000010 IDENTIFICATION  DIVISION.                                        00001000
000020 PROGRAM-ID.     DSDS100.                                         00002000
000030 AUTHOR.         J. TRIPPENSEE.                                   00003000
000040 INSTALLATION.   CENTRAL DATA COMPANY.                            00004000
000050 DATE-WRITTEN.   DECEMBER 8 1977.                                 00005000
000060******************************************************************00006000
000070*REMARKS                                                 REMARKB**00007000
000080*                                                                 00008000
000090* PURPOSE: DSDS100 IS EXECUTED AT CDC FOR ALL DSDS CUSTOMERS.     00009000
000100*                                                                 00010000
000110* FREQUENCY: DSDS100 IS RUN DAILY.                                00011000
000120*                                                                 00012000
000130* REPORT RECORDS GENERATED:                                       00013000
000140*   -SYSTEM ID- -REPORT NBR- -REPORT NAME-                        00014000
000150*                                                                 00015000
000160* PROCESSING CONSIDERATIONS:                                      00016000
000170*      - DSDS100 IS THE MAIN DOLLAR TRANSACTION POSTING PROGRAM   00017000
000180*                FOR THE DSDS SYSTEM.                             00018000
000190*      - DSDS100 INPUT  ALL TRANSACTION FILE (IO MODULE DSDSTXL1) 00019000
000200*                       DSDS BANK CONTROL FILE (VSAM) (DISK)      00020000
000210*                       DSDS PROCESS CONTROL FILE (DISK)          00021000
000220*                       HOLD TOTAL FILE (VSAM) (DISK)             00022000
000230*                       ACCOUNT ANALYSIS FILE (VSAM)              00023000
000240*                       BALANCE ADJUSTMENT FILE (DISK)            00024000
000250*                       AFFILIATE CHECK HOLD FILE (VSAM) (DISK)   00025000
000260*                       UNIVERSAL BANK CONTROL FILE (DB2)         00026000
000270*                       ATM CARD FILE (DB2)                       00027000
000280*                       AR CUSTOMER CONTROL FILE (DB2).           00028000
000290*      - DSDS100 OUTPUT POSTED DETAIL (DISK)                      00029000
000300*                       POSTING JOURNAL (PRINT AND/OR FICHE)      00030000
000310*                       DAILY TOTALS    (PRINT AND/OR FICHE)      00031000
000320*                       SPECIAL FORMS REPORT WORK (DISK)          00032000
000330*                       STOCK PAPER REPORT WORK   (DISK)          00033000
000340*                           (THIS FILE IS IN DSDM102)             00034000
000350*                       ACCOUNT RECONCILIATION FILE (DISK)        00035000
000360*                       INVESTMENT STATEMENT BALANCES (VSAM)      00036000
000370*                       NSF ITEM FILE 1 (DISK)                    00037000
000380*                       NSF ITEM FILE 2 (DISK)                    00038000
000390*                       STATEMENT HEADER (TRAILER) FILE (DISK)    00039000
000400*                       ODB HISTORY DETAIL FILE (DISK)            00040000
000410*                       GENERAL LEDGER TRANSACTIONS (DISK)        00041000
000420*                       HS CASH MANAGEMENT COLLATERAL FILE (DISK) 00042000
000430*                       OSB SUMMARY FILE (DISK)                   00043000
000440*                       IMAGE MCF HEADER FILE (DISK)              00044000
000450*                       IMAGE MCF EOM HEADER FILE (DISK)          00045000
000460*                       DSDS BAI TRANSACTION FILE )DISK)          00046000
000470*                       SHADOW ACCOUNTS FILE (DISK)               00047000
000480*                       NSF ITEM FILE 3 (DISK)                    00048000
000490*                       OVERDRAFT INFO FILE (DISK)                00049000
000500*                       ACCOUNT ANALYSIS TX FILE (DSK).           00050000
000510*                       NSF ITEM FILE 4 (DISK)                    00051000
000520*                       COLLATERAL EXCEPTION FILE (DISK)          00052000
000530*      - DSDS100 I-O    DSDS MASTER FILES  (RDAM)                 00053000
000540*                       DSDS HISTORY FILES (RDAM)                 00054000
000550*                       DSDS COLLATERAL FILE (VSAM)               00055000
000560*                       DSDS PENDING TX FILE (DB2)                00056000
000570*                       IRS PENDING TX FILE (DB2).                00057000
000580                                                                  00058000
000590 COPY DSDSREPT.                                                   00059000
000600                                                                  00060000
000610******************************************************************00061000
000620*         A L P H A   I N D E X   O F   R O U T I N E S          *00062000
000630******************************************************************00063000
000640*    ACCOUNT ANALYSIS TRANSACTION PROCESSING                      00064000
000650*        DAILY BALANCE TXS                                  P8780 00065000
000660*        DAILY POSTED TXS                                   P8790 00066000
000670*        DAILY COUNT TXS                                    P8800 00067000
000680*        BALANCE ADJUSTMENT TXS                             P8810 00068000
000690*    ACCOUNT ID CHANGE                                      P0650 00069000
000700*    ACCOUNT RECONCILIATION                                       00070000
000710*        LOOKUP CUSTOMER CONTROL FILE                       P8310 00071000
000720*    ACCRUAL ROUTINES - CALL FOR                            P0570 00072000
000730*    ADM OPEN AND RATE RETRIEVAL                            P0180 00073000
000740*    BANK CONTROL ACCOUNTS UPDATE                           P5800 00074000
000750*    BANK CONTROL FILE                                            00075000
000760*        ACCOUNT ID LOOK UP                                 P8070 00076000
000770*        EXTERNAL SERVICE CHARGE LOOK UP                    P8080 00077000
000780*        OPEN                                               P0020 00078000
000790*        OVERDRAFT BANKING LOOK UP                          P0620 00079000
000800*        READ                                               P0090 00080000
000810*        SERVICE CHARGE LOOK UP                             P8360 00081000
000820*    BANK INITIALIZATION                                    P0100 00082000
000830*    CHRISTMAS CLUB - CYCLE WITHOUT INTEREST                P5510 00083000
000840*    CHRISTMAS CLUB - CYCLE WITH INTEREST                   P5520 00084000
000850*    CIF OPEN                                               P0120 00085000
000860*    CLEAR TOTALS                                           P8170 00086000
000870*    CYCLE EARNINGS                                         P5500 00087000
000880*    CYCLE STATEMENTS                                       P5400 00088000
000890*    EARNINGS CYCLE                                         P5500 00089000
000900*    END-OF ROUTINES                                              00090000
000910*        BANK                                               P6000 00091000
000920*        MONTH                                              P6500 00092000
000930*        QUARTER                                            P6507 00093000
000940*        RUN                                                P9999 00094000
000950*        YEAR                                               P6530 00095000
000960*    ERROR ROUTINES                                         P9800 00096000
000970*    HEADER TRANSACTIONS BUILT                                    00097000
000980*        INVESTMENT                                         P9000 00098000
000990*        N.O.W.                                             P8980 00099000
001000*        O.D.B.                                             P8960 00100000
001010*        O.D.B. HISTORY CARD                                P8600 00101000
001020*        O.S.B. SAVINGS                                     P8610 00102000
001030*        REGULAR                                            P8590 00103000
001040*        SERVICE CHARGE                                     P8580 00104000
001050*    HISTORY FILE                                                 00105000
001060*        OPEN                                               P0140 00106000
001070*        READ                                               P7525E00107000
001080*    HOLDS                                                        00108000
001090*        ADD TRANSACTION                                    P1170 00109000
001100*        DELETE TRANSACTION                                 P1175 00110000
001110*        ADD INSF HOLD                                      P8270 00111000
001120*        DELETE HOLDS FOR CLOSED ACCOUNTS                   P8280 00112000
001130*        LIST ALL HOLDS                                     P8290 00113000
001140*        READ HOLD TOTAL FILE (VSAM)                        P8330 00114000
001150*    INTEREST DAILY ACCRUAL                                 P0570 00115000
001160*    INVESTMENTS                                                  00116000
001170*        ACTIVITY CHECK                                     P4400 00117000
001180*        CYCLE                                              P4000 00118000
001190*        INTEREST ACCRUAL                                   P0590 00119000
001200*        INTEREST POSTING                                   P4100 00120000
001210*        MATURITY CHECK                                     P4200 00121000
001220*        PEGGED BALANCE ADJUSTMENT                          P4500 00122000
001230*        RATE RETRIEVAL                                     P4300 00123000
001240*        TX PROCESSING                                            00124000
001250*            MATURITIES                                     P3500 00125000
001260*            PURCHASES                                      P3600 00126000
001270*    MASTER PROCESSING                                            00127000
001280*        CONTROL DATE CHECK                                 P0150 00128000
001290*        OPEN                                               P0130 00129000
001300*        PREP 1 DAY                                         P0330 00130000
001310*        PREP STATEMENT CYCLE                               P0350 00131000
001320*        PREPROCESSING                                      P0310 00132000
001330*        PROCESSING  AFTER POSTING                          P5000 00133000
001340*        READ                                               P0300 00134000
001350*        WRITE                                              P5225 00135000
001360*    MATCH MASTER AND TRANSACTION RECORDS                   P1000 00136000
001370*    OUTPUT CONTROL RECORDS BUILT                           P0040 00137000
001380*    OVERDRAFT ACCESS PROCESSING                            P1515 00138000
001390*    OVERDRAFT BANKING (O.D.B.)                                   00139000
001400*        AUTOMATIC ADVANCES                                       00140000
001410*            ADVANCE AMOUNT ACCUMULATION                    P2450 00141000
001420*            BUILD ADVANCE TX                               P2650 00142000
001430*        CREDIT LIFE ACCRUAL                                P0580 00143000
001440*        CREDIT LIFE POSTING                                P3150 00144000
001450*        CYCLE                                              P2850 00145000
001460*        DAILY PAYOFF ROUTINE                               P3350 00146000
001470*        FINANCE CHARGE ACCRUAL                             P0580 00147000
001480*        FINANCE CHARGE POSTING                             P3100 00148000
001490*        HEADER BUILT                                       P8960 00149000
001500*        HISTORY CARDS                                            00150000
001510*            HEADER BUILT                                   P8600 00151000
001520*            CYCLE OR REQUEST NEEDED                        P8370 00152000
001530*        PAST DUE NOTICES                                   P3250 00153000
001540*        PAST DUE PAYMENTS                                  P2750 00154000
001550*        PAYMENT TRANSACTIONS                               P2800 00155000
001560*        PEGGED BALANCE ROUTINE                             P3400 00156000
001570*        TX PROCESSING                                      P2000 00157000
001580*            DEBITS                                         P2100 00158000
001590*            CREDITS                                        P2200 00159000
001600*        TRAILER BUILT                                      P8970 00160000
001610*    POSTED DETAIL PROCESSING                                     00161000
001620*        ACCUMULATED                                        P8630 00162000
001630*        RECORD BUILT                                       P8570 00163000
001640*        WRITTEN                                            P8574 00164000
001650*    PROCESS CONTROL READ                                   P0050 00165000
001660*    REPORT FREQUENCY                                       P7525 00166000
001670*    SERVICE CHARGE DEBIT (DECISION)                        P8825 00167000
001680*    SERVICE CHARGE ROUTINES                                P5460 00168000
001690*    SERVICE CHARGE STATEMENT NEEDED                        P8350 00169000
001700*    SPECIAL FORMS                                                00170000
001710*        ADDITIONAL MARGIN NOTICES (SL ACCTS ONLY) (086)    P8520 00171000
001720*        PEGGED BALANCE ADJUSTMENT NOTICES         (087)    P8510 00172000
001730*        INTEREST CHECKS                           (091)    P7190 00173000
001740*        PAST DUE NOTICES                          (092)    P3250 00174000
001750*        ADVANCE NOTICES                           (093)    P2680 00175000
001760*        INSUFFICIENT NOTICES                      (094)    P8380 00176000
001770*        CHRISTMAS CLUB CHECKS                     (095)    P7190 00177000
001780*        COLLATERAL NOTICES                        (097)    P8230 00178000
001790*        LIST POST ROUTINES                        (098)    P8680 00179000
001800*    STATEMENT TYPE (DECISION)                              P8340 00180000
001810*    STATEMENTS CYCLE                                       P5400 00181000
001820*    STOCK PAPER COMMON FIELDS                                    00182000
001830*    STOCK PAPER REPORTS                                          00183000
001840*        TRIAL BALANCE (DAILY)                     (001)    P7010 00184000
001850*        DEPOSIT LISTING                           (002)    P7020 00185000
001860*        KITE SUSPECTS                             (003)    P7030 00186000
001870*        OD ACCESS LIMIT CHANGES                   (004)    P7040 00187000
001880*        OVERDRAWN ACCOUNTS                        (005)    P7050 00188000
001890*        HOLD ACTIVITY                             (006)    P7060 00189000
001900*        CLOSED ACCOUNTS (TODAY)                   (009)    P7090 00190000
001910*        NEW ACCOUNTS (TODAY)                      (010)    P7100 00191000
001920*        DORMANT/INACTIVE ACCOUNTS ACTIVITY        (011)    P7110 00192000
001930*        O.D.B. ACTIVITY                           (012)    P7120 00193000
001940*        O.D.B. TRIAL BALANCE                      (013)    P7130 00194000
001950*        O.D.B. CUTOFF/OVERLINE/PAST DUE ACCTS     (014)    P7140 00195000
001960*        SERVICE CHARGE/INTEREST EARNINGS JOURNAL  (015)    P7150 00196000
001970*        DAILY EXTERNAL SERVICE CHARGES            (016)    P7160 00197000
001980*        ACCOUNTS CLOSED BY SERVICE CHARGE         (018)    P7180 00198000
001990*        CHECK REGISTER                            (019)    P7190 00199000
002000*        MASTER/TRANSACTION EXCEPTIONS             (020)    P7200 00200000
002010*        UNPOSTED ITEMS                            (021)    P7210 00201000
002020*        WATCHED ACCOUNTS                          (025)    P7250 00202000
002030*        MATURED INVESTMENTS                       (026)    P7260 00203000
002040*        PURCHASED INVESTMENTS AND COLLATERAL      (027)    P7270 00204000
002050*        INVESTMENT TRIAL BALANCE                  (028)    P7280 00205000
002060*        INVESTMENT MANAGEMENT                     (029)    P7290 00206000
002070*        INVESTMENT NEW ACCOUNTS                   (030)    P7300 00207000
002080*        INVESTMENT CLOSED ACCOUNTS                (031)    P7310 00208000
002090*        DORMANT/INACTIVE ACCOUNTS LISTING         (032)    P7110 00209000
002100*        O.D.B. AGING ACCOUNTS                     (033)    P7330 00210000
002110*        HOLD LISTING                              (034)    P7340 00211000
002120*        O.D.B. MATURITY LIST                      (037)    P7370 00212000
002130*        I.B.E.W. TRIAL BALANCE                    (038)    P7010 00213000
002140*        COMMERCIAL ACCOUNT SUSPECTS               (039)    P7390 00214000
002150*        TRIAL BALANCE (SPECIAL)                   (040)    P7010 00215000
002160*        CLOSED ACCOUNTS (THIS MONTH)              (041)    P7090 00216000
002170*        NEW ACCOUNTS (THIS MONTH)                 (042)    P7100 00217000
002180*        SERVICE CHARGE BY RELATED ACCOUNTS        (043)    P7430 00218000
002190*        CORPORATE ACCOUNTS                        (044)    P7440 00219000
002200*        LARGE AVERAGE BALANCES                    (045)    P7450 00220000
002210*        NEGATIVE NET COLLECTED BALANCES           (046)    P7460 00221000
002220*        SUMMARY OF ACCTS (ALL)                    (047)    P7470 00222000
002230*        SUMMARY OF ACCTS BY OFFICER (ALL)         (048)    P7470 00223000
002240*        SUMMARY OF ACCTS ONLY WITH OFFICER        (049)    P7470 00224000
002250*        SUMMARY OF ACCTS IF SC EXMPT BY EXMPT CD  (050)    P7470 00225000
002260*        SUMMARY OF ACCTS IF HIGH LOSS             (051)    P7470 00226000
002270*        SUMMARY OF ACCTS IF HIGH PROFIT           (052)    P7470 00227000
002280*        O.D.B. TRIAL BALANCE (EMPLOYEE)           (053)    P7130 00228000
002290*        B.B.I. CYCLE CODE 46 EXCEPTION REPORT     (054)    P7540 00229000
002300*        LIST POST LISTING                         (055)    P8690 00230000
002310*                                                  (055)    P8700 00231000
002320*        I.M.M. EXCEPTIONS                         (056)    P7560 00232000
002330*        INVESTMENT EXCEPTIONS                     (057)    P7570 00233000
002340*        $100,000 AND OVER (FOR CALL REPORT)       (057)    P7580 00234000
002350*        SUMMARY OF ACCTS BY SC CODE (ALL)         (059)    P7470 00235000
002360*        O.D.B. PRIORITY LINE REPORT               (060)    P7600 00236000
002370*        ACCOUNT HISTORY                           (061)    P7610 00237000
002380*        POSTED DEBIT LIST (IN AMOUNT SEQ)         (062)    P7620 00238000
002390*        ZERO BALANCE ACCOUNTS                     (063)    P7630 00239000
002400*        OVERDRAWN ACCOUNTS (LARGE OD LIMITS)      (064)    P7050 00240000
002410*        MONTHLY OVERDRAFT LIST                    (065)    P7650 00241000
002420*        GROWTH SAVINGS EXCEPTION LIST             (066)    P7660 00242000
002430*        O.D.B. CREDIT LIFE ACCOUNT LIST           (067)    P7670 00243000
002440*        DEPOSIT LISTING (IN AMOUNT SEQ)           (068)    P7680 00244000
002450*        SUMMARY OF ACCTS IF SC EXMPT BY OFF CODE  (069)    P7470 00245000
002460*        UNPOSTED ITEMS BY AMOUNT                  (070)    P7210 00246000
002470*        O.D.B. YEAR-TO-DATE INTEREST              (071)    P7710 00247000
002480*        ACCOUNT RECONCILIATION ACCOUNT LIST       (072)    P7720 00248000
002490*        O.D.B. ACTIVITY (SECURITIES LINE ONLY )   (073)    P7120 00249000
002500*        O.D.B. TRIAL BALANCE (SECURITIES LN ONLY) (074)    P7130 00250000
002510*        O.D.B. CUTOFF/OVERLINE/PAST DUE (SL ONLY) (075)    P7140 00251000
002520*        LARGE ITEMS REPORT                        (077)    P7200 00252000
002530*        POSTING JOURNAL                           (080)    P8660 00253000
002540*        DAILY TOTALS                              (082)    P6800 00254000
002550*        OVERDRAWN ACCOUNTS (BY OFFICER)           (083)    P7050 00255000
002560*        CASH MANAGEMENT EXCEPTIONS                (084)    P7840 00256000
002570*        OVERDRAWN ACCOUNTS BY OD ACCESS CODE      (090)    P7900 00257000
002580*    STOCK PAPER SORT KEY                                   P8000 00258000
002590*    STOCK PAPER WRITE                                      P7000 00259000
002600*    TRAILER TRANSACTIONS BUILT                                   00260000
002610*        INVESTMENT                                         P8990 00261000
002620*        O.D.B.                                             P8970 00262000
002630*        O.D.B. HISTORY CARD                                P8370 00263000
002640*        REGULAR                                            P8620 00264000
002650*        SERVICE CHARGE                                     P8830 00265000
002660*    TRANSACTIONS                                                 00266000
002670*        ACCRUED INTEREST ADJUSTMENT                        P1155 00267000
002680*        CLOSE ACCOUNTS AUTOMATICALLY                       P5750 00268000
002690*        CREDIT TRANSACTIONS                                      00269000
002700*            BACKDATED                                      P1400 00270000
002710*            NORMAL                                         P1320 00271000
002720*            PROCESSING                                     P1300 00272000
002730*        DEBIT TRANSACTIONS                                       00273000
002740*            BACKDATED                                      P1650 00274000
002750*            NORMAL                                         P1665 00275000
002760*            PROCESSING                                     P1500 00276000
002770*        EXTERNAL SERVICE CHARGE                            P1250 00277000
002780*        FLOAT DECREASE                                     P1110 00278000
002790*        FLOAT INCREASE                                     P1085 00279000
002800*        HOLD                                               P1170 00280000
002810*        INITIALIZATION COMMON FIELDS                       P8200 00281000
002820*        INTEREST PAYMENT                                   P8410 00282000
002830*        NON-DOLLAR                                         P1040 00283000
002840*        ONLINE BULK SORT                                         00284000
002850*            ENCLOSURE TX                                   P8850 00285000
002860*            EXCEPTION TX (UNPOSTED)                        P8855 00286000
002870*            EXCEPTION TX (STOP PAYS)                       P8860 00287000
002880*            EXCEPTION TX (POSTED)                          P8865 00288000
002890*            INITIALIZATION                                 P0060 00289000
002900*        OPEN FILE                                          P0010 00290000
002910*        OVERDRAFT CHARGE                                   P5020 00291000
002920*        READ FILE                                          P0400 00292000
002930*        SERVICE CHARGE                                     P5690 00293000
002940*        SERVICE CHARGE FOR FEE ACCOUNTS                    P5760 00294000
002950*        STOP PAY IN FORCE                                  P1165 00295000
002960*    WITHHOLDING                                                  00296000
002970*        POST ADJUSTMENT EARNINGS AND WITHHOLDING           P1820 00297000
002980*        POST CYCLE EARNINGS AND WITHHOLDING                P1810 00298000
002990*        STATUS CHECK                                       P1800 00299000
003000*    YEAR END                                               P6530 00300000
003010                                                                  00301000
003020 ENVIRONMENT DIVISION.                                            00302000
003030 CONFIGURATION SECTION.                                           00303000
003040 SOURCE-COMPUTER. IBM-4341.                                       00304000
003050 OBJECT-COMPUTER. IBM-4341.                                       00305000
003060 INPUT-OUTPUT SECTION.                                            00306000
003070 FILE-CONTROL.                                                    00307000
003080     SELECT DSDS-MAST        ASSIGN TO DSDSMAST                   00308000
003090                             RECORD KEY IS DSDS-M-RECORD-KEY      00309000
003100                             ORGANIZATION IS INDEXED              00310000
003110                             FILE STATUS IS VSAM-FILE-STATUS      00311000
003120                             ACCESS MODE IS DYNAMIC.              00312000
003130                                                                  00313000
003140     SELECT DSDS-HIST        ASSIGN TO DSDSHIST                   00314000
003150                             RECORD KEY IS DSDS-H-RECORD-KEY      00315000
003160                             ORGANIZATION IS INDEXED              00316000
003170                             FILE STATUS IS VSAM-FILE-STATUS      00317000
003180                             ACCESS MODE IS DYNAMIC.              00318000
003190                                                                  00319000
003200     SELECT PROCESS-CONTROL  ASSIGN TO   UT-S-DSDS102R.           00320000
003210     SELECT POSTED-DETAIL    ASSIGN TO   UT-S-DSDS103W.           00321000
003220     SELECT SPECIAL-FORMS-WORK                                    00322000
003230                             ASSIGN TO   UT-S-DSDS104W.           00323000
003240     SELECT HOLD-TOT-FILE    ASSIGN TO        DSDS106R            00324000
003250                             ORGANIZATION IS INDEXED              00325000
003260                             RECORD KEY   IS HOLD-TOT-KEY         00326000
003270                             FILE STATUS  IS VSAM-FILE-STATUS     00327000
003280                             ACCESS MODE  IS RANDOM.              00328000
003290     SELECT OBS-TRANS-FILE   ASSIGN TO   UT-S-DSDS107W.           00329000
003300     SELECT BCF-FILE         ASSIGN TO        DSDSBCF             00330000
003310                             ORGANIZATION IS INDEXED              00331000
003320                             RECORD KEY   IS BCF-RECORD-ID        00332000
003330                             FILE STATUS  IS VSAM-FILE-STATUS     00333000
003340                             ACCESS MODE  IS DYNAMIC.             00334000
003350     SELECT ACCT-ANAL-TX-FILE                                     00335000
003360                             ASSIGN TO   UT-S-DSDS108W.           00336000
003370     SELECT DSDS-COLLATERAL-FILE                                  00337000
003380                             ASSIGN TO        DSDS109X            00338000
003390                             ORGANIZATION IS INDEXED              00339000
003400                             RECORD KEY   IS DSDS-COLLAT-REC-ID   00340000
003410                             FILE STATUS  IS VSAM-FILE-STATUS     00341000
003420                             ACCESS MODE  IS SEQUENTIAL.          00342000
003430     SELECT ACCOUNT-RECON    ASSIGN TO   UT-S-DSDS110W.           00343000
003440     SELECT INV-STATEMENT-BALANCES                                00344000
003450                             ASSIGN TO        DSDS112W            00345000
003460                             ORGANIZATION IS INDEXED              00346000
003470                             RECORD KEY   IS INV-STMT-BAL-REC-ID  00347000
003480                             FILE STATUS  IS VSAM-FILE-STATUS     00348000
003490                             ACCESS MODE  IS SEQUENTIAL.          00349000
003500     SELECT ACCT-ANAL-FILE   ASSIGN TO        DSDS113R            00350000
003510                             ORGANIZATION IS INDEXED              00351000
003520                             RECORD KEY   IS ACCT-ANAL-KEY        00352000
003530                             FILE STATUS  IS VSAM-FILE-STATUS     00353000
003540                             ACCESS MODE  IS RANDOM.              00354000
003550     SELECT NSF-ITEM-FILE-1  ASSIGN TO   UT-S-DSDS114W.           00355000
003560     SELECT NSF-ITEM-FILE-2  ASSIGN TO   UT-S-DSDS115W.           00356000
003570     SELECT STMT-HEADER-FILE ASSIGN TO   UT-S-DSDS116W.           00357000
003580     SELECT ODB-HISTORY-DTL-FILE                                  00358000
003590                             ASSIGN TO   UT-S-DSDS117W.           00359000
003600     SELECT BALANCE-ADJ-FILE ASSIGN TO   UT-S-DSDS121R.           00360000
003610     SELECT OSB-SUMMARY-FILE ASSIGN TO   UT-S-DSDS122W.           00361000
003620     SELECT AFFCHK-HOLD-FILE ASSIGN TO        DSDS123R            00362000
003630                             ORGANIZATION IS INDEXED              00363000
003640                             RECORD KEY   IS AFFCHK-HOLD-KEY      00364000
003650                             FILE STATUS  IS VSAM-FILE-STATUS     00365000
003660                             ACCESS MODE  IS RANDOM.              00366000
003670     SELECT CASH-MGMT-COLLAT-FILE                                 00367000
003680                             ASSIGN TO   UT-S-DSDS124W.           00368000
003690     SELECT MCF-HEADER-FILE  ASSIGN TO   UT-S-DSDS125W.           00369000
003700     SELECT MCF-HEADER-FILE-EOM                                   00370000
003710                             ASSIGN TO   UT-S-DSDS126W.           00371000
003720     SELECT DSDS-BAI-TRANS-FILE                                   00372000
003730                             ASSIGN TO   UT-S-DSDS128W.           00373000
003740     SELECT SHADOW-ACCOUNTS  ASSIGN TO   UT-S-DSDS129W.           00374000
003750     SELECT NSF-ITEM-FILE-3  ASSIGN TO   UT-S-DSDS130W.           00375000
003760     SELECT CHANGE-LOG-FILE  ASSIGN TO   UT-S-DSDS133W.           00376000
003770     SELECT DSDS-859-FILE    ASSIGN TO   UT-S-DSDS134W.           00377000
003780     SELECT OSB-IRA-SUMMARY-FILE                                  00378000
003790                             ASSIGN TO   UT-S-DSDS135W.           00379000
003800     SELECT NSF-ITEM-FILE-4  ASSIGN TO   UT-S-DSDS137W.           00380000
003810     SELECT DEPOSIT-SCORE-FILE                                    00381000
003820                             ASSIGN TO   UT-S-DSDS138W.           00382000
003830     SELECT COLLAT-EXCEPT-FILE                                    00383000
003840                             ASSIGN TO   UT-S-DSDS139W.           00384000
003850     SELECT ML-HELOC-ADV-FILE                                     00385000
003860                             ASSIGN TO   UT-S-DSDS140W.           00386000
003870                                                                  00387000
003880     SELECT ACRS-TRAN-FILE                                        00388000
003890                             ASSIGN TO   UT-S-DSDS141W.           00389000
003900     SELECT CLSN-BR-TX-FILE  ASSIGN TO   UT-S-DSDS142W.           00390000
003910                                                                  00391000
003920     SELECT ICS-FA-TRAN-FILE ASSIGN TO   UT-S-DSDS143W.           00392000
003930                                                                  00393000
003940 DATA DIVISION.                                                   00394000
003950 FILE SECTION.                                                    00395000
003960 FD  DSDS-MAST.                                                   00396000
003970     COPY DSDSMSTP.                                               00397000
003980                                                                  00398000
003990 FD  DSDS-HIST.                                                   00399000
004000     COPY DSDSHSTP.                                               00400000
004010                                                                  00401000
004020 FD PROCESS-CONTROL                                               00402000
004030     RECORDING MODE F                                             00403000
004040     RECORD CONTAINS 217 CHARACTERS                               00404000
004050     BLOCK  CONTAINS   0 RECORDS                                  00405000
004060     LABEL RECORDS STANDARD                                       00406000
004070     DATA  RECORDS PROC-CTL.                                      00407000
004080 01  PROC-CTL.                                                    00408000
004090     02  FILLER              PIC X(217).                          00409000
004100                                                                  00410000
004110 FD POSTED-DETAIL                                                 00411000
004120     RECORDING MODE F                                             00412000
004130     RECORD CONTAINS 225 CHARACTERS                               00413000
004140     BLOCK  CONTAINS   0 RECORDS                                  00414000
004150     LABEL RECORDS STANDARD                                       00415000
004160     DATA  RECORDS POSTED-DTL.                                    00416000
004170 01  POSTED-DTL.                                                  00417000
004180     02  FILLER              PIC X(225).                          00418000
004190                                                                  00419000
004200 FD SPECIAL-FORMS-WORK                                            00420000
004210     RECORDING MODE F                                             00421000
004220     RECORD CONTAINS 150 CHARACTERS                               00422000
004230     BLOCK  CONTAINS   0 RECORDS                                  00423000
004240     LABEL RECORDS STANDARD                                       00424000
004250     DATA  RECORDS SPECIAL-FORM.                                  00425000
004260 01  SPECIAL-FORM.                                                00426000
004270     02  FILLER              PIC X(150).                          00427000
004280                                                                  00428000
004290 FD HOLD-TOT-FILE.                                                00429000
004300 01  HOLD-TOT-RECORD.                                             00430000
004310     02  HOLD-TOT-KEY        PIC X(9).                            00431000
004320     02  FILLER              PIC X(16).                           00432000
004330                                                                  00433000
004340 FD OBS-TRANS-FILE                                                00434000
004350     RECORDING MODE F                                             00435000
004360     RECORD CONTAINS 100 CHARACTERS                               00436000
004370     BLOCK  CONTAINS  0 RECORDS                                   00437000
004380     LABEL RECORDS STANDARD                                       00438000
004390     DATA  RECORDS OBS-TX.                                        00439000
004400 01  OBS-TX.                                                      00440000
004410     02  FILLER              PIC X(100).                          00441000
004420                                                                  00442000
004430 FD BCF-FILE.                                                     00443000
004440     COPY DSDSBKCF.                                               00444000
004450                                                                  00445000
004460 FD ACCT-ANAL-TX-FILE                                             00446000
004470     RECORDING MODE F                                             00447000
004480     RECORD CONTAINS 228 CHARACTERS                               00448000
004490     BLOCK  CONTAINS   0 RECORDS                                  00449000
004500     LABEL RECORDS STANDARD                                       00450000
004510     DATA  RECORDS ACCT-ANAL-TX-OUT.                              00451000
004520 01  ACCT-ANAL-TX-OUT.                                            00452000
004530     02  FILLER              PIC X(228).                          00453000
004540                                                                  00454000
004550 FD DSDS-COLLATERAL-FILE.                                         00455000
004560 01  DSDS-COLLAT-REC.                                             00456000
004570     02  DSDS-COLLAT-REC-ID.                                      00457000
004580         03  DSDS-COLLAT-BK  PIC 999                     COMP-3.  00458000
004590         03  DSDS-COLLAT-RATE PIC 9V99                   COMP-3.  00459000
004600         03  DSDS-COLLAT-SEQ PIC 9(5)                    COMP-3.  00460000
004610     02  FILLER              PIC X(93).                           00461000
004620                                                                  00462000
004630 FD ACCOUNT-RECON                                                 00463000
004640     RECORDING MODE F                                             00464000
004650     RECORD CONTAINS 50 CHARACTERS                                00465000
004660     BLOCK  CONTAINS  0 RECORDS                                   00466000
004670     LABEL RECORDS STANDARD                                       00467000
004680     DATA  RECORDS ACCT-RECONX.                                   00468000
004690 01  ACCT-RECONX.                                                 00469000
004700     02  FILLER              PIC X(50).                           00470000
004710                                                                  00471000
004720 FD INV-STATEMENT-BALANCES.                                       00472000
004730 01  INV-STMT-BAL-REC.                                            00473000
004740     02  INV-STMT-BAL-REC-ID.                                     00474000
004750         03  INV-STMT-BAL-BANK-NO                                 00475000
004760                             PIC 99.                              00476000
004770         03  INV-STMT-BAL-ACCT-NO                                 00477000
004780                             PIC 9(9)                    COMP-3.  00478000
004790     02  INV-STMT-BAL-INV-BAL                                     00479000
004800                             PIC S9(9)V99                COMP-3.  00480000
004810     02  INV-STMT-BAL-STMT-BAL                                    00481000
004820                             PIC S9(9)V99                COMP-3.  00482000
004830     02  INV-STMT-BAL-PUR    PIC S9(9)V99                COMP-3.  00483000
004840     02  INV-STMT-BAL-MAT    PIC S9(9)V99                COMP-3.  00484000
004850     02  FILLER              PIC X(19).                           00485000
004860                                                                  00486000
004870 FD ACCT-ANAL-FILE.                                               00487000
004880     COPY DSDSANAL.                                               00488000
004890                                                                  00489000
004900 FD NSF-ITEM-FILE-1                                               00490000
004910     RECORDING MODE F                                             00491000
004920     RECORD CONTAINS 225 CHARACTERS                               00492000
004930     BLOCK  CONTAINS   0 RECORDS                                  00493000
004940     LABEL RECORDS STANDARD                                       00494000
004950     DATA  RECORDS NSF-FILE-1.                                    00495000
004960 01  NSF-FILE-1.                                                  00496000
004970     02  FILLER              PIC X(225).                          00497000
004980                                                                  00498000
004990 FD NSF-ITEM-FILE-2                                               00499000
005000     RECORDING MODE F                                             00500000
005010     RECORD CONTAINS 150 CHARACTERS                               00501000
005020     BLOCK  CONTAINS   0 RECORDS                                  00502000
005030     LABEL RECORDS STANDARD                                       00503000
005040     DATA  RECORDS NSF-FILE-2.                                    00504000
005050 01  NSF-FILE-2.                                                  00505000
005060     02  FILLER              PIC X(150).                          00506000
005070                                                                  00507000
005080 FD STMT-HEADER-FILE                                              00508000
005090     RECORDING MODE F                                             00509000
005100     RECORD CONTAINS 225 CHARACTERS                               00510000
005110     BLOCK  CONTAINS   0 RECORDS                                  00511000
005120     LABEL RECORDS STANDARD                                       00512000
005130     DATA  RECORDS STMT-HDR.                                      00513000
005140 01  STMT-HDR.                                                    00514000
005150     02  FILLER              PIC X(225).                          00515000
005160                                                                  00516000
005170 FD ODB-HISTORY-DTL-FILE                                          00517000
005180     RECORDING MODE F                                             00518000
005190     RECORD CONTAINS 225 CHARACTERS                               00519000
005200     BLOCK  CONTAINS   0 RECORDS                                  00520000
005210     LABEL RECORDS STANDARD                                       00521000
005220     DATA  RECORDS ODB-HIST-DTL.                                  00522000
005230 01  ODB-HIST-DTL.                                                00523000
005240     02  FILLER              PIC X(225).                          00524000
005250                                                                  00525000
005260 FD BALANCE-ADJ-FILE                                              00526000
005270     RECORDING MODE IS F                                          00527000
005280     RECORD CONTAINS 17 CHARACTERS                                00528000
005290     BLOCK  CONTAINS 0  RECORDS                                   00529000
005300     LABEL RECORDS ARE STANDARD                                   00530000
005310     DATA  RECORDS ARE BAL-ADJ.                                   00531000
005320 01  BAL-ADJ                 PIC X(17).                           00532000
005330                                                                  00533000
005340 FD OSB-SUMMARY-FILE                                              00534000
005350     RECORDING MODE F                                             00535000
005360     RECORD CONTAINS 150 CHARACTERS                               00536000
005370     BLOCK  CONTAINS   0 RECORDS                                  00537000
005380     LABEL RECORDS STANDARD                                       00538000
005390     DATA  RECORDS OSB-SUMMARY.                                   00539000
005400 01  OSB-SUMMARY.                                                 00540000
005410     02  FILLER              PIC X(150).                          00541000
005420                                                                  00542000
005430 FD AFFCHK-HOLD-FILE.                                             00543000
005440 01  AFFCHK-HOLDS.                                                00544000
005450     02  AFFCHK-HOLD-KEY.                                         00545000
005460         03  AFFCHK-BANK-NBR PIC 99.                              00546000
005470         03  AFFCHK-ACCT-ID  PIC 9(3)                    COMP-3.  00547000
005480         03  AFFCHK-ACCT-NBR PIC 9(9)                    COMP-3.  00548000
005490         03  AFFCHK-CHK-NBR  PIC S9(9)                   COMP-3.  00549000
005500         03  AFFCHK-AMOUNT   PIC S9(9)V99                COMP-3.  00550000
005510                                                                  00551000
005520 FD CASH-MGMT-COLLAT-FILE                                         00552000
005530     RECORDING MODE F                                             00553000
005540     RECORD CONTAINS 102 CHARACTERS                               00554000
005550     BLOCK  CONTAINS   0 RECORDS                                  00555000
005560     LABEL RECORDS STANDARD                                       00556000
005570     DATA  RECORDS CASH-MGMT-COLLAT-OUT.                          00557000
005580 01  CASH-MGMT-COLLAT-OUT.                                        00558000
005590     02  FILLER              PIC X(102).                          00559000
005600                                                                  00560000
005610 FD MCF-HEADER-FILE                                               00561000
005620     RECORDING MODE F                                             00562000
005630     RECORD CONTAINS 80 CHARACTERS                                00563000
005640     BLOCK  CONTAINS  0 RECORDS                                   00564000
005650     LABEL RECORDS STANDARD                                       00565000
005660     DATA  RECORDS MCF-HDR-OUT.                                   00566000
005670 01  MCF-HDR-OUT.                                                 00567000
005680     02  FILLER              PIC X(80).                           00568000
005690                                                                  00569000
005700 FD MCF-HEADER-FILE-EOM                                           00570000
005710     RECORDING MODE F                                             00571000
005720     RECORD CONTAINS 80 CHARACTERS                                00572000
005730     BLOCK  CONTAINS  0 RECORDS                                   00573000
005740     LABEL RECORDS STANDARD                                       00574000
005750     DATA  RECORDS MCF-HDR-EOM-OUT.                               00575000
005760 01  MCF-HDR-EOM-OUT.                                             00576000
005770     02  FILLER              PIC X(80).                           00577000
005780                                                                  00578000
005790 FD DSDS-BAI-TRANS-FILE                                           00579000
005800     RECORDING MODE F                                             00580000
005810     RECORD CONTAINS 100 CHARACTERS                               00581000
005820     BLOCK  CONTAINS   0 RECORDS                                  00582000
005830     LABEL RECORDS STANDARD                                       00583000
005840     DATA  RECORDS DSDS-BAI-OUT.                                  00584000
005850 01  DSDS-BAI-OUT.                                                00585000
005860     02  FILLER              PIC X(100).                          00586000
005870                                                                  00587000
005880 FD SHADOW-ACCOUNTS                                               00588000
005890     RECORDING MODE F                                             00589000
005900     RECORD CONTAINS 20 CHARACTERS                                00590000
005910     BLOCK  CONTAINS  0 RECORDS                                   00591000
005920     LABEL RECORDS ARE STANDARD                                   00592000
005930     DATA  RECORDS ARE SHADOW-ACCTS-OUT.                          00593000
005940 01  SHADOW-ACCTS-OUT        PIC X(20).                           00594000
005950                                                                  00595000
005960 FD NSF-ITEM-FILE-3                                               00596000
005970     RECORDING MODE F                                             00597000
005980     RECORD CONTAINS 225 CHARACTERS                               00598000
005990     BLOCK  CONTAINS   0 RECORDS                                  00599000
006000     LABEL RECORDS STANDARD                                       00600000
006010     DATA  RECORDS NSF-FILE-3.                                    00601000
006020 01  NSF-FILE-3.                                                  00602000
006030     02  FILLER              PIC X(225).                          00603000
006040                                                                  00604000
006050 FD  CHANGE-LOG-FILE                                              00605000
006060     RECORDING MODE F                                             00606000
006070     RECORD CONTAINS 80 CHARACTERS                                00607000
006080     BLOCK  CONTAINS  0 RECORDS                                   00608000
006090     LABEL RECORDS STANDARD                                       00609000
006100     DATA  RECORDS LOG-FILE-OUT.                                  00610000
006110 01  LOG-FILE-OUT.                                                00611000
006120     02  FILLER              PIC X(80).                           00612000
006130                                                                  00613000
006140 FD  DSDS-859-FILE                                                00614000
006150     RECORDING MODE F                                             00615000
006160     RECORD CONTAINS 300 CHARACTERS                               00616000
006170     BLOCK  CONTAINS  0 RECORDS                                   00617000
006180     LABEL RECORDS STANDARD                                       00618000
006190     DATA  RECORDS DSDS-859-RECORD.                               00619000
006200 01  DSDS-859-RECORD.                                             00620000
006210     02  FILLER              PIC X(300).                          00621000
006220                                                                  00622000
006230 FD  OSB-IRA-SUMMARY-FILE                                         00623000
006240     RECORDING MODE F                                             00624000
006250     RECORD CONTAINS 225 CHARACTERS                               00625000
006260     BLOCK  CONTAINS  0 RECORDS                                   00626000
006270     LABEL RECORDS STANDARD                                       00627000
006280     DATA  RECORDS OSB-IRA-RECORD.                                00628000
006290 01  OSB-IRA-RECORD.                                              00629000
006300     02  FILLER              PIC X(225).                          00630000
006310                                                                  00631000
006320 FD NSF-ITEM-FILE-4                                               00632000
006330     RECORDING MODE F                                             00633000
006340     RECORD CONTAINS 225 CHARACTERS                               00634000
006350     BLOCK  CONTAINS   0 RECORDS                                  00635000
006360     LABEL RECORDS STANDARD                                       00636000
006370     DATA  RECORDS NSF-FILE-4.                                    00637000
006380 01  NSF-FILE-4.                                                  00638000
006390     02  FILLER              PIC X(225).                          00639000
006400                                                                  00640000
006410 FD DEPOSIT-SCORE-FILE                                            00641000
006420     RECORDING MODE F                                             00642000
006430     RECORD CONTAINS 1400 CHARACTERS                              00643000
006440     BLOCK  CONTAINS  0 RECORDS                                   00644000
006450     LABEL RECORDS STANDARD                                       00645000
006460     DATA  RECORDS DEPOSIT-SCORE-REC.                             00646000
006470 01  DEPOSIT-SCORE-REC.                                           00647000
006480     02  FILLER              PIC X(1400).                         00648000
006490                                                                  00649000
006500 FD COLLAT-EXCEPT-FILE                                            00650000
006510     RECORDING MODE F                                             00651000
006520     RECORD CONTAINS 80 CHARACTERS                                00652000
006530     BLOCK  CONTAINS  0 RECORDS                                   00653000
006540     LABEL RECORDS STANDARD                                       00654000
006550     DATA  RECORDS COLLAT-EXCEPT-OUT.                             00655000
006560 01  COLLAT-EXCEPT-OUT.                                           00656000
006570     02  FILLER              PIC X(80).                           00657000
006580                                                                  00658000
006590 FD ML-HELOC-ADV-FILE                                             00659000
006600     RECORDING MODE F                                             00660000
006610     RECORD CONTAINS 80 CHARACTERS                                00661000
006620     BLOCK  CONTAINS  0 RECORDS                                   00662000
006630     LABEL RECORDS STANDARD                                       00663000
006640     DATA  RECORDS ML-HELOC-ADV-OUT.                              00664000
006650 01  ML-HELOC-ADV-OUT.                                            00665000
006660     02  FILLER              PIC X(80).                           00666000
006670                                                                  00667000
006680 FD  ACRS-TRAN-FILE                                               00668000
006690     RECORDING MODE F                                             00669000
006700     RECORD CONTAINS 500 CHARACTERS                               00670000
006710     BLOCK  CONTAINS  0 RECORDS                                   00671000
006720     LABEL RECORDS STANDARD                                       00672000
006730     DATA  RECORDS ACRS-TRAN-REC.                                 00673000
006740 01  ACRS-TRAN-REC.                                               00674000
006750     02  FILLER              PIC X(500).                          00675000
006760                                                                  00676000
006770 FD  CLSN-BR-TX-FILE                                              00677000
006780     RECORDING MODE F                                             00678000
006790     RECORD CONTAINS 110 CHARACTERS                               00679000
006800     BLOCK  CONTAINS  0 RECORDS                                   00680000
006810     LABEL RECORDS STANDARD                                       00681000
006820     DATA  RECORDS CLSN-BR-TX-FILE-OUT.                           00682000
006830 01  CLSN-BR-TX-FILE-OUT.                                         00683000
006840     02  FILLER              PIC X(110).                          00684000
006850                                                                  00685000
006860 FD  ICS-FA-TRAN-FILE                                             00686000
006870     RECORDING MODE F                                             00687000
006880     RECORD CONTAINS 100 CHARACTERS                               00688000
006890     BLOCK  CONTAINS  0 RECORDS                                   00689000
006900     LABEL RECORDS STANDARD                                       00690000
006910     DATA  RECORDS ICS-FA-TRAN-FILE-OUT.                          00691000
006920 01  ICS-FA-TRAN-FILE-OUT.                                        00692000
006930     02  FILLER              PIC X(100).                          00693000
006940                                                                  00694000
006950 WORKING-STORAGE SECTION.                                         00695000
006960 77  FILLER                  PIC X(16)   VALUE 'B-WSS-DSDS100   '.00696000
006970 77  GOT-HISTORY             PIC 9       VALUE ZERO      COMP-3.  00697000
006980 77  WK-EXIST                PIC S9      VALUE +0        COMP-3.  00698000
006990 77  PAGE-CNT                PIC S999    VALUE ZERO      COMP-3.  00699000
007000 77  LINE-CNT                PIC S999    VALUE ZERO      COMP-3.  00700000
007010 77  CTR-IMM                 PIC S9(03)  VALUE +0        COMP-3.  00701000
007020 77  BINARY-ONE              PIC S9999   VALUE +1     COMP SYNC.  00702000
007030 77  SEQ-NO-WK               PIC 9(9)    VALUE ZERO      COMP-3.  00703000
007040 77  UPDATE-MSTR             PIC S9(5)   VALUE ZERO      COMP-3.  00704000
007050 77  SEARCH-HIST             PIC S9(5)   VALUE ZERO      COMP-3.  00705000
007060 77  UPDATE-HIST             PIC S9(5)   VALUE ZERO      COMP-3.  00706000
007070 77  MSTR-CNT-WK             PIC 9(5)    VALUE ZERO      COMP-3.  00707000
007080*77  MT-16-SW                PIC 9       VALUE ZERO      COMP-3.  00708000
007090 77  SAVE-DR-SORT-KEY        PIC XX      VALUE SPACES.            00709000
007100 77  SAVE-CR-SORT-KEY        PIC XX      VALUE SPACES.            00710000
007110 77  SAVE-ENCL-SW            PIC 9       VALUE ZERO.              00711000
007120 77  SAVE-ENCL-SW-FOR-NIPS   PIC 9       VALUE ZERO.              00712000
007130 77  INSF-NOTICE-SW          PIC 9       VALUE ZERO      COMP-3.  00713000
007140 77  TYPE-TOT-SW             PIC 9       VALUE ZERO      COMP-3.  00714000
007150 77  X1                      PIC S9(4)   VALUE ZERO   COMP SYNC.  00715000
007160 77  X2                      PIC S9(4)   VALUE ZERO   COMP SYNC.  00716000
007170 77  X3                      PIC S9(4)   VALUE ZERO   COMP SYNC.  00717000
007180 77  X4                      PIC S9(4)   VALUE ZERO   COMP SYNC.  00718000
007190 77  CDCUT34-LENGTH          PIC S9(4)   VALUE ZERO   COMP SYNC.  00719000
007200 77  LENGTH-09               PIC S9(4)   VALUE +0009  COMP SYNC.  00720000
007210 77  LENGTH-24               PIC S9(4)   VALUE +0024  COMP SYNC.  00721000
007220 77  LENGTH-50               PIC S9(4)   VALUE +0050  COMP SYNC.  00722000
007230 77  LENGTH-90               PIC S9(4)   VALUE +0090  COMP SYNC.  00723000
007240 77  LENGTH-100              PIC S9(4)   VALUE +0100  COMP SYNC.  00724000
007250 77  MAST-OPEN-SW            PIC 9       VALUE ZERO      COMP-3.  00725000
007260 77  HIST-OPEN-SW            PIC 9       VALUE ZERO      COMP-3.  00726000
007270 77  COL-OPEN-SW             PIC 9       VALUE ZERO      COMP-3.  00727000
007280 77  AFFCHK-OPEN-SW          PIC 9       VALUE ZERO      COMP-3.  00728000
007290 77  AFFCHK-HIT-SW           PIC 9       VALUE ZERO      COMP-3.  00729000
007300 77  ZBA-HIT-SW              PIC 9       VALUE ZERO      COMP-3.  00730000
007310 77  SHADOW-OPEN-SW          PIC 9       VALUE ZERO      COMP-3.  00731000
007320 77  WITHHOLDING-PERCENT     PIC SV9(3)  VALUE ZEROS     COMP-3.  00732000
007330 77  AFS-OPEN-SW             PIC 9       VALUE ZERO      COMP-3.  00733000
007340 77  RBB-OPEN-SW             PIC 9       VALUE ZERO      COMP-3.  00734000
007350 77  NSF-FILE-1-SW           PIC 9       VALUE ZERO      COMP-3.  00735000
007360 77  NSF-FILE-3-SW           PIC 9       VALUE ZERO      COMP-3.  00736000
007370 77  NSF-FILE-4-SW           PIC 9       VALUE ZERO      COMP-3.  00737000
007380 77  NSF-ITEM-ACCT-TOT       PIC S9(9)V99 VALUE ZERO     COMP-3.  00738000
007390 77  INV-STMT-BAL-FILE-SW    PIC X       VALUE SPACE.             00739000
007400 77  HELOC-FIRST-TIME-SW     PIC X       VALUE SPACE.             00740000
007410 77  DATE-TYPE               PIC X       VALUE SPACE.             00741000
007420 77  NBR-OF-ENTRIES          PIC 9       VALUE ZERO      COMP-3.  00742000
007430 77  DSDM102-ACTION-CODE     PIC X       VALUE SPACE.             00743000
007440 77  DSDM103-ACTION-CODE     PIC X       VALUE SPACE.             00744000
007450 77  XSC-TX-CODE-WK          PIC 9(3)    VALUE 101       COMP-3.  00745000
007460 77  RPT-54-IND              PIC X       VALUE 'N'.               00746000
007470 77  CASH-MANAGEMENT-IND     PIC XXX     VALUE SPACES.            00747000
007480 77  WK-NUM-ENTRIES          PIC S999    VALUE ZERO      COMP-3.  00748000
007490 77  WK-CURR-BAL-12-MO       PIC S9(11)  VALUE ZERO      COMP-3.  00749000
007500 77  WK-COLL-BAL-12-MO       PIC S9(11)  VALUE ZERO      COMP-3.  00750000
007510 77  HOLD-XSC-IND-FOR-AA     PIC X       VALUE SPACES.            00751000
007520 77  HOLD-XSC-AMT-NUM-FOR-AA PIC X       VALUE SPACES.            00752000
007530 77  HOLD-DEBITS-FOR-AA      PIC S9(5)   VALUE ZERO      COMP-3.  00753000
007540 77  HOLD-CREDITS-FOR-AA     PIC S9(5)   VALUE ZERO      COMP-3.  00754000
007550 77  HOLD-ITEMS-FOR-AA       PIC S9(7)   VALUE ZERO      COMP-3.  00755000
007560 77  HOLD-LOC-ITEMS-FOR-AA   PIC S9(7)   VALUE ZERO      COMP-3.  00756000
007570 77  HOLD-DR-CR-ITM-FOR-AA   PIC S9(7)   VALUE ZERO      COMP-3.  00757000
007580 77  HOLD-REG-TELE-CR-ITM-FOR-AA                                  00758000
007590                             PIC S9(7)   VALUE ZERO      COMP-3.  00759000
007600 77  HOLD-XCESS-3P-L6-FOR-AA PIC S9(3)   VALUE ZERO      COMP-3.  00760000
007610 77  HOLD-ACH-DEB-FOR-AA     PIC S9(7)   VALUE ZERO      COMP-3.  00761000
007620 77  HOLD-ACH-CR-FOR-AA      PIC S9(7)   VALUE ZERO      COMP-3.  00762000
007630 77  HOLD-CR-ITM-FOR-AA      PIC S9(7)   VALUE ZERO      COMP-3.  00763000
007640 77  HOLD-REG-CR-FOR-AA      PIC S9(7)   VALUE ZERO      COMP-3.  00764000
007650 77  HOLD-ALL-DR-FOR-AA      PIC S9(7)   VALUE ZERO      COMP-3.  00765000
007660 77  HOLD-E-DEP-FOR-AA       PIC S9(7)   VALUE ZERO      COMP-3.  00766000
007670 77  HOLD-E-DEP-ITM-FOR-AA   PIC S9(7)   VALUE ZERO      COMP-3.  00767000
007680 77  HOLD-MBL-RDC-FOR-AA     PIC S9(7)   VALUE ZERO      COMP-3.  00768000
007690 77  HOLD-MBL-RDC-ITM-FOR-AA PIC S9(7)   VALUE ZERO      COMP-3.  00769000
007700 77  HOLD-ITM-DEP-FOR-AA     PIC S9(7)   VALUE ZERO      COMP-3.  00770000
007710 77  HOLD-ITM-DEP-ITM-FOR-AA PIC S9(7)   VALUE ZERO      COMP-3.  00771000
007720 77  HOLD-TOT-289-FOR-AA     PIC S9(7)   VALUE ZERO      COMP-3.  00772000
007730 77  HOLD-TOT-290-ITM-FOR-AA PIC S9(7)   VALUE ZERO      COMP-3.  00773000
007740 77  HOLD-XCESS-3P           PIC S9(3)   VALUE ZERO      COMP-3.  00774000
007750 77  HOLD-XCESS-L6           PIC S9(3)   VALUE ZERO      COMP-3.  00775000
007760 77  ACCT-NBR-COUNT          PIC S9(09)  VALUE ZERO      COMP-3.  00776000
007770 77  DELETE-COUNT            PIC 9(9)    VALUE ZERO.              00777000
007780 77  NULL-INDICATOR          PIC S9(4)   VALUE +0    COMP.        00778000
007790 77  CDC-TIMESTAMP           PIC X(26)   VALUE SPACES.            00779000
007800 77  COUNT-1                 PIC 9(5)    VALUE ZERO      COMP-3.  00780000
007810 77  COUNT-2                 PIC 9(5)    VALUE ZERO      COMP-3.  00781000
007820 77  COUNT-3                 PIC 9(5)    VALUE ZERO      COMP-3.  00782000
007830 77  COUNT-4                 PIC 9(5)    VALUE ZERO      COMP-3.  00783000
007840 77  HOLD-OLD-STAT-2X        PIC X(2)    VALUE SPACES.            00784000
007850 77  HOLD-NEW-STAT-2X        PIC X(2)    VALUE SPACES.            00785000
007860 77  HOLD-OLD-SC-DISP        PIC 9       VALUE ZEROS.             00786000
007870 77  HOLD-NEW-SC-DISP        PIC 9       VALUE ZEROS.             00787000
007880 77  HOLD-OLD-EARN-DISP      PIC X       VALUE ZEROS.             00788000
007890 77  HOLD-NEW-EARN-DISP      PIC X       VALUE ZEROS.             00789000
007900 77  HOLD-OLD-INV-STAT       PIC X(2)    VALUE SPACES.            00790000
007910 77  HOLD-NEW-INV-STAT       PIC X(2)    VALUE SPACES.            00791000
007920 77  HOLD-OLD-ODB-STAT       PIC X(2)    VALUE SPACES.            00792000
007930 77  HOLD-NEW-ODB-STAT       PIC X(2)    VALUE SPACES.            00793000
007940 77  HOLD-OLD-ACCESS-CODE    PIC X(2)    VALUE SPACES.            00794000
007950 77  HOLD-NEW-ACCESS-CODE    PIC X(2)    VALUE SPACES.            00795000
007960 77  HOLD-OLD-ACCESS-LIMIT   PIC S9(5)   VALUE ZEROS     COMP-3.  00796000
007970 77  HOLD-NEW-ACCESS-LIMIT   PIC S9(5)   VALUE ZEROS     COMP-3.  00797000
007980 77  HOLD-OLD-STMT-CYCLE     PIC S9(3)   VALUE ZEROS     COMP-3.  00798000
007990 77  HOLD-NEW-STMT-CYCLE     PIC S9(3)   VALUE ZEROS     COMP-3.  00799000
008000 77  HOLD-OLD-SC-EARN-CYC    PIC S9(3)   VALUE ZEROS     COMP-3.  00800000
008010 77  HOLD-NEW-SC-EARN-CYC    PIC S9(3)   VALUE ZEROS     COMP-3.  00801000
008020 77  HOLD-OLD-STMT-DISP-CODE PIC X       VALUE SPACES.            00802000
008030 77  HOLD-NEW-STMT-DISP-CODE PIC X       VALUE SPACES.            00803000
008040 77  HOLD-OLD-INV-TERM       PIC S9(5)   VALUE ZEROS     COMP-3.  00804000
008050 77  HOLD-NEW-INV-TERM       PIC S9(5)   VALUE ZEROS     COMP-3.  00805000
008060 77  HOLD-OLD-INV-MAT-DATE   PIC X(10)   VALUE SPACES.            00806000
008070 77  HOLD-NEW-INV-MAT-DATE   PIC X(10)   VALUE SPACES.            00807000
008080 77  HOLD-OLD-INV-NEXT-TERM  PIC S9(5)   VALUE ZEROS     COMP-3.  00808000
008090 77  HOLD-NEW-INV-NEXT-TERM  PIC S9(5)   VALUE ZEROS     COMP-3.  00809000
008100 77  HOLD-OLD-INV-NEXT-MAT-DATE                                   00810000
008110                             PIC X(10)     VALUE SPACES.          00811000
008120 77  HOLD-NEW-INV-NEXT-MAT-DATE                                   00812000
008130                             PIC X(10)     VALUE SPACES.          00813000
008140 77  HOLD-OLD-CUST-ACT-DATE  PIC S9(07)    VALUE ZEROS   COMP-3.  00814000
008150 77  HOLD-NEW-CUST-ACT-DATE  PIC S9(07)    VALUE ZEROS   COMP-3.  00815000
008160 77  HOLD-OLD-ACCT-TYPE      PIC X(03)     VALUE SPACES.          00816000
008170 77  HOLD-NEW-ACCT-TYPE      PIC X(03)     VALUE SPACES.          00817000
008180 77  HOLD-OLD-BR-CLSN-TIED   PIC S9(11)    VALUE ZEROS   COMP-3.  00818000
008190 77  HOLD-NEW-BR-CLSN-TIED   PIC S9(11)    VALUE ZEROS   COMP-3.  00819000
008200 77  HOLD-EXTRACT-IND        PIC X         VALUE SPACE.           00820000
008210 77  BEGINNING-ESCHEAT-DATE  PIC S9(08)    VALUE ZEROS     COMP-3.00821000
008220 77  ESCHEAT-WORK-DATE       PIC S9(08)    VALUE ZEROS     COMP-3.00822000
008230 77  INV-COLL-ONLY-IND       PIC X         VALUE 'N'.             00823000
008240 77  SAC-HIT-SW              PIC X         VALUE 'N'.             00824000
008250 77  HOLD-SAC-BALANCE        PIC S9(09)V99 VALUE ZEROS   COMP-3.  00825000
008260 77  POSTING-SAC-OFFSET      PIC X         VALUE 'N'.             00826000
008270 77  WORK-ENTRY-DATE         PIC X(10)     VALUE SPACES.          00827000
008280 77  TALLY-CNT               PIC 9(03)     VALUE ZEROES COMP-3.   00828000
008290 77  WORK-CURR-DAYS-OD       PIC 9(05)     VALUE ZEROES COMP-3.   00829000
008300 77  WORK-6MONTHS-AGO        PIC 9(07)     VALUE ZEROES COMP-3.   00830000
008310 77  NUM-MONTHS              PIC S9(05)    VALUE ZEROES COMP-3.   00831000
008320 77  NUM-DAYS                PIC S9(05)    VALUE ZEROES COMP-3.   00832000
008330 77  WORK-7DAYS-AGO          PIC 9(07)     VALUE ZEROES COMP-3.   00833000
008340 77  WORK-DAYS-2-CHG         PIC 9(03)     VALUE ZEROES COMP-3.   00834000
008350 77  ACCR-DIFF               PIC S9(05)V99 VALUE ZEROES COMP-3.   00835000
008360 77  WORK-INT-RATE           PIC SV9(07)   VALUE ZEROES COMP-3.   00836000
008370 77  TIS-GRS-BAL-WORK        PIC S9(11)    VALUE ZEROES COMP-3.   00837000
008380 77  E-ITEMS-NSF             PIC S9(03)    VALUE ZEROES COMP-3.   00838000
008390 77  WORK-FDIC-FEE           PIC S9(09)V99 VALUE ZEROS   COMP-3.  00839000
008400 77  ACCUM-AMT-LAST-DEP      PIC S9(09)V99 VALUE ZEROS  COMP-3.   00840000
008410 77  WORK-OD-FEE             PIC S9(03)V99 VALUE ZEROS   COMP-3.  00841000
008420 77  WORK-RET-CHECK-CHRG     PIC S9(03)V99 VALUE ZEROS   COMP-3.  00842000
008430 77  WORK-OD-LIMIT-PER-DAY   PIC S9(03)    VALUE ZEROS   COMP-3.  00843000
008440 77  WORK-OD-LIMIT           PIC S9(09)V99 VALUE ZEROS   COMP-3.  00844000
008450 77  WORK-OD-MIN-TX-AMT      PIC S9(09)V99 VALUE ZEROS   COMP-3.  00845000
008460 77  WORK-OD-COUNTER         PIC S9(03)    VALUE ZEROS   COMP-3.  00846000
008470 77  ML02003-SW              PIC X         VALUE 'N'.             00847000
008480 77  CC-TRANSFER-SW          PIC X         VALUE 'N'.             00848000
008490 77  HOLD-MONTHLY-ACCUM-INT  PIC S9(05)V99 VALUE ZEROES  COMP-3.  00849000
008500 77  WORK-ODB-LOAN-BAL       PIC S9(09)V99 VALUE ZEROS   COMP-3.  00850000
008510 77  WORK-JUL-NXT-PROCESS    PIC S9(07)    VALUE ZEROS   COMP-3.  00851000
008520 77  WORK-DB2-DATE           PIC X(10)     VALUE SPACES.          00852000
008530 77  WORK-DROP-DIFF          PIC S9(09)V99999 VALUE ZEROS  COMP-3.00853000
008540 77  CD-LST-ACT-DT-JUL       PIC S9(7)     VALUE ZEROS     COMP-3.00854000
008550 77  HOLD-SOURCE-USER-NUM    PIC 9(5)      VALUE ZEROS.           00855000
008560******************************************************************00856000
008570*        M A S T E R   R D A M   W O R K   A R E A S             *00857000
008580*                                                                *00858000
008590******************************************************************00859000
008600 01  FILLER                  PIC X(16)   VALUE 'MASTER DATA LIST'.00860000
008610     COPY DSDSMAST.                                               00861000
008620                                                                  00862000
008630 01  FILLER                  PIC X(16)   VALUE 'MASTER CTL LIST'. 00863000
008640     COPY DSDSMCTL.                                               00864000
008650                                                                  00865000
008660 01  FILLER                  PIC X(16)   VALUE 'HIST DATA LIST'.  00866000
008670     COPY DSDSHIST.                                               00867000
008680                                                                  00868000
008690 01  FILLER                  PIC X(16)   VALUE 'TRANSACTION WORK'.00869000
008700*01  DSDS-TRANSACTION-LONG.                                       00870000
008710     COPY DSDSTXL.                                                00871000
008720                                                                  00872000
008730*01  IO-PARAMETERS.                                               00873000
008740     COPY IOPARMS.                                                00874000
008750                                                                  00875000
008760 01  FILLER                  PIC X(16)   VALUE 'TRANSACTION SAVE'.00876000
008770 01  SAVE-DSDS-TRANSACTION-LONG                                   00877000
008780                             PIC X(200)  VALUE SPACES.            00878000
008790                                                                  00879000
008800 01  FILLER                  PIC X(16)   VALUE 'COLLAT-RECORD'.   00880000
008810 01  DSDS-COLLATERAL-RECORD.                                      00881000
008820     COPY DSDRCOLL.                                               00882000
008830                                                                  00883000
008840 01  FILLER                  PIC X(16)   VALUE 'COLLAT-EXCPT-REC'.00884000
008850*01  COLLATERAL-EXCEPTION-RECORD.                                 00885000
008860     COPY DSDSCOLE.                                               00886000
008870                                                                  00887000
008880 01  FILLER                  PIC X(16)   VALUE 'DSDSMLH         '.00888000
008890*01  ML-HELOC-ADVANCE-RECORD.                                     00889000
008900     COPY DSDSMLH.                                                00890000
008910                                                                  00891000
008920 01  FILLER                  PIC X(16)   VALUE 'ACRSTRAN        '.00892000
008930 01  ACRS-DSDS-FILE-LAYOUT.                                       00893000
008940     COPY ACRSTRAN.                                               00894000
008950                                                                  00895000
008960 01  FILLER                  PIC X(16)   VALUE 'DSDM050P        '.00896000
008970 01  DSDM050P-PARAMETERS.                                         00897000
008980     COPY DSDM050P.                                               00898000
008990                                                                  00899000
009000 01  FILLER                  PIC X(16)   VALUE 'STOCK PAPER WORK'.00900000
009010 01  STOCK-WORK.                                                  00901000
009020     02  FILLER              PIC X(200).                          00902000
009030 01  SP-CTL               REDEFINES STOCK-WORK.                   00903000
009040     COPY DSDR3CTL.                                               00904000
009050 01  SP-07                REDEFINES STOCK-WORK.                   00905000
009060     COPY DSDR307.                                                00906000
009070 01  SP-26                REDEFINES STOCK-WORK.                   00907000
009080     COPY DSDR326.                                                00908000
009090 01  SP-55                REDEFINES STOCK-WORK.                   00909000
009100     COPY DSDR355.                                                00910000
009110                                                                  00911000
009120 01  DSDS859-REPORT-RECORD.                                       00912000
009130     COPY DSDR859P.                                               00913000
009140                                                                  00914000
009150 01  IRA-OSB-STMT-SUMMARY.                                        00915000
009160     COPY IRAOSBST.                                               00916000
009170                                                                  00917000
009180*01  CIFU010-PARAMETERS.                                          00918000
009190     COPY CIFU010P.                                               00919000
009200                                                                  00920000
009210 01  FILLER                  PIC X(16)   VALUE 'SPEC FORMS WORK'. 00921000
009220 01  SPECIAL-WORK.                                                00922000
009230     02  FILLER              PIC X(150).                          00923000
009240 01  SF-CTL               REDEFINES SPECIAL-WORK.                 00924000
009250     COPY DSDR2CTL.                                               00925000
009260 01  SF-86                REDEFINES SPECIAL-WORK.                 00926000
009270     COPY DSDR286.                                                00927000
009280 01  SF-87                REDEFINES SPECIAL-WORK.                 00928000
009290     COPY DSDR287.                                                00929000
009300 01  SF-91                REDEFINES SPECIAL-WORK.                 00930000
009310     COPY DSDR291.                                                00931000
009320 01  SF-92                REDEFINES SPECIAL-WORK.                 00932000
009330     COPY DSDR292.                                                00933000
009340 01  SF-93                REDEFINES SPECIAL-WORK.                 00934000
009350     COPY DSDR293.                                                00935000
009360 01  SF-94                REDEFINES SPECIAL-WORK.                 00936000
009370     COPY DSDR294.                                                00937000
009380 01  SF-97                REDEFINES SPECIAL-WORK.                 00938000
009390     COPY DSDR297.                                                00939000
009400 01  SF-98                REDEFINES SPECIAL-WORK.                 00940000
009410     COPY DSDR298.                                                00941000
009420                                                                  00942000
009430 01  FILLER                  PIC X(16)   VALUE 'POSTED DTL WORK'. 00943000
009440 01  POSTED-WORK.                                                 00944000
009450     02  FILLER              PIC X(225).                          00945000
009460 01  PD-PDC               REDEFINES POSTED-WORK.                  00946000
009470     COPY DSDSPDC.                                                00947000
009480 01  PD-PDR               REDEFINES POSTED-WORK.                  00948000
009490     COPY DSDSPDTX.                                               00949000
009500 01  PD-SCH               REDEFINES POSTED-WORK.                  00950000
009510     COPY DSDSSCH.                                                00951000
009520 01  PD-PDH               REDEFINES POSTED-WORK.                  00952000
009530     COPY DSDSPDH.                                                00953000
009540 01  PD-OSH               REDEFINES POSTED-WORK.                  00954000
009550     COPY DSDSOSH.                                                00955000
009560 01  PD-HCH               REDEFINES POSTED-WORK.                  00956000
009570     COPY DSDSHCH.                                                00957000
009580 01  PD-SCT               REDEFINES POSTED-WORK.                  00958000
009590     COPY DSDSSCT.                                                00959000
009600 01  PD-PDT               REDEFINES POSTED-WORK.                  00960000
009610     COPY DSDSPDT.                                                00961000
009620 01  PD-ODH               REDEFINES POSTED-WORK.                  00962000
009630     COPY DSDSODH.                                                00963000
009640 01  PD-NAH               REDEFINES POSTED-WORK.                  00964000
009650     COPY DSDSNAH.                                                00965000
009660 01  PD-ODT               REDEFINES POSTED-WORK.                  00966000
009670     COPY DSDSODT.                                                00967000
009680 01  PD-IAT               REDEFINES POSTED-WORK.                  00968000
009690     COPY DSDSIAT.                                                00969000
009700                                                                  00970000
009710 01  FILLER                  PIC X(16)   VALUE 'OBS TRANS WORK'.  00971000
009720 01  ONLINE-BULK-SORT-ENCLOSURES.                                 00972000
009730     COPY OBSTRANS.                                               00973000
009740                                                                  00974000
009750 01  FILLER                  PIC X(16)   VALUE 'CIFU521P'.        00975000
009760*01  CIFU521-PARAMETERS.                                          00976000
009770     COPY CIFU521P.                                               00977000
009780                                                                  00978000
009790 01  FILLER                  PIC X(16)   VALUE 'CIFU521W'.        00979000
009800*01  CIFU521W-WORK-AREA.                                          00980000
009810     COPY CIFU521W.                                               00981000
009820                                                                  00982000
009830 01  FILLER                  PIC X(16)   VALUE 'PROCESS CTL WORK'.00983000
009840 01  PROCESS-WORK.                                                00984000
009850     COPY DSDSPRCF.                                               00985000
009860                                                                  00986000
009870 01  FILLER                  PIC X(16)   VALUE 'NSF ITEM FILE 1'. 00987000
009880 01  NSF-FILE-1-WORK.                                             00988000
009890     COPY DSDNIP1.                                                00989000
009900                                                                  00990000
009910 01  UNPOSTED-REASON-TABLE.                                       00991000
009920     02  UI-ITEMS.                                                00992000
009930         03  UPI-01          PIC X(11)   VALUE 'N.S.F.     '.     00993000
009940         03  UPI-02          PIC X(11)   VALUE 'HOLD       '.     00994000
009950         03  UPI-03          PIC X(11)   VALUE 'GRNSH/LEVY '.     00995000
009960         03  UPI-04          PIC X(11)   VALUE 'DECEASED   '.     00996000
009970         03  UPI-05          PIC X(11)   VALUE 'CLOSED     '.     00997000
009980         03  UPI-06          PIC X(11)   VALUE 'SCHK STALE '.     00998000
009990         03  UPI-07          PIC X(11)   VALUE 'UNLOCATED  '.     00999000
010000         03  UPI-08          PIC X(11)   VALUE 'DORMANT    '.     01000000
010010         03  UPI-09          PIC X(11)   VALUE 'POS EXCEPT '.     01001000
010020         03  UPI-10          PIC X(11)   VALUE 'INVALID TX.'.     01002000
010030         03  UPI-11          PIC X(11)   VALUE 'SCHK STOPAY'.     01003000
010040         03  UPI-12          PIC X(11)   VALUE 'RESTRICTED '.     01004000
010050         03  UPI-13          PIC X(11)   VALUE 'NSF ACR INT'.     01005000
010060         03  UPI-14          PIC X(11)   VALUE 'INV-UNLOC  '.     01006000
010070         03  UPI-15          PIC X(11)   VALUE 'ODB-UNLOC  '.     01007000
010080         03  UPI-16          PIC X(11)   VALUE 'ODB-CLOSED '.     01008000
010090         03  UPI-17          PIC X(11)   VALUE 'ODB-INV TX '.     01009000
010100         03  UPI-18          PIC X(11)   VALUE 'ODB-PAY BIG'.     01010000
010110         03  UPI-19          PIC X(11)   VALUE 'ODB-OVER LN'.     01011000
010120         03  UPI-20          PIC X(11)   VALUE 'SCHK NO REC'.     01012000
010130         03  UPI-21          PIC X(11)   VALUE 'SCHK PAID  '.     01013000
010140         03  UPI-22          PIC X(11)   VALUE 'ACT.HAS.INV'.     01014000
010150         03  UPI-23          PIC X(11)   VALUE 'RESTRCT PCO'.     01015000
010160         03  UPI-24          PIC X(11)   VALUE 'RESTRCT PDO'.     01016000
010170         03  UPI-25          PIC X(11)   VALUE 'INV-NSF INT'.     01017000
010180         03  UPI-26          PIC X(11)   VALUE 'SCHK VOIDED'.     01018000
010190         03  UPI-27          PIC X(11)   VALUE 'STOP PAY   '.     01019000
010200         03  UPI-28          PIC X(11)   VALUE 'ACT.HAS.ODB'.     01020000
010210         03  UPI-29          PIC X(11)   VALUE 'CLOS.AMT.SM'.     01021000
010220         03  UPI-30          PIC X(11)   VALUE 'CLOS.AMT.LG'.     01022000
010230         03  UPI-31          PIC X(11)   VALUE 'COURT RSTRC'.     01023000
010240         03  UPI-32          PIC X(11)   VALUE 'SCHK NO SER'.     01024000
010250         03  UPI-33          PIC X(11)   VALUE 'SCHK AMOUNT'.     01025000
010260         03  UPI-34          PIC X(11)   VALUE 'RESTRCT ACH'.     01026000
010270         03  UPI-35          PIC X(11)   VALUE 'RESTRCT PPD'.     01027000
010280         03  UPI-36          PIC X(11)   VALUE 'SCHK HI $$$'.     01028000
010290         03  UPI-37          PIC X(11)   VALUE 'OA NSF PD  '.     01029000
010300         03  UPI-38          PIC X(11)   VALUE 'SCHK E-CK  '.     01030000
010310         03  UPI-39          PIC X(11)   VALUE 'RESTRCT SEC'.     01031000
010320         03  UPI-40          PIC X(11)   VALUE 'SCHK DUPL  '.     01032000
010330         03  UPI-41          PIC X(11)   VALUE 'SCHK N.S.F.'.     01033000
010340         03  UPI-42          PIC X(11)   VALUE 'DORM/DECEAS'.     01034000
010350     02  FILLER REDEFINES UI-ITEMS.                               01035000
010360         03  REASON          PIC X(11)   OCCURS 42 TIMES.         01036000
010370                                                                  01037000
010380 01  FILLER                  PIC X(16)   VALUE 'NSF ITEM FILE 2'. 01038000
010390 01  NSF-FILE-2-WORK.                                             01039000
010400     COPY DSDNIP2.                                                01040000
010410                                                                  01041000
010420 01  NSF-FILE-3-WORK.                                             01042000
010430     COPY DSDNIP3.                                                01043000
010440                                                                  01044000
010450 01  FILLER                  PIC X(16)  VALUE 'DSDNIP4       '.   01045000
010460 01  NSF-FILE-4-WORK.                                             01046000
010470     COPY DSDNIP4.                                                01047000
010480                                                                  01048000
010490 01  FILLER                  PIC X(16)   VALUE 'DSDSOAF3        '.01049000
010500*01  OVERDRAWN-ACCOUNTS-FILE3.                                    01050000
010510     COPY DSDSOAF3.                                               01051000
010520                                                                  01052000
010530 01  AA-FILEREC.                                                  01053000
010540     COPY AAFILES.                                                01054000
010550                                                                  01055000
010560 01  FILLER                  PIC X(16)  VALUE 'ML02003P'.         01056000
010570*01  ML02003-LINK-PARAMTERS.                                      01057000
010580     COPY ML02003P.                                               01058000
010590                                                                  01059000
010600 01  FILLER                  PIC X(16)   VALUE 'CASH MGMT COLLAT'.01060000
010610 01  CASH-MGMT-COLLAT-WORK.                                       01061000
010620     02  CMC-DATE            PIC 9(6).                            01062000
010630     02  CMC-BANK-NO         PIC 9(3).                            01063000
010640     02  CMC-ACCT-ID         PIC 9(3).                            01064000
010650     02  CMC-ACCT-NO         PIC 9(9).                            01065000
010660     02  CMC-RECORD-TYPE     PIC X.                               01066000
010670     02  CMC-INV-PLAN        PIC XX.                              01067000
010680     02  CMC-MARKET-VALUE    PIC S9(9)V99.                        01068000
010690     02  CMC-RATE-EARNED     PIC SV9(7).                          01069000
010700     02  CMC-INT-EARNED      PIC Z(7)9.9(5).                      01070000
010710     02  CMC-MATURE-DATE     PIC 9(6).                            01071000
010720     02  CMC-PAR-VALUE       PIC Z,ZZZ,ZZ9.                       01072000
010730     02  CMC-FILLER          PIC X(2).                            01073000
010740     02  CMC-CUSIP           PIC X(8).                            01074000
010750     02  CMC-COLLAT-DESC     PIC X(20).                           01075000
010760     02  CMC-END-CHARACTER   PIC X.                               01076000
010770                                                                  01077000
010780 01  FILLER                  PIC X(16)   VALUE 'MCF HEADER WORK'. 01078000
010790 01  MCF-HEADER-WORK.                                             01079000
010800     02  MCF-HDR-TYPE        PIC 9       VALUE 1.                 01080000
010810     02  MCF-HDR-FILE-TYPE   PIC X(5)    VALUE 'IMAGE'.           01081000
010820     02  MCF-HDR-REMOTE-NBR  PIC 9(4).                            01082000
010830     02  MCF-HDR-ABA-NBR     PIC 9(8).                            01083000
010840     02  MCF-HDR-CSPM        PIC X(8).                            01084000
010850     02  MCF-HDR-CSGN.                                            01085000
010860         03  MCF-HDR-CSGN-BK PIC 9(6).                            01086000
010870         03  MCF-HDR-CSGN-CYC                                     01087000
010880                             PIC 99.                              01088000
010890     02  MCF-HDR-CSPTD       PIC X(8)    VALUE SPACES.            01089000
010900     02  MCF-HDR-CIT         PIC X       VALUE 'F'.               01090000
010910     02  MCF-HDR-FILLER      PIC X(37)   VALUE SPACES.            01091000
010920                                                                  01092000
010930 01  MCF-TRANSIT-ROUTING-WORK.                                    01093000
010940     02  TRANSIT-ROUTING-WK  PIC 9(9).                            01094000
010950     02  FILLER REDEFINES TRANSIT-ROUTING-WK.                     01095000
010960         03  TRANS-ROUT-WK   PIC 9(8).                            01096000
010970         03  FILLER          PIC X.                               01097000
010980                                                                  01098000
010990 01  BALANCE-ADJ-WORK.                                            01099000
011000     02  BAW-BANK-NO         PIC 99.                              01100000
011010     02  BAW-CLASS-PLAN      PIC X(3).                            01101000
011020     02  BAW-DEBIT-AMT       PIC S9(9)V99                COMP-3.  01102000
011030     02  BAW-CREDIT-AMT      PIC S9(9)V99                COMP-3.  01103000
011040                                                                  01104000
011050 01  BALANCE-ADJ-TABLE.                                           01105000
011060     02  BAL-ADJ-BK-INFO     OCCURS 99 TIMES.                     01106000
011070         03  BAL-ADJ-INFO    OCCURS 15 TIMES.                     01107000
011080             04  BAT-CLASS-PLAN                                   01108000
011090                             PIC XXX.                             01109000
011100             04  BAT-DEBIT-AMT                                    01110000
011110                             PIC S9(9)V99                COMP-3.  01111000
011120             04  BAT-CREDIT-AMT                                   01112000
011130                             PIC S9(9)V99                COMP-3.  01113000
011140                                                                  01114000
011150 01  FILLER                  PIC X(16)   VALUE 'SCHK PAID FILE '. 01115000
011160 01  SURE-CHECK-PAID-WORK.                                        01116000
011170     02  SCP-BANK-NBR        PIC 999.                             01117000
011180     02  SCP-COMPANY-NBR     PIC 999.                             01118000
011190     02  SCP-ACCOUNT-NBR     PIC 9(9).                            01119000
011200     02  SCP-SERIAL-NBR      PIC 9(9).                            01120000
011210     02  SCP-CHECK-AMT       PIC 9(9)V99.                         01121000
011220     02  SCP-DATE-PAID       PIC 9(8).                            01122000
011230     02  SCP-DISPOSITION     PIC X.                               01123000
011240     02  SCP-FILLER          PIC X(36)   VALUE SPACES.            01124000
011250                                                                  01125000
011260     COPY DSDSBAI.                                                01126000
011270                                                                  01127000
011280 01  SHADOW-ACCT-WORK.                                            01128000
011290     02  SAW-BANK-NBR        PIC 99.                              01129000
011300     02  SAW-ACCT-ID         PIC 9(3)                  COMP-3.    01130000
011310     02  SAW-ACCT-NBR        PIC 9(9)                  COMP-3.    01131000
011320     02  SAW-ACCT-CLASS      PIC X(3).                            01132000
011330     02  SAW-ACCT-STATUS     PIC X.                               01133000
011340     02  SAW-OWNER-CODE      PIC X.                               01134000
011350     02  SAW-CURR-BAL        PIC S9(9)V99              COMP-3.    01135000
011360                                                                  01136000
011370 01  OSB-SUMMARY-WORK.                                            01137000
011380     COPY DSDSUMM.                                                01138000
011390                                                                  01139000
011400 01  DSD-SC-MODULE.                                               01140000
011410     02  FILLER              PIC X(4)    VALUE 'DDSC'.            01141000
011420     02  DSD-SC-MOD-BK-NO    PIC 99.                              01142000
011430     02  FILLER              PIC XX      VALUE SPACES.            01143000
011440                                                                  01144000
011450 01  DSS-SC-MODULE.                                               01145000
011460     02  FILLER              PIC X(4)    VALUE 'DSSC'.            01146000
011470     02  DSS-SC-MOD-BK-NO    PIC 99.                              01147000
011480     02  FILLER              PIC XX      VALUE SPACES.            01148000
011490                                                                  01149000
011500 01  DSD-EARN-MODULE.                                             01150000
011510     02  FILLER              PIC X(5)    VALUE 'DDERN'.           01151000
011520     02  DSD-EARN-MOD-BK-NO  PIC 99.                              01152000
011530     02  FILLER              PIC X       VALUE SPACES.            01153000
011540                                                                  01154000
011550 01  DSS-EARN-MODULE.                                             01155000
011560     02  FILLER              PIC X(5)    VALUE 'DSERN'.           01156000
011570     02  DSS-EARN-MOD-BK-NO  PIC 99.                              01157000
011580     02  FILLER              PIC X       VALUE SPACES.            01158000
011590                                                                  01159000
011600 01  OTHER-BUSINESS-WORK-AREA.                                    01160000
011610     02  OTHBS-BANK-NBR      PIC 999     VALUE ZERO      COMP-3.  01161000
011620     02  OTHBS-FILE-ID       PIC X(4)    VALUE 'DDA'.             01162000
011630     02  OTHBS-REC-KEY       PIC X(25)   VALUE SPACES.            01163000
011640     02  OTHBS-RETURN-CODE   PIC X       VALUE SPACE.             01164000
011650                                                                  01165000
011660 01  OFFICER-NUMBER-WORK-AREA.                                    01166000
011670     02  OFFICER-NUMBER-WORK PIC 9(5)    VALUE ZERO.              01167000
011680     02  FILLER REDEFINES OFFICER-NUMBER-WORK.                    01168000
011690         03  FILLER          PIC XX.                              01169000
011700         03  OFF-NUM-WK      PIC XXX.                             01170000
011710                                                                  01171000
011720 01  ACCT-KEY-WORK-AREA.                                          01172000
011730     02  ACCT-KEY-WORK.                                           01173000
011740         03  AKW-ACCT-NBR    PIC 9(9).                            01174000
011750         03  AKW-ACCT-ID     PIC 999     VALUE 001.               01175000
011760     02  AKW-REC-ID.                                              01176000
011770         03  AKW-REC-ID-ACCT-NBR                                  01177000
011780                             PIC 9(9)                    COMP-3.  01178000
011790         03  FILLER          PIC X(15).                           01179000
011800                                                                  01180000
011810 01  RDS-REPORT-PARAMETER-TABLE.                                  01181000
011820     COPY RDSTABLE.                                               01182000
011830                                                                  01183000
011840 01  FILLER                  PIC X(16)   VALUE 'RPT TABLE WORK'.  01184000
011850 01  REPORT-TABLE-WORK.                                           01185000
011860     02  RPT-PARM-TABLE-WK.                                       01186000
011870         03  SORT-CODE-WK    PIC X.                               01187000
011880             88  NUMERIC-RPT-WK          VALUE '0'.               01188000
011890             88  ALPHA-RPT-WK            VALUE '1'.               01189000
011900         03  SELECT-FIELD-WK PIC X.                               01190000
011910             88  SEL-ACCT-ID-WK          VALUE 'A'.               01191000
011920             88  SEL-OFFICER-WK          VALUE 'O'.               01192000
011930             88  SEL-TYPE-WK             VALUE 'T'.               01193000
011940             88  SEL-NONE-WK             VALUE ' '.               01194000
011950             88  SEL-SERV-CHG-WK         VALUE 'S'.               01195000
011960             88  SEL-BALANCE-WK          VALUE 'B'.               01196000
011970             88  SEL-SC-RTN-WK           VALUE 'R'.               01197000
011980         03  SELECT-CRITERIA-WK                                   01198000
011990                             PIC X(20).                           01199000
012000         03  REPORT-PROCESS-SW-WK                                 01200000
012010                             PIC X.                               01201000
012020             88  DONT-PROCESS-RPT-WK     VALUE ' '.               01202000
012030             88  DO-PROCESS-RPT-WK       VALUE '1' '3'.           01203000
012040             88  PARM-ERROR-WK           VALUE '2'.               01204000
012050             88  PROCESS-WITH-SELECT-WK  VALUE '3'.               01205000
012060                                                                  01206000
012070 01  FILLER                  PIC X(16)   VALUE 'VSAM FILE STATUS'.01207000
012080 01  VSAM-FILE-STATUS-CODES.                                      01208000
012090     COPY VSAMSTAT.                                               01209000
012100                                                                  01210000
012110 01  FILLER                  PIC X(16)   VALUE 'REL BALANCE WORK'.01211000
012120 01  RBB-ACTION-CODE         PIC X.                               01212000
012130 01  RBB-ACTION-DATE         PIC 9(7)                    COMP-3.  01213000
012140 01  RELATIONSHIP-BANKING-BALANCES.                               01214000
012150     COPY DSDRRBB.                                                01215000
012160 01  RBB-RETURN-CODE         PIC X.                               01216000
012170                                                                  01217000
012180 01  FILLER                  PIC X(16)   VALUE 'ACCT-RECON-WORK'. 01218000
012190 01  ACCT-RECON-WORK.                                             01219000
012200     02  AR-BANK-NO          PIC 99.                              01220000
012210     02  AR-ACCT-NO          PIC 9(9)                    COMP-3.  01221000
012220     02  AR-SERIAL-NO        PIC 9(9)                    COMP-3.  01222000
012230     02  AR-DATE-PD          PIC 9(7)                    COMP-3.  01223000
012240     02  AR-CHK-AMT          PIC S9(9)V99                COMP-3.  01224000
012250     02  AR-BAT-NO           PIC 9(5)                    COMP-3.  01225000
012260     02  AR-SEQ-NO           PIC 9(5)                    COMP-3.  01226000
012270     02  AR-DISPOSITION      PIC X.                               01227000
012280     02  AR-ACH-CLASS        PIC X(3).                            01228000
012290     02  AR-FILLER           PIC X(18).                           01229000
012300                                                                  01230000
012310 01  PENDING-TRANS-WORK-AREA.                                     01231000
012320     02  PTW-TX-DESC-WK.                                          01232000
012330         03  PTW-TX-DESC     PIC X(16).                           01233000
012340         03  FILLER          PIC X       VALUE SPACE.             01234000
012350         03  PTW-ODB-ACCT-NO PIC Z(9).                            01235000
012360                                                                  01236000
012370 01  HOLD-TOTAL-FILE-WORK.                                        01237000
012380     02  HOLD-TOT-KEY-WORK.                                       01238000
012390         03  HOLD-KEY-BANK-NO PIC 99.                             01239000
012400         03  HOLD-KEY-ACCT-ID PIC 9(3)                   COMP-3.  01240000
012410         03  HOLD-KEY-ACCT-NO PIC 9(9)                   COMP-3.  01241000
012420     02  HOLD-TOT-AMT-WORK    PIC 9(9)V99                COMP-3.  01242000
012430     02  HOLD-AFFILIATE-CHK-IND                                   01243000
012440                              PIC X.                              01244000
012450     02  FILLER               PIC X(9).                           01245000
012460                                                                  01246000
012470 01  FILLER                  PIC X(16)   VALUE 'CHANGE-LOG-WORK'. 01247000
012480 01  CHANGE-LOG-WORK.                                             01248000
012490     COPY DSDSCLW.                                                01249000
012500                                                                  01250000
012510 01 IRA-OSB-WORK.                                                 01251000
012520     02  WORK-IRA-CNTR-NBR    PIC X(13).                          01252000
012530     02  FILLER REDEFINES WORK-IRA-CNTR-NBR.                      01253000
012540         03  WORK-IRA-CUST-NBR     PIC 9(09).                     01254000
012550         03  WORK-IRA-FILLER       PIC X.                         01255000
012560         03  WORK-IRA-SEQ-NBR      PIC 9(03).                     01256000
012570                                                                  01257000
012580 01  FILLER                  PIC X(16)   VALUE 'ACRS-WORK-AREA '. 01258000
012590 01  ACRS-WORK-AREA.                                              01259000
012600     02  ACRS-FIELD-ID-WORK  PIC 9(09).                           01260000
012610     02  FILLER REDEFINES ACRS-FIELD-ID-WORK.                     01261000
012620         03  ACRS-FIELD-ID-1 PIC 9(03).                           01262000
012630         03  ACRS-FIELD-ID-2 PIC 9(03).                           01263000
012640         03  ACRS-FIELD-ID-3 PIC 9(03).                           01264000
012650     02  ACRS-FIELD-DESC                 PIC X(100).              01265000
012660     02  FILLER REDEFINES ACRS-FIELD-DESC.                        01266000
012670         03  ACRS-FIELD-DESC-1           PIC X(09).               01267000
012680         03  FILLER                      PIC X(01).               01268000
012690         03  ACRS-FIELD-DESC-2-3-4       PIC X(90).               01269000
012700         03  FILLER REDEFINES ACRS-FIELD-DESC-2-3-4.              01270000
012710             04  ACRS-FIELD-DESC-2-3     PIC X(50).               01271000
012720             04  FILLER REDEFINES ACRS-FIELD-DESC-2-3.            01272000
012730                 05  ACRS-FIELD-DESC-2   PIC X(24).               01273000
012740                 05  FILLER              PIC X(01).               01274000
012750                 05  ACRS-FIELD-DESC-3   PIC X(25).               01275000
012760             04  FILLER                  PIC X(01).               01276000
012770             04  ACRS-FIELD-DESC-4       PIC X(39).               01277000
012780     02  ACRS-DATE-WORK                  PIC X(08).               01278000
012790     02  FILLER REDEFINES ACRS-DATE-WORK.                         01279000
012800         03  ACRS-DATE-YYYY              PIC 9(04).               01280000
012810         03  ACRS-DATE-MM                PIC 9(02).               01281000
012820         03  ACRS-DATE-DD                PIC 9(02).               01282000
012830     02  ACRS-QUARTER                    PIC 9(01).               01283000
012840                                                                  01284000
012850 01  FILLER                  PIC X(16)   VALUE 'CLSN-BR-WORK-AR'. 01285000
012860 01  CLSN-BR-WORK-AREA.                                           01286000
012870     02  WORK-CLSN-NUM          PIC 9(11)    VALUE ZEROS.         01287000
012880     02  FILLER REDEFINES WORK-CLSN-NUM.                          01288000
012890         03  CLSN-CUST-NUM      PIC 9(7).                         01289000
012900         03  CLSN-LOAN-NUM      PIC 9(4).                         01290000
012910     02  HOLD-BR-CLSN-TIED      PIC 9(11)    VALUE ZEROS.         01291000
012920     02  CLSN-BR-DDA-NBR-X      PIC X(09)    VALUE SPACES.        01292000
012930     02  FILLER REDEFINES CLSN-BR-DDA-NBR-X.                      01293000
012940         03  CLSN-BR-DDA-NBR    PIC 9(09).                        01294000
012950     02  CLSN-BR-POST-TX        PIC X.                            01295000
012960         88  CLSN-BR-POST-TX-YES             VALUE 'Y'.           01296000
012970         88  CLSN-BR-POST-TX-NO              VALUE 'N'.           01297000
012980     02  CLSN-BR-WORK-ADV-AMT   PIC S9(9)V99 VALUE ZERO  COMP-3.  01298000
012990     02  CLSN-BR-WORK-PYMT-AMT  PIC S9(9)V99 VALUE ZERO  COMP-3.  01299000
013000     02  CLSN-BR-WORK-PRIN-BAL  PIC S9(9)V99 VALUE ZERO  COMP-3.  01300000
013010     02  CLSN-BR-WORK-BALANCE   PIC S9(9)V99 VALUE ZERO  COMP-3.  01301000
013020     02  CLSN-BR-WORK-CURR-BAL  PIC S9(9)V99 VALUE ZERO  COMP-3.  01302000
013030     02  CLSN-BR-WORK-COLL-BAL  PIC S9(9)V99 VALUE ZERO  COMP-3.  01303000
013040     02  CLSN-BR-WORK-AVAIL-BAL PIC S9(9)V99 VALUE ZERO  COMP-3.  01304000
013050     02  CLSN-BR-WORK-TOT-FLOAT PIC S9(9)V99 VALUE ZERO  COMP-3.  01305000
013060     02  CLSN-BR-AMT-NEEDED     PIC S9(9)V99 VALUE ZERO  COMP-3.  01306000
013070     02  CLSN-BR-ADV-TX-AMT     PIC S9(9)V99 VALUE ZERO  COMP-3.  01307000
013080     02  CLSN-BR-PYMT-TX-AMT    PIC S9(9)V99 VALUE ZERO  COMP-3.  01308000
013090     02  AMT-CLSN-BR-CREDITS    PIC S9(9)V99 VALUE ZERO  COMP-3.  01309000
013100     02  AMT-CLSN-BR-DEBITS     PIC S9(9)V99 VALUE ZERO  COMP-3.  01310000
013110     02  NUM-CLSN-BR-CREDITS    PIC S9(7)    VALUE ZERO  COMP-3.  01311000
013120     02  NUM-CLSN-BR-DEBITS     PIC S9(7)    VALUE ZERO  COMP-3.  01312000
013130                                                                  01313000
013140 01  FILLER                  PIC X(16)   VALUE 'ICS-WORK-AREA  '. 01314000
013150 01  ICS-WORK-AREA.                                               01315000
013160     02  ICS-WORK-SWEEP-AMT     PIC S9(9)V99  VALUE ZERO  COMP-3. 01316000
013170     02  ICS-WORK-COLL-BAL      PIC S9(9)V99  VALUE ZERO  COMP-3. 01317000
013180     02  ICS-DEBIT-TX-AMT       PIC S9(9)V99  VALUE ZERO  COMP-3. 01318000
013190     02  ICS-CRED-TX-AMT        PIC S9(9)V99  VALUE ZERO  COMP-3. 01319000
013200     02  AMT-ICS-CREDITS        PIC S9(9)V99 VALUE ZERO  COMP-3.  01320000
013210     02  AMT-ICS-DEBITS         PIC S9(9)V99 VALUE ZERO  COMP-3.  01321000
013220     02  NUM-ICS-CREDITS        PIC S9(7)    VALUE ZERO  COMP-3.  01322000
013230     02  NUM-ICS-DEBITS         PIC S9(7)    VALUE ZERO  COMP-3.  01323000
013240                                                                  01324000
013250                                                                  01325000
013260 01  CDC-CURRENT-DATES.                                           01326000
013270     COPY CURRDATE.                                               01327000
013280                                                                  01328000
013290     EXEC SQL                                                     01329000
013300         INCLUDE AMSOPER                                          01330000
013310     END-EXEC.                                                    01331000
013320                                                                  01332000
013330     EXEC SQL                                                     01333000
013340         INCLUDE FINQHOLD                                         01334000
013350     END-EXEC.                                                    01335000
013360                                                                  01336000
013370     EXEC SQL                                                     01337000
013380         INCLUDE FINQDEP                                          01338000
013390     END-EXEC.                                                    01339000
013400                                                                  01340000
013410     EXEC SQL                                                     01341000
013420         INCLUDE DSDSPEND                                         01342000
013430     END-EXEC.                                                    01343000
013440                                                                  01344000
013450     EXEC SQL                                                     01345000
013460         INCLUDE CIFACCT                                          01346000
013470     END-EXEC.                                                    01347000
013480                                                                  01348000
013490     EXEC SQL                                                     01349000
013500         INCLUDE CDCBKCTL                                         01350000
013510     END-EXEC.                                                    01351000
013520                                                                  01352000
013530     EXEC SQL                                                     01353000
013540         INCLUDE ACMDEBC                                          01354000
013550     END-EXEC.                                                    01355000
013560                                                                  01356000
013570     EXEC SQL                                                     01357000
013580         INCLUDE ACMDEBX                                          01358000
013590     END-EXEC.                                                    01359000
013600                                                                  01360000
013610     EXEC SQL                                                     01361000
013620         INCLUDE IRSPLST                                          01362000
013630     END-EXEC.                                                    01363000
013640                                                                  01364000
013650     EXEC SQL                                                     01365000
013660         INCLUDE DSDSOSB                                          01366000
013670     END-EXEC.                                                    01367000
013680                                                                  01368000
013690     EXEC SQL                                                     01369000
013700         INCLUDE ARCUST                                           01370000
013710     END-EXEC.                                                    01371000
013720                                                                  01372000
013730     EXEC SQL                                                     01373000
013740         INCLUDE ARCHECKS                                         01374000
013750     END-EXEC.                                                    01375000
013760                                                                  01376000
013770     EXEC SQL                                                     01377000
013780          INCLUDE NIPSDTL                                         01378000
013790     END-EXEC.                                                    01379000
013800                                                                  01380000
013810     EXEC SQL                                                     01381000
013820          INCLUDE DSDSZBCM                                        01382000
013830     END-EXEC.                                                    01383000
013840                                                                  01384000
013850     EXEC SQL                                                     01385000
013860          INCLUDE DSDSSACX                                        01386000
013870     END-EXEC.                                                    01387000
013880                                                                  01388000
013890     EXEC SQL                                                     01389000
013900          INCLUDE CDPEND                                          01390000
013910     END-EXEC.                                                    01391000
013920                                                                  01392000
013930     EXEC SQL                                                     01393000
013940          INCLUDE CDHIST                                          01394000
013950     END-EXEC.                                                    01395000
013960                                                                  01396000
013970     EXEC SQL                                                     01397000
013980          INCLUDE IRADDA                                          01398000
013990     END-EXEC.                                                    01399000
014000                                                                  01400000
014010 01  FILLER                   PIC X(16)  VALUE 'DSDSPACA        '.01401000
014020     EXEC SQL                                                     01402000
014030          INCLUDE DSDSPACA                                        01403000
014040     END-EXEC.                                                    01404000
014050                                                                  01405000
014060 01  FILLER                   PIC X(16)  VALUE 'MLSDLYST        '.01406000
014070     EXEC SQL                                                     01407000
014080          INCLUDE MLSDLYST                                        01408000
014090     END-EXEC.                                                    01409000
014100                                                                  01410000
014110 01  FILLER                   PIC X(16)  VALUE 'CDCNTL          '.01411000
014120     EXEC SQL                                                     01412000
014130          INCLUDE CDCNTL                                          01413000
014140     END-EXEC.                                                    01414000
014150                                                                  01415000
014160 01  FILLER                   PIC X(16)  VALUE 'CDMSTR          '.01416000
014170     EXEC SQL                                                     01417000
014180          INCLUDE CDMSTR                                          01418000
014190     END-EXEC.                                                    01419000
014200                                                                  01420000
014210     EXEC SQL                                                     01421000
014220          INCLUDE SPECSTMT                                        01422000
014230     END-EXEC.                                                    01423000
014240                                                                  01424000
014250 01  FILLER                   PIC X(16)  VALUE 'CIFACCTR        '.01425000
014260     EXEC SQL                                                     01426000
014270          INCLUDE CIFACCTR                                        01427000
014280     END-EXEC.                                                    01428000
014290                                                                  01429000
014300 01  FILLER                   PIC X(16)  VALUE 'DSDSSCR         '.01430000
014310     EXEC SQL                                                     01431000
014320          INCLUDE DSDSSCR                                         01432000
014330     END-EXEC.                                                    01433000
014340                                                                  01434000
014350     EXEC SQL                                                     01435000
014360          INCLUDE AMSPROPS                                        01436000
014370     END-EXEC.                                                    01437000
014380                                                                  01438000
014390     EXEC SQL                                                     01439000
014400          INCLUDE CLSD34                                          01440000
014410     END-EXEC.                                                    01441000
014420                                                                  01442000
014430     EXEC SQL                                                     01443000
014440          INCLUDE CLSD50                                          01444000
014450     END-EXEC.                                                    01445000
014460                                                                  01446000
014470     EXEC SQL                                                     01447000
014480          INCLUDE ODBGLTXN                                        01448000
014490     END-EXEC.                                                    01449000
014500                                                                  01450000
014510     EXEC SQL                                                     01451000
014520         INCLUDE SQLCA                                            01452000
014530     END-EXEC.                                                    01453000
014540                                                                  01454000
014550     COPY CIFXREFK.                                               01455000
014560                                                                  01456000
014570     COPY EDOC050P.                                               01457000
014580                                                                  01458000
014590 01  CHECKPLUS-FILE-KEY-WORK.                                     01459000
014600     02  CHKPLUS-FILE-KEY    PIC X(25).                           01460000
014610                                                                  01461000
014620******************************************************************01462000
014630*            C R F   R D A M   W O R K   A R E A S               *01463000
014640******************************************************************01464000
014650 01  ADM-RATE-PARAMETERS.                                         01465000
014660     COPY ADMPARM1.                                               01466000
014670                                                                  01467000
014680 01  STOCK-PAPER-WORK-FIELDS.                                     01468000
014690     COPY DSDR101.                                                01469000
014700                                                                  01470000
014710******************************************************************01471000
014720************ MISCELLANEOUS WORKING-STORAGE AREAS *****************01472000
014730 01  FILLER                  PIC X(16)   VALUE 'MISC-WS-AREAS'.   01473000
014740 01  MISC-WS-AREAS.                                               01474000
014750******************************************************************01475000
014760****                 S U B S C R I P T S                      ****01476000
014770******************************************************************01477000
014780     02  FILLER              PIC X(16)   VALUE '** SUBSCRIPTS **'.01478000
014790                                                                  01479000
014800     02  SUB3                PIC S9(4)   VALUE ZERO  COMP   SYNC. 01480000
014810**** SUB3            INDEX FOR EDOC050 TABLE                     *01481000
014820                                                                  01482000
014830     02  SUB4                PIC S9(4)   VALUE +1    COMP   SYNC. 01483000
014840**** SUB4            INDEX FOR ACCT.ID. IN PROCESS CONTROL       *01484000
014850                                                                  01485000
014860     02  SUB6                PIC S9(4)   VALUE ZERO  COMP   SYNC. 01486000
014870**** SUB6            INDEX FOR PRINTING TOTALS BY TYPE, STRATA,  *01487000
014880****                                     CLASS, BRANCH, SERVICE  *01488000
014890****                                     CHARGE CODE             *01489000
014900****                                     (DAILY TOTAL ROUTINE)   *01490000
014910                                                                  01491000
014920     02  SUB7                PIC S9(4)   VALUE ZERO  COMP   SYNC. 01492000
014930**** SUB7            INDEX FOR EXTERNAL SERVICE CHARGES IN BCF   *01493000
014940                                                                  01494000
014950     02  SUB8                PIC S9(4)   VALUE +1    COMP   SYNC. 01495000
014960**** SUB8            INDEX FOR CYCLE CODES IN PROCESS CONTROL    *01496000
014970                                                                  01497000
014980     02  SUB9                PIC S9(4)   VALUE ZERO  COMP   SYNC. 01498000
014990**** SUB9            INDEX FOR TOTALS BY ACCT TYPE               *01499000
015000                                                                  01500000
015010     02  SUB10               PIC S9(4)   VALUE +1    COMP   SYNC. 01501000
015020**** SUB10           INDEX FOR ODB ACCTS BY PLAN TYPE            *01502000
015030                                                                  01503000
015040     02  SUB11               PIC S9(4)   VALUE +1    COMP   SYNC. 01504000
015050**** SUB11           INDEX FOR INV ACCTS BY PLAN TYPE            *01505000
015060                                                                  01506000
015070     02  SUB12               PIC S9(4)   VALUE ZERO  COMP   SYNC. 01507000
015080**** SUB12           ** NOT USED **                              *01508000
015090                                                                  01509000
015100     02  SUB13               PIC S9(4)   VALUE ZERO  COMP   SYNC. 01510000
015110**** SUB13           INDEX FOR TOTALS BY ACCT CLASSIFICATION     *01511000
015120                                                                  01512000
015130     02  SUB14               PIC S9(4)   VALUE +1    COMP   SYNC. 01513000
015140**** SUB14           INDEX FOR OVERDRAFT BANKING INFO IN BCF     *01514000
015150                                                                  01515000
015160     02  SUB16               PIC S9(4)   VALUE ZERO  COMP   SYNC. 01516000
015170**** SUB16           ** NOT USED **                              *01517000
015180                                                                  01518000
015190     02  SUB17               PIC S9(4)   VALUE ZERO  COMP   SYNC. 01519000
015200**** SUB17           ** NOT USED **                              *01520000
015210                                                                  01521000
015220     02  SUB18               PIC S9(4)   VALUE ZERO  COMP   SYNC. 01522000
015230**** SUB18           INDEX FOR EARNINGS ELEMENTS IN BCF          *01523000
015240                                                                  01524000
015250     02  SUB-IMM             PIC S9(03)  VALUE +0    COMP.        01525000
015260**** SUB-IMM         USED FOR COUNTING 'Y' SWITCHES FOR IMM      *01526000
015270                                                                  01527000
015280     02  SUB-CYCLE           PIC S9(03)  VALUE +0    COMP.        01528000
015290**** SUB-CYCLE       USED FOR GETTING NEXT STATEMENT CYCLE FOR ODB01529000
015300                                                                  01530000
015310******************************************************************01531000
015320*       M I S C E L L A N E O U S   W O R K   F I E L D S        *01532000
015330******************************************************************01533000
015340 01  FILLER                  PIC X(16)   VALUE 'MISC. WORK AREA'. 01534000
015350 01  MISCELLANEOUS-WORK-FIELDS.                                   01535000
015360     02  DAY-TO-PROC         PIC S9(5)   VALUE ZERO      COMP-3.  01536000
015370     02  HOLD-SORT-KEY       PIC X(20)   VALUE SPACES.            01537000
015380     02  FILLER REDEFINES HOLD-SORT-KEY.                          01538000
015390         03  SK-ACCOUNT-ID   PIC 999                     COMP-3.  01539000
015400         03  SK-ACCOUNT-NO   PIC 9(9)                    COMP-3.  01540000
015410         03  SK-AMOUNT       PIC S9(9)V99                COMP-3.  01541000
015420         03  SK-WA-IND       PIC X.                               01542000
015430         03  FILLER          PIC X(6).                            01543000
015440     02  FILLER REDEFINES HOLD-SORT-KEY.                          01544000
015450         03  SKA-ACCOUNT-ID  PIC 999                     COMP-3.  01545000
015460         03  SKA-SHORT-NAME  PIC X(13).                           01546000
015470         03  SKA-ACCOUNT-NO  PIC 9(9)                    COMP-3.  01547000
015480     02  FILLER REDEFINES HOLD-SORT-KEY.                          01548000
015490         03  SKB-ACCOUNT-ID  PIC 999                     COMP-3.  01549000
015500         03  SKB-XXX         PIC XXX.                             01550000
015510         03  FILLER REDEFINES SKB-XXX.                            01551000
015520             04  SKB-XX      PIC 99.                              01552000
015530             04  FILLER      PIC X.                               01553000
015540         03  SKB-SHORT-NAME  PIC X(13).                           01554000
015550         03  FILLER REDEFINES SKB-SHORT-NAME.                     01555000
015560             04  SKB-ACCOUNT-NO  PIC 9(9)                COMP-3.  01556000
015570             04  FILLER      PIC X(8).                            01557000
015580         03  FILLER          PIC XX.                              01558000
015590     02  FILLER REDEFINES HOLD-SORT-KEY.                          01559000
015600         03  SKC-REL-ACCT    PIC 9(7)                    COMP-3.  01560000
015610         03  SKC-SHORT-NM    PIC X(13).                           01561000
015620         03  FILLER REDEFINES SKC-SHORT-NM.                       01562000
015630             04  SKC-ACCT-ID PIC 999                     COMP-3.  01563000
015640             04  SKC-ACCT-NO PIC 9(9)                    COMP-3.  01564000
015650             04  FILLER      PIC X(6).                            01565000
015660         03  FILLER          PIC XXX.                             01566000
015670     02  FILLER REDEFINES HOLD-SORT-KEY.                          01567000
015680         03  SKD-ACCOUNT-ID  PIC 999                     COMP-3.  01568000
015690         03  SKD-SC-EX-CD    PIC XX.                              01569000
015700         03  SKD-OFFICER     PIC XXX.                             01570000
015710         03  SKD-ACCOUNT-NO  PIC 9(9)                    COMP-3.  01571000
015720         03  FILLER          PIC X(8).                            01572000
015730     02  FILLER REDEFINES HOLD-SORT-KEY.                          01573000
015740         03  SKE-ACCOUNT-ID  PIC 999                     COMP-3.  01574000
015750         03  SKE-OFFICER     PIC XXX.                             01575000
015760         03  SKE-SC-EX-CD    PIC XX.                              01576000
015770         03  SKE-ACCOUNT-NO  PIC 9(9)                    COMP-3.  01577000
015780         03  FILLER          PIC X(8).                            01578000
015790     02  FILLER REDEFINES HOLD-SORT-KEY.                          01579000
015800         03  SKF-ACCOUNT-ID  PIC 999                     COMP-3.  01580000
015810         03  SKF-ACCOUNT-NO  PIC 9(9)                    COMP-3.  01581000
015820         03  SKF-LP-CONT     PIC S999                    COMP-3.  01582000
015830         03  SKF-AMOUNT      PIC S9(9)V99                COMP-3.  01583000
015840         03  FILLER          PIC X(5).                            01584000
015850     02  ODB-REVIEW-CURR-DT  PIC 9(8).                            01585000
015860     02  FILLER REDEFINES ODB-REVIEW-CURR-DT.                     01586000
015870         03  ODB-RCD-CCYR    PIC 9(4).                            01587000
015880         03  ODB-RCD-MO      PIC 99.                              01588000
015890         03  ODB-RCD-DA      PIC 99.                              01589000
015900     02  ODB-REVIEW-DATE-WK  PIC 9(6).                            01590000
015910     02  FILLER REDEFINES ODB-REVIEW-DATE-WK.                     01591000
015920         03  ODB-RDW-CCYR    PIC 9(4).                            01592000
015930         03  ODB-RDW-MO      PIC 99.                              01593000
015940     02  ODB-NEXT-REVIEW-DT  PIC 9(6).                            01594000
015950     02  FILLER REDEFINES ODB-NEXT-REVIEW-DT.                     01595000
015960         03  ODB-NRD-CCYR    PIC 9(4).                            01596000
015970         03  ODB-NRD-MO      PIC 99.                              01597000
015980     02  ODB-REVIEW-DATE-WK1 PIC 9(4).                            01598000
015990     02  FILLER REDEFINES ODB-REVIEW-DATE-WK1.                    01599000
016000         03  ODB-RD-MO1      PIC 99.                              01600000
016010         03  ODB-RD-YR1      PIC 99.                              01601000
016020     02  ODB-REVIEW-DATE-WK2 PIC 9(6).                            01602000
016030     02  FILLER REDEFINES ODB-REVIEW-DATE-WK2.                    01603000
016040         03  ODB-RD-CC2      PIC 99.                              01604000
016050         03  ODB-RD-YR2      PIC 99.                              01605000
016060         03  ODB-RD-MO2      PIC 99.                              01606000
016070     02  CYCLE-THIS-HC       PIC 9       VALUE ZERO      COMP-3.  01607000
016080     02  HOLD-NUMBER         PIC S9(7)   VALUE ZERO      COMP-3.  01608000
016090     02  HOLD-AVG-CURR-CYC   PIC S9(9)V99 VALUE ZERO     COMP-3.  01609000
016100     02  HOLD-AVG-CURR-MO    PIC S9(9)V99 VALUE ZERO     COMP-3.  01610000
016110     02  HOLD-AVG-COLL-CYC   PIC S9(9)V99 VALUE ZERO     COMP-3.  01611000
016120     02  HOLD-AVG-COLL-MO    PIC S9(9)V99 VALUE ZERO     COMP-3.  01612000
016130     02  HOLD-DAYS-IN-CYCLE  PIC S9(3)   VALUE ZERO      COMP-3.  01613000
016140     02  HOLD-FDIC-CHARGE    PIC S9(9)V99 VALUE ZERO     COMP-3.  01614000
016150     02  HOLD-LOW-BAL-MTH    PIC S9(9)V99 VALUE ZERO     COMP-3.  01615000
016160     02  AVG-BAL-IN-1000S    PIC S9(9)   VALUE ZERO      COMP-3.  01616000
016170     02  AVG-BAL             PIC S9(9)   VALUE ZERO      COMP-3.  01617000
016180     02  WORK-AVERAGE-BAL    PIC S9(11)  VALUE ZERO    COMP-3.    01618000
016190     02  HOLD-CURR-BAL-ADJ   PIC S9(11)V99 VALUE ZERO    COMP-3.  01619000
016200     02  HOLD-COLL-BAL-ADJ   PIC S9(11)V99 VALUE ZERO    COMP-3.  01620000
016210     02  MONTH-END-MO        PIC 99      VALUE ZERO.              01621000
016220     02  MONTH-END-YR        PIC 99      VALUE ZERO.              01622000
016230     02  DAILY-TOT-SW        PIC 9       VALUE ZERO      COMP-3.  01623000
016240     02  CURR-ACCR-CNTR      PIC 9       VALUE ZERO      COMP-3.  01624000
016250     02  CURR-ACCR-CNTR-INV  PIC 9       VALUE ZERO      COMP-3.  01625000
016260     02  BACKOUT-DAYS        PIC S9      VALUE ZERO      COMP-3.  01626000
016270     02  NO-MO-QTR           PIC 9       VALUE 0.                 01627000
016280     02  HI-VAL-TX-ID        PIC X(9).                            01628000
016290     02  DSDSTXL-EOB-SW      PIC 9       VALUE 0.                 01629000
016300     02  MSTR-ID.                                                 01630000
016310         03  MSTR-ID-BANK-NO PIC 99.                              01631000
016320         03  MSTR-ID-ACCT-ID PIC 999                     COMP-3.  01632000
016330         03  MSTR-ID-ACCT-NO PIC 9(9)                    COMP-3.  01633000
016340     02  MSTR-ID-R REDEFINES MSTR-ID.                             01634000
016350         03  FILLER          PIC 99.                              01635000
016360         03  MSTR-ID-HV      PIC X(7).                            01636000
016370     02  HOLD-CASH-MANAGEMENT-WORK-AMT                            01637000
016380                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01638000
016390     02  HOLD-RP-WORK-AMT    PIC S9(9)V99 VALUE ZERO     COMP-3.  01639000
016400     02  HOLD-RP-COLLAT-AMT  PIC S9(9)V99 VALUE ZERO     COMP-3.  01640000
016410     02  HOLD-RP-EXCESS      PIC S9(9)V99 VALUE ZERO     COMP-3.  01641000
016420     02  HOLD-RP-MARKET-VALUE                                     01642000
016430                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01643000
016440     02  HOLD-RP-DAILY-INT   PIC S9(8)V9(5) VALUE ZERO   COMP-3.  01644000
016450     02  HOLD-RP-NUM-INCR    PIC S9(11)  VALUE ZERO      COMP-3.  01645000
016460     02  HOLD-RP-RATE        PIC SV9(7)  VALUE ZERO      COMP-3.  01646000
016470     02  HOLD-RP-COLLAT-CNT  PIC S9(3)   VALUE ZERO      COMP-3.  01647000
016480     02  HOLD-RP-COLLAT-RATE PIC S9V99   VALUE ZERO      COMP-3.  01648000
016490     02  HOLD-PEG-NEW        PIC S9(11)V99 VALUE ZERO    COMP-3.  01649000
016500     02  HOLD-PEG-BAL-WK1    PIC S9(11)V99 VALUE ZERO    COMP-3.  01650000
016510     02  HOLD-PEG-BAL-WK2    PIC S9(11)V99 VALUE ZERO    COMP-3.  01651000
016520     02  HOLD-PEG-SC-AMT     PIC S9(5)V99 VALUE ZERO     COMP-3.  01652000
016530     02  HOLD-PEG-EARN-RATE  PIC SV9(5)  VALUE ZERO      COMP-3.  01653000
016540     02  HOLD-PEG-CNT        PIC 9(5)    VALUE ZERO      COMP-3.  01654000
016550     02  TOT-COLLAT-AVAIL    PIC S9(9)V99 VALUE ZERO     COMP-3.  01655000
016560     02  HOLD-INV-RATE       PIC SV9(7)  VALUE ZERO      COMP-3.  01656000
016570     02  HOLD-TARGET-BALANCE PIC S9(9)V99 VALUE ZERO     COMP-3.  01657000
016580     02  HOLD-IMM-DEBITS     PIC 9(5)    VALUE ZERO      COMP-3.  01658000
016590     02  HOLD-DDA-ACCT-ID-LINKED-TO-SEC                           01659000
016600                             PIC 999      VALUE ZERO     COMP-3.  01660000
016610     02  HOLD-DDA-ACCT-NO-LINKED-TO-SEC                           01661000
016620                             PIC 9(9)     VALUE ZERO     COMP-3.  01662000
016630     02  HOLD-OSH-DDA-ACCT-ID                                     01663000
016640                             PIC 999      VALUE ZERO     COMP-3.  01664000
016650     02  HOLD-OSH-DDA-ACCT-NO                                     01665000
016660                             PIC 9(9)     VALUE ZERO     COMP-3.  01666000
016670     02  TEMP-CLOSEOUT-BAL   PIC S9(11)V99 VALUE ZERO    COMP-3.  01667000
016680     02  TEMP-CLOSEOUT-EXCESS                                     01668000
016690                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01669000
016700     02  TEMP-CLOSEOUT-INT-DROP                                   01670000
016710                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01671000
016720     02  TEMP-CLOSEOUT-INV-INT-DROP                               01672000
016730                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01673000
016740     02  TEMP-CLOSEOUT-ACCR-INT                                   01674000
016750                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01675000
016760     02  TEMP-CLOSEOUT-TX-INT                                     01676000
016770                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01677000
016780     02  TEMP-CLOSEOUT-TAX   PIC S9(9)V99 VALUE ZERO     COMP-3.  01678000
016790     02  TEMP-CLOSEOUT-ANN-EARN                                   01679000
016800                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01680000
016810     02  CLOSEOUT-SW         PIC X        VALUE SPACE.            01681000
016820         88  NO-CLOSEOUT-IN-PROCESS       VALUE ' '.              01682000
016830         88  CLOSEOUT-IN-PROCESS          VALUE 'C'.              01683000
016840     02  TEMP-IMM-DEBITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  01684000
016850     02  TEMP-SC-WK          PIC S9(9)V99 VALUE ZERO     COMP-3.  01685000
016860     02  HOLD-PREV-ODB-STMT-BAL                                   01686000
016870                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01687000
016880     02  HOLD-PREV-XX-ODB-RATE1                                   01688000
016890                             PIC SV9(5)  VALUE ZERO      COMP-3.  01689000
016900     02  HOLD-PREV-XX-ODB-AMT1                                    01690000
016910                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01691000
016920     02  HOLD-PREV-XX-ODB-RATE2                                   01692000
016930                             PIC SV9(5)  VALUE ZERO      COMP-3.  01693000
016940     02  HOLD-PREV-INV-STMT-BAL                                   01694000
016950                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01695000
016960     02  HOLD-GROSS-LOAN-BAL      PIC S9(9)V99 VALUE ZERO  COMP-3.01696000
016970     02  HOLD-2ND-GROSS-LOAN-BAL  PIC S9(9)V99 VALUE ZERO  COMP-3.01697000
016980     02  HOLD-2ND-AVG-BAL    PIC S9(9)V99      VALUE ZERO  COMP-3.01698000
016990     02  WORK-DAILY-RATE     PIC SV9(5)        VALUE ZERO  COMP-3.01699000
017000     02  WORK-INT-CHG-1      PIC S9(9)V9(5)    VALUE ZERO  COMP-3.01700000
017010     02  WORK-INT-CHG-2      PIC S9(9)V9(5)    VALUE ZERO  COMP-3.01701000
017020     02  OVERNIGHT-RATE-1    PIC SV9(7)  VALUE ZERO      COMP-3.  01702000
017030     02  OVERNIGHT-RATE-2    PIC SV9(7)  VALUE ZERO      COMP-3.  01703000
017040     02  OVERNIGHT-RATE-3    PIC SV9(7)  VALUE ZERO      COMP-3.  01704000
017050     02  OVERNIGHT-RATE-4    PIC SV9(7)  VALUE ZERO      COMP-3.  01705000
017060     02  OVERNIGHT-RATE-5    PIC SV9(7)  VALUE ZERO      COMP-3.  01706000
017070     02  TAX-EXEMPT-RATE     PIC SV9(7)  VALUE ZERO      COMP-3.  01707000
017080     02  TREASURY-FUND-RATE  PIC SV9(7)  VALUE ZERO      COMP-3.  01708000
017090     02  FED-FUNDS-RT        PIC SV9(7)  VALUE ZERO      COMP-3.  01709000
017100     02  CASH-MGMT-TRUST-RATE                                     01710000
017110                             PIC SV9(7)  VALUE ZERO      COMP-3.  01711000
017120     02  ODB-RATE-WK         PIC SV9(5)  VALUE ZERO      COMP-3.  01712000
017130     02  ODB-RATE-WK2        PIC SV9(5)  VALUE ZERO      COMP-3.  01713000
017140     02  ODB-PEG-BAL-TX-SW   PIC 9       VALUE ZERO      COMP-3.  01714000
017150     02  TEMP-TAX-WITHHELD   PIC S9(9)V99 VALUE ZERO     COMP-3.  01715000
017160     02  HOLD-WH-STATUS      PIC X        VALUE SPACE.            01716000
017170         88  NOT-IN-WITHHOLD-STATUS       VALUE ' '.              01717000
017180         88  IN-WITHHOLD-STATUS           VALUE 'W'.              01718000
017190     02  HOLD-INT-PD-LST-CYC PIC S9(7)V99 VALUE ZERO     COMP-3.  01719000
017200     02  HOLD-SERV-CHG-AMT   PIC S9(5)V99 VALUE ZERO     COMP-3.  01720000
017210     02  HOLD-ODB-AVAILABLE  PIC S9(9)V99 VALUE ZERO     COMP-3.  01721000
017220     02  HOLD-ODB-INT-AMT    PIC S9(9)V99 VALUE ZERO     COMP-3.  01722000
017230     02  HOLD-ODB-MIN-PYMT-AMT                                    01723000
017240                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01724000
017250     02  HOLD-ODB-AMT-TO-CHRG                                     01725000
017260                             PIC S9(9)V99 VALUE ZERO     COMP-3.  01726000
017270     02  HOLD-ODB-PYMT-FREQ  PIC 9       VALUE ZERO      COMP-3.  01727000
017280     02  ADD-COUNT           PIC 9       VALUE ZERO      COMP-3.  01728000
017290     02  ADD-COUNT-2         PIC 9       VALUE ZERO      COMP-3.  01729000
017300     02  HOLD-UPDATE-SW      PIC 9       VALUE ZERO      COMP-3.  01730000
017310     02  HOLD-REPORT-CODE    PIC S999    VALUE ZERO      COMP-3.  01731000
017320     02  SUB-FILE-REC-ID     PIC X(20)   VALUE SPACES.            01732000
017330     02  FILLER REDEFINES SUB-FILE-REC-ID.                        01733000
017340         03  SFR-ACCT-NO     PIC 9(9)                    COMP-3.  01734000
017350         03  FILLER          PIC X(15).                           01735000
017360     02  WORK-ID             PIC X(20)   VALUE SPACES.            01736000
017370     02  FILLER REDEFINES WORK-ID.                                01737000
017380         03  WORK-ID-ACCT-NO PIC 9(9)                    COMP-3.  01738000
017390         03  FILLER          PIC X(15).                           01739000
017400     02  ACCT-ANAL-REC-ID-WK PIC X(20)   VALUE SPACES.            01740000
017410     02  FILLER REDEFINES ACCT-ANAL-REC-ID-WK.                    01741000
017420         03  ACCT-ANAL-REC-ID                                     01742000
017430                             PIC 9(9)                    COMP-3.  01743000
017440         03  FILLER          PIC X(15).                           01744000
017450     02  SAVE-ACCOUNT-ID     PIC 999     VALUE ZERO.              01745000
017460     02  SAVE-SUB-FILE-ID    PIC X(3)    VALUE SPACES.            01746000
017470     02  HOLD-SA-NO-DEBITS   PIC S9(5)   VALUE ZERO      COMP-3.  01747000
017480     02  HOLD-SA-NO-CREDITS  PIC S9(5)   VALUE ZERO      COMP-3.  01748000
017490     02  HOLD-SA-NO-DEP-ITEMS                                     01749000
017500                             PIC S9(7)   VALUE ZERO      COMP-3.  01750000
017510     02  HOLD-SA-S-C-CALC-AMT                                     01751000
017520                             PIC S9(9)   VALUE ZERO      COMP-3.  01752000
017530     02  DSDSTXL-BANK-SAVE   PIC 999     VALUE ZERO      COMP-3.  01753000
017540     02  FIRST-DSDSTXL-SW    PIC 9       VALUE 1         COMP-3.  01754000
017550     02  DSDSTXL-PENDING-SW  PIC 9       VALUE ZERO      COMP-3.  01755000
017560     02  DSDSTXL-EOF         PIC 9       VALUE ZERO      COMP-3.  01756000
017570     02  CYCLE-THIS-SC-EARN  PIC 9       VALUE ZERO      COMP-3.  01757000
017580     02  SPEC-SC-THIS-SPEC-CHKR                                   01758000
017590                             PIC 9       VALUE ZERO      COMP-3.  01759000
017600     02  REQUEST-STMT        PIC 9       VALUE ZERO      COMP-3.  01760000
017610     02  REQ-STMT-NO-ENCL    PIC 9       VALUE ZERO      COMP-3.  01761000
017620     02  REQUEST-HISTORY     PIC 9       VALUE ZERO      COMP-3.  01762000
017630     02  HOLD-SELECT-CRITERIA                                     01763000
017640                             PIC XXX     VALUE SPACES.            01764000
017650     02  FILLER REDEFINES HOLD-SELECT-CRITERIA.                   01765000
017660         03  FILLER          PIC X.                               01766000
017670         03  TYPE-CRITERIA   PIC 99.                              01767000
017680     02  ID-CRITERIA REDEFINES HOLD-SELECT-CRITERIA               01768000
017690                             PIC 999.                             01769000
017700     02  OSB-SAV-HDR-SW      PIC 9       VALUE ZERO      COMP-3.  01770000
017710     02  HC-HDR-SW           PIC 9       VALUE ZERO      COMP-3.  01771000
017720     02  PD-HDR-SW           PIC 9       VALUE ZERO      COMP-3.  01772000
017730     02  SC-HDR-SW           PIC 9       VALUE ZERO      COMP-3.  01773000
017740     02  HOLD-PJ-ACCT        PIC 9(9)    VALUE ZERO      COMP-3.  01774000
017750     02  FIRST-TIME-SW       PIC 9       VALUE 1         COMP-3.  01775000
017760     02  LAST-TIME-SW        PIC 9       VALUE ZERO      COMP-3.  01776000
017770     02  PJ-DEB-SW           PIC 9       VALUE ZERO      COMP-3.  01777000
017780     02  PJ-CRE-SW           PIC 9       VALUE ZERO      COMP-3.  01778000
017790     02  BYPASS-PAST-DUE     PIC 9       VALUE ZERO      COMP-3.  01779000
017800     02  PJ-DATE-WORK        PIC 9(6)    VALUE ZERO.              01780000
017810     02  FILLER REDEFINES PJ-DATE-WORK.                           01781000
017820         03  PJ-DATE-WK1     PIC 9(4).                            01782000
017830         03  FILLER          PIC 99.                              01783000
017840     02  TEMP-CR-AVAIL       PIC S9(9)V99 VALUE ZERO     COMP-3.  01784000
017850     02  TEMP-HE-CR-AVAIL    PIC S9(9)V99 VALUE ZERO     COMP-3.  01785000
017860     02  TEMP-TX-PAYMENT     PIC S9(9)V99 VALUE ZERO     COMP-3.  01786000
017870     02  PAYMENT-FRACTION    PIC SV999   VALUE ZERO      COMP-3.  01787000
017880     02  PAYMENT-DOLLARS     PIC S9(9)   VALUE ZERO      COMP-3.  01788000
017890     02  TEMP-PAYMENT        PIC S9(9)V99 VALUE ZERO     COMP-3.  01789000
017900     02  HOLD-ADVANCE-AMT    PIC S9(9)V99 VALUE ZERO     COMP-3.  01790000
017910     02  HOLD-HE-ADV-AMT     PIC S9(9)V99 VALUE ZERO     COMP-3.  01791000
017920     02  TEMP-TX-AMT         PIC S9(11)V99 VALUE ZERO    COMP-3.  01792000
017930     02  TEMP-SUM            PIC S9(11)V99 VALUE ZERO    COMP-3.  01793000
017940     02  ADVANCE-TX-AMT      PIC S9(9)V99 VALUE ZERO     COMP-3.  01794000
017950     02  HE-ADVANCE-TX-AMT   PIC S9(9)V99 VALUE ZERO     COMP-3.  01795000
017960     02  NO-OF-TIMES         PIC 999     VALUE ZERO      COMP-3.  01796000
017970     02  TEMP-DAYS           PIC 999     VALUE ZERO      COMP-3.  01797000
017980     02  TEMP-LOAN-BAL       PIC S9(9)V99 VALUE ZERO     COMP-3.  01798000
017990     02  TEMP-EXCESS         PIC S9(9)V99 VALUE ZERO     COMP-3.  01799000
018000     02  TEMP-MAX1           PIC S9(9)V99 VALUE ZERO     COMP-3.  01800000
018010     02  TEMP-CR-LIFE        PIC S9(4)V999 VALUE ZERO    COMP-3.  01801000
018020     02  EXCESS-ODB-PAYMENT  PIC S9(9)V99 VALUE ZERO     COMP-3.  01802000
018030     02  EDIT-ACCT-NO        PIC X(12)   VALUE SPACES.            01803000
018040     02  EDIT-RETURN         PIC X       VALUE SPACE.             01804000
018050     02  WITHDRAWALS-TDY     PIC S9(9)V99 VALUE ZERO     COMP-3.  01805000
018060     02  HOLD-LRG-ITM-CHK    PIC S9(9)V99 VALUE ZERO     COMP-3.  01806000
018070     02  OVERRIDE-TX-TDY     PIC 9       VALUE ZERO      COMP-3.  01807000
018080     02  RET-CHK-CR-SW       PIC 9       VALUE ZERO      COMP-3.  01808000
018090     02  ACTIVITY-TDY        PIC 9       VALUE ZERO      COMP-3.  01809000
018100     02  INV-MAT-TDY         PIC 9       VALUE ZERO      COMP-3.  01810000
018110     02  ADVANCES-TDY        PIC S9(9)V99 VALUE ZERO     COMP-3.  01811000
018120     02  DEP-LESS-ADV        PIC S9(9)V99 VALUE ZERO     COMP-3.  01812000
018130     02  DEPOSITS-TDY        PIC S9(9)V99 VALUE ZERO     COMP-3.  01813000
018140     02  TEMP-CURR-BAL       PIC S9(11)V99 VALUE ZERO    COMP-3.  01814000
018150     02  LIST-POST-SW        PIC 9       VALUE ZERO      COMP-3.  01815000
018160     02  LIST-POST-CNT       PIC S9(5)   VALUE ZERO      COMP-3.  01816000
018170     02  LIST-POST-TOT       PIC S9(9)V99 VALUE ZERO     COMP-3.  01817000
018180     02  LIST-POST-TABLE.                                         01818000
018190         03  WP-DETAIL       PIC X(54)   OCCURS 9 TIMES.          01819000
018200         03  WP-WORK.                                             01820000
018210             04  WP-TX-CODE  PIC S999                    COMP-3.  01821000
018220             04  WP-AMT      PIC S9(9)V99                COMP-3.  01822000
018230             04  WP-ITEM-ID  PIC X(6).                            01823000
018240             04  FILLER REDEFINES WP-ITEM-ID.                     01824000
018250                 05  WP-BAT  PIC S9(5)                   COMP-3.  01825000
018260                 05  WP-SEQ  PIC S9(5)                   COMP-3.  01826000
018270             04  WP-SORT-KEY PIC XX.                              01827000
018280             04  WP-CHK-NO   PIC S9(11)                  COMP-3.  01828000
018290             04  WP-CO-DESC  PIC X(16).                           01829000
018300             04  WP-DESC     PIC X(10).                           01830000
018310             04  WP-TX-BAL   PIC S9(9)V99                COMP-3.  01831000
018320     02  LP-MINIMUM          PIC S9      VALUE ZERO      COMP-3.  01832000
018330     02  PUT-CNT             PIC S9999   VALUE ZERO  COMP   SYNC. 01833000
018340     02  LP-STORE            PIC S9999   VALUE ZERO  COMP   SYNC. 01834000
018350     02  HOLD-SC-FEE         PIC S999V99 VALUE ZERO      COMP-3.  01835000
018360     02  HOLD-SC-AMT         PIC S9(9)V99 VALUE ZERO     COMP-3.  01836000
018370     02  SC-CRITERIA         PIC S9(3)V99 VALUE ZERO     COMP-3.  01837000
018380     02  HOLD-DT-PERCENT     PIC S9(4)V9(3) VALUE ZERO   COMP-3.  01838000
018390     02  HOLD-DT-AMOUNT      PIC S9(9)V99 VALUE ZERO     COMP-3.  01839000
018400     02  SC-DEB-SW           PIC 9       VALUE ZERO      COMP-3.  01840000
018410     02  TX-SW               PIC 9       VALUE ZERO      COMP-3.  01841000
018420         88  THERE-WERE-NO-TXS-ON-THIS-ACCT  VALUE 0.             01842000
018430     02  ADD-TO-DAYS-OD-SW   PIC 9       VALUE ZERO      COMP-3.  01843000
018440     02  APPROVED-OD-SW      PIC 9       VALUE ZERO      COMP-3.  01844000
018450     02  397-SW              PIC 9       VALUE ZERO      COMP-3.  01845000
018460     02  447-SW              PIC 9       VALUE ZERO      COMP-3.  01846000
018470     02  460-710-SW          PIC 9       VALUE ZERO      COMP-3.  01847000
018480     02  470-480-SW          PIC 9       VALUE ZERO      COMP-3.  01848000
018490     02  750-SW              PIC 9       VALUE ZERO      COMP-3.  01849000
018500     02  942-AMT             PIC S9(9)V99 VALUE ZERO     COMP-3.  01850000
018510     02  942-DIFF            PIC S9(9)V99 VALUE ZERO     COMP-3.  01851000
018520     02  942-DIFF-DISPLAY    PIC Z(9).99-.                        01852000
018530     02  BEG-BAL-SW          PIC 9       VALUE ZERO      COMP-3.  01853000
018540         88  BEG-BAL-PLUS                VALUE 0  2.              01854000
018550         88  BEG-BAL-MINUS               VALUE 1.                 01855000
018560         88  BEG-BAL-ZERO                VALUE 0.                 01856000
018570     02  SUB-NUM-TMS-OD-SW   PIC 9       VALUE ZERO      COMP-3.  01857000
018580     02  HOLD-NUM-OD         PIC 9       VALUE ZERO      COMP-3.  01858000
018590     02  NO-ACTIVITY-STMT    PIC 9       VALUE ZERO      COMP-3.  01859000
018600     02  TEMP-I-CHG          PIC S9(5)V99 VALUE ZERO     COMP-3.  01860000
018610     02  INSF-AMT            PIC S9(9)V99 VALUE ZERO     COMP-3.  01861000
018620     02  UNPOST-AMT          PIC S9(9)V99 VALUE ZERO     COMP-3.  01862000
018630     02  READ-MSTR           PIC S9(5)   VALUE ZERO      COMP-3.  01863000
018640     02  READ-CNT            PIC S9(5)   VALUE ZERO      COMP-3.  01864000
018650     02  READ-REMAINDER      PIC S9(5)   VALUE ZERO      COMP-3.  01865000
018660     02  TEMP-GROSS-BAL      PIC S9(9)V99 VALUE ZERO     COMP-3.  01866000
018670     02  TX-CODE-WK          PIC 999     VALUE ZERO      COMP-3.  01867000
018680         88  ATM-TX                      VALUE 600, 601, 610,     01868000
018690                                               611, 613, 614, 626,01869000
018700                                               770 THRU 780,      01870000
018710                                               783, 784.          01871000
018720         88  ACH-TX                      VALUE 500, 590, 741, 763,01872000
018730                                               840, 973, 974,     01873000
018740                                               980.               01874000
018750         88  DEBIT-TX                    VALUE 990  988 460       01875000
018760                                               700 THRU 989.      01876000
018770         88  CREDIT-TX                   VALUE 540 543            01877000
018780                                               470 THRU 670.      01878000
018790         88  E-ITEM-TX                   VALUE 770, 771, 772, 773,01879000
018800                                               774, 775, 776, 777,01880000
018810                                               778, 779, 780, 781,01881000
018820                                               783, 798, 879, 902,01882002
018820                                               904, 905, 908, 918,01882102
018830                                               920, 922, 924, 925,01883000
018840                                               926.               01884000
018850         88  REGE-TX                     VALUE 770, 771, 773, 776,01885000
018860                                               777, 778, 779, 780,01886000
018870                                               781, 922, 926.     01887000
018880         88  CD-335-10-TX                VALUE 540, 541, 542, 543,01888000
018890                                               544, 549, 550, 590,01889000
018900                                               600, 601, 602, 603,01890000
018910                                               604, 605, 606, 610,01891000
018920                                               620, 623, 624, 625,01892000
018930                                               626, 628, 629, 630,01893000
018940                                               631, 632.          01894000
018950         88  CD-335-89-TX                VALUE 608, 614.          01895000
018960         88  CD-335-91-TX                VALUE 529, 546, 547, 548,01896000
018970                                               599.               01897000
018980         88  CD-313-29-TX                VALUE 700 THRU 710, 741, 01898000
018990                                               748,               01899000
019000                                               760 THRU 771,      01900000
019010                                               773 THRU 780,      01901000
019020                                               820, 860, 870, 874,01902000
019030                                               892, 878, 902, 904,01903000
019040                                               906 THRU 910, 913, 01904000
019050                                               920, 922 THRU 926, 01905000
019060                                               972, 973, 980,     01906000
019070                                               988, 990.          01907000
019080         88  CD-313-89-TX                VALUE 880, 901, 970.     01908000
019090         88  CD-313-91-TX                VALUE 759, 772, 783, 790,01909000
019100                                               791, 793, 798, 815,01910000
019110                                               818, 819, 821, 822,01911000
019120                                               829, 834, 838, 840,01912000
019130                                               846, 879, 882, 884,01913000
019140                                               887, 896, 897, 905,01914000
019150                                               908.               01915000
019160         88  CD-NO-OFFSET                VALUE 460, 470, 480,     01916000
019170                                               490 THRU 538, 545  01917000
019180                                               551 THRU 589,      01918000
019190                                               595 THRU 598,      01919000
019200                                               611 THRU 613,      01920000
019210                                               615 THRU 618,      01921000
019220                                               621, 622, 627      01922000
019230                                               633 THRU 671,      01923000
019240                                               673 THRU 689,      01924000
019250                                               720 THRU 747,      01925000
019260                                               749 THRU 758,      01926000
019270                                               781 THRU 782,      01927000
019280                                               784 THRU 789,      01928000
019290                                               792,               01929000
019300                                               794 THRU 797,      01930000
019310                                               799 THRU 814,      01931000
019320                                               816 THRU 817,      01932000
019330                                               823 THRU 828,      01933000
019340                                               830 THRU 833,      01934000
019350                                               835 THRU 837,      01935000
019360                                               839,               01936000
019370                                               841 THRU 845,      01937000
019380                                               847 THRU 859,      01938000
019390                                               861 THRU 869,      01939000
019400                                               871 THRU 873,      01940000
019410                                               875 THRU 877,      01941000
019420                                               881, 883, 885, 886,01942000
019430                                               888, 889, 893, 894 01943000
019440                                               890 THRU 891,      01944000
019450                                               898, 899,          01945000
019460                                               900, 903, 915,     01946000
019470                                               917, 918,          01947000
019480                                               921 THRU 922,      01948000
019490                                               927 THRU 962, 971, 01949000
019500                                               974 THRU 978,      01950000
019510                                               981 THRU 989.      01951000
019520         88  AA-CODE-296                 VALUE 490, 520, 530,     01952000
019530                                               540, 542, 543,     01953000
019540                                               544, 549, 580,     01954000
019550                                               700, 705, 710,     01955000
019560                                               860, 870, 874,     01956000
019570                                               878, 910, 913,     01957000
019580                                               960, 990.          01958000
019590         88  PREPAID-CREDIT              VALUE 505, 510, 515,     01959000
019600                                               535, 540, 541,     01960000
019610                                               542, 543, 544,     01961000
019620                                               545, 549, 550,     01962000
019630                                               570, 590, 600,     01963000
019640                                               601, 602, 603,     01964000
019650                                               604, 605, 606,     01965000
019660                                               610, 611, 612,     01966000
019670                                               613, 614, 618,     01967000
019680                                               620, 623, 624,     01968000
019690                                               625, 668, 669,     01969000
019700                                               685, 632, 500,     01970000
019710                                               521, 547, 560,     01971000
019720                                               580, 615, 626,     01972000
019730                                               516.               01973000
019740         88  PREPAID-DEBIT               VALUE 750, 761, 763,     01974000
019750                                               770, 771, 748,     01975000
019760                                               772, 773, 775,     01976000
019770                                               776, 777, 778,     01977000
019780                                               779, 780, 781,     01978000
019790                                               782, 783, 784,     01979000
019800                                               818, 850, 879,     01980000
019810                                               880, 901, 902,     01981000
019820                                               904, 905, 920,     01982000
019830                                               923, 924, 925,     01983000
019840                                               970, 892, 705,     01984000
019850                                               730, 764, 766,     01985000
019860                                               768, 789, 792,     01986000
019870                                               830, 908.          01987000
019880         88  WIRE-TX-CODE                VALUE 888, 889, 890,     01988000
019890                                               891, 893, 894,     01989000
019900                                               898, 899.          01990000
019910                                                                  01991000
019920                                                                  01992000
019930     02  END-OF-PERIOD-IND   PIC 9       VALUE ZERO      COMP-3.  01993000
019940         88  END-OF-PERIOD               VALUE 1.                 01994000
019950     02  HOLD-APYE-INTEREST-RATE                                  01995000
019960                             PIC S99V9(7) VALUE ZERO     COMP-3.  01996000
019970     02  HOLD-APYE-INT-RATE REDEFINES HOLD-APYE-INTEREST-RATE     01997000
019980                             PIC SV9(9)                  COMP-3.  01998000
019990     02  HOLD-GROSS-DAILY-INT                                     01999000
020000                             PIC S9(9)V99 VALUE ZERO     COMP-3.  02000000
020010     02  HOLD-ACTUAL-ACCR-INT                                     02001000
020020                             PIC S9(8)V9(5) VALUE +0 COMP-3.      02002000
020030     02  OA-NSF-CNT          PIC S9(5)   VALUE ZERO      COMP-3.  02003000
020040     02  OA-NSF-FEE-AMT      PIC S9(5)V99 VALUE ZERO     COMP-3.  02004000
020050     02  HOLD-AVG-RP-INTEREST-RATE                                02005000
020060                             PIC S9(8)V9(7) VALUE ZERO   COMP-3.  02006000
020070     02  AA-IMPL-DATE        PIC X(10)   VALUE SPACES.            02007000
020080                                                                  02008000
020090 01  FILLER                  PIC X(16)   VALUE 'DATE-AROUND'.     02009000
020100 01  DATE-AROUND.                                                 02010000
020110     02  YYMMDD-DATE         PIC 9(6)    VALUE ZERO.              02011000
020120     02  FILLER REDEFINES YYMMDD-DATE.                            02012000
020130         03  YYMMDD-YR       PIC 99.                              02013000
020140         03  YYMMDD-MO       PIC 99.                              02014000
020150         03  YYMMDD-DA       PIC 99.                              02015000
020160     02  MMDDYY-DATE         PIC 9(6)    VALUE ZERO.              02016000
020170     02  FILLER REDEFINES MMDDYY-DATE.                            02017000
020180         03  MMDDYY-MO       PIC 99.                              02018000
020190         03  MMDDYY-DA       PIC 99.                              02019000
020200         03  MMDDYY-YR       PIC 99.                              02020000
020210                                                                  02021000
020220 01  FILLER                  PIC X(16)   VALUE 'HEAD DATE WORK'.  02022000
020230 01  HEADING-DATE-WORK.                                           02023000
020240     02  H-DT-WK.                                                 02024000
020250         03  H-DT-MO         PIC 99.                              02025000
020260         03  FILLER          PIC X       VALUE '/'.               02026000
020270         03  H-DT-DA         PIC 99.                              02027000
020280         03  FILLER          PIC X       VALUE '/'.               02028000
020290         03  H-DT-YR         PIC 99.                              02029000
020300                                                                  02030000
020310 01  FILLER                  PIC X(16)   VALUE 'LPROC DT YR TYP'. 02031000
020320 01  LAST-PROC-DATE-YEAR-TYPE.                                    02032000
020330     02  LST-PROC-DT-YR-TYP  PIC X       VALUE SPACE.             02033000
020340         88  LST-PROC-DT-NORM-YR         VALUE '1'.               02034000
020350         88  LST-PROC-DT-LEAP-YR         VALUE '2'.               02035000
020360                                                                  02036000
020370 01  FILLER                  PIC X(16)   VALUE 'OBS BAT-SEQ-WORK'.02037000
020380 01  OBS-BAT-SEQ-WORK-AREA.                                       02038000
020390     03  OBS-BAT-SEQ-WK      PIC 9(10)   VALUE ZERO.              02039000
020400     03  FILLER REDEFINES OBS-BAT-SEQ-WK.                         02040000
020410         05  OBS-BAT-NO      PIC 9(5).                            02041000
020420         05  OBS-SEQ-NO      PIC 9(5).                            02042000
020430                                                                  02043000
020440 01  FILLER                  PIC X(16)   VALUE 'OBS FIELD1 WORK'. 02044000
020450 01  OBS-FIELD1-WORK-AREA.                                        02045000
020460     03  OBS-FIELD1-WK       PIC 9(13)   VALUE ZERO      COMP-3.  02046000
020470     03  FILLER REDEFINES OBS-FIELD1-WK.                          02047000
020480         05  OBS-FIELD1-AMT-WK                                    02048000
020490                             PIC 9(11)V99                COMP-3.  02049000
020500                                                                  02050000
020510 01  FILLER                  PIC X(16)   VALUE 'INV MAT DT WORK'. 02051000
020520 01  INV-MAT-DATE-WORK-AREA.                                      02052000
020530     02  INV-MAT-DT-WK       PIC 9(7)    VALUE ZERO.              02053000
020540     02  FILLER REDEFINES INV-MAT-DT-WK.                          02054000
020550         03  INV-MAT-DT-YYYY PIC 9(4).                            02055000
020560         03  INV-MAT-DT-DDD  PIC 999.                             02056000
020570                                                                  02057000
020580 01  FILLER                  PIC X(16)   VALUE 'CDC DT RTN WORK'. 02058000
020590 01  CDC-DATE-ROUTINE-WORK-AREA.                                  02059000
020600     02  GDATE-01            PIC X(8)    VALUE SPACES.            02060000
020610     02  GDATE-04            PIC 9(7)    VALUE ZERO      COMP-3.  02061000
020620     02  JDATE-04            PIC 9(5)    VALUE ZERO      COMP-3.  02062000
020630     02  JDATE-11            PIC 9(5)    VALUE ZERO      COMP-3.  02063000
020640     02  DAYS-11             PIC 9(5)    VALUE ZERO      COMP-3.  02064000
020650     02  DAYS-15             PIC 9(5)    VALUE ZERO      COMP-3.  02065000
020660     02  END-DATE-15         PIC 9(7)    VALUE ZERO      COMP-3.  02066000
020670     02  MONTHS-12           PIC 9(5)    VALUE ZERO      COMP-3.  02067000
020680     02  MGDATE-23           PIC 9(9)    VALUE ZERO      COMP-3.  02068000
020690     02  DAYS-IN-MO-30       PIC 9(3)    VALUE ZERO      COMP-3.  02069000
020700     02  MJDATE-46           PIC 9(7)    VALUE ZERO      COMP-3.  02070000
020710     02  FILLER REDEFINES MJDATE-46.                              02071000
020720         03  FILLER          PIC X(2).                            02072000
020730         03  MJDATE-46-DDD   PIC 9(3)                    COMP-3.  02073000
020740     02  MJDATE-DIFF         PIC 9(7)    VALUE ZERO      COMP-3.  02074000
020750     02  SCHK-DATE-PAID-48   PIC X(10)   VALUE '0001-01-01'.      02075000
020760     02  NUM-OF-MONTHS       PIC 9(5)    VALUE ZERO      COMP-3.  02076000
020770     02  NUM-OF-YEARS        PIC 9(5)    VALUE ZERO      COMP-3.  02077000
020780     02  HOLD-DAYS-IN-MMM    PIC 9(3)    VALUE ZERO      COMP-3.  02078000
020790     02  HOLD-DAYS-IN-YYY    PIC 9(3)    VALUE ZERO      COMP-3.  02079000
020800                                                                  02080000
020810 01  FILLER                  PIC X(16)   VALUE 'INV DATE WORK'.   02081000
020820 01  INVESTMENT-DATE-WORK.                                        02082000
020830     02  INV-DATE-WK         PIC X(8).                            02083000
020840     02  FILLER REDEFINES INV-DATE-WK.                            02084000
020850         03  INV-DT-MO       PIC 99.                              02085000
020860         03  FILLER          PIC X(4).                            02086000
020870         03  INV-DT-YR       PIC 99.                              02087000
020880                                                                  02088000
020890 01  FILLER                  PIC X(16)   VALUE 'ODB DATE WORK'.   02089000
020900 01  OVERDRAFT-BANKING-DATE-WORK.                                 02090000
020910     02  ODB-MAT-END-DATE    PIC S9(7)   VALUE ZERO      COMP-3.  02091000
020920     02  ODB-MAT-DATE-1      PIC 9(9)    VALUE ZERO.              02092000
020930     02  FILLER REDEFINES ODB-MAT-DATE-1.                         02093000
020940         03  FILLER          PIC X.                               02094000
020950         03  ODB-MAT-YR      PIC 9(4).                            02095000
020960         03  ODB-MAT-MO      PIC 99.                              02096000
020970         03  ODB-MAT-DA      PIC 99.                              02097000
020980     02  ODB-MAT-DATE-2      PIC S9(9)   VALUE ZERO      COMP-3.  02098000
020990                                                                  02099000
021000 01  OPERATOR-WORK-AREA.                                          02100000
021010     02  OPERATOR.                                                02101000
021020         03  OPER-NUM            PIC 9(5).                        02102000
021030         03  FILLER              PIC X(5).                        02103000
021040                                                                  02104000
021050 01  HOLD-TYPE-WORK-AREA.                                         02105000
021060     02  HOLD-TYPE-WORK       PIC 999.                            02106000
021070     02  FILLER REDEFINES HOLD-TYPE-WORK.                         02107000
021080         03  FILLER           PIC XX.                             02108000
021090         03  HOLD-TYPE-X      PIC X.                              02109000
021100                                                                  02110000
021110 01  FILLER                  PIC X(16)   VALUE 'DSDS PRINT LINES'.02111000
021120****** P * R * I * N * T ********AREAS******** P * R * I * N * T *02112000
021130 01  DSDS-HEAD-1.                                                 02113000
021140     COPY DSDRHEAD.                                               02114000
021150                                                                  02115000
021160 01  SPACE-LINE.                                                  02116000
021170     02  FILLER              PIC X(80)   VALUE SPACES.            02117000
021180     02  FILLER              PIC X(53)   VALUE SPACES.            02118000
021190                                                                  02119000
021200 01  FILLER                  PIC X(16)   VALUE 'PJ HEAD LINE 3'.  02120000
021210 01  PJ-HEADING-LINE-3.                                           02121000
021220     02  FILLER              PIC X(14)   VALUE SPACES.            02122000
021230     02  FILLER              PIC X(16)   VALUE '*---------------'.02123000
021240     02  FILLER              PIC X(16)   VALUE '---------------D'.02124000
021250     02  FILLER              PIC X       VALUE ' '.               02125000
021260     02  FILLER              PIC X(16)   VALUE 'E B I T S-------'.02126000
021270     02  FILLER              PIC X(16)   VALUE '----------------'.02127000
021280     02  FILLER              PIC X(16)   VALUE '------*    *----'.02128000
021290     02  FILLER              PIC X(16)   VALUE '------C R E D I '.02129000
021300     02  FILLER              PIC X(16)   VALUE 'T S---------*   '.02130000
021310     02  FILLER              PIC X(6)    VALUE 'DATE  '.          02131000
021320                                                                  02132000
021330 01  FILLER                  PIC X(16)   VALUE 'PJ HEAD LINE 4'.  02133000
021340 01  PJ-HEADING-LINE-4.                                           02134000
021350     02  FILLER              PIC X(16)   VALUE '    ACCOUNT     '.02135000
021360     02  FILLER              PIC X(16)   VALUE ' ITEM     TX    '.02136000
021370     02  FILLER              PIC X(16)   VALUE '  AMOUNT    EFF.'.02137000
021380     02  FILLER              PIC X(16)   VALUE '       ITEM     '.02138000
021390     02  FILLER              PIC X(16)   VALUE 'TX      AMOUNT  '.02139000
021400     02  FILLER              PIC X(16)   VALUE '  EFF.       ITE'.02140000
021410     02  FILLER              PIC X(16)   VALUE 'M     TX      AM'.02141000
021420     02  FILLER              PIC X(16)   VALUE 'OUNT    EFF.   L'.02142000
021430     02  FILLER              PIC X(5)    VALUE 'AST  '.           02143000
021440                                                                  02144000
021450 01  FILLER                  PIC X(16)   VALUE 'PJ HEAD LINE 5'.  02145000
021460 01  PJ-HEADING-LINE-5.                                           02146000
021470     02  FILLER              PIC X(16)   VALUE '  ID  NUMBER    '.02147000
021480     02  FILLER              PIC X(16)   VALUE ' I.D.           '.02148000
021490     02  FILLER              PIC X(16)   VALUE '            DAYS'.02149000
021500     02  FILLER              PIC X(16)   VALUE '       I.D.     '.02150000
021510     02  FILLER              PIC X(16)   VALUE '                '.02151000
021520     02  FILLER              PIC X(16)   VALUE '  DAYS       I.D'.02152000
021530     02  FILLER              PIC X(16)   VALUE '.               '.02153000
021540     02  FILLER              PIC X(16)   VALUE '        DAYS ACT'.02154000
021550     02  FILLER              PIC X(5)    VALUE 'IVITY'.           02155000
021560                                                                  02156000
021570 01  FILLER                  PIC X(16)   VALUE 'PJ-DETAIL-LINE'.  02157000
021580 01  PJ-DETAIL-LINE.                                              02158000
021590     02  FILLER              PIC X.                               02159000
021600     02  PJ-ACCT-ID          PIC XXX.                             02160000
021610     02  FILLER              PIC X       VALUE ' '.               02161000
021620     02  PJ-ACCT-NO          PIC X(9)    JUST RIGHT.              02162000
021630     02  PJ-ITEM-ID1.                                             02163000
021640         03  PJ-BATCH-NO1    PIC ZZZZZ.                           02164000
021650         03  PJ-SEQ-NO1      PIC ZZZZZ.                           02165000
021660     02  FILLER              PIC X       VALUE SPACES.            02166000
021670     02  PJ-TX1              PIC 999.                             02167000
021680     02  PJ-AMOUNT1          PIC ZZZZZZZZZ.99.                    02168000
021690     02  PJ-CODE1            PIC XXX.                             02169000
021700     02  FILLER              PIC X       VALUE SPACES.            02170000
021710     02  PJ-EFF-DAYS1        PIC ZZZ.                             02171000
021720     02  FILLER              PIC X(5)    VALUE SPACES.            02172000
021730     02  PJ-ITEM-ID2.                                             02173000
021740         03  PJ-BATCH-NO2    PIC ZZZZZ.                           02174000
021750         03  PJ-SEQ-NO2      PIC ZZZZZ.                           02175000
021760     02  FILLER              PIC X       VALUE SPACES.            02176000
021770     02  PJ-TX2              PIC 999.                             02177000
021780     02  PJ-AMOUNT2          PIC ZZZZZZZZZ.99.                    02178000
021790     02  PJ-CODE2            PIC XXX.                             02179000
021800     02  FILLER              PIC X       VALUE SPACES.            02180000
021810     02  PJ-EFF-DAYS2        PIC ZZZ.                             02181000
021820     02  FILLER              PIC X(5)    VALUE SPACES.            02182000
021830     02  PJ-ITEM-ID3.                                             02183000
021840         03  PJ-BATCH-NO3    PIC ZZZZZ.                           02184000
021850         03  PJ-SEQ-NO3      PIC ZZZZZ.                           02185000
021860     02  FILLER              PIC X       VALUE SPACES.            02186000
021870     02  PJ-TX3              PIC 999.                             02187000
021880     02  PJ-AMOUNT3          PIC ZZZZZZZZZ.99.                    02188000
021890     02  PJ-CODE3            PIC XXX.                             02189000
021900     02  FILLER              PIC X       VALUE SPACES.            02190000
021910     02  PJ-EFF-DAYS3        PIC ZZZ.                             02191000
021920     02  FILLER              PIC XX      VALUE SPACES.            02192000
021930     02  PJ-DT-LAST-ACT      PIC X(8).                            02193000
021940                                                                  02194000
021950 01  FILLER                  PIC X(16)   VALUE 'PJ-TOTAL-LINE'.   02195000
021960 01  PJ-TOTAL-LINE.                                               02196000
021970     02  FILLER              PIC X(11)   VALUE SPACES.            02197000
021980     02  PJ-TOTAL-DESC       PIC X(20).                           02198000
021990     02  FILLER              PIC X(4)    VALUE SPACES.            02199000
022000     02  PJ-TOTAL-NO         PIC ZZZZZZZ.                         02200000
022010     02  FILLER              PIC XXX     VALUE SPACES.            02201000
022020     02  PJ-TOTAL-AMOUNT     PIC ZZZ,ZZZ,ZZZ,ZZZ.99.              02202000
022030     02  FILLER              PIC X(70)   VALUE SPACES.            02203000
022040                                                                  02204000
022050 01  FILLER                  PIC X(16)   VALUE 'PJ-TOTAL-ACCUMS'. 02205000
022060 01  PJ-TOTAL-ACCUMS.                                             02206000
022070     02  PJ-DEB-NO           PIC S9(7)       VALUE +0    COMP-3.  02207000
022080     02  PJ-CRE-NO           PIC S9(7)       VALUE +0    COMP-3.  02208000
022090     02  PJ-DEB-AMT          PIC S9(11)V99   VALUE +0    COMP-3.  02209000
022100     02  PJ-CRE-AMT          PIC S9(11)V99   VALUE +0    COMP-3.  02210000
022110     02  PJ-HOLD-CODE        PIC XXX     VALUE SPACES.            02211000
022120                                                                  02212000
022130 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 3'.  02213000
022140 01  DT-HEADING-LINE-3.                                           02214000
022150     02  FILLER              PIC X(41)   VALUE SPACES.            02215000
022160     02  FILLER              PIC X(16)   VALUE 'PERCENT OF    CU'.02216000
022170     02  FILLER              PIC X(16)   VALUE 'RRENT    PERCENT'.02217000
022180     02  FILLER              PIC XXX     VALUE ' OF'.             02218000
022190     02  FILLER              PIC X(73)   VALUE SPACES.            02219000
022200                                                                  02220000
022210 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 4'.  02221000
022220 01  DT-HEADING-LINE-4.                                           02222000
022230     02  FILLER              PIC X(16)   VALUE ' STRATIFICATION '.02223000
022240     02  FILLER              PIC X(16)   VALUE '               N'.02224000
022250     02  FILLER              PIC X(16)   VALUE 'UMBER   TOTAL NU'.02225000
022260     02  FILLER              PIC X(16)   VALUE 'MBER   BALANCE  '.02226000
022270     02  FILLER              PIC X(12)   VALUE '  TOTAL BAL.'.    02227000
022280     02  FILLER              PIC X(73)   VALUE SPACES.            02228000
022290                                                                  02229000
022300 01  FILLER                  PIC X(16)   VALUE 'DT-DETAIL-LINE-1'.02230000
022310 01  DT-DETAIL-LINE-1.                                            02231000
022320     02  FILLER              PIC X(5)    VALUE SPACES.            02232000
022330     02  DT1-DESCRIPTION     PIC X(24).                           02233000
022340     02  DT1-NUMBER          PIC ZZZZ,ZZZ.                        02234000
022350     02  FILLER              PIC X(5)    VALUE SPACES.            02235000
022360     02  DT1-PERCENT-NO      PIC ZZZ.99.                          02236000
022370     02  DT1-BALANCE         PIC ZZ,ZZZ,ZZZ,ZZZ.99-.              02237000
022380     02  FILLER              PIC X       VALUE SPACE.             02238000
022390     02  DT1-PERCENT-BAL     PIC ZZZ.99.                          02239000
022400     02  DT1-VARIABLE        PIC X(60)   VALUE SPACES.            02240000
022410     02  FILLER REDEFINES DT1-VARIABLE.                           02241000
022420         03  DT1-BEGIN-ACCRU PIC ZZZZ,ZZZ.99999-.                 02242000
022430         03  DT1-TODAYS-EXP  PIC ZZZZ,ZZZ.99999-.                 02243000
022440         03  DT1-PAID-TODAY  PIC ZZZ,ZZZ,ZZZ.ZZ-.                 02244000
022450         03  DT1-END-ACCRU   PIC ZZZZ,ZZZ.99999-.                 02245000
022460     02  FILLER REDEFINES DT1-VARIABLE.                           02246000
022470         03  FILLER          PIC X(6).                            02247000
022480         03  DT1-NO-CREDITS  PIC ZZZ,ZZZ.                         02248000
022490         03  FILLER          PIC X.                               02249000
022500         03  DT1-AMT-CREDITS PIC ZZ,ZZZ,ZZZ,ZZZ.99.               02250000
022510         03  FILLER          PIC X(3).                            02251000
022520         03  DT1-NO-DEBITS   PIC ZZZ,ZZZ.                         02252000
022530         03  FILLER          PIC X.                               02253000
022540         03  DT1-AMT-DEBITS  PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ.               02254000
022550         03  FILLER          PIC X.                               02255000
022560     02  FILLER REDEFINES DT1-VARIABLE.                           02256000
022570         03  FILLER          PIC X(13).                           02257000
022580         03  DT1-NUMBER-2    PIC ZZZZ,ZZZ.                        02258000
022590         03  FILLER          PIC X(5).                            02259000
022600         03  DT1-PERCENT-NO-2 PIC ZZZ.99.                         02260000
022610         03  DT1-BALANCE-2   PIC ZZ,ZZZ,ZZZ,ZZZ.99-.              02261000
022620         03  FILLER          PIC X.                               02262000
022630         03  DT1-PERCENT-BAL-2 PIC ZZZ.99.                        02263000
022640         03  FILLER          PIC X(3).                            02264000
022650                                                                  02265000
022660 01  FILLER                  PIC X(16)   VALUE 'DT-DASH-LINE-1'.  02266000
022670 01  DT-DASH-LINE-1.                                              02267000
022680     02  FILLER              PIC X(30)   VALUE SPACES.            02268000
022690     02  FILLER              PIC X(16)   VALUE '-------     ----'.02269000
022700     02  FILLER              PIC X(16)   VALUE '-- -------------'.02270000
022710     02  FILLER              PIC X(11)   VALUE '---  ------'.     02271000
022720     02  FILLER              PIC X(76)   VALUE SPACES.            02272000
022730                                                                  02273000
022740 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 5'.  02274000
022750 01  DT-HEADING-LINE-5.                                           02275000
022760     02  FILLER              PIC X(12)   VALUE '      MASTER'.    02276000
022770     02  FILLER              PIC X(58)   VALUE SPACES.            02277000
022780     02  FILLER              PIC XXX     VALUE 'ODB'.             02278000
022790     02  FILLER              PIC X(60)   VALUE SPACES.            02279000
022800                                                                  02280000
022810 01  FILLER                  PIC X(16)   VALUE 'DT-DETAIL-LINE-2'.02281000
022820 01  DT-DETAIL-LINE-2.                                            02282000
022830     02  FILLER              PIC X(5)    VALUE SPACES.            02283000
022840     02  DT2-DESCRIPTION1    PIC X(24).                           02284000
022850     02  DT2-NUMBER1         PIC ZZZZ,ZZZ.                        02285000
022860     02  FILLER              PIC X(2)    VALUE SPACES.            02286000
022870     02  DT2-BALANCE1        PIC ZZ,ZZZ,ZZZ,ZZZ.99.               02287000
022880     02  FILLER              PIC X(5)    VALUE SPACES.            02288000
022890     02  DT2-DESCRIPTION2    PIC X(24).                           02289000
022900     02  DT2-NUMBER2         PIC ZZZZ,ZZZ.                        02290000
022910     02  FILLER              PIC X(2)    VALUE SPACES.            02291000
022920     02  DT2-BALANCE2        PIC ZZ,ZZZ,ZZZ,ZZZ.99.               02292000
022930     02  FILLER              PIC X(21)   VALUE SPACES.            02293000
022940                                                                  02294000
022950 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 5A'. 02295000
022960 01  DT-HEADING-LINE-5A.                                          02296000
022970     02  FILLER              PIC X(34)   VALUE SPACES.            02297000
022980     02  FILLER              PIC X(11)   VALUE 'ACCTS WITH'.      02298000
022990     02  FILLER              PIC X(11)   VALUE 'CHECKS'.          02299000
023000     02  FILLER              PIC X(20)   VALUE 'ACCTS TRUNCATED'. 02300000
023010     02  FILLER              PIC X(57)   VALUE 'ACCTS IMAGED'.    02301000
023020                                                                  02302000
023030 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 5B'. 02303000
023040 01  DT-HEADING-LINE-5B.                                          02304000
023050     02  FILLER              PIC X(05)   VALUE SPACES.            02305000
023060     02  FILLER              PIC X(10)   VALUE 'STATEMENT'.       02306000
023070     02  FILLER              PIC X(19)   VALUE 'COUNTERS'.        02307000
023080     02  FILLER              PIC X(11)   VALUE 'STMTS WITH'.      02308000
023090     02  FILLER              PIC X(11)   VALUE 'CHECKS'.          02309000
023100     02  FILLER              PIC X(20)   VALUE 'STMTS TRUNCATED'. 02310000
023110     02  FILLER              PIC X(57)   VALUE 'STMTS IMAGED'.    02311000
023120                                                                  02312000
023130 01  FILLER                  PIC X(16)   VALUE 'DT-DETAIL-LINE-4'.02313000
023140 01  DT-DETAIL-LINE-4.                                            02314000
023150     02  FILLER              PIC X(5)    VALUE SPACES.            02315000
023160     02  DT4-DESCRIPTION1    PIC X(24).                           02316000
023170     02  FILLER              PIC X(10)   VALUE SPACES.            02317000
023180     02  DT4-NUMBER1         PIC ZZ,ZZ9.                          02318000
023190     02  FILLER              PIC X(15)   VALUE SPACES.            02319000
023200     02  DT4-NUMBER2         PIC ZZ,ZZ9.                          02320000
023210     02  FILLER              PIC X(13)   VALUE SPACES.            02321000
023220     02  DT4-NUMBER3         PIC ZZ,ZZ9.                          02322000
023230     02  FILLER              PIC X(48)   VALUE SPACES.            02323000
023240                                                                  02324000
023250 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 6'.  02325000
023260 01  DT-HEADING-LINE-6.                                           02326000
023270     02  FILLER              PIC X(16)   VALUE '          ACCOUN'.02327000
023280     02  FILLER              PIC X       VALUE 'T'.               02328000
023290     02  FILLER              PIC X(62)   VALUE SPACES.            02329000
023300     02  FILLER              PIC X(16)   VALUE '*---------------'.02330000
023310     02  FILLER              PIC X(7)    VALUE '-------'.         02331000
023320     02  FILLER              PIC X(8)    VALUE 'INTEREST'.        02332000
023330     02  FILLER              PIC X(16)   VALUE '----------------'.02333000
023340     02  FILLER              PIC X(7)    VALUE '------*'.         02334000
023350                                                                  02335000
023360 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 7'.  02336000
023370 01  DT-HEADING-LINE-7.                                           02337000
023380     02  FILLER              PIC X(16)   VALUE '      CLASSIFICA'.02338000
023390     02  FILLER              PIC X(16)   VALUE 'TION            '.02339000
023400     02  FILLER              PIC X(16)   VALUE '         PERCENT'.02340000
023410     02  FILLER              PIC X(16)   VALUE ' OF    CURRENT  '.02341000
023420     02  FILLER              PIC X(16)   VALUE '  PERCENT OF   B'.02342000
023430     02  FILLER              PIC X(16)   VALUE 'EGINNING        '.02343000
023440     02  FILLER              PIC X(16)   VALUE 'ACCRUED     PAID'.02344000
023450     02  FILLER              PIC X(16)   VALUE '/DROPPED/    END'.02345000
023460     02  FILLER              PIC X(5)    VALUE 'ING  '.           02346000
023470                                                                  02347000
023480 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 8'.  02348000
023490 01  DT-HEADING-LINE-8.                                           02349000
023500     02  FILLER              PIC X(16)   VALUE '                '.02350000
023510     02  FILLER              PIC X(16)   VALUE '               N'.02351000
023520     02  FILLER              PIC X(16)   VALUE 'UMBER   TOTAL NU'.02352000
023530     02  FILLER              PIC X(16)   VALUE 'MBER   BALANCE  '.02353000
023540     02  FILLER              PIC X(16)   VALUE '  TOTAL BAL.    '.02354000
023550     02  FILLER              PIC X(16)   VALUE 'ACCRUAL         '.02355000
023560     02  FILLER              PIC X(16)   VALUE ' TODAY     WITHH'.02356000
023570     02  FILLER              PIC X(16)   VALUE 'ELD TODAY    ACC'.02357000
023580     02  FILLER              PIC X(5)    VALUE 'RUAL '.           02358000
023590                                                                  02359000
023600 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 9'.  02360000
023610 01  DT-HEADING-LINE-9.                                           02361000
023620     02  FILLER              PIC X(41)   VALUE SPACES.            02362000
023630     02  FILLER              PIC X(16)   VALUE 'PERCENT OF    CU'.02363000
023640     02  FILLER              PIC X(16)   VALUE 'RRENT    PERCENT'.02364000
023650     02  FILLER              PIC X(16)   VALUE ' OF  *---------C'.02365000
023660     02  FILLER              PIC X(16)   VALUE 'REDITS---------*'.02366000
023670     02  FILLER              PIC X(16)   VALUE ' *----------DEBI'.02367000
023680     02  FILLER              PIC X(12)   VALUE 'TS---------*'.    02368000
023690                                                                  02369000
023700 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 10'. 02370000
023710 01  DT-HEADING-LINE-10.                                          02371000
023720     02  FILLER              PIC X(16)   VALUE '      TYPE      '.02372000
023730     02  FILLER              PIC X(16)   VALUE '               N'.02373000
023740     02  FILLER              PIC X(16)   VALUE 'UMBER   TOTAL NU'.02374000
023750     02  FILLER              PIC X(16)   VALUE 'MBER   BALANCE  '.02375000
023760     02  FILLER              PIC X(16)   VALUE '  TOTAL BAL.    '.02376000
023770     02  FILLER              PIC X(16)   VALUE 'NUMBER         A'.02377000
023780     02  FILLER              PIC X(16)   VALUE 'MOUNT       NUMB'.02378000
023790     02  FILLER              PIC X(16)   VALUE 'ER         AMOUN'.02379000
023800     02  FILLER              PIC X(5)    VALUE 'T    '.           02380000
023810                                                                  02381000
023820 01  FILLER                  PIC X(16)   VALUE 'DT-DASH-LINE-2'.  02382000
023830 01  DT-DASH-LINE-2.                                              02383000
023840     02  FILLER              PIC X(16)   VALUE '                '.02384000
023850     02  FILLER              PIC X(16)   VALUE '             ---'.02385000
023860     02  FILLER              PIC X(16)   VALUE '-----     ------'.02386000
023870     02  FILLER              PIC X(16)   VALUE '  --------------'.02387000
023880     02  FILLER              PIC X(16)   VALUE '-  ------     --'.02388000
023890     02  FILLER              PIC X(16)   VALUE '------    ------'.02389000
023900     02  FILLER              PIC X(16)   VALUE '--------  ------'.02390000
023910     02  FILLER              PIC X(16)   VALUE '--   -----------'.02391000
023920     02  FILLER              PIC X(5)    VALUE '-----'.           02392000
023930                                                                  02393000
023940 01  FILLER                  PIC X(16)   VALUE 'DT-DASH-LINE-3'.  02394000
023950 01  DT-DASH-LINE-3.                                              02395000
023960     02  FILLER              PIC X(29)   VALUE SPACES.            02396000
023970     02  FILLER              PIC X(16)   VALUE '--------     ---'.02397000
023980     02  FILLER              PIC X(16)   VALUE '---  -----------'.02398000
023990     02  FILLER              PIC X(16)   VALUE '----  ------ ---'.02399000
024000     02  FILLER              PIC X(16)   VALUE '----------- ----'.02400000
024010     02  FILLER              PIC X(16)   VALUE '---------- -----'.02401000
024020     02  FILLER              PIC X(16)   VALUE '--------- ------'.02402000
024030     02  FILLER              PIC X(8)    VALUE '--------'.        02403000
024040                                                                  02404000
024050 01  FILLER                  PIC X(16)   VALUE 'TP-CONTROL-PRINT'.02405000
024060 01  TP-CONTROL-PRINT.                                            02406000
024070     02  FILLER              PIC X.                               02407000
024080     02  TP-CONTROL-ID       PIC X(6).                            02408000
024090     02  FILLER              PIC X(126)  VALUE SPACES.            02409000
024100                                                                  02410000
024110 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 10A'.02411000
024120 01  DT-HEADING-LINE-10A.                                         02412000
024130     02  FILLER              PIC X(56)   VALUE SPACES.            02413000
024140     02  FILLER              PIC X(16)   VALUE 'TOTAL ACCOUNTS B'.02414000
024150     02  FILLER              PIC X(6)    VALUE 'Y TYPE'.          02415000
024160     02  FILLER              PIC X(55)   VALUE SPACES.            02416000
024170                                                                  02417000
024180 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 12'. 02418000
024190 01  DT-HEADING-LINE-12.                                          02419000
024200     02  FILLER              PIC X(31)   VALUE SPACES.            02420000
024210     02  FILLER              PIC X(16)   VALUE '*------------- T'.02421000
024220     02  FILLER              PIC X(16)   VALUE 'OTAL ACCOUNTS --'.02422000
024230     02  FILLER              PIC X(13)   VALUE '------------*'.   02423000
024240     02  FILLER              PIC X(57)   VALUE SPACES.            02424000
024250                                                                  02425000
024260 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 13'. 02426000
024270 01  DT-HEADING-LINE-13.                                          02427000
024280     02  FILLER              PIC X(31)   VALUE SPACES.            02428000
024290     02  FILLER              PIC X(16)   VALUE '*------- ALL SER'.02429000
024300     02  FILLER              PIC X(16)   VALUE 'VICE CHARGE ROUT'.02430000
024310     02  FILLER              PIC X(13)   VALUE 'INES -------*'.   02431000
024320     02  FILLER              PIC X(57)   VALUE SPACES.            02432000
024330                                                                  02433000
024340 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 17'. 02434000
024350 01  DT-HEADING-LINE-17.                                          02435000
024360     02  FILLER              PIC X(16)   VALUE '     OVERDRAFT B'.02436000
024370     02  FILLER              PIC X(6)    VALUE 'ANKING'.          02437000
024380     02  FILLER              PIC X(57)   VALUE SPACES.            02438000
024390     02  FILLER              PIC X(16)   VALUE '*---------------'.02439000
024400     02  FILLER              PIC X(4)    VALUE '----'.            02440000
024410     02  FILLER              PIC X(14)   VALUE 'FINANCE CHARGE'.  02441000
024420     02  FILLER              PIC X(16)   VALUE '----------------'.02442000
024430     02  FILLER              PIC X(4)    VALUE '---*'.            02443000
024440                                                                  02444000
024450 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 18'. 02445000
024460 01  DT-HEADING-LINE-18.                                          02446000
024470     02  FILLER              PIC X(16)   VALUE '      IDENTIFICA'.02447000
024480     02  FILLER              PIC X(16)   VALUE 'TION            '.02448000
024490     02  FILLER              PIC X(16)   VALUE '         PERCENT'.02449000
024500     02  FILLER              PIC X(16)   VALUE ' OF    CURRENT  '.02450000
024510     02  FILLER              PIC X(16)   VALUE '  PERCENT OF   B'.02451000
024520     02  FILLER              PIC X(16)   VALUE 'EGINNING        '.02452000
024530     02  FILLER              PIC X(16)   VALUE 'ACCRUED      COL'.02453000
024540     02  FILLER              PIC X(16)   VALUE 'LECTED/      END'.02454000
024550     02  FILLER              PIC X(5)    VALUE 'ING  '.           02455000
024560                                                                  02456000
024570 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 19'. 02457000
024580 01  DT-HEADING-LINE-19.                                          02458000
024590     02  FILLER              PIC X(16)   VALUE '                '.02459000
024600     02  FILLER              PIC X(16)   VALUE '               N'.02460000
024610     02  FILLER              PIC X(16)   VALUE 'UMBER   TOTAL NU'.02461000
024620     02  FILLER              PIC X(16)   VALUE 'MBER   BALANCE  '.02462000
024630     02  FILLER              PIC X(16)   VALUE '  TOTAL BAL.    '.02463000
024640     02  FILLER              PIC X(16)   VALUE 'ACCRUAL         '.02464000
024650     02  FILLER              PIC X(16)   VALUE ' TODAY      DROP'.02465000
024660     02  FILLER              PIC X(16)   VALUE 'PED TODAY    ACC'.02466000
024670     02  FILLER              PIC X(5)    VALUE 'RUAL '.           02467000
024680                                                                  02468000
024690 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 20'. 02469000
024700 01  DT-HEADING-LINE-20.                                          02470000
024710     02  FILLER              PIC X(16)   VALUE '        INVESTME'.02471000
024720     02  FILLER              PIC XX      VALUE 'NT'.              02472000
024730     02  FILLER              PIC X(61)   VALUE SPACES.            02473000
024740     02  FILLER              PIC X(16)   VALUE '*---------------'.02474000
024750     02  FILLER              PIC X(12)   VALUE '-INVESTMENT '.    02475000
024760     02  FILLER              PIC X(8)    VALUE 'INTEREST'.        02476000
024770     02  FILLER              PIC X(16)   VALUE '----------------'.02477000
024780     02  FILLER              PIC XX      VALUE '-*'.              02478000
024790                                                                  02479000
024800 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 21'. 02480000
024810 01  DT-HEADING-LINE-21.                                          02481000
024820     02  FILLER              PIC X(28)   VALUE SPACES.            02482000
024830     02  FILLER              PIC X(16)   VALUE 'EXT.  * EXTERNAL'.02483000
024840     02  FILLER              PIC X(16)   VALUE ' CHARGES  *  * E'.02484000
024850     02  FILLER              PIC X(16)   VALUE 'XTERNAL CHARGES '.02485000
024860     02  FILLER              PIC X(16)   VALUE ' *     HARD  *  '.02486000
024870     02  FILLER              PIC X(16)   VALUE ' HARD CHARGES   '.02487000
024880     02  FILLER              PIC X(16)   VALUE ' *  *   HARD CHA'.02488000
024890     02  FILLER              PIC X(9)    VALUE 'RGES    *'.       02489000
024900                                                                  02490000
024910 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 22'. 02491000
024920 01  DT-HEADING-LINE-22.                                          02492000
024930     02  FILLER              PIC X(27)   VALUE SPACES.            02493000
024940     02  FILLER              PIC X(16)   VALUE 'CHARGE *       T'.02494000
024950     02  FILLER              PIC X(16)   VALUE 'ODAY       *  * '.02495000
024960     02  FILLER              PIC X(16)   VALUE '      M-T-D     '.02496000
024970     02  FILLER              PIC X(16)   VALUE '  *    CHARGE * '.02497000
024980     02  FILLER              PIC X(16)   VALUE '      TODAY     '.02498000
024990     02  FILLER              PIC X(16)   VALUE '  *  *       M-T'.02499000
025000     02  FILLER              PIC X(10)   VALUE '-D       *'.      02500000
025010                                                                  02501000
025020 01  FILLER                  PIC X(16)   VALUE 'DT HEAD LINE 23'. 02502000
025030 01  DT-HEADING-LINE-23.                                          02503000
025040     02  FILLER              PIC X(4)    VALUE SPACES.            02504000
025050     02  FILLER              PIC X(16)   VALUE 'DESCRIPTION     '.02505000
025060     02  FILLER              PIC X(16)   VALUE '        CODE  * '.02506000
025070     02  FILLER              PIC X(16)   VALUE ' NO.       AMOUN'.02507000
025080     02  FILLER              PIC X(16)   VALUE 'T *  *  NO.     '.02508000
025090     02  FILLER              PIC X(16)   VALUE '  AMOUNT *     C'.02509000
025100     02  FILLER              PIC X(16)   VALUE 'ODE  *  NO.     '.02510000
025110     02  FILLER              PIC X(16)   VALUE '  AMOUNT *  *  N'.02511000
025120     02  FILLER              PIC X(16)   VALUE 'O.       AMOUNT '.02512000
025130     02  FILLER              PIC X       VALUE '*'.               02513000
025140                                                                  02514000
025150 01  FILLER                  PIC X(16)   VALUE 'DT-DETAIL-LINE-3'.02515000
025160 01  DT-DETAIL-LINE-3.                                            02516000
025170     02  FILLER              PIC X       VALUE SPACES.            02517000
025180     02  DT3-DESC-1          PIC X(26).                           02518000
025190     02  FILLER              PIC XX      VALUE SPACES.            02519000
025200     02  DT3-CODE-1          PIC 999.                             02520000
025210     02  FILLER              PIC XX      VALUE SPACES.            02521000
025220     02  DT3-NUM-1           PIC ZZ,ZZ9.                          02522000
025230     02  FILLER              PIC X       VALUE SPACES.            02523000
025240     02  DT3-AMT-1           PIC ZZZ,ZZZ,ZZZ.99.                  02524000
025250     02  FILLER              PIC XX      VALUE SPACES.            02525000
025260     02  DT3-NUM-2           PIC ZZ,ZZ9.                          02526000
025270     02  FILLER              PIC X       VALUE SPACES.            02527000
025280     02  DT3-AMT-2           PIC ZZZ,ZZZ,ZZZ.99.                  02528000
025290     02  FILLER              PIC X(6)    VALUE SPACES.            02529000
025300     02  DT3-CODE-2          PIC 999.                             02530000
025310     02  FILLER              PIC XX      VALUE SPACES.            02531000
025320     02  DT3-NUM-3           PIC ZZ,ZZ9.                          02532000
025330     02  FILLER              PIC X       VALUE SPACES.            02533000
025340     02  DT3-AMT-3           PIC ZZZ,ZZZ,ZZZ.99.                  02534000
025350     02  FILLER              PIC XX      VALUE SPACES.            02535000
025360     02  DT3-NUM-4           PIC ZZ,ZZ9.                          02536000
025370     02  FILLER              PIC X       VALUE SPACES.            02537000
025380     02  DT3-AMT-4           PIC ZZZ,ZZZ,ZZZ.99.                  02538000
025390                                                                  02539000
025400 01  FILLER                  PIC X(16)   VALUE 'TOTALS BY TYPE'.  02540000
025410 01  TOTALS-BY-TYPE.                                              02541000
025420     05  TYPE-TOTAL OCCURS 100 TIMES.                             02542000
025430         10  NUMBER-BY-TYPE  PIC S9(5)       COMP-3.              02543000
025440         10  CUR-BAL-BY-TYPE PIC S9(11)V99   COMP-3.              02544000
025450         10  NO-DEB-BY-TYPE  PIC S9(5)       COMP-3.              02545000
025460         10  AMT-DEB-BY-TYPE PIC S9(11)V99   COMP-3.              02546000
025470         10  NO-CRE-BY-TYPE  PIC S9(5)       COMP-3.              02547000
025480         10  AMT-CRE-BY-TYPE PIC S9(11)V99   COMP-3.              02548000
025490                                                                  02549000
025500 01  FILLER                  PIC X(16)   VALUE 'SUBTOTAL BY TYPE'.02550000
025510 01  SUBTOTALS-BY-TYPE.                                           02551000
025520     05  TYPE-SUB-TOTALS.                                         02552000
025530         10  NUMBER-SUBTYPE  PIC S9(5)       COMP-3.              02553000
025540         10  CUR-BAL-SUBTYPE PIC S9(11)V99   COMP-3.              02554000
025550         10  NO-DEB-SUBTYPE  PIC S9(5)       COMP-3.              02555000
025560         10  AMT-DEB-SUBTYPE PIC S9(11)V99   COMP-3.              02556000
025570         10  NO-CRE-SUBTYPE  PIC S9(5)       COMP-3.              02557000
025580         10  AMT-CRE-SUBTYPE PIC S9(11)V99   COMP-3.              02558000
025590                                                                  02559000
025600 01  FILLER                  PIC X(16)   VALUE 'TOTALS BY SC'.    02560000
025610 01  TOTALS-BY-SERVICE-CHARGE.                                    02561000
025620     05  SERV-CHRG-TOTAL OCCURS 98 TIMES.                         02562000
025630         10  SC-FEE-BY-SC    PIC S9(9)V99    COMP-3.              02563000
025640                                                                  02564000
025650 01  FILLER                  PIC X(16)   VALUE 'STRATA DESC CLAS'.02565000
025660 01  STRATA-TOTALS-BY-CLASS-DESC.                                 02566000
025670     02  FILLER      PIC X(24)   VALUE 'BANK SUSPENSE ACCOUNTS  '.02567000
025680     02  FILLER      PIC X(24)   VALUE 'OVERDRAFTS              '.02568000
025690     02  FILLER      PIC X(24)   VALUE 'OVERDRAFTS (OD ACCESS)  '.02569000
025700     02  FILLER      PIC X(24)   VALUE '$0 TO $49               '.02570000
025710     02  FILLER      PIC X(24)   VALUE '$50 TO $199             '.02571000
025720     02  FILLER      PIC X(24)   VALUE '$200 TO $499            '.02572000
025730     02  FILLER      PIC X(24)   VALUE '$500 TO $749            '.02573000
025740     02  FILLER      PIC X(24)   VALUE '$750 TO $999            '.02574000
025750     02  FILLER      PIC X(24)   VALUE '$1,000 TO $1,199        '.02575000
025760     02  FILLER      PIC X(24)   VALUE '$1,200 TO $1,499        '.02576000
025770     02  FILLER      PIC X(24)   VALUE '$1,500 TO $4,999        '.02577000
025780     02  FILLER      PIC X(24)   VALUE '$5,000 TO $9,999        '.02578000
025790     02  FILLER      PIC X(24)   VALUE '$10,000 TO $24,999      '.02579000
025800     02  FILLER      PIC X(24)   VALUE '$25,000 TO $99,999      '.02580000
025810     02  FILLER      PIC X(24)   VALUE '$100,000                '.02581000
025820     02  FILLER      PIC X(24)   VALUE '$100.000 TO $250,000    '.02582000
025830     02  FILLER      PIC X(24)   VALUE 'OVER $250,000           '.02583000
025840 01  FILLER REDEFINES STRATA-TOTALS-BY-CLASS-DESC.                02584000
025850     02  STRATA-DESC-BY-CLASS PIC X(24) OCCURS 17 TIMES.          02585000
025860                                                                  02586000
025870 01  FILLER                  PIC X(16)   VALUE 'STRATA DESC SC  '.02587000
025880 01  STRATA-TOTALS-BY-SC-DESC.                                    02588000
025890     02  FILLER      PIC X(24)   VALUE 'BANK SUSPENSE ACCOUNTS  '.02589000
025900     02  FILLER      PIC X(24)   VALUE 'OVERDRAFTS              '.02590000
025910     02  FILLER      PIC X(24)   VALUE 'OVERDRAFTS (OD ACCESS)  '.02591000
025920     02  FILLER      PIC X(24)   VALUE '$0 TO $99               '.02592000
025930     02  FILLER      PIC X(24)   VALUE '$100 TO $299            '.02593000
025940     02  FILLER      PIC X(24)   VALUE '$300 TO $749            '.02594000
025950     02  FILLER      PIC X(24)   VALUE '$750 TO $999            '.02595000
025960     02  FILLER      PIC X(24)   VALUE '$1,000 TO $2,499        '.02596000
025970     02  FILLER      PIC X(24)   VALUE '$2,500 TO $4,999        '.02597000
025980     02  FILLER      PIC X(24)   VALUE '$5,000 TO $9,999        '.02598000
025990     02  FILLER      PIC X(24)   VALUE '$10,000 TO $24,999      '.02599000
026000     02  FILLER      PIC X(24)   VALUE '$25,000 TO $49,999      '.02600000
026010     02  FILLER      PIC X(24)   VALUE '$50,000 TO $99,999      '.02601000
026020     02  FILLER      PIC X(24)   VALUE '$100,000 TO $499,999    '.02602000
026030     02  FILLER      PIC X(24)   VALUE '$500,000 AND OVER       '.02603000
026040 01  FILLER REDEFINES STRATA-TOTALS-BY-SC-DESC.                   02604000
026050     02  STRATA-DESC-BY-SC   PIC X(24) OCCURS 15 TIMES.           02605000
026060                                                                  02606000
026070 01  FILLER                  PIC X(16)   VALUE 'TOTALS BY STRATA'.02607000
026080 01  TOTALS-BY-STRATIFICATION.                                    02608000
026090     05  STRATA-TOTALS            OCCURS 18 TIMES.                02609000
026100         10  NUMBER-BY-STRATA     PIC S9(7)           COMP-3.     02610000
026110         10  CUR-BAL-BY-STRATA    PIC S9(11)V99       COMP-3.     02611000
026120     05  STRATA-TOTALS-SC         OCCURS 16 TIMES.                02612000
026130         10  NUMBER-BY-STRATA-SC  PIC S9(7)           COMP-3.     02613000
026140         10  CUR-BAL-BY-STRATA-SC PIC S9(11)V99       COMP-3.     02614000
026150                                                                  02615000
026160 01  FILLER                  PIC X(16)   VALUE 'TYPE-TOTAL-DESC'. 02616000
026170 01  TYPE-TOTAL-DESC.                                             02617000
026180     COPY DSDSTYP.                                                02618000
026190                                                                  02619000
026200 01  FILLER                  PIC X(16)   VALUE 'MSTR UPDATE TOT'. 02620000
026210 01  MASTER-UPDATE-TOTALS.                                        02621000
026220     02  BEG-CUR-BAL         PIC S9(11)V99 VALUE ZERO    COMP-3.  02622000
026230     02  AMT-REG-DEBITS      PIC S9(11)V99 VALUE ZERO    COMP-3.  02623000
026240     02  AMT-REG-CREDITS     PIC S9(11)V99 VALUE ZERO    COMP-3.  02624000
026250     02  AMT-FT-DEBITS       PIC S9(9)V99 VALUE ZERO     COMP-3.  02625000
026260     02  AMT-FT-CREDITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02626000
026270     02  AMT-ADS-CREDITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  02627000
026280     02  AMT-ADS-DEBITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02628000
026290     02  AMT-ATM-CREDITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  02629000
026300     02  AMT-ATM-DEBITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02630000
026310     02  AMT-PAY-CREDITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  02631000
026320     02  AMT-PAY-DEBITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02632000
026330     02  AMT-ZBA-CREDITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  02633000
026340     02  AMT-ZBA-DEBITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02634000
026350     02  AMT-ODP-CREDITS     PIC S9(9)V99 VALUE ZERO     COMP-3.  02635000
026360     02  AMT-ODP-DEBITS      PIC S9(9)V99 VALUE ZERO     COMP-3.  02636000
026370     02  AMT-ODB-CREDITS-DDA PIC S9(9)V99 VALUE ZERO     COMP-3.  02637000
026380     02  AMT-HELOC-CREDITS   PIC S9(9)V99 VALUE ZERO     COMP-3.  02638000
026390     02  AMT-ODB-DEBITS-DDA  PIC S9(9)V99 VALUE ZERO     COMP-3.  02639000
026400     02  END-CUR-BAL         PIC S9(11)V99 VALUE ZERO    COMP-3.  02640000
026410     02  BEG-LOAN-BAL        PIC S9(9)V99 VALUE ZERO     COMP-3.  02641000
026420     02  AMT-AUTO-ADVANCES   PIC S9(9)V99 VALUE ZERO     COMP-3.  02642000
026430     02  AMT-MANUAL-ADVANCES PIC S9(9)V99 VALUE ZERO     COMP-3.  02643000
026440     02  AMT-OVER-ADVANCES   PIC S9(9)V99 VALUE ZERO     COMP-3.  02644000
026450     02  AMT-OTH-ODB-DEB     PIC S9(9)V99 VALUE ZERO     COMP-3.  02645000
026460     02  AMT-PAYOFFS         PIC S9(9)V99 VALUE ZERO     COMP-3.  02646000
026470     02  AMT-OTH-ODB-CRE     PIC S9(9)V99 VALUE ZERO     COMP-3.  02647000
026480     02  AMT-AUTO-PAYMENTS   PIC S9(9)V99 VALUE ZERO     COMP-3.  02648000
026490     02  AMT-MANUAL-PAYMENTS PIC S9(9)V99 VALUE ZERO     COMP-3.  02649000
026500     02  AMT-FINANCE-CHARGE  PIC S9(9)V99 VALUE ZERO     COMP-3.  02650000
026510     02  AMT-CR-LIFE-CHARGE  PIC S9(9)V99 VALUE ZERO     COMP-3.  02651000
026520     02  END-LOAN-BAL        PIC S9(9)V99 VALUE ZERO     COMP-3.  02652000
026530     02  BEG-NUM-ACCTS       PIC S9(7)    VALUE ZERO     COMP-3.  02653000
026540     02  NUM-REG-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02654000
026550     02  NUM-REG-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02655000
026560     02  NUM-FT-DEBITS       PIC S9(7)   VALUE ZERO      COMP-3.  02656000
026570     02  NUM-FT-CREDITS      PIC S9(7)   VALUE ZERO      COMP-3.  02657000
026580     02  NUM-ADS-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02658000
026590     02  NUM-ADS-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02659000
026600     02  NUM-ATM-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02660000
026610     02  NUM-ATM-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02661000
026620     02  NUM-PAY-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02662000
026630     02  NUM-PAY-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02663000
026640     02  NUM-ZBA-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02664000
026650     02  NUM-ZBA-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02665000
026660     02  NUM-ODP-CREDITS     PIC S9(7)   VALUE ZERO      COMP-3.  02666000
026670     02  NUM-ODP-DEBITS      PIC S9(7)   VALUE ZERO      COMP-3.  02667000
026680     02  NUM-HELOC-CREDITS   PIC S9(7)   VALUE ZERO      COMP-3.  02668000
026690     02  NUM-ODB-CREDITS-DDA PIC S9(7)   VALUE ZERO      COMP-3.  02669000
026700     02  NUM-ODB-DEBITS-DDA  PIC S9(7)   VALUE ZERO      COMP-3.  02670000
026710     02  END-NUM-ACCTS       PIC S9(7)   VALUE ZERO      COMP-3.  02671000
026720     02  BEG-NUM-LOANS       PIC S9(7)   VALUE ZERO      COMP-3.  02672000
026730     02  NUM-AUTO-ADVANCES   PIC S9(7)   VALUE ZERO      COMP-3.  02673000
026740     02  NUM-MANUAL-ADVANCES PIC S9(7)   VALUE ZERO      COMP-3.  02674000
026750     02  NUM-OVER-ADVANCES   PIC S9(7)   VALUE ZERO      COMP-3.  02675000
026760     02  NUM-OTH-ODB-DEB     PIC S9(7)   VALUE ZERO      COMP-3.  02676000
026770     02  NUM-PAYOFFS         PIC S9(7)   VALUE ZERO      COMP-3.  02677000
026780     02  NUM-OTH-ODB-CRE     PIC S9(7)   VALUE ZERO      COMP-3.  02678000
026790     02  NUM-AUTO-PAYMENTS   PIC S9(7)   VALUE ZERO      COMP-3.  02679000
026800     02  NUM-MANUAL-PAYMENTS PIC S9(7)   VALUE ZERO      COMP-3.  02680000
026810     02  NUM-FINANCE-CHARGE  PIC S9(7)   VALUE ZERO      COMP-3.  02681000
026820     02  NUM-CR-LIFE-CHARGE  PIC S9(7)   VALUE ZERO      COMP-3.  02682000
026830     02  END-NUM-LOANS       PIC S9(7)   VALUE ZERO      COMP-3.  02683000
026840     02  NUM-CLOSED-ACCTS    PIC S9(7)   VALUE ZERO      COMP-3.  02684000
026850     02  NUM-ZERO-ACCTS      PIC S9(7)   VALUE ZERO      COMP-3.  02685000
026860     02  NUM-ERASED-ACCTS    PIC S9(7)   VALUE ZERO      COMP-3.  02686000
026870     02  NUM-OPEN-ACCTS      PIC S9(7)   VALUE ZERO      COMP-3.  02687000
026880     02  NUM-CR-LIFE-ACCTS   PIC S9(7)   VALUE ZERO      COMP-3.  02688000
026890     02  AMT-CR-LIFE-ACCTS   PIC S9(9)V99 VALUE ZERO     COMP-3.  02689000
026900     02  NUM-ODB-EXCESS-PMNT PIC S9(7)   VALUE ZERO      COMP-3.  02690000
026910     02  AMT-ODB-EXCESS-PMNT PIC S9(9)V99 VALUE ZERO     COMP-3.  02691000
026920     02  AMT-ODB-FIN-CHRG-UNSECURED                               02692000
026930                             PIC S9(9)V99 VALUE ZERO     COMP-3.  02693000
026940     02  AMT-ODB-FIN-CHRG-SECURED                                 02694000
026950                             PIC S9(9)V99 VALUE ZERO     COMP-3.  02695000
026960     02  GEN-DEBIT-CNT       PIC S9(7)   VALUE ZERO      COMP-3.  02696000
026970     02  GEN-CREDIT-CNT      PIC S9(7)   VALUE ZERO      COMP-3.  02697000
026980     02  GEN-DEBIT-AMT       PIC S9(9)V99 VALUE ZERO     COMP-3.  02698000
026990     02  GEN-CREDIT-AMT      PIC S9(9)V99 VALUE ZERO     COMP-3.  02699000
027000     02  NUM-BILL-TX         PIC S9(7)   VALUE ZERO      COMP-3.  02700000
027010     02  NUM-IMAGED-ACCTS    PIC S9(7)   VALUE ZERO      COMP-3.  02701000
027020     02  NUM-APPROVED-ODB    PIC S9(7)   VALUE ZERO      COMP-3.  02702000
027030     02  NUM-OTHER-ODB       PIC S9(7)   VALUE ZERO      COMP-3.  02703000
027040     02  NUM-APPROVED-INV    PIC S9(7)   VALUE ZERO      COMP-3.  02704000
027050     02  NUM-OTHER-INV       PIC S9(7)   VALUE ZERO      COMP-3.  02705000
027060     02  NUM-DEPOSITED-ITEMS PIC S9(9)   VALUE ZERO      COMP-3.  02706000
027070     02  NUM-FIN-CHG-DROP    PIC S9(5)   VALUE ZERO      COMP-3.  02707000
027080     02  AMT-FIN-CHG-DROP    PIC S9(9)V99 VALUE ZERO     COMP-3.  02708000
027090     02  NUM-CR-LIFE-DROP    PIC S9(5)   VALUE ZERO      COMP-3.  02709000
027100     02  AMT-CR-LIFE-DROP    PIC S9(9)V99 VALUE ZERO     COMP-3.  02710000
027110     02  NUM-WIRES-IN        PIC S9(5)   VALUE ZERO      COMP-3.  02711000
027120     02  AMT-WIRES-IN        PIC S9(11)V99 VALUE ZERO    COMP-3.  02712000
027130     02  NUM-WIRES-OUT       PIC S9(5)   VALUE ZERO      COMP-3.  02713000
027140     02  AMT-WIRES-OUT       PIC S9(11)V99 VALUE ZERO    COMP-3.  02714000
027150     02  NUM-INTL-WIRES-IN   PIC S9(5)   VALUE ZERO      COMP-3.  02715000
027160     02  AMT-INTL-WIRES-IN   PIC S9(11)V99 VALUE ZERO    COMP-3.  02716000
027170     02  NUM-INTL-WIRES-OUT  PIC S9(5)   VALUE ZERO      COMP-3.  02717000
027180     02  AMT-INTL-WIRES-OUT  PIC S9(11)V99 VALUE ZERO    COMP-3.  02718000
027190     02  NUM-WIRES-TTL       PIC S9(5)   VALUE ZERO      COMP-3.  02719000
027200     02  AMT-WIRES-TTL       PIC S9(11)V99 VALUE ZERO    COMP-3.  02720000
027210     02  NUM-MOBILE-RDC-FEE  PIC S9(5)   VALUE ZERO      COMP-3.  02721000
027220     02  AMT-MOBILE-RDC-FEE  PIC S9(11)V99 VALUE ZERO    COMP-3.  02722000
027230     02  NUM-INV-MATURITIES  PIC S9(5)   VALUE ZERO      COMP-3.  02723000
027240     02  AMT-INV-MATURITIES  PIC S9(9)V99 VALUE ZERO     COMP-3.  02724000
027250     02  NUM-INV-PURCHASES   PIC S9(5)   VALUE ZERO      COMP-3.  02725000
027260     02  AMT-INV-PURCHASES   PIC S9(9)V99 VALUE ZERO     COMP-3.  02726000
027270     02  NUM-INV-INTEREST    PIC S9(5)   VALUE ZERO      COMP-3.  02727000
027280     02  AMT-INV-INTEREST    PIC S9(9)V99 VALUE ZERO     COMP-3.  02728000
027290     02  BK-CC-CYC-C-BUCKET  PIC S9(9)V99 VALUE ZERO     COMP-3.  02729000
027300     02  BK-CC-CYC-T-BUCKET  PIC S9(9)V99 VALUE ZERO     COMP-3.  02730000
027310     02  UNPOSTED-DEBIT-097  PIC S9(9)V99 VALUE ZERO     COMP-3.  02731000
027320     02  UNPOSTED-CREDIT-097 PIC S9(9)V99 VALUE ZERO     COMP-3.  02732000
027330     02  NUM-ACCTS-WITH-CHKS PIC S9(5)   VALUE ZERO      COMP-3.  02733000
027340     02  NUM-ACCTS-TRUNCATED PIC S9(5)   VALUE ZERO      COMP-3.  02734000
027350     02  NUM-ACCTS-IMAGED    PIC S9(5)   VALUE ZERO      COMP-3.  02735000
027360     02  NUM-STMTS-CHKS-PRI  PIC S9(5)   VALUE ZERO      COMP-3.  02736000
027370     02  NUM-STMTS-CHKS-SEC  PIC S9(5)   VALUE ZERO      COMP-3.  02737000
027380     02  NUM-STMTS-TRUNC-PRI PIC S9(5)   VALUE ZERO      COMP-3.  02738000
027390     02  NUM-STMTS-TRUNC-SEC PIC S9(5)   VALUE ZERO      COMP-3.  02739000
027400     02  NUM-STMTS-IMAGE-PRI PIC S9(5)   VALUE ZERO      COMP-3.  02740000
027410     02  NUM-STMTS-IMAGE-SEC PIC S9(5)   VALUE ZERO      COMP-3.  02741000
027420     02  NUM-CYCLE-ENCL      PIC S9(7)   VALUE ZERO      COMP-3.  02742000
027430     02  NUM-REQUEST-397     PIC S9(5)   VALUE ZERO      COMP-3.  02743000
027440     02  NUM-REQUEST-398     PIC S9(5)   VALUE ZERO      COMP-3.  02744000
027450     02  NUM-REQUEST-399     PIC S9(5)   VALUE ZERO      COMP-3.  02745000
027460     02  NUM-MAIL-CODE-M     PIC S9(5)   VALUE ZERO      COMP-3.  02746000
027470     02  NUM-MAIL-CODE-H     PIC S9(5)   VALUE ZERO      COMP-3.  02747000
027480     02  NUM-MAIL-CODE-E     PIC S9(5)   VALUE ZERO      COMP-3.  02748000
027490     02  NUM-MAIL-CODE-A     PIC S9(5)   VALUE ZERO      COMP-3.  02749000
027500     02  NUM-MAIL-CODE-C     PIC S9(5)   VALUE ZERO      COMP-3.  02750000
027510     02  NUM-MAIL-CODE-D     PIC S9(5)   VALUE ZERO      COMP-3.  02751000
027520     02  NUM-MAIL-CODE-G     PIC S9(5)   VALUE ZERO      COMP-3.  02752000
027530     02  NUM-MAIL-CODE-X     PIC S9(5)   VALUE ZERO      COMP-3.  02753000
027540     02  NUM-MAIL-CODE-OTHER PIC S9(5)   VALUE ZERO      COMP-3.  02754000
027550     02  NUM-CLOSED-STMTS    PIC S9(5)   VALUE ZERO      COMP-3.  02755000
027560     02  NUM-CLOSED-TODAY    PIC S9(5)   VALUE ZERO      COMP-3.  02756000
027570     02  FOR-ATM-FEE-DROPPED PIC S9(9)V99 VALUE ZERO     COMP-3.  02757000
027580                                                                  02758000
027590     COPY DSDSMFEE.                                               02759000
027600                                                                  02760000
027610 01  FILLER                  PIC X(16)   VALUE 'SELECT BAL WORK'. 02761000
027620 01  SELECTED-BALANCE-WORK.                                       02762000
027630     02  SELECT-CNT-RPT-39-X PIC XXX.                             02763000
027640     02  SELECT-CNT-RPT-39 REDEFINES SELECT-CNT-RPT-39-X          02764000
027650                             PIC 999.                             02765000
027660     02  SELECT-BAL          PIC 9(9)    VALUE ZERO.              02766000
027670     02  FILLER REDEFINES SELECT-BAL.                             02767000
027680         03  FILLER          PIC XXX.                             02768000
027690         03  SELECT-BAL-IN-K PIC XXX.                             02769000
027700         03  FILLER          PIC XXX.                             02770000
027710     02  SELECT-BAL-RPT-45   PIC S9(9)   VALUE ZERO      COMP-3.  02771000
027720     02  SELECT-BAL-SPEC     PIC 9(9)    VALUE ZERO.              02772000
027730     02  FILLER REDEFINES SELECT-BAL-SPEC.                        02773000
027740         03  FILLER          PIC X(4).                            02774000
027750         03  SELECT-BAL-IN-H PIC XXX.                             02775000
027760         03  FILLER          PIC XX.                              02776000
027770     02  SELECT-BAL-RPT-64   PIC S9(9)   VALUE ZERO      COMP-3.  02777000
027780     02  SELECT-BAL-RPT-65   PIC S9(9)   VALUE ZERO      COMP-3.  02778000
027790     02  SELECT-CRIT-WORK    PIC 9(5)    VALUE ZERO.              02779000
027800     02  FILLER REDEFINES SELECT-CRIT-WORK.                       02780000
027810         03  SELECT-CRIT-WK  PIC XX.                              02781000
027820         03  FILLER          PIC 999.                             02782000
027830     02  SELECT-CRIT-RPT-66  PIC 9(5).                            02783000
027840                                                                  02784000
027850 01  FILLER                  PIC X(16)   VALUE 'TOT. BY ACCT ID.'.02785000
027860 01  TOTALS-BY-ACCOUNT-ID.                                        02786000
027870     05  IDENT-TOTALS   OCCURS 11 TIMES.                          02787000
027880         10  DESC-BY-IDENT       PIC X(24).                       02788000
027890         10  NUMBER-BY-IDENT     PIC S9(7)               COMP-3.  02789000
027900         10  CUR-BAL-BY-IDENT    PIC S9(11)V99           COMP-3.  02790000
027910         10  BEG-ACCR-BY-IDENT   PIC S9(9)V9(5)          COMP-3.  02791000
027920         10  TDY-EXP-BY-IDENT    PIC S9(9)V9(5)          COMP-3.  02792000
027930         10  TDY-PAID-BY-IDENT   PIC S9(9)V99            COMP-3.  02793000
027940         10  TDY-DROP-BY-IDENT   PIC S9(9)V99            COMP-3.  02794000
027950         10  TDY-WITH-BY-IDENT   PIC S9(9)V99            COMP-3.  02795000
027960         10  END-ACCR-BY-IDENT   PIC S9(9)V9(5)          COMP-3.  02796000
027970         10  NUMBER-BY-IDENT-PERS                                 02797000
027980                                 PIC S9(7)               COMP-3.  02798000
027990         10  NUMBER-BY-IDENT-NON-PERS                             02799000
028000                                 PIC S9(7)               COMP-3.  02800000
028010         10  CUR-BAL-BY-IDENT-PERS                                02801000
028020                                 PIC S9(9)V99            COMP-3.  02802000
028030         10  CUR-BAL-BY-IDENT-NON-PERS                            02803000
028040                                 PIC S9(9)V99            COMP-3.  02804000
028050         10  YTD-INT-BY-IDENT    PIC S9(9)V99            COMP-3.  02805000
028060         10  AVG-CURR-BAL-MO-BY-IDENT                             02806000
028070                                 PIC S9(9)V99            COMP-3.  02807000
028080         10  AVG-COLL-BAL-MO-BY-IDENT                             02808000
028090                                 PIC S9(9)V99            COMP-3.  02809000
028100         10  DEBITS-BY-IDENT     PIC S9(11)V99           COMP-3.  02810000
028110         10  CREDITS-BY-IDENT    PIC S9(11)V99           COMP-3.  02811000
028120                                                                  02812000
028130 01  FILLER                  PIC X(16)   VALUE 'TOT. BY PLAN ODB'.02813000
028140 01  TOTALS-BY-PLAN-TYPE-ODB.                                     02814000
028150     03  UNPOSTED-DEBIT-ODB      PIC S9(9)V99            COMP-3.  02815000
028160     03  UNPOSTED-CREDIT-ODB     PIC S9(9)V99            COMP-3.  02816000
028170     03  TOT-BY-PLAN-TYPE-ODB    OCCURS 11 TIMES.                 02817000
028180         05  PLAN-ID-ODB         PIC XX.                          02818000
028190         05  NUM-BY-PLAN-ODB     PIC S9(7)               COMP-3.  02819000
028200         05  BAL-BY-PLAN-ODB     PIC S9(9)V99            COMP-3.  02820000
028210         05  BEG-ACCR-BY-PLAN-ODB                                 02821000
028220                                 PIC S9(9)V9(5)          COMP-3.  02822000
028230         05  TDY-ACCR-BY-PLAN-ODB                                 02823000
028240                                 PIC S9(9)V9(5)          COMP-3.  02824000
028250         05  TDY-COLL-BY-PLAN-ODB                                 02825000
028260                                 PIC S9(9)V99            COMP-3.  02826000
028270         05  TDY-DROP-BY-PLAN-ODB                                 02827000
028280                                 PIC S9(9)V99            COMP-3.  02828000
028290         05  END-ACCR-BY-PLAN-ODB                                 02829000
028300                                 PIC S9(9)V9(5)          COMP-3.  02830000
028310         05  NUM-BY-PLAN-PERS-ODB                                 02831000
028320                                 PIC S9(7)               COMP-3.  02832000
028330         05  NUM-BY-PLAN-NON-PERS-ODB                             02833000
028340                                 PIC S9(7)               COMP-3.  02834000
028350         05  BAL-BY-PLAN-PERS-ODB                                 02835000
028360                                 PIC S9(9)V99            COMP-3.  02836000
028370         05  BAL-BY-PLAN-NON-PERS-ODB                             02837000
028380                                 PIC S9(9)V99            COMP-3.  02838000
028390         05  ADVANCES-BY-PLAN-ODB                                 02839000
028400                                 PIC S9(9)V99            COMP-3.  02840000
028410         05  PAYMENTS-BY-PLAN-ODB                                 02841000
028420                                 PIC S9(9)V99            COMP-3.  02842000
028430         05  CRED-LIFE-COLL-BY-PLAN-ODB                           02843000
028440                                 PIC S9(9)V99            COMP-3.  02844000
028450         05  MONTHLY-FEES-BY-PLAN-ODB                             02845000
028460                                 PIC S9(9)V99            COMP-3.  02846000
028470                                                                  02847000
028480 01  FILLER                  PIC X(16)   VALUE 'TOT. BY PLAN INV'.02848000
028490 01  TOTALS-BY-PLAN-TYPE-INV.                                     02849000
028500     03  TOT-BY-PLAN-TYPE-INV    OCCURS 11 TIMES.                 02850000
028510         05  PLAN-ID-INV         PIC XX.                          02851000
028520         05  NUM-BY-PLAN-INV     PIC S9(7)               COMP-3.  02852000
028530         05  BAL-BY-PLAN-INV     PIC S9(9)V99            COMP-3.  02853000
028540         05  BEG-ACCR-BY-PLAN-INV                                 02854000
028550                                 PIC S9(9)V9(5)          COMP-3.  02855000
028560         05  TDY-ACCR-BY-PLAN-INV                                 02856000
028570                                 PIC S9(9)V9(5)          COMP-3.  02857000
028580         05  TDY-PAID-BY-PLAN-INV                                 02858000
028590                                 PIC S9(9)V99            COMP-3.  02859000
028600         05  TDY-DROP-BY-PLAN-INV                                 02860000
028610                                 PIC S9(9)V99            COMP-3.  02861000
028620         05  TDY-YTD-INC-BY-PLAN-INV                              02862000
028630                                 PIC S9(9)V99            COMP-3.  02863000
028640         05  TDY-YTD-DEC-BY-PLAN-INV                              02864000
028650                                 PIC S9(9)V99            COMP-3.  02865000
028660         05  TDY-WITH-BY-PLAN-INV                                 02866000
028670                                 PIC S9(9)V99            COMP-3.  02867000
028680         05  END-ACCR-BY-PLAN-INV                                 02868000
028690                                 PIC S9(9)V9(5)          COMP-3.  02869000
028700         05  NUM-BY-PLAN-PERS-INV                                 02870000
028710                                 PIC S9(7)               COMP-3.  02871000
028720         05  NUM-BY-PLAN-NON-PERS-INV                             02872000
028730                                 PIC S9(7)               COMP-3.  02873000
028740         05  BAL-BY-PLAN-PERS-INV                                 02874000
028750                                 PIC S9(9)V99            COMP-3.  02875000
028760         05  BAL-BY-PLAN-NON-PERS-INV                             02876000
028770                                 PIC S9(9)V99            COMP-3.  02877000
028780         05  MATURITIES-BY-PLAN-INV                               02878000
028790                                 PIC S9(9)V99            COMP-3.  02879000
028800         05  PURCHASES-BY-PLAN-INV                                02880000
028810                                 PIC S9(9)V99            COMP-3.  02881000
028820                                                                  02882000
028830 01  FILLER                  PIC X(16)   VALUE 'ODB RATE WORK'.   02883000
028840 01  ODB-RATE-WORK-AREA.                                          02884000
028850     02  ODB-RATE-WORK       OCCURS 10 TIMES.                     02885000
028860         03  XX-ODB-RATE1    PIC SV9(7)                  COMP-3.  02886000
028870         03  XX-ODB-AMT1     PIC S9(9)V99                COMP-3.  02887000
028880         03  XX-ODB-RATE2    PIC SV9(7)                  COMP-3.  02888000
028890         03  XX-ODB-USURY    PIC SV9(7)                  COMP-3.  02889000
028900                                                                  02890000
028910 01  FILLER                  PIC X(16)   VALUE 'CLEAR-HISTORY'.   02891000
028920 01  CLEAR-HISTORY.                                               02892000
028930     02  FILLER              PIC S9(9)       VALUE +0    COMP-3.  02893000
028940     02  FILLER              PIC S9(9)       VALUE +0    COMP-3.  02894000
028950     02  FILLER              PIC S9(9)       VALUE +0    COMP-3.  02895000
028960     02  FILLER              PIC S9(9)       VALUE +0    COMP-3.  02896000
028970     02  FILLER              PIC S9(5)       VALUE +0    COMP-3.  02897000
028980     02  FILLER              PIC S9(3)       VALUE +0    COMP-3.  02898000
028990     02  FILLER              PIC S9(3)       VALUE +0    COMP-3.  02899000
029000     02  FILLER              PIC S9(3)       VALUE +0    COMP-3.  02900000
029010     02  FILLER              PIC S9(5)       VALUE +0    COMP-3.  02901000
029020     02  FILLER              PIC S9(5)       VALUE +0    COMP-3.  02902000
029030     02  FILLER              PIC S9(7)       VALUE +0    COMP-3.  02903000
029040     02  FILLER              PIC S9(5)V99    VALUE +0    COMP-3.  02904000
029050     02  FILLER              PIC S9(3)       VALUE +0    COMP-3.  02905000
029060     02  FILLER              PIC X           VALUE HIGH-VALUES.   02906000
029070     02  FILLER              PIC S9(9)       VALUE +0    COMP-3.  02907000
029080     02  FILLER              PIC S9(3)       VALUE +0    COMP-3.  02908000
029090     02  FILLER              PIC S9(9)V99    VALUE +0    COMP-3.  02909000
029100     02  FILLER              PIC S9(9)V99    VALUE +0    COMP-3.  02910000
029110     02  FILLER              PIC 9(4)        VALUE 0.             02911000
029120                                                                  02912000
029130 01  FILLER                  PIC X(16)   VALUE 'EARNING RTN WORK'.02913000
029140 01  EARNINGS-ROUTINE-WORK-AREA.                                  02914000
029150     COPY DSDSERWA.                                               02915000
029160                                                                  02916000
029170 01  FILLER                  PIC X(16)   VALUE 'S. C. RTN. WORK'. 02917000
029180 01  SC-ROUTINE-WORK-FIELDS.                                      02918000
029190     COPY DSDSSCWA.                                               02919000
029200                                                                  02920000
029210 01  TRANSACTION-SORT-KEYS.                                       02921000
029220     COPY DSDSTXSK.                                               02922000
029230                                                                  02923000
029240 01  FILLER                  PIC X(16)   VALUE 'OSB DESCRIPTIONS'.02924000
029250     COPY DSDSOSBD.                                               02925000
029260                                                                  02926000
029270 01  FILLER                  PIC X(16)   VALUE 'ACCT ID DESC TAB'.02927000
029280 01  ACCT-ID-DESC-TABLE-1.                                        02928000
029290     COPY DSDSDESC.                                               02929000
029300                                                                  02930000
029310 01  FILLER                  PIC X(16)   VALUE 'DESCRIPTION-WORK'.02931000
029320 01  DESCRIPTION-WORK.                                            02932000
029330     02  DESC-WORK-1         PIC X(3).                            02933000
029340     02  DESC-WORK-2.                                             02934000
029350         03  DESC-RATE       PIC Z9.9(4).                         02935000
029360 01  DESCRIPTION-WORK-2.                                          02936000
029370     02  DESC-WORK-ST-LOC    PIC Z(9)9.                           02937000
029380                                                                  02938000
029390 01  ACCOUNT-NUMBER-WORK.                                         02939000
029400     02  ACCT-NO-WK          PIC 9(9)    VALUE ZERO      COMP-3.  02940000
029410     02  FILLER              PIC X(15)   VALUE SPACES.            02941000
029420                                                                  02942000
029430 01  FILLER                  PIC X(16)   VALUE 'IRS ACCT NO WORK'.02943000
029440 01  IRS-ACCOUNT-NUMBER-WORK.                                     02944000
029450     02  IRS-ACCT-NO-WORK.                                        02945000
029460         03  IRS-ACCT-NO-WK  PIC 9(9)    VALUE ZERO      COMP-3.  02946000
029470         03  FILLER          PIC X(9)    VALUE SPACES.            02947000
029480                                                                  02948000
029490     COPY CIFU021P.                                               02949000
029500                                                                  02950000
029510     COPY DSDM104P.                                               02951000
029520                                                                  02952000
029530 01  EXT-SERV-CHRG-CODE-WORK-AREA.                                02953000
029540     COPY DSDSXSCC.                                               02954000
029550                                                                  02955000
029560 01  FILLER                  PIC X(16)   VALUE 'EXT SC CHRG TOT'. 02956000
029570 01  EXT-CHRG-HARD-CHRG-TOTALS.                                   02957000
029580     02  EXT-HARD-TOTALS     OCCURS 251 TIMES.                    02958000
029590         03  AMT-EXT-CHRGS   PIC S9(9)V99                COMP-3.  02959000
029600         03  AMT-HARD-CHRGS  PIC S9(9)V99                COMP-3.  02960000
029610         03  NUM-EXT-CHRGS   PIC 9(5)                    COMP-3.  02961000
029620         03  NUM-HARD-CHRGS  PIC 9(5)                    COMP-3.  02962000
029630     02  TOT-AMT-HARD-CHRGS  PIC S9(9)V99 VALUE ZERO     COMP-3.  02963000
029640     02  TOT-NUM-HARD-CHRGS  PIC 9(5)     VALUE ZERO     COMP-3.  02964000
029650     02  HOLD-AMT-HARD-CHRGS PIC S9(9)V99 VALUE ZERO     COMP-3.  02965000
029660     02  HOLD-NUM-HARD-CHRGS PIC 9(5)     VALUE ZERO     COMP-3.  02966000
029670     02  TOT-AMT-EXT-CHRGS   PIC S9(9)V99 VALUE ZERO     COMP-3.  02967000
029680     02  TOT-NUM-EXT-CHRGS   PIC 9(5)     VALUE ZERO     COMP-3.  02968000
029690     02  HOLD-AMT-EXT-CHRGS  PIC S9(9)V99 VALUE ZERO     COMP-3.  02969000
029700     02  HOLD-NUM-EXT-CHRGS  PIC 9(5)     VALUE ZERO     COMP-3.  02970000
029710                                                                  02971000
029720 01  CIFU032-PARAMETERS.                                          02972000
029730     COPY CIFU032P.                                               02973000
029740                                                                  02974000
029750     COPY DSDM105P.                                               02975000
029760                                                                  02976000
029770 01  FILLER                PIC X(16)   VALUE 'DSDM020P        '.  02977000
029780 01  DSDM020P-PARAMETERS.                                         02978000
029790     COPY DSDM020P.                                               02979000
029800                                                                  02980000
029810 01  FILLER                  PIC X(16)   VALUE 'LISCLTX'.         02981000
029820*01  MONETARY-TXN-RECORD.                                         02982000
029830     COPY LISCLTX.                                                02983000
029840                                                                  02984000
029850 01  ICS-FA-TRAN-REC.                                             02985000
029860     02  ICS-FA-TRAN-ID.                                          02986000
029870         03  ICS-FA-TRAN-BANK-NO                                  02987000
029880                             PIC 9(3).                            02988000
029890         03  ICS-FA-TRAN-ACCT-NBR                                 02989000
029900                             PIC 9(9).                            02990000
029910         03  ICS-FA-TRAN-DATE                                     02991000
029920                             PIC X(7).                            02992000
029930     02  ICS-FA-TRAN-TYPE    PIC X(1).                            02993000
029940     02  ICS-FA-ACCT-NBR     PIC 9(9).                            02994000
029950     02  ICS-FA-TRAN-AMOUNT  PIC S9(9)V99                COMP-3.  02995000
029960     02  FILLER              PIC X(65).                           02996000
029970                                                                  02997000
029980 01  WORK-NIP-SEQUENCE       PIC 9(07)   VALUE ZEROS.             02998000
029990 01  FILLER REDEFINES WORK-NIP-SEQUENCE.                          02999000
030000     02  WK-NIP-FILE-ID      PIC 9(01).                           03000000
030010     02  WK-NIP-BANK-ID      PIC 9(03).                           03001000
030020     02  WK-NIP-SEQ          PIC 9(03).                           03002000
030030                                                                  03003000
030040 01  FILLER                  PIC X(16)   VALUE 'E-WSS-DSDS100   '.03004000
030050                                                                  03005000
030060 PROCEDURE DIVISION.                                              03006000
030070     DISPLAY 'BEGIN DSDS100' UPON CONSOLE.                        03007000
030080******************************************************************03008000
030090*            I N I T I A L I Z A T I O N                         *03009000
030100******************************************************************03010000
030110 P0005-OPEN-FILES.                                                03011000
030120     SET OPEN-INPUT     TO TRUE.                                  03012000
030130                                                                  03013000
030140     CALL 'CDCDT10'     USING CDC-CURRENT-DATES.                  03014000
030150     MOVE SPACES                    TO AMSPRP-VALUE-TEXT.         03015000
030160     MOVE ZEROS                     TO AMSPRP-VALUE-LEN.          03016000
030170     MOVE 'aaa.implementation.date' TO AMSPRP-KEY-TEXT.           03017000
030180     MOVE 23                        TO AMSPRP-KEY-LEN.            03018000
030190     EXEC SQL                                                     03019000
030200         SELECT                                                   03020000
030210             AMSPRP_VALUE                                         03021000
030220         INTO                                                     03022000
030230            :AMSPRP-VALUE                                         03023000
030240         FROM AMS.PROPS                                           03024000
030250         WHERE AMSPRP_KEY = :AMSPRP-KEY                           03025000
030260     END-EXEC.                                                    03026000
030270     EVALUATE SQLCODE                                             03027000
030280         WHEN ZEROS                                               03028000
030290             MOVE AMSPRP-VALUE-TEXT TO AA-IMPL-DATE               03029000
030300         WHEN OTHER                                               03030000
030310             CALL 'CDCUT90' USING SQLCA                           03031000
030320             CALL 'CDCDUMP' USING BY CONTENT '2001'               03032000
030330     END-EVALUATE.                                                03033000
030340                                                                  03034000
030350     EXEC SQL                                                     03035000
030360         SET :CDC-TIMESTAMP = CURRENT TIMESTAMP                   03036000
030370     END-EXEC.                                                    03037000
030380     DISPLAY 'TIMESTAMP ' CDC-TIMESTAMP.                          03038000
030390                                                                  03039000
030400     CALL 'DSDSTXL1' USING IO-PARAMETERS                          03040000
030410                           DSDS-TRANSACTION-LONG.                 03041000
030420     IF NOT IO-SUCCESSFUL                                         03042000
030430         DISPLAY 'CDCERROR-TX OPEN ERROR' UPON CONSOLE            03043000
030440         DISPLAY 'IO FILE STATUS = ' IO-FILE-STATUS UPON CONSOLE  03044000
030450         CALL 'CDCDUMP' USING BY CONTENT '2002'.                  03045000
030460                                                                  03046000
030470     OPEN INPUT  PROCESS-CONTROL                                  03047000
030480                 BALANCE-ADJ-FILE.                                03048000
030490     OPEN OUTPUT POSTED-DETAIL                                    03049000
030500                 SPECIAL-FORMS-WORK                               03050000
030510                 OBS-TRANS-FILE                                   03051000
030520                 ACCOUNT-RECON                                    03052000
030530                 NSF-ITEM-FILE-1                                  03053000
030540                 NSF-ITEM-FILE-2                                  03054000
030550                 NSF-ITEM-FILE-3                                  03055000
030560                 NSF-ITEM-FILE-4                                  03056000
030570                 STMT-HEADER-FILE                                 03057000
030580                 ODB-HISTORY-DTL-FILE                             03058000
030590                 CASH-MGMT-COLLAT-FILE                            03059000
030600                 OSB-SUMMARY-FILE                                 03060000
030610                 MCF-HEADER-FILE                                  03061000
030620                 MCF-HEADER-FILE-EOM                              03062000
030630                 DSDS-BAI-TRANS-FILE                              03063000
030640                 ACCT-ANAL-TX-FILE                                03064000
030650                 CHANGE-LOG-FILE                                  03065000
030660                 DSDS-859-FILE                                    03066000
030670                 OSB-IRA-SUMMARY-FILE                             03067000
030680                 DEPOSIT-SCORE-FILE                               03068000
030690                 COLLAT-EXCEPT-FILE                               03069000
030700                 ML-HELOC-ADV-FILE                                03070000
030710                 ACRS-TRAN-FILE                                   03071000
030720                 CLSN-BR-TX-FILE                                  03072000
030730                 ICS-FA-TRAN-FILE.                                03073000
030740     CALL 'DATETIME' USING   H-DATETIME.                          03074000
030750     MOVE 'O' TO DSDM102-ACTION-CODE.                             03075000
030760     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   03076000
030770     MOVE 'W' TO DSDM102-ACTION-CODE.                             03077000
030780     MOVE 'O' TO DSDM103-ACTION-CODE.                             03078000
030790     PERFORM P6900-GL-TRANS THRU P6909-EXIT.                      03079000
030800     MOVE 'W' TO DSDM103-ACTION-CODE.                             03080000
030810     INITIALIZE BALANCE-ADJ-TABLE.                                03081000
030820     CALL 'CIFU032' USING CIFU032-PARAMETERS.                     03082000
030830     MOVE CIFU032-WITHHOLD-PERCENT TO WITHHOLDING-PERCENT.        03083000
030840     DISPLAY 'WITHHOLDING PERCENT = ' WITHHOLDING-PERCENT.        03084000
030850     MOVE 'DSDS100' TO EDOC050-SOURCE-PROG.                       03085000
030860     MOVE ZEROS TO EDOC050-USER-ID.                               03086000
030870     MOVE 'DDA ' TO EDOC050-ACCT-FILE-ID.                         03087000
030880     MOVE 'OSB     ' TO EDOC050-FORM-ID.                          03088000
030890     MOVE 'Y'        TO HELOC-FIRST-TIME-SW.                      03089000
030900                                                                  03090000
030910 P0010-OPEN-BCF-FILE.                                             03091000
030920     OPEN INPUT BCF-FILE.                                         03092000
030930     IF VSAM-SUCCESSFUL                                           03093000
030940         NEXT SENTENCE                                            03094000
030950       ELSE                                                       03095000
030960         DISPLAY 'BCF VSAM OPEN ERROR' UPON CONSOLE               03096000
030970         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03097000
030980         CALL 'CDCDUMP' USING BY CONTENT '2003'.                  03098000
030990                                                                  03099000
031000 P0015-OPEN-HOLD-FILE.                                            03100000
031010     OPEN INPUT HOLD-TOT-FILE.                                    03101000
031020     IF VSAM-SUCCESSFUL                                           03102000
031030         NEXT SENTENCE                                            03103000
031040       ELSE                                                       03104000
031050         DISPLAY 'HOLD VSAM OPEN ERROR' UPON CONSOLE              03105000
031060         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03106000
031070         CALL 'CDCDUMP' USING BY CONTENT '2004'.                  03107000
031080                                                                  03108000
031090 P0020-OPEN-ACCT-ANAL-FILE.                                       03109000
031100     OPEN INPUT ACCT-ANAL-FILE.                                   03110000
031110     IF VSAM-SUCCESSFUL                                           03111000
031120         NEXT SENTENCE                                            03112000
031130       ELSE                                                       03113000
031140         DISPLAY 'ACCT ANAL VSAM OPEN ERROR' UPON CONSOLE         03114000
031150         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03115000
031160         CALL 'CDCDUMP' USING BY CONTENT '2005'.
031170                                                                  03117000
031180 P0025-PROCESS-BAL-ADJ-FILE.
031190     READ BALANCE-ADJ-FILE INTO BALANCE-ADJ-WORK                  03119000
031200         AT END                                                   03120000
031210         CLOSE BALANCE-ADJ-FILE                                   03121000
031220         GO TO P0030-PROGRAM-INITIALIZATION.                      03122000
031230     IF BAW-CLASS-PLAN = SPACES                                   03123000
031240         GO TO P0025-PROCESS-BAL-ADJ-FILE.                        03124000
031250     MOVE BAW-BANK-NO TO X1.                                      03125000
031260     EVALUATE BAW-CLASS-PLAN                                      03126000
031270         WHEN 'DDA'                                               03127000
031280             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 1)         03128000
031290             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 1)          03129000
031300             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 1)         03130000
031310         WHEN 'NOW'                                               03131000
031320             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 2)         03132000
031330             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 2)          03133000
031340             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 2)         03134000
031350         WHEN 'CMM'                                               03135000
031360             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 3)         03136000
031370             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 3)          03137000
031380             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 3)         03138000
031390         WHEN 'IMM'                                               03139000
031400             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 4)         03140000
031410             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 4)          03141000
031420             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 4)         03142000
031430         WHEN 'IMP'                                               03143000
031440             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 5)         03144000
031450             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 5)          03145000
031460             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 5)         03146000
031470         WHEN 'IMT'                                               03147000
031480             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 6)         03148000
031490             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 6)          03149000
031500             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 6)         03150000
031510         WHEN 'IMA'                                               03151000
031520             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 7)         03152000
031530             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 7)          03153000
031540             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 7)         03154000
031550         WHEN 'IML'                                               03155000
031560             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 8)         03156000
031570             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 8)          03157000
031580             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 8)         03158000
031590         WHEN 'RP '                                               03159000
031600             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 9)         03160000
031610             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 9)          03161000
031620             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 9)         03162000
031630         WHEN 'TR '                                               03163000
031640             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 10)        03164000
031650             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 10)         03165000
031660             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 10)        03166000
031670         WHEN 'TE '                                               03167000
031680             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 11)        03168000
031690             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 11)         03169000
031700             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 11)        03170000
031710         WHEN 'TF '                                               03171000
031720             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 12)        03172000
031730             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 12)         03173000
031740             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 12)        03174000
031750         WHEN 'FF '                                               03175000
031760             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 13)        03176000
031770             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 13)         03177000
031780             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 13)        03178000
031790         WHEN 'CF '                                               03179000
031800             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 14)        03180000
031810             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 14)         03181000
031820             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 14)        03182000
031830         WHEN 'IC '                                               03183000
031840             MOVE BAW-CLASS-PLAN TO BAT-CLASS-PLAN (X1 15)        03184000
031850             MOVE BAW-DEBIT-AMT  TO BAT-DEBIT-AMT (X1 15)         03185000
031860             MOVE BAW-CREDIT-AMT TO BAT-CREDIT-AMT (X1 15)        03186000
031870         WHEN OTHER                                               03187000
031880             DISPLAY 'CDCERROR-BAD BAL ADJ RECORD' UPON CONSOLE   03188000
031890             DISPLAY BALANCE-ADJ-WORK UPON CONSOLE                03189000
031900             CALL 'CDCDUMP' USING BY CONTENT '2006'               03190000
031910     END-EVALUATE.                                                03191000
031920     GO TO P0025-PROCESS-BAL-ADJ-FILE.                            03192000
031930                                                                  03193000
031940 P0030-PROGRAM-INITIALIZATION.                                    03194000
031950     INITIALIZE EXT-SERV-CHRG-CODE-WORK-AREA.                     03195000
031960     PERFORM P0035-READ-XSC-FILE THRU P0039-EXIT.                 03196000
031970     PERFORM P0050-READ-PROC-CTL THRU P0055-EXIT.                 03197000
031980     PERFORM P0060-INIT-OBS-TRANS THRU P0065-EXIT.                03198000
031990     PERFORM P0040-BUILD-OUTPUT-FILE-CTLS THRU P0045-EXIT.        03199000
032000     PERFORM P0090-READ-BK-CTL THRU P0290-END-JOURNAL-HEADS.      03200000
032010     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 03201000
032020     PERFORM P0300-READ-MSTR THRU P0399-READ-MSTR-EXIT.           03202000
032030     GO TO P1000-MATCH-MSTR-TX.                                   03203000
032040                                                                  03204000
032050 P0035-READ-XSC-FILE.                                             03205000
032060     MOVE XSC-TX-CODE-WK TO XSCC-TX-CODE (SUB15).                 03206000
032070     CALL 'DSDM038' USING EXT-SERV-CHRG-CODES (SUB15).            03207000
032080     IF SUB15 = 250                                               03208000
032090         MOVE 1 TO SUB15                                          03209000
032100         GO TO P0039-EXIT.                                        03210000
032110     ADD 1 TO SUB15                                               03211000
032120              XSC-TX-CODE-WK.                                     03212000
032130     GO TO P0035-READ-XSC-FILE.                                   03213000
032140                                                                  03214000
032150 P0039-EXIT.                                                      03215000
032160     EXIT.                                                        03216000
032170                                                                  03217000
032180 P0040-BUILD-OUTPUT-FILE-CTLS.                                    03218000
032190     MOVE SPACES TO PJ-DETAIL-LINE.                               03219000
032200     MOVE SPACES TO NSF-FILE-1-WORK.                              03220000
032210     MOVE SPACES TO NSF-FILE-2-WORK.                              03221000
032220     MOVE SPACES TO NSF-FILE-3-WORK.                              03222000
032230     MOVE SPACES TO NSF-FILE-4-WORK.                              03223000
032240     INITIALIZE PD-PDC.                                           03224000
032250     INITIALIZE SP-CTL.                                           03225000
032260     INITIALIZE SF-CTL.                                           03226000
032270     INITIALIZE ACCT-RECON-WORK.                                  03227000
032280     INITIALIZE NSF-FILE-1-WORK.                                  03228000
032290     INITIALIZE NSF-FILE-2-WORK.                                  03229000
032300     INITIALIZE NSF-FILE-3-WORK.                                  03230000
032310     INITIALIZE NSF-FILE-4-WORK.                                  03231000
032320     INITIALIZE DSDS-BAI-TX-WORK.                                 03232000
032330     MOVE PROC-FILE-ID TO PDC-FILE-ID.                            03233000
032340     MOVE PROC-FILE-ID TO SP-FILE-ID.                             03234000
032350     MOVE PROC-FILE-ID TO SF-FILE-ID.                             03235000
032360     MOVE PROC-CURR-DATE TO PDC-CURR-PROC-DT.                     03236000
032370     MOVE PROC-CURR-DATE TO SP-CURR-PROC-DT.                      03237000
032380     MOVE PROC-CURR-DATE TO SF-CURR-PROC-DT.                      03238000
032390     MOVE PROC-CURR-DATE TO NIP1-SEQ-NBR.                         03239000
032400     MOVE PROC-CURR-DATE TO NIP2-DATE-OPENED.                     03240000
032410     MOVE PROC-CURR-DATE TO NIP3-SEQ-NBR.                         03241000
032420     MOVE PROC-CURR-DATE TO NIP4-SEQ-NBR.                         03242000
032430     MOVE LOW-VALUE TO SP-SORT-KEY.                               03243000
032440     MOVE PROC-CURR-DATE TO AR-DATE-PD.                           03244000
032450     WRITE POSTED-DTL FROM PD-PDC.                                03245000
032460     WRITE STMT-HDR FROM PD-PDC.                                  03246000
032470     WRITE ODB-HIST-DTL FROM PD-PDC.                              03247000
032480     WRITE SPECIAL-FORM FROM SF-CTL.                              03248000
032490     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   03249000
032500     WRITE ACCT-RECONX FROM ACCT-RECON-WORK.                      03250000
032510     WRITE NSF-FILE-1  FROM NSF-FILE-1-WORK.                      03251000
032520     WRITE NSF-FILE-2  FROM NSF-FILE-2-WORK.                      03252000
032530     WRITE NSF-FILE-3  FROM NSF-FILE-3-WORK.                      03253000
032540     WRITE NSF-FILE-4  FROM NSF-FILE-4-WORK.                      03254000
032550     INITIALIZE CASH-MGMT-COLLAT-WORK.                            03255000
032560     CALL 'CDCDT99' USING PROC-CURR-DATE                          03256000
032570                          CMC-DATE                                03257000
032580                          BY CONTENT 'PYYYYDDD'                   03258000
032590                          BY CONTENT 'CMMDDYY'.                   03259000
032600     IF NOT PROC-MONTH-END                                        03260000
032610         GO TO P0045-EXIT.                                        03261000
032620     IF INV-STMT-BAL-FILE-SW = '1'                                03262000
032630         GO TO P0045-EXIT.                                        03263000
032640     OPEN OUTPUT INV-STATEMENT-BALANCES.                          03264000
032650     IF NOT VSAM-SUCCESSFUL                                       03265000
032660         DISPLAY 'OPEN ERROR - INV STMT BAL FILE' UPON CONSOLE    03266000
032670         CALL 'CDCDUMP' USING BY CONTENT '2007'.                  03267000
032680     MOVE '1' TO INV-STMT-BAL-FILE-SW.                            03268000
032690     INITIALIZE INV-STMT-BAL-REC.                                 03269000
032700     MOVE PROC-CURR-DATE TO INV-STMT-BAL-ACCT-NO.                 03270000
032710     WRITE INV-STMT-BAL-REC.                                      03271000
032720     IF NOT VSAM-SUCCESSFUL                                       03272000
032730         DISPLAY 'WRITE ERROR - INV STMT BAL FILE' UPON CONSOLE   03273000
032740         CALL 'CDCDUMP' USING BY CONTENT '2008'.                  03274000
032750                                                                  03275000
032760 P0045-EXIT.                                                      03276000
032770     EXIT.                                                        03277000
032780                                                                  03278000
032790******************************************************************03279000
032800*    R E A D  P R O C E S S  C O N T R O L  R E C O R D S        *03280000
032810******************************************************************03281000
032820 P0050-READ-PROC-CTL.                                             03282000
032830     READ PROCESS-CONTROL INTO PROCESS-WORK                       03283000
032840         AT END                                                   03284000
032850         GO TO P9999-END.                                         03285000
032860     DISPLAY 'BEGINNING PROCESSING FOR ' PROC-BK-NO UPON CONSOLE. 03286000
032870     MOVE PROC-BK-NO TO DSDSTXL-BANK-SAVE.                        03287000
032880     CALL 'CDCDT30' USING PROC-CURR-DATE                          03288000
032890                          DAYS-IN-MO-30                           03289000
032900                          HOLD-DAYS-IN-YEAR.                      03290000
032910     MOVE PROC-MONTH-END-SW TO SPW-MONTH-END.                     03291000
032920     EVALUATE TRUE                                                03292000
032930         WHEN PROC-YEAR-END                                       03293000
032940             MOVE '3' TO DATE-TYPE                                03294000
032950         WHEN PROC-QTR-END                                        03295000
032960             MOVE '2' TO DATE-TYPE                                03296000
032970         WHEN PROC-MONTH-END                                      03297000
032980             MOVE '1' TO DATE-TYPE                                03298000
032990         WHEN OTHER                                               03299000
033000             MOVE ' ' TO DATE-TYPE                                03300000
033010     END-EVALUATE.                                                03301000
033020     CALL 'DSDSRDS3' USING PROC-BK-NO                             03302000
033030                           PROC-FILE-ID                           03303000
033040                           PROC-LAST-DATE                         03304000
033050                           PROC-CURR-DATE                         03305000
033060                           DATE-TYPE                              03306000
033070                           RDS-REPORT-PARAMETER-TABLE.            03307000
033080                                                                  03308000
033090** DSDM020 THIS IS A CALLED MODULE USED TO GET THE NEXT STATEMENT 03309000
033100**         CYCLE DATE FOR THE STATEMENT CYCLE CODES PROCESSING    03310000
033110**         TODAY                                                  03311000
033120     MOVE PROC-BK-NO   TO DSDM020P-BANK.                          03312000
033130     IF PROC-FILE-ID = 'DSD'                                      03313000
033140       MOVE 001          TO DSDM020P-ACCT-ID                      03314000
033150     ELSE                                                         03315000
033160       MOVE 004          TO DSDM020P-ACCT-ID                      03316000
033170     END-IF.                                                      03317000
033180     MOVE SPACES       TO DSDM020P-RETURN-CODE.                   03318000
033190     CALL 'DSDM020' USING DSDM020P-PARAMETERS                     03319000
033200                          PROCESS-WORK.                           03320000
033210                                                                  03321000
033220     IF PROC-MONTH-END                                            03322000
033230         CALL 'CDCDT23' USING PROC-MONTH-END-DATE                 03323000
033240                              MGDATE-23                           03324000
033250         MOVE MGDATE-23 TO YYMMDD-DATE                            03325000
033260         MOVE YYMMDD-MO TO MONTH-END-MO                           03326000
033270         MOVE YYMMDD-YR TO MONTH-END-YR.                          03327000
033280     IF PROC-MONTH-END OR PROC-QTR-END OR PROC-YEAR-END           03328000
033290         MOVE 1 TO END-OF-PERIOD-IND                              03329000
033300       ELSE                                                       03330000
033310         MOVE 0 TO END-OF-PERIOD-IND.                             03331000
033320     CALL 'CDCDT11' USING PROC-CURR-DATE                          03332000
033330                          PROC-NEXT-DATE                          03333000
033340                          DAYS-TO-NEXT-DATE.                      03334000
033350     CALL 'CDCDT11' USING PROC-LAST-DATE                          03335000
033360                          PROC-CURR-DATE                          03336000
033370                          DAYS-11.                                03337000
033380     MOVE DAYS-11 TO BACKOUT-DAYS.                                03338000
033390     MOVE PROC-BK-NO TO UBKC-BANK-NBR                             03339000
033400                        MCF-HDR-REMOTE-NBR                        03340000
033410                        MCF-HDR-CSGN-BK.                          03341000
033420     EXEC SQL                                                     03342000
033430         SELECT                                                   03343000
033440             UBKC_TRANS_ROUTING                                   03344000
033450         INTO                                                     03345000
033460            :UBKC-TRANS-ROUTING                                   03346000
033470         FROM CDC.BANKCTL                                         03347000
033480         WHERE UBKC_BANK_NBR = :UBKC-BANK-NBR                     03348000
033490     END-EXEC.                                                    03349000
033500     EVALUATE SQLCODE                                             03350000
033510         WHEN ZEROS                                               03351000
033520             CONTINUE                                             03352000
033530         WHEN +100                                                03353000
033540             DISPLAY '*CDCERROR - INVALID BANK NBR ' UBKC-BANK-NBR03354000
033550             CALL 'CDCUT90' USING SQLCA                           03355000
033560             CALL 'CDCDUMP' USING BY CONTENT '2009'               03356000
033570         WHEN OTHER                                               03357000
033580             CALL 'CDCUT90' USING SQLCA                           03358000
033590             CALL 'CDCDUMP' USING BY CONTENT '2010'               03359000
033600     END-EVALUATE.                                                03360000
033610     MOVE UBKC-TRANS-ROUTING TO TRANSIT-ROUTING-WK.               03361000
033620     MOVE TRANS-ROUT-WK TO MCF-HDR-ABA-NBR.                       03362000
033630     MOVE SPACES TO MCF-HDR-CSPM.                                 03363000
033640     MOVE 99 TO MCF-HDR-CSGN-CYC.                                 03364000
033650     WRITE MCF-HDR-OUT FROM MCF-HEADER-WORK.                      03365000
033660     WRITE MCF-HDR-EOM-OUT FROM MCF-HEADER-WORK.                  03366000
033670     DISPLAY 'DELETING HOLDS FOR BANK ' PROC-BK-NO UPON CONSOLE.  03367000
033680     MOVE PROC-BK-NO TO HOLD-BANK-NBR.                            03368000
033690     MOVE PROC-CURR-DATE TO HOLD-PLACE-DATE.                      03369000
033700     MOVE ZEROS TO ACCT-NBR-COUNT.                                03370000
033710******                                                            03371000
033720     IF PROC-DSD                                                  03372000
033730         EXEC SQL                                                 03373000
033740             SELECT                                               03374000
033750                 HOLD_BANK_NBR,                                   03375000
033760                 HOLD_ACCT_ID,                                    03376000
033770                 HOLD_ACCT_NBR,                                   03377000
033780                 HOLD_TYPE,                                       03378000
033790                 HOLD_SOURCE_USER,                                03379000
033800                 HOLD_SOURCE_PROG,                                03380000
033810                 HOLD_PLACE_DATE,                                 03381000
033820                 HOLD_RELEASE_DATE,                               03382000
033830                 HOLD_AMOUNT,                                     03383000
033840                 HOLD_CHECK_NBR,                                  03384000
033850                 HOLD_LAST_UPDATE,                                03385000
033860                 HOLD_TX_DESC,                                    03386000
033870                 HOLD_LST_4_DIGITS                                03387000
033880             INTO                                                 03388000
033890                :HOLD-BANK-NBR,                                   03389000
033900                :HOLD-ACCT-ID,                                    03390000
033910                :HOLD-ACCT-NBR,                                   03391000
033920                :HOLD-TYPE,                                       03392000
033930                :HOLD-SOURCE-USER,                                03393000
033940                :HOLD-SOURCE-PROG,                                03394000
033950                :HOLD-PLACE-DATE,                                 03395000
033960                :HOLD-RELEASE-DATE,                               03396000
033970                :HOLD-AMOUNT,                                     03397000
033980                :HOLD-CHECK-NBR,                                  03398000
033990                :HOLD-LAST-UPDATE,                                03399000
034000                :HOLD-TX-DESC,                                    03400000
034010                :HOLD-LST-4-DIGITS                                03401000
034020             FROM FINQ.HOLD                                       03402000
034030                 WHERE HOLD_BANK_NBR    = :HOLD-BANK-NBR AND      03403000
034040                       HOLD_ACCT_ID     = 001 AND                 03404000
034050                       HOLD_PLACE_DATE  = :HOLD-PLACE-DATE AND    03405000
034060                       HOLD_SOURCE_PROG = 'DSDS100'               03406000
034070         END-EXEC                                                 03407000
034080       ELSE                                                       03408000
034090         EXEC SQL                                                 03409000
034100             SELECT                                               03410000
034110                 HOLD_BANK_NBR,                                   03411000
034120                 HOLD_ACCT_ID,                                    03412000
034130                 HOLD_ACCT_NBR,                                   03413000
034140                 HOLD_TYPE,                                       03414000
034150                 HOLD_SOURCE_USER,                                03415000
034160                 HOLD_SOURCE_PROG,                                03416000
034170                 HOLD_PLACE_DATE,                                 03417000
034180                 HOLD_RELEASE_DATE,                               03418000
034190                 HOLD_AMOUNT,                                     03419000
034200                 HOLD_CHECK_NBR,                                  03420000
034210                 HOLD_LAST_UPDATE,                                03421000
034220                 HOLD_TX_DESC,                                    03422000
034230                 HOLD_LST_4_DIGITS                                03423000
034240             INTO                                                 03424000
034250                :HOLD-BANK-NBR,                                   03425000
034260                :HOLD-ACCT-ID,                                    03426000
034270                :HOLD-ACCT-NBR,                                   03427000
034280                :HOLD-TYPE,                                       03428000
034290                :HOLD-SOURCE-USER,                                03429000
034300                :HOLD-SOURCE-PROG,                                03430000
034310                :HOLD-PLACE-DATE,                                 03431000
034320                :HOLD-RELEASE-DATE,                               03432000
034330                :HOLD-AMOUNT,                                     03433000
034340                :HOLD-CHECK-NBR,                                  03434000
034350                :HOLD-LAST-UPDATE,                                03435000
034360                :HOLD-TX-DESC,                                    03436000
034370                :HOLD-LST-4-DIGITS                                03437000
034380             FROM FINQ.HOLD                                       03438000
034390                 WHERE HOLD_BANK_NBR    = :HOLD-BANK-NBR AND      03439000
034400                       HOLD_ACCT_ID     > 001 AND                 03440000
034410                       HOLD_PLACE_DATE  = :HOLD-PLACE-DATE AND    03441000
034420                       HOLD_SOURCE_PROG = 'DSDS100'               03442000
034430             END-EXEC                                             03443000
034440     END-IF.                                                      03444000
034450                                                                  03445000
034460     EVALUATE SQLCODE                                             03446000
034470         WHEN +100                                                03447000
034480             DISPLAY 'NO HOLDS TO DELETE' UPON CONSOLE            03448000
034490             GO TO P0052-CONT                                     03449000
034500         WHEN ZEROS                                               03450000
034510         WHEN -811                                                03451000
034520             CONTINUE                                             03452000
034530         WHEN OTHER                                               03453000
034540             DISPLAY 'HOLD COUNT DID NOT WORK' UPON CONSOLE       03454000
034550             CALL 'CDCUT90' USING SQLCA                           03455000
034560             CALL 'CDCDUMP' USING BY CONTENT '2011'               03456000
034570     END-EVALUATE.                                                03457000
034580                                                                  03458000
034590     MOVE ZEROS TO DELETE-COUNT.                                  03459000
034600     IF PROC-DSD                                                  03460000
034610         PERFORM P9050-DELETE-DSD-FINQHOLD THRU P9059-EXIT        03461000
034620         PERFORM P9180-DELETE-CDPEND       THRU P9189-EXIT        03462000
034630       ELSE                                                       03463000
034640         PERFORM P9060-DELETE-DSS-FINQHOLD THRU P9069-EXIT        03464000
034650         PERFORM P9070-DELETE-DSS-FINQDEP  THRU P9079-EXIT        03465000
034660         PERFORM P9080-DELETE-DSS-DSDSPEND THRU P9089-EXIT        03466000
034670     END-IF.                                                      03467000
034680                                                                  03468000
034690     DISPLAY DELETE-COUNT ' HOLDS DELETED' UPON CONSOLE.          03469000
034700                                                                  03470000
034710 P0052-CONT.                                                      03471000
034720     MOVE PROC-BK-NO TO PEND-BANK-NBR.                            03472000
034730     MOVE PROC-NEXT-DATE TO PEND-EFFECT-DATE.                     03473000
034740     IF PROC-DSD                                                  03474000
034750         EXEC SQL                                                 03475000
034760             DELETE                                               03476000
034770             FROM DSDS.PEND                                       03477000
034780             WHERE PEND_BANK_NBR = :PEND-BANK-NBR AND             03478000
034790                   PEND_ACCT_ID = 001 AND                         03479000
034800                   PEND_EFFECT_DATE = :PEND-EFFECT-DATE AND       03480000
034810                   PEND_SOURCE_PROG = 'DSDS100'                   03481000
034820         END-EXEC                                                 03482000
034830       ELSE                                                       03483000
034840         EXEC SQL                                                 03484000
034850             DELETE                                               03485000
034860             FROM DSDS.PEND                                       03486000
034870             WHERE PEND_BANK_NBR = :PEND-BANK-NBR AND             03487000
034880                   PEND_ACCT_ID > 001 AND                         03488000
034890                   PEND_EFFECT_DATE = :PEND-EFFECT-DATE AND       03489000
034900                   PEND_SOURCE_PROG = 'DSDS100'                   03490000
034910         END-EXEC.                                                03491000
034920     EVALUATE SQLCODE                                             03492000
034930         WHEN ZEROS                                               03493000
034940             CONTINUE                                             03494000
034950         WHEN +100                                                03495000
034960             DISPLAY 'NO PENDING TXS TO DELETE' UPON CONSOLE      03496000
034970             GO TO P0055-EXIT                                     03497000
034980         WHEN OTHER                                               03498000
034990             DISPLAY 'PEND DELETE DID NOT WORK' UPON CONSOLE      03499000
035000             CALL 'CDCUT90' USING SQLCA                           03500000
035010             CALL 'CDCDUMP' USING BY CONTENT '2012'               03501000
035020     END-EVALUATE.                                                03502000
035030     DISPLAY SQLERRD(3) ' PENDING TXS DELETED' UPON CONSOLE.      03503000
035040     EXEC SQL                                                     03504000
035050         COMMIT                                                   03505000
035060     END-EXEC.                                                    03506000
035070     EVALUATE SQLCODE                                             03507000
035080         WHEN ZEROS                                               03508000
035090             CONTINUE                                             03509000
035100         WHEN OTHER                                               03510000
035110             DISPLAY 'PEND COMMIT DID NOT WORK' UPON CONSOLE      03511000
035120             CALL 'CDCUT90' USING SQLCA                           03512000
035130             CALL 'CDCDUMP' USING BY CONTENT '2013'               03513000
035140     END-EVALUATE.                                                03514000
035150                                                                  03515000
035160     IF PROC-DSS                                                  03516000
035170         EXEC SQL                                                 03517000
035180             DELETE                                               03518000
035190             FROM DSDS.PEND                                       03519000
035200             WHERE PEND_BANK_NBR    = :PEND-BANK-NBR AND          03520000
035210                   PEND_EFFECT_DATE = :PEND-EFFECT-DATE AND       03521000
035220                   PEND_SOURCE_PROG = 'DSDS100C'                  03522000
035230         END-EXEC                                                 03523000
035240     EVALUATE SQLCODE                                             03524000
035250         WHEN ZEROS                                               03525000
035260             CONTINUE                                             03526000
035270         WHEN +100                                                03527000
035280             DISPLAY 'NO PENDING TXS TO DELETE' UPON CONSOLE      03528000
035290             GO TO P0055-EXIT                                     03529000
035300         WHEN OTHER                                               03530000
035310             DISPLAY 'PEND DELETE DID NOT WORK' UPON CONSOLE      03531000
035320             CALL 'CDCUT90' USING SQLCA                           03532000
035330             CALL 'CDCDUMP' USING BY CONTENT '2014'               03533000
035340     END-EVALUATE.                                                03534000
035350     DISPLAY SQLERRD(3) ' PENDING TXS DELETED' UPON CONSOLE.      03535000
035360     EXEC SQL                                                     03536000
035370         COMMIT                                                   03537000
035380     END-EXEC.                                                    03538000
035390     EVALUATE SQLCODE                                             03539000
035400         WHEN ZEROS                                               03540000
035410             CONTINUE                                             03541000
035420         WHEN OTHER                                               03542000
035430             DISPLAY 'PEND COMMIT DID NOT WORK' UPON CONSOLE      03543000
035440             CALL 'CDCUT90' USING SQLCA                           03544000
035450             CALL 'CDCDUMP' USING BY CONTENT '2015'               03545000
035460     END-EVALUATE.                                                03546000
035470                                                                  03547000
035480 P0055-EXIT.                                                      03548000
035490     EXIT.                                                        03549000
035500                                                                  03550000
035510******************************************************************03551000
035520*    INITIALIZE ONLINE BULK SORT TRANSACTIONS                    *03552000
035530******************************************************************03553000
035540 P0060-INIT-OBS-TRANS.                                            03554000
035550     MOVE SPACES TO ONLINE-BULK-SORT-ENCLOSURES.                  03555000
035560     MOVE SPACES TO ONLINE-BULK-SORT-EXCEPTIONS.                  03556000
035570     MOVE 'STMT' TO OBS-ENCL-JN-CTL.                              03557000
035580     MOVE 'CYCL' TO OBS-EXCPT-JN-CTL.                             03558000
035590                                                                  03559000
035600 P0065-EXIT.                                                      03560000
035610     EXIT.                                                        03561000
035620                                                                  03562000
035630******************************************************************03563000
035640*    R E A D  B A N K  C O N T R O L  R E C O R D S              *03564000
035650******************************************************************03565000
035660 P0090-READ-BK-CTL.                                               03566000
035670     MOVE PROC-BK-NO TO BCF-BANK-NO.                              03567000
035680     MOVE PROC-FILE-ID TO BCF-FILE-ID.                            03568000
035690     READ BCF-FILE.                                               03569000
035700     IF VSAM-RECORD-NOT-FOUND                                     03570000
035710         DISPLAY 'NO BANK CONTROL FILE FOR ' BCF-RECORD-ID        03571000
035720             UPON CONSOLE                                         03572000
035730         CALL 'CDCDUMP' USING BY CONTENT '2016'.                  03573000
035740     IF VSAM-SUCCESSFUL                                           03574000
035750         NEXT SENTENCE                                            03575000
035760       ELSE                                                       03576000
035770         DISPLAY 'BCF VSAM READ ERROR' UPON CONSOLE               03577000
035780         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03578000
035790         CALL 'CDCDUMP' USING BY CONTENT '2017'.                  03579000
035800     CALL 'CDCDT99' USING PROC-CURR-DATE                          03580000
035810                          ODB-REVIEW-CURR-DT                      03581000
035820                          BY CONTENT 'PYYYYDDD'                   03582000
035830                          BY CONTENT 'CYYYYMMDD'.                 03583000
035840     MOVE ODB-RCD-CCYR TO ODB-RDW-CCYR                            03584000
035850                          ODB-NRD-CCYR.                           03585000
035860     MOVE ODB-RCD-MO   TO ODB-RDW-MO                              03586000
035870                          ODB-NRD-MO.                             03587000
035880     ADD 1 TO ODB-NRD-CCYR.                                       03588000
035890     CALL 'CDCDT23' USING PROC-CURR-DATE                          03589000
035900                          MGDATE-23.                              03590000
035910     MOVE MGDATE-23 TO TODAYS-GREG                                03591000
035920                       ODB-MAT-DATE-1.                            03592000
035930     MOVE 01 TO ODB-MAT-DA.                                       03593000
035940     ADD 02 TO ODB-MAT-MO.                                        03594000
035950     IF ODB-MAT-MO GREATER THAN 12                                03595000
035960         SUBTRACT 12 FROM ODB-MAT-MO                              03596000
035970         ADD 01 TO ODB-MAT-YR.                                    03597000
035980     MOVE ODB-MAT-DATE-1 TO ODB-MAT-DATE-2.                       03598000
035990     CALL 'CDCDT13' USING ODB-MAT-DATE-2                          03599000
036000                          ODB-MAT-END-DATE.                       03600000
036010                                                                  03601000
036020 P0100-BANK-INITIALIZATION.                                       03602000
036030     INITIALIZE SUBTOTALS-BY-TYPE.                                03603000
036040     INITIALIZE TOTALS-BY-TYPE.                                   03604000
036050     INITIALIZE TOTALS-BY-SERVICE-CHARGE.                         03605000
036060     INITIALIZE TOTALS-BY-STRATIFICATION.                         03606000
036070     INITIALIZE MASTER-UPDATE-TOTALS.                             03607000
036080     INITIALIZE MISCELLANEOUS-FEES-WORK-AREA.                     03608000
036090     INITIALIZE TOTALS-BY-ACCOUNT-ID.                             03609000
036100     INITIALIZE TOTALS-BY-PLAN-TYPE-ODB.                          03610000
036110     INITIALIZE TOTALS-BY-PLAN-TYPE-INV.                          03611000
036120     INITIALIZE EXT-CHRG-HARD-CHRG-TOTALS.                        03612000
036130     MOVE ZEROS TO PEND-SEQUENCE-NBR.                             03613000
036140     MOVE ZEROS TO NIP1-SEQ-NBR.                                  03614000
036150     MOVE ZEROS TO COUNT-1.                                       03615000
036160     MOVE ZEROS TO COUNT-2.                                       03616000
036170     MOVE ZEROS TO COUNT-3.                                       03617000
036180     MOVE ZEROS TO COUNT-4.                                       03618000
036190     MOVE ZEROS TO WORK-NIP-SEQUENCE.                             03619000
036200     MOVE ZEROS TO AMT-CLSN-BR-CREDITS.                           03620000
036210     MOVE ZEROS TO AMT-CLSN-BR-DEBITS.                            03621000
036220     MOVE ZEROS TO NUM-CLSN-BR-CREDITS.                           03622000
036230     MOVE ZEROS TO NUM-CLSN-BR-DEBITS.                            03623000
036240     MOVE ZEROS TO AMT-ICS-CREDITS.                               03624000
036250     MOVE ZEROS TO AMT-ICS-DEBITS.                                03625000
036260     MOVE ZEROS TO NUM-ICS-CREDITS.                               03626000
036270     MOVE ZEROS TO NUM-ICS-DEBITS.                                03627000
036280     PERFORM P9300-DELETE-ODBGLTXN THRU P9309-EXIT.               03628000
036290     mOVE ZEROS TO OBGL-ADVANCE-AMT                               03629000
036300                   OBGL-PAYMENT-AMT                               03630000
036310                   OBGL-ACCR-INT-AMT                              03631000
036320                   OBGL-COLL-INT-AMT                              03632000
036330                   OBGL-DROP-INT-AMT                              03633000
036340                   OBGL-CREDIT-LIFE-AMT                           03634000
036350                   OBGL-MO-FEE-AMT.                               03635000
036360     EVALUATE PROC-BK-NO                                          03636000
036370         WHEN 001                                                 03637000
036380         WHEN 045                                                 03638000
036390             MOVE 000 TO WK-NIP-BANK-ID                           03639000
036400         WHEN 002                                                 03640000
036410             MOVE 010 TO WK-NIP-BANK-ID                           03641000
036420         WHEN 010                                                 03642000
036430             MOVE 015 TO WK-NIP-BANK-ID                           03643000
036440         WHEN 011                                                 03644000
036450             MOVE 020 TO WK-NIP-BANK-ID                           03645000
036460         WHEN 014                                                 03646000
036470             MOVE 025 TO WK-NIP-BANK-ID                           03647000
036480         WHEN 015                                                 03648000
036490             MOVE 035 TO WK-NIP-BANK-ID                           03649000
036500         WHEN 016                                                 03650000
036510             MOVE 040 TO WK-NIP-BANK-ID                           03651000
036520         WHEN 020                                                 03652000
036530             MOVE 045 TO WK-NIP-BANK-ID                           03653000
036540         WHEN 022                                                 03654000
036550             MOVE 050 TO WK-NIP-BANK-ID                           03655000
036560         WHEN 024                                                 03656000
036570             MOVE 055 TO WK-NIP-BANK-ID                           03657000
036580         WHEN 027                                                 03658000
036590             MOVE 060 TO WK-NIP-BANK-ID                           03659000
036600         WHEN 029                                                 03660000
036610             MOVE 065 TO WK-NIP-BANK-ID                           03661000
036620         WHEN 039                                                 03662000
036630             MOVE 070 TO WK-NIP-BANK-ID                           03663000
036640         WHEN OTHER                                               03664000
036650             MOVE 075 TO WK-NIP-BANK-ID                           03665000
036660     END-EVALUATE.                                                03666000
036670     MOVE 1     TO WK-NIP-FILE-ID.                                03667000
036680     MOVE WORK-NIP-SEQUENCE TO NIP1-SEQ-NBR.                      03668000
036690     MOVE 3     TO WK-NIP-FILE-ID.                                03669000
036700     MOVE WORK-NIP-SEQUENCE TO NIP3-SEQ-NBR.                      03670000
036710     MOVE 4     TO WK-NIP-FILE-ID.                                03671000
036720     MOVE WORK-NIP-SEQUENCE TO NIP4-SEQ-NBR.                      03672000
036730                                                                  03673000
036740     MOVE BINARY-ONE TO SUB-ID.                                   03674000
036750     MOVE 1 TO FIRST-TIME-SW.                                     03675000
036760     INITIALIZE COLLATERAL-EXCEPTION-RECORD.                      03676000
036770     MOVE PROC-BK-NO TO CER-BANK-NBR.                             03677000
036780     MOVE 001        TO CER-ACCT-ID.                              03678000
036790     MOVE 999999999  TO CER-ACCT-NBR.                             03679000
036800     WRITE COLLAT-EXCEPT-OUT FROM COLLATERAL-EXCEPTION-RECORD.    03680000
036810     MOVE RDS-SELECT-CRITERIA-TAB (039) TO SELECT-CNT-RPT-39-X.   03681000
036820     IF SELECT-CNT-RPT-39 NOT NUMERIC                             03682000
036830         MOVE 015 TO SELECT-CNT-RPT-39.                           03683000
036840     IF SEL-BALANCE-RDS (045)                                     03684000
036850         MOVE RDS-SELECT-CRITERIA-TAB (045) TO SELECT-BAL-IN-K    03685000
036860       ELSE                                                       03686000
036870         MOVE '025' TO SELECT-BAL-IN-K.                           03687000
036880     MOVE SELECT-BAL TO SELECT-BAL-RPT-45.                        03688000
036890     MOVE 'N' TO RPT-54-IND.                                      03689000
036900     IF SEL-BALANCE-RDS (064)                                     03690000
036910         MOVE RDS-SELECT-CRITERIA-TAB (064) TO SELECT-BAL-IN-H    03691000
036920       ELSE                                                       03692000
036930         MOVE '001' TO SELECT-BAL-IN-H.                           03693000
036940     MOVE SELECT-BAL-SPEC TO SELECT-BAL-RPT-64.                   03694000
036950     IF SEL-BALANCE-RDS (065)                                     03695000
036960         MOVE RDS-SELECT-CRITERIA-TAB (065) TO SELECT-BAL-IN-H    03696000
036970       ELSE                                                       03697000
036980         MOVE '001' TO SELECT-BAL-IN-H.                           03698000
036990     MULTIPLY -1 BY SELECT-BAL-SPEC GIVING SELECT-BAL-RPT-65.     03699000
037000     MOVE ZEROES TO SELECT-CRIT-WORK.                             03700000
037010     MOVE RDS-SELECT-CRITERIA-TAB (066)     TO SELECT-CRIT-WK.    03701000
037020     IF SELECT-CRIT-WORK NOT NUMERIC                              03702000
037030        MOVE ZEROES TO SELECT-CRIT-WORK                           03703000
037040        MOVE '18'   TO SELECT-CRIT-WK                             03704000
037050     END-IF.                                                      03705000
037060     MOVE SELECT-CRIT-WORK                  TO SELECT-CRIT-RPT-66.03706000
037070     MOVE PROC-BK-NO TO OBS-ENCL-BK-NO                            03707000
037080                        OBS-EXCPT-BK-NO                           03708000
037090                        OBS-ENCL-JN-NO                            03709000
037100                        OBS-EXCPT-JN-NO                           03710000
037110                        DSD-SC-MOD-BK-NO                          03711000
037120                        DSS-SC-MOD-BK-NO                          03712000
037130                        DSD-EARN-MOD-BK-NO                        03713000
037140                        DSS-EARN-MOD-BK-NO                        03714000
037150                        U021-BANK-NBR.                            03715000
037160     IF PROC-DSD AND AFFCHK-OPEN-SW = 0                           03716000
037170         MOVE 1 TO AFFCHK-OPEN-SW                                 03717000
037180         OPEN INPUT AFFCHK-HOLD-FILE                              03718000
037190         IF VSAM-SUCCESSFUL                                       03719000
037200             NEXT SENTENCE                                        03720000
037210           ELSE                                                   03721000
037220             DISPLAY 'AFFCHK HOLD VSAM OPEN ERROR' UPON CONSOLE   03722000
037230             DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS           03723000
037240                 UPON CONSOLE                                     03724000
037250             CALL 'CDCDUMP' USING BY CONTENT '2018'.              03725000
037260     MOVE 'N' TO HOLD-AFFILIATE-CHK-IND.                          03726000
037270     IF PROC-DSD AND SHADOW-OPEN-SW = 0                           03727000
037280         MOVE 1 TO SHADOW-OPEN-SW                                 03728000
037290         OPEN OUTPUT SHADOW-ACCOUNTS.                             03729000
037300                                                                  03730000
037310     MOVE -7           TO NUM-DAYS                                03731000
037320     CALL 'CDCDT15' USING PROC-CURR-DATE                          03732000
037330                          NUM-DAYS                                03733000
037340                          WORK-7DAYS-AGO.                         03734000
037350     COMPUTE WORK-DAYS-2-CHG = PROC-CURR-DAYS + PROC-MEMO-DAYS.   03735000
037360                                                                  03736000
037370******************************************************************03737000
037380*    O P E N  M A S T E R  F I L E                               *03738000
037390******************************************************************03739000
037400 P0130-OPEN-MSTR.                                                 03740000
037410     MOVE ZEROS TO SAVE-SUB-FILE-ID.                              03741000
037420     IF MAST-OPEN-SW = 1                                          03742000
037430         GO TO P0140-OPEN-HIST.                                   03743000
037440     OPEN I-O DSDS-MAST.                                          03744000
037450     IF VSAM-SUCCESSFUL                                           03745000
037460         NEXT SENTENCE                                            03746000
037470       ELSE                                                       03747000
037480         DISPLAY 'CDCERROR-MASTER OPEN ERROR' UPON CONSOLE        03748000
037490         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03749000
037500         CALL 'CDCDUMP' USING BY CONTENT '2019'.                  03750000
037510     MOVE 1 TO MAST-OPEN-SW.                                      03751000
037520                                                                  03752000
037530******************************************************************03753000
037540*    O P E N   H I S T O R Y   F I L E                           *03754000
037550******************************************************************03755000
037560 P0140-OPEN-HIST.                                                 03756000
037570     IF HIST-OPEN-SW = 1                                          03757000
037580         GO TO P0145-OPEN-RBB.                                    03758000
037590     OPEN I-O DSDS-HIST.                                          03759000
037600     IF VSAM-SUCCESSFUL                                           03760000
037610         NEXT SENTENCE                                            03761000
037620       ELSE                                                       03762000
037630         DISPLAY 'CDCERROR-HISTORY OPEN ERROR' UPON CONSOLE       03763000
037640         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03764000
037650         CALL 'CDCDUMP' USING BY CONTENT '2020'.                  03765000
037660     MOVE 1 TO HIST-OPEN-SW.                                      03766000
037670                                                                  03767000
037680******************************************************************03768000
037690*                   O P E N   R B B   F I L E                    *03769000
037700******************************************************************03770000
037710 P0145-OPEN-RBB.                                                  03771000
037720     IF RBB-OPEN-SW = 0                                           03772000
037730         MOVE PROC-CURR-DATE TO RBB-ACTION-DATE                   03773000
037740         MOVE 'O' TO RBB-ACTION-CODE                              03774000
037750         CALL 'DSDM065' USING RBB-ACTION-CODE                     03775000
037760                              RBB-ACTION-DATE                     03776000
037770                              RELATIONSHIP-BANKING-BALANCES       03777000
037780                              RBB-RETURN-CODE.                    03778000
037790     MOVE 1 TO RBB-OPEN-SW.                                       03779000
037800                                                                  03780000
037810******************************************************************03781000
037820*    C H E C K   M A S T E R   F I L E   C O N T R O L   D A T E *03782000
037830******************************************************************03783000
037840 P0150-GET-CNTL-REC.                                              03784000
037850     MOVE PROC-BK-NO             TO DSDS-BANK-NO.                 03785000
037860     MOVE ZEROS                  TO DSDS-ACCOUNT-ID.              03786000
037870     MOVE ZEROS                  TO DSDS-ACCOUNT-NO.              03787000
037880     MOVE SPACES                 TO DSDS-KEY-FILLER.              03788000
037890     MOVE DSDS-MASTER-RECORD-KEY TO DSDS-M-RECORD-KEY.            03789000
037900     READ DSDS-MAST.                                              03790000
037910     IF VSAM-SUCCESSFUL                                           03791000
037920         NEXT SENTENCE                                            03792000
037930       ELSE                                                       03793000
037940         DISPLAY 'CDCERROR-MASTER READ ERROR' UPON CONSOLE        03794000
037950         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03795000
037960         DISPLAY 'NO CONTROL RECORD FOR BANK ' PROC-BK-NO         03796000
037970             UPON CONSOLE                                         03797000
037980         CALL 'CDCDUMP' USING BY CONTENT '2021'.                  03798000
037990     MOVE DSDS-M-CONTROL-DATA TO DSDS-MSTR-CTL-DATA.              03799000
038000                                                                  03800000
038010 P0160-CHK-CNTL-DATE.                                             03801000
038020     IF DSDS-MSTR-FILE-DATE NOT = PROC-LAST-DATE                  03802000
038030         DISPLAY 'FILE DATE INCORRECT FOR BANK ' PROC-BK-NO       03803000
038040             UPON CONSOLE                                         03804000
038050         DISPLAY 'LAST PROC DATE = ' PROC-LAST-DATE               03805000
038060             UPON CONSOLE                                         03806000
038070         DISPLAY 'MSTR FILE DATE = ' DSDS-MSTR-FILE-DATE          03807000
038080             UPON CONSOLE                                         03808000
038090         CALL 'CDCDUMP' USING BY CONTENT '2022'.                  03809000
038100     MOVE PROC-CURR-DATE TO DSDS-MSTR-FILE-DATE.                  03810000
038110                                                                  03811000
038120 P0170-UPDATE-CNTL-REC.                                           03812000
038130     MOVE DSDS-MSTR-CTL-DATA TO DSDS-M-CONTROL-DATA.              03813000
038140     REWRITE DSDS-M-FILE-CONTROL.                                 03814000
038150     IF VSAM-SUCCESSFUL                                           03815000
038160         NEXT SENTENCE                                            03816000
038170       ELSE                                                       03817000
038180         DISPLAY 'CDCERROR-MASTER REWRITE ERROR' UPON CONSOLE     03818000
038190         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03819000
038200         CALL 'CDCDUMP' USING BY CONTENT '2023'.                  03820000
038210                                                                  03821000
038220 P0179-EXIT.                                                      03822000
038230     EXIT.                                                        03823000
038240                                                                  03824000
038250******************************************************************03825000
038260*       G E T   R A T E S   U S I N G   ' A D M S 0 1 0 '        *03826000
038270******************************************************************03827000
038280 P0180-OPEN-ADM.                                                  03828000
038290     MOVE BCF-BANK-NO TO ADM-BK-NO.                               03829000
038300     MOVE 001 TO ADM-REQUEST-CODE.                                03830000
038310     MOVE 001 TO ADM-MODE-TYPE.                                   03831000
038320     MOVE 001 TO ADM-FILE-TYPE.                                   03832000
038330     MOVE ZEROS TO RTE-AMOUNT.                                    03833000
038340     MOVE 001 TO RTE-TERM.                                        03834000
038350                                                                  03835000
038360     MOVE 071 TO ADM-RTE-TYPE.                                    03836000
038370     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03837000
038380     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03838000
038390     MOVE RETURN-RATE TO OVERNIGHT-RATE-1.                        03839000
038400                                                                  03840000
038410     MOVE 072 TO ADM-RTE-TYPE.                                    03841000
038420     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03842000
038430     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03843000
038440     MOVE RETURN-RATE TO OVERNIGHT-RATE-2.                        03844000
038450                                                                  03845000
038460     MOVE 073 TO ADM-RTE-TYPE.                                    03846000
038470     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03847000
038480     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03848000
038490     MOVE RETURN-RATE TO OVERNIGHT-RATE-3.                        03849000
038500                                                                  03850000
038510     MOVE 081 TO ADM-RTE-TYPE.                                    03851000
038520     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03852000
038530     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03853000
038540     MOVE RETURN-RATE TO OVERNIGHT-RATE-4.                        03854000
038550                                                                  03855000
038560     MOVE 082 TO ADM-RTE-TYPE.                                    03856000
038570     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03857000
038580     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03858000
038590     MOVE RETURN-RATE TO OVERNIGHT-RATE-5.                        03859000
038600                                                                  03860000
038610     MOVE 057 TO ADM-RTE-TYPE.                                    03861000
038620     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03862000
038630     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03863000
038640     MOVE RETURN-RATE TO TAX-EXEMPT-RATE.                         03864000
038650                                                                  03865000
038660     MOVE 058 TO ADM-RTE-TYPE.                                    03866000
038670     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03867000
038680     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03868000
038690     MOVE RETURN-RATE TO TREASURY-FUND-RATE.                      03869000
038700                                                                  03870000
038710     MOVE 064 TO ADM-RTE-TYPE.                                    03871000
038720     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03872000
038730     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03873000
038740     MOVE RETURN-RATE TO FED-FUNDS-RT.                            03874000
038750                                                                  03875000
038760     MOVE 075 TO ADM-RTE-TYPE.                                    03876000
038770     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03877000
038780     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03878000
038790     MOVE RETURN-RATE TO CASH-MGMT-TRUST-RATE.                    03879000
038800                                                                  03880000
038810     MOVE 1 TO SUB14.                                             03881000
038820     INITIALIZE ODB-RATE-WORK-AREA.                               03882000
038830                                                                  03883000
038840 P0185-ODB-RATES.                                                 03884000
038850     IF SUB14 = 11                                                03885000
038860         MOVE 1 TO SUB14                                          03886000
038870         GO TO P0200-OPEN-COL.                                    03887000
038880     IF ODB-PLAN-TYPE (SUB14) = SPACES                            03888000
038890         MOVE 1 TO SUB14                                          03889000
038900         GO TO P0200-OPEN-COL.                                    03890000
038910     MOVE 063 TO ADM-RTE-TYPE.                                    03891000
038920     MOVE ODB-PLAN-TYPE (SUB14) TO ADM-PLAN-TYPE.                 03892000
038930     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    03893000
038940     PERFORM P0188-CHECK-ADM-RETURN THRU P0189-EXIT.              03894000
038950     MOVE RETURN-RATE-1     TO XX-ODB-RATE1 (SUB14).              03895000
038960     MOVE RETURN-AMOUNT-1   TO XX-ODB-AMT1 (SUB14).               03896000
038970     MOVE RETURN-RATE-2     TO XX-ODB-RATE2 (SUB14).              03897000
038980     MOVE RETURN-USURY-RATE TO XX-ODB-USURY (SUB14).              03898000
038990     ADD 1 TO SUB14.                                              03899000
039000     GO TO P0185-ODB-RATES.                                       03900000
039010                                                                  03901000
039020 P0188-CHECK-ADM-RETURN.                                          03902000
039030     IF GOOD-RETURN OF RETURN-STAT                                03903000
039040         GO TO P0189-EXIT.                                        03904000
039050     IF BAD-BANK-NO                                               03905000
039060         DISPLAY 'CDCERROR' UPON CONSOLE                          03906000
039070         DISPLAY 'NO RATE SCREEN FOR BANK ' ADM-BK-NO UPON CONSOLE03907000
039080         DISPLAY 'CALL SUPERVISOR TO SET UP RATES' UPON CONSOLE   03908000
039090         CALL 'CDCDUMP' USING BY CONTENT '2024'.                  03909000
039100     IF BAD-REQUEST                                               03910000
039110         DISPLAY 'CDCERROR' UPON CONSOLE                          03911000
039120         DISPLAY 'BAD RATE REQUEST CODE FOR BANK ' ADM-BK-NO      03912000
039130             UPON CONSOLE                                         03913000
039140         DISPLAY 'REQUEST CODE IS ' ADM-REQUEST-CODE UPON CONSOLE 03914000
039150         DISPLAY 'CALL PROGRAMMER' UPON CONSOLE                   03915000
039160         CALL 'CDCDUMP' USING BY CONTENT '2025'.                  03916000
039170     IF BAD-RTE-TYPE                                              03917000
039180         DISPLAY 'CDCERROR' UPON CONSOLE                          03918000
039190         DISPLAY 'BAD RATE TYPE FOR BANK ' ADM-BK-NO UPON CONSOLE 03919000
039200         DISPLAY 'RATE TYPE IS ' ADM-RTE-TYPE UPON CONSOLE        03920000
039210         DISPLAY 'CALL PROGRAMMER' UPON CONSOLE                   03921000
039220         CALL 'CDCDUMP' USING BY CONTENT '2026'.                  03922000
039230                                                                  03923000
039240 P0189-EXIT.                                                      03924000
039250     EXIT.                                                        03925000
039260                                                                  03926000
039270******************************************************************03927000
039280*            O P E N   C O L L A T E R A L   F I L E             *03928000
039290******************************************************************03929000
039300 P0200-OPEN-COL.                                                  03930000
039310     IF PROC-DSS                                                  03931000
039320         GO TO P0210-SETUP-IRS-PENDLST.                           03932000
039330     IF COL-OPEN-SW = 1                                           03933000
039340         GO TO P0210-SETUP-IRS-PENDLST.                           03934000
039350     OPEN I-O DSDS-COLLATERAL-FILE.                               03935000
039360     IF VSAM-SUCCESSFUL                                           03936000
039370         NEXT SENTENCE                                            03937000
039380       ELSE                                                       03938000
039390         DISPLAY 'COLLATERAL VSAM OPEN ERROR' UPON CONSOLE        03939000
039400         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  03940000
039410         CALL 'CDCDUMP' USING BY CONTENT '2027'.                  03941000
039420     READ DSDS-COLLATERAL-FILE NEXT INTO DSDS-COLLATERAL-RECORD.  03942000
039430     IF VSAM-SUCCESSFUL                                           03943000
039440         NEXT SENTENCE                                            03944000
039450       ELSE                                                       03945000
039460         DISPLAY 'NO COLLATERAL VSAM CONTROL RECORD' UPON CONSOLE 03946000
039470         CALL 'CDCDUMP' USING BY CONTENT '2028'.                  03947000
039480     IF COLLAT-CURR-DATE NOT = PROC-CURR-DATE                     03948000
039490         DISPLAY 'COLLATERAL VSAM DATE ERROR' UPON CONSOLE        03949000
039500         DISPLAY 'FILE DATE IS ' COLLAT-CURR-DATE UPON CONSOLE    03950000
039510         DISPLAY 'CURR DATE IS ' PROC-CURR-DATE UPON CONSOLE      03951000
039520         CALL 'CDCDUMP' USING BY CONTENT '2029'.                  03952000
039530     MOVE 1 TO COL-OPEN-SW.                                       03953000
039540                                                                  03954000
039550******************************************************************03955000
039560*         S E T   P A C E R I R S   P A R A M E T E R S          *03956000
039570******************************************************************03957000
039580 P0210-SETUP-IRS-PENDLST.                                         03958000
039590     IF PROC-DSD                                                  03959000
039600         MOVE 001   TO IRSPL-APPL-NBR                             03960000
039610       ELSE                                                       03961000
039620         MOVE 003   TO IRSPL-APPL-NBR.                            03962000
039630     MOVE PROC-BK-NO TO IRSPL-BANK-NBR.                           03963000
039640     CALL 'CDCDT48' USING PROC-CURR-DATE                          03964000
039650                          IRSPL-POST-DATE.                        03965000
039660     EXEC SQL                                                     03966000
039670         DELETE                                                   03967000
039680         FROM IRS.PENDLST                                         03968000
039690         WHERE IRSPL_APPL_NBR  = :IRSPL-APPL-NBR AND              03969000
039700               IRSPL_BANK_NBR  = :IRSPL-BANK-NBR AND              03970000
039710               IRSPL_POST_DATE = :IRSPL-POST-DATE                 03971000
039720     END-EXEC.                                                    03972000
039730     EVALUATE SQLCODE                                             03973000
039740         WHEN ZEROS                                               03974000
039750             DISPLAY SQLERRD(3) ' IRS PENDLST TXS DELETED'        03975000
039760                 UPON CONSOLE                                     03976000
039770         WHEN +100                                                03977000
039780             DISPLAY 'NO IRS PENDLST TXS TO DELETE' UPON CONSOLE  03978000
039790             GO TO P0220-CONT                                     03979000
039800         WHEN OTHER                                               03980000
039810             DISPLAY 'IRS PENDLST DELETE DID NOT WORK'            03981000
039820                 UPON CONSOLE                                     03982000
039830             CALL 'CDCUT90' USING SQLCA                           03983000
039840             CALL 'CDCDUMP' USING BY CONTENT '2030'               03984000
039850     END-EVALUATE.                                                03985000
039860     EXEC SQL                                                     03986000
039870         COMMIT                                                   03987000
039880     END-EXEC.                                                    03988000
039890     EVALUATE SQLCODE                                             03989000
039900         WHEN ZEROS                                               03990000
039910             CONTINUE                                             03991000
039920         WHEN OTHER                                               03992000
039930             DISPLAY 'IRS PENDLST COMMIT DID NOT WORK'            03993000
039940                 UPON CONSOLE                                     03994000
039950             CALL 'CDCUT90' USING SQLCA                           03995000
039960             CALL 'CDCDUMP' USING BY CONTENT '2031'               03996000
039970     END-EVALUATE.                                                03997000
039980                                                                  03998000
039990 P0220-CONT.                                                      03999000
040000     CALL 'CDCDT48' USING PROC-CURR-DATE                          04000000
040010                          IRSPL-EFF-DATE.                         04001000
040020     MOVE '0001-01-01' TO IRSPL-EXTRACT-DATE                      04002000
040030                          IRSPL-DEPOSIT-DATE.                     04003000
040040     MOVE 'DSDS100'    TO IRSPL-SOURCE-ID.                        04004000
040050     MOVE 'C'          TO IRSPL-POST-YR-IND.                      04005000
040060     MOVE 'Y'          TO IRSPL-REMIT-IND.                        04006000
040070     MOVE 'I'          TO IRSPL-EARN-TYPE.                        04007000
040080     MOVE ZEROS        TO IRSPL-ACCT-END-BAL.                     04008000
040090                                                                  04009000
040100******************************************************************04010000
040110*    P R E P A R E  P O S T I N G  J O U R N A L                 *04011000
040120******************************************************************04012000
040130 P0270-PREPARE-JOURNAL.                                           04013000
040140     MOVE ZEROS TO PJ-CRE-AMT.                                    04014000
040150     MOVE ZEROS TO PJ-DEB-AMT.                                    04015000
040160     MOVE ZEROS TO PJ-CRE-NO.                                     04016000
040170     MOVE ZEROS TO PJ-DEB-NO.                                     04017000
040180     MOVE ZEROS TO HOLD-PJ-ACCT.                                  04018000
040190     IF DONT-PROCESS-RDS (080)                                    04019000
040200         GO TO P0290-END-JOURNAL-HEADS.                           04020000
040210     MOVE ZEROS TO PAGE-CNT.                                      04021000
040220     MOVE 'DSDS100' TO H-PROGRAM-NAME.                            04022000
040230     MOVE 80 TO H-MODULE-NO.                                      04023000
040240     MOVE ZEROS TO SEQ-NO-WK.                                     04024000
040250     MOVE BCF-BANK-NO TO H-BK-NO.                                 04025000
040260     IF BCF-FILE-ID = 'DSS'                                       04026000
040270         MOVE 'S A V I N G S' TO H-SYSTEM-NAME.                   04027000
040280     MOVE 'P O S T I N G   J O U R N A L' TO H-REPT-NAME.         04028000
040290     MOVE SPACES TO H-DISTRIBUTION.                               04029000
040300     MOVE TDY-MO TO H-DT-MO.                                      04030000
040310     MOVE TDY-DA TO H-DT-DA.                                      04031000
040320     MOVE TDY-YR TO H-DT-YR.                                      04032000
040330     MOVE H-DT-WK TO H-DATE.                                      04033000
040340     MOVE BCF-FILE-ID TO H-FILE-ID.                               04034000
040350                                                                  04035000
040360 P0280-PRINT-JOURNAL-HEADS.                                       04036000
040370     MOVE ZEROS TO LINE-CNT.                                      04037000
040380     ADD 1 TO PAGE-CNT.                                           04038000
040390     MOVE PAGE-CNT TO H-PAGE-NO.                                  04039000
040400     IF DONT-PROCESS-RDS (080)                                    04040000
040410         GO TO P0290-END-JOURNAL-HEADS.                           04041000
040420     ADD 1 TO SEQ-NO-WK.                                          04042000
040430     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04043000
040440     MOVE PROC-BK-NO TO PL-BANK-NO.                               04044000
040450     MOVE 080 TO PL-REPORT-CODE.                                  04045000
040460     IF PROC-DSD                                                  04046000
040470         MOVE 001 TO PL-ACCT-ID                                   04047000
040480       ELSE                                                       04048000
040490         MOVE 004 TO PL-ACCT-ID.                                  04049000
040500     MOVE DSDS-HEAD-1 TO PL-PRINT-LINE.                           04050000
040510     MOVE '0' TO PL-CC.                                           04051000
040520     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04052000
040530     ADD 1 TO SEQ-NO-WK.                                          04053000
040540     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04054000
040550     MOVE DSDS-HEAD-2 TO PL-PRINT-LINE.                           04055000
040560     MOVE '1' TO PL-CC.                                           04056000
040570     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04057000
040580     ADD 1 TO SEQ-NO-WK.                                          04058000
040590     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04059000
040600     MOVE PJ-HEADING-LINE-3 TO PL-PRINT-LINE.                     04060000
040610     MOVE '2' TO PL-CC.                                           04061000
040620     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04062000
040630     ADD 1 TO SEQ-NO-WK.                                          04063000
040640     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04064000
040650     MOVE PJ-HEADING-LINE-4 TO PL-PRINT-LINE.                     04065000
040660     MOVE '1' TO PL-CC.                                           04066000
040670     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04067000
040680     ADD 1 TO SEQ-NO-WK.                                          04068000
040690     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04069000
040700     MOVE PJ-HEADING-LINE-5 TO PL-PRINT-LINE.                     04070000
040710     MOVE '1' TO PL-CC.                                           04071000
040720     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04072000
040730     ADD 1 TO SEQ-NO-WK.                                          04073000
040740     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 04074000
040750     MOVE SPACE-LINE TO PL-PRINT-LINE.                            04075000
040760     MOVE '1' TO PL-CC.                                           04076000
040770     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   04077000
040780                                                                  04078000
040790 P0290-END-JOURNAL-HEADS.                                         04079000
040800     EXIT.                                                        04080000
040810                                                                  04081000
040820******************************************************************04082000
040830*    R E A D  M A S T E R  R E C O R D S                         *04083000
040840******************************************************************04084000
040850 P0300-READ-MSTR.                                                 04085000
040860     READ DSDS-MAST NEXT.                                         04086000
040870     IF VSAM-SUCCESSFUL                                           04087000
040880         NEXT SENTENCE                                            04088000
040890       ELSE                                                       04089000
040900         DISPLAY 'CDCERROR-MASTER READ ERROR' UPON CONSOLE        04090000
040910         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  04091000
040920         CALL 'CDCDUMP' USING BY CONTENT '2032'.                  04092000
040930     MOVE DSDS-M-FILE-RECORD TO DSDS-MASTER-RECORD.               04093000
040940     IF DSDS-M-EOF                                                04094000
040950         MOVE HIGH-VALUES TO MSTR-ID-HV                           04095000
040960         MOVE ZEROS TO ACCT-TYPE-CODE                             04096000
040970         GO TO P0399-READ-MSTR-EXIT.                              04097000
040980     MOVE DSDS-RECORD-ID TO MSTR-REC-ID.                          04098000
040990     ADD 1 TO READ-MSTR.                                          04099000
041000     DIVIDE READ-MSTR BY 2000                                     04100000
041010         GIVING READ-CNT                                          04101000
041020         REMAINDER READ-REMAINDER.                                04102000
041030     IF READ-REMAINDER = ZEROS                                    04103000
041040         DISPLAY READ-MSTR UPON CONSOLE.                          04104000
041050     MOVE ACCOUNT-NUMBER TO SFR-ACCT-NO.                          04105000
041060                                                                  04106000
041070** INITIALIZE NEW MASTER FILE FIELDS HERE                         04107000
041080                                                                  04108000
041090     MOVE STMT-CYCLE-CODE     TO NEXT-STMT-CYC-CODE.              04109000
041100     MOVE SC-EARN-CYCLE-CODE  TO NEXT-SC-ER-CYC-CODE.             04110000
041110     MOVE STATEMENT-IMAGE-IND TO NEXT-STMT-IMAGE-IND.             04111000
041120     MOVE SPACES TO HOLD-OLD-STAT-2X.                             04112000
041130     MOVE SPACES TO HOLD-NEW-STAT-2X.                             04113000
041140     MOVE SPACES TO HOLD-OLD-INV-STAT.                            04114000
041150     MOVE SPACES TO HOLD-NEW-INV-STAT.                            04115000
041160     MOVE SPACES TO HOLD-OLD-ODB-STAT.                            04116000
041170     MOVE SPACES TO HOLD-NEW-ODB-STAT.                            04117000
041180     MOVE SPACES TO HOLD-OLD-ACCESS-CODE.                         04118000
041190     MOVE SPACES TO HOLD-NEW-ACCESS-CODE.                         04119000
041200     MOVE ZEROS  TO HOLD-OLD-ACCESS-LIMIT.                        04120000
041210     MOVE ZEROS  TO HOLD-NEW-ACCESS-LIMIT.                        04121000
041220     MOVE ZEROS  TO HOLD-OLD-STMT-CYCLE.                          04122000
041230     MOVE ZEROS  TO HOLD-NEW-STMT-CYCLE.                          04123000
041240     MOVE ZEROS  TO HOLD-OLD-SC-EARN-CYC.                         04124000
041250     MOVE ZEROS  TO HOLD-NEW-SC-EARN-CYC.                         04125000
041260     MOVE ZEROS  TO HOLD-MONTHLY-ACCUM-INT.                       04126000
041270                                                                  04127000
041280     IF ODB-REVIEW-DATE NOT NUMERIC                               04128000
041290         MOVE ZEROS TO ODB-REVIEW-DATE.                           04129000
041300                                                                  04130000
041310     IF CLOSED                                                    04131000
041320         MOVE ZEROS TO CURR-NET-COLL-BAL                          04132000
041330                       CURR-BAL-ELG-WITH                          04133000
041340         MOVE OD-ACCESS-LIMIT TO HOLD-OLD-ACCESS-LIMIT            04134000
041350         MOVE ZEROS TO OD-ACCESS-LIMIT                            04135000
041360                       HOLD-NEW-ACCESS-LIMIT                      04136000
041370         EVALUATE TRUE                                            04137000
041380             WHEN OA-ACTIVE                                       04138000
041390             WHEN OA-ACTIVE-30-90                                 04139000
041400             WHEN OA-ACTIVE-FIXED                                 04140000
041410             WHEN OA-SUSPENDED                                    04141000
041420                  MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE     04142000
041430                  MOVE 90 TO OD-ACCESS-CODE                       04143000
041440                             HOLD-NEW-ACCESS-CODE                 04144000
041450             WHEN OA-CLOSED                                       04145000
041460                  CONTINUE                                        04146000
041470             WHEN OTHER                                           04147000
041480                  MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE     04148000
041490                  MOVE 00 TO OD-ACCESS-CODE                       04149000
041500                             HOLD-NEW-ACCESS-CODE                 04150000
041510         END-EVALUATE.                                            04151000
041520                                                                  04152000
041530     MOVE 'Y' TO HOLD-EXTRACT-IND.                                04153000
041540     PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT.           04154000
041550     PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.           04155000
041560                                                                  04156000
041570     IF ODB-PLAN = SPACES                                         04157000
041580         MOVE ZEROS TO ODB-REVIEW-DATE                            04158000
041590       ELSE                                                       04159000
041600         IF ODB-CLOSED-DELETE                                     04160000
041610             NEXT SENTENCE                                        04161000
041620           ELSE                                                   04162000
041630             IF ODB-REVIEW-DATE LESS THAN ODB-REVIEW-DATE-WK      04163000
041640                 MOVE ODB-NEXT-REVIEW-DT TO ODB-REVIEW-DATE.      04164000
041650                                                                  04165000
041660     IF ACCT-ANAL-OFFICER = SPACES                                04166000
041670         MOVE '00000' TO ACCT-ANAL-OFFICER.                       04167000
041680                                                                  04168000
041690     EVALUATE TRUE                                                04169000
041700         WHEN NON-ACCT-ANAL-BANK                                  04170000
041710             MOVE 'N' TO ACCT-ANAL-ACCT-IND                       04171000
041720         WHEN ACCT-ANAL-TEST-BANK                                 04172000
041730             IF BCFSCR-ACCT-ANAL-RTN-IND = 'Y'                    04173000
041740                 MOVE 'Y' TO ACCT-ANAL-ACCT-IND                   04174000
041750               ELSE                                               04175000
041760                 MOVE 'N' TO ACCT-ANAL-ACCT-IND                   04176000
041770                 IF RELATED-ACCT-CODE GREATER THAN ZERO           04177000
041780                     MOVE 'Y' TO ACCT-ANAL-ACCT-IND               04178000
041790                 END-IF                                           04179000
041800                 IF SERV-CHRG-STMT-IND NOT = '0'                  04180000
041810                     MOVE 'Y' TO ACCT-ANAL-ACCT-IND               04181000
041820                 END-IF                                           04182000
041830             END-IF                                               04183000
041840             IF STMT-CYCLE-CODE = 99                              04184000
041850                 MOVE 'N' TO ACCT-ANAL-ACCT-IND                   04185000
041860             END-IF                                               04186000
041870         WHEN OTHER                                               04187000
041880             CONTINUE                                             04188000
041890     END-EVALUATE.                                                04189000
041900                                                                  04190000
041910*    IF BANK-CTL-ACCTS                                            04191000
041920*        IF ACCT-TYPE-CODE = 90                                   04192000
041930*            NEXT SENTENCE                                        04193000
041940*          ELSE                                                   04194000
041950*            MOVE 'N' TO ACCT-ANAL-ACCT-IND.                      04195000
041960                                                                  04196000
041970     EVALUATE STATEMENT-IMAGE-IND                                 04197000
041980         WHEN 'C'                                                 04198000
041990             MOVE 'N' TO DEPOSITS-IMAGE-IND                       04199000
042000         WHEN 'I'                                                 04200000
042010             MOVE 0 TO DEPOSITS-ENCLOSURE-IND                     04201000
042020         WHEN 'T'                                                 04202000
042030             MOVE 'N' TO DEPOSITS-IMAGE-IND                       04203000
042040             MOVE 0 TO DEPOSITS-ENCLOSURE-IND                     04204000
042050         WHEN OTHER                                               04205000
042060             CONTINUE                                             04206000
042070     END-EVALUATE.                                                04207000
042080**** SELECT CLS.CLST34_BR_AVAILABLE TO AVAILABLE AMOUNT ON BR     04208000
042090****                                   PRINCIPAL AMOUNT ON BR     04209000
042100     MOVE ZEROS TO HOLD-BR-CLSN-TIED.                             04210000
042110     IF BR-CLSN-TIED GREATER THAN ZEROS                           04211000
042120         PERFORM P2602-SELECT-CLST34 THRU P2604-EXIT              04212000
042130     END-IF.                                                      04213000
042140                                                                  04214000
042150** END INITIALIZATION                                             04215000
042160                                                                  04216000
042170     IF DSDS-STATUS-CODE NOT NUMERIC                              04217000
042180         MOVE 010 TO DSDS-STATUS-CODE.                            04218000
042190     IF DSDS-CLOSE OR DSDS-DELETE                                 04219000
042200         ADD 1 TO NUM-CLOSED-ACCTS                                04220000
042210         IF SPEC-REPORT-ID = 'C' OR 'S'                           04221000
042220             NEXT SENTENCE                                        04222000
042230           ELSE                                                   04223000
042240             GO TO P0300-READ-MSTR.                               04224000
042250     IF TODAY                                                     04225000
042260         MOVE '2' TO STAT-1X.                                     04226000
042270     IF MAINT-NEW                                                 04227000
042280         MOVE '1' TO STAT-1X.                                     04228000
042290     IF MAINT-CLOSE                                               04229000
042300         MOVE '1' TO STAT-1X                                      04230000
042310         ADD 1 TO NUM-CLOSED-TODAY                                04231000
042320         IF PROC-DSD                                              04232000
042330             MOVE 'C' TO SPEC-REPORT-ID                           04233000
042340           ELSE                                                   04234000
042350             IF SAV-ACCOUNT                                       04235000
042360                 MOVE 'S' TO SPEC-REPORT-ID.                      04236000
042370     MOVE BCF-BANK-NO TO MSTR-ID-BANK-NO.                         04237000
042380     MOVE ACCOUNT-ID TO MSTR-ID-ACCT-ID.                          04238000
042390     MOVE ACCOUNT-NUMBER TO MSTR-ID-ACCT-NO.                      04239000
042400     MOVE ZEROS TO GOT-HISTORY.                                   04240000
042410     MOVE ZEROS TO CYCLE-THIS-STMT.                               04241000
042420     MOVE ZEROS TO CYCLE-THIS-SC-EARN.                            04242000
042430     MOVE ZEROS TO SPEC-SC-THIS-SPEC-CHKR.                        04243000
042440     MOVE ZEROS TO NSF-FILE-1-SW.                                 04244000
042450     MOVE ZEROS TO NSF-FILE-3-SW.                                 04245000
042460     MOVE ZEROS TO NSF-FILE-4-SW.                                 04246000
042470     MOVE ZEROS TO NSF-ITEM-ACCT-TOT.                             04247000
042480     MOVE ZEROS TO ADD-TO-DAYS-OD-SW.                             04248000
042490     MOVE ZEROS TO APPROVED-OD-SW.                                04249000
042500     MOVE ZEROS TO TX-SW.                                         04250000
042510     MOVE ZEROS TO 397-SW.                                        04251000
042520     MOVE ZEROS TO 447-SW.                                        04252000
042530     MOVE ZEROS TO 460-710-SW.                                    04253000
042540     MOVE ZEROS TO 470-480-SW.                                    04254000
042550     MOVE ZEROS TO 750-SW.                                        04255000
042560     MOVE ZEROS TO 942-AMT.                                       04256000
042570     MOVE ZEROS TO HOLD-TIMES-OD-SW.                              04257000
042580     MOVE ZEROS TO HOLD-APPR-OD-SW.                               04258000
042590     MOVE ZEROS TO HOLD-DAY-OD-SW.                                04259000
042600     MOVE ZEROS TO HOLD-NSF-CHECKS-SW.                            04260000
042610     MOVE ZEROS TO HOLD-UNCOLL-WITHD-SW.                          04261000
042620     MOVE ZEROS TO HOLD-THIS-ACCRUAL.                             04262000
042630     MOVE ZEROS TO HOLD-ACTUAL-ACCR-INT.                          04263000
042640     MOVE ZEROS TO HOLD-CHARGES.                                  04264000
042650     MOVE ZEROS TO HOLD-EARNINGS.                                 04265000
042660     MOVE ZEROS TO HOLD-TAX-WITHHELD.                             04266000
042670     MOVE ZEROS TO HOLD-SC-EARN.                                  04267000
042680     MOVE ZEROS TO HOLD-ODB-AVAILABLE.                            04268000
042690     MOVE ZEROS TO HOLD-ACCUM.                                    04269000
042700     MOVE ZEROS TO HOLD-ADVANCE-AMT.                              04270000
042710     MOVE ZEROS TO HOLD-IMM-AVG-INV-BAL.                          04271000
042720     MOVE ZEROS TO HOLD-IMM-AVG-INT-RT.                           04272000
042730     MOVE ZEROS TO HOLD-CURR-BAL-ADJ.                             04273000
042740     MOVE ZEROS TO HOLD-COLL-BAL-ADJ.                             04274000
042750     MOVE ZEROS TO HOLD-REASON-CODE.                              04275000
042760     MOVE ZEROS TO ADVANCE-TX-AMT.                                04276000
042770     MOVE ZEROS TO HE-ADVANCE-TX-AMT.                             04277000
042780     MOVE ZEROS TO CLSN-BR-ADV-TX-AMT.                            04278000
042790     MOVE ZEROS TO CLSN-BR-PYMT-TX-AMT.                           04279000
042800     MOVE ZEROS TO CLSN-BR-WORK-ADV-AMT.                          04280000
042810     MOVE ZEROS TO CLSN-BR-WORK-PYMT-AMT.                         04281000
042820     MOVE ZEROS TO CLSN-BR-WORK-PRIN-BAL.                         04282000
042830     MOVE ZEROS TO CLSN-BR-WORK-BALANCE.                          04283000
042840     MOVE ZEROS TO CLSN-BR-WORK-CURR-BAL.                         04284000
042850     MOVE ZEROS TO CLSN-BR-WORK-COLL-BAL.                         04285000
042860     MOVE ZEROS TO ICS-WORK-SWEEP-AMT.                            04286000
042870     MOVE ZEROS TO ICS-WORK-COLL-BAL.                             04287000
042880     MOVE ZEROS TO ICS-DEBIT-TX-AMT.                              04288000
042890     MOVE ZEROS TO ICS-CRED-TX-AMT.                               04289000
042900     MOVE ZEROS TO HOLD-PREV-INV-STMT-BAL.                        04290000
042910     MOVE 0 TO BEG-BAL-SW.                                        04291000
042920     IF CURRENT-BALANCE GREATER THAN ZERO                         04292000
042930         MOVE 2 TO BEG-BAL-SW                                     04293000
042940       ELSE                                                       04294000
042950         IF CURRENT-BALANCE LESS THAN ZERO                        04295000
042960             MOVE 1 TO BEG-BAL-SW.                                04296000
042970     MOVE ZEROS TO SUB-NUM-TMS-OD-SW.                             04297000
042980     MOVE ZEROS TO HOLD-NUM-OD.                                   04298000
042990     MOVE ZEROS TO INSF-CNT.                                      04299000
043000     MOVE ZEROS TO INSF-AMT.                                      04300000
043010     MOVE ZEROS TO UNPOST-AMT.                                    04301000
043020     MOVE ZEROS TO TEMP-I-CHG.                                    04302000
043030     MOVE ZEROS TO OA-NSF-CNT.                                    04303000
043040     MOVE ZEROS TO OA-NSF-FEE-AMT.                                04304000
043050     MOVE ZEROS TO CYCLE-THIS-HC.                                 04305000
043060     MOVE ZEROS TO REQUEST-STMT.                                  04306000
043070     MOVE ZEROS TO REQ-STMT-NO-ENCL.                              04307000
043080     MOVE ZEROS TO REQUEST-HISTORY.                               04308000
043090     MOVE ZEROS TO ACTIVITY-TDY.                                  04309000
043100     MOVE ZEROS TO INV-MAT-TDY.                                   04310000
043110     MOVE ZEROS TO RET-CHK-CR-SW.                                 04311000
043120     MOVE ZEROS TO OVERRIDE-TX-TDY.                               04312000
043130     MOVE ZEROS TO BYPASS-PAST-DUE.                               04313000
043140     MOVE '0'   TO INSF-PEND-SW.                                  04314000
043150     MOVE ZEROS TO NO-ACTIVITY-STMT.                              04315000
043160     MOVE ZEROS TO HOLD-SC-FEE.                                   04316000
043170     MOVE ZEROS TO ZBA-HIT-SW.                                    04317000
043180     IF LOW-BALANCE-CYCLE = 999999999                             04318000
043190         MOVE ZEROS TO ODB-ACCUM-INT-CHARGED                      04319000
043200     END-IF.                                                      04320000
043210     INITIALIZE DSDS-BAI-WORK-AREA.                               04321000
043220     MOVE CURRENT-BALANCE TO TEMP-CURR-BAL                        04322000
043230                             HOLD-BAI-OPENING-LGR.                04323000
043240     MOVE ZEROS TO DEPOSITS-TDY.                                  04324000
043250     MOVE ZEROS TO TODAYS-DEBIT.                                  04325000
043260     MOVE ZEROS TO ADVANCES-TDY.                                  04326000
043270     MOVE ZEROS TO HOLD-DEBITS-FOR-AA.                            04327000
043280     MOVE ZEROS TO HOLD-CREDITS-FOR-AA.                           04328000
043290     MOVE ZEROS TO HOLD-ITEMS-FOR-AA.                             04329000
043300     MOVE ZEROS TO HOLD-LOC-ITEMS-FOR-AA.                         04330000
043310     MOVE ZEROS TO HOLD-DR-CR-ITM-FOR-AA.                         04331000
043320     MOVE ZEROS TO HOLD-REG-TELE-CR-ITM-FOR-AA.                   04332000
043330     MOVE ZEROS TO HOLD-XCESS-3P-L6-FOR-AA.                       04333000
043340     MOVE ZEROS TO HOLD-ACH-DEB-FOR-AA.                           04334000
043350     MOVE ZEROS TO HOLD-ACH-CR-FOR-AA.                            04335000
043360     MOVE ZEROS TO HOLD-CR-ITM-FOR-AA.                            04336000
043370     MOVE ZEROS TO HOLD-REG-CR-FOR-AA.                            04337000
043380     MOVE ZEROS TO HOLD-ALL-DR-FOR-AA.                            04338000
043390     MOVE ZEROS TO HOLD-E-DEP-FOR-AA.                             04339000
043400     MOVE ZEROS TO HOLD-E-DEP-ITM-FOR-AA.                         04340000
043410     MOVE ZEROS TO HOLD-MBL-RDC-FOR-AA.                           04341000
043420     MOVE ZEROS TO HOLD-MBL-RDC-ITM-FOR-AA.                       04342000
043430     MOVE ZEROS TO HOLD-ITM-DEP-FOR-AA.                           04343000
043440     MOVE ZEROS TO HOLD-ITM-DEP-ITM-FOR-AA.                       04344000
043450     MOVE ZEROS TO HOLD-TOT-289-FOR-AA.                           04345000
043460     MOVE ZEROS TO HOLD-TOT-290-ITM-FOR-AA.                       04346000
043470     MOVE ZEROS TO E-ITEMS-NSF.                                   04347000
043480     MOVE ZEROS TO ACCUM-AMT-LAST-DEP.                            04348000
043490     MOVE LOW-BALANCE-MONTH TO HOLD-LOW-BAL-MTH.                  04349000
043500     MOVE ZEROS TO SUB7.                                          04350000
043510     MOVE SPACE TO KITE-IND.                                      04351000
043520     MOVE DEP-KEY TO SAVE-CR-SORT-KEY.                            04352000
043530     MULTIPLY LARGE-ITEM-AMOUNT BY 1000 GIVING HOLD-LRG-ITM-CHK.  04353000
043540     MOVE STATUS-CODE         TO HOLD-STATUS-CODE.                04354000
043550     MOVE ZEROS TO WITHDRAWALS-TDY.                               04355000
043560     MOVE AVG-CUR-BAL-TO-LOAD TO PREV-AVG-CUR-BAL-LOADED.         04356000
043570     MOVE AVG-COL-BAL-TO-LOAD TO PREV-AVG-COL-BAL-LOADED.         04357000
043580     IF ACCOUNT-ID = SAVE-ACCOUNT-ID                              04358000
043590         NEXT SENTENCE                                            04359000
043600       ELSE                                                       04360000
043610         MOVE ACCOUNT-ID TO SAVE-ACCOUNT-ID                       04361000
043620         PERFORM P0650-NEW-ACCOUNT-ID THRU P0659-EXIT.            04362000
043630     PERFORM P8360-LOOKUP-SC-IN-BKCTL THRU P8369-EXIT.            04363000
043640     PERFORM P8430-LOOKUP-EARN-IN-BCF THRU P8439-EXIT.            04364000
043650     PERFORM P0640-SET-CLASS-SUB THRU P0649-EXIT.                 04365000
043660     PERFORM P8310-CHECK-AR-CCF THRU P8319-EXIT.                  04366000
043670     PERFORM P8320-CHECK-FOR-E-STMT THRU P8329-EXIT.              04367000
043680     IF PROC-MONTH-END                                            04368000
043690         IF ACCT-ANAL-ACCT-IND = 'Y'                              04369000
043700             PERFORM P9320-AA-ESTATEMENT-TX THRU P9329-EXIT       04370000
043710         END-IF                                                   04371000
043720     END-IF.                                                      04372000
043730     EVALUATE TRUE                                                04373000
043740         WHEN OSB-NO-STMT                                         04374000
043750             ADD 1 TO COUNT-1                                     04375000
043760         WHEN OSB-PAPER                                           04376000
043770             ADD 1 TO COUNT-2                                     04377000
043780         WHEN OSB-EMAIL-FAX                                       04378000
043790             ADD 1 TO COUNT-3                                     04379000
043800         WHEN OSB-PAPER-EMAIL-FAX                                 04380000
043810             ADD 1 TO COUNT-4                                     04381000
043820     END-EVALUATE.                                                04382000
043830     PERFORM P9100-ESCHEAT-SUSPECTS   THRU P9109-EXIT.            04383000
043840     IF MASTER-PAC-ACCOUNT                                        04384000
043850         PERFORM P8060-GET-MASTER-PAC THRU P8069-EXIT             04385000
043860     END-IF.                                                      04386000
043870     IF PAC-ACCOUNT                                               04387000
043880         PERFORM P8070-GET-PAC        THRU P8079-EXIT             04388000
043890     END-IF.                                                      04389000
043900     MOVE ZEROS TO HOLD-SAC-BALANCE.                              04390000
043910     MOVE 'N'   TO POSTING-SAC-OFFSET.                            04391000
043920     MOVE 'N'   TO ML02003-SW.                                    04392000
043930**** JULY 1, 2010                                                 04393000
043940**** MOVING AN 'I' TO REGE SW FOR ALL NON-PERSONAL ACCT TRANS     04394000
043950****   SO THAT TRANSACTION PROCESSING DOES NOT CHANGE FOR         04395000
043960****   TRANSACTIONS ON NON-PERSONAL ACCOUNTS                      04396000
043970     IF PERSONAL                                                  04397000
043980         CONTINUE                                                 04398000
043990     ELSE                                                         04399000
044000         MOVE 'I' TO REG-E-ATM-POS-SW                             04400000
044010     END-IF.                                                      04401000
044020**** THIS AREA WILL SET THE WORK FIELDS FOR THE OVERDRAFT CHARGE  04402000
044030**** BASED ON IF THE ACCOUNT IS PERSONAL OR COMMERCIAL.           04403000
044040**** THESE VALUES ARE HELD ON THE BANK CONTROL FILE.              04404000
044050     IF PERSONAL                                                  04405000
044060         MOVE OD-CHARGE-OR-FEE        TO WORK-OD-FEE              04406000
044070         MOVE RETURN-CHK-CHARGE       TO WORK-RET-CHECK-CHRG      04407000
044080         MOVE RETAIL-OD-LIMIT-PER-DAY TO WORK-OD-LIMIT-PER-DAY    04408000
044090         MOVE ZEROS                   TO WORK-OD-LIMIT            04409000
044100*        MOVE OVERDRAFT-LIMIT         TO WORK-OD-LIMIT            04410000
044110         MOVE RETAIL-OD-MIN-AMT       TO WORK-OD-MIN-TX-AMT       04411000
044120     ELSE                                                         04412000
044130         MOVE COMM-OD-FEE             TO WORK-OD-FEE              04413000
044140         MOVE COMM-RET-FEE            TO WORK-RET-CHECK-CHRG      04414000
044150         MOVE COMM-OD-LIMIT-PER-DAY   TO WORK-OD-LIMIT-PER-DAY    04415000
044160         MOVE OVERDRAFT-LIMIT         TO WORK-OD-LIMIT            04416000
044170         MOVE ZEROS                   TO WORK-OD-MIN-TX-AMT       04417000
044180     END-IF.                                                      04418000
044190     MOVE ZEROS                       TO WORK-OD-COUNTER.         04419000
044200                                                                  04420000
044210     IF HSA-ACCT OR CESA-ACCT                                     04421000
044220         INITIALIZE DSDS859-REPORT-RECORD                         04422000
044230         PERFORM P9120-CHECK-SAC-ACCT THRU P9129-EXIT.            04423000
044240                                                                  04424000
044250 P0310-PREPROCESS-MSTR.                                           04425000
044260     ADD CURRENT-BALANCE TO BEG-CUR-BAL.                          04426000
044270     ADD 1 TO BEG-NUM-ACCTS.                                      04427000
044280     ADD ACCRUED-INTEREST TO BEG-ACCR-BY-IDENT (11).              04428000
044290     ADD ACCRUED-INTEREST TO BEG-ACCR-BY-IDENT (SUB13).           04429000
044300     MOVE ZERO TO MEMO-ACCR-INTEREST.                             04430000
044310     IF PROC-DSS                                                  04431000
044320         GO TO P0340-PREP-MSTR-CONT.                              04432000
044330                                                                  04433000
044340 P0320-PREPROCESS-ODB.                                            04434000
044350     IF ODB-PLAN = SPACES                                         04435000
044360         GO TO P0330-PREPROCESS-INV.                              04436000
044370     MOVE ZEROS TO ODB-MEMO-ACCR-F-C                              04437000
044380                   ODB-MEMO-ACCR-CR-LIFE.                         04438000
044390     IF ODB-NUM-PYMTS-TO-WAIVE NOT NUMERIC                        04439000
044400         MOVE ZEROS TO ODB-NUM-PYMTS-TO-WAIVE.                    04440000
044410     IF ODB-LOAN-BAL = ZERO                                       04441000
044420         NEXT SENTENCE                                            04442000
044430       ELSE                                                       04443000
044440         ADD 1 TO BEG-NUM-LOANS.                                  04444000
044450     ADD ODB-LOAN-BAL TO BEG-LOAN-BAL.                            04445000
044460     IF ODB-PLAN = PLAN-ID-ODB (SUB10)                            04446000
044470         NEXT SENTENCE                                            04447000
044480       ELSE                                                       04448000
044490         PERFORM P0610-SET-ODB-TOT-SUB THRU P0619-EXIT.           04449000
044500     IF ODB-PLAN = ODB-PLAN-TYPE (SUB14)                          04450000
044510         NEXT SENTENCE                                            04451000
044520       ELSE                                                       04452000
044530         PERFORM P0620-SET-ODB-BCF-SUB THRU P0629-EXIT.           04453000
044540     ADD 1 TO NUM-BY-PLAN-ODB (SUB10)                             04454000
044550              NUM-BY-PLAN-ODB (11).                               04455000
044560     IF PERSONAL                                                  04456000
044570         ADD 1 TO NUM-BY-PLAN-PERS-ODB (SUB10)                    04457000
044580                  NUM-BY-PLAN-PERS-ODB (11)                       04458000
044590       ELSE                                                       04459000
044600         ADD 1 TO NUM-BY-PLAN-NON-PERS-ODB (SUB10)                04460000
044610                  NUM-BY-PLAN-NON-PERS-ODB (11).                  04461000
044620     ADD ODB-ACCRUED-F-C TO BEG-ACCR-BY-PLAN-ODB (SUB10)          04462000
044630                            BEG-ACCR-BY-PLAN-ODB (11).            04463000
044640     IF ODB-MATURITY-DATE = ZEROS                                 04464000
044650         GO TO P0330-PREPROCESS-INV.                              04465000
044660     IF ODB-MATURITY-DATE LESS THAN PROC-CURR-DATE                04466000
044670         NEXT SENTENCE                                            04467000
044680       ELSE                                                       04468000
044690         GO TO P0330-PREPROCESS-INV.                              04469000
044700     IF ODB-NORMAL                                                04470000
044710         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                04471000
044720         MOVE '02' TO ODB-STATUS-CODE                             04472000
044730                      HOLD-NEW-ODB-STAT                           04473000
044740         MOVE '5' TO HISTORY-CARD-IND.                            04474000
044750     IF ODB-MANUAL-PAY                                            04475000
044760         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                04476000
044770         MOVE '06' TO ODB-STATUS-CODE                             04477000
044780                      HOLD-NEW-ODB-STAT                           04478000
044790         MOVE '5' TO HISTORY-CARD-IND.                            04479000
044800     MOVE 'Y' TO HOLD-EXTRACT-IND.                                04480000
044810     PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT.        04481000
044820                                                                  04482000
044830 P0330-PREPROCESS-INV.                                            04483000
044840     IF INV-PLAN = SPACES OR 'IC'                                 04484000
044850         GO TO P0340-PREP-MSTR-CONT                               04485000
044860     END-IF.                                                      04486000
044870     MOVE ZEROS TO INV-MEMO-ACCR-INT.                             04487000
044880     IF INV-PLAN = PLAN-ID-INV (SUB11)                            04488000
044890         NEXT SENTENCE                                            04489000
044900       ELSE                                                       04490000
044910         PERFORM P0630-SET-INV-SUB THRU P0639-EXIT.               04491000
044920     ADD 1 TO NUM-BY-PLAN-INV (SUB11)                             04492000
044930              NUM-BY-PLAN-INV (11).                               04493000
044940     IF PERSONAL                                                  04494000
044950         ADD 1 TO NUM-BY-PLAN-PERS-INV (SUB11)                    04495000
044960                  NUM-BY-PLAN-PERS-INV (11)                       04496000
044970       ELSE                                                       04497000
044980         ADD 1 TO NUM-BY-PLAN-NON-PERS-INV (SUB11)                04498000
044990                  NUM-BY-PLAN-NON-PERS-INV (11).                  04499000
045000     ADD INV-ACCRUED-INT TO BEG-ACCR-BY-PLAN-INV (SUB11)          04500000
045010                            BEG-ACCR-BY-PLAN-INV (11).            04501000
045020     IF INV-STATUS-CODE = '9 '                                    04502000
045030         MOVE '09' TO INV-STATUS-CODE                             04503000
045040     END-IF.                                                      04504000
045050                                                                  04505000
045060 P0340-PREP-MSTR-CONT.                                            04506000
045070     MOVE '0' TO STOP-PAY-INDICATOR.                              04507000
045080     PERFORM P0500-PRE-ACCRUAL-ROUTINE THRU P0529-EXIT            04508000
045090         PROC-PRE-DAYS TIMES.                                     04509000
045100     MOVE TWO-DAY-FLOAT-AMT TO ONE-DAY-FLOAT-AMT.                 04510000
045110     MOVE THREE-DAY-FLOAT-AMT TO TWO-DAY-FLOAT-AMT.               04511000
045120     MOVE FOUR-DAY-FLOAT-AMT TO THREE-DAY-FLOAT-AMT.              04512000
045130     MOVE FIVE-DAY-FLOAT-AMT TO FOUR-DAY-FLOAT-AMT.               04513000
045140     MOVE ZEROS TO FIVE-DAY-FLOAT-AMT.                            04514000
045150     COMPUTE HOLD-BAI-OPENING-AVL =                               04515000
045160         CURRENT-BALANCE -                                        04516000
045170         (ONE-DAY-FLOAT-AMT + TWO-DAY-FLOAT-AMT +                 04517000
045180         THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +               04518000
045190         FIVE-DAY-FLOAT-AMT).                                     04519000
045200                                                                  04520000
045210 P0350-READ-MSTR-END.                                             04521000
045220     IF CLOSED                                                    04522000
045230         MOVE BINARY-ONE TO SUB8                                  04523000
045240       ELSE                                                       04524000
045250         GO TO P0360-PREP-MSTR-CK-STMT-CYC.                       04525000
045260     IF SPEC-REPORT-ID = 'C' OR 'S'                               04526000
045270         GO TO P0360-PREP-MSTR-CK-STMT-CYC.                       04527000
045280     GO TO P0395-PREP-MSTR-CYC-CK-END.                            04528000
045290                                                                  04529000
045300 P0360-PREP-MSTR-CK-STMT-CYC.                                     04530000
045310     IF STMT-CYCLE-CODE = 00                                      04531000
045320         MOVE 1 TO CYCLE-THIS-STMT                                04532000
045330         MOVE 1 TO CYCLE-THIS-SC-EARN                             04533000
045340         PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT              04534000
045350         GO TO P0380-PREP-MSTR-CK-HC-CYC.                         04535000
045360     IF STMT-CYCLE-CODE = 99                                      04536000
045370         GO TO P0370-PREP-MSTR-CK-SC-E-CYC.                       04537000
045380     MOVE STMT-CYCLE-CODE TO SUB8.                                04538000
045390     IF PROC-CYCLE-CODE (SUB8) = 'Y'                              04539000
045400         MOVE 1 TO CYCLE-THIS-STMT                                04540000
045410         MOVE 1 TO CYCLE-THIS-SC-EARN                             04541000
045420         PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT              04542000
045430         GO TO P0380-PREP-MSTR-CK-HC-CYC.                         04543000
045440     MOVE BINARY-ONE TO SUB8.                                     04544000
045450                                                                  04545000
045460 P0370-PREP-MSTR-CK-SC-E-CYC.                                     04546000
045470     IF SC-EARN-CYCLE-CODE = 00                                   04547000
045480         MOVE 1 TO CYCLE-THIS-SC-EARN                             04548000
045490         PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT              04549000
045500         GO TO P0380-PREP-MSTR-CK-HC-CYC.                         04550000
045510     IF SC-EARN-CYCLE-CODE = 99                                   04551000
045520         GO TO P0380-PREP-MSTR-CK-HC-CYC.                         04552000
045530     MOVE SC-EARN-CYCLE-CODE TO SUB8.                             04553000
045540     IF PROC-CYCLE-CODE (SUB8) = 'Y'                              04554000
045550         MOVE 1 TO CYCLE-THIS-SC-EARN                             04555000
045560         PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT              04556000
045570         GO TO P0380-PREP-MSTR-CK-HC-CYC.                         04557000
045580     MOVE BINARY-ONE TO SUB8.                                     04558000
045590                                                                  04559000
045600 P0380-PREP-MSTR-CK-HC-CYC.                                       04560000
045610     IF ODB-PLAN = SPACES                                         04561000
045620         GO TO P0395-PREP-MSTR-CYC-CK-END.                        04562000
045630     IF ODB-CLOSED-DELETE                                         04563000
045640         IF HC-CLOSED                                             04564000
045650             MOVE 1 TO REQUEST-HISTORY                            04565000
045660             MOVE '4' TO HISTORY-CARD-IND                         04566000
045670             PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT         04567000
045680             GO TO P0395-PREP-MSTR-CYC-CK-END                     04568000
045690           ELSE                                                   04569000
045700             MOVE '0' TO HISTORY-CARD-IND                         04570000
045710             GO TO P0395-PREP-MSTR-CYC-CK-END.                    04571000
045720     IF HC-REVIEW OR ODB-REVIEW-DATE = ODB-REVIEW-DATE-WK         04572000
045730         MOVE 1 TO CYCLE-THIS-HC                                  04573000
045740         MOVE '1' TO HISTORY-CARD-IND                             04574000
045750         PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT             04575000
045760         GO TO P0395-PREP-MSTR-CYC-CK-END.                        04576000
045770     IF HC-MATURED                                                04577000
045780         MOVE 1 TO REQUEST-HISTORY                                04578000
045790         PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.            04579000
045800     GO TO P0395-PREP-MSTR-CYC-CK-END.                            04580000
045810                                                                  04581000
045820 P0390-PREP-MSTR-CK-INV-CYC.                                      04582000
045830     IF INV-PLAN = SPACES OR 'IC'                                 04583000
045840         GO TO P0394-EXIT                                         04584000
045850     END-IF.                                                      04585000
045860     IF INV-CLOSED                                                04586000
045870         IF SPEC-REPORT-ID = 'C'                                  04587000
045880             NEXT SENTENCE                                        04588000
045890           ELSE                                                   04589000
045900             GO TO P0394-EXIT.                                    04590000
045910     IF CYCLE-THIS-STMT = 0 AND                                   04591000
045920        CYCLE-THIS-SC-EARN = 0 AND                                04592000
045930        REQUEST-STMT = 0 AND                                      04593000
045940        REQ-STMT-NO-ENCL = 0                                      04594000
045950         GO TO P0394-EXIT.                                        04595000
045960     IF CYCLE-THIS-SC-EARN = 1                                    04596000
045970         MOVE 051 TO HOLD-REPORT-CODE                             04597000
045980       ELSE                                                       04598000
045990         MOVE 052 TO HOLD-REPORT-CODE.                            04599000
046000     PERFORM P9000-BUILD-INV-HDR THRU P9009-EXIT.                 04600000
046010                                                                  04601000
046020 P0394-EXIT.                                                      04602000
046030     EXIT.                                                        04603000
046040                                                                  04604000
046050 P0395-PREP-MSTR-CYC-CK-END.                                      04605000
046060     PERFORM P8330-READ-HOLD-FILE THRU P8339-EXIT.                04606000
046070     IF INV-PLAN = SPACES or 'IC'                                 04607000
046080         GO TO P0399-READ-MSTR-EXIT                               04608000
046090     END-IF.                                                      04609000
046100     PERFORM P4200-CHECK-INV-MATURITY THRU P4299-EXIT.            04610000
046110                                                                  04611000
046120 P0399-READ-MSTR-EXIT.                                            04612000
046130     EXIT.                                                        04613000
046140                                                                  04614000
046150******************************************************************04615000
046160*    R E A D  T R A N S A C T I O N  R E C O R D S               *04616000
046170******************************************************************04617000
046180 P0400-READ-TOTAL-TX.                                             04618000
046190     MOVE ZEROS TO HOLD-SC-FEE.                                   04619000
046200     IF DSDSTXL-EOF = 1                                           04620000
046210         GO TO P0430-END-TOTAL-TX.                                04621000
046220     IF DSDSTXL-PENDING-SW = 1                                    04622000
046230         GO TO P0410-MOVE-TTX.                                    04623000
046240                                                                  04624000
046250     SET READ-NEXT      TO TRUE.                                  04625000
046260     CALL 'DSDSTXL1' USING IO-PARAMETERS                          04626000
046270                           DSDS-TRANSACTION-LONG.                 04627000
046280     IF IO-END-OF-FILE                                            04628000
046290         GO TO P0430-END-TOTAL-TX.                                04629000
046300     IF NOT IO-SUCCESSFUL                                         04630000
046310         DISPLAY 'CDCERROR-TX READ ERROR' UPON CONSOLE            04631000
046320         DISPLAY 'IO FILE STATUS = ' IO-FILE-STATUS UPON CONSOLE  04632000
046330         CALL 'CDCDUMP' USING BY CONTENT '2033'.                  04633000
046340     MOVE DSDS-TRANSACTION-LONG TO SAVE-DSDS-TRANSACTION-LONG.    04634000
046350     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW-FOR-NIPS.             04635000
046360                                                                  04636000
046370 P0410-MOVE-TTX.                                                  04637000
046380     IF DSDSTXL-EOB-SW = 1                                        04638000
046390         MOVE HI-VAL-TX-ID TO DSDSTXL-ID                          04639000
046400         GO TO P0439-EXIT.                                        04640000
046410     MOVE SAVE-DSDS-TRANSACTION-LONG TO DSDS-TRANSACTION-LONG.    04641000
046420     MOVE DSDSTXL-CODE TO TX-CODE-WK.                             04642000
046430     MOVE 0 TO DSDSTXL-PENDING-SW.                                04643000
046440     IF DSDSTXL-BANK-NO = DSDSTXL-BANK-SAVE                       04644000
046450         GO TO P0439-EXIT.                                        04645000
046460     IF FIRST-DSDSTXL-SW = 1                                      04646000
046470         MOVE 0 TO FIRST-DSDSTXL-SW                               04647000
046480         GO TO P0420-CHECK-CTL-TX.                                04648000
046490     MOVE HIGH-VALUES TO DSDSTXL-ID.                              04649000
046500     MOVE DSDSTXL-BANK-SAVE TO DSDSTXL-BANK-NO.                   04650000
046510     MOVE DSDSTXL-ID TO HI-VAL-TX-ID.                             04651000
046520     MOVE 1 TO DSDSTXL-EOB-SW.                                    04652000
046530     MOVE 1 TO DSDSTXL-PENDING-SW.                                04653000
046540     GO TO P0439-EXIT.                                            04654000
046550                                                                  04655000
046560 P0420-CHECK-CTL-TX.                                              04656000
046570     IF DSDSTXL-CTL-FILE-ID = 'DSS' OR 'DSD'                      04657000
046580         PERFORM P0440-CK-TTX-CTL THRU P0449-EXIT                 04658000
046590         GO TO P0400-READ-TOTAL-TX.                               04659000
046600     GO TO P0439-EXIT.                                            04660000
046610                                                                  04661000
046620 P0430-END-TOTAL-TX.                                              04662000
046630     MOVE HIGH-VALUES TO DSDSTXL-ID.                              04663000
046640     MOVE 1 TO DSDSTXL-EOF.                                       04664000
046650     MOVE DSDSTXL-BANK-SAVE TO DSDSTXL-BANK-NO.                   04665000
046660                                                                  04666000
046670 P0439-EXIT.                                                      04667000
046680     EXIT.                                                        04668000
046690                                                                  04669000
046700 P0440-CK-TTX-CTL.                                                04670000
046710     IF DSDSTXL-CTL-FILE-ID NOT = PROC-FILE-ID                    04671000
046720         DISPLAY 'TOTAL TX FILE HAS INVALID CTL FOR THIS RUN.'    04672000
046730             UPON CONSOLE                                         04673000
046740         DISPLAY 'BANK NO. ' DSDSTXL-CTL-BK-NO ' FILE I.D. '      04674000
046750             DSDSTXL-CTL-FILE-ID ' FILE DATE ' DSDSTXL-CTL-FILE-DT04675000
046760                 UPON CONSOLE                                     04676000
046770         CALL 'CDCDUMP' USING BY CONTENT '2034'.                  04677000
046780     IF DSDSTXL-CTL-FILE-DT = PROC-CURR-DATE                      04678000
046790         GO TO P0449-EXIT.                                        04679000
046800     IF DSDSTXL-CTL-FILE-DT LESS THAN PROC-CURR-DATE              04680000
046810         IF DSDSTXL-CTL-FILE-DT GREATER THAN PROC-LAST-DATE       04681000
046820             GO TO P0449-EXIT.                                    04682000
046830     DISPLAY 'CDCERROR' UPON CONSOLE.                             04683000
046840     DISPLAY 'TX FILE DATE NOT = CURR PROC DATE' UPON CONSOLE.    04684000
046850     DISPLAY 'TX FILE DATE = ' DSDSTXL-CTL-FILE-DT UPON CONSOLE.  04685000
046860     DISPLAY 'CURR PROC DATE = ' PROC-CURR-DATE UPON CONSOLE.     04686000
046870     DISPLAY 'CORRECT AND RERUN' UPON CONSOLE.                    04687000
046880     CALL 'CDCDUMP' USING BY CONTENT '2035'.                      04688000
046890                                                                  04689000
046900 P0449-EXIT.                                                      04690000
046910     EXIT.                                                        04691000
046920                                                                  04692000
046930******************************************************************04693000
046940*    P R E - A C C R U A L   R O U T I N E                       *04694000
046950******************************************************************04695000
046960 P0500-PRE-ACCRUAL-ROUTINE.                                       04696000
046970     IF CLOSED                                                    04697000
046980         GO TO P0529-EXIT.                                        04698000
046990     IF REJECT-OD                                                 04699000
047000         IF BEG-BAL-MINUS                                         04700000
047010             ADD 1 TO NUM-DAYS-OD-MO.                             04701000
047020     IF CALENDAR-DAY                                              04702000
047030         MOVE TWO-DAY-FLOAT-AMT TO ONE-DAY-FLOAT-AMT              04703000
047040         MOVE THREE-DAY-FLOAT-AMT TO TWO-DAY-FLOAT-AMT            04704000
047050         MOVE FOUR-DAY-FLOAT-AMT TO THREE-DAY-FLOAT-AMT           04705000
047060         MOVE FIVE-DAY-FLOAT-AMT TO FOUR-DAY-FLOAT-AMT            04706000
047070         MOVE ZEROS TO FIVE-DAY-FLOAT-AMT.                        04707000
047080     COMPUTE CURR-NET-COLL-BAL =                                  04708000
047090         CURRENT-BALANCE -                                        04709000
047100         (ONE-DAY-FLOAT-AMT + TWO-DAY-FLOAT-AMT +                 04710000
047110         THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +               04711000
047120         FIVE-DAY-FLOAT-AMT).                                     04712000
047130     ADD CURR-NET-COLL-BAL TO GROSS-COLL-BAL-CYCL                 04713000
047140                              GROSS-COLL-BAL-MNTH                 04714000
047150                              GR-CUR-SINCE-LST-STMT.              04715000
047160     ADD CURRENT-BALANCE TO GROSS-CURR-BAL-CYCL                   04716000
047170                            GROSS-CURR-BAL-MNTH                   04717000
047180                            GR-COL-SINCE-LST-STMT.                04718000
047190     ADD 1 TO DAYS-IN-CAL-MONTH                                   04719000
047200              DAYS-IN-CYCLE                                       04720000
047210              DAYS-SINCE-LAST-STMT.                               04721000
047220     IF DDA-ACCOUNT                                               04722000
047230         GO TO P0510-PRE-ACCR-ODB.                                04723000
047240     PERFORM P0600-TIS-GROSS THRU P0609-EXIT.                     04724000
047250     MOVE 1 TO EARN-RETURN.                                       04725000
047260     PERFORM P0570-ACCR-INT THRU P0579-EXIT.                      04726000
047270     ADD HOLD-DAILY-ACCR TO ACCRUED-INTEREST                      04727000
047280                            TDY-EXP-BY-IDENT (11)                 04728000
047290                            TDY-EXP-BY-IDENT (SUB13).             04729000
047300     ADD HOLD-MIN-ACCR TO MIN-ACCR-INTEREST.                      04730000
047310     IF INTEREST-RATE = ZEROS                                     04731000
047320         GO TO P0505-PRE-ACCR-CHK-FOR-DSS.                        04732000
047330     IF HOLD-DAILY-ACCR GREATER THAN ZERO                         04733000
047340         ADD 1 TO GROSS-RATE-DAYS                                 04734000
047350         EVALUATE EARN-BALANCE-CODE (SUB18)                       04735000
047360           WHEN '1'                                               04736000
047370             MOVE TIS-GRS-CUR-BAL-CYC TO TIS-GRS-BAL-WORK         04737000
047380             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04738000
047390                 COMPUTE GROSS-RATE =                             04739000
047400                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04740000
047410                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04741000
047420             ELSE                                                 04742000
047430                 MOVE ZEROS TO GROSS-RATE                         04743000
047440             END-IF                                               04744000
047450           WHEN '2'                                               04745000
047460             MOVE TIS-GRS-COL-BAL-CYC TO TIS-GRS-BAL-WORK         04746000
047470             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04747000
047480                 COMPUTE GROSS-RATE =                             04748000
047490                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04749000
047500                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04750000
047510             ELSE                                                 04751000
047520                 MOVE ZEROS TO GROSS-RATE                         04752000
047530             END-IF                                               04753000
047540           WHEN '4'                                               04754000
047550             MOVE TIS-GRS-COL-BAL-CYC TO TIS-GRS-BAL-WORK         04755000
047560             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04756000
047570                 COMPUTE GROSS-RATE =                             04757000
047580                     ACCRUED-INTEREST / (TIS-GRS-BAL-WORK *       04758000
047590                     (1.00000 - EARN-INT-ACCR-RESERVE (SUB18))) * 04759000
047600                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04760000
047610             ELSE                                                 04761000
047620                 MOVE ZEROS TO GROSS-RATE                         04762000
047630             END-IF                                               04763000
047640           WHEN OTHER                                             04764000
047650             MOVE TIS-GRS-CUR-BAL-CYC TO TIS-GRS-BAL-WORK         04765000
047660             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04766000
047670                 COMPUTE GROSS-RATE =                             04767000
047680                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04768000
047690                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04769000
047700             ELSE                                                 04770000
047710                 MOVE ZEROS TO GROSS-RATE                         04771000
047720             END-IF                                               04772000
047730         END-EVALUATE                                             04773000
047740     END-IF.                                                      04774000
047750                                                                  04775000
047760 P0505-PRE-ACCR-CHK-FOR-DSS.                                      04776000
047770     IF PROC-DSS                                                  04777000
047780         GO TO P0529-EXIT.                                        04778000
047790                                                                  04779000
047800 P0510-PRE-ACCR-ODB.                                              04780000
047810     IF ODB-PLAN = SPACES                                         04781000
047820         GO TO P0515-PRE-ACCR-INV.                                04782000
047830                                                                  04783000
047840     IF ODB-LOAN-BAL GREATER THAN FIRST-INT-AMT                   04784000
047850         IF FIRST-INT-RATE EQUAL SECOND-INT-RATE                  04785000
047860             ADD ODB-LOAN-BAL  TO GROSS-LOAN-BAL                  04786000
047870         ELSE                                                     04787000
047880             ADD FIRST-INT-AMT TO GROSS-LOAN-BAL                  04788000
047890             COMPUTE WORK-ODB-LOAN-BAL =                          04789000
047900                     ODB-LOAN-BAL - FIRST-INT-AMT                 04790000
047910             ADD WORK-ODB-LOAN-BAL TO 2ND-GROSS-LOAN-BAL          04791000
047920         END-IF                                                   04792000
047930     ELSE                                                         04793000
047940         ADD ODB-LOAN-BAL  TO GROSS-LOAN-BAL                      04794000
047950     END-IF.                                                      04795000
047960                                                                  04796000
047970     IF AMT-PAST-DUE GREATER THAN ZERO                            04797000
047980         ADD 1 TO NUM-DAYS-DELQ.                                  04798000
047990     PERFORM P0580-ACCR-ODB-INT THRU P0589-EXIT.                  04799000
048000     IF TEMP-CR-LIFE GREATER THAN ZERO                            04800000
048010         ADD TEMP-CR-LIFE TO ODB-ACCUM-CR-LIFE.                   04801000
048020     ADD TEMP-DAILY-INT TO ODB-ACCRUED-F-C.                       04802000
048030     ADD 0 ODB-ACCRUED-F-C GIVING MONTHLY-ACCUM-INT.              04803000
048040     MOVE MONTHLY-ACCUM-INT TO HOLD-MONTHLY-ACCUM-INT.            04804000
048050     ADD TEMP-DAILY-INT TO TDY-ACCR-BY-PLAN-ODB (SUB10)           04805000
048060                           TDY-ACCR-BY-PLAN-ODB (11).             04806000
048070     MOVE TEMP-DAILY-INT    TO OBGL-ACCR-INT-AMT.                 04807000
048080     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             04808000
048090                                                                  04809000
048100 P0515-PRE-ACCR-INV.                                              04810000
048110     IF INV-PLAN = SPACES or 'IC'                                 04811000
048120         GO TO P0529-EXIT                                         04812000
048130     END-IF.                                                      04813000
048140     IF INV-BALANCE = ZERO                                        04814000
048150         GO TO P0520-PRE-ACCR-INV-CONT.                           04815000
048160     ADD INV-BALANCE TO INV-GROSS-BAL                             04816000
048170                        INV-GROSS-BAL-YTD.                        04817000
048180     ADD 1 TO INV-DAYS-INVESTED.                                  04818000
048190     ADD INV-ACCR-INT-DAILY-FAC TO INV-ACCRUED-INT                04819000
048200                                   TDY-ACCR-BY-PLAN-INV (SUB11)   04820000
048210                                   TDY-ACCR-BY-PLAN-INV (11).     04821000
048220     ADD INV-GROSS-INT-DAILY-FAC TO INV-GROSS-INT                 04822000
048230                                    INV-GROSS-INT-YTD.            04823000
048240                                                                  04824000
048250 P0520-PRE-ACCR-INV-CONT.                                         04825000
048260     IF INV-NO-ADJUSTMENT OR INV-ADJUST-PEGGED                    04826000
048270         GO TO P0529-EXIT.                                        04827000
048280     IF INV-SHORT-BAL-DAILY-FAC = ZEROS                           04828000
048290         GO TO P0529-EXIT.                                        04829000
048300     ADD INV-SHORT-BAL-DAILY-FAC TO INV-SHORT-BAL.                04830000
048310     IF INV-SHORT-BAL LESS THAN ZERO                              04831000
048320         MOVE ZEROS TO INV-SHORT-BAL.                             04832000
048330                                                                  04833000
048340 P0529-EXIT.                                                      04834000
048350     EXIT.                                                        04835000
048360                                                                  04836000
048370******************************************************************04837000
048380*    C U R R E N T   A C C R U A L   R O U T I N E               *04838000
048390******************************************************************04839000
048400 P0530-CURR-ACCRUAL-ROUTINE.                                      04840000
048410     IF CURR-ACCR-CNTR = ZERO                                     04841000
048420         ADD 1 TO CURR-ACCR-CNTR                                  04842000
048430       ELSE                                                       04843000
048440         IF CALENDAR-DAY                                          04844000
048450             MOVE TWO-DAY-FLOAT-AMT TO ONE-DAY-FLOAT-AMT          04845000
048460             MOVE THREE-DAY-FLOAT-AMT TO TWO-DAY-FLOAT-AMT        04846000
048470             MOVE FOUR-DAY-FLOAT-AMT TO THREE-DAY-FLOAT-AMT       04847000
048480             MOVE FIVE-DAY-FLOAT-AMT TO FOUR-DAY-FLOAT-AMT        04848000
048490             MOVE ZEROS TO FIVE-DAY-FLOAT-AMT.                    04849000
048500     IF CLOSED                                                    04850000
048510         IF TODAY                                                 04851000
048520             NEXT SENTENCE                                        04852000
048530           ELSE                                                   04853000
048540             GO TO P0559-EXIT.                                    04854000
048550     COMPUTE CURR-NET-COLL-BAL =                                  04855000
048560         CURRENT-BALANCE -                                        04856000
048570         (ONE-DAY-FLOAT-AMT + TWO-DAY-FLOAT-AMT +                 04857000
048580         THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +               04858000
048590         FIVE-DAY-FLOAT-AMT).                                     04859000
048600     ADD CURR-NET-COLL-BAL TO GROSS-COLL-BAL-CYCL                 04860000
048610                              GROSS-COLL-BAL-MNTH                 04861000
048620                              GR-CUR-SINCE-LST-STMT.              04862000
048630     ADD CURRENT-BALANCE TO GROSS-CURR-BAL-CYCL                   04863000
048640                            GROSS-CURR-BAL-MNTH                   04864000
048650                            GR-COL-SINCE-LST-STMT.                04865000
048660     ADD 1 TO DAYS-IN-CAL-MONTH                                   04866000
048670              DAYS-IN-CYCLE                                       04867000
048680              DAYS-SINCE-LAST-STMT.                               04868000
048690     IF DAYS-IN-CYCLE = ZEROS                                     04869000
048700         MOVE 1 TO DAYS-IN-CYCLE.                                 04870000
048710     DIVIDE GROSS-CURR-BAL-CYCL BY DAYS-IN-CYCLE                  04871000
048720         GIVING AVG-CUR-BAL-TO-LOAD.                              04872000
048730     DIVIDE GROSS-COLL-BAL-CYCL BY DAYS-IN-CYCLE                  04873000
048740         GIVING AVG-COL-BAL-TO-LOAD.                              04874000
048750     IF DDA-ACCOUNT                                               04875000
048760         GO TO P0540-CURR-ACCR-ODB.                               04876000
048770     PERFORM P0600-TIS-GROSS THRU P0609-EXIT.                     04877000
048780     MOVE 1 TO EARN-RETURN.                                       04878000
048790     PERFORM P0570-ACCR-INT THRU P0579-EXIT.                      04879000
048800     ADD HOLD-DAILY-ACCR TO ACCRUED-INTEREST                      04880000
048810                            TDY-EXP-BY-IDENT (11)                 04881000
048820                            TDY-EXP-BY-IDENT (SUB13).             04882000
048830     MOVE HOLD-DAILY-ACCR TO ACCRUED-INTEREST-DAILY-FAC.          04883000
048840     ADD HOLD-MIN-ACCR TO MIN-ACCR-INTEREST.                      04884000
048850     IF INTEREST-RATE = ZEROS                                     04885000
048860         GO TO P0535-CURR-ACCR-CHK-FOR-DSS.                       04886000
048870     IF HOLD-DAILY-ACCR GREATER THAN ZERO                         04887000
048880         ADD 1 TO GROSS-RATE-DAYS                                 04888000
048890         EVALUATE EARN-BALANCE-CODE (SUB18)                       04889000
048900           WHEN '1'                                               04890000
048910             MOVE TIS-GRS-CUR-BAL-CYC TO TIS-GRS-BAL-WORK         04891000
048920             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04892000
048930                 COMPUTE GROSS-RATE =                             04893000
048940                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04894000
048950                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04895000
048960             ELSE                                                 04896000
048970                 MOVE ZEROS TO GROSS-RATE                         04897000
048980             END-IF                                               04898000
048990           WHEN '2'                                               04899000
049000             MOVE TIS-GRS-COL-BAL-CYC TO TIS-GRS-BAL-WORK         04900000
049010             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04901000
049020                 COMPUTE GROSS-RATE =                             04902000
049030                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04903000
049040                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04904000
049050             ELSE                                                 04905000
049060                 MOVE ZEROS TO GROSS-RATE                         04906000
049070             END-IF                                               04907000
049080           WHEN '4'                                               04908000
049090             MOVE TIS-GRS-COL-BAL-CYC TO TIS-GRS-BAL-WORK         04909000
049100             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04910000
049110                 COMPUTE GROSS-RATE =                             04911000
049120                     ACCRUED-INTEREST / (TIS-GRS-BAL-WORK *       04912000
049130                     (1.00000 - EARN-INT-ACCR-RESERVE (SUB18))) * 04913000
049140                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04914000
049150             ELSE                                                 04915000
049160                 MOVE ZEROS TO GROSS-RATE                         04916000
049170             END-IF                                               04917000
049180           WHEN OTHER                                             04918000
049190             MOVE TIS-GRS-CUR-BAL-CYC TO TIS-GRS-BAL-WORK         04919000
049200             IF TIS-GRS-BAL-WORK GREATER THAN ZEROS               04920000
049210                 COMPUTE GROSS-RATE =                             04921000
049220                     ACCRUED-INTEREST / TIS-GRS-BAL-WORK *        04922000
049230                     HOLD-DAYS-IN-YEAR * GROSS-RATE-DAYS          04923000
049240             ELSE                                                 04924000
049250                 MOVE ZEROS TO GROSS-RATE                         04925000
049260             END-IF                                               04926000
049270         END-EVALUATE                                             04927000
049280     END-IF.                                                      04928000
049290                                                                  04929000
049300 P0535-CURR-ACCR-CHK-FOR-DSS.                                     04930000
049310     IF PROC-DSS                                                  04931000
049320         GO TO P0559-EXIT.                                        04932000
049330                                                                  04933000
049340 P0540-CURR-ACCR-ODB.                                             04934000
049350     IF ODB-PLAN = SPACES                                         04935000
049360         GO TO P0545-CURR-ACCR-INV.                               04936000
049370                                                                  04937000
049380     IF ODB-LOAN-BAL GREATER THAN FIRST-INT-AMT                   04938000
049390         IF FIRST-INT-RATE EQUAL SECOND-INT-RATE                  04939000
049400             ADD ODB-LOAN-BAL  TO GROSS-LOAN-BAL                  04940000
049410         ELSE                                                     04941000
049420             ADD FIRST-INT-AMT TO GROSS-LOAN-BAL                  04942000
049430             COMPUTE WORK-ODB-LOAN-BAL =                          04943000
049440                     ODB-LOAN-BAL - FIRST-INT-AMT                 04944000
049450             ADD WORK-ODB-LOAN-BAL TO 2ND-GROSS-LOAN-BAL          04945000
049460         END-IF                                                   04946000
049470     ELSE                                                         04947000
049480         ADD ODB-LOAN-BAL  TO GROSS-LOAN-BAL                      04948000
049490     END-IF.                                                      04949000
049500                                                                  04950000
049510     IF AMT-PAST-DUE GREATER THAN ZERO                            04951000
049520         ADD 1 TO NUM-DAYS-DELQ.                                  04952000
049530     PERFORM P0580-ACCR-ODB-INT THRU P0589-EXIT.                  04953000
049540     IF TEMP-CR-LIFE GREATER THAN ZERO                            04954000
049550         ADD TEMP-CR-LIFE TO ODB-ACCUM-CR-LIFE.                   04955000
049560     ADD TEMP-DAILY-INT TO ODB-ACCRUED-F-C.                       04956000
049570     ADD 0 ODB-ACCRUED-F-C GIVING MONTHLY-ACCUM-INT.              04957000
049580     MOVE MONTHLY-ACCUM-INT TO HOLD-MONTHLY-ACCUM-INT.            04958000
049590     ADD TEMP-DAILY-INT TO TDY-ACCR-BY-PLAN-ODB (SUB10)           04959000
049600                           TDY-ACCR-BY-PLAN-ODB (11).             04960000
049610     MOVE TEMP-DAILY-INT    TO OBGL-ACCR-INT-AMT.                 04961000
049620     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             04962000
049630                                                                  04963000
049640 P0545-CURR-ACCR-INV.                                             04964000
049650     IF INV-PLAN = SPACES OR 'IC'                                 04965000
049660         GO TO P0559-EXIT                                         04966000
049670     END-IF.                                                      04967000
049680     MOVE ZEROS TO INV-ACCR-INT-DAILY-FAC                         04968000
049690                   INV-GROSS-INT-DAILY-FAC.                       04969000
049700     IF INV-BALANCE = ZERO                                        04970000
049710         GO TO P0550-CURR-ACCR-INV-CONT.                          04971000
049720     ADD INV-BALANCE TO INV-GROSS-BAL                             04972000
049730                        INV-GROSS-BAL-YTD.                        04973000
049740     ADD 1 TO INV-DAYS-INVESTED.                                  04974000
049750     PERFORM P0590-ACCR-INV-INT THRU P0599-EXIT.                  04975000
049760     ADD HOLD-DAILY-ACCR TO INV-ACCRUED-INT                       04976000
049770                            TDY-ACCR-BY-PLAN-INV (SUB11)          04977000
049780                            TDY-ACCR-BY-PLAN-INV (11).            04978000
049790     MOVE HOLD-DAILY-ACCR TO INV-ACCR-INT-DAILY-FAC.              04979000
049800     ADD HOLD-GROSS-DAILY-INT TO INV-GROSS-INT                    04980000
049810                                 INV-GROSS-INT-YTD.               04981000
049820     MOVE HOLD-GROSS-DAILY-INT TO INV-GROSS-INT-DAILY-FAC.        04982000
049830                                                                  04983000
049840 P0550-CURR-ACCR-INV-CONT.                                        04984000
049850     IF INV-NO-ADJUSTMENT OR INV-ADJUST-PEGGED                    04985000
049860         GO TO P0559-EXIT.                                        04986000
049870     IF INV-SHORT-BAL-DAILY-FAC = ZEROS                           04987000
049880         GO TO P0559-EXIT.                                        04988000
049890     IF CURR-ACCR-CNTR-INV = ZERO                                 04989000
049900         ADD 1 TO CURR-ACCR-CNTR-INV                              04990000
049910       ELSE                                                       04991000
049920         ADD INV-SHORT-BAL-DAILY-FAC TO INV-SHORT-BAL             04992000
049930         IF INV-SHORT-BAL LESS THAN ZERO                          04993000
049940             MOVE ZEROS TO INV-SHORT-BAL.                         04994000
049950                                                                  04995000
049960 P0559-EXIT.                                                      04996000
049970     EXIT.                                                        04997000
049980                                                                  04998000
049990******************************************************************04999000
050000*    M E M O   A C C R U A L   R O U T I N E                     *05000000
050010******************************************************************05001000
050020 P0560-MEMO-ACCRUAL-ROUTINE.                                      05002000
050030     IF CLOSED                                                    05003000
050040         GO TO P0569-EXIT.                                        05004000
050050     IF DDA-ACCOUNT                                               05005000
050060         GO TO P0562-MEMO-ACCR-ODB.                               05006000
050070     MOVE 1 TO EARN-RETURN.                                       05007000
050080     PERFORM P0570-ACCR-INT THRU P0579-EXIT.                      05008000
050090     ADD HOLD-DAILY-ACCR TO MEMO-ACCR-INTEREST.                   05009000
050100     IF PROC-DSS                                                  05010000
050110         GO TO P0569-EXIT.                                        05011000
050120                                                                  05012000
050130 P0562-MEMO-ACCR-ODB.                                             05013000
050140     IF ODB-PLAN = SPACES                                         05014000
050150         GO TO P0564-MEMO-ACCR-INV.                               05015000
050160     PERFORM P0580-ACCR-ODB-INT THRU P0589-EXIT.                  05016000
050170     IF TEMP-CR-LIFE GREATER THAN ZERO                            05017000
050180         ADD TEMP-CR-LIFE TO ODB-MEMO-ACCR-CR-LIFE.               05018000
050190     ADD TEMP-DAILY-INT TO ODB-MEMO-ACCR-F-C.                     05019000
050200                                                                  05020000
050210 P0564-MEMO-ACCR-INV.                                             05021000
050220     IF INV-PLAN = SPACES OR 'IC'                                 05022000
050230         GO TO P0569-EXIT                                         05023000
050240     END-IF.                                                      05024000
050250     IF INV-BALANCE = ZERO                                        05025000
050260         GO TO P0569-EXIT.                                        05026000
050270     PERFORM P0590-ACCR-INV-INT THRU P0599-EXIT.                  05027000
050280     ADD HOLD-DAILY-ACCR TO INV-MEMO-ACCR-INT.                    05028000
050290                                                                  05029000
050300 P0569-EXIT.                                                      05030000
050310     EXIT.                                                        05031000
050320                                                                  05032000
050330 P0570-ACCR-INT.                                                  05033000
050340     MOVE CYCLE-THIS-STMT TO HOLD-CYCLE-SW.                       05034000
050350     MOVE CYCLE-THIS-SC-EARN TO HOLD-SC-CYC-SW.                   05035000
050360     MOVE BCF-ACCOUNT-INFORMATION (SUB-ID) TO HOLD-ACCT-INFO.     05036000
050370     MOVE BCF-EARN-RTN-INFO (SUB18) TO HOLD-EARN-INFO.            05037000
050380     IF BACK-DATED-SW = 1                                         05038000
050390         MOVE DSDSTXL-AMOUNT TO HOLD-TTX-AMOUNT                   05039000
050400       ELSE                                                       05040000
050410         MOVE ZEROS TO HOLD-TTX-AMOUNT.                           05041000
050420     IF PROC-DSD                                                  05042000
050430         GO TO P0572-ACCR-DSD.                                    05043000
050440     GO TO P0574-ACCR-DSS.                                        05044000
050450                                                                  05045000
050460 P0572-ACCR-DSD.                                                  05046000
050470     EVALUATE PROC-BK-NO                                          05047000
050480         WHEN 01                                                  05048000
050490             CALL 'DDERN01' USING DSDS-MASTER-RECORD              05049000
050500                                  EARNINGS-ROUTINE-WORK-AREA      05050000
050510         WHEN 02                                                  05051000
050520             CALL 'DDERN02' USING DSDS-MASTER-RECORD              05052000
050530                                  EARNINGS-ROUTINE-WORK-AREA      05053000
050540         WHEN 10                                                  05054000
050550             CALL 'DDERN10' USING DSDS-MASTER-RECORD              05055000
050560                                  EARNINGS-ROUTINE-WORK-AREA      05056000
050570         WHEN 11                                                  05057000
050580             CALL 'DDERN11' USING DSDS-MASTER-RECORD              05058000
050590                                  EARNINGS-ROUTINE-WORK-AREA      05059000
050600         WHEN 14                                                  05060000
050610             CALL 'DDERN14' USING DSDS-MASTER-RECORD              05061000
050620                                  EARNINGS-ROUTINE-WORK-AREA      05062000
050630         WHEN 15                                                  05063000
050640             CALL 'DDERN15' USING DSDS-MASTER-RECORD              05064000
050650                                  EARNINGS-ROUTINE-WORK-AREA      05065000
050660         WHEN 16                                                  05066000
050670             CALL 'DDERN16' USING DSDS-MASTER-RECORD              05067000
050680                                  EARNINGS-ROUTINE-WORK-AREA      05068000
050690         WHEN 20                                                  05069000
050700             CALL 'DDERN20' USING DSDS-MASTER-RECORD              05070000
050710                                  EARNINGS-ROUTINE-WORK-AREA      05071000
050720         WHEN 22                                                  05072000
050730             CALL 'DDERN22' USING DSDS-MASTER-RECORD              05073000
050740                                  EARNINGS-ROUTINE-WORK-AREA      05074000
050750         WHEN 24                                                  05075000
050760             CALL 'DDERN24' USING DSDS-MASTER-RECORD              05076000
050770                                  EARNINGS-ROUTINE-WORK-AREA      05077000
050780         WHEN 27                                                  05078000
050790             CALL 'DDERN27' USING DSDS-MASTER-RECORD              05079000
050800                                  EARNINGS-ROUTINE-WORK-AREA      05080000
050810         WHEN 29                                                  05081000
050820             CALL 'DDERN29' USING DSDS-MASTER-RECORD              05082000
050830                                  EARNINGS-ROUTINE-WORK-AREA      05083000
050840         WHEN 39                                                  05084000
050850             CALL 'DDERN39' USING DSDS-MASTER-RECORD              05085000
050860                                  EARNINGS-ROUTINE-WORK-AREA      05086000
050870         WHEN 45                                                  05087000
050880             CALL 'DDERN45' USING DSDS-MASTER-RECORD              05088000
050890                                  EARNINGS-ROUTINE-WORK-AREA      05089000
050900         WHEN OTHER                                               05090000
050910         CALL DSD-EARN-MODULE                                     05091000
050920                            USING DSDS-MASTER-RECORD              05092000
050930                                  EARNINGS-ROUTINE-WORK-AREA      05093000
050940     END-EVALUATE.                                                05094000
050950                                                                  05095000
050960     GO TO P0576-ACCR-RETURN.                                     05096000
050970                                                                  05097000
050980 P0574-ACCR-DSS.                                                  05098000
050990     EVALUATE PROC-BK-NO                                          05099000
051000         WHEN 01                                                  05100000
051010             CALL 'DSERN01' USING DSDS-MASTER-RECORD              05101000
051020                                  EARNINGS-ROUTINE-WORK-AREA      05102000
051030         WHEN 02                                                  05103000
051040             CALL 'DSERN02' USING DSDS-MASTER-RECORD              05104000
051050                                  EARNINGS-ROUTINE-WORK-AREA      05105000
051060         WHEN 10                                                  05106000
051070             CALL 'DSERN10' USING DSDS-MASTER-RECORD              05107000
051080                                  EARNINGS-ROUTINE-WORK-AREA      05108000
051090         WHEN 11                                                  05109000
051100             CALL 'DSERN11' USING DSDS-MASTER-RECORD              05110000
051110                                  EARNINGS-ROUTINE-WORK-AREA      05111000
051120         WHEN 14                                                  05112000
051130             CALL 'DSERN14' USING DSDS-MASTER-RECORD              05113000
051140                                  EARNINGS-ROUTINE-WORK-AREA      05114000
051150         WHEN 15                                                  05115000
051160             CALL 'DSERN15' USING DSDS-MASTER-RECORD              05116000
051170                                  EARNINGS-ROUTINE-WORK-AREA      05117000
051180         WHEN 16                                                  05118000
051190             CALL 'DSERN16' USING DSDS-MASTER-RECORD              05119000
051200                                  EARNINGS-ROUTINE-WORK-AREA      05120000
051210         WHEN 20                                                  05121000
051220             CALL 'DSERN20' USING DSDS-MASTER-RECORD              05122000
051230                                  EARNINGS-ROUTINE-WORK-AREA      05123000
051240         WHEN 22                                                  05124000
051250             CALL 'DSERN22' USING DSDS-MASTER-RECORD              05125000
051260                                  EARNINGS-ROUTINE-WORK-AREA      05126000
051270         WHEN 24                                                  05127000
051280             CALL 'DSERN24' USING DSDS-MASTER-RECORD              05128000
051290                                  EARNINGS-ROUTINE-WORK-AREA      05129000
051300         WHEN 27                                                  05130000
051310             CALL 'DSERN27' USING DSDS-MASTER-RECORD              05131000
051320                                  EARNINGS-ROUTINE-WORK-AREA      05132000
051330         WHEN 29                                                  05133000
051340             CALL 'DSERN29' USING DSDS-MASTER-RECORD              05134000
051350                                  EARNINGS-ROUTINE-WORK-AREA      05135000
051360         WHEN 39                                                  05136000
051370             CALL 'DSERN39' USING DSDS-MASTER-RECORD              05137000
051380                                  EARNINGS-ROUTINE-WORK-AREA      05138000
051390         WHEN 45                                                  05139000
051400             CALL 'DSERN45' USING DSDS-MASTER-RECORD              05140000
051410                                  EARNINGS-ROUTINE-WORK-AREA      05141000
051420         WHEN OTHER                                               05142000
051430             CALL DSS-EARN-MODULE                                 05143000
051440                            USING DSDS-MASTER-RECORD              05144000
051450                                  EARNINGS-ROUTINE-WORK-AREA      05145000
051460                                                                  05146000
051470     END-EVALUATE.                                                05147000
051480                                                                  05148000
051490 P0576-ACCR-RETURN.                                               05149000
051500     EVALUATE EARN-RETURN                                         05150000
051510         WHEN 0                                                   05151000
051520             CONTINUE                                             05152000
051530         WHEN 1                                                   05153000
051540             ADD .00500 TO ACCRUED-INTEREST                       05154000
051550             MOVE ACCRUED-INTEREST TO HOLD-EARNINGS               05155000
051560             PERFORM P5502-NO-CREDIT                              05156000
051570         WHEN 2                                                   05157000
051580             MOVE 23 TO HOLD-REASON-CODE                          05158000
051590             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT     05159000
051600         WHEN 3                                                   05160000
051610             MOVE 24 TO HOLD-REASON-CODE                          05161000
051620             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT     05162000
051630         WHEN OTHER                                               05163000
051640             DISPLAY 'BAD EARN RETURN CODE ' EARN-RETURN          05164000
051650                 UPON CONSOLE                                     05165000
051660             DISPLAY 'ACCOUNT ' ACCOUNT-ID ' ' ACCOUNT-NUMBER     05166000
051670                 UPON CONSOLE                                     05167000
051680             DISPLAY 'EARNINGS CODE ' EARNINGS-CODE               05168000
051690                 UPON CONSOLE                                     05169000
051700             CALL 'CDCDUMP' USING BY CONTENT '2036'               05170000
051710     END-EVALUATE.                                                05171000
051720                                                                  05172000
051730 P0579-EXIT.                                                      05173000
051740     EXIT.                                                        05174000
051750                                                                  05175000
051760 P0580-ACCR-ODB-INT.                                              05176000
051770     MOVE ZERO TO TEMP-DAILY-INT                                  05177000
051780                  TEMP-CR-LIFE.                                   05178000
051790     IF ODB-LOAN-BAL = ZERO                                       05179000
051800         GO TO P0589-EXIT.                                        05180000
051810     IF NO-CR-LIFE OR CRED-LIFE-RATE = ZERO                       05181000
051820         GO TO P0584-CHK-ODB-VARI.                                05182000
051830     MOVE ODB-LOAN-BAL TO TEMP-LOAN-BAL.                          05183000
051840     IF ODB-LOAN-BAL LESS THAN +5000.00                           05184000
051850         GO TO P0582-ACCRUE-CR-LIFE.                              05185000
051860     IF ODB-SECURED-BY-RE OR EQUITY-CREDIT OR HOME-EQUITY OR      05186000
051870        (PROC-BK-NO = 01 AND EMPLOYEE-RESERVE)                    05187000
051880         IF ODB-LOAN-BAL GREATER THAN +25000.00                   05188000
051890             MOVE +25000.00 TO TEMP-LOAN-BAL                      05189000
051900             GO TO P0582-ACCRUE-CR-LIFE                           05190000
051910           ELSE                                                   05191000
051920             GO TO P0582-ACCRUE-CR-LIFE.                          05192000
051930     MOVE +5000.00 TO TEMP-LOAN-BAL.                              05193000
051940                                                                  05194000
051950 P0582-ACCRUE-CR-LIFE.                                            05195000
051960     COMPUTE TEMP-CR-LIFE ROUNDED =                               05196000
051970         (TEMP-LOAN-BAL * CRED-LIFE-RATE * .03288).               05197000
051980                                                                  05198000
051990 P0584-CHK-ODB-VARI.                                              05199000
052000     MOVE ODB-LOAN-BAL TO TEMP-LOAN-BAL.                          05200000
052010     IF ODB-NO-VARIANCE OR ODB-FIXED-RATE                         05201000
052020         MOVE FIRST-INT-RATE TO ODB-RATE-WK                       05202000
052030         GO TO P0586-ACCRUE.                                      05203000
052040     IF ODB-PLUS-VARIANCE                                         05204000
052050         ADD FIRST-INT-RATE  ODB-RATE-VARIANCE                    05205000
052060             GIVING ODB-RATE-WK                                   05206000
052070       ELSE                                                       05207000
052080         SUBTRACT ODB-RATE-VARIANCE FROM FIRST-INT-RATE           05208000
052090             GIVING ODB-RATE-WK.                                  05209000
052100 P0586-ACCRUE.                                                    05210000
052110     IF TEMP-LOAN-BAL IS GREATER THAN FIRST-INT-AMT               05211000
052120         IF FIRST-INT-RATE EQUAL SECOND-INT-RATE                  05212000
052130             CONTINUE                                             05213000
052140         ELSE                                                     05214000
052150             MOVE FIRST-INT-AMT TO TEMP-MAX1                      05215000
052160             SUBTRACT TEMP-MAX1 FROM TEMP-LOAN-BAL                05216000
052170             COMPUTE TEMP-DAILY-INT ROUNDED =                     05217000
052180                 ((ODB-RATE-WK * TEMP-MAX1) +                     05218000
052190                  (SECOND-INT-RATE * TEMP-LOAN-BAL)) / 365        05219000
052200             MOVE '1' TO ODB-2ND-RATE-IND                         05220000
052210             GO TO P0589-EXIT                                     05221000
052220         END-IF                                                   05222000
052230     END-IF.                                                      05223000
052240     COMPUTE TEMP-DAILY-INT ROUNDED =                             05224000
052250         TEMP-LOAN-BAL * ODB-RATE-WK / 365.                       05225000
052260                                                                  05226000
052270 P0589-EXIT.                                                      05227000
052280     EXIT.                                                        05228000
052290                                                                  05229000
052300 P0590-ACCR-INV-INT.                                              05230000
052310     IF INSURED-CASH-SWEEP                                        05231000
052320        GO TO P0599-EXIT                                          05232000
052330     END-IF.                                                      05233000
052340     MOVE INV-BALANCE TO HOLD-EARN-BALANCE.                       05234000
052350     EVALUATE TRUE                                                05235000
052360         WHEN INV-NO-VARIANCE                                     05236000
052370             MOVE INV-RATE TO HOLD-INTEREST-RATE                  05237000
052380         WHEN INV-FIXED-RATE                                      05238000
052390             MOVE INV-RATE TO HOLD-INTEREST-RATE                  05239000
052400         WHEN INV-PLUS-VARIANCE                                   05240000
052410             COMPUTE HOLD-INTEREST-RATE ROUNDED =                 05241000
052420                 INV-RATE + INV-RATE-VARIANCE                     05242000
052430         WHEN INV-MINUS-VARIANCE                                  05243000
052440             COMPUTE HOLD-INTEREST-RATE ROUNDED =                 05244000
052450                 INV-RATE - INV-RATE-VARIANCE                     05245000
052460         WHEN OTHER                                               05246000
052470             MOVE INV-RATE TO HOLD-INTEREST-RATE                  05247000
052480     END-EVALUATE.                                                05248000
052490                                                                  05249000
052500     IF HOLD-INTEREST-RATE NEGATIVE                               05250000
052510         MOVE ZEROS TO HOLD-DAILY-ACCR                            05251000
052520         GO TO P0599-EXIT                                         05252000
052530     END-IF.                                                      05253000
052540                                                                  05254000
052550     COMPUTE HOLD-GROSS-DAILY-INT ROUNDED =                       05255000
052560         HOLD-EARN-BALANCE *                                      05256000
052570         HOLD-INTEREST-RATE.                                      05257000
052580                                                                  05258000
052590     IF TERM-REPO                                                 05259000
052600         IF INV-INT-ACCR-365                                      05260000
052610             COMPUTE HOLD-DAILY-ACCR ROUNDED =                    05261000
052620                 HOLD-GROSS-DAILY-INT / 365                       05262000
052630             GO TO P0599-EXIT                                     05263000
052640         ELSE                                                     05264000
052650             COMPUTE HOLD-DAILY-ACCR ROUNDED =                    05265000
052660                 HOLD-GROSS-DAILY-INT / 360                       05266000
052670             GO TO P0599-EXIT                                     05267000
052680         END-IF                                                   05268000
052690     END-IF.                                                      05269000
052700                                                                  05270000
052710     IF INV-INT-ACCR-365                                          05271000
052720         COMPUTE HOLD-DAILY-ACCR ROUNDED =                        05272000
052730             HOLD-GROSS-DAILY-INT /                               05273000
052740             HOLD-DAYS-IN-YEAR                                    05274000
052750       ELSE                                                       05275000
052760         COMPUTE HOLD-DAILY-ACCR ROUNDED =                        05276000
052770             HOLD-GROSS-DAILY-INT /                               05277000
052780             360.                                                 05278000
052790                                                                  05279000
052800 P0599-EXIT.                                                      05280000
052810     EXIT.                                                        05281000
052820                                                                  05282000
052830 P0600-TIS-GROSS.                                                 05283000
052840     ADD 1 TO TIS-DAYS-CYC.                                       05284000
052850     IF CURRENT-BALANCE GREATER THAN ZERO                         05285000
052860         ADD CURRENT-BALANCE TO TIS-GRS-CUR-BAL-CYC.              05286000
052870     IF CURR-NET-COLL-BAL GREATER THAN ZERO                       05287000
052880         ADD CURR-NET-COLL-BAL TO TIS-GRS-COL-BAL-CYC.            05288000
052890                                                                  05289000
052900 P0609-EXIT.                                                      05290000
052910     EXIT.                                                        05291000
052920                                                                  05292000
052930 P0610-SET-ODB-TOT-SUB.                                           05293000
052940     MOVE 1 TO SUB10.                                             05294000
052950                                                                  05295000
052960 P0615-ODB-TOT-LOOP.                                              05296000
052970     IF SUB10 = 11                                                05297000
052980         GO TO P0619-EXIT.                                        05298000
052990     IF PLAN-ID-ODB (SUB10) = SPACES                              05299000
053000         MOVE ODB-PLAN TO PLAN-ID-ODB (SUB10)                     05300000
053010         GO TO P0619-EXIT.                                        05301000
053020     IF ODB-PLAN = PLAN-ID-ODB (SUB10)                            05302000
053030         GO TO P0619-EXIT.                                        05303000
053040     ADD 1 TO SUB10.                                              05304000
053050     GO TO P0615-ODB-TOT-LOOP.                                    05305000
053060                                                                  05306000
053070 P0619-EXIT.                                                      05307000
053080     EXIT.                                                        05308000
053090                                                                  05309000
053100 P0620-SET-ODB-BCF-SUB.                                           05310000
053110     MOVE 1 TO SUB14.                                             05311000
053120                                                                  05312000
053130 P0625-ODB-BCF-LOOP.                                              05313000
053140     IF SUB14 = 11                                                05314000
053150         MOVE 1 TO SUB14                                          05315000
053160         GO TO P0629-EXIT.                                        05316000
053170     IF ODB-PLAN-TYPE (SUB14) = SPACES                            05317000
053180         GO TO P0625-ODB-BCF-LOOP.                                05318000
053190     IF ODB-PLAN = ODB-PLAN-TYPE (SUB14)                          05319000
053200         GO TO P0629-EXIT.                                        05320000
053210     ADD 1 TO SUB14.                                              05321000
053220     GO TO P0625-ODB-BCF-LOOP.                                    05322000
053230                                                                  05323000
053240 P0629-EXIT.                                                      05324000
053250     EXIT.                                                        05325000
053260                                                                  05326000
053270 P0630-SET-INV-SUB.                                               05327000
053280     MOVE 1 TO SUB11.                                             05328000
053290                                                                  05329000
053300 P0635-INV-LOOP.                                                  05330000
053310     IF SUB11 = 11                                                05331000
053320         GO TO P0639-EXIT.                                        05332000
053330     IF PLAN-ID-INV (SUB11) = SPACES                              05333000
053340         MOVE INV-PLAN TO PLAN-ID-INV (SUB11)                     05334000
053350         GO TO P0639-EXIT.                                        05335000
053360     IF INV-PLAN = PLAN-ID-INV (SUB11)                            05336000
053370         GO TO P0639-EXIT.                                        05337000
053380     ADD 1 TO SUB11.                                              05338000
053390     GO TO P0635-INV-LOOP.                                        05339000
053400                                                                  05340000
053410 P0639-EXIT.                                                      05341000
053420     EXIT.                                                        05342000
053430                                                                  05343000
053440 P0640-SET-CLASS-SUB.                                             05344000
053450     IF PROC-DSS                                                  05345000
053460         GO TO P0645-DSS.                                         05346000
053470     EVALUATE TRUE                                                05347000
053480         WHEN DDA-ACCOUNT                                         05348000
053490             MOVE 1 TO SUB13                                      05349000
053500             MOVE ACCT-ID-DESC-1 (1) TO DESC-BY-IDENT (1)         05350000
053510         WHEN NOW-ACCOUNT                                         05351000
053520             MOVE 2 TO SUB13                                      05352000
053530             MOVE 'INTEREST CHECKING' TO DESC-BY-IDENT (2)        05353000
053540         WHEN CMM-ACCOUNT                                         05354000
053550             MOVE 3 TO SUB13                                      05355000
053560             MOVE 'CHECKING MONEY MARKET' TO DESC-BY-IDENT (3)    05356000
053570         WHEN IMP-ACCOUNT                                         05357000
053580             MOVE 5 TO SUB13                                      05358000
053590             MOVE 'SPECIAL IMMA PUBLIC FUND' TO DESC-BY-IDENT (5) 05359000
053600         WHEN IMT-ACCOUNT                                         05360000
053610             MOVE 6 TO SUB13                                      05361000
053620             MOVE 'SPECIAL IMMA TRUST' TO DESC-BY-IDENT (6)       05362000
053630         WHEN IMA-ACCOUNT                                         05363000
053640             MOVE 7 TO SUB13                                      05364000
053650             MOVE 'SPECIAL IMMA ADVANTAGE' TO DESC-BY-IDENT (7)   05365000
053660         WHEN IML-ACCOUNT                                         05366000
053670             MOVE 8 TO SUB13                                      05367000
053680             MOVE 'SPECIAL IMMA MONEYLINK' TO DESC-BY-IDENT (8)   05368000
053690         WHEN IMM-ACCOUNT                                         05369000
053700             MOVE 4 TO SUB13                                      05370000
053710             MOVE 'INSURED MONEY MARKET' TO DESC-BY-IDENT (4)     05371000
053720         WHEN OTHER                                               05372000
053730             MOVE 1 TO SUB13                                      05373000
053740             MOVE ACCT-ID-DESC-1 (1) TO DESC-BY-IDENT (1)         05374000
053750     END-EVALUATE.                                                05375000
053760     GO TO P0649-EXIT.                                            05376000
053770                                                                  05377000
053780 P0645-DSS.                                                       05378000
053790     EVALUATE TRUE                                                05379000
053800         WHEN SAV-ACCOUNT                                         05380000
053810             MOVE 1 TO SUB13                                      05381000
053820             MOVE ACCT-ID-DESC-1 (4)  TO DESC-BY-IDENT (1)        05382000
053830         WHEN CC-ACCOUNT                                          05383000
053840             MOVE 2 TO SUB13                                      05384000
053850             MOVE ACCT-ID-DESC-1 (10) TO DESC-BY-IDENT (2)        05385000
053860         WHEN OTHER                                               05386000
053870             MOVE 1 TO SUB13                                      05387000
053880             MOVE ACCT-ID-DESC-1 (4) TO DESC-BY-IDENT (1)         05388000
053890     END-EVALUATE.                                                05389000
053900                                                                  05390000
053910 P0649-EXIT.                                                      05391000
053920     EXIT.                                                        05392000
053930                                                                  05393000
053940******************************************************************05394000
053950* SUBROUTINE - N E W   A C C O U N T   I D                       *05395000
053960******************************************************************05396000
053970 P0650-NEW-ACCOUNT-ID.                                            05397000
053980     MOVE ACCOUNT-ID TO SUB-ID.                                   05398000
053990     IF ACCOUNT-ID = ACCT-ID-CODE (SUB-ID)                        05399000
054000         NEXT SENTENCE                                            05400000
054010       ELSE                                                       05401000
054020         DISPLAY 'MSTR ACCT.I.D. ' ACCOUNT-ID ' FOUND ON BANK '   05402000
054030             BCF-BANK-NO '-NOT ON BK CTL.' UPON CONSOLE           05403000
054040         CALL 'CDCDUMP' USING BY CONTENT '2037'.                  05404000
054050     MOVE 100 TO HOLD-PROGRAM-ID.                                 05405000
054060     IF FIRST-TIME-SW = 1                                         05406000
054070         NEXT SENTENCE                                            05407000
054080       ELSE                                                       05408000
054090         PERFORM P6700-TOTAL-POSTING-JRNL THRU P6749-EXIT.        05409000
054100     MOVE 0 TO FIRST-TIME-SW.                                     05410000
054110     IF CRF-SUBFILE-ID (SUB-ID) = SAVE-SUB-FILE-ID                05411000
054120         GO TO P0659-EXIT.                                        05412000
054130     MOVE CRF-SUBFILE-ID (SUB-ID) TO SAVE-SUB-FILE-ID             05413000
054140                                     U021-FILE-ID.                05414000
054150                                                                  05415000
054160 P0659-EXIT.                                                      05416000
054170     EXIT.                                                        05417000
054180                                                                  05418000
054190******************************************************************05419000
054200*    M A T C H  M A S T E R  A N D  T R A N S A C T I O N S      *05420000
054210******************************************************************05421000
054220 P1000-MATCH-MSTR-TX.                                             05422000
054230     IF MSTR-ID = DSDSTXL-ID                                      05423000
054240         GO TO P1015-APPLY-TX-TO-MSTR.                            05424000
054250     IF MSTR-ID GREATER THAN DSDSTXL-ID                           05425000
054260         GO TO P1005-UNPOSTED-TX.                                 05426000
054270     GO TO P5000-UPDATE-MASTER.                                   05427000
054280                                                                  05428000
054290 P1005-UNPOSTED-TX.                                               05429000
054300     IF DSDSTXL-CODE = 442                                        05430000
054310         GO TO P1010-TRANSACTION-EXIT.                            05431000
054320     MOVE SPACES TO STOCK-WORK.                                   05432000
054330**********************************   UNLOCATED ACCOUNT-UNPOSTED  *05433000
054340     MOVE 07 TO HOLD-UI-REASON.                                   05434000
054350     IF DSDSTXL-CODE GREATER THAN 679                             05435000
054360         IF DSDSTXL-CODE LESS THAN 690                            05436000
054370             MOVE 15 TO HOLD-UI-REASON.                           05437000
054380     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           05438000
054390                                                                  05439000
054400 P1010-TRANSACTION-EXIT.                                          05440000
054410     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 05441000
054420     GO TO P1000-MATCH-MSTR-TX.                                   05442000
054430                                                                  05443000
054440 P1015-APPLY-TX-TO-MSTR.                                          05444000
054450     IF MSTR-ID-HV = HIGH-VALUES                                  05445000
054460         MOVE 0 TO DSDSTXL-EOB-SW                                 05446000
054470         GO TO P6000-END-OF-BANK.                                 05447000
054480     MOVE 1 TO TX-SW.                                             05448000
054490     IF CLOSED                                                    05449000
054500         IF DSDSTXL-CODE = 442                                    05450000
054510             GO TO P1010-TRANSACTION-EXIT                         05451000
054520           ELSE                                                   05452000
054530             MOVE SPACES TO STOCK-WORK                            05453000
054540**********************************   CLOSED ACCOUNT-UNPOSTED     *05454000
054550             MOVE 05 TO HOLD-UI-REASON                            05455000
054560             PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT    05456000
054570             GO TO P1010-TRANSACTION-EXIT.                        05457000
054580     MOVE DSDSTXL-CODE TO HOLD-TX-CODE-IN.                        05458000
054590                                                                  05459000
054600     IF DSDSTXL-CODE = 516                                        05460000
054610         GO TO P1300-CRED-TX                                      05461000
054620     END-IF.                                                      05462000
054630                                                                  05463000
054640     IF DSDSTXL-CODE LESS THAN 460                                05464000
054650         GO TO P1040-NON-DOLLAR-TX.                               05465000
054660     ADD 1 TO NUM-BILL-TX.                                        05466000
054670     IF OPENED                                                    05467000
054680         GO TO P1020-DEB-OR-CRED.                                 05468000
054690     IF DSDSTXL-CODE = 799                                        05469000
054700         GO TO P1017-OTHER-STATUS-CHECK.                          05470000
054710     IF DORMANT OR ESCHEAT                                        05471000
054720         MOVE SPACES TO STOCK-WORK                                05472000
054730**************************************   DORMANT ACCOUNT UNPOSTED*05473000
054740**************************************   ESCHEAT ACCOUNT UNPOSTED*05474000
054750         MOVE 08 TO HOLD-UI-REASON                                05475000
054760         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        05476000
054770         MOVE 03 TO HOLD-REASON-CODE                              05477000
054780         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         05478000
054790         IF DSDSTXL-CODE = 460 OR DSDSTXL-CODE GREATER THAN 699   05479000
054800             ADD DSDSTXL-AMOUNT TO UNPOST-AMT                     05480000
054810             GO TO P1010-TRANSACTION-EXIT                         05481000
054820           ELSE                                                   05482000
054830             GO TO P1010-TRANSACTION-EXIT.                        05483000
054840                                                                  05484000
054850     IF DORMANT-DECEASED                                          05485000
054860         MOVE SPACES TO STOCK-WORK                                05486000
054870******************************* DORMANT/DECEASED ACCOUNT UNPOSTED*05487000
054880         MOVE 42 TO HOLD-UI-REASON                                05488000
054890         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        05489000
054900         MOVE 35 TO HOLD-REASON-CODE                              05490000
054910         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         05491000
054920         IF DSDSTXL-CODE = 460 OR DSDSTXL-CODE GREATER THAN 699   05492000
054930             ADD DSDSTXL-AMOUNT TO UNPOST-AMT                     05493000
054940             GO TO P1010-TRANSACTION-EXIT                         05494000
054950           ELSE                                                   05495000
054960             GO TO P1010-TRANSACTION-EXIT.                        05496000
054970                                                                  05497000
054980 P1017-OTHER-STATUS-CHECK.                                        05498000
054990     IF INACTIVE                                                  05499000
055000         MOVE 04 TO HOLD-REASON-CODE                              05500000
055010         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         05501000
055020         PERFORM P8865-CREATE-OBS-EXCPT-POSTED THRU P8869-EXIT    05502000
055030         GO TO P1020-DEB-OR-CRED.                                 05503000
055040     IF LOST-CONTACT                                              05504000
055050         MOVE 17 TO HOLD-REASON-CODE                              05505000
055060         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         05506000
055070         PERFORM P8865-CREATE-OBS-EXCPT-POSTED THRU P8869-EXIT    05507000
055080         GO TO P1020-DEB-OR-CRED.                                 05508000
055090     IF WATCHED                                                   05509000
055100         PERFORM P8865-CREATE-OBS-EXCPT-POSTED THRU P8869-EXIT.   05510000
055110     IF WATCHED-ACH                                               05511000
055120         IF DSDSTXL-CODE = 973 OR 980 OR 741                      05512000
055130            PERFORM P8865-CREATE-OBS-EXCPT-POSTED THRU P8869-EXIT 05513000
055140         END-IF                                                   05514000
055150     END-IF.                                                      05515000
055160                                                                  05516000
055170 P1020-DEB-OR-CRED.                                               05517000
055180     IF DSDSTXL-CODE LESS THAN 491                                05518000
055190         GO TO P1025-DEB-OR-CRED2.                                05519000
055200                                                                  05520000
055210 P1025-DEB-OR-CRED2.                                              05521000
055220     IF DSDSTXL-CODE GREATER THAN 699                             05522000
055230         GO TO P1035-MUST-BE-DEB.                                 05523000
055240     IF DSDSTXL-CODE GREATER THAN 679                             05524000
055250         GO TO P2000-ODB-TX.                                      05525000
055260     IF DSDSTXL-CODE = 460                                        05526000
055270         GO TO P1500-DEB-TX.                                      05527000
055280                                                                  05528000
055290 P1030-MUST-BE-CRED.                                              05529000
055300     IF DSDSTXL-ENCL                                              05530000
055310         NEXT SENTENCE                                            05531000
055320       ELSE                                                       05532000
055330         GO TO P1300-CRED-TX.                                     05533000
055340     EVALUATE TRUE                                                05534000
055350         WHEN STMT-TRUNCATED                                      05535000
055360             MOVE 0 TO DSDSTXL-ENCL-TYPE                          05536000
055370         WHEN STMT-IMAGED                                         05537000
055380             IF IMAGE-DEPOSITS                                    05538000
055390                 CONTINUE                                         05539000
055400               ELSE                                               05540000
055410                 MOVE 0 TO DSDSTXL-ENCL-TYPE                      05541000
055420             END-IF                                               05542000
055430         WHEN STMT-WITH-CHECKS                                    05543000
055440             MOVE DEPOSITS-ENCLOSURE-IND TO DSDSTXL-ENCL-TYPE     05544000
055450         WHEN OTHER                                               05545000
055460             MOVE 0 TO DSDSTXL-ENCL-TYPE                          05546000
055470     END-EVALUATE.                                                05547000
055480     GO TO P1300-CRED-TX.                                         05548000
055490                                                                  05549000
055500 P1035-MUST-BE-DEB.                                               05550000
055510     IF ODB-PLAN = SPACES                                         05551000
055520         GO TO P1500-DEB-TX.                                      05552000
055530     IF AMT-PAST-DUE NOT = ZERO                                   05553000
055540         PERFORM P2750-TAKE-PAST-DUE-PMNT THRU P2790-EXIT.        05554000
055550     GO TO P1500-DEB-TX.                                          05555000
055560                                                                  05556000
055570******************************************************************05557000
055580*    N O N  D O L L A R  T R A N S A C T I O N  C O D E S        *05558000
055590******************************************************************05559000
055600 P1040-NON-DOLLAR-TX.                                             05560000
055610     IF WATCHED OR WATCHED-ACH                                    05561000
055620         MOVE 'P' TO HOLD-WA-TX-DISP                              05562000
055630         PERFORM P7250-BUILD-WATCHED-ACCT THRU P7259-EXIT.        05563000
055640     EVALUATE TRUE                                                05564000
055650         WHEN DSDSTXL-CODE LESS THAN 101                          05565000
055660             CONTINUE                                             05566000
055670         WHEN DSDSTXL-CODE LESS THAN 351                          05567000
055680             GO TO P1250-EXT-SERV-CHRG-TXS                        05568000
055690         WHEN DSDSTXL-CODE = 397                                  05569000
055700             GO TO P1210-TX-397                                   05570000
055710         WHEN DSDSTXL-CODE = 398                                  05571000
055720             GO TO P1215-TX-398-399                               05572000
055730         WHEN DSDSTXL-CODE = 399                                  05573000
055740             GO TO P1215-TX-398-399                               05574000
055750         WHEN DSDSTXL-CODE = 400                                  05575000
055760             GO TO P1220-TX-400                                   05576000
055770         WHEN DSDSTXL-CODE = 401                                  05577000
055780             GO TO P1045-TX-401                                   05578000
055790         WHEN DSDSTXL-CODE = 420                                  05579000
055800             GO TO P1075-TX-420                                   05580000
055810         WHEN DSDSTXL-CODE = 421                                  05581000
055820             GO TO P1085-TX-421                                   05582000
055830         WHEN DSDSTXL-CODE = 422                                  05583000
055840             GO TO P1090-TX-422                                   05584000
055850         WHEN DSDSTXL-CODE = 423                                  05585000
055860             GO TO P1095-TX-423                                   05586000
055870         WHEN DSDSTXL-CODE = 424                                  05587000
055880             GO TO P1100-TX-424                                   05588000
055890         WHEN DSDSTXL-CODE = 425                                  05589000
055900             GO TO P1105-TX-425                                   05590000
055910         WHEN DSDSTXL-CODE = 426                                  05591000
055920             GO TO P1135-TX-426                                   05592000
055930         WHEN DSDSTXL-CODE = 427                                  05593000
055940             GO TO P1140-TX-427                                   05594000
055950         WHEN DSDSTXL-CODE = 428                                  05595000
055960             GO TO P1145-TX-428                                   05596000
055970         WHEN DSDSTXL-CODE = 429                                  05597000
055980             GO TO P1150-TX-429                                   05598000
055990         WHEN DSDSTXL-CODE = 430                                  05599000
056000             GO TO P1080-TX-430                                   05600000
056010         WHEN DSDSTXL-CODE = 431                                  05601000
056020             GO TO P1110-TX-431                                   05602000
056030         WHEN DSDSTXL-CODE = 432                                  05603000
056040             GO TO P1115-TX-432                                   05604000
056050         WHEN DSDSTXL-CODE = 433                                  05605000
056060             GO TO P1120-TX-433                                   05606000
056070         WHEN DSDSTXL-CODE = 434                                  05607000
056080             GO TO P1125-TX-434                                   05608000
056090         WHEN DSDSTXL-CODE = 435                                  05609000
056100             GO TO P1130-TX-435                                   05610000
056110         WHEN DSDSTXL-CODE = 436                                  05611000
056120             GO TO P1225-TX-436                                   05612000
056130         WHEN DSDSTXL-CODE = 437                                  05613000
056140             GO TO P1230-TX-437                                   05614000
056150         WHEN DSDSTXL-CODE = 438                                  05615000
056160             GO TO P1155-TX-438                                   05616000
056170         WHEN DSDSTXL-CODE = 439                                  05617000
056180             GO TO P1160-TX-439                                   05618000
056190         WHEN DSDSTXL-CODE = 442                                  05619000
056200             GO TO P1165-TX-442                                   05620000
056210         WHEN DSDSTXL-CODE = 444                                  05621000
056220             GO TO P1170-TX-444                                   05622000
056230         WHEN DSDSTXL-CODE = 445                                  05623000
056240             GO TO P1190-TX-445                                   05624000
056250         WHEN DSDSTXL-CODE = 446                                  05625000
056260             GO TO P1195-TX-446                                   05626000
056270         WHEN DSDSTXL-CODE = 447                                  05627000
056280             GO TO P1200-TX-447                                   05628000
056290         WHEN DSDSTXL-CODE = 448                                  05629000
056300             GO TO P1235-TX-448                                   05630000
056310         WHEN DSDSTXL-CODE = 449                                  05631000
056320             GO TO P1240-TX-449                                   05632000
056330         WHEN OTHER                                               05633000
056340             CONTINUE                                             05634000
056350     END-EVALUATE.                                                05635000
056360                                                                  05636000
056370     MOVE SPACES TO STOCK-WORK.                                   05637000
056380**********************************   INVALID TX CODE-UNPOSTED    *05638000
056390     MOVE 10 TO HOLD-UI-REASON.                                   05639000
056400     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           05640000
056410     GO TO P1010-TRANSACTION-EXIT.                                05641000
056420                                                                  05642000
056430******************************************************************05643000
056440*    U P D A T E   I N V E S T O R G O L D   I M M A   B A L     *05644000
056450******************************************************************05645000
056460 P1045-TX-401.                                                    05646000
056470     MOVE DSDSTXL-AMOUNT TO CASH-MANAGEMENT-BAL-IN-IMMA.          05647000
056480     MOVE DSDSTXL-ITEM-COUNT TO CASH-MANAGEMENT-TRNSFR-CNT.       05648000
056490     GO TO P1010-TRANSACTION-EXIT.                                05649000
056500                                                                  05650000
056510******************************************************************05651000
056520*    I N C R E A S E   N O .   S E R V .   C H R G .   I T E M S *05652000
056530******************************************************************05653000
056540 P1075-TX-420.                                                    05654000
056550     ADD DSDSTXL-ITEM-COUNT TO NUM-SERV-CHG-ITEMS                 05655000
056560                               HOLD-DR-CR-ITM-FOR-AA              05656000
056570                               HOLD-CR-ITM-FOR-AA                 05657000
056580                               HOLD-REG-TELE-CR-ITM-FOR-AA        05658000
056590                               HOLD-ITEMS-FOR-AA.                 05659000
056600     ADD DSDSTXL-ITEM-COUNT TO NUM-DEPOSITED-ITEMS.               05660000
056610     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05661000
056620     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05662000
056630     GO TO P1010-TRANSACTION-EXIT.                                05663000
056640                                                                  05664000
056650******************************************************************05665000
056660*    D E C R E A S E   N O .   S E R V .   C H R G .   I T E M S *05666000
056670******************************************************************05667000
056680 P1080-TX-430.                                                    05668000
056690     SUBTRACT DSDSTXL-ITEM-COUNT FROM NUM-SERV-CHG-ITEMS          05669000
056700                                      HOLD-DR-CR-ITM-FOR-AA       05670000
056710                                      HOLD-CR-ITM-FOR-AA          05671000
056720                                      HOLD-REG-TELE-CR-ITM-FOR-AA 05672000
056730                                      HOLD-ITEMS-FOR-AA.          05673000
056740     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05674000
056750     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05675000
056760     GO TO P1010-TRANSACTION-EXIT.                                05676000
056770                                                                  05677000
056780******************************************************************05678000
056790*    I N C R E A S E  O N E  D A Y  F L O A T  T X  C O D E      *05679000
056800******************************************************************05680000
056810 P1085-TX-421.                                                    05681000
056820     ADD DSDSTXL-AMOUNT TO ONE-DAY-FLOAT-AMT.                     05682000
056830     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              05683000
056840     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05684000
056850     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05685000
056860     GO TO P1010-TRANSACTION-EXIT.                                05686000
056870                                                                  05687000
056880******************************************************************05688000
056890*    I N C R E A S E  T W O  D A Y  F L O A T  T X  C O D E      *05689000
056900******************************************************************05690000
056910 P1090-TX-422.                                                    05691000
056920     ADD DSDSTXL-AMOUNT TO TWO-DAY-FLOAT-AMT.                     05692000
056930     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              05693000
056940     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05694000
056950     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05695000
056960     GO TO P1010-TRANSACTION-EXIT.                                05696000
056970                                                                  05697000
056980******************************************************************05698000
056990*    I N C R E A S E  T H R E E  D A Y  F L O A T  T X  C O D E  *05699000
057000******************************************************************05700000
057010 P1095-TX-423.                                                    05701000
057020     ADD DSDSTXL-AMOUNT TO THREE-DAY-FLOAT-AMT.                   05702000
057030     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              05703000
057040     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05704000
057050     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05705000
057060     GO TO P1010-TRANSACTION-EXIT.                                05706000
057070                                                                  05707000
057080******************************************************************05708000
057090*    I N C R E A S E  F O U R  D A Y  F L O A T  T X  C O D E    *05709000
057100******************************************************************05710000
057110 P1100-TX-424.                                                    05711000
057120     ADD DSDSTXL-AMOUNT TO FOUR-DAY-FLOAT-AMT.                    05712000
057130     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              05713000
057140     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05714000
057150     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05715000
057160     GO TO P1010-TRANSACTION-EXIT.                                05716000
057170                                                                  05717000
057180******************************************************************05718000
057190*    I N C R E A S E  F I V E  D A Y  F L O A T  T X  C O D E    *05719000
057200******************************************************************05720000
057210 P1105-TX-425.                                                    05721000
057220     ADD DSDSTXL-AMOUNT TO FIVE-DAY-FLOAT-AMT.                    05722000
057230     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              05723000
057240     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05724000
057250     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05725000
057260     GO TO P1010-TRANSACTION-EXIT.                                05726000
057270                                                                  05727000
057280******************************************************************05728000
057290*    D E C R E A S E  O N E  D A Y  F L O A T  T X  C O D E      *05729000
057300******************************************************************05730000
057310 P1110-TX-431.                                                    05731000
057320     SUBTRACT DSDSTXL-AMOUNT FROM ONE-DAY-FLOAT-AMT.              05732000
057330     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     05733000
057340     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05734000
057350     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05735000
057360     GO TO P1010-TRANSACTION-EXIT.                                05736000
057370                                                                  05737000
057380******************************************************************05738000
057390*    D E C R E A S E  T W O  D A Y  F L O A T  T X  C O D E      *05739000
057400******************************************************************05740000
057410 P1115-TX-432.                                                    05741000
057420     SUBTRACT DSDSTXL-AMOUNT FROM TWO-DAY-FLOAT-AMT.              05742000
057430     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     05743000
057440     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05744000
057450     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05745000
057460     GO TO P1010-TRANSACTION-EXIT.                                05746000
057470                                                                  05747000
057480******************************************************************05748000
057490*    D E C R E A S E  T H R E E  D A Y  F L O A T  T X  C O D E  *05749000
057500******************************************************************05750000
057510 P1120-TX-433.                                                    05751000
057520     SUBTRACT DSDSTXL-AMOUNT FROM THREE-DAY-FLOAT-AMT.            05752000
057530     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     05753000
057540     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05754000
057550     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05755000
057560     GO TO P1010-TRANSACTION-EXIT.                                05756000
057570                                                                  05757000
057580******************************************************************05758000
057590*    D E C R E A S E  F O U R  D A Y  F L O A T  T X  C O D E    *05759000
057600******************************************************************05760000
057610 P1125-TX-434.                                                    05761000
057620     SUBTRACT DSDSTXL-AMOUNT FROM FOUR-DAY-FLOAT-AMT.             05762000
057630     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     05763000
057640     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05764000
057650     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05765000
057660     GO TO P1010-TRANSACTION-EXIT.                                05766000
057670                                                                  05767000
057680******************************************************************05768000
057690*    D E C R E A S E  F I V E  D A Y  F L O A T  T X  C O D E    *05769000
057700******************************************************************05770000
057710 P1130-TX-435.                                                    05771000
057720     SUBTRACT DSDSTXL-AMOUNT FROM FIVE-DAY-FLOAT-AMT.             05772000
057730     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     05773000
057740     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           05774000
057750     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            05775000
057760     GO TO P1010-TRANSACTION-EXIT.                                05776000
057770                                                                  05777000
057780******************************************************************05778000
057790*       I N C R E A S E   T A X   W I T H H E L D   Y T D        *05779000
057800******************************************************************05780000
057810 P1135-TX-426.                                                    05781000
057820     ADD DSDSTXL-AMOUNT TO TAX-WITHHELD-YTD.                      05782000
057830     MOVE ZEROS TO IRSPL-GROUP-ID.                                05783000
057840     MOVE +114 TO IRSPL-REQUEST-CODE.                             05784000
057850     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              05785000
057860     MOVE 25 TO HOLD-REASON-CODE.                                 05786000
057870     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05787000
057880     GO TO P1010-TRANSACTION-EXIT.                                05788000
057890******************************************************************05789000
057900*       D E C R E A S E   T A X   W I T H H E L D   Y T D        *05790000
057910******************************************************************05791000
057920 P1140-TX-427.                                                    05792000
057930     IF DSDSTXL-AMOUNT GREATER THAN TAX-WITHHELD-YTD              05793000
057940         MOVE ZEROS TO TAX-WITHHELD-YTD                           05794000
057950       ELSE                                                       05795000
057960         SUBTRACT DSDSTXL-AMOUNT FROM TAX-WITHHELD-YTD.           05796000
057970     MOVE ZEROS TO IRSPL-GROUP-ID.                                05797000
057980     MOVE +113 TO IRSPL-REQUEST-CODE.                             05798000
057990     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              05799000
058000     MOVE 25 TO HOLD-REASON-CODE.                                 05800000
058010     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05801000
058020     GO TO P1010-TRANSACTION-EXIT.                                05802000
058030                                                                  05803000
058040******************************************************************05804000
058050*   I N C R E A S E   I N V   T A X   W I T H H E L D   Y T D    *05805000
058060******************************************************************05806000
058070 P1145-TX-428.                                                    05807000
058080     ADD DSDSTXL-AMOUNT TO INV-TAX-WITHHELD-YTD.                  05808000
058090     MOVE +02 TO IRSPL-GROUP-ID.                                  05809000
058100     MOVE +114 TO IRSPL-REQUEST-CODE.                             05810000
058110     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              05811000
058120     MOVE 26 TO HOLD-REASON-CODE.                                 05812000
058130     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05813000
058140     GO TO P1010-TRANSACTION-EXIT.                                05814000
058150******************************************************************05815000
058160*   D E C R E A S E   I N V   T A X   W I T H H E L D   Y T D    *05816000
058170******************************************************************05817000
058180                                                                  05818000
058190 P1150-TX-429.                                                    05819000
058200     IF DSDSTXL-AMOUNT GREATER THAN INV-TAX-WITHHELD-YTD          05820000
058210         MOVE ZEROS TO INV-TAX-WITHHELD-YTD                       05821000
058220       ELSE                                                       05822000
058230         SUBTRACT DSDSTXL-AMOUNT FROM INV-TAX-WITHHELD-YTD.       05823000
058240     MOVE +02 TO IRSPL-GROUP-ID.                                  05824000
058250     MOVE +113 TO IRSPL-REQUEST-CODE.                             05825000
058260     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              05826000
058270     MOVE 26 TO HOLD-REASON-CODE.                                 05827000
058280     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05828000
058290     GO TO P1010-TRANSACTION-EXIT.                                05829000
058300                                                                  05830000
058310******************************************************************05831000
058320*    I N C R E A S E  A C C R U E D  I N T E R E S T  T X        *05832000
058330******************************************************************05833000
058340 P1155-TX-438.                                                    05834000
058350     ADD DSDSTXL-ACCR-INT TO ACCRUED-INTEREST.                    05835000
058360     ADD DSDSTXL-ACCR-INT TO TDY-EXP-BY-IDENT (11).               05836000
058370     ADD DSDSTXL-ACCR-INT TO TDY-EXP-BY-IDENT (SUB13).            05837000
058380     MOVE 12 TO HOLD-REASON-CODE.                                 05838000
058390     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05839000
058400     GO TO P1010-TRANSACTION-EXIT.                                05840000
058410                                                                  05841000
058420******************************************************************05842000
058430*    D E C R E A S E  A C C R U E D  I N T E R E S T  T X        *05843000
058440******************************************************************05844000
058450 P1160-TX-439.                                                    05845000
058460     ADD DSDSTXL-ACCR-INT TO TDY-DROP-BY-IDENT (11).              05846000
058470     ADD DSDSTXL-ACCR-INT TO TDY-DROP-BY-IDENT (SUB13).           05847000
058480     SUBTRACT DSDSTXL-ACCR-INT FROM ACCRUED-INTEREST.             05848000
058490     MOVE 12 TO HOLD-REASON-CODE.                                 05849000
058500     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05850000
058510     GO TO P1010-TRANSACTION-EXIT.                                05851000
058520                                                                  05852000
058530******************************************************************05853000
058540*    S T O P  P A Y M E N T  I N  F O R C E  T X                 *05854000
058550******************************************************************05855000
058560 P1165-TX-442.                                                    05856000
058570     MOVE '1' TO STOP-PAY-INDICATOR.                              05857000
058580     GO TO P1010-TRANSACTION-EXIT.                                05858000
058590                                                                  05859000
058600******************************************************************05860000
058610*    B U S I N E S S L I N K   I N D I C A T O R   T X           *05861000
058620******************************************************************05862000
058630 P1170-TX-444.                                                    05863000
058640     GO TO P1010-TRANSACTION-EXIT.                                05864000
058650                                                                  05865000
058660******************************************************************05866000
058670*    R E Q U E S T  C Y C L E  H I S T O R Y  C A R D  T X       *05867000
058680******************************************************************05868000
058690 P1190-TX-445.                                                    05869000
058700     IF ODB-PLAN = SPACES                                         05870000
058710         GO TO P1010-TRANSACTION-EXIT.                            05871000
058720     IF CYCLE-THIS-HC = 1                                         05872000
058730         GO TO P1010-TRANSACTION-EXIT.                            05873000
058740     IF REQUEST-HISTORY = 1                                       05874000
058750         GO TO P1010-TRANSACTION-EXIT.                            05875000
058760     MOVE 1 TO REQUEST-HISTORY.                                   05876000
058770     MOVE 445 TO HOLD-REPORT-CODE.                                05877000
058780     IF DSDSTXL-ITEM-COUNT = 99999                                05878000
058790         MOVE '4' TO HISTORY-CARD-IND                             05879000
058800     ELSE                                                         05880000
058810         MOVE '3' TO HISTORY-CARD-IND                             05881000
058820     END-IF.                                                      05882000
058830     PERFORM P8600-BUILD-HC-HEADER THRU P8609-BUILD-HCH-EXIT.     05883000
058840     GO TO P1010-TRANSACTION-EXIT.                                05884000
058850                                                                  05885000
058860******************************************************************05886000
058870*    R E Q U E S T  O D B  H I S T O R Y  C A R D  T X  C O D E  *05887000
058880******************************************************************05888000
058890 P1195-TX-446.                                                    05889000
058900     IF ODB-PLAN = SPACES                                         05890000
058910         GO TO P1010-TRANSACTION-EXIT.                            05891000
058920     IF CYCLE-THIS-HC = 1                                         05892000
058930         GO TO P1010-TRANSACTION-EXIT.                            05893000
058940     IF REQUEST-HISTORY = 1                                       05894000
058950         GO TO P1010-TRANSACTION-EXIT.                            05895000
058960     MOVE 1 TO REQUEST-HISTORY.                                   05896000
058970     MOVE 446 TO HOLD-REPORT-CODE.                                05897000
058980     MOVE '3' TO HISTORY-CARD-IND.                                05898000
058990     PERFORM P8600-BUILD-HC-HEADER THRU P8609-BUILD-HCH-EXIT.     05899000
059000     GO TO P1010-TRANSACTION-EXIT.                                05900000
059010                                                                  05901000
059020******************************************************************05902000
059030*    O V E R D R A F T   I N D I C A T O R   T X                 *05903000
059040******************************************************************05904000
059050 P1200-TX-447.                                                    05905000
059060     MOVE 1 TO 447-SW.                                            05906000
059070     GO TO P1010-TRANSACTION-EXIT.                                05907000
059080                                                                  05908000
059090******************************************************************05909000
059100*    R E Q U E S T   C Y C L E   S T A T E M E N T               *05910000
059110******************************************************************05911000
059120 P1210-TX-397.                                                    05912000
059130     IF CYCLE-THIS-STMT = 1                                       05913000
059140         GO TO P1010-TRANSACTION-EXIT.                            05914000
059150     ADD 1 TO NUM-REQUEST-397.                                    05915000
059160     MOVE 1 TO CYCLE-THIS-STMT.                                   05916000
059170     MOVE 1 TO CYCLE-THIS-SC-EARN.                                05917000
059180     MOVE 1 TO 397-SW.                                            05918000
059190     IF ACCOUNT-ID LESS THAN 004                                  05919000
059200         PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT.             05920000
059210     IF DSDSTXL-ITEM-COUNT = 99999                                05921000
059220         NEXT SENTENCE                                            05922000
059230       ELSE                                                       05923000
059240         GO TO P1010-TRANSACTION-EXIT.                            05924000
059250     MOVE 2 TO 397-SW.                                            05925000
059260     ADD 1 TO NUM-CYCLES-TO-WAIVE-SC.                             05926000
059270     IF ODB-PLAN = SPACES                                         05927000
059280         NEXT SENTENCE                                            05928000
059290       ELSE                                                       05929000
059300         IF NOT ODB-CLOSED-DELETE                                 05930000
059310             ADD 1 TO ODB-NUM-PYMTS-TO-WAIVE.                     05931000
059320     GO TO P1010-TRANSACTION-EXIT.                                05932000
059330                                                                  05933000
059340******************************************************************05934000
059350*    R E Q U E S T   S P E C I A L   S T A T E M E N T           *05935000
059360******************************************************************05936000
059370 P1215-TX-398-399.                                                05937000
059380     IF CYCLE-THIS-STMT = 1                                       05938000
059390         GO TO P1010-TRANSACTION-EXIT.                            05939000
059400     IF REQUEST-STMT = 1                                          05940000
059410         GO TO P1010-TRANSACTION-EXIT.                            05941000
059420     IF REQ-STMT-NO-ENCL = 1                                      05942000
059430         GO TO P1010-TRANSACTION-EXIT.                            05943000
059440     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   05944000
059450     IF BCFSCR-CHARGE-A-TIME                                      05945000
059460         MOVE 1 TO SPEC-SC-THIS-SPEC-CHKR.                        05946000
059470     IF DSDSTXL-CODE = 398                                        05947000
059480         ADD 1 TO NUM-REQUEST-398                                 05948000
059490         MOVE 1 TO REQUEST-STMT                                   05949000
059500       ELSE                                                       05950000
059510         ADD 1 TO NUM-REQUEST-399                                 05951000
059520         MOVE 1 TO REQ-STMT-NO-ENCL.                              05952000
059530     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                05953000
059540     IF SUB7 = ZERO                                               05954000
059550         GO TO P1010-TRANSACTION-EXIT.                            05955000
059560     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    05956000
059570     MOVE 110 TO DSDSTXL-CODE.                                    05957000
059580     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                05958000
059590     GO TO P1250-EXT-SERV-CHRG-TXS.                               05959000
059600                                                                  05960000
059610******************************************************************05961000
059620*    R E Q U E S T  S E R V I C E  C H A R G E  S T A T E M E N T*05962000
059630******************************************************************05963000
059640 P1220-TX-400.                                                    05964000
059650     IF CYCLE-THIS-SC-EARN = 1                                    05965000
059660         GO TO P1010-TRANSACTION-EXIT.                            05966000
059670     PERFORM P8350-CHECK-SC-STMT THRU P8359-EXIT.                 05967000
059680     GO TO P1010-TRANSACTION-EXIT.                                05968000
059690******************************************************************05969000
059700* I N C R E A S E   I N V   A C C R U E D   I N T E R E S T   T X*05970000
059710******************************************************************05971000
059720                                                                  05972000
059730 P1225-TX-436.                                                    05973000
059740     ADD DSDSTXL-ACCR-INT TO INV-ACCRUED-INT.                     05974000
059750     ADD DSDSTXL-ACCR-INT TO TDY-ACCR-BY-PLAN-INV (11).           05975000
059760     ADD DSDSTXL-ACCR-INT TO TDY-ACCR-BY-PLAN-INV (SUB11).        05976000
059770     MOVE 10 TO HOLD-REASON-CODE.                                 05977000
059780     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05978000
059790     GO TO P1010-TRANSACTION-EXIT.                                05979000
059800                                                                  05980000
059810******************************************************************05981000
059820* D E C R E A S E   I N V   A C C R U E D   I N T E R E S T   T X*05982000
059830******************************************************************05983000
059840 P1230-TX-437.                                                    05984000
059850     IF DSDSTXL-ACCR-INT GREATER THAN INV-ACCRUED-INT             05985000
059860**********************************   DECREASE TOO BIG-UNPOSTED   *05986000
059870         MOVE 14 TO HOLD-UI-REASON                                05987000
059880         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        05988000
059890         GO TO P1010-TRANSACTION-EXIT.                            05989000
059900     ADD DSDSTXL-ACCR-INT TO TDY-DROP-BY-PLAN-INV (11).           05990000
059910     ADD DSDSTXL-ACCR-INT TO TDY-DROP-BY-PLAN-INV (SUB11).        05991000
059920     SUBTRACT DSDSTXL-ACCR-INT FROM INV-ACCRUED-INT.              05992000
059930     MOVE 10 TO HOLD-REASON-CODE.                                 05993000
059940     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            05994000
059950     GO TO P1010-TRANSACTION-EXIT.                                05995000
059960                                                                  05996000
059970******************************************************************05997000
059980* I N C R E A S E   I N V   Y T D   I N T E R E S T   T X        *05998000
059990******************************************************************05999000
060000 P1235-TX-448.                                                    06000000
060010     ADD DSDSTXL-AMOUNT TO INV-INT-PAID-YTD.                      06001000
060020     ADD DSDSTXL-AMOUNT TO TDY-YTD-INC-BY-PLAN-INV (11).          06002000
060030     ADD DSDSTXL-AMOUNT TO TDY-YTD-INC-BY-PLAN-INV (SUB11).       06003000
060040     MOVE 13 TO HOLD-REASON-CODE.                                 06004000
060050     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            06005000
060060     GO TO P1010-TRANSACTION-EXIT.                                06006000
060070                                                                  06007000
060080******************************************************************06008000
060090* D E C R E A S E   I N V   A C C R U E D   I N T E R E S T   T X*06009000
060100******************************************************************06010000
060110 P1240-TX-449.                                                    06011000
060120     IF DSDSTXL-AMOUNT GREATER THAN INV-INT-PAID-YTD              06012000
060130**********************************   DECREASE TOO BIG-UNPOSTED   *06013000
060140         MOVE 18 TO HOLD-UI-REASON                                06014000
060150         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        06015000
060160         GO TO P1010-TRANSACTION-EXIT.                            06016000
060170     ADD DSDSTXL-AMOUNT TO TDY-YTD-DEC-BY-PLAN-INV (11).          06017000
060180     ADD DSDSTXL-AMOUNT TO TDY-YTD-DEC-BY-PLAN-INV (SUB11).       06018000
060190     SUBTRACT DSDSTXL-AMOUNT FROM INV-INT-PAID-YTD.               06019000
060200     MOVE 13 TO HOLD-REASON-CODE.                                 06020000
060210     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            06021000
060220     GO TO P1010-TRANSACTION-EXIT.                                06022000
060230                                                                  06023000
060240******************************************************************06024000
060250*E X T E R N A L   S E R V I C E   C H A R G E   T X   C O D E S *06025000
060260******************************************************************06026000
060270 P1250-EXT-SERV-CHRG-TXS.                                         06027000
060280     SUBTRACT 100 FROM DSDSTXL-CODE GIVING SUB15.                 06028000
060290     IF SUB15 GREATER THAN 0 AND LESS THAN 251                    06029000
060300         NEXT SENTENCE                                            06030000
060310       ELSE                                                       06031000
060320         DISPLAY 'CDCERROR-INVALID EXT SC TX CODE' UPON CONSOLE   06032000
060330         DISPLAY 'TX CODE = ' DSDSTXL-CODE UPON CONSOLE           06033000
060340         CALL 'CDCDUMP' USING BY CONTENT '2038'.                  06034000
060350     IF XSCC-TX-CODE (SUB15) = ZEROS                              06035000
060360         MOVE SPACES TO STOCK-WORK                                06036000
060370**********************************   INVALID TX CODE-UNPOSTED    *06037000
060380         MOVE 10 TO HOLD-UI-REASON                                06038000
060390         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        06039000
060400         GO TO P1290-RESET-XSC.                                   06040000
060410     MOVE EXT-SC-TX-IND (SUB15) TO HOLD-XSC-IND                   06041000
060420                                   HOLD-XSC-IND-FOR-AA.           06042000
060430     MOVE XSCC-AA-AMT-NUM-IND (SUB15) TO HOLD-XSC-AMT-NUM-FOR-AA. 06043000
060440     IF DSDSTXL-ITEM-COUNT = ZERO                                 06044000
060450         MOVE 1 TO DSDSTXL-ITEM-COUNT.                            06045000
060460     IF EXT-SC-TX-IND (SUB15) = 'W'                               06046000
060470         PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT           06047000
060480         PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT    06048000
060490         GO TO P1290-RESET-XSC.                                   06049000
060500     IF XSCC-EXTEND-AMT-IND (SUB15) = 'Y'                         06050000
060510         COMPUTE DSDSTXL-AMOUNT =                                 06051000
060520             DSDSTXL-AMOUNT * DSDSTXL-ITEM-COUNT.                 06052000
060530     IF DSDSTXL-CODE = 118                                        06053000
060540         GO TO P1260-XSC-118.                                     06054000
060550     IF DSDSTXL-CODE = 119                                        06055000
060560         GO TO P1270-XSC-119.                                     06056000
060570     IF XSCC-OVERRIDE-IND (SUB15) = ' '                           06057000
060580         GO TO P1255-CHECK-XSC-IND.                               06058000
060590     IF XSCC-OVERRIDE-IND (SUB15) = 'S' OR 'A'                    06059000
060600         MOVE XSCC-OVERRIDE-IND (SUB15) TO HOLD-XSC-IND           06060000
060610                                           HOLD-XSC-IND-FOR-AA    06061000
060620         GO TO P1275-SOFT-CHARGE.                                 06062000
060630     IF XSCC-OVERRIDE-IND (SUB15) = 'H'                           06063000
060640         MOVE XSCC-OVERRIDE-IND (SUB15) TO HOLD-XSC-IND           06064000
060650                                           HOLD-XSC-IND-FOR-AA    06065000
060660         GO TO P1280-HARD-CHARGE.                                 06066000
060670     IF XSCC-OVERRIDE-IND (SUB15) = 'W'                           06067000
060680         MOVE XSCC-OVERRIDE-IND (SUB15) TO HOLD-XSC-IND           06068000
060690                                           HOLD-XSC-IND-FOR-AA    06069000
060700         PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT           06070000
060710         PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT    06071000
060720         GO TO P1290-RESET-XSC.                                   06072000
060730                                                                  06073000
060740 P1255-CHECK-XSC-IND.                                             06074000
060750     IF EXT-SC-TX-IND (SUB15) = 'H'                               06075000
060760         GO TO P1280-HARD-CHARGE.                                 06076000
060770     GO TO P1275-SOFT-CHARGE.                                     06077000
060780                                                                  06078000
060790 P1260-XSC-118.                                                   06079000
060800     IF PROC-DSS                                                  06080000
060810         GO TO P1290-RESET-XSC.                                   06081000
060820     IF EXT-SC-TX-IND (SUB15) = 'H'                               06082000
060830         MOVE 'W' TO HOLD-XSC-IND                                 06083000
060840                     HOLD-XSC-IND-FOR-AA                          06084000
060850         PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT           06085000
060860         PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT    06086000
060870         GO TO P1290-RESET-XSC.                                   06087000
060880     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           06088000
060890     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            06089000
060900     GO TO P1275-SOFT-CHARGE.                                     06090000
060910                                                                  06091000
060920 P1270-XSC-119.                                                   06092000
060930     IF PROC-DSS                                                  06093000
060940         GO TO P1290-RESET-XSC.                                   06094000
060950     IF EXT-SC-TX-IND (SUB15) = 'H'                               06095000
060960         MOVE 'W' TO HOLD-XSC-IND                                 06096000
060970                     HOLD-XSC-IND-FOR-AA                          06097000
060980         PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT           06098000
060990         PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT    06099000
061000         GO TO P1290-RESET-XSC.                                   06100000
061010     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           06101000
061020     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            06102000
061030     GO TO P1275-SOFT-CHARGE.                                     06103000
061040                                                                  06104000
061050 P1275-SOFT-CHARGE.                                               06105000
061060     IF PERSONAL                                                  06106000
061070         GO TO P1290-RESET-XSC.                                   06107000
061080     ADD DSDSTXL-AMOUNT TO EXT-SERV-CHG-AMT                       06108000
061090                           AMT-EXT-CHRGS (SUB15)                  06109000
061100                           AMT-EXT-CHRGS (251).                   06110000
061110     ADD 1 TO NUM-EXT-CHRGS (SUB15)                               06111000
061120              NUM-EXT-CHRGS (251).                                06112000
061130     PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT.              06113000
061140     PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT.       06114000
061150     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     06115000
061160     GO TO P1290-RESET-XSC.                                       06116000
061170                                                                  06117000
061180 P1280-HARD-CHARGE.                                               06118000
061190     PERFORM P8790-BUILD-ACCT-ANAL-POST-TX THRU P8794-EXIT.       06119000
061200     MOVE XSCC-HARD-CHRG-CODE (SUB15) TO DSDSTXL-CODE.            06120000
061210     MOVE XSCC-DESC-16 (SUB15) TO DSDSTXL-CO-DESC.                06121000
061220     MOVE XSCC-DESC-10 (SUB15) TO DSDSTXL-DESC.                   06122000
061230     MOVE ZEROS TO DSDSTXL-ENCL-TYPE                              06123000
061240                   DSDSTXL-SC-TYPE.                               06124000
061250     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                06125000
061260     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO                        06126000
061270                            DSDSTXL-EFFECT-DT                     06127000
061280                            DSDSTXL-DATE.                         06128000
061290     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          06129000
061300                           AMT-HARD-CHRGS (SUB15)                 06130000
061310                           AMT-HARD-CHRGS (251).                  06131000
061320     ADD 1 TO GEN-DEBIT-CNT                                       06132000
061330              NUM-BILL-TX                                         06133000
061340              NUM-HARD-CHRGS (SUB15)                              06134000
061350              NUM-HARD-CHRGS (251).                               06135000
061360     PERFORM P1665-NORM-DEBIT  THRU P1667-CHECK-HSA-CESA.         06136000
061370     PERFORM P7160-DAILY-EXT-SC-RPT THRU P7169-EXIT.              06137000
061380     GO TO P1290-RESET-XSC.                                       06138000
061390                                                                  06139000
061400 P1290-RESET-XSC.                                                 06140000
061410     MOVE ZEROS TO SUB7.                                          06141000
061420     MOVE 1     TO SUB15.                                         06142000
061430                                                                  06143000
061440 P1295-EXIT.                                                      06144000
061450     EXIT.                                                        06145000
061460                                                                  06146000
061470 P1299-END-EXT-SC.                                                06147000
061480     GO TO P1010-TRANSACTION-EXIT.                                06148000
061490                                                                  06149000
061500******************************************************************06150000
061510*                    P O S T   C R E D I T S                     *06151000
061520******************************************************************06152000
061530 P1300-CRED-TX.                                                   06153000
061540* THIS CHECK IS FOR EAA ACCOUNTS                                  06154000
061550*    IF SC-ROUTINE = 34                                           06155000
061560*        IF DSDSTXL-CODE = 540 OR 590 OR 570 OR 600 OR 601 OR     06156000
061570*                          610 OR 620 OR 535 OR 546 OR 548 OR     06157000
061580*                          543 OR 515 OR 604 OR 669               06158000
061590*            NEXT SENTENCE                                        06159000
061600*          ELSE                                                   06160000
061610*            MOVE 35 TO HOLD-UI-REASON                            06161000
061620*            MOVE SPACES TO STOCK-WORK                            06162000
061630*            PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT    06163000
061640*            GO TO P1010-TRANSACTION-EXIT.                        06164000
061650                                                                  06165000
061660* THIS CHECK IS FOR PREPAID CARD ACCOUNTS                         06166000
061670     IF BCFSCR-PREPAID-CARD                                       06167000
061680         IF PREPAID-CREDIT                                        06168000
061690             NEXT SENTENCE                                        06169000
061700           ELSE                                                   06170000
061710             MOVE 35 TO HOLD-UI-REASON                            06171000
061720             MOVE SPACES TO STOCK-WORK                            06172000
061730             PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT    06173000
061740             GO TO P1010-TRANSACTION-EXIT                         06174000
061750         END-IF                                                   06175000
061760     END-IF.                                                      06176000
061770                                                                  06177000
061780     IF DSDSTXL-CODE = 470                                        06178000
061790         GO TO P1375-RET-CHK-CREDIT.                              06179000
061800     IF DSDSTXL-CODE = 480                                        06180000
061810         GO TO P1375-RET-CHK-CREDIT.                              06181000
061820     IF POST-OD                                                   06182000
061830         GO TO P1305-CK-BAL.                                      06183000
061840     GO TO P1310-CONT-CRED.                                       06184000
061850                                                                  06185000
061860 P1305-CK-BAL.                                                    06186000
061870     IF CURRENT-BALANCE NOT LESS THAN 0                           06187000
061880         IF RET-CHK-CR-SW = 1                                     06188000
061890             MOVE 0 TO RET-CHK-CR-SW                              06189000
061900             MOVE 1 TO SUB-NUM-TMS-OD-SW.                         06190000
061910                                                                  06191000
061920 P1310-CONT-CRED.                                                 06192000
061930* PAYROLL CREDIT                                                  06193000
061940     IF DSDSTXL-CODE = 500 OR 580                                 06194000
061950         GO TO P1320-NORMAL-CREDIT.                               06195000
061960     IF DSDSTXL-CODE = 510                                        06196000
061970         GO TO P1320-NORMAL-CREDIT.                               06197000
061980     IF DSDSTXL-CODE = 660                                        06198000
061990         GO TO P1360-TRANSFER-ACCRUED-660.                        06199000
062000*** 669 *** THIS IS FOR THE REFUND OF FOREIGN ATM FEE FOR THE     06200000
062010***         FREE + INTEREST CHECKING PRODUCT - REFUND NEEDS TO    06201000
062020***         TO BE REPORTED AS INTEREST INCOME                     06202000
062030*** 669 *** REMOVED FROM IF STATEMENT DEC 2017                    06203000
062040     IF DSDSTXL-CODE = 670 OR 622 OR 668                          06204000
062050         GO TO P1355-PAID-INT-CREDIT.                             06205000
062060     IF DSDSTXL-CODE = 614                                        06206000
062070         MOVE CHECKPLUS-CRED-KEY TO SAVE-CR-SORT-KEY              06207000
062080         GO TO P1320-NORMAL-CREDIT.                               06208000
062090     IF OPENED                                                    06209000
062100         GO TO P1315-REG-CREDIT.                                  06210000
062110                                                                  06211000
062120     IF DSDSTXL-CODE = 530 OR 535 OR 515 OR 520 OR 516            06212000
062130         GO TO P1315-REG-CREDIT.                                  06213000
062140     IF COURT-RESTRICT                                            06214000
062150         GO TO P1315-REG-CREDIT.                                  06215000
062160     IF DSDSTXL-BAT-NO = 99921                                    06216000
062170         GO TO P1315-REG-CREDIT.                                  06217000
062180     EVALUATE TRUE                                                06218000
062190         WHEN RESTRICTED                                          06219000
062200             MOVE 12 TO HOLD-UI-REASON                            06220000
062210*                                *   RESTRICTED ACCOUNT-UNPOSTED *06221000
062220         WHEN RESTRICTED-PDO                                      06222000
062230             MOVE 24 TO HOLD-UI-REASON                            06223000
062240*                                *   RESTRICTED - POST DEB ONLY  *06224000
062250         WHEN DECEASED                                            06225000
062260             MOVE 04 TO HOLD-UI-REASON                            06226000
062270*                                *   DECEASED ACCOUNT-UNPOSTED   *06227000
062280         WHEN GARNISH-LEVY                                        06228000
062290             MOVE 03 TO HOLD-UI-REASON                            06229000
062300*                                * GRNSH-LEVY ACCOUNT-UNPOSTED   *06230000
062310         WHEN OTHER                                               06231000
062320             GO TO P1315-REG-CREDIT                               06232000
062330     END-EVALUATE.                                                06233000
062340     MOVE SPACES TO STOCK-WORK.                                   06234000
062350     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           06235000
062360     GO TO P1010-TRANSACTION-EXIT.                                06236000
062370                                                                  06237000
062380 P1315-REG-CREDIT.                                                06238000
062390     IF DSDSTXL-CODE = 540 OR 543                                 06239000
062400         GO TO P1320-NORMAL-CREDIT.                               06240000
062410     IF DSDSTXL-CODE = 600 OR 601 OR 610 OR 626                   06241000
062420         MOVE ATM-DEPOSIT-KEY TO SAVE-CR-SORT-KEY                 06242000
062430         GO TO P1320-NORMAL-CREDIT.                               06243000
062440     IF DSDSTXL-CODE = 490                                        06244000
062450         GO TO P1320-NORMAL-CREDIT.                               06245000
062460     IF DSDSTXL-CODE = 535 OR 515 OR 516                          06246000
062470         GO TO P1430-CLOSEOUT-CREDIT.                             06247000
062480     IF DSDSTXL-CODE = 542                                        06248000
062490         GO TO P1397-CHK-EXT-542.                                 06249000
062500     IF DSDSTXL-CODE = 556 OR 559                                 06250000
062510         GO TO P1390-CHK-EXT-556-559.                             06251000
062520     IF DSDSTXL-CODE = 557                                        06252000
062530         GO TO P1392-CHK-EXT-557.                                 06253000
062540     IF DSDSTXL-CODE = 575                                        06254000
062550         GO TO P1370-ODB-CREDIT.                                  06255000
062560     IF DSDSTXL-CODE = 628 OR 629                                 06256000
062570         GO TO P1387-CHK-EXT-628.                                 06257000
062580     IF DSDSTXL-CODE = 630 OR 631                                 06258000
062590         GO TO P1385-CHK-EXT-630.                                 06259000
062600     IF DSDSTXL-CODE = 653                                        06260000
062610         GO TO P1395-CHK-EXT-653.                                 06261000
062620     IF DSDSTXL-CODE = 665                                        06262000
062630         GO TO P1365-TRANS-INV-ACCR-INT-665.                      06263000
062640                                                                  06264000
062650******************************************************************06265000
062660*        N O R M A L     C R E D I T                             *06266000
062670******************************************************************06267000
062680 P1320-NORMAL-CREDIT.                                             06268000
062690     IF DSDSTXL-EFFECT-DT NOT = ZERO                              06269000
062700         IF DSDSTXL-EFFECT-DT LESS THAN PROC-CURR-DATE            06270000
062710             IF DSDSTXL-CODE NOT = 650                            06271000
062720                 PERFORM P1400-BACK-DATED-CREDIT THRU P1429-EXIT. 06272000
062730                                                                  06273000
062740 P1325-NORM-CR-2.                                                 06274000
062750     ADD 1 TO NUM-CREDITS.                                        06275000
062760     ADD DSDSTXL-AMOUNT TO AMT-CREDITS.                           06276000
062770     ADD DSDSTXL-AMOUNT TO TEMP-CURR-BAL.                         06277000
062780     ADD DSDSTXL-AMOUNT TO CURRENT-BALANCE.                       06278000
062790     IF OD-ACCESS-FEES-IN-OD-BAL GREATER THAN ZERO                06279000
062800         SUBTRACT DSDSTXL-AMOUNT FROM OD-ACCESS-FEES-IN-OD-BAL    06280000
062810         IF OD-ACCESS-FEES-IN-OD-BAL LESS THAN ZERO               06281000
062820             MOVE ZEROS TO OD-ACCESS-FEES-IN-OD-BAL.              06282000
062830                                                                  06283000
062840**  550 - AUTOMATIC TRANSFER (FT)                                 06284000
062850**  590 - DIRECT DEPOSIT                                          06285000
062860**  602 - BANKING@HOME TRANSFER                                   06286000
062870**  SC-ROUTINE 09 IS THE SAVEUP SERVICE CHARGE ROUTINE            06287000
062880**                FOR ALL BANKS                                   06288000
062890     IF SAV-ACCOUNT                                               06289000
062900         IF DSDSTXL-CODE = 550 OR                                 06290000
062910                           590 OR                                 06291000
062920                           602                                    06292000
062930             MOVE 'Y' TO SAVEUP-IND                               06293000
062940         END-IF                                                   06294000
062950     END-IF.                                                      06295000
062960     IF DSDSTXL-CODE = 470 OR                                     06296000
062970                       480 OR                                     06297000
062980                       500 OR                                     06298000
062990                       640                                        06299000
063000         NEXT SENTENCE                                            06300000
063010       ELSE                                                       06301000
063020         ADD DSDSTXL-AMOUNT  TO ACCUM-AMT-LAST-DEP                06302000
063030         MOVE DSDSTXL-AMOUNT TO AMT-LAST-DEPOSIT                  06303000
063040         MOVE DSDSTXL-DATE   TO DATE-LAST-DEPOSIT.                06304000
063050     ADD DSDSTXL-AMOUNT TO DEPOSITS-TDY.                          06305000
063060     IF DSDSTXL-CODE = 640 OR                                     06306000
063070                       575 OR                                     06307000
063080                       545 OR                                     06308000
063090                       665                                        06309000
063100         NEXT SENTENCE                                            06310000
063110       ELSE                                                       06311000
063120         MOVE 1 TO ACTIVITY-TDY.                                  06312000
063130     ADD DSDSTXL-ENCL-TYPE TO NUM-ENCLOSURES.                     06313000
063140     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW.                      06314000
063150     EVALUATE TRUE                                                06315000
063160         WHEN DSDSTXL-NOT-SC                                      06316000
063170             CONTINUE                                             06317000
063180         WHEN DSDSTXL-REG-SC                                      06318000
063190             ADD 1 TO NUM-SERV-CHG-CREDIT                         06319000
063200                      HOLD-DR-CR-ITM-FOR-AA                       06320000
063210                      HOLD-CR-ITM-FOR-AA                          06321000
063220                      HOLD-CREDITS-FOR-AA                         06322000
063230             IF DSDSTXL-CODE NOT EQUAL 549                        06323000
063240                 ADD 1 TO HOLD-REG-CR-FOR-AA                      06324000
063250             END-IF                                               06325000
063260         WHEN DSDSTXL-ACH-SC                                      06326000
063270             ADD 1 TO NUM-SERV-CHG-CREDIT                         06327000
063280                      HOLD-DR-CR-ITM-FOR-AA                       06328000
063290                      HOLD-CR-ITM-FOR-AA                          06329000
063300                      HOLD-ACH-CR-FOR-AA                          06330000
063310                      HOLD-CREDITS-FOR-AA                         06331000
063320         WHEN OTHER                                               06332000
063330             CONTINUE                                             06333000
063340     END-EVALUATE.                                                06334000
063350     EVALUATE TRUE                                                06335000
063360         WHEN AA-CODE-296                                         06336000
063370             ADD 1 TO HOLD-REG-TELE-CR-ITM-FOR-AA                 06337000
063380         WHEN OTHER                                               06338000
063390             CONTINUE                                             06339000
063400     END-EVALUATE.                                                06340000
063410                                                                  06341000
063420     EVALUATE DSDSTXL-CODE                                        06342000
063430         WHEN 544                                                 06343000
063440             ADD 1                  TO HOLD-E-DEP-FOR-AA          06344000
063450             ADD DSDSTXL-ITEM-COUNT TO HOLD-E-DEP-ITM-FOR-AA      06345000
063460         WHEN 542                                                 06346000
063470             ADD 1                  TO HOLD-MBL-RDC-FOR-AA        06347000
063480             ADD DSDSTXL-ITEM-COUNT TO HOLD-MBL-RDC-ITM-FOR-AA    06348000
063490         WHEN 549                                                 06349000
063500             ADD 1                  TO HOLD-ITM-DEP-FOR-AA        06350000
063510             ADD DSDSTXL-ITEM-COUNT TO HOLD-ITM-DEP-ITM-FOR-AA    06351000
063520         WHEN OTHER                                               06352000
063530             CONTINUE                                             06353000
063540     END-EVALUATE.                                                06354000
063550                                                                  06355000
063560     MOVE SAVE-CR-SORT-KEY TO DSDSTXL-SORT-KEY.                   06356000
063570     MOVE DEP-KEY TO SAVE-CR-SORT-KEY.                            06357000
063580     ADD DSDSTXL-ITEM-COUNT TO NUM-SERV-CHG-ITEMS                 06358000
063590                               NUM-DEPOSITED-ITEMS.               06359000
063600     MOVE DSDSTXL-ITEM-COUNT TO HOLD-TTX-ITEM-COUNT.              06360000
063610     ADD DSDSTXL-FLOAT2 TO NUM-LOCAL-ITEMS.                       06361000
063620     IF NO-LOCAL-ITEMS                                            06362000
063630         ADD DSDSTXL-ITEM-COUNT TO HOLD-ITEMS-FOR-AA              06363000
063640                                   HOLD-DR-CR-ITM-FOR-AA          06364000
063650                                   HOLD-CR-ITM-FOR-AA             06365000
063660                                   HOLD-REG-TELE-CR-ITM-FOR-AA    06366000
063670     ELSE                                                         06367000
063680         COMPUTE HOLD-ITEMS-FOR-AA =                              06368000
063690             HOLD-ITEMS-FOR-AA +                                  06369000
063700             (DSDSTXL-ITEM-COUNT - DSDSTXL-FLOAT2)                06370000
063710         COMPUTE HOLD-DR-CR-ITM-FOR-AA =                          06371000
063720             HOLD-DR-CR-ITM-FOR-AA +                              06372000
063730             (DSDSTXL-ITEM-COUNT - DSDSTXL-FLOAT2)                06373000
063740         COMPUTE HOLD-REG-TELE-CR-ITM-FOR-AA =                    06374000
063750             HOLD-REG-TELE-CR-ITM-FOR-AA +                        06375000
063760             (DSDSTXL-ITEM-COUNT - DSDSTXL-FLOAT2)                06376000
063770         COMPUTE HOLD-CR-ITM-FOR-AA =                             06377000
063780             HOLD-CR-ITM-FOR-AA +                                 06378000
063790             (DSDSTXL-ITEM-COUNT - DSDSTXL-FLOAT2)                06379000
063800         IF DSDSTXL-CODE EQUAL 549                                06380000
063810             ADD DSDSTXL-FLOAT2 TO HOLD-ITEMS-FOR-AA              06381000
063820         ELSE                                                     06382000
063830             ADD DSDSTXL-FLOAT2 TO HOLD-LOC-ITEMS-FOR-AA          06383000
063840         END-IF                                                   06384000
063850     END-IF.                                                      06385000
063860                                                                  06386000
063870     IF DSDSTXL-CHK-NO = PROC-CURR-DATE                           06387000
063880         NEXT SENTENCE                                            06388000
063890       ELSE                                                       06389000
063900         IF PRINT-DEP-RECON-RPT                                   06390000
063910             PERFORM P8890-SETUP-DEP-RECON-RPT THRU P8899-EXIT    06391000
063920           ELSE                                                   06392000
063930             IF BAI-ACCOUNT                                       06393000
063940                 NEXT SENTENCE                                    06394000
063950               ELSE                                               06395000
063960                 MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.           06396000
063970     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     06397000
063980                                                                  06398000
063990     IF HSA-ACCT OR CESA-ACCT                                     06399000
064000          PERFORM P9160-SAC-CREDIT-PROCESSING THRU P9169-EXIT.    06400000
064010                                                                  06401000
064020 P1330-NORM-CR-3.                                                 06402000
064030     IF DSDSTXL-CODE NOT = 500                                    06403000
064040         PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT         06404000
064050         PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.   06405000
064060     IF DSDSTXL-CODE = 500 OR                                     06406000
064070                       480                                        06407000
064080         GO TO P1335-NORM-CR-3-EXIT.                              06408000
064090     IF DSDSTXL-AMOUNT GREATER THAN HOLD-LRG-ITM-CHK              06409000
064100        MOVE 06 TO HOLD-REASON-CODE                               06410000
064110        PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.         06411000
064120                                                                  06412000
064130 P1335-NORM-CR-3-EXIT.                                            06413000
064140     EXIT.                                                        06414000
064150                                                                  06415000
064160 P1340-NORMAL-CREDIT-EXIT.                                        06416000
064170     GO TO P1010-TRANSACTION-EXIT.                                06417000
064180                                                                  06418000
064190******************************************************************06419000
064200*            P A I D   I N T E R E S T   C R E D I T             *06420000
064210******************************************************************06421000
064220 P1355-PAID-INT-CREDIT.                                           06422000
064230     ADD DSDSTXL-AMOUNT TO INT-PAID-YTD.                          06423000
064240     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06424000
064250     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             06425000
064260     IF NOT-IN-WITHHOLD-STATUS                                    06426000
064270         GO TO P1010-TRANSACTION-EXIT.                            06427000
064280     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT               06428000
064290         GIVING TEMP-TAX-WITHHELD.                                06429000
064300     IF TEMP-TAX-WITHHELD = ZERO                                  06430000
064310         GO TO P1010-TRANSACTION-EXIT.                            06431000
064320     MOVE ZEROS TO IRSPL-GROUP-ID.                                06432000
064330     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT.              06433000
064340     MOVE 802 TO DSDSTXL-CODE.                                    06434000
064350     MOVE OSB-DESC-0001-A TO DSDSTXL-CO-DESC.                     06435000
064360     MOVE OSB-DESC-0001-B TO DSDSTXL-DESC.                        06436000
064370     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                06437000
064380     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       06438000
064390     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             06439000
064400     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          06440000
064410                           TAX-WITHHELD-YTD.                      06441000
064420     ADD 1 TO GEN-DEBIT-CNT                                       06442000
064430              NUM-BILL-TX.                                        06443000
064440     ADD DSDSTXL-AMOUNT TO TDY-WITH-BY-IDENT (SUB13)              06444000
064450                           TDY-WITH-BY-IDENT (11).                06445000
064460     MOVE +114 TO IRSPL-REQUEST-CODE.                             06446000
064470     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              06447000
064480     GO TO P1665-NORM-DEBIT.                                      06448000
064490                                                                  06449000
064500******************************************************************06450000
064510*       T R A N S F E R   A C C R U E D   I N T E R E S T        *06451000
064520******************************************************************06452000
064530 P1360-TRANSFER-ACCRUED-660.                                      06453000
064540     IF DSDSTXL-AMOUNT GREATER THAN ACCRUED-INTEREST              06454000
064550         MOVE SPACES TO STOCK-WORK                                06455000
064560**********************************   ACCRUED INT.NSF-UNPOSTED    *06456000
064570         MOVE 13 TO HOLD-UI-REASON                                06457000
064580         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        06458000
064590         GO TO P1010-TRANSACTION-EXIT.                            06459000
064600     SUBTRACT DSDSTXL-AMOUNT FROM ACCRUED-INTEREST.               06460000
064610     IF ACCRUED-INTEREST LESS THAN +.01                           06461000
064620         MOVE ZEROS TO ACCRUED-INTEREST.                          06462000
064630     ADD DSDSTXL-AMOUNT TO INT-PAID-YTD.                          06463000
064640     ADD DSDSTXL-AMOUNT TO TDY-PAID-BY-IDENT (11).                06464000
064650     ADD DSDSTXL-AMOUNT TO TDY-PAID-BY-IDENT (SUB13).             06465000
064660     MOVE 11 TO HOLD-REASON-CODE.                                 06466000
064670     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            06467000
064680     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06468000
064690     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             06469000
064700     IF NOT-IN-WITHHOLD-STATUS                                    06470000
064710         GO TO P1010-TRANSACTION-EXIT.                            06471000
064720     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT               06472000
064730         GIVING TEMP-TAX-WITHHELD.                                06473000
064740     IF TEMP-TAX-WITHHELD = ZERO                                  06474000
064750         GO TO P1010-TRANSACTION-EXIT.                            06475000
064760     MOVE ZEROS TO IRSPL-GROUP-ID.                                06476000
064770     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT.              06477000
064780     MOVE 802 TO DSDSTXL-CODE.                                    06478000
064790     MOVE OSB-DESC-0002-A TO DSDSTXL-CO-DESC.                     06479000
064800     MOVE OSB-DESC-0002-B TO DSDSTXL-DESC.                        06480000
064810     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                06481000
064820     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       06482000
064830     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             06483000
064840     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          06484000
064850                           TAX-WITHHELD-YTD.                      06485000
064860     ADD 1 TO GEN-DEBIT-CNT                                       06486000
064870              NUM-BILL-TX.                                        06487000
064880     ADD DSDSTXL-AMOUNT TO TDY-WITH-BY-IDENT (SUB13)              06488000
064890                           TDY-WITH-BY-IDENT (11).                06489000
064900     MOVE +114 TO IRSPL-REQUEST-CODE.                             06490000
064910     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              06491000
064920     GO TO P1665-NORM-DEBIT.                                      06492000
064930                                                                  06493000
064940******************************************************************06494000
064950*    T R A N S F E R   I N V E S T M E N T   I N T E R E S T     *06495000
064960******************************************************************06496000
064970 P1365-TRANS-INV-ACCR-INT-665.                                    06497000
064980     IF DSDSTXL-AMOUNT GREATER THAN INV-ACCRUED-INT               06498000
064990         MOVE SPACES TO STOCK-WORK                                06499000
065000**********************************   INV ACCR INT NSF-UNPOSTED   *06500000
065010         MOVE 25 TO HOLD-UI-REASON                                06501000
065020         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        06502000
065030         GO TO P1010-TRANSACTION-EXIT.                            06503000
065040     SUBTRACT DSDSTXL-AMOUNT FROM INV-ACCRUED-INT.                06504000
065050     IF INV-ACCRUED-INT LESS THAN +.01000                         06505000
065060         MOVE ZEROS TO INV-ACCRUED-INT.                           06506000
065070     ADD DSDSTXL-AMOUNT TO INV-INT-PAID-YTD                       06507000
065080                           INV-INT-REPORTABLE                     06508000
065090                           TDY-PAID-BY-PLAN-INV (SUB11)           06509000
065100                           TDY-PAID-BY-PLAN-INV (11)              06510000
065110                           CURR-NET-COLL-BAL.                     06511000
065120     MOVE 'RPI' TO PJ-HOLD-CODE.                                  06512000
065130     PERFORM P1325-NORM-CR-2.                                     06513000
065140     MOVE 06 TO HOLD-REASON-CODE.                                 06514000
065150     PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                06515000
065160     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             06516000
065170     IF NOT-IN-WITHHOLD-STATUS                                    06517000
065180         GO TO P1010-TRANSACTION-EXIT.                            06518000
065190     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT               06519000
065200         GIVING TEMP-TAX-WITHHELD.                                06520000
065210     IF TEMP-TAX-WITHHELD = ZERO                                  06521000
065220         GO TO P1010-TRANSACTION-EXIT.                            06522000
065230     MOVE +02 TO IRSPL-GROUP-ID.                                  06523000
065240     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT.              06524000
065250     MOVE 807 TO DSDSTXL-CODE.                                    06525000
065260     MOVE OSB-DESC-0003-A TO DSDSTXL-CO-DESC.                     06526000
065270     MOVE OSB-DESC-0003-B TO DSDSTXL-DESC.                        06527000
065280     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                06528000
065290     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       06529000
065300     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             06530000
065310     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          06531000
065320                           INV-TAX-WITHHELD-YTD                   06532000
065330                           TDY-WITH-BY-PLAN-INV (SUB11)           06533000
065340                           TDY-WITH-BY-PLAN-INV (11).             06534000
065350     ADD 1 TO GEN-DEBIT-CNT                                       06535000
065360              NUM-BILL-TX.                                        06536000
065370     MOVE +02 TO IRSPL-GROUP-ID.                                  06537000
065380     MOVE +114 TO IRSPL-REQUEST-CODE.                             06538000
065390     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              06539000
065400     GO TO P1010-TRANSACTION-EXIT.                                06540000
065410                                                                  06541000
065420 P1370-ODB-CREDIT.                                                06542000
065430     MOVE SPACES TO STOCK-WORK.                                   06543000
065440     MOVE 10 TO HOLD-UI-REASON.                                   06544000
065450**********************************   INVALID TX CODE-UNPOSTED    *06545000
065460     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           06546000
065470     GO TO P1010-TRANSACTION-EXIT.                                06547000
065480                                                                  06548000
065490******************************************************************06549000
065500*             R E T U R N   C H E C K   C R E D I T              *06550000
065510******************************************************************06551000
065520 P1375-RET-CHK-CREDIT.                                            06552000
065530     MOVE 1 TO 470-480-SW.                                        06553000
065540     IF POST-OD                                                   06554000
065550         ADD 1 TO NUM-NSF-CHECKS-MO                               06555000
065560         MOVE 1 TO RET-CHK-CR-SW                                  06556000
065570         SUBTRACT 1 FROM NUM-APPR-OD-MO.                          06557000
065580     IF DSDSTXL-CODE = 470                                        06558000
065590         GO TO P1380-CHK-EXT-470.                                 06559000
065600     IF WORK-RET-CHECK-CHRG = ZERO                                06560000
065610         PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT    06561000
065620         PERFORM P1382-SET-ADD-TO-DAYS-OD-SW THRU P1383-EXIT      06562000
065630         IF POST-OD                                               06563000
065640             PERFORM P1305-CK-BAL                                 06564000
065650             GO TO P1010-TRANSACTION-EXIT                         06565000
065660           ELSE                                                   06566000
065670             GO TO P1010-TRANSACTION-EXIT.                        06567000
065680     PERFORM P1320-NORMAL-CREDIT THRU P1325-NORM-CR-2.            06568000
065690     PERFORM P1382-SET-ADD-TO-DAYS-OD-SW THRU P1383-EXIT.         06569000
065700     MOVE 793 TO DSDSTXL-CODE.                                    06570000
065710     MOVE OSB-DESC-0004-A TO DSDSTXL-CO-DESC.                     06571000
065720     MOVE OSB-DESC-0004-B TO DSDSTXL-DESC.                        06572000
065730     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                06573000
065740     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       06574000
065750     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             06575000
065760     MOVE WORK-RET-CHECK-CHRG TO DSDSTXL-AMOUNT.                  06576000
065770     IF PERSONAL                                                  06577000
065780         ADD DSDSTXL-AMOUNT TO RETURN-CHECK-FEE-RETAIL            06578000
065790       ELSE                                                       06579000
065800         ADD DSDSTXL-AMOUNT TO RETURN-CHECK-FEE-COMMERCIAL.       06580000
065810     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT.                         06581000
065820     ADD 1 TO GEN-DEBIT-CNT.                                      06582000
065830     ADD 1 TO NUM-BILL-TX.                                        06583000
065840     GO TO P1665-NORM-DEBIT.                                      06584000
065850                                                                  06585000
065860 P1380-CHK-EXT-470.                                               06586000
065870     PERFORM P1320-NORMAL-CREDIT THRU P1325-NORM-CR-2.            06587000
065880     PERFORM P1382-SET-ADD-TO-DAYS-OD-SW THRU P1383-EXIT.         06588000
065890     IF POST-OD                                                   06589000
065900         PERFORM P1305-CK-BAL.                                    06590000
065910     GO TO P1010-TRANSACTION-EXIT.                                06591000
065920                                                                  06592000
065930 P1382-SET-ADD-TO-DAYS-OD-SW.                                     06593000
065940     IF BEG-BAL-MINUS                                             06594000
065950         IF CURRENT-BALANCE NEGATIVE                              06595000
065960             MOVE 1 TO ADD-TO-DAYS-OD-SW                          06596000
065970           ELSE                                                   06597000
065980             MOVE 0 TO ADD-TO-DAYS-OD-SW.                         06598000
065990                                                                  06599000
066000 P1383-EXIT.                                                      06600000
066010     EXIT.                                                        06601000
066020                                                                  06602000
066030******************************************************************06603000
066040*                W I R E   T R A N S F E R   I N                 *06604000
066050******************************************************************06605000
066060 P1385-CHK-EXT-630.                                               06606000
066070     ADD DSDSTXL-AMOUNT TO AMT-WIRES-IN.                          06607000
066080     ADD 1 TO NUM-WIRES-IN.                                       06608000
066090     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06609000
066100     IF DSDSTXL-CODE = 631                                        06610000
066110         GO TO P1010-TRANSACTION-EXIT.                            06611000
066120     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06612000
066130     IF SUB7 = ZERO                                               06613000
066140         GO TO P1010-TRANSACTION-EXIT.                            06614000
066150     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    06615000
066160     MOVE 116 TO DSDSTXL-CODE.                                    06616000
066170     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                06617000
066180     GO TO P1250-EXT-SERV-CHRG-TXS.                               06618000
066190                                                                  06619000
066200******************************************************************06620000
066210*  I N T E R N A T I O N A L  W I R E   T R A N S F E R   I N *   06621000
066220******************************************************************06622000
066230 P1387-CHK-EXT-628.                                               06623000
066240     ADD DSDSTXL-AMOUNT TO AMT-INTL-WIRES-IN.                     06624000
066250     ADD 1 TO NUM-INTL-WIRES-IN.                                  06625000
066260     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06626000
066270     IF DSDSTXL-CODE = 629                                        06627000
066280         GO TO P1010-TRANSACTION-EXIT.                            06628000
066290     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06629000
066300     IF SUB7 = ZERO                                               06630000
066310         GO TO P1010-TRANSACTION-EXIT.                            06631000
066320     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    06632000
066330     MOVE 187 TO DSDSTXL-CODE.                                    06633000
066340     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                06634000
066350     GO TO P1250-EXT-SERV-CHRG-TXS.                               06635000
066360                                                                  06636000
066370******************************************************************06637000
066380*          S A F E K E E P I N G   C R E D I T   T X S           *06638000
066390******************************************************************06639000
066400 P1390-CHK-EXT-556-559.                                           06640000
066410     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06641000
066420     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06642000
066430     IF SUB7 = ZERO                                               06643000
066440         GO TO P1010-TRANSACTION-EXIT.                            06644000
066450     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    06645000
066460     MOVE 127 TO DSDSTXL-CODE.                                    06646000
066470     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                06647000
066480     GO TO P1250-EXT-SERV-CHRG-TXS.                               06648000
066490                                                                  06649000
066500 P1392-CHK-EXT-557.                                               06650000
066510     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06651000
066520     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06652000
066530     IF SUB7 = ZERO                                               06653000
066540         GO TO P1010-TRANSACTION-EXIT.                            06654000
066550     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    06655000
066560     MOVE 104 TO DSDSTXL-CODE.                                    06656000
066570     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                06657000
066580     GO TO P1250-EXT-SERV-CHRG-TXS.                               06658000
066590                                                                  06659000
066600******************************************************************06660000
066610*             S E C U R I T I E S   M A T U R I T Y              *06661000
066620******************************************************************06662000
066630 P1395-CHK-EXT-653.                                               06663000
066640     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06664000
066650     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06665000
066660     IF SUB7 = ZERO                                               06666000
066670         GO TO P1010-TRANSACTION-EXIT.                            06667000
066680     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    06668000
066690     MOVE 106 TO DSDSTXL-CODE.                                    06669000
066700     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                06670000
066710     GO TO P1250-EXT-SERV-CHRG-TXS.                               06671000
066720                                                                  06672000
066730******************************************************************06673000
066740*  M O B I L E   R D C   D E P O S I T                           *06674000
066750******************************************************************06675000
066760 P1397-CHK-EXT-542.                                               06676000
066770     ADD DSDSTXL-AMOUNT TO AMT-MOBILE-RDC-FEE.                    06677000
066780     ADD 1              TO NUM-MOBILE-RDC-FEE.                    06678000
066790     PERFORM P1320-NORMAL-CREDIT THRU P1335-NORM-CR-3-EXIT.       06679000
066800     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                06680000
066810     IF BCFSCR-FREE-CHECKING                                      06681000
066820         IF BCFSCR-DEBIT-CHG-RDC GREATER THAN ZEROS               06682000
066830             CONTINUE                                             06683000
066840         ELSE                                                     06684000
066850             GO TO P1010-TRANSACTION-EXIT                         06685000
066860         END-IF                                                   06686000
066870     ELSE                                                         06687000
066880         GO TO P1010-TRANSACTION-EXIT                             06688000
066890     END-IF.                                                      06689000
066900     MOVE BCFSCR-DEBIT-CHG-RDC TO DSDSTXL-AMOUNT.                 06690000
066910     MOVE 193                  TO DSDSTXL-CODE.                   06691000
066920     MOVE 1                    TO DSDSTXL-ITEM-COUNT.             06692000
066930     GO TO P1250-EXT-SERV-CHRG-TXS.                               06693000
066940                                                                  06694000
066950******************************************************************06695000
066960* SUBROUTINE - B A C K D A T E D  C R E D I T                    *06696000
066970******************************************************************06697000
066980 P1400-BACK-DATED-CREDIT.                                         06698000
066990     MOVE ZEROS TO HOLD-THIS-ACCRUAL                              06699000
067000                   DAYS-11.                                       06700000
067010     CALL 'CDCDT11' USING DSDSTXL-EFFECT-DT                       06701000
067020                          PROC-CURR-DATE                          06702000
067030                          DAYS-11.                                06703000
067040     IF DAYS-11 GREATER THAN 365                                  06704000
067050         MOVE DSDSTXL-DATE TO DSDSTXL-EFFECT-DT                   06705000
067060         GO TO P1429-EXIT.                                        06706000
067070                                                                  06707000
067080 P1405-BUILD-ACCT-ANAL-ADJ-TX.                                    06708000
067090     IF PROC-DSS                                                  06709000
067100         GO TO P1410-CALC-BACK-DATED-GRS-CYC.                     06710000
067110     IF NON-ACCT-ANAL-BANK                                        06711000
067120         GO TO P1410-CALC-BACK-DATED-GRS-CYC.                     06712000
067130     IF ACCT-ANAL-ACCT-IND = 'Y'                                  06713000
067140         NEXT SENTENCE                                            06714000
067150       ELSE                                                       06715000
067160         GO TO P1410-CALC-BACK-DATED-GRS-CYC.                     06716000
067170                                                                  06717000
067180     IF CDC-DB2-DATE >= AA-IMPL-DATE                              06718000
067190         IF DSDSTXL-CODE = 799                                    06719000
067200             GO TO P1410-CALC-BACK-DATED-GRS-CYC                  06720000
067210         END-IF                                                   06721000
067220     END-IF.                                                      06722000
067230                                                                  06723000
067240     MOVE SPACES              TO AA-FILEREC.                      06724000
067250     MOVE 01                  TO AA-INSYSTEM.                     06725000
067260     MOVE PROC-BK-NO          TO AA-BKNBR.                        06726000
067270     MOVE 01                  TO AA-APPL.                         06727000
067280     MOVE DSDSTXL-ACCT-NO     TO AA-ACCOUNT.                      06728000
067290     MOVE 07                  TO AA-RECCODE.                      06729000
067300     INITIALIZE                  AA-BALADJUST.                    06730000
067310     MOVE 'Y'                 TO AA-ADJFILE.                      06731000
067320     MOVE DSDSTXL-EFFECT-DT   TO AA-EFFDT.                        06732000
067330     MOVE ZEROS               TO AA-PDAYSADJ.                     06733000
067340     SUBTRACT PROC-PRE-DAYS FROM DAYS-11                          06734000
067350                          GIVING AA-LDAYS.                        06735000
067360     MOVE DSDSTXL-AMOUNT      TO AA-LBAL.                         06736000
067370     MOVE 00001               TO AA-LDESCRNBR.                    06737000
067380     MOVE 'N'                 TO AA-LSTMTPRT.                     06738000
067390     MOVE AA-LDAYS            TO AA-CDAYS.                        06739000
067400     MOVE DSDSTXL-AMOUNT      TO AA-CBAL.                         06740000
067410     MOVE 00002               TO AA-CDESCNBR.                     06741000
067420     MOVE 'N'                 TO AA-CSTMTPRT.                     06742000
067430     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      06743000
067440     IF PROC-PRE-DAYS = ZERO                                      06744000
067450         GO TO P1410-CALC-BACK-DATED-GRS-CYC.                     06745000
067460     MOVE AA-LDAYS            TO DAYS-15.                         06746000
067470     CALL 'CDCDT15'        USING DSDSTXL-EFFECT-DT                06747000
067480                                 DAYS-15                          06748000
067490                                 END-DATE-15.                     06749000
067500     MOVE END-DATE-15         TO AA-EFFDT.                        06750000
067510     MOVE PROC-PRE-DAYS       TO AA-LDAYS                         06751000
067520                                 AA-CDAYS.                        06752000
067530     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      06753000
067540                                                                  06754000
067550 P1410-CALC-BACK-DATED-GRS-CYC.                                   06755000
067560     IF DAYS-11 GREATER THAN DAYS-IN-CYCLE                        06756000
067570         COMPUTE TEMP-GROSS-BAL =                                 06757000
067580             DSDSTXL-AMOUNT * DAYS-IN-CYCLE                       06758000
067590       ELSE                                                       06759000
067600         COMPUTE TEMP-GROSS-BAL =                                 06760000
067610             DSDSTXL-AMOUNT * DAYS-11.                            06761000
067620     ADD TEMP-GROSS-BAL TO GROSS-CURR-BAL-CYCL                    06762000
067630                           GROSS-COLL-BAL-CYCL.                   06763000
067640     IF DDA-ACCOUNT                                               06764000
067650         NEXT SENTENCE                                            06765000
067660       ELSE                                                       06766000
067670         ADD TEMP-GROSS-BAL TO TIS-GRS-CUR-BAL-CYC                06767000
067680                               TIS-GRS-COL-BAL-CYC.               06768000
067690                                                                  06769000
067700 P1415-CALC-BACK-DATED-GRS-MTH.                                   06770000
067710     IF DAYS-11 GREATER THAN DAYS-IN-CAL-MONTH                    06771000
067720         COMPUTE TEMP-GROSS-BAL =                                 06772000
067730             DSDSTXL-AMOUNT * DAYS-IN-CAL-MONTH                   06773000
067740       ELSE                                                       06774000
067750         COMPUTE TEMP-GROSS-BAL =                                 06775000
067760             DSDSTXL-AMOUNT * DAYS-11.                            06776000
067770     ADD TEMP-GROSS-BAL TO GROSS-CURR-BAL-MNTH                    06777000
067780                           GROSS-COLL-BAL-MNTH.                   06778000
067790                                                                  06779000
067800 P1420-CALC-BACK-DATED-INT.                                       06780000
067810     IF DDA-ACCOUNT                                               06781000
067820         GO TO P1425-REPORT-BACK-DATED-TX.                        06782000
067830     MOVE 1 TO BACK-DATED-SW.                                     06783000
067840     PERFORM P0570-ACCR-INT THRU P0579-EXIT.                      06784000
067850     COMPUTE HOLD-THIS-ACCRUAL =                                  06785000
067860         HOLD-DAILY-ACCR * DAYS-11.                               06786000
067870     ADD HOLD-THIS-ACCRUAL TO ACCRUED-INTEREST                    06787000
067880                              TDY-EXP-BY-IDENT (SUB13)            06788000
067890                              TDY-EXP-BY-IDENT (11).              06789000
067900     COMPUTE HOLD-THIS-ACCRUAL = HOLD-MIN-ACCR * DAYS-11.         06790000
067910     ADD HOLD-THIS-ACCRUAL TO MIN-ACCR-INTEREST.                  06791000
067920     MOVE 0 TO BACK-DATED-SW.                                     06792000
067930                                                                  06793000
067940 P1425-REPORT-BACK-DATED-TX.                                      06794000
067950     MOVE 01 TO HOLD-REASON-CODE.                                 06795000
067960     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            06796000
067970                                                                  06797000
067980 P1429-EXIT.                                                      06798000
067990     EXIT.                                                        06799000
068000                                                                  06800000
068010******************************************************************06801000
068020*     C L O S E O U T   C R E D I T   T R A N S A C T I O N      *06802000
068030******************************************************************06803000
068040 P1430-CLOSEOUT-CREDIT.                                           06804000
068050     MULTIPLY DSDSTXL-AMOUNT BY -1 GIVING TEMP-TX-AMT.            06805000
068060     IF DSDSTXL-CODE = 516                                        06806000
068070        CONTINUE                                                  06807000
068080     ELSE                                                         06808000
068090        IF CURRENT-BALANCE = TEMP-TX-AMT                          06809000
068100           CONTINUE                                               06810000
068110        ELSE                                                      06811000
068120         GO TO P1460-CLOSEOUT-NOT-EQUAL                           06812000
068130        END-IF                                                    06813000
068140     END-IF.                                                      06814000
068150     IF PROC-DSS                                                  06815000
068160         GO TO P1445-CLOSEOUT-SAV.                                06816000
068170     IF ODB-PLAN = SPACES                                         06817000
068180         GO TO P1435-CHK-FOR-INV.                                 06818000
068190     IF ODB-LOAN-BAL = ZERO  AND                                  06819000
068200         MONTHLY-ACCUM-INT = ZERO AND                             06820000
068210         ODB-ACCUM-CR-LIFE = ZERO                                 06821000
068220         GO TO P1435-CHK-FOR-INV.                                 06822000
068230     MOVE SPACES TO STOCK-WORK.                                   06823000
068240     MOVE 28 TO HOLD-UI-REASON.                                   06824000
068250     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           06825000
068260     GO TO P1010-TRANSACTION-EXIT.                                06826000
068270                                                                  06827000
068280 P1435-CHK-FOR-INV.                                               06828000
068290     IF INV-PLAN = SPACES                                         06829000
068300         GO TO P1440-CHK-ACCT-TYPE.                               06830000
068310     IF INV-BALANCE = ZERO  AND                                   06831000
068320         INV-ACCRUED-INT = ZERO                                   06832000
068330         GO TO P1440-CHK-ACCT-TYPE.                               06833000
068340     IF DSDSTXL-CODE = 516                                        06834000
068350        PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT           06835000
068360        IF NOT-IN-WITHHOLD-STATUS                                 06836000
068370           GO TO P1436-CLOSEOUT-RP-516                            06837000
068380     END-IF.                                                      06838000
068390                                                                  06839000
068400     MOVE SPACES TO STOCK-WORK.                                   06840000
068410     MOVE 22 TO HOLD-UI-REASON.                                   06841000
068420     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           06842000
068430     GO TO P1010-TRANSACTION-EXIT.                                06843000
068440                                                                  06844000
068450 P1436-CLOSEOUT-RP-516.                                           06845000
068460                                                                  06846000
068470     IF CURRENT-BALANCE > TEMP-TX-AMT                             06847000
068480         GO TO P1470-CLOSEOUT-TOO-BIG                             06848000
068490     END-IF.                                                      06849000
068500                                                                  06850000
068510     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      06851000
068520     MOVE HOLD-EARNINGS    TO ACCRUED-INTEREST.                   06852000
068530     MOVE INV-ACCRUED-INT  TO HOLD-EARNINGS.                      06853000
068540     MOVE HOLD-EARNINGS    TO INV-ACCRUED-INT.                    06854000
068550     IF ACCRUED-INTEREST NEGATIVE                                 06855000
068560        COMPUTE TEMP-CLOSEOUT-BAL ROUNDED =                       06856000
068570                CURRENT-BALANCE +                                 06857000
068580                INV-ACCRUED-INT                                   06858000
068590        END-COMPUTE                                               06859000
068600     ELSE                                                         06860000
068610        COMPUTE TEMP-CLOSEOUT-BAL ROUNDED =                       06861000
068620                CURRENT-BALANCE +                                 06862000
068630                INV-ACCRUED-INT +                                 06863000
068640                ACCRUED-INTEREST                                  06864000
068650        END-COMPUTE                                               06865000
068660     END-IF.                                                      06866000
068670                                                                  06867000
068680     IF TEMP-CLOSEOUT-BAL < TEMP-TX-AMT                           06868000
068690         GO TO P1465-CLOSEOUT-TOO-SMALL                           06869000
068700     END-IF.                                                      06870000
068710                                                                  06871000
068720     IF ACCRUED-INTEREST NEGATIVE                                 06872000
068730         MOVE ACCRUED-INTEREST TO TEMP-CLOSEOUT-INT-DROP          06873000
068740         MOVE ZEROS TO ACCRUED-INTEREST                           06874000
068750         MOVE TEMP-CLOSEOUT-INT-DROP TO HOLD-EARNINGS             06875000
068760         MOVE '9' TO HOLD-EARN-DISP                               06876000
068770         PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT       06877000
068780         ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (11)     06878000
068790         ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (SUB13)  06879000
068800     END-IF.                                                      06880000
068810                                                                  06881000
068820     COMPUTE TEMP-CLOSEOUT-EXCESS ROUNDED =                       06882000
068830             DSDSTXL-AMOUNT +                                     06883000
068840             TEMP-CLOSEOUT-BAL                                    06884000
068850     END-COMPUTE.                                                 06885000
068860                                                                  06886000
068870     IF TEMP-CLOSEOUT-EXCESS = ZERO                               06887000
068880         GO TO P1437-END-CLOSEOUT-RP-516                          06888000
068890     END-IF.                                                      06889000
068900                                                                  06890000
068910     COMPUTE TEMP-TX-AMT ROUNDED =                                06891000
068920             DSDSTXL-AMOUNT +                                     06892000
068930             CURRENT-BALANCE                                      06893000
068940     END-COMPUTE.                                                 06894000
068950                                                                  06895000
068960     IF TEMP-TX-AMT NOT LESS THAN INV-ACCRUED-INT                 06896000
068970         COMPUTE ACCRUED-INTEREST ROUNDED =                       06897000
068980                 TEMP-TX-AMT -                                    06898000
068990                 INV-ACCRUED-INT                                  06899000
069000         END-COMPUTE                                              06900000
069010         MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP      06901000
069020         MOVE TEMP-CLOSEOUT-INT-DROP TO HOLD-EARNINGS             06902000
069030         MOVE '9' TO HOLD-EARN-DISP                               06903000
069040         PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT       06904000
069050         ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (11)     06905000
069060         ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (SUB13)  06906000
069070         GO TO P1437-END-CLOSEOUT-RP-516                          06907000
069080     END-IF.                                                      06908000
069090                                                                  06909000
069100     COMPUTE TEMP-CLOSEOUT-INV-INT-DROP ROUNDED =                 06910000
069110             INV-ACCRUED-INT -                                    06911000
069120             TEMP-TX-AMT                                          06912000
069130     END-COMPUTE.                                                 06913000
069140     ADD TEMP-CLOSEOUT-INV-INT-DROP                               06914000
069150             TO TDY-DROP-BY-PLAN-INV (SUB11)                      06915000
069160                TDY-DROP-BY-PLAN-INV (11).                        06916000
069170     MOVE TEMP-TX-AMT TO INV-ACCRUED-INT.                         06917000
069180     MOVE ZEROS TO ACCRUED-INTEREST.                              06918000
069190     MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP.         06919000
069200     MOVE TEMP-CLOSEOUT-INT-DROP TO HOLD-EARNINGS.                06920000
069210     MOVE '9' TO HOLD-EARN-DISP.                                  06921000
069220     PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT.          06922000
069230     ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (11).        06923000
069240     ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (SUB13).     06924000
069250                                                                  06925000
069260 P1437-END-CLOSEOUT-RP-516.                                       06926000
069270                                                                  06927000
069280     IF INV-ACCRUED-INT NOT = ZERO                                06928000
069290         PERFORM P4110-POST-INV-INT-2 THRU P4199-EXIT             06929000
069300     END-IF.                                                      06930000
069310                                                                  06931000
069320     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                       06932000
069330                              HOLD-ACTUAL-ACCR-INT.               06933000
069340                                                                  06934000
069350     IF ACCRUED-INTEREST NOT = ZERO                               06935000
069360         IF ACCRUED-INTEREST POSITIVE                             06936000
069370             MOVE '1' TO HOLD-EARN-DISP                           06937000
069380             PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT   06938000
069390             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           06939000
069400             PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT        06940000
069410             MOVE ZEROS TO ACCRUED-INTEREST                       06941000
069420         ELSE                                                     06942000
069430             MOVE '9' TO HOLD-EARN-DISP                           06943000
069440             PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT   06944000
069450             PERFORM P5502-NO-CREDIT                              06945000
069460         END-IF                                                   06946000
069470     END-IF.                                                      06947000
069480                                                                  06948000
069490     PERFORM P1325-NORM-CR-2.                                     06949000
069500     PERFORM P1475-CLOSEOUT-ACCT THRU P1479-EXIT.                 06950000
069510     GO TO P1010-TRANSACTION-EXIT.                                06951000
069520                                                                  06952000
069530 P1440-CHK-ACCT-TYPE.                                             06953000
069540     IF NOW-ACCOUNT OR IMM-ACCOUNT OR CMM-ACCOUNT                 06954000
069550        IF DSDSTXL-CODE = 516                                     06955000
069560           GO TO P1446-CLOSEOUT-INT-ACCTS-516                     06956000
069570        ELSE                                                      06957000
069580           GO TO P1455-CLOSEOUT-NOW-IMM                           06958000
069590        END-IF                                                    06959000
069600     END-IF.                                                      06960000
069610                                                                  06961000
069620     GO TO P1450-CLOSEOUT-DDA.                                    06962000
069630                                                                  06963000
069640 P1445-CLOSEOUT-SAV.                                              06964000
069650                                                                  06965000
069660     IF DSDSTXL-CODE = 516                                        06966000
069670        GO TO P1446-CLOSEOUT-INT-ACCTS-516                        06967000
069680     END-IF.                                                      06968000
069690                                                                  06969000
069700     IF ACCRUED-INTEREST = ZERO                                   06970000
069710         NEXT SENTENCE                                            06971000
069720       ELSE                                                       06972000
069730         MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                   06973000
069740         PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT       06974000
069750         PERFORM P5502-NO-CREDIT.                                 06975000
069760     PERFORM P1325-NORM-CR-2.                                     06976000
069770     PERFORM P1475-CLOSEOUT-ACCT THRU P1479-EXIT.                 06977000
069780     GO TO P1010-TRANSACTION-EXIT.                                06978000
069790                                                                  06979000
069800 P1446-CLOSEOUT-INT-ACCTS-516.                                    06980000
069810                                                                  06981000
069820     IF CURRENT-BALANCE > TEMP-TX-AMT                             06982000
069830         GO TO P1470-CLOSEOUT-TOO-BIG                             06983000
069840     END-IF.                                                      06984000
069850                                                                  06985000
069860     IF ACCRUED-INTEREST NEGATIVE                                 06986000
069870        MOVE CURRENT-BALANCE TO TEMP-CLOSEOUT-BAL                 06987000
069880     ELSE                                                         06988000
069890        COMPUTE TEMP-CLOSEOUT-BAL ROUNDED =                       06989000
069900                CURRENT-BALANCE +                                 06990000
069910                ACCRUED-INTEREST                                  06991000
069920        END-COMPUTE                                               06992000
069930     END-IF.                                                      06993000
069940                                                                  06994000
069950     IF TEMP-CLOSEOUT-BAL < TEMP-TX-AMT                           06995000
069960         GO TO P1465-CLOSEOUT-TOO-SMALL                           06996000
069970     END-IF.                                                      06997000
069980                                                                  06998000
069990     COMPUTE TEMP-CLOSEOUT-EXCESS ROUNDED =                       06999000
070000             DSDSTXL-AMOUNT +                                     07000000
070010             TEMP-CLOSEOUT-BAL                                    07001000
070020     END-COMPUTE.                                                 07002000
070030                                                                  07003000
070040     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             07004000
070050     IF IN-WITHHOLD-STATUS                                        07005000
070060        COMPUTE TEMP-CLOSEOUT-TX-INT ROUNDED =                    07006000
070070                CURRENT-BALANCE +                                 07007000
070080                DSDSTXL-AMOUNT                                    07008000
070090        END-COMPUTE                                               07009000
070100        MULTIPLY WITHHOLDING-PERCENT BY TEMP-CLOSEOUT-TX-INT      07010000
070110             GIVING TEMP-CLOSEOUT-TAX                             07011000
070120        IF TEMP-CLOSEOUT-TAX > TEMP-CLOSEOUT-EXCESS               07012000
070130            MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-TAX        07013000
070140            MOVE ZEROS TO TEMP-CLOSEOUT-EXCESS                    07014000
070150        ELSE                                                      07015000
070160            SUBTRACT TEMP-CLOSEOUT-TAX FROM TEMP-CLOSEOUT-EXCESS  07016000
070170        END-IF                                                    07017000
070180     END-IF.                                                      07018000
070190                                                                  07019000
070200     IF TEMP-CLOSEOUT-EXCESS > ZERO                               07020000
070210        SUBTRACT TEMP-CLOSEOUT-EXCESS FROM ACCRUED-INTEREST       07021000
070220                                           HOLD-ACTUAL-ACCR-INT   07022000
070230        MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP       07023000
070240        MOVE TEMP-CLOSEOUT-INT-DROP TO HOLD-EARNINGS              07024000
070250        MOVE '9' TO HOLD-EARN-DISP                                07025000
070260        PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT        07026000
070270        ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (11)      07027000
070280        ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (SUB13)   07028000
070290     END-IF.                                                      07029000
070300                                                                  07030000
070310     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      07031000
070320     MOVE TEMP-CLOSEOUT-TAX TO HOLD-TAX-WITHHELD.                 07032000
070330                                                                  07033000
070340     IF ACCRUED-INTEREST NOT = ZERO                               07034000
070350         IF ACCRUED-INTEREST POSITIVE                             07035000
070360             MOVE '1'   TO HOLD-EARN-DISP                         07036000
070370             PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT   07037000
070380             MOVE 'C'   TO CLOSEOUT-SW                            07038000
070390             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           07039000
070400             MOVE ' '   TO CLOSEOUT-SW                            07040000
070410             PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT        07041000
070420             MOVE ZEROS TO ACCRUED-INTEREST                       07042000
070430         ELSE                                                     07043000
070440             MOVE '9'   TO HOLD-EARN-DISP                         07044000
070450             PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT   07045000
070460             PERFORM P5502-NO-CREDIT                              07046000
070470         END-IF                                                   07047000
070480     END-IF.                                                      07048000
070490                                                                  07049000
070500     PERFORM P1325-NORM-CR-2.                                     07050000
070510     PERFORM P1475-CLOSEOUT-ACCT THRU P1479-EXIT.                 07051000
070520     GO TO P1010-TRANSACTION-EXIT.                                07052000
070530                                                                  07053000
070540 P1450-CLOSEOUT-DDA.                                              07054000
070550                                                                  07055000
070560     IF DSDSTXL-CODE = 516                                        07056000
070570        IF CURRENT-BALANCE > TEMP-TX-AMT                          07057000
070580            GO TO P1470-CLOSEOUT-TOO-BIG                          07058000
070590        ELSE                                                      07059000
070600            IF CURRENT-BALANCE < TEMP-TX-AMT                      07060000
070610                GO TO P1465-CLOSEOUT-TOO-SMALL                    07061000
070620            END-IF                                                07062000
070630        END-IF                                                    07063000
070640     END-IF.                                                      07064000
070650                                                                  07065000
070660     PERFORM P1325-NORM-CR-2.                                     07066000
070670     PERFORM P1475-CLOSEOUT-ACCT THRU P1479-EXIT.                 07067000
070680     GO TO P1010-TRANSACTION-EXIT.                                07068000
070690                                                                  07069000
070700 P1455-CLOSEOUT-NOW-IMM.                                          07070000
070710     IF ACCRUED-INTEREST = ZERO                                   07071000
070720         NEXT SENTENCE                                            07072000
070730       ELSE                                                       07073000
070740         MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                   07074000
070750         PERFORM P1480-REPORT-CLOSEOUT-EARN THRU P1484-EXIT       07075000
070760         PERFORM P5502-NO-CREDIT.                                 07076000
070770     PERFORM P1325-NORM-CR-2.                                     07077000
070780     PERFORM P1475-CLOSEOUT-ACCT THRU P1479-EXIT.                 07078000
070790     GO TO P1010-TRANSACTION-EXIT.                                07079000
070800                                                                  07080000
070810 P1460-CLOSEOUT-NOT-EQUAL.                                        07081000
070820     IF CURRENT-BALANCE LESS THAN TEMP-TX-AMT                     07082000
070830         GO TO P1470-CLOSEOUT-TOO-BIG.                            07083000
070840                                                                  07084000
070850 P1465-CLOSEOUT-TOO-SMALL.                                        07085000
070860     MOVE SPACES TO STOCK-WORK.                                   07086000
070870     MOVE 29 TO HOLD-UI-REASON.                                   07087000
070880     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07088000
070890     GO TO P1010-TRANSACTION-EXIT.                                07089000
070900                                                                  07090000
070910 P1470-CLOSEOUT-TOO-BIG.                                          07091000
070920     MOVE SPACES TO STOCK-WORK.                                   07092000
070930     MOVE 30 TO HOLD-UI-REASON.                                   07093000
070940     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07094000
070950     GO TO P1010-TRANSACTION-EXIT.                                07095000
070960                                                                  07096000
070970 P1475-CLOSEOUT-ACCT.                                             07097000
070980     IF CYCLE-THIS-STMT NOT = 1                                   07098000
070990         IF PROC-DSD                                              07099000
071000             MOVE 'C' TO SPEC-REPORT-ID                           07100000
071010           ELSE                                                   07101000
071020             IF SAV-ACCOUNT                                       07102000
071030                 MOVE 'S' TO SPEC-REPORT-ID.                      07103000
071040                                                                  07104000
071050     MOVE STAT-2X TO HOLD-OLD-STAT-2X.                            07105000
071060     MOVE 091 TO STATUS-CODE.                                     07106000
071070     MOVE '09'    TO HOLD-NEW-STAT-2X.                            07107000
071080     MOVE 'Y' TO HOLD-EXTRACT-IND.                                07108000
071090     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            07109000
071100                                                                  07110000
071110     ADD 1 TO NUM-CLOSED-TODAY.                                   07111000
071120     MOVE PROC-CURR-DATE TO DATE-CLOSED                           07112000
071130                            DSDS-LAST-MAINT-DATE.                 07113000
071140     IF ODB-PLAN = SPACES                                         07114000
071150         NEXT SENTENCE                                            07115000
071160       ELSE                                                       07116000
071170         IF ODB-STATUS-CODE = '04'                                07117000
071180             NEXT SENTENCE                                        07118000
071190           ELSE                                                   07119000
071200             MOVE '4' TO HISTORY-CARD-IND                         07120000
071210             MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT            07121000
071220             MOVE '04' TO ODB-STATUS-CODE                         07122000
071230                          HOLD-NEW-ODB-STAT                       07123000
071240             MOVE PROC-CURR-DATE TO DATE-CANCELLED                07124000
071250             MOVE 'Y' TO HOLD-EXTRACT-IND                         07125000
071260             PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT 07126000
071270             PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.        07127000
071280     IF INV-PLAN = SPACES                                         07128000
071290         NEXT SENTENCE                                            07129000
071300       ELSE                                                       07130000
071310         MOVE INV-STATUS-CODE TO HOLD-OLD-INV-STAT                07131000
071320         MOVE '08' TO INV-STATUS-CODE                             07132000
071330                      HOLD-NEW-INV-STAT                           07133000
071340         MOVE 'Y' TO HOLD-EXTRACT-IND                             07134000
071350         PERFORM P8482-INV-STATUS-CODE-CHANGE THRU P8482-EXIT     07135000
071360         MOVE PROC-CURR-DATE TO INV-MATURE-DATE.                  07136000
071370     MOVE OD-ACCESS-LIMIT TO HOLD-OLD-ACCESS-LIMIT                07137000
071380     MOVE ZEROS TO OD-ACCESS-LIMIT                                07138000
071390                   HOLD-NEW-ACCESS-LIMIT                          07139000
071400     IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED           07140000
071410                  OR OA-SUSPENDED                                 07141000
071420         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              07142000
071430         MOVE 90 TO OD-ACCESS-CODE                                07143000
071440                    HOLD-NEW-ACCESS-CODE                          07144000
071450       ELSE                                                       07145000
071460         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              07146000
071470         MOVE 00 TO OD-ACCESS-CODE                                07147000
071480                    HOLD-NEW-ACCESS-CODE                          07148000
071490     END-IF.                                                      07149000
071500     MOVE 'Y' TO HOLD-EXTRACT-IND.                                07150000
071510     PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT.           07151000
071520     PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.           07152000
071530                                                                  07153000
071540     IF BR-CLSN-TIED GREATER THAN ZEROS                           07154000
071550         MOVE BR-CLSN-TIED TO HOLD-OLD-BR-CLSN-TIED               07155000
071560         MOVE ZEROS        TO HOLD-NEW-BR-CLSN-TIED               07156000
071570                              BR-CLSN-TIED                        07157000
071580         PERFORM P8496-BR-CLSN-TIED-CHANGE THRU P8496-EXIT        07158000
071590     END-IF.                                                      07159000
071600                                                                  07160000
071610     PERFORM P8795-CLOSE-ACCT-ANAL THRU P8799-EXIT.               07161000
071620                                                                  07162000
071630 P1479-EXIT.                                                      07163000
071640     EXIT.                                                        07164000
071650                                                                  07165000
071660 P1480-REPORT-CLOSEOUT-EARN.                                      07166000
071670     MOVE ' ' TO HOLD-DISP.                                       07167000
071680     MOVE ZEROS TO HOLD-CHARGES.                                  07168000
071690     MOVE ZEROS TO EXT-SERV-CHG-AMT.                              07169000
071700     PERFORM P7150-BUILD-IE-SC-JRNL THRU P7159-EXIT.              07170000
071710                                                                  07171000
071720 P1484-EXIT.                                                      07172000
071730     EXIT.                                                        07173000
071740                                                                  07174000
071750******************************************************************07175000
071760*                    P O S T   D E B I T S                       *07176000
071770******************************************************************07177000
071780 P1500-DEB-TX.                                                    07178000
071790* DOLLAR CUT ITEM COUNT                                           07179000
071800     IF ITEM-HANDLING-CODE = '5' OR '9'                           07180000
071810         IF DSDSTXL-ENCL                                          07181000
071820             IF DSDSTXL-AMOUNT = DOLLAR-CUT-2SIG-REQ OR           07182000
071830                DSDSTXL-AMOUNT GREATER THAN DOLLAR-CUT-2SIG-REQ   07183000
071840                 ADD 1 TO ITEM-COUNT-2SIG-REQ.                    07184000
071850                                                                  07185000
071860     IF DSDSTXL-REGE-SW EQUAL 'I' OR 'O'                          07186000
071870         CONTINUE                                                 07187000
071880     ELSE                                                         07188000
071890         MOVE REG-E-ATM-POS-SW  TO DSDSTXL-REGE-SW                07189000
071900     END-IF.                                                      07190000
071910                                                                  07191000
071920* THIS CHECK IS FOR EAA ACCOUNTS                                  07192000
071930     IF BCFSCR-PREPAID-CARD                                       07193000
071940         IF PREPAID-DEBIT OR                                      07194000
071950             DSDSTXL-BAT-NO = 99921                               07195000
071960             NEXT SENTENCE                                        07196000
071970           ELSE                                                   07197000
071980             MOVE 35 TO HOLD-UI-REASON                            07198000
071990             MOVE SPACES TO STOCK-WORK                            07199000
072000             PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT    07200000
072010             GO TO P1010-TRANSACTION-EXIT                         07201000
072020         END-IF                                                   07202000
072030     END-IF.                                                      07203000
072040                                                                  07204000
072050     MOVE DSDSTXL-AMOUNT TO TEMP-TX-AMT.                          07205000
072060     PERFORM P8825-CK-DB-SC-ITEM THRU P8828-EXIT.                 07206000
072070     ADD HOLD-SC-FEE TO TEMP-TX-AMT.                              07207000
072080*** BILL PAYMENT CHECKS NEED TO BE SORTED DIFFERENTLY FROM THE    07208000
072090*** REST OF THE CHECKS                                            07209000
072100     IF DSDSTXL-CODE = 971 OR 974 OR 976 OR 781 OR 972            07210000
072110         NEXT SENTENCE                                            07211000
072120     ELSE                                                         07212000
072130         IF DSDSTXL-DESC EQUAL 'BPCHECK   '                       07213000
072140             MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY         07214000
072150             GO TO P1505-STATUS-CHK                               07215000
072160         END-IF                                                   07216000
072170     END-IF.                                                      07217000
072180                                                                  07218000
072190*** 990/910/870 - MOST COMMON DEBIT CODES                         07219000
072200     IF DSDSTXL-CODE = 990 OR 910 OR 870 OR 874 OR 878            07220000
072210                           OR 913 OR 988                          07221000
072220         PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT           07222000
072230         GO TO P1505-STATUS-CHK.                                  07223000
072240     IF DSDSTXL-CODE = 775 OR 776 OR 777                          07224000
072250         MOVE CHECKPLUS-DEB-KEY TO SAVE-DR-SORT-KEY               07225000
072260         IF PROC-DSD AND SAVEUP-IND = 'Y'                         07226000
072270             ADD 1 TO SAVEUP-NBR-DEBITS                           07227000
072280         END-IF                                                   07228000
072290         IF NO-NSF-ONLINE                                         07229000
072300             GO TO P1555-POST-DEB-CHK-ADV                         07230000
072310           ELSE                                                   07231000
072320             GO TO P1505-STATUS-CHK.                              07232000
072330     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                07233000
072340     IF DSDSTXL-CODE = 460                                        07234000
072350         PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT           07235000
072360         GO TO P1545-POST-DEBIT.                                  07236000
072370     IF DSDSTXL-CODE = 710                                        07237000
072380         PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT           07238000
072390         GO TO P1510-CHK-SURE-CHECK.                              07239000
072400     IF DSDSTXL-CODE = 790 OR 796 OR 797 OR 880 OR                07240000
072410                       896 OR 897                                 07241000
072420         IF DSDSTXL-CODE = 880                                    07242000
072430             ADD DSDSTXL-AMOUNT TO RET-DEP-ITEM-AMT               07243000
072440             ADD 1              TO RET-DEP-ITEM-CNT               07244000
072450         END-IF                                                   07245000
072460         GO TO P1545-POST-DEBIT.                                  07246000
072470     IF DSDSTXL-CODE = 970                                        07247000
072480         IF PRINT-DEP-RECON-RPT                                   07248000
072490             PERFORM P8890-SETUP-DEP-RECON-RPT THRU P8899-EXIT    07249000
072500         END-IF                                                   07250000
072510         GO TO P1545-POST-DEBIT                                   07251000
072520     END-IF.                                                      07252000
072530     IF DSDSTXL-CODE = 787 OR 840 OR 856 OR 799                   07253000
072540         GO TO P1555-POST-DEB-CHK-ADV.                            07254000
072550     IF DSDSTXL-CODE = 972                                        07255000
072560         PERFORM P8860-CREATE-OBS-EXCPT-STOPPAY THRU P8864-EXIT   07256000
072570         IF DSDSTXL-DESC EQUAL 'BPCHECK   '                       07257000
072580             MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY         07258000
072590         ELSE                                                     07259000
072600             PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT       07260000
072610         END-IF                                                   07261000
072620         GO TO P1505-STATUS-CHK.                                  07262000
072630     IF DSDSTXL-CODE = 973                                        07263000
072640         PERFORM P8860-CREATE-OBS-EXCPT-STOPPAY THRU P8864-EXIT   07264000
072650         GO TO P1505-STATUS-CHK.                                  07265000
072660     IF DSDSTXL-CODE = 780 OR 770 OR 771 OR 779 OR 773 OR 778     07266000
072670         MOVE ATM-WITHDRAWAL-KEY TO SAVE-DR-SORT-KEY              07267000
072680         PERFORM P8500-CHK-FOR-UNCOLL-FUNDS THRU P8509-EXIT       07268000
072690         IF NO-NSF-ONLINE                                         07269000
072700             GO TO P1555-POST-DEB-CHK-ADV                         07270000
072710           ELSE                                                   07271000
072720             GO TO P1505-STATUS-CHK.                              07272000
072730     IF DSDSTXL-CODE = 700 OR 705                                 07273000
072740         PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT           07274000
072750         GO TO P1510-CHK-SURE-CHECK.                              07275000
072760     IF DSDSTXL-CODE = 730                                        07276000
072770         GO TO P1545-POST-DEBIT.                                  07277000
072780     IF DSDSTXL-CODE = 740                                        07278000
072790         GO TO P1510-CHK-SURE-CHECK.                              07279000
072800     IF DSDSTXL-CODE = 750                                        07280000
072810         GO TO P1700-CLOSEOUT-DEBIT.                              07281000
072820     IF DSDSTXL-CODE = 830                                        07282000
072830         GO TO P1555-POST-DEB-CHK-ADV.                            07283000
072840     IF SURE-CHECK-ACCT                                           07284000
072850         IF DSDSTXL-CODE = 980                                    07285000
072860             IF DSDSTXL-ACH-STD-ENTRY-CLASS = 'RCK' OR 'POP' OR   07286000
072870                                              'ARC' OR 'BOC'      07287000
072880                 MOVE SPACES TO STOCK-WORK                        07288000
072890********************   SURE CHECK ACCTS WITH ELECTRONIC CHECKS   *07289000
072900                 MOVE 38 TO HOLD-UI-REASON                        07290000
072910                 PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT07291000
072920                 GO TO P1010-TRANSACTION-EXIT.                    07292000
072930     IF DSDSTXL-CODE = 971 OR 974                                 07293000
072940         MOVE SPACES TO STOCK-WORK                                07294000
072950**********************************   STOP PAY MATCH - UNPOSTED   *07295000
072960         MOVE 27 TO HOLD-UI-REASON                                07296000
072970         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07297000
072980         GO TO P1010-TRANSACTION-EXIT.                            07298000
072990     IF DSDSTXL-CODE = 976                                        07299000
073000         MOVE SPACES TO STOCK-WORK                                07300000
073010**********************************   SURECHECK - DUPLICATE       *07301000
073020         MOVE 40 TO HOLD-UI-REASON                                07302000
073030         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07303000
073040         GO TO P1010-TRANSACTION-EXIT.                            07304000
073050     IF DSDSTXL-CODE = 781                                        07305000
073060         MOVE SPACES TO STOCK-WORK                                07306000
073070**********************************   POS EXCEPTION - UNPOSTED    *07307000
073080         MOVE 09 TO HOLD-UI-REASON                                07308000
073090         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07309000
073100         GO TO P1010-TRANSACTION-EXIT.                            07310000
073110     IF DSDSTXL-CODE = 860                                        07311000
073120         PERFORM P8840-SET-KEY-FOR-CHKS THRU P8841-EXIT           07312000
073130         GO TO P1505-STATUS-CHK.                                  07313000
073140     IF DSDSTXL-CODE = 942                                        07314000
073150         MOVE DSDSTXL-AMOUNT TO 942-AMT                           07315000
073160         GO TO P1555-POST-DEB-CHK-ADV.                            07316000
073170     IF DSDSTXL-CODE = 751                                        07317000
073180         GO TO P1507-INVALID-DEB-TX.                              07318000
073190     IF DSDSTXL-CODE = 989                                        07319000
073200         GO TO P1507-INVALID-DEB-TX.                              07320000
073210     IF DSDSTXL-CODE GREATER THAN 788                             07321000
073220         IF DSDSTXL-CODE LESS THAN 796                            07322000
073230             GO TO P1507-INVALID-DEB-TX.                          07323000
073240                                                                  07324000
073250 P1505-STATUS-CHK.                                                07325000
073260     IF HSA-ACCT OR CESA-ACCT                                     07326000
073270         ADD CURRENT-BALANCE TO HOLD-SAC-BALANCE                  07327000
073280                                    GIVING TEMP-CURR-BAL.         07328000
073290     IF DSDSTXL-BAT-NO = 99921                                    07329000
073300         IF SURE-CHECK-ACCT                                       07330000
073310             GO TO P1510-CHK-SURE-CHECK                           07331000
073320           ELSE                                                   07332000
073330             GO TO P1545-POST-DEBIT.                              07333000
073340     IF OPENED                                                    07334000
073350         GO TO P1510-CHK-SURE-CHECK.                              07335000
073360     EVALUATE TRUE                                                07336000
073370         WHEN RESTRICTED                                          07337000
073380             MOVE 12 TO HOLD-UI-REASON                            07338000
073390*                                *   RESTRICTED ACCOUNT-UNPOSTED *07339000
073400         WHEN COURT-RESTRICT                                      07340000
073410             MOVE 31 TO HOLD-UI-REASON                            07341000
073420*                                *   COURT RESTRICTED-UNPOSTED   *07342000
073430         WHEN RESTRICTED-PCO                                      07343000
073440             MOVE 23 TO HOLD-UI-REASON                            07344000
073450*                                *   RESTRICTED - POST CRED ONLY *07345000
073460         WHEN DECEASED                                            07346000
073470             MOVE 04 TO HOLD-UI-REASON                            07347000
073480*                                *   DECEASED ACCOUNT-UNPOSTED   *07348000
073490         WHEN GARNISH-LEVY                                        07349000
073500             MOVE 03 TO HOLD-UI-REASON                            07350000
073510*                                * GRNSH/LEVY ACCOUNT-UNPOSTED   *07351000
073520         WHEN RESTRICTED-ACH                                      07352000
073530             IF DSDSTXL-CODE = 980 OR 973 OR 763 OR 840 OR 741    07353000
073540                 MOVE 34 TO HOLD-UI-REASON                        07354000
073550*                                *   RESTRICTED - ACH DEBITS     *07355000
073560               ELSE                                               07356000
073570                 GO TO P1510-CHK-SURE-CHECK                       07357000
073580             END-IF                                               07358000
073590         WHEN OTHER                                               07359000
073600             GO TO P1510-CHK-SURE-CHECK                           07360000
073610     END-EVALUATE.                                                07361000
073620     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07362000
073630     MOVE SPACES TO STOCK-WORK.                                   07363000
073640     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07364000
073650     GO TO P1010-TRANSACTION-EXIT.                                07365000
073660                                                                  07366000
073670 P1507-INVALID-DEB-TX.                                            07367000
073680     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07368000
073690     MOVE SPACES TO STOCK-WORK.                                   07369000
073700**********************************   INV.TX CODE-UNPOSTED        *07370000
073710     MOVE 10 TO HOLD-UI-REASON.                                   07371000
073720     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07372000
073730     GO TO P1010-TRANSACTION-EXIT.                                07373000
073740*****************                                                 07374000
073750*****************                                                 07375000
073760 P1510-CHK-SURE-CHECK.                                            07376000
073770     IF SURE-CHECK-ACCT                                           07377000
073780         NEXT SENTENCE                                            07378000
073790       ELSE                                                       07379000
073800         GO TO P1515-CHECK-FOR-OA.                                07380000
073810     IF DSDSTXL-CODE = 990 OR                                     07381000
073820                       988 OR                                     07382000
073830                       972 OR                                     07383000
073840                       910 OR                                     07384000
073850                       913 OR                                     07385000
073860                       870 OR                                     07386000
073870                       874 OR                                     07387000
073880                       878 OR                                     07388000
073890                       710                                        07389000
073900         NEXT SENTENCE                                            07390000
073910       ELSE                                                       07391000
073920         GO TO P1515-CHECK-FOR-OA.                                07392000
073930     IF SAVE-DR-SORT-KEY = SER-CHK-KEY OR                         07393000
073940        DSDSTXL-DESC = 'BPCHECK   '                               07394000
073950         NEXT SENTENCE                                            07395000
073960       ELSE                                                       07396000
073970         ADD DSDSTXL-AMOUNT TO UNPOST-AMT                         07397000
073980         MOVE SPACES TO STOCK-WORK                                07398000
073990***************************************   CHECK NO SERIAL NUMBER *07399000
074000         MOVE 32 TO HOLD-UI-REASON                                07400000
074010         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07401000
074020         PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT    07402000
074030         GO TO P1010-TRANSACTION-EXIT.                            07403000
074040     IF ARC-DOLLAR-LIMIT = ZEROS                                  07404000
074050         GO TO P1511-SURE-CHECK-BEGIN-CHECK.                      07405000
074060     IF DSDSTXL-CODE = 710 OR                                     07406000
074070        DSDSTXL-BAT-NO = 99921                                    07407000
074080         GO TO P1511-SURE-CHECK-BEGIN-CHECK.                      07408000
074090     IF DSDSTXL-AMOUNT GREATER THAN ARC-DOLLAR-LIMIT              07409000
074100         NEXT SENTENCE                                            07410000
074110       ELSE                                                       07411000
074120         GO TO P1511-SURE-CHECK-BEGIN-CHECK.                      07412000
074130     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07413000
074140     MOVE SPACES TO STOCK-WORK.                                   07414000
074150*                                     *   CHECK AMOUNT TOO HIGH  *07415000
074160     MOVE 36 TO HOLD-UI-REASON.                                   07416000
074170     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07417000
074180     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07418000
074190     GO TO P1010-TRANSACTION-EXIT.                                07419000
074200                                                                  07420000
074210 P1511-SURE-CHECK-BEGIN-CHECK.                                    07421000
074220     IF DSDSTXL-CHK-NO GREATER THAN ARC-BEGIN-CHECK               07422000
074230         NEXT SENTENCE                                            07423000
074240       ELSE                                                       07424000
074250         GO TO P1515-CHECK-FOR-OA.                                07425000
074260     MOVE DSDSTXL-BANK-NO TO AR-BANK.                             07426000
074270     MOVE DSDSTXL-ACCT-NO TO AR-ACCT.                             07427000
074280     MOVE DSDSTXL-CHK-NO  TO AR-SERIAL-NBR.                       07428000
074290     MOVE DSDSTXL-AMOUNT  TO AR-ISSUED-AMT.                       07429000
074300     EXEC SQL                                                     07430000
074310         SELECT                                                   07431000
074320             AR_BANK,                                             07432000
074330             AR_ACCT,                                             07433000
074340             AR_SERIAL_NBR,                                       07434000
074350             AR_CURR_STATUS,                                      07435000
074360             AR_PREV_STATUS,                                      07436000
074370             AR_DATE_ISSUED,                                      07437000
074380             AR_ISS_AUD_CYCLE,                                    07438000
074390             AR_DATE_PAID,                                        07439000
074400             AR_ISSUED_AMT,                                       07440000
074410             AR_PAID_AMT,                                         07441000
074420             AR_BATCH_NBR,                                        07442000
074430             AR_SEQUENCE_NBR,                                     07443000
074440             AR_CHECK_TYPE,                                       07444000
074450             AR_PAYEE_NAME,                                       07445000
074460             AR_PAYROLL_CO,                                       07446000
074470             AR_STATUS_DATE,                                      07447000
074480             AR_LAST_MAINT_DT,                                    07448000
074490             AR_LAST_PROC_DATE,                                   07449000
074500             AR_MAINT_EXTRACT,                                    07450000
074510             AR_MAINT_OPER,                                       07451000
074520             AR_STOP_PAY_IND                                      07452000
074530         INTO                                                     07453000
074540            :AR-BANK,                                             07454000
074550            :AR-ACCT,                                             07455000
074560            :AR-SERIAL-NBR,                                       07456000
074570            :AR-CURR-STATUS,                                      07457000
074580            :AR-PREV-STATUS,                                      07458000
074590            :AR-DATE-ISSUED,                                      07459000
074600            :AR-ISS-AUD-CYCLE,                                    07460000
074610            :AR-DATE-PAID,                                        07461000
074620            :AR-ISSUED-AMT,                                       07462000
074630            :AR-PAID-AMT,                                         07463000
074640            :AR-BATCH-NBR,                                        07464000
074650            :AR-SEQUENCE-NBR,                                     07465000
074660            :AR-CHECK-TYPE,                                       07466000
074670            :AR-PAYEE-NAME,                                       07467000
074680            :AR-PAYROLL-CO,                                       07468000
074690            :AR-STATUS-DATE,                                      07469000
074700            :AR-LAST-MAINT-DT,                                    07470000
074710            :AR-LAST-PROC-DATE,                                   07471000
074720            :AR-MAINT-EXTRACT,                                    07472000
074730            :AR-MAINT-OPER,                                       07473000
074740            :AR-STOP-PAY-IND                                      07474000
074750         FROM AR.CHECKS                                           07475000
074760         WHERE AR_BANK       = :AR-BANK                           07476000
074770           AND AR_ACCT       = :AR-ACCT                           07477000
074780           AND AR_SERIAL_NBR = :AR-SERIAL-NBR                     07478000
074790           AND AR_ISSUED_AMT = :AR-ISSUED-AMT                     07479000
074800     END-EXEC.                                                    07480000
074810     EVALUATE SQLCODE                                             07481000
074820         WHEN ZEROS                                               07482000
074830             GO TO P1513-SURE-CHECK-FOUND                         07483000
074840         WHEN +100                                                07484000
074850             CONTINUE                                             07485000
074860         WHEN OTHER                                               07486000
074870             DISPLAY 'CDCERROR-SURE CHECK SELECT ERROR'           07487000
074880                 UPON CONSOLE                                     07488000
074890             CALL 'CDCUT90' USING SQLCA                           07489000
074900             CALL 'CDCDUMP' USING BY CONTENT '2039'               07490000
074910     END-EVALUATE.                                                07491000
074920                                                                  07492000
074930 P1512-LOOK-FOR-SERIAL-ONLY.                                      07493000
074940     MOVE DSDSTXL-BANK-NO TO AR-BANK.                             07494000
074950     MOVE DSDSTXL-ACCT-NO TO AR-ACCT.                             07495000
074960     MOVE DSDSTXL-CHK-NO  TO AR-SERIAL-NBR.                       07496000
074970     EXEC SQL                                                     07497000
074980         SELECT                                                   07498000
074990             AR_BANK,                                             07499000
075000             AR_ACCT,                                             07500000
075010             AR_SERIAL_NBR,                                       07501000
075020             AR_CURR_STATUS,                                      07502000
075030             AR_PREV_STATUS,                                      07503000
075040             AR_DATE_ISSUED,                                      07504000
075050             AR_ISS_AUD_CYCLE,                                    07505000
075060             AR_DATE_PAID,                                        07506000
075070             AR_ISSUED_AMT,                                       07507000
075080             AR_PAID_AMT,                                         07508000
075090             AR_BATCH_NBR,                                        07509000
075100             AR_SEQUENCE_NBR,                                     07510000
075110             AR_CHECK_TYPE,                                       07511000
075120             AR_PAYEE_NAME,                                       07512000
075130             AR_PAYROLL_CO,                                       07513000
075140             AR_STATUS_DATE,                                      07514000
075150             AR_LAST_MAINT_DT,                                    07515000
075160             AR_LAST_PROC_DATE,                                   07516000
075170             AR_MAINT_EXTRACT,                                    07517000
075180             AR_MAINT_OPER,                                       07518000
075190             AR_STOP_PAY_IND                                      07519000
075200         INTO                                                     07520000
075210            :AR-BANK,                                             07521000
075220            :AR-ACCT,                                             07522000
075230            :AR-SERIAL-NBR,                                       07523000
075240            :AR-CURR-STATUS,                                      07524000
075250            :AR-PREV-STATUS,                                      07525000
075260            :AR-DATE-ISSUED,                                      07526000
075270            :AR-ISS-AUD-CYCLE,                                    07527000
075280            :AR-DATE-PAID,                                        07528000
075290            :AR-ISSUED-AMT,                                       07529000
075300            :AR-PAID-AMT,                                         07530000
075310            :AR-BATCH-NBR,                                        07531000
075320            :AR-SEQUENCE-NBR,                                     07532000
075330            :AR-CHECK-TYPE,                                       07533000
075340            :AR-PAYEE-NAME,                                       07534000
075350            :AR-PAYROLL-CO,                                       07535000
075360            :AR-STATUS-DATE,                                      07536000
075370            :AR-LAST-MAINT-DT,                                    07537000
075380            :AR-LAST-PROC-DATE,                                   07538000
075390            :AR-MAINT-EXTRACT,                                    07539000
075400            :AR-MAINT-OPER,                                       07540000
075410            :AR-STOP-PAY-IND                                      07541000
075420         FROM AR.CHECKS                                           07542000
075430         WHERE AR_BANK       = :AR-BANK                           07543000
075440           AND AR_ACCT       = :AR-ACCT                           07544000
075450           AND AR_SERIAL_NBR = :AR-SERIAL-NBR                     07545000
075460     END-EXEC.                                                    07546000
075470     EVALUATE SQLCODE                                             07547000
075480         WHEN ZEROS                                               07548000
075490         WHEN -811                                                07549000
075500***************************************   CHECK BAD AMOUNT       *07550000
075510             MOVE 33 TO HOLD-UI-REASON                            07551000
075520         WHEN +100                                                07552000
075530***************************************   NO SURE CHECK RECORD   *07553000
075540             MOVE 20 TO HOLD-UI-REASON                            07554000
075550         WHEN OTHER                                               07555000
075560             DISPLAY 'CDCERROR-SURE CHECK SELECT ERROR'           07556000
075570                 UPON CONSOLE                                     07557000
075580             CALL 'CDCUT90' USING SQLCA                           07558000
075590             CALL 'CDCDUMP' USING BY CONTENT '2040'               07559000
075600     END-EVALUATE.                                                07560000
075610                                                                  07561000
075620     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07562000
075630     MOVE SPACES TO STOCK-WORK.                                   07563000
075640     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07564000
075650     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07565000
075660     GO TO P1010-TRANSACTION-EXIT.                                07566000
075670                                                                  07567000
075680 P1513-SURE-CHECK-FOUND.                                          07568000
075690     EVALUATE TRUE                                                07569000
075700         WHEN AR-CURR-STATUS = 'I'                                07570000
075710             IF DSDSTXL-BAT-NO = 99921                            07571000
075720                 GO TO P1545-POST-DEBIT                           07572000
075730               ELSE                                               07573000
075740                 GO TO P1515-CHECK-FOR-OA                         07574000
075750             END-IF                                               07575000
075760         WHEN AR-CURR-STATUS = 'C'                                07576000
075770             MOVE 21 TO HOLD-UI-REASON                            07577000
075780*                                     *   CHECK ALREADY PAID     *07578000
075790         WHEN AR-CURR-STATUS = 'D' OR 'V'                         07579000
075800             MOVE 26 TO HOLD-UI-REASON                            07580000
075810*                                     *   CHECK DELETED OR VOID  *07581000
075820         WHEN AR-CURR-STATUS = 'R'                                07582000
075830             MOVE 06 TO HOLD-UI-REASON                            07583000
075840*                                     *   CHECK STALE DATED      *07584000
075850         WHEN AR-CURR-STATUS = 'S'                                07585000
075860             MOVE 11 TO HOLD-UI-REASON                            07586000
075870*                                     *   CHECK STOPPAY          *07587000
075880         WHEN OTHER                                               07588000
075890             GO TO P1515-CHECK-FOR-OA                             07589000
075900     END-EVALUATE.                                                07590000
075910     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07591000
075920     MOVE SPACES TO STOCK-WORK.                                   07592000
075930     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07593000
075940     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07594000
075950     GO TO P1010-TRANSACTION-EXIT.                                07595000
075960                                                                  07596000
075970*****************                                                 07597000
075980*****************                                                 07598000
075990                                                                  07599000
076000 P1515-CHECK-FOR-OA.                                              07600000
076010     IF DSDSTXL-BAT-NO = 99921                                    07601000
076020         GO TO P1545-POST-DEBIT.                                  07602000
076030     IF DSDSTXL-CODE = 710                                        07603000
076040         GO TO P1545-POST-DEBIT.                                  07604000
076050     IF DSDSTXL-CODE = 772 OR 783 OR 798 OR 879 OR 908            07605000
076060         GO TO P1560-POST-DEBIT2                                  07606000
076070     END-IF.                                                      07607000
076080     IF OD-ACCESS-BANK                                            07608000
076090         NEXT SENTENCE                                            07609000
076100       ELSE                                                       07610000
076110         GO TO P1519-PROCESS-DEBIT.                               07611000
076120     IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED           07612000
076130         NEXT SENTENCE                                            07613000
076140       ELSE                                                       07614000
076150         GO TO P1519-PROCESS-DEBIT.                               07615000
076160     MOVE CURRENT-BALANCE TO TEMP-CURR-BAL.                       07616000
076170     IF TEMP-CURR-BAL LESS THAN TEMP-TX-AMT                       07617000
076180         GO TO P1516-CHECK-OA-LIMIT.                              07618000
076190     IF DSDSTXL-CODE = 870 OR 874 OR 878                          07619000
076200*        IF HOLD-AFFILIATE-CHK-IND = 'Y'                          07620000
076210*            PERFORM P8250-CHECK-AFFCHK-HOLD THRU P8259-EXIT      07621000
076220*        GO TO P1560-POST-DEBIT2                                  07622000
076230*      ELSE                                                       07623000
076240         GO TO P1560-POST-DEBIT2.                                 07624000
076250     IF HOLD-ACCUM = ZERO                                         07625000
076260         GO TO P1519-PROCESS-DEBIT.                               07626000
076270     GO TO P1517-CHECK-HOLD.                                      07627000
076280                                                                  07628000
076290 P1516-CHECK-OA-LIMIT.                                            07629000
076300     ADD OD-ACCESS-LIMIT TO TEMP-CURR-BAL.                        07630000
076310     IF CYCLE-THIS-SC-EARN = 1                                    07631000
076320         IF ACCRUED-INTEREST POSITIVE                             07632000
076330             ADD ACCRUED-INTEREST TO TEMP-CURR-BAL.               07633000
076340     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    07634000
076350         GO TO P1519-PROCESS-DEBIT.                               07635000
076360     IF DSDSTXL-CODE = 700 OR 705 OR 740                          07636000
076370         GO TO P1518-USE-OD-ACCESS-LIMIT.                         07637000
076380     IF HOLD-ACCUM = ZERO                                         07638000
076390         GO TO P1518-USE-OD-ACCESS-LIMIT.                         07639000
076400     MOVE ZERO TO AFFCHK-HIT-SW.                                  07640000
076410     IF HOLD-AFFILIATE-CHK-IND = 'Y'                              07641000
076420         PERFORM P8250-CHECK-AFFCHK-HOLD THRU P8259-EXIT          07642000
076430         IF AFFCHK-HIT-SW = 1                                     07643000
076440             MOVE ZERO TO AFFCHK-HIT-SW                           07644000
076450             GO TO P1518-USE-OD-ACCESS-LIMIT.                     07645000
076460     SUBTRACT HOLD-ACCUM FROM TEMP-CURR-BAL.                      07646000
076470     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    07647000
076480         MOVE SPACES TO STOCK-WORK                                07648000
076490******************************   HOLD VIOLATION-UNPOSTED          07649000
076500         MOVE 02 TO HOLD-UI-REASON                                07650000
076510         IF E-ITEM-TX                                             07651000
076520             PERFORM P8465-BUILD-NSF-FILE-4 THRU P8469-EXIT       07652000
076530             GO TO P1560-POST-DEBIT2                              07653000
076540         END-IF                                                   07654000
076550         ADD DSDSTXL-AMOUNT TO UNPOST-AMT                         07655000
076560         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07656000
076570         PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT    07657000
076580         GO TO P1010-TRANSACTION-EXIT.                            07658000
076590     GO TO P1518-USE-OD-ACCESS-LIMIT.                             07659000
076600                                                                  07660000
076610 P1517-CHECK-HOLD.                                                07661000
076620     MOVE ZERO TO AFFCHK-HIT-SW.                                  07662000
076630     IF HOLD-AFFILIATE-CHK-IND = 'Y'                              07663000
076640         PERFORM P8250-CHECK-AFFCHK-HOLD THRU P8259-EXIT          07664000
076650         IF AFFCHK-HIT-SW = 1                                     07665000
076660             MOVE ZERO TO AFFCHK-HIT-SW                           07666000
076670             GO TO P1560-POST-DEBIT2.                             07667000
076680     SUBTRACT HOLD-ACCUM FROM TEMP-CURR-BAL.                      07668000
076690     IF TEMP-CURR-BAL LESS THAN TEMP-TX-AMT                       07669000
076700         NEXT SENTENCE                                            07670000
076710       ELSE                                                       07671000
076720         GO TO P1519-PROCESS-DEBIT.                               07672000
076730     ADD OD-ACCESS-LIMIT TO TEMP-CURR-BAL.                        07673000
076740     IF CYCLE-THIS-SC-EARN = 1                                    07674000
076750         IF ACCRUED-INTEREST POSITIVE                             07675000
076760             ADD ACCRUED-INTEREST TO TEMP-CURR-BAL.               07676000
076770     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    07677000
076780         NEXT SENTENCE                                            07678000
076790       ELSE                                                       07679000
076800         GO TO P1560-POST-DEBIT2.                                 07680000
076810     ADD HOLD-ACCUM TO TEMP-CURR-BAL.                             07681000
076820     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    07682000
076830         GO TO P1535-NSF2.                                        07683000
076840     IF DSDSTXL-CODE = 700 OR 705 OR 740                          07684000
076850         GO TO P1518-USE-OD-ACCESS-LIMIT.                         07685000
076860     MOVE SPACES TO STOCK-WORK.                                   07686000
076870**************************   HOLD VIOLATION-UNPOSTED              07687000
076880     MOVE 02 TO HOLD-UI-REASON.                                   07688000
076890     IF E-ITEM-TX                                                 07689000
076900         PERFORM P8465-BUILD-NSF-FILE-4 THRU P8469-EXIT           07690000
076910         GO TO P1560-POST-DEBIT2                                  07691000
076920     END-IF.                                                      07692000
076930     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07693000
076940     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07694000
076950     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07695000
076960     GO TO P1010-TRANSACTION-EXIT.                                07696000
076970                                                                  07697000
076980 P1518-USE-OD-ACCESS-LIMIT.                                       07698000
076990     MOVE 37 TO HOLD-UI-REASON.                                   07699000
077000     PERFORM P8460-BUILD-NSF-FILE-3 THRU P8464-EXIT.              07700000
077010     PERFORM P8770-CHK-NIPS-HIST THRU P8779-EXIT.                 07701000
077020 P1518-CONTINUE.                                                  07702000
077030     ADD 1 TO NUM-NSF-CHECKS-MO.                                  07703000
077040     GO TO P1560-POST-DEBIT2.                                     07704000
077050                                                                  07705000
077060 P1519-PROCESS-DEBIT.                                             07706000
077070     MOVE CURRENT-BALANCE     TO TEMP-CURR-BAL.                   07707000
077080     IF HSA-ACCT OR CESA-ACCT                                     07708000
077090         ADD HOLD-SAC-BALANCE TO TEMP-CURR-BAL.                   07709000
077100     ADD ADVANCE-TX-AMT       TO TEMP-CURR-BAL.                   07710000
077110     ADD HE-ADVANCE-TX-AMT    TO TEMP-CURR-BAL.                   07711000
077120     ADD CLSN-BR-ADV-TX-AMT   TO TEMP-CURR-BAL.                   07712000
077130     IF POST-OD                                                   07713000
077140         NEXT SENTENCE                                            07714000
077150       ELSE                                                       07715000
077160         ADD WORK-OD-LIMIT TO TEMP-CURR-BAL.                      07716000
077170     IF ODB-PLAN = SPACES                                         07717000
077180         IF CYCLE-THIS-SC-EARN = 1                                07718000
077190             IF ACCRUED-INTEREST POSITIVE                         07719000
077200                 ADD ACCRUED-INTEREST TO TEMP-CURR-BAL.           07720000
077210     IF DSDSTXL-CODE = 700 OR                                     07721000
077220                       705 OR                                     07722000
077230                       740                                        07723000
077240         GO TO P1530-CHK-NSF2.                                    07724000
077250     IF SURE-CHECK-ACCT AND ZERO-BAL-ACCT-IND = 'Y'               07725000
077260         PERFORM P8250-CHECK-AFFCHK-HOLD THRU P8259-EXIT          07726000
077270         IF AFFCHK-HIT-SW = 1                                     07727000
077280             MOVE ZERO TO AFFCHK-HIT-SW                           07728000
077290             GO TO P1560-POST-DEBIT2.                             07729000
077300     IF HOLD-ACCUM = ZERO                                         07730000
077310         GO TO P1530-CHK-NSF2.                                    07731000
077320     MOVE ZERO TO AFFCHK-HIT-SW.                                  07732000
077330     IF HOLD-AFFILIATE-CHK-IND = 'Y'                              07733000
077340         PERFORM P8250-CHECK-AFFCHK-HOLD THRU P8259-EXIT          07734000
077350         IF AFFCHK-HIT-SW = 1                                     07735000
077360           AND ODB-PLAN = SPACES                                  07736000
077370           AND ML-HELOC-NBR = ZEROS                               07737000
077380             MOVE ZERO TO AFFCHK-HIT-SW                           07738000
077390             GO TO P1560-POST-DEBIT2.                             07739000
077400     SUBTRACT HOLD-ACCUM FROM TEMP-CURR-BAL.                      07740000
077410                                                                  07741000
077420 P1520-CHK-NSF1.                                                  07742000
077430     IF TEMP-CURR-BAL NOT LESS THAN TEMP-TX-AMT                   07743000
077440         GO TO P1560-POST-DEBIT2.                                 07744000
077450     IF ODB-PLAN = SPACES                                         07745000
077460     AND ML-HELOC-NBR = ZEROS                                     07746000
077470     AND HOLD-BR-CLSN-TIED = ZEROS                                07747000
077480         GO TO P1525-NSF1                                         07748000
077490     END-IF.                                                      07749000
077500     IF ML-HELOC-NBR = ZEROS                                      07750000
077510         CONTINUE                                                 07751000
077520     ELSE                                                         07752000
077530         PERFORM P2590-NEED-ML-HELOC-ADVANCE THRU P2590-EXIT      07753000
077540         GO TO P1522-CONTINUE                                     07754000
077550     END-IF.                                                      07755000
077560                                                                  07756000
077570     IF HOLD-BR-CLSN-TIED = ZEROS                                 07757000
077580         CONTINUE                                                 07758000
077590     ELSE                                                         07759000
077600         IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                07760000
077610             PERFORM P2600-NEED-CLSN-BR-ADVANCE THRU P2601-EXIT   07761000
077620         END-IF                                                   07762000
077630         IF CLSN-BR-POST-TX-YES                                   07763000
077640             GO TO P1560-POST-DEBIT2                              07764000
077650         ELSE                                                     07765000
077660             GO TO P1525-NSF1                                     07766000
077670         END-IF                                                   07767000
077680     END-IF.                                                      07768000
077690                                                                  07769000
077700     PERFORM P2450-NEED-ADVANCE     THRU P2520-ADV-EXIT.          07770000
077710                                                                  07771000
077720 P1522-CONTINUE.                                                  07772000
077730     IF TEMP-CURR-BAL NOT LESS THAN TEMP-TX-AMT                   07773000
077740         GO TO P1560-POST-DEBIT2.                                 07774000
077750     IF AFFCHK-HIT-SW = 1                                         07775000
077760         MOVE ZERO TO AFFCHK-HIT-SW                               07776000
077770         GO TO P1560-POST-DEBIT2.                                 07777000
077780                                                                  07778000
077790 P1525-NSF1.                                                      07779000
077800     ADD HOLD-ACCUM TO TEMP-CURR-BAL.                             07780000
077810     IF TEMP-CURR-BAL NOT LESS THAN TEMP-TX-AMT                   07781000
077820         NEXT SENTENCE                                            07782000
077830       ELSE                                                       07783000
077840         GO TO P1535-NSF2.                                        07784000
077850     MOVE SPACES TO STOCK-WORK.                                   07785000
077860**********************************   HOLD VIOLATION-UNPOSTED     *07786000
077870     MOVE 02 TO HOLD-UI-REASON.                                   07787000
077880     IF E-ITEM-TX                                                 07788000
077890         PERFORM P8465-BUILD-NSF-FILE-4 THRU P8469-EXIT           07789000
077900         GO TO P1560-POST-DEBIT2                                  07790000
077910     ELSE                                                         07791000
077920         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        07792000
077930         PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT    07793000
077940     END-IF.                                                      07794000
077950     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            07795000
077960     GO TO P1010-TRANSACTION-EXIT.                                07796000
077970                                                                  07797000
077980 P1530-CHK-NSF2.                                                  07798000
077990     IF TEMP-CURR-BAL NOT LESS THAN TEMP-TX-AMT                   07799000
078000         GO TO P1560-POST-DEBIT2.                                 07800000
078010     IF  ODB-PLAN     = SPACES                                    07801000
078020     AND ML-HELOC-NBR = ZEROS                                     07802000
078030     AND HOLD-BR-CLSN-TIED = ZEROS                                07803000
078040         GO TO P1535-NSF2                                         07804000
078050     END-IF.                                                      07805000
078060                                                                  07806000
078070     IF ML-HELOC-NBR = ZEROS                                      07807000
078080         CONTINUE                                                 07808000
078090     ELSE                                                         07809000
078100         PERFORM P2590-NEED-ML-HELOC-ADVANCE THRU P2590-EXIT      07810000
078110         GO TO P1532-CONTINUE                                     07811000
078120     END-IF.                                                      07812000
078130                                                                  07813000
078140     IF HOLD-BR-CLSN-TIED = ZEROS                                 07814000
078150         CONTINUE                                                 07815000
078160     ELSE                                                         07816000
078170         PERFORM P2600-NEED-CLSN-BR-ADVANCE THRU P2601-EXIT       07817000
078180         IF CLSN-BR-POST-TX-YES                                   07818000
078190             GO TO P1560-POST-DEBIT2                              07819000
078200         ELSE                                                     07820000
078210             GO TO P1535-NSF2                                     07821000
078220         END-IF                                                   07822000
078230     END-IF.                                                      07823000
078240                                                                  07824000
078250     PERFORM P2450-NEED-ADVANCE     THRU P2520-ADV-EXIT.          07825000
078260 P1532-CONTINUE.                                                  07826000
078270     IF TEMP-CURR-BAL NOT LESS THAN TEMP-TX-AMT                   07827000
078280         GO TO P1560-POST-DEBIT2.                                 07828000
078290                                                                  07829000
078300 P1535-NSF2.                                                      07830000
078310     IF POST-OD                                                   07831000
078320         GO TO P1540-CHK-APPR-OD.                                 07832000
078330     IF DSDSTXL-CODE = 772 OR 783 OR 879 OR 908                   07833000
078340         GO TO P1560-POST-DEBIT2                                  07834000
078350     END-IF.                                                      07835000
078360     ADD 1 TO NUM-NSF-CHECKS-MO.                                  07836000
078370     MOVE SPACES TO STOCK-WORK.                                   07837000
078380**********************************   INSUFFICIENT-UNPOSTED       *07838000
078390     IF SURE-CHECK-ACCT                                           07839000
078400         MOVE 41 TO HOLD-UI-REASON                                07840000
078410       ELSE                                                       07841000
078420         MOVE 01 TO HOLD-UI-REASON.                               07842000
078430     IF E-ITEM-TX                                                 07843000
078440         PERFORM P8465-BUILD-NSF-FILE-4 THRU P8469-EXIT           07844000
078450         GO TO P1560-POST-DEBIT2                                  07845000
078460     END-IF.                                                      07846000
078470     MOVE '1' TO INSF-PEND-SW.                                    07847000
078480     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           07848000
078490     ADD 1 TO INSF-CNT.                                           07849000
078500     ADD DSDSTXL-AMOUNT TO INSF-AMT.                              07850000
078510     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07851000
078520     GO TO P1010-TRANSACTION-EXIT.                                07852000
078530                                                                  07853000
078540 P1540-CHK-APPR-OD.                                               07854000
078550     IF DSDSTXL-CODE LESS THAN 790 OR GREATER THAN 850            07855000
078560         ADD 1 TO NUM-APPR-OD-MO.                                 07856000
078570     IF SURE-CHECK-ACCT                                           07857000
078580         MOVE 41 TO HOLD-UI-REASON                                07858000
078590       ELSE                                                       07859000
078600         MOVE 01 TO HOLD-UI-REASON.                               07860000
078610     IF E-ITEM-TX                                                 07861000
078620         PERFORM P8465-BUILD-NSF-FILE-4 THRU P8469-EXIT           07862000
078630         GO TO P1560-POST-DEBIT2                                  07863000
078640     END-IF.                                                      07864000
078650     ADD 1 TO INSF-CNT.                                           07865000
078660     PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT.       07866000
078670     PERFORM P8440-BUILD-NSF-FILE-1 THRU P8449-EXIT.              07867000
078680     PERFORM P8865-CREATE-OBS-EXCPT-POSTED THRU P8869-EXIT.       07868000
078690     GO TO P1560-POST-DEBIT2.                                     07869000
078700                                                                  07870000
078710 P1545-POST-DEBIT.                                                07871000
078720     IF EARNINGS-CODE = +099                                      07872000
078730         NEXT SENTENCE                                            07873000
078740       ELSE                                                       07874000
078750         MOVE 1 TO BACK-DATED-SW                                  07875000
078760         PERFORM P0570-ACCR-INT THRU P0579-EXIT                   07876000
078770         MOVE 0 TO BACK-DATED-SW                                  07877000
078780         COMPUTE HOLD-THIS-ACCRUAL =                              07878000
078790             HOLD-DAILY-ACCR * BACKOUT-DAYS                       07879000
078800         SUBTRACT HOLD-THIS-ACCRUAL FROM ACCRUED-INTEREST         07880000
078810         SUBTRACT HOLD-THIS-ACCRUAL FROM TDY-EXP-BY-IDENT (SUB13) 07881000
078820         SUBTRACT HOLD-THIS-ACCRUAL FROM TDY-EXP-BY-IDENT (11)    07882000
078830         COMPUTE HOLD-THIS-ACCRUAL = HOLD-MIN-ACCR * BACKOUT-DAYS 07883000
078840         SUBTRACT HOLD-THIS-ACCRUAL FROM MIN-ACCR-INTEREST.       07884000
078850     IF INV-PLAN = SPACES                                         07885000
078860         NEXT SENTENCE                                            07886000
078870       ELSE                                                       07887000
078880         IF DSDSTXL-CODE = 880 AND INV-NORMAL                     07888000
078890             IF INV-PEGGED-BAL = ZERO                             07889000
078900                 GO TO P1555-POST-DEB-CHK-ADV.                    07890000
078910     IF DAYS-IN-CYCLE = 0                                         07891000
078920         GO TO P1550-CONT.                                        07892000
078930                                                                  07893000
078940     IF CDC-DB2-DATE >= AA-IMPL-DATE                              07894000
078950         IF DSDSTXL-CODE = 799                                    07895000
078960             GO TO P1546-CONTINUE                                 07896000
078970         END-IF                                                   07897000
078980     END-IF.                                                      07898000
078990                                                                  07899000
079000     SUBTRACT DSDSTXL-AMOUNT FROM HOLD-CURR-BAL-ADJ.              07900000
079010     SUBTRACT DSDSTXL-AMOUNT FROM HOLD-COLL-BAL-ADJ.              07901000
079020                                                                  07902000
079030 P1546-CONTINUE.                                                  07903000
079040     IF DAYS-IN-CYCLE LESS THAN BACKOUT-DAYS                      07904000
079050         COMPUTE HOLD-AVERAGE =                                   07905000
079060             DSDSTXL-AMOUNT * DAYS-IN-CYCLE                       07906000
079070       ELSE                                                       07907000
079080         COMPUTE HOLD-AVERAGE =                                   07908000
079090             DSDSTXL-AMOUNT * BACKOUT-DAYS.                       07909000
079100     SUBTRACT HOLD-AVERAGE FROM GROSS-COLL-BAL-CYCL.              07910000
079110     SUBTRACT HOLD-AVERAGE FROM GROSS-CURR-BAL-CYCL.              07911000
079120     IF DDA-ACCOUNT                                               07912000
079130         GO TO P1550-CONT.                                        07913000
079140     IF HOLD-AVERAGE GREATER THAN TIS-GRS-CUR-BAL-CYC             07914000
079150         NEXT SENTENCE                                            07915000
079160       ELSE                                                       07916000
079170         SUBTRACT HOLD-AVERAGE FROM TIS-GRS-CUR-BAL-CYC.          07917000
079180     IF HOLD-AVERAGE GREATER THAN TIS-GRS-COL-BAL-CYC             07918000
079190         NEXT SENTENCE                                            07919000
079200       ELSE                                                       07920000
079210         SUBTRACT HOLD-AVERAGE FROM TIS-GRS-COL-BAL-CYC.          07921000
079220                                                                  07922000
079230 P1550-CONT.                                                      07923000
079240     IF DAYS-IN-CAL-MONTH = 0                                     07924000
079250         GO TO P1555-POST-DEB-CHK-ADV.                            07925000
079260     IF DAYS-IN-CAL-MONTH LESS THAN BACKOUT-DAYS                  07926000
079270         COMPUTE HOLD-AVERAGE =                                   07927000
079280             DSDSTXL-AMOUNT * DAYS-IN-CAL-MONTH                   07928000
079290       ELSE                                                       07929000
079300         COMPUTE HOLD-AVERAGE =                                   07930000
079310             DSDSTXL-AMOUNT * BACKOUT-DAYS.                       07931000
079320     SUBTRACT HOLD-AVERAGE FROM GROSS-COLL-BAL-MNTH.              07932000
079330     SUBTRACT HOLD-AVERAGE FROM GROSS-CURR-BAL-MNTH.              07933000
079340                                                                  07934000
079350 P1555-POST-DEB-CHK-ADV.                                          07935000
079360     COMPUTE TEMP-CURR-BAL =                                      07936000
079370         CURRENT-BALANCE +                                        07937000
079380         ADVANCE-TX-AMT +                                         07938000
079390         HE-ADVANCE-TX-AMT +                                      07939000
079400         CLSN-BR-ADV-TX-AMT +                                     07940000
079410         WORK-OD-LIMIT -                                          07941000
079420         HOLD-ACCUM.                                              07942000
079430     IF CYCLE-THIS-SC-EARN = 1                                    07943000
079440         ADD ACCRUED-INTEREST TO TEMP-CURR-BAL.                   07944000
079450     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    07945000
079460         NEXT SENTENCE                                            07946000
079470       ELSE                                                       07947000
079480         GO TO P1560-POST-DEBIT2.                                 07948000
079490     IF  ODB-PLAN     = SPACES                                    07949000
079500     AND ML-HELOC-NBR = ZEROS                                     07950000
079510     AND HOLD-BR-CLSN-TIED = ZEROS                                07951000
079520         GO TO P1560-POST-DEBIT2                                  07952000
079530     END-IF.                                                      07953000
079540                                                                  07954000
079550     IF ML-HELOC-NBR = ZEROS                                      07955000
079560         CONTINUE                                                 07956000
079570     ELSE                                                         07957000
079580         PERFORM P2590-NEED-ML-HELOC-ADVANCE THRU P2590-EXIT      07958000
079590         GO TO P1560-POST-DEBIT2                                  07959000
079600     END-IF.                                                      07960000
079610                                                                  07961000
079620     IF HOLD-BR-CLSN-TIED = ZEROS                                 07962000
079630         CONTINUE                                                 07963000
079640     ELSE                                                         07964000
079650         ADD HOLD-ACCUM TO TEMP-CURR-BAL                          07965000
079660         SUBTRACT WORK-OD-LIMIT FROM TEMP-CURR-BAL                07966000
079670         PERFORM P2600-NEED-CLSN-BR-ADVANCE THRU P2601-EXIT       07967000
079680         IF CLSN-BR-POST-TX-YES                                   07968000
079690             GO TO P1560-POST-DEBIT2                              07969000
079700         END-IF                                                   07970000
079710     END-IF.                                                      07971000
079720                                                                  07972000
079730     PERFORM P2450-NEED-ADVANCE     THRU P2520-ADV-EXIT.          07973000
079740 P1560-POST-DEBIT2.                                               07974000
079750     IF DSDSTXL-EFFECT-DT NOT = ZERO                              07975000
079760         IF DSDSTXL-CODE NOT = 720                                07976000
079770             IF DSDSTXL-EFFECT-DT LESS THAN PROC-CURR-DATE        07977000
079780                 PERFORM P1650-BACK-DATED-DEBIT THRU P1659-EXIT.  07978000
079790     IF DSDSTXL-CODE = 800                                        07979000
079800         GO TO P1660-PAID-INT-DEBIT.                              07980000
079810                                                                  07981000
079820 P1600-POSTING-DEBITS.                                            07982000
079830     IF DO-ACCT-RECON                                             07983000
079840         IF (SAVE-DR-SORT-KEY = NON-SER-CHK-KEY OR SER-CHK-KEY)   07984000
079850            OR DSDSTXL-DESC = 'BPCHECK   '                        07985000
079860             PERFORM P9010-BUILD-ACCT-RECON THRU P9014-EXIT       07986000
079870           ELSE                                                   07987000
079880             IF DSDSTXL-CODE = 980                                07988000
079890                IF DSDSTXL-ACH-STD-ENTRY-CLASS = 'RCK' OR 'POP' OR07989000
079900                                                 'ARC' OR 'BOC'   07990000
079910                 PERFORM P9010-BUILD-ACCT-RECON THRU P9014-EXIT.  07991000
079920     PERFORM P1690-CHK-3RD-PARTY THRU P1699-EXIT.                 07992000
079930     IF DSDSTXL-CODE = 990 OR                                     07993000
079940                       988 OR                                     07994000
079950                       972 OR                                     07995000
079960                       910 OR                                     07996000
079970                       913 OR                                     07997000
079980                       870 OR                                     07998000
079990                       874 OR                                     07999000
080000                       878                                        08000000
080010         NEXT SENTENCE                                            08001000
080020       ELSE                                                       08002000
080030         GO TO P1665-NORM-DEBIT.                                  08003000
080040     IF LIST-POST-CODE GREATER THAN 0                             08004000
080050         GO TO P1610-LIST-POST-ROUTINE.                           08005000
080060     ADD DSDSTXL-ENCL-TYPE TO NUM-ENCLOSURES.                     08006000
080070     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW.                      08007000
080080     IF DSDSTXL-CHK-NO = ZERO                                     08008000
080090         MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                   08009000
080100     GO TO P1665-NORM-DEBIT.                                      08010000
080110                                                                  08011000
080120 P1610-LIST-POST-ROUTINE.                                         08012000
080130     IF LIST-POST-SW = 1                                          08013000
080140         GO TO P1615-CHK-LP-ITM-CNT.                              08014000
080150     MOVE ZEROS TO LIST-POST-CNT.                                 08015000
080160     MOVE ZEROS TO LIST-POST-TOT.                                 08016000
080170     MOVE ZEROS TO LP-STORE.                                      08017000
080180     MOVE 1 TO LIST-POST-SW.                                      08018000
080190     MOVE LIST-POST-CODE TO LP-MINIMUM.                           08019000
080200                                                                  08020000
080210 P1615-CHK-LP-ITM-CNT.                                            08021000
080220     IF LIST-POST-CNT LESS THAN LP-MINIMUM                        08022000
080230         NEXT SENTENCE                                            08023000
080240       ELSE                                                       08024000
080250         GO TO P1625-NO-STORE-CK.                                 08025000
080260     ADD 1 TO LP-STORE.                                           08026000
080270     MOVE DSDSTXL-CODE TO WP-TX-CODE.                             08027000
080280     MOVE DSDSTXL-AMOUNT TO WP-AMT.                               08028000
080290     MOVE DSDSTXL-ITEM-ID TO WP-ITEM-ID.                          08029000
080300     MOVE DSDSTXL-DESC TO WP-DESC.                                08030000
080310     IF DSDSTXL-CHK-NO = ZERO                                     08031000
080320         MOVE NON-SER-CHK-KEY TO WP-SORT-KEY                      08032000
080330         MOVE PROC-CURR-DATE TO WP-CHK-NO                         08033000
080340       ELSE                                                       08034000
080350         MOVE SER-CHK-KEY TO WP-SORT-KEY                          08035000
080360         MOVE DSDSTXL-CHK-NO TO WP-CHK-NO.                        08036000
080370     MOVE DSDSTXL-CO-DESC TO WP-CO-DESC.                          08037000
080380     SUBTRACT DSDSTXL-AMOUNT FROM CURRENT-BALANCE                 08038000
080390         GIVING WP-TX-BAL.                                        08039000
080400     MOVE WP-WORK TO WP-DETAIL (LP-STORE).                        08040000
080410                                                                  08041000
080420 P1620-POST-LP-DEBIT.                                             08042000
080430     SUBTRACT DSDSTXL-AMOUNT FROM CURRENT-BALANCE.                08043000
080440     ADD 1 TO NUM-DEBITS.                                         08044000
080450     SUBTRACT HOLD-SC-FEE FROM CURRENT-BALANCE.                   08045000
080460     MOVE ACCT-TYPE-CODE TO SUB9.                                 08046000
080470     ADD HOLD-SC-FEE TO SERV-CHG-FEES                             08047000
080480                        AMT-DEBITS                                08048000
080490                        SC-FEE-BY-SC (SUB5)                       08049000
080500                        CURR-MO-SERV-CHRG                         08050000
080510                        GEN-DEBIT-AMT                             08051000
080520                        AMT-REG-DEBITS                            08052000
080530                        AMT-DEB-BY-TYPE (SUB9)                    08053000
080540                        AMT-DEB-BY-TYPE (100)                     08054000
080550                        DEBITS-BY-IDENT (SUB13)                   08055000
080560                        PJ-DEB-AMT.                               08056000
080570     IF HOLD-SC-FEE NOT = ZERO                                    08057000
080580         MOVE ZEROS TO HOLD-SC-FEE                                08058000
080590         ADD 1 TO GEN-DEBIT-CNT.                                  08059000
080600     EVALUATE TRUE                                                08060000
080610         WHEN DSDSTXL-NOT-SC                                      08061000
080620             CONTINUE                                             08062000
080630         WHEN DSDSTXL-REG-SC                                      08063000
080640             ADD 1 TO NUM-REG-SC-DEBITS                           08064000
080650                      NUM-SERV-CHG-DEBITS                         08065000
080660                      HOLD-DR-CR-ITM-FOR-AA                       08066000
080670                      HOLD-DEBITS-FOR-AA                          08067000
080680                      HOLD-ALL-DR-FOR-AA                          08068000
080690         WHEN DSDSTXL-ATM-SC                                      08069000
080700             ADD 1 TO NUM-ATM-SC-DEBITS                           08070000
080710                      NUM-SERV-CHG-DEBITS                         08071000
080720                      HOLD-DR-CR-ITM-FOR-AA                       08072000
080730                      HOLD-DEBITS-FOR-AA                          08073000
080740                      HOLD-ALL-DR-FOR-AA                          08074000
080750         WHEN DSDSTXL-ACH-SC                                      08075000
080760             ADD 1 TO NUM-ACH-SC-DEBITS                           08076000
080770                      NUM-SERV-CHG-DEBITS                         08077000
080780                      HOLD-DR-CR-ITM-FOR-AA                       08078000
080790                      HOLD-ACH-DEB-FOR-AA                         08079000
080800                      HOLD-ALL-DR-FOR-AA                          08080000
080810         WHEN DSDSTXL-FT-SC                                       08081000
080820             ADD 1 TO NUM-FT-SC-DEBITS                            08082000
080830                      NUM-SERV-CHG-DEBITS                         08083000
080840                      HOLD-DR-CR-ITM-FOR-AA                       08084000
080850                      HOLD-DEBITS-FOR-AA                          08085000
080860                      HOLD-ALL-DR-FOR-AA                          08086000
080870         WHEN DSDSTXL-TELE-SC                                     08087000
080880             ADD 1 TO NUM-TELE-SC-DEBITS                          08088000
080890                      NUM-SERV-CHG-DEBITS                         08089000
080900                      HOLD-DR-CR-ITM-FOR-AA                       08090000
080910                      HOLD-DEBITS-FOR-AA                          08091000
080920                      HOLD-ALL-DR-FOR-AA                          08092000
080930         WHEN DSDSTXL-INFOLN-SC                                   08093000
080940             ADD 1 TO NUM-INFOLINE-SC-DEBITS                      08094000
080950                      NUM-SERV-CHG-DEBITS                         08095000
080960                      HOLD-DR-CR-ITM-FOR-AA                       08096000
080970                      HOLD-DEBITS-FOR-AA                          08097000
080980                      HOLD-ALL-DR-FOR-AA                          08098000
080990         WHEN DSDSTXL-POS-SC                                      08099000
081000             ADD 1 TO NUM-POS-SC-DEBITS                           08100000
081010                      NUM-SERV-CHG-DEBITS                         08101000
081020                      HOLD-DR-CR-ITM-FOR-AA                       08102000
081030                      HOLD-DEBITS-FOR-AA                          08103000
081040                      HOLD-ALL-DR-FOR-AA                          08104000
081050         WHEN OTHER                                               08105000
081060             CONTINUE                                             08106000
081070     END-EVALUATE.                                                08107000
081080     EVALUATE TRUE                                                08108000
081090         WHEN AA-CODE-296                                         08109000
081100             ADD 1 TO HOLD-REG-TELE-CR-ITM-FOR-AA                 08110000
081110         WHEN OTHER                                               08111000
081120             CONTINUE                                             08112000
081130     END-EVALUATE.                                                08113000
081140     ADD DSDSTXL-AMOUNT TO AMT-DEBITS.                            08114000
081150     ADD 1 TO TODAYS-DEBIT.                                       08115000
081160     MOVE 1 TO ACTIVITY-TDY.                                      08116000
081170     ADD 1 TO LIST-POST-CNT.                                      08117000
081180     ADD DSDSTXL-AMOUNT TO LIST-POST-TOT.                         08118000
081190     IF DSDSTXL-AMOUNT GREATER THAN HOLD-LRG-ITM-CHK              08119000
081200         MOVE 06 TO HOLD-REASON-CODE                              08120000
081210         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.        08121000
081220     PERFORM P8570-BUILD-POSTED-DTL THRU P8572-ACCUM-POSTED-DTL.  08122000
081230     GO TO P1010-TRANSACTION-EXIT.                                08123000
081240                                                                  08124000
081250 P1625-NO-STORE-CK.                                               08125000
081260     IF LP-STORE = 0                                              08126000
081270         GO TO P1640-WRITE-LIST-2.                                08127000
081280     MOVE 0 TO PUT-CNT.                                           08128000
081290                                                                  08129000
081300 P1630-WRITE-LIST-1.                                              08130000
081310     ADD 1 TO PUT-CNT.                                            08131000
081320     MOVE WP-DETAIL (PUT-CNT) TO WP-WORK.                         08132000
081330     MOVE 01 TO HOLD-REASON-CODE.                                 08133000
081340     PERFORM P8690-BUILD-LIST-POST THRU P8699-EXIT.               08134000
081350     IF PUT-CNT = LP-STORE                                        08135000
081360         GO TO P1635-END-LIST-1.                                  08136000
081370     GO TO P1630-WRITE-LIST-1.                                    08137000
081380                                                                  08138000
081390 P1635-END-LIST-1.                                                08139000
081400     MOVE 0 TO LP-STORE.                                          08140000
081410                                                                  08141000
081420 P1640-WRITE-LIST-2.                                              08142000
081430     MOVE 01 TO HOLD-REASON-CODE.                                 08143000
081440     PERFORM P8700-BUILD-LIST-POST2 THRU P8709-BUILD-LP-2-EXIT.   08144000
081450                                                                  08145000
081460 P1645-END-LIST-2.                                                08146000
081470     GO TO P1620-POST-LP-DEBIT.                                   08147000
081480                                                                  08148000
081490******************************************************************08149000
081500* SUBROUTINE - B A C K D A T E D  D E B I T                      *08150000
081510******************************************************************08151000
081520 P1650-BACK-DATED-DEBIT.                                          08152000
081530     MOVE ZEROS TO HOLD-THIS-ACCRUAL                              08153000
081540                   DAYS-11.                                       08154000
081550     CALL 'CDCDT11' USING DSDSTXL-EFFECT-DT                       08155000
081560                          PROC-CURR-DATE                          08156000
081570                          DAYS-11.                                08157000
081580     IF DAYS-11 GREATER THAN 365                                  08158000
081590         MOVE DSDSTXL-DATE TO DSDSTXL-EFFECT-DT                   08159000
081600         GO TO P1659-EXIT.                                        08160000
081610                                                                  08161000
081620 P1651-BUILD-ACCT-ANAL-ADJ-TX.                                    08162000
081630     IF PROC-DSS                                                  08163000
081640         GO TO P1652-CALC-BACK-DATED-GRS-CYC.                     08164000
081650     IF NON-ACCT-ANAL-BANK                                        08165000
081660         GO TO P1652-CALC-BACK-DATED-GRS-CYC.                     08166000
081670     IF ACCT-ANAL-ACCT-IND = 'Y'                                  08167000
081680         NEXT SENTENCE                                            08168000
081690       ELSE                                                       08169000
081700         GO TO P1652-CALC-BACK-DATED-GRS-CYC.                     08170000
081710                                                                  08171000
081720     IF CDC-DB2-DATE >= AA-IMPL-DATE                              08172000
081730         IF DSDSTXL-CODE = 799                                    08173000
081740             GO TO P1652-CALC-BACK-DATED-GRS-CYC                  08174000
081750         END-IF                                                   08175000
081760     END-IF.                                                      08176000
081770                                                                  08177000
081780     MOVE SPACES              TO AA-FILEREC.                      08178000
081790     MOVE 01                  TO AA-INSYSTEM.                     08179000
081800     MOVE PROC-BK-NO          TO AA-BKNBR.                        08180000
081810     MOVE 01                  TO AA-APPL.                         08181000
081820     MOVE DSDSTXL-ACCT-NO     TO AA-ACCOUNT.                      08182000
081830     MOVE 07                  TO AA-RECCODE.                      08183000
081840     INITIALIZE                  AA-BALADJUST.                    08184000
081850     MOVE 'Y'                 TO AA-ADJFILE.                      08185000
081860     MOVE DSDSTXL-EFFECT-DT   TO AA-EFFDT.                        08186000
081870     MOVE ZEROS               TO AA-PDAYSADJ.                     08187000
081880     SUBTRACT PROC-PRE-DAYS FROM DAYS-11                          08188000
081890                          GIVING AA-LDAYS.                        08189000
081900     SUBTRACT DSDSTXL-AMOUNT FROM ZERO                            08190000
081910                          GIVING AA-LBAL.                         08191000
081920     MOVE 00001               TO AA-LDESCRNBR.                    08192000
081930     MOVE 'N'                 TO AA-LSTMTPRT.                     08193000
081940     MOVE AA-LDAYS            TO AA-CDAYS.                        08194000
081950     MOVE AA-LBAL             TO AA-CBAL.                         08195000
081960     MOVE 00002               TO AA-CDESCNBR.                     08196000
081970     MOVE 'N'                 TO AA-CSTMTPRT.                     08197000
081980     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      08198000
081990     IF PROC-PRE-DAYS = ZERO                                      08199000
082000         GO TO P1652-CALC-BACK-DATED-GRS-CYC.                     08200000
082010     MOVE AA-LDAYS            TO DAYS-15.                         08201000
082020     CALL 'CDCDT15'        USING DSDSTXL-EFFECT-DT                08202000
082030                                 DAYS-15                          08203000
082040                                 END-DATE-15.                     08204000
082050     MOVE END-DATE-15         TO AA-EFFDT.                        08205000
082060     MOVE PROC-PRE-DAYS       TO AA-LDAYS                         08206000
082070                                 AA-CDAYS.                        08207000
082080     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      08208000
082090                                                                  08209000
082100 P1652-CALC-BACK-DATED-GRS-CYC.                                   08210000
082110     IF DAYS-11 GREATER THAN DAYS-IN-CYCLE                        08211000
082120         COMPUTE TEMP-GROSS-BAL =                                 08212000
082130             DSDSTXL-AMOUNT * DAYS-IN-CYCLE                       08213000
082140       ELSE                                                       08214000
082150         COMPUTE TEMP-GROSS-BAL =                                 08215000
082160             DSDSTXL-AMOUNT * DAYS-11.                            08216000
082170     SUBTRACT TEMP-GROSS-BAL FROM GROSS-CURR-BAL-CYCL             08217000
082180                                  GROSS-COLL-BAL-CYCL.            08218000
082190     IF DDA-ACCOUNT                                               08219000
082200         GO TO P1654-CALC-BACK-DATED-GRS-MTH.                     08220000
082210     IF TEMP-GROSS-BAL GREATER THAN TIS-GRS-CUR-BAL-CYC           08221000
082220         NEXT SENTENCE                                            08222000
082230       ELSE                                                       08223000
082240         SUBTRACT TEMP-GROSS-BAL FROM TIS-GRS-CUR-BAL-CYC.        08224000
082250     IF TEMP-GROSS-BAL GREATER THAN TIS-GRS-COL-BAL-CYC           08225000
082260         NEXT SENTENCE                                            08226000
082270       ELSE                                                       08227000
082280         SUBTRACT TEMP-GROSS-BAL FROM TIS-GRS-COL-BAL-CYC.        08228000
082290                                                                  08229000
082300 P1654-CALC-BACK-DATED-GRS-MTH.                                   08230000
082310     IF DAYS-11 GREATER THAN DAYS-IN-CAL-MONTH                    08231000
082320         COMPUTE TEMP-GROSS-BAL =                                 08232000
082330             DSDSTXL-AMOUNT * DAYS-IN-CAL-MONTH                   08233000
082340       ELSE                                                       08234000
082350         COMPUTE TEMP-GROSS-BAL =                                 08235000
082360             DSDSTXL-AMOUNT * DAYS-11.                            08236000
082370     SUBTRACT TEMP-GROSS-BAL FROM GROSS-CURR-BAL-MNTH             08237000
082380                                  GROSS-COLL-BAL-MNTH.            08238000
082390                                                                  08239000
082400 P1656-CALC-BACK-DATED-INT.                                       08240000
082410     IF DDA-ACCOUNT                                               08241000
082420         GO TO P1658-REPORT-BACK-DATED-TX.                        08242000
082430     MOVE 1 TO BACK-DATED-SW.                                     08243000
082440     PERFORM P0570-ACCR-INT THRU P0579-EXIT.                      08244000
082450     COMPUTE HOLD-THIS-ACCRUAL =                                  08245000
082460         HOLD-DAILY-ACCR * DAYS-11.                               08246000
082470     MOVE 0 TO BACK-DATED-SW.                                     08247000
082480     IF HOLD-THIS-ACCRUAL GREATER THAN ACCRUED-INTEREST           08248000
082490         IF ACCRUED-INTEREST GREATER THAN ZERO                    08249000
082500             MOVE ACCRUED-INTEREST TO HOLD-THIS-ACCRUAL           08250000
082510           ELSE                                                   08251000
082520             MOVE 02 TO HOLD-REASON-CODE                          08252000
082530             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT     08253000
082540             GO TO P1659-EXIT.                                    08254000
082550     SUBTRACT HOLD-THIS-ACCRUAL FROM ACCRUED-INTEREST             08255000
082560                                     TDY-EXP-BY-IDENT (SUB13)     08256000
082570                                     TDY-EXP-BY-IDENT (11).       08257000
082580     COMPUTE HOLD-THIS-ACCRUAL = HOLD-MIN-ACCR * DAYS-11.         08258000
082590     IF HOLD-THIS-ACCRUAL GREATER THAN MIN-ACCR-INTEREST          08259000
082600         MOVE MIN-ACCR-INTEREST TO HOLD-THIS-ACCRUAL.             08260000
082610     SUBTRACT HOLD-THIS-ACCRUAL FROM MIN-ACCR-INTEREST.           08261000
082620                                                                  08262000
082630 P1658-REPORT-BACK-DATED-TX.                                      08263000
082640     MOVE 01 TO HOLD-REASON-CODE.                                 08264000
082650     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            08265000
082660                                                                  08266000
082670 P1659-EXIT.                                                      08267000
082680     EXIT.                                                        08268000
082690                                                                  08269000
082700******************************************************************08270000
082710*             P A I D   I N T E R E S T   D E B I T              *08271000
082720******************************************************************08272000
082730 P1660-PAID-INT-DEBIT.                                            08273000
082740     IF DSDSTXL-AMOUNT NOT GREATER THAN INT-PAID-YTD              08274000
082750         SUBTRACT DSDSTXL-AMOUNT FROM INT-PAID-YTD                08275000
082760       ELSE                                                       08276000
082770         MOVE ZEROS TO INT-PAID-YTD.                              08277000
082780     PERFORM P1665-NORM-DEBIT.                                    08278000
082790     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             08279000
082800     IF NOT-IN-WITHHOLD-STATUS                                    08280000
082810         GO TO P1010-TRANSACTION-EXIT.                            08281000
082820     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT               08282000
082830         GIVING TEMP-TAX-WITHHELD.                                08283000
082840     IF TEMP-TAX-WITHHELD = ZERO                                  08284000
082850         GO TO P1010-TRANSACTION-EXIT.                            08285000
082860     MOVE ZEROS TO IRSPL-GROUP-ID.                                08286000
082870     MULTIPLY WITHHOLDING-PERCENT BY DSDSTXL-AMOUNT.              08287000
082880     MOVE 662 TO DSDSTXL-CODE.                                    08288000
082890     MOVE OSB-DESC-0005-A TO DSDSTXL-CO-DESC.                     08289000
082900     MOVE OSB-DESC-0005-B TO DSDSTXL-DESC.                        08290000
082910     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       08291000
082920     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             08292000
082930     ADD DSDSTXL-AMOUNT TO GEN-CREDIT-AMT.                        08293000
082940     IF DSDSTXL-AMOUNT NOT GREATER THAN TAX-WITHHELD-YTD          08294000
082950         SUBTRACT DSDSTXL-AMOUNT FROM TAX-WITHHELD-YTD            08295000
082960       ELSE                                                       08296000
082970         MOVE ZEROS TO TAX-WITHHELD-YTD.                          08297000
082980     ADD 1 TO GEN-CREDIT-CNT                                      08298000
082990              NUM-BILL-TX.                                        08299000
083000     MOVE ZEROS TO IRSPL-GROUP-ID.                                08300000
083010     MOVE +113 TO IRSPL-REQUEST-CODE.                             08301000
083020     PERFORM P1820-POST-ADJ-EARN-WH THRU P1829-EXIT.              08302000
083030     PERFORM P1325-NORM-CR-2.                                     08303000
083040     GO TO P1010-TRANSACTION-EXIT.                                08304000
083050                                                                  08305000
083060******************************************************************08306000
083070*                N O R M A L  D E B I T                          *08307000
083080******************************************************************08308000
083090 P1665-NORM-DEBIT.                                                08309000
083100     IF DSDSTXL-CODE = 750                                        08310000
083110         MOVE 1 TO 750-SW.                                        08311000
083120                                                                  08312000
083130     IF 447-SW = 1                                                08313000
083140       IF DSDSTXL-AMOUNT GREATER THAN CURRENT-BALANCE             08314000
083150           NEXT SENTENCE                                          08315000
083160         ELSE                                                     08316000
083170           MOVE 00 TO HOLD-UI-REASON                              08317000
083180           PERFORM P8440-BUILD-NSF-FILE-1 THRU P8449-EXIT         08318000
083190           PERFORM P8380-BUILD-NSF-REC THRU P8389-BUILD-NSF-EXIT. 08319000
083200                                                                  08320000
083210     SUBTRACT DSDSTXL-AMOUNT FROM CURRENT-BALANCE.                08321000
083220     ADD 1 TO NUM-DEBITS.                                         08322000
083230     SUBTRACT HOLD-SC-FEE FROM CURRENT-BALANCE.                   08323000
083240     MOVE ACCT-TYPE-CODE TO SUB9.                                 08324000
083250     ADD HOLD-SC-FEE TO SERV-CHG-FEES                             08325000
083260                        AMT-DEBITS                                08326000
083270                        SC-FEE-BY-SC (SUB5)                       08327000
083280                        CURR-MO-SERV-CHRG                         08328000
083290                        GEN-DEBIT-AMT                             08329000
083300                        AMT-REG-DEBITS                            08330000
083310                        AMT-DEB-BY-TYPE (SUB9)                    08331000
083320                        AMT-DEB-BY-TYPE (100)                     08332000
083330                        DEBITS-BY-IDENT (SUB13)                   08333000
083340                        PJ-DEB-AMT.                               08334000
083350     IF HOLD-SC-FEE NOT = ZERO                                    08335000
083360         MOVE ZEROS TO HOLD-SC-FEE                                08336000
083370         ADD 1 TO GEN-DEBIT-CNT.                                  08337000
083380     EVALUATE TRUE                                                08338000
083390         WHEN DSDSTXL-NOT-SC                                      08339000
083400             CONTINUE                                             08340000
083410         WHEN DSDSTXL-REG-SC                                      08341000
083420             ADD 1 TO NUM-REG-SC-DEBITS                           08342000
083430                      NUM-SERV-CHG-DEBITS                         08343000
083440                      HOLD-DR-CR-ITM-FOR-AA                       08344000
083450                      HOLD-DEBITS-FOR-AA                          08345000
083460                      HOLD-ALL-DR-FOR-AA                          08346000
083470         WHEN DSDSTXL-ATM-SC                                      08347000
083480             ADD 1 TO NUM-ATM-SC-DEBITS                           08348000
083490                      NUM-SERV-CHG-DEBITS                         08349000
083500                      HOLD-DR-CR-ITM-FOR-AA                       08350000
083510                      HOLD-DEBITS-FOR-AA                          08351000
083520                      HOLD-ALL-DR-FOR-AA                          08352000
083530         WHEN DSDSTXL-ACH-SC                                      08353000
083540             ADD 1 TO NUM-ACH-SC-DEBITS                           08354000
083550                      NUM-SERV-CHG-DEBITS                         08355000
083560                      HOLD-DR-CR-ITM-FOR-AA                       08356000
083570                      HOLD-ACH-DEB-FOR-AA                         08357000
083580                      HOLD-ALL-DR-FOR-AA                          08358000
083590         WHEN DSDSTXL-FT-SC                                       08359000
083600             ADD 1 TO NUM-FT-SC-DEBITS                            08360000
083610                      NUM-SERV-CHG-DEBITS                         08361000
083620                      HOLD-DR-CR-ITM-FOR-AA                       08362000
083630                      HOLD-DEBITS-FOR-AA                          08363000
083640                      HOLD-ALL-DR-FOR-AA                          08364000
083650         WHEN DSDSTXL-TELE-SC                                     08365000
083660             ADD 1 TO NUM-TELE-SC-DEBITS                          08366000
083670                      NUM-SERV-CHG-DEBITS                         08367000
083680                      HOLD-DR-CR-ITM-FOR-AA                       08368000
083690                      HOLD-DEBITS-FOR-AA                          08369000
083700                      HOLD-ALL-DR-FOR-AA                          08370000
083710         WHEN DSDSTXL-INFOLN-SC                                   08371000
083720             ADD 1 TO NUM-INFOLINE-SC-DEBITS                      08372000
083730                      NUM-SERV-CHG-DEBITS                         08373000
083740                      HOLD-DR-CR-ITM-FOR-AA                       08374000
083750                      HOLD-DEBITS-FOR-AA                          08375000
083760                      HOLD-ALL-DR-FOR-AA                          08376000
083770         WHEN DSDSTXL-POS-SC                                      08377000
083780             ADD 1 TO NUM-POS-SC-DEBITS                           08378000
083790                      NUM-SERV-CHG-DEBITS                         08379000
083800                      HOLD-DR-CR-ITM-FOR-AA                       08380000
083810                      HOLD-DEBITS-FOR-AA                          08381000
083820                      HOLD-ALL-DR-FOR-AA                          08382000
083830         WHEN OTHER                                               08383000
083840             CONTINUE                                             08384000
083850     END-EVALUATE.                                                08385000
083860     EVALUATE TRUE                                                08386000
083870         WHEN AA-CODE-296                                         08387000
083880             ADD 1 TO HOLD-REG-TELE-CR-ITM-FOR-AA                 08388000
083890         WHEN OTHER                                               08389000
083900             CONTINUE                                             08390000
083910     END-EVALUATE.                                                08391000
083920     ADD DSDSTXL-AMOUNT TO AMT-DEBITS.                            08392000
083930     ADD DSDSTXL-AMOUNT TO WITHDRAWALS-TDY.                       08393000
083940     IF DSDSTXL-CODE = 793                                        08394000
083950         NEXT SENTENCE                                            08395000
083960       ELSE                                                       08396000
083970         ADD 1 TO TODAYS-DEBIT.                                   08397000
083980     MOVE PROC-CURR-DATE TO DATE-LAST-WITHDRAW.                   08398000
083990     MOVE DSDSTXL-AMOUNT TO AMT-LAST-WITHDRAW.                    08399000
084000     IF (DSDSTXL-CODE GREATER THAN 789 AND LESS THAN 851) OR      08400000
084010         DSDSTXL-CODE = 751                                       08401000
084020         NEXT SENTENCE                                            08402000
084030       ELSE                                                       08403000
084040         MOVE 1 TO ACTIVITY-TDY.                                  08404000
084050     IF DSDSTXL-CODE = 880                                        08405000
084060         IF DSDSTXL-CHK-NO GREATER THAN ZERO                      08406000
084070             IF DSDSTXL-CHK-NO = PROC-CURR-DATE                   08407000
084080                 NEXT SENTENCE                                    08408000
084090               ELSE                                               08409000
084100                 MOVE DSDSTXL-CHK-NO TO DSDSTXL-ITEM-COUNT        08410000
084110                 MOVE ZEROS TO DSDSTXL-CHK-NO.                    08411000
084120     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW.                      08412000
084130     MOVE SAVE-DR-SORT-KEY TO DSDSTXL-SORT-KEY.                   08413000
084140     IF DSDSTXL-CHK-NO = ZERO                                     08414000
084150         MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                   08415000
084160                                                                  08416000
084170     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     08417000
084180     IF DSDSTXL-CODE = 785                                        08418000
084190         NEXT SENTENCE                                            08419000
084200       ELSE                                                       08420000
084210         IF DSDSTXL-AMOUNT GREATER THAN HOLD-LRG-ITM-CHK          08421000
084220             MOVE 06 TO HOLD-REASON-CODE                          08422000
084230             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.    08423000
084240                                                                  08424000
084250 P1667-CHECK-HSA-CESA.                                            08425000
084260     IF HSA-ACCT OR CESA-ACCT                                     08426000
084270         PERFORM P9150-SAC-DEBIT-PROCESSING THRU P9159-EXIT.      08427000
084280                                                                  08428000
084290 P1670-DEBIT-EXIT.                                                08429000
084300     IF DSDSTXL-CODE = 990 OR                                     08430000
084310                       988 OR                                     08431000
084320                       972 OR                                     08432000
084330                       910 OR                                     08433000
084340                       913 OR                                     08434000
084350                       870 OR                                     08435000
084360                       874 OR                                     08436000
084370                       878                                        08437000
084380         GO TO P1010-TRANSACTION-EXIT.                            08438000
084390     ADD SAVE-ENCL-SW TO NUM-ENCLOSURES.                          08439000
084400     IF DSDSTXL-CODE = 460 OR                                     08440000
084410                       710                                        08441000
084420         GO TO P1680-DB-CODE-460.                                 08442000
084430     IF DSDSTXL-CODE = 880                                        08443000
084440         IF DSDSTXL-ITEM-COUNT = ZERO                             08444000
084450             GO TO P1010-TRANSACTION-EXIT                         08445000
084460           ELSE                                                   08446000
084470             MOVE 108 TO HOLD-NUMBER                              08447000
084480             GO TO P1675-CHK-EXT-SC-GEN.                          08448000
084490     IF DSDSTXL-CODE = 888                                        08449000
084500         ADD DSDSTXL-AMOUNT TO AMT-INTL-WIRES-OUT                 08450000
084510         ADD 1 TO NUM-INTL-WIRES-OUT                              08451000
084520         MOVE 188 TO HOLD-NUMBER                                  08452000
084530         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08453000
084540         GO TO P1675-CHK-EXT-SC-GEN.                              08454000
084550     IF DSDSTXL-CODE = 889 OR 893                                 08455000
084560         ADD DSDSTXL-AMOUNT TO AMT-INTL-WIRES-OUT                 08456000
084570         ADD 1 TO NUM-INTL-WIRES-OUT                              08457000
084580         GO TO P1010-TRANSACTION-EXIT.                            08458000
084590     IF DSDSTXL-CODE = 890                                        08459000
084600         ADD DSDSTXL-AMOUNT TO AMT-WIRES-OUT                      08460000
084610         ADD 1 TO NUM-WIRES-OUT                                   08461000
084620         MOVE 101 TO HOLD-NUMBER                                  08462000
084630         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08463000
084640         GO TO P1675-CHK-EXT-SC-GEN.                              08464000
084650     IF DSDSTXL-CODE = 891 OR 894                                 08465000
084660         ADD DSDSTXL-AMOUNT TO AMT-WIRES-OUT                      08466000
084670         ADD 1 TO NUM-WIRES-OUT                                   08467000
084680         GO TO P1010-TRANSACTION-EXIT.                            08468000
084690     IF DSDSTXL-CODE = 898                                        08469000
084700         ADD DSDSTXL-AMOUNT TO AMT-WIRES-TTL                      08470000
084710         ADD 1 TO NUM-WIRES-TTL                                   08471000
084720         MOVE 199 TO HOLD-NUMBER                                  08472000
084730         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08473000
084740         GO TO P1675-CHK-EXT-SC-GEN.                              08474000
084750     IF DSDSTXL-CODE = 899                                        08475000
084760         ADD DSDSTXL-AMOUNT TO AMT-WIRES-TTL                      08476000
084770         ADD 1 TO NUM-WIRES-TTL                                   08477000
084780         GO TO P1010-TRANSACTION-EXIT.                            08478000
084790     IF DSDSTXL-CODE = 920                                        08479000
084800         MOVE 133 TO HOLD-NUMBER                                  08480000
084810         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08481000
084820         GO TO P1675-CHK-EXT-SC-GEN.                              08482000
084830     IF DSDSTXL-CODE = 950                                        08483000
084840         MOVE 115 TO HOLD-NUMBER                                  08484000
084850         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08485000
084860         GO TO P1675-CHK-EXT-SC-GEN.                              08486000
084870     IF DSDSTXL-CODE = 983                                        08487000
084880         MOVE 115 TO HOLD-NUMBER                                  08488000
084890         MOVE 1 TO DSDSTXL-ITEM-COUNT                             08489000
084900         GO TO P1675-CHK-EXT-SC-GEN.                              08490000
084910                                                                  08491000
084920     GO TO P1010-TRANSACTION-EXIT.                                08492000
084930                                                                  08493000
084940 P1675-CHK-EXT-SC-GEN.                                            08494000
084950     PERFORM P8080-CHK-EXT-SC-GEN THRU P8089-EXIT.                08495000
084960     IF SUB7 = ZERO                                               08496000
084970         GO TO P1010-TRANSACTION-EXIT.                            08497000
084980     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    08498000
084990     MOVE HOLD-NUMBER TO DSDSTXL-CODE.                            08499000
085000     GO TO P1250-EXT-SERV-CHRG-TXS.                               08500000
085010                                                                  08501000
085020                                                                  08502000
085030 P1680-DB-CODE-460.                                               08503000
085040     IF POST-OD                                                   08504000
085050         GO TO P1010-TRANSACTION-EXIT.                            08505000
085060     ADD 1 TO NUM-APPR-OD-MO.                                     08506000
085070     MOVE 1 TO 460-710-SW.                                        08507000
085080     IF DSDSTXL-CODE = 460                                        08508000
085090         NEXT SENTENCE                                            08509000
085100       ELSE                                                       08510000
085110         GO TO P1010-TRANSACTION-EXIT.                            08511000
085120     IF CURRENT-BALANCE LESS THAN 0                               08512000
085130         NEXT SENTENCE                                            08513000
085140       ELSE                                                       08514000
085150         GO TO P1010-TRANSACTION-EXIT.                            08515000
085160     IF SC-ITEM-CHG                                               08516000
085170         NEXT SENTENCE                                            08517000
085180       ELSE                                                       08518000
085190         GO TO P1010-TRANSACTION-EXIT.                            08519000
085200     IF WORK-OD-FEE       = ZERO                                  08520000
085210         GO TO P1010-TRANSACTION-EXIT.                            08521000
085220     IF HOLD-NUM-OD = 9                                           08522000
085230         GO TO P1685-CHARGE-460.                                  08523000
085240     ADD 1 TO HOLD-NUM-OD.                                        08524000
085250     IF HOLD-NUM-OD GREATER THAN NUM-FREE-OVERDRAFTS              08525000
085260         GO TO P1685-CHARGE-460.                                  08526000
085270     GO TO P1010-TRANSACTION-EXIT.                                08527000
085280                                                                  08528000
085290 P1685-CHARGE-460.                                                08529000
085300     MOVE 791 TO DSDSTXL-CODE.                                    08530000
085310     MOVE OSB-DESC-0006-A TO DSDSTXL-CO-DESC.                     08531000
085320     MOVE OSB-DESC-0006-B TO DSDSTXL-DESC.                        08532000
085330     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                08533000
085340     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       08534000
085350     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             08535000
085360     MOVE WORK-OD-FEE      TO DSDSTXL-AMOUNT.                     08536000
085370     IF PERSONAL                                                  08537000
085380         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-RETAIL               08538000
085390       ELSE                                                       08539000
085400         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-COMMERCIAL.          08540000
085410     ADD 1 TO GEN-DEBIT-CNT.                                      08541000
085420     ADD 1 TO NUM-BILL-TX.                                        08542000
085430     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT.                         08543000
085440     GO TO P1665-NORM-DEBIT.                                      08544000
085450                                                                  08545000
085460 P1690-CHK-3RD-PARTY.                                             08546000
085470     IF PROC-DSD                                                  08547000
085480         IF DSDSTXL-CODE = 990 OR 910 OR 988 OR 913 OR 460 OR 710 08548000
085490                        OR 775 OR 776 OR 777 OR 778               08549000
085500             ADD 1 TO NUM-3RD-PARTY-DEBITS                        08550000
085510                      NUM-LIMIT-OF-6-DEBITS                       08551000
085520                      IMM-NTC-MM-CTR                              08552000
085530             GO TO P1695-CHK-EXCEPTION.                           08553000
085540     IF DSDSTXL-CODE = 700 OR 860 OR 930 OR 931 OR 932 OR 972     08554000
085550         ADD 1 TO NUM-3RD-PARTY-DEBITS                            08555000
085560                  NUM-LIMIT-OF-6-DEBITS                           08556000
085570                  IMM-NTC-MM-CTR                                  08557000
085580         GO TO P1695-CHK-EXCEPTION.                               08558000
085590     GO TO P1699-EXIT.                                            08559000
085600                                                                  08560000
085610 P1695-CHK-EXCEPTION.                                             08561000
085620     PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT.                08562000
085630                                                                  08563000
085640 P1699-EXIT.                                                      08564000
085650     EXIT.                                                        08565000
085660                                                                  08566000
085670******************************************************************08567000
085680*      C L O S E O U T   D E B I T   T R A N S A C T I O N       *08568000
085690******************************************************************08569000
085700 P1700-CLOSEOUT-DEBIT.                                            08570000
085710     MOVE ZEROS TO TEMP-CLOSEOUT-BAL                              08571000
085720                   TEMP-CLOSEOUT-EXCESS                           08572000
085730                   TEMP-CLOSEOUT-ACCR-INT                         08573000
085740                   TEMP-CLOSEOUT-INT-DROP                         08574000
085750                   TEMP-CLOSEOUT-INV-INT-DROP                     08575000
085760                   TEMP-CLOSEOUT-TX-INT                           08576000
085770                   TEMP-CLOSEOUT-TAX                              08577000
085780                   TEMP-CLOSEOUT-ANN-EARN.                        08578000
085790     IF CURRENT-BALANCE NEGATIVE                                  08579000
085800         GO TO P1745-CLOSEOUT-TOO-BIG.                            08580000
085810     IF PROC-DSS                                                  08581000
085820         GO TO P1715-CLOSEOUT-SAV.                                08582000
085830     IF ODB-PLAN = SPACES                                         08583000
085840         GO TO P1705-CHK-FOR-INV.                                 08584000
085850     IF ODB-LOAN-BAL = ZERO  AND                                  08585000
085860        MONTHLY-ACCUM-INT = ZERO AND                              08586000
085870        ODB-ACCUM-CR-LIFE = ZERO                                  08587000
085880         GO TO P1705-CHK-FOR-INV.                                 08588000
085890     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            08589000
085900     MOVE SPACES TO STOCK-WORK.                                   08590000
085910     MOVE 28 TO HOLD-UI-REASON.                                   08591000
085920     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           08592000
085930     GO TO P1010-TRANSACTION-EXIT.                                08593000
085940                                                                  08594000
085950 P1705-CHK-FOR-INV.                                               08595000
085960     IF INV-PLAN = SPACES                                         08596000
085970         GO TO P1710-CHK-ACCT-TYPE.                               08597000
085980     IF INV-BALANCE = ZERO  AND                                   08598000
085990        INV-ACCRUED-INT = ZERO                                    08599000
086000         GO TO P1710-CHK-ACCT-TYPE.                               08600000
086010     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             08601000
086020     IF NOT-IN-WITHHOLD-STATUS                                    08602000
086030         GO TO P1725-CLOSEOUT-RP.                                 08603000
086040     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            08604000
086050     MOVE SPACES TO STOCK-WORK.                                   08605000
086060     MOVE 22 TO HOLD-UI-REASON.                                   08606000
086070     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           08607000
086080     GO TO P1010-TRANSACTION-EXIT.                                08608000
086090                                                                  08609000
086100 P1710-CHK-ACCT-TYPE.                                             08610000
086110     IF NOW-ACCOUNT OR IMM-ACCOUNT OR CMM-ACCOUNT                 08611000
086120         GO TO P1735-CLOSEOUT-NOW-IMM.                            08612000
086130     GO TO P1720-CLOSEOUT-DDA.                                    08613000
086140                                                                  08614000
086150 P1715-CLOSEOUT-SAV.                                              08615000
086160     IF DSDSTXL-AMOUNT LESS THAN CURRENT-BALANCE                  08616000
086170         GO TO P1740-CLOSEOUT-TOO-SMALL.                          08617000
086180     IF ACCRUED-INTEREST NEGATIVE                                 08618000
086190         MOVE CURRENT-BALANCE TO TEMP-CLOSEOUT-BAL                08619000
086200       ELSE                                                       08620000
086210         COMPUTE TEMP-CLOSEOUT-BAL ROUNDED =                      08621000
086220             CURRENT-BALANCE +                                    08622000
086230             ACCRUED-INTEREST.                                    08623000
086240     IF DSDSTXL-AMOUNT GREATER THAN TEMP-CLOSEOUT-BAL             08624000
086250         GO TO P1745-CLOSEOUT-TOO-BIG.                            08625000
086260     IF ACCRUED-INTEREST GREATER THAN ZERO                        08626000
086270         MOVE ACCRUED-INTEREST TO HOLD-ACTUAL-ACCR-INT            08627000
086280         ADD +.005 TO ACCRUED-INTEREST.                           08628000
086290     SUBTRACT DSDSTXL-AMOUNT FROM TEMP-CLOSEOUT-BAL               08629000
086300         GIVING TEMP-CLOSEOUT-EXCESS.                             08630000
086310     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             08631000
086320     IF IN-WITHHOLD-STATUS                                        08632000
086330         SUBTRACT CURRENT-BALANCE FROM DSDSTXL-AMOUNT             08633000
086340             GIVING TEMP-CLOSEOUT-TX-INT                          08634000
086350         MULTIPLY WITHHOLDING-PERCENT BY TEMP-CLOSEOUT-TX-INT     08635000
086360             GIVING TEMP-CLOSEOUT-TAX                             08636000
086370         IF TEMP-CLOSEOUT-TAX GREATER THAN TEMP-CLOSEOUT-EXCESS   08637000
086380             MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-TAX       08638000
086390             MOVE ZEROS TO TEMP-CLOSEOUT-EXCESS                   08639000
086400           ELSE                                                   08640000
086410             SUBTRACT TEMP-CLOSEOUT-TAX FROM TEMP-CLOSEOUT-EXCESS.08641000
086420     IF TEMP-CLOSEOUT-EXCESS = ZERO                               08642000
086430         NEXT SENTENCE                                            08643000
086440       ELSE                                                       08644000
086450         SUBTRACT TEMP-CLOSEOUT-EXCESS FROM ACCRUED-INTEREST      08645000
086460                                            HOLD-ACTUAL-ACCR-INT  08646000
086470         MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP      08647000
086480         PERFORM P1750-ADD-CLOSEOUT-INT-DROP THRU P1759-EXIT.     08648000
086490     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      08649000
086500     MOVE TEMP-CLOSEOUT-TAX TO HOLD-TAX-WITHHELD.                 08650000
086510     IF ACCRUED-INTEREST NOT = ZERO                               08651000
086520         IF ACCRUED-INTEREST POSITIVE                             08652000
086530             MOVE '1' TO HOLD-EARN-DISP                           08653000
086540             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08654000
086550             MOVE 'C' TO CLOSEOUT-SW                              08655000
086560             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           08656000
086570             MOVE ' ' TO CLOSEOUT-SW                              08657000
086580             PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT        08658000
086590             MOVE ZEROS TO ACCRUED-INTEREST                       08659000
086600           ELSE                                                   08660000
086610             MOVE '9' TO HOLD-EARN-DISP                           08661000
086620             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08662000
086630             PERFORM P5502-NO-CREDIT.                             08663000
086640     PERFORM P1665-NORM-DEBIT.                                    08664000
086650     ADD SAVE-ENCL-SW TO NUM-ENCLOSURES.                          08665000
086660     PERFORM P1760-CLOSEOUT-ACCT THRU P1769-EXIT.                 08666000
086670     GO TO P1010-TRANSACTION-EXIT.                                08667000
086680                                                                  08668000
086690 P1720-CLOSEOUT-DDA.                                              08669000
086700     IF DSDSTXL-AMOUNT LESS THAN CURRENT-BALANCE                  08670000
086710         GO TO P1740-CLOSEOUT-TOO-SMALL.                          08671000
086720     IF DSDSTXL-AMOUNT GREATER THAN CURRENT-BALANCE               08672000
086730         GO TO P1745-CLOSEOUT-TOO-BIG.                            08673000
086740     PERFORM P1665-NORM-DEBIT.                                    08674000
086750     ADD SAVE-ENCL-SW TO NUM-ENCLOSURES.                          08675000
086760     PERFORM P1760-CLOSEOUT-ACCT THRU P1769-EXIT.                 08676000
086770     GO TO P1010-TRANSACTION-EXIT.                                08677000
086780                                                                  08678000
086790 P1725-CLOSEOUT-RP.                                               08679000
086800     IF DSDSTXL-AMOUNT LESS THAN CURRENT-BALANCE                  08680000
086810         GO TO P1740-CLOSEOUT-TOO-SMALL.                          08681000
086820     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      08682000
086830     MOVE HOLD-EARNINGS TO ACCRUED-INTEREST.                      08683000
086840     MOVE INV-ACCRUED-INT TO HOLD-EARNINGS.                       08684000
086850     MOVE HOLD-EARNINGS TO INV-ACCRUED-INT.                       08685000
086860     IF ACCRUED-INTEREST NEGATIVE                                 08686000
086870         ADD CURRENT-BALANCE  INV-ACCRUED-INT                     08687000
086880             GIVING TEMP-CLOSEOUT-BAL                             08688000
086890       ELSE                                                       08689000
086900         ADD CURRENT-BALANCE  ACCRUED-INTEREST  INV-ACCRUED-INT   08690000
086910             GIVING TEMP-CLOSEOUT-BAL.                            08691000
086920     IF DSDSTXL-AMOUNT GREATER THAN TEMP-CLOSEOUT-BAL             08692000
086930         GO TO P1745-CLOSEOUT-TOO-BIG.                            08693000
086940     IF ACCRUED-INTEREST NEGATIVE                                 08694000
086950         MOVE ACCRUED-INTEREST TO TEMP-CLOSEOUT-INT-DROP          08695000
086960         MOVE ZEROS TO ACCRUED-INTEREST                           08696000
086970         PERFORM P1750-ADD-CLOSEOUT-INT-DROP THRU P1759-EXIT.     08697000
086980     SUBTRACT DSDSTXL-AMOUNT FROM TEMP-CLOSEOUT-BAL               08698000
086990         GIVING TEMP-CLOSEOUT-EXCESS.                             08699000
087000     IF TEMP-CLOSEOUT-EXCESS = ZERO                               08700000
087010         GO TO P1730-END-CLOSEOUT-RP.                             08701000
087020     SUBTRACT CURRENT-BALANCE FROM DSDSTXL-AMOUNT                 08702000
087030         GIVING TEMP-TX-AMT.                                      08703000
087040     IF TEMP-TX-AMT NOT LESS THAN INV-ACCRUED-INT                 08704000
087050         SUBTRACT INV-ACCRUED-INT FROM TEMP-TX-AMT                08705000
087060             GIVING ACCRUED-INTEREST                              08706000
087070         MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP      08707000
087080         PERFORM P1750-ADD-CLOSEOUT-INT-DROP THRU P1759-EXIT      08708000
087090         GO TO P1730-END-CLOSEOUT-RP.                             08709000
087100     SUBTRACT TEMP-TX-AMT FROM INV-ACCRUED-INT                    08710000
087110         GIVING TEMP-CLOSEOUT-INV-INT-DROP.                       08711000
087120     ADD TEMP-CLOSEOUT-INV-INT-DROP                               08712000
087130             TO TDY-DROP-BY-PLAN-INV (SUB11)                      08713000
087140                TDY-DROP-BY-PLAN-INV (11).                        08714000
087150     MOVE TEMP-TX-AMT TO INV-ACCRUED-INT.                         08715000
087160     MOVE ZEROS TO ACCRUED-INTEREST.                              08716000
087170     MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP.         08717000
087180     PERFORM P1750-ADD-CLOSEOUT-INT-DROP THRU P1759-EXIT.         08718000
087190                                                                  08719000
087200 P1730-END-CLOSEOUT-RP.                                           08720000
087210     IF INV-ACCRUED-INT NOT = ZERO                                08721000
087220         PERFORM P4110-POST-INV-INT-2 THRU P4199-EXIT.            08722000
087230     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                       08723000
087240                              HOLD-ACTUAL-ACCR-INT.               08724000
087250     IF ACCRUED-INTEREST NOT = ZERO                               08725000
087260         IF ACCRUED-INTEREST POSITIVE                             08726000
087270             MOVE '1' TO HOLD-EARN-DISP                           08727000
087280             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08728000
087290             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           08729000
087300             PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT        08730000
087310             MOVE ZEROS TO ACCRUED-INTEREST                       08731000
087320           ELSE                                                   08732000
087330             MOVE '9' TO HOLD-EARN-DISP                           08733000
087340             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08734000
087350             PERFORM P5502-NO-CREDIT.                             08735000
087360     PERFORM P1665-NORM-DEBIT.                                    08736000
087370     ADD SAVE-ENCL-SW TO NUM-ENCLOSURES.                          08737000
087380     PERFORM P1760-CLOSEOUT-ACCT THRU P1769-EXIT.                 08738000
087390     GO TO P1010-TRANSACTION-EXIT.                                08739000
087400                                                                  08740000
087410 P1735-CLOSEOUT-NOW-IMM.                                          08741000
087420     IF DSDSTXL-AMOUNT LESS THAN CURRENT-BALANCE                  08742000
087430         GO TO P1740-CLOSEOUT-TOO-SMALL.                          08743000
087440     IF ACCRUED-INTEREST NEGATIVE                                 08744000
087450         MOVE CURRENT-BALANCE TO TEMP-CLOSEOUT-BAL                08745000
087460       ELSE                                                       08746000
087470         ADD CURRENT-BALANCE  ACCRUED-INTEREST                    08747000
087480             GIVING TEMP-CLOSEOUT-BAL.                            08748000
087490     IF DSDSTXL-AMOUNT GREATER THAN TEMP-CLOSEOUT-BAL             08749000
087500         GO TO P1745-CLOSEOUT-TOO-BIG.                            08750000
087510     SUBTRACT DSDSTXL-AMOUNT FROM TEMP-CLOSEOUT-BAL               08751000
087520         GIVING TEMP-CLOSEOUT-EXCESS.                             08752000
087530     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             08753000
087540     IF IN-WITHHOLD-STATUS                                        08754000
087550         SUBTRACT CURRENT-BALANCE FROM DSDSTXL-AMOUNT             08755000
087560             GIVING TEMP-CLOSEOUT-TX-INT                          08756000
087570         MULTIPLY WITHHOLDING-PERCENT BY TEMP-CLOSEOUT-TX-INT     08757000
087580             GIVING TEMP-CLOSEOUT-TAX                             08758000
087590         IF TEMP-CLOSEOUT-TAX GREATER THAN TEMP-CLOSEOUT-EXCESS   08759000
087600             MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-TAX       08760000
087610             MOVE ZEROS TO TEMP-CLOSEOUT-EXCESS                   08761000
087620           ELSE                                                   08762000
087630             SUBTRACT TEMP-CLOSEOUT-TAX FROM TEMP-CLOSEOUT-EXCESS.08763000
087640     IF TEMP-CLOSEOUT-EXCESS = ZERO                               08764000
087650         NEXT SENTENCE                                            08765000
087660       ELSE                                                       08766000
087670         SUBTRACT TEMP-CLOSEOUT-EXCESS FROM ACCRUED-INTEREST      08767000
087680         MOVE TEMP-CLOSEOUT-EXCESS TO TEMP-CLOSEOUT-INT-DROP      08768000
087690         PERFORM P1750-ADD-CLOSEOUT-INT-DROP THRU P1759-EXIT.     08769000
087700     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                       08770000
087710                              HOLD-ACTUAL-ACCR-INT.               08771000
087720     MOVE TEMP-CLOSEOUT-TAX TO HOLD-TAX-WITHHELD.                 08772000
087730     IF ACCRUED-INTEREST NOT = ZERO                               08773000
087740         IF ACCRUED-INTEREST POSITIVE                             08774000
087750             MOVE '1' TO HOLD-EARN-DISP                           08775000
087760             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08776000
087770             MOVE 'C' TO CLOSEOUT-SW                              08777000
087780             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           08778000
087790             MOVE ' ' TO CLOSEOUT-SW                              08779000
087800             PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT        08780000
087810             MOVE ZEROS TO ACCRUED-INTEREST                       08781000
087820           ELSE                                                   08782000
087830             MOVE '9' TO HOLD-EARN-DISP                           08783000
087840             PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT   08784000
087850             PERFORM P5502-NO-CREDIT.                             08785000
087860     PERFORM P1665-NORM-DEBIT.                                    08786000
087870     ADD SAVE-ENCL-SW TO NUM-ENCLOSURES.                          08787000
087880     PERFORM P1760-CLOSEOUT-ACCT THRU P1769-EXIT.                 08788000
087890     GO TO P1010-TRANSACTION-EXIT.                                08789000
087900                                                                  08790000
087910 P1740-CLOSEOUT-TOO-SMALL.                                        08791000
087920     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            08792000
087930     MOVE SPACES TO STOCK-WORK.                                   08793000
087940     MOVE 29 TO HOLD-UI-REASON.                                   08794000
087950     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           08795000
087960     GO TO P1010-TRANSACTION-EXIT.                                08796000
087970                                                                  08797000
087980 P1745-CLOSEOUT-TOO-BIG.                                          08798000
087990     ADD DSDSTXL-AMOUNT TO UNPOST-AMT.                            08799000
088000     MOVE SPACES TO STOCK-WORK.                                   08800000
088010     MOVE 30 TO HOLD-UI-REASON.                                   08801000
088020     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           08802000
088030     GO TO P1010-TRANSACTION-EXIT.                                08803000
088040                                                                  08804000
088050 P1750-ADD-CLOSEOUT-INT-DROP.                                     08805000
088060     MOVE TEMP-CLOSEOUT-INT-DROP TO HOLD-EARNINGS.                08806000
088070     MOVE '9' TO HOLD-EARN-DISP.                                  08807000
088080     PERFORM P1770-REPORT-CLOSEOUT-EARN THRU P1779-EXIT.          08808000
088090     ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (11).        08809000
088100     ADD TEMP-CLOSEOUT-INT-DROP TO TDY-DROP-BY-IDENT (SUB13).     08810000
088110                                                                  08811000
088120 P1759-EXIT.                                                      08812000
088130     EXIT.                                                        08813000
088140                                                                  08814000
088150 P1760-CLOSEOUT-ACCT.                                             08815000
088160     IF CYCLE-THIS-STMT NOT = 1                                   08816000
088170         IF PROC-DSD                                              08817000
088180             MOVE 'C' TO SPEC-REPORT-ID                           08818000
088190           ELSE                                                   08819000
088200             IF SAV-ACCOUNT                                       08820000
088210                 MOVE 'S' TO SPEC-REPORT-ID.                      08821000
088220                                                                  08822000
088230     MOVE STAT-2X TO HOLD-OLD-STAT-2X                             08823000
088240     MOVE 091 TO STATUS-CODE.                                     08824000
088250     MOVE '09'    TO HOLD-NEW-STAT-2X                             08825000
088260     MOVE 'Y' TO HOLD-EXTRACT-IND.                                08826000
088270     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            08827000
088280                                                                  08828000
088290                                                                  08829000
088300     ADD 1 TO NUM-CLOSED-TODAY.                                   08830000
088310     MOVE PROC-CURR-DATE TO DATE-CLOSED                           08831000
088320                            DSDS-LAST-MAINT-DATE.                 08832000
088330     IF ODB-PLAN = SPACES                                         08833000
088340         NEXT SENTENCE                                            08834000
088350       ELSE                                                       08835000
088360         IF ODB-STATUS-CODE = '04'                                08836000
088370             NEXT SENTENCE                                        08837000
088380           ELSE                                                   08838000
088390             MOVE '4' TO HISTORY-CARD-IND                         08839000
088400             MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT            08840000
088410             MOVE '04' TO ODB-STATUS-CODE                         08841000
088420                          HOLD-NEW-ODB-STAT                       08842000
088430             MOVE PROC-CURR-DATE TO DATE-CANCELLED                08843000
088440             MOVE 'Y' TO HOLD-EXTRACT-IND                         08844000
088450             PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT 08845000
088460             PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.        08846000
088470     IF INV-PLAN = SPACES                                         08847000
088480         NEXT SENTENCE                                            08848000
088490       ELSE                                                       08849000
088500         MOVE INV-STATUS-CODE TO HOLD-OLD-INV-STAT                08850000
088510         MOVE '08' TO INV-STATUS-CODE                             08851000
088520                      HOLD-NEW-INV-STAT                           08852000
088530         MOVE 'Y' TO HOLD-EXTRACT-IND                             08853000
088540         PERFORM P8482-INV-STATUS-CODE-CHANGE THRU P8482-EXIT     08854000
088550         MOVE PROC-CURR-DATE TO INV-MATURE-DATE.                  08855000
088560     MOVE OD-ACCESS-LIMIT TO HOLD-OLD-ACCESS-LIMIT                08856000
088570     MOVE ZEROS TO OD-ACCESS-LIMIT                                08857000
088580                   HOLD-NEW-ACCESS-LIMIT                          08858000
088590     IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED           08859000
088600                  OR OA-SUSPENDED                                 08860000
088610         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              08861000
088620         MOVE 90 TO OD-ACCESS-CODE                                08862000
088630                    HOLD-NEW-ACCESS-CODE                          08863000
088640       ELSE                                                       08864000
088650         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              08865000
088660         MOVE 00 TO OD-ACCESS-CODE                                08866000
088670                    HOLD-NEW-ACCESS-CODE                          08867000
088680     END-IF.                                                      08868000
088690     MOVE 'Y' TO HOLD-EXTRACT-IND.                                08869000
088700     PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT.           08870000
088710     PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.           08871000
088720                                                                  08872000
088730     IF BR-CLSN-TIED GREATER THAN ZEROS                           08873000
088740         MOVE BR-CLSN-TIED TO HOLD-OLD-BR-CLSN-TIED               08874000
088750         MOVE ZEROS        TO HOLD-NEW-BR-CLSN-TIED               08875000
088760                              BR-CLSN-TIED                        08876000
088770         PERFORM P8496-BR-CLSN-TIED-CHANGE THRU P8496-EXIT        08877000
088780     END-IF.                                                      08878000
088790                                                                  08879000
088800     PERFORM P8795-CLOSE-ACCT-ANAL THRU P8799-EXIT.               08880000
088810                                                                  08881000
088820 P1769-EXIT.                                                      08882000
088830     EXIT.                                                        08883000
088840                                                                  08884000
088850 P1770-REPORT-CLOSEOUT-EARN.                                      08885000
088860     MOVE ' ' TO HOLD-DISP.                                       08886000
088870     MOVE ZEROS TO HOLD-CHARGES.                                  08887000
088880     MOVE ZEROS TO EXT-SERV-CHG-AMT.                              08888000
088890     PERFORM P7150-BUILD-IE-SC-JRNL THRU P7159-EXIT.              08889000
088900                                                                  08890000
088910 P1779-EXIT.                                                      08891000
088920     EXIT.                                                        08892000
088930                                                                  08893000
088940******************************************************************08894000
088950*C H E C K   A C C O U N T   W I T H H O L D I N G   S T A T U S *08895000
088960******************************************************************08896000
088970 P1800-CHK-WITHHOLD-STAT.                                         08897000
088980     MOVE SPACE          TO HOLD-WH-STATUS.                       08898000
088990     MOVE SPACE          TO U021-RETURN-CODE.                     08899000
089000     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    08900000
089010     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   08901000
089020     MOVE CIF-XREF-KEY   TO U021-FILE-KEY.                        08902000
089030     MOVE 'N'            TO U021-DEMOGRAPHICS-IND.                08903000
089040     CALL 'CIFU021'   USING CIFU021-PARAMETERS.                   08904000
089050     IF U021-GOOD-RETURN                                          08905000
089060         NEXT SENTENCE                                            08906000
089070       ELSE                                                       08907000
089080         GO TO P1809-EXIT.                                        08908000
089090     IF U021-CUST-WITHHOLD-TAX = '2' OR '3' OR '4' OR '5'         08909000
089100         MOVE 'W'        TO HOLD-WH-STATUS.                       08910000
089110                                                                  08911000
089120 P1809-EXIT.                                                      08912000
089130     EXIT.                                                        08913000
089140                                                                  08914000
089150******************************************************************08915000
089160*         P O S T   C Y C L E   E A R N I N G S   A N D          *08916000
089170*                                                                *08917000
089180*         W I T H H O L D I N G   T O   P A C E R I R S          *08918000
089190******************************************************************08919000
089200 P1810-POST-CYCLE-EARN-WH.                                        08920000
089210     IF NO-CLOSEOUT-IN-PROCESS                                    08921000
089220         MULTIPLY WITHHOLDING-PERCENT BY HOLD-EARNINGS            08922000
089230             GIVING HOLD-TAX-WITHHELD.                            08923000
089240     IF HOLD-TAX-WITHHELD = ZERO                                  08924000
089250         GO TO P1819-EXIT.                                        08925000
089260     MOVE +001 TO IRSPL-REQUEST-CODE.                             08926000
089270     IF IRSPL-GROUP-ID = +02                                      08927000
089280         GO TO P1812-CONT.                                        08928000
089290     IF PROC-DSD                                                  08929000
089300         EVALUATE TRUE                                            08930000
089310             WHEN NOW-ACCOUNT                                     08931000
089320                 MOVE +01 TO IRSPL-GROUP-ID                       08932000
089330                 GO TO P1812-CONT                                 08933000
089340             WHEN CMM-ACCOUNT                                     08934000
089350                 MOVE +03 TO IRSPL-GROUP-ID                       08935000
089360                 GO TO P1812-CONT                                 08936000
089370             WHEN IMM-ACCOUNT                                     08937000
089380                 MOVE +04 TO IRSPL-GROUP-ID                       08938000
089390                 GO TO P1812-CONT                                 08939000
089400             WHEN OTHER                                           08940000
089410                 GO TO P1812-CONT                                 08941000
089420         END-EVALUATE                                             08942000
089430       ELSE                                                       08943000
089440         EVALUATE TRUE                                            08944000
089450             WHEN CC-ACCOUNT                                      08945000
089460                 MOVE +02 TO IRSPL-GROUP-ID                       08946000
089470                 GO TO P1812-CONT                                 08947000
089480             WHEN OTHER                                           08948000
089490                 GO TO P1812-CONT                                 08949000
089500         END-EVALUATE                                             08950000
089510     END-IF.                                                      08951000
089520                                                                  08952000
089530 P1812-CONT.                                                      08953000
089540     MOVE +001 TO IRSPL-RECORD-TYPE.                              08954000
089550     MOVE ACCOUNT-NUMBER TO IRS-ACCT-NO-WK.                       08955000
089560     MOVE IRS-ACCT-NO-WORK TO IRSPL-ACCT-NBR.                     08956000
089570     MOVE SHORT-NAME TO IRSPL-SHORT-NAME.                         08957000
089580     MOVE HOLD-EARNINGS TO IRSPL-TX-AMOUNT.                       08958000
089590     MOVE HOLD-TAX-WITHHELD TO IRSPL-FED-WH-AMT.                  08959000
089600                                                                  08960000
089610 P1814-INSERT-IRS-PENDLST.                                        08961000
089620     EXEC SQL                                                     08962000
089630         INSERT INTO IRS.PENDLST                                  08963000
089640             (IRSPL_APPL_NBR,                                     08964000
089650              IRSPL_BANK_NBR,                                     08965000
089660              IRSPL_RECORD_TYPE,                                  08966000
089670              IRSPL_POST_DATE,                                    08967000
089680              IRSPL_EFF_DATE,                                     08968000
089690              IRSPL_EXTRACT_DATE,                                 08969000
089700              IRSPL_REQUEST_CODE,                                 08970000
089710              IRSPL_SOURCE_ID,                                    08971000
089720              IRSPL_GROUP_ID,                                     08972000
089730              IRSPL_ACCT_NBR,                                     08973000
089740              IRSPL_SHORT_NAME,                                   08974000
089750              IRSPL_EARN_TYPE,                                    08975000
089760              IRSPL_TX_AMOUNT,                                    08976000
089770              IRSPL_POST_YR_IND,                                  08977000
089780              IRSPL_ACCT_END_BAL,                                 08978000
089790              IRSPL_FED_WH_AMT,                                   08979000
089800              IRSPL_REMIT_IND,                                    08980000
089810              IRSPL_DEPOSIT_DATE)                                 08981000
089820         VALUES                                                   08982000
089830             (:IRSPL-APPL-NBR,                                    08983000
089840              :IRSPL-BANK-NBR,                                    08984000
089850              :IRSPL-RECORD-TYPE,                                 08985000
089860              :IRSPL-POST-DATE,                                   08986000
089870              :IRSPL-EFF-DATE,                                    08987000
089880              :IRSPL-EXTRACT-DATE,                                08988000
089890              :IRSPL-REQUEST-CODE,                                08989000
089900              :IRSPL-SOURCE-ID,                                   08990000
089910              :IRSPL-GROUP-ID,                                    08991000
089920              :IRSPL-ACCT-NBR,                                    08992000
089930              :IRSPL-SHORT-NAME,                                  08993000
089940              :IRSPL-EARN-TYPE,                                   08994000
089950              :IRSPL-TX-AMOUNT,                                   08995000
089960              :IRSPL-POST-YR-IND,                                 08996000
089970              :IRSPL-ACCT-END-BAL,                                08997000
089980              :IRSPL-FED-WH-AMT,                                  08998000
089990              :IRSPL-REMIT-IND,                                   08999000
090000              :IRSPL-DEPOSIT-DATE)                                09000000
090010     END-EXEC.                                                    09001000
090020     EVALUATE SQLCODE                                             09002000
090030         WHEN ZEROS                                               09003000
090040             CONTINUE                                             09004000
090050         WHEN +100                                                09005000
090060             DISPLAY 'IRS PENDLST INSERT DID NOT WORK'            09006000
090070                 UPON CONSOLE                                     09007000
090080             CALL 'CDCUT90' USING SQLCA                           09008000
090090             CALL 'CDCDUMP' USING BY CONTENT '2041'               09009000
090100         WHEN OTHER                                               09010000
090110             DISPLAY 'IRS PENDLST INSERT DID NOT WORK'            09011000
090120                 UPON CONSOLE                                     09012000
090130             CALL 'CDCUT90' USING SQLCA                           09013000
090140             CALL 'CDCDUMP' USING BY CONTENT '2042'               09014000
090150     END-EVALUATE.                                                09015000
090160     EXEC SQL                                                     09016000
090170         COMMIT                                                   09017000
090180     END-EXEC.                                                    09018000
090190     EVALUATE SQLCODE                                             09019000
090200         WHEN ZEROS                                               09020000
090210             CONTINUE                                             09021000
090220         WHEN OTHER                                               09022000
090230             DISPLAY 'IRS PENDLST COMMIT DID NOT WORK'            09023000
090240                 UPON CONSOLE                                     09024000
090250             CALL 'CDCUT90' USING SQLCA                           09025000
090260             CALL 'CDCDUMP' USING BY CONTENT '2043'               09026000
090270     END-EVALUATE.                                                09027000
090280                                                                  09028000
090290 P1819-EXIT.                                                      09029000
090300     EXIT.                                                        09030000
090310                                                                  09031000
090320******************************************************************09032000
090330*        P O S T   A D J U S T M E N T   E A R N I N G S         *09033000
090340*                                                                *09034000
090350*     A N D   W I T H H O L D I N G   T O   P A C E R I R S      *09035000
090360******************************************************************09036000
090370 P1820-POST-ADJ-EARN-WH.                                          09037000
090380     IF IRSPL-GROUP-ID = +02                                      09038000
090390         GO TO P1825-CONT.                                        09039000
090400     IF PROC-DSD                                                  09040000
090410         EVALUATE TRUE                                            09041000
090420             WHEN NOW-ACCOUNT                                     09042000
090430                 MOVE +01 TO IRSPL-GROUP-ID                       09043000
090440                 GO TO P1825-CONT                                 09044000
090450             WHEN CMM-ACCOUNT                                     09045000
090460                 MOVE +03 TO IRSPL-GROUP-ID                       09046000
090470                 GO TO P1825-CONT                                 09047000
090480             WHEN IMM-ACCOUNT                                     09048000
090490                 MOVE +04 TO IRSPL-GROUP-ID                       09049000
090500                 GO TO P1825-CONT                                 09050000
090510             WHEN OTHER                                           09051000
090520                 GO TO P1825-CONT                                 09052000
090530         END-EVALUATE                                             09053000
090540       ELSE                                                       09054000
090550         EVALUATE TRUE                                            09055000
090560             WHEN CC-ACCOUNT                                      09056000
090570                 MOVE +02 TO IRSPL-GROUP-ID                       09057000
090580                 GO TO P1825-CONT                                 09058000
090590             WHEN OTHER                                           09059000
090600                 GO TO P1825-CONT                                 09060000
090610         END-EVALUATE                                             09061000
090620     END-IF.                                                      09062000
090630                                                                  09063000
090640 P1825-CONT.                                                      09064000
090650     MOVE +002 TO IRSPL-RECORD-TYPE.                              09065000
090660     MOVE ACCOUNT-NUMBER TO IRS-ACCT-NO-WK.                       09066000
090670     MOVE IRS-ACCT-NO-WORK TO IRSPL-ACCT-NBR.                     09067000
090680     MOVE SHORT-NAME TO IRSPL-SHORT-NAME.                         09068000
090690     MOVE DSDSTXL-AMOUNT TO IRSPL-TX-AMOUNT.                      09069000
090700     MOVE ZEROS TO IRSPL-FED-WH-AMT.                              09070000
090710     PERFORM P1814-INSERT-IRS-PENDLST THRU P1819-EXIT.            09071000
090720                                                                  09072000
090730 P1829-EXIT.                                                      09073000
090740     EXIT.                                                        09074000
090750                                                                  09075000
090760******************************************************************09076000
090770*             O . D . B .  T R A N S A C T I O N S               *09077000
090780******************************************************************09078000
090790 P2000-ODB-TX.                                                    09079000
090800     IF ODB-PLAN = SPACES                                         09080000
090810         GO TO P1005-UNPOSTED-TX.                                 09081000
090820     IF DSDSTXL-CODE LESS THAN 683                                09082000
090830         GO TO P2200-ODB-CREDIT.                                  09083000
090840     IF DSDSTXL-CODE LESS THAN 686                                09084000
090850         GO TO P2100-ODB-DEBIT.                                   09085000
090860     IF DSDSTXL-CODE = 689                                        09086000
090870         GO TO P2300-CHK-689.                                     09087000
090880                                                                  09088000
090890 P2030-INV-ODB-TX.                                                09089000
090900     MOVE SPACES TO STOCK-WORK.                                   09090000
090910**********************************   INVALID ODB TX - UNPOSTED   *09091000
090920     MOVE 17 TO HOLD-UI-REASON.                                   09092000
090930     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           09093000
090940     GO TO P1010-TRANSACTION-EXIT.                                09094000
090950                                                                  09095000
090960******************************************************************09096000
090970*                    O D B   D E B I T                           *09097000
090980******************************************************************09098000
090990 P2100-ODB-DEBIT.                                                 09099000
091000     IF ODB-CLOSED-DELETE                                         09100000
091010         MOVE SPACES TO STOCK-WORK                                09101000
091020         MOVE 16 TO HOLD-UI-REASON                                09102000
091030         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        09103000
091040*************************  O.D.B. CLOSED STATUS                  *09104000
091050         GO TO P1010-TRANSACTION-EXIT.                            09105000
091060                                                                  09106000
091070 P2110-VALID-ODB-DEBIT.                                           09107000
091080     IF DSDSTXL-CODE = 683                                        09108000
091090         NEXT SENTENCE                                            09109000
091100       ELSE                                                       09110000
091110         GO TO P2120-POST-ODB-DEBIT.                              09111000
091120     SUBTRACT ODB-LOAN-BAL FROM AUTH-CREDIT-LIMIT                 09112000
091130         GIVING TEMP-CR-AVAIL.                                    09113000
091140     IF TEMP-CR-AVAIL LESS THAN DSDSTXL-AMOUNT                    09114000
091150         NEXT SENTENCE                                            09115000
091160       ELSE                                                       09116000
091170         GO TO P2120-POST-ODB-DEBIT.                              09117000
091180************************* ODB MANUAL ADVANCE OVER CREDIT LINE    *09118000
091190     MOVE SPACES TO STOCK-WORK.                                   09119000
091200     MOVE 19 TO HOLD-UI-REASON.                                   09120000
091210     PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT.           09121000
091220     GO TO P1010-TRANSACTION-EXIT.                                09122000
091230                                                                  09123000
091240 P2120-POST-ODB-DEBIT.                                            09124000
091250     ADD DSDSTXL-AMOUNT TO ODB-LOAN-BAL.                          09125000
091260     MOVE DSDSTXL-CODE TO LAST-TX-CODE.                           09126000
091270     MOVE DSDSTXL-EFFECT-DT TO LAST-ADV-DATE.                     09127000
091280     MOVE DSDSTXL-AMOUNT TO LAST-ADV-AMT.                         09128000
091290     ADD DSDSTXL-AMOUNT TO AMT-ODB-ADV-ON-STMT.                   09129000
091300     IF DSDSTXL-CODE = 685                                        09130000
091310         NEXT SENTENCE                                            09131000
091320       ELSE                                                       09132000
091330         ADD 1 TO NUM-ADVANCES-YTD.                               09133000
091340     MOVE '1' TO ODB-ACTIVITY-SW.                                 09134000
091350     IF DSDSTXL-CODE = 683                                        09135000
091360         MOVE 1 TO ACTIVITY-TDY                                   09136000
091370         MOVE OSB-DESC-0007-A TO DSDSTXL-CO-DESC                  09137000
091380         MOVE OSB-DESC-0007-B TO DSDSTXL-DESC                     09138000
091390         GO TO P2130-POSTED-ODB.                                  09139000
091400     IF DSDSTXL-CODE = 684                                        09140000
091410         MOVE 1 TO ACTIVITY-TDY                                   09141000
091420         MOVE OSB-DESC-0008-A TO DSDSTXL-CO-DESC                  09142000
091430         MOVE OSB-DESC-0008-B TO DSDSTXL-DESC                     09143000
091440         ADD 1 TO NUM-TIMES-OVER-LINE                             09144000
091450         GO TO P2130-POSTED-ODB.                                  09145000
091460     IF DSDSTXL-CODE = 685                                        09146000
091470         MOVE OSB-DESC-0009-A TO DSDSTXL-CO-DESC                  09147000
091480         MOVE OSB-DESC-0009-B TO DSDSTXL-DESC                     09148000
091490         GO TO P2130-POSTED-ODB.                                  09149000
091500                                                                  09150000
091510 P2130-POSTED-ODB.                                                09151000
091520     ADD DSDSTXL-ENCL-TYPE TO NUM-ENCLOSURES.                     09152000
091530     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW.                      09153000
091540     IF DSDSTXL-CODE = 689                                        09154000
091550         MOVE ODB-MIN-PAY-KEY TO DSDSTXL-SORT-KEY                 09155000
091560       ELSE                                                       09156000
091570         MOVE ODB-PAY-ADV-KEY TO DSDSTXL-SORT-KEY.                09157000
091580     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       09158000
091590     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     09159000
091600     IF EXCESS-ODB-PAYMENT = ZERO                                 09160000
091610         GO TO P1010-TRANSACTION-EXIT.                            09161000
091620                                                                  09162000
091630 P2150-EXCESS-ODB-PAYMENT.                                        09163000
091640     PERFORM P8205-TX-INIT-2 THRU P8209-EXIT.                     09164000
091650     MOVE 540 TO DSDSTXL-CODE.                                    09165000
091660     MOVE OSB-DESC-0062-A TO DSDSTXL-CO-DESC.                     09166000
091670     MOVE OSB-DESC-0062-B TO DSDSTXL-DESC.                        09167000
091680     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       09168000
091690     MOVE EXCESS-ODB-PAYMENT TO DSDSTXL-AMOUNT.                   09169000
091700     MOVE ZEROS TO EXCESS-ODB-PAYMENT.                            09170000
091710     MOVE 'XSP' TO PJ-HOLD-CODE.                                  09171000
091720     ADD 1 TO NUM-ODB-EXCESS-PMNT                                 09172000
091730              GEN-CREDIT-CNT.                                     09173000
091740     ADD DSDSTXL-AMOUNT TO AMT-ODB-EXCESS-PMNT                    09174000
091750                           ODB-EXCESS-PMNT                        09175000
091760                           GEN-CREDIT-AMT.                        09176000
091770     PERFORM P1325-NORM-CR-2.                                     09177000
091780     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            09178000
091790     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       09179000
091800     MOVE 14 TO HOLD-REASON-CODE.                                 09180000
091810     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            09181000
091820     GO TO P1010-TRANSACTION-EXIT.                                09182000
091830                                                                  09183000
091840******************************************************************09184000
091850*                    O D B   C R E D I T                         *09185000
091860******************************************************************09186000
091870 P2200-ODB-CREDIT.                                                09187000
091880     IF DSDSTXL-CODE = 682                                        09188000
091890         MOVE SPACES TO STOCK-WORK                                09189000
091900**********************************   INVALID ODB TX - UNPOSTED   *09190000
091910         MOVE 17 TO HOLD-UI-REASON                                09191000
091920         PERFORM P7210-BUILD-UNPOSTED-ITEM THRU P7219-EXIT        09192000
091930         GO TO P1010-TRANSACTION-EXIT.                            09193000
091940     IF DSDSTXL-AMOUNT LESS THAN ODB-LOAN-BAL                     09194000
091950         GO TO P2240-POST-ODB-CREDIT1.                            09195000
091960     COMPUTE TEMP-LOAN-BAL =                                      09196000
091970         ODB-LOAN-BAL +                                           09197000
091980         ODB-ACCUM-CR-LIFE +                                      09198000
091990         MONTHLY-ACCUM-INT.                                       09199000
092000     IF TEMP-LOAN-BAL = ZERO                                      09200000
092010         MOVE DSDSTXL-AMOUNT TO EXCESS-ODB-PAYMENT                09201000
092020         GO TO P2150-EXCESS-ODB-PAYMENT.                          09202000
092030     IF DSDSTXL-AMOUNT = TEMP-LOAN-BAL                            09203000
092040         GO TO P2220-POST-FINANCE-CHG1.                           09204000
092050     IF DSDSTXL-AMOUNT GREATER THAN TEMP-LOAN-BAL                 09205000
092060         PERFORM P3100-POST-FIN-CHRG THRU P3109-EXIT              09206000
092070         PERFORM P3150-POST-CR-LIFE THRU P3159-EXIT               09207000
092080         SUBTRACT TEMP-LOAN-BAL FROM DSDSTXL-AMOUNT               09208000
092090             GIVING EXCESS-ODB-PAYMENT                            09209000
092100         MOVE TEMP-LOAN-BAL TO DSDSTXL-AMOUNT                     09210000
092110         GO TO P2240-POST-ODB-CREDIT1.                            09211000
092120     SUBTRACT DSDSTXL-AMOUNT FROM TEMP-LOAN-BAL                   09212000
092130         GIVING TEMP-EXCESS.                                      09213000
092140     IF TEMP-EXCESS GREATER THAN +1.00                            09214000
092150         GO TO P2220-POST-FINANCE-CHG1.                           09215000
092160     IF MONTHLY-ACCUM-INT GREATER THAN TEMP-EXCESS                09216000
092170         SUBTRACT TEMP-EXCESS FROM MONTHLY-ACCUM-INT              09217000
092180         ADD TEMP-EXCESS TO TDY-DROP-BY-PLAN-ODB (SUB10)          09218000
092190                            TDY-DROP-BY-PLAN-ODB (11)             09219000
092200                            AMT-FIN-CHG-DROP                      09220000
092210         MOVE TEMP-EXCESS       TO OBGL-DROP-INT-AMT              09221000
092220         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          09222000
092230         ADD 1 TO NUM-FIN-CHG-DROP                                09223000
092240         GO TO P2220-POST-FINANCE-CHG1.                           09224000
092250     SUBTRACT MONTHLY-ACCUM-INT FROM TEMP-EXCESS.                 09225000
092260     ADD MONTHLY-ACCUM-INT TO TDY-DROP-BY-PLAN-ODB (SUB10)        09226000
092270                              TDY-DROP-BY-PLAN-ODB (11)           09227000
092280                              AMT-FIN-CHG-DROP.                   09228000
092290     MOVE MONTHLY-ACCUM-INT TO OBGL-DROP-INT-AMT                  09229000
092300     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT              09230000
092310     ADD 1 TO NUM-FIN-CHG-DROP.                                   09231000
092320     MOVE ZEROS TO MONTHLY-ACCUM-INT                              09232000
092330                   ODB-ACCRUED-F-C.                               09233000
092340     SUBTRACT TEMP-EXCESS FROM ODB-ACCUM-CR-LIFE.                 09234000
092350     ADD TEMP-EXCESS TO AMT-CR-LIFE-DROP.                         09235000
092360     ADD 1 TO NUM-CR-LIFE-DROP.                                   09236000
092370     GO TO P2230-POST-CR-LIFE.                                    09237000
092380                                                                  09238000
092390 P2220-POST-FINANCE-CHG1.                                         09239000
092400     PERFORM P3100-POST-FIN-CHRG THRU P3109-EXIT.                 09240000
092410                                                                  09241000
092420 P2230-POST-CR-LIFE.                                              09242000
092430     PERFORM P3150-POST-CR-LIFE THRU P3159-EXIT.                  09243000
092440                                                                  09244000
092450 P2240-POST-ODB-CREDIT1.                                          09245000
092460     IF AMT-PAST-DUE = ZERO                                       09246000
092470         GO TO P2310-POST-ODB-CREDIT2.                            09247000
092480     IF AMT-PAST-DUE NOT GREATER THAN DSDSTXL-AMOUNT              09248000
092490         NEXT SENTENCE                                            09249000
092500       ELSE                                                       09250000
092510         GO TO P2250-REDUCE-DELINQ1.                              09251000
092520     SUBTRACT AMT-PAST-DUE FROM ODB-MAN-PYMT-ACCUM.               09252000
092530     MOVE ZEROS TO AMT-PAST-DUE.                                  09253000
092540     MOVE ZEROS TO NUM-PAST-DUE-PMNTS.                            09254000
092550     MOVE ZEROS TO NUM-DAYS-DELQ.                                 09255000
092560     MOVE 0 TO FIRST-NOTICE-SW.                                   09256000
092570     MOVE 0 TO SECOND-NOTICE-SW.                                  09257000
092580     GO TO P2310-POST-ODB-CREDIT2.                                09258000
092590                                                                  09259000
092600 P2250-REDUCE-DELINQ1.                                            09260000
092610     IF NUM-PAST-DUE-PMNTS IS GREATER THAN 1                      09261000
092620         GO TO P2270-REDUCE-PART1.                                09262000
092630                                                                  09263000
092640 P2260-REDUCE-AMT-DUE.                                            09264000
092650     SUBTRACT DSDSTXL-AMOUNT FROM ODB-MAN-PYMT-ACCUM.             09265000
092660     SUBTRACT DSDSTXL-AMOUNT FROM AMT-PAST-DUE.                   09266000
092670     GO TO P2310-POST-ODB-CREDIT2.                                09267000
092680                                                                  09268000
092690 P2270-REDUCE-PART1.                                              09269000
092700     MOVE DSDSTXL-AMOUNT TO TEMP-TX-PAYMENT.                      09270000
092710     DIVIDE NUM-PAST-DUE-PMNTS INTO 1.000                         09271000
092720         GIVING PAYMENT-FRACTION ROUNDED.                         09272000
092730     MULTIPLY AMT-PAST-DUE BY PAYMENT-FRACTION                    09273000
092740         GIVING PAYMENT-DOLLARS ROUNDED.                          09274000
092750     MOVE PAYMENT-DOLLARS TO TEMP-PAYMENT.                        09275000
092760                                                                  09276000
092770 P2280-REDUCE-PART2.                                              09277000
092780     IF TEMP-TX-PAYMENT LESS THAN TEMP-PAYMENT                    09278000
092790         GO TO P2260-REDUCE-AMT-DUE.                              09279000
092800     IF NUM-PAST-DUE-PMNTS = 0                                    09280000
092810         NEXT SENTENCE                                            09281000
092820       ELSE                                                       09282000
092830         SUBTRACT 1 FROM NUM-PAST-DUE-PMNTS.                      09283000
092840     IF NUM-DAYS-DELQ IS GREATER THAN 030                         09284000
092850         SUBTRACT 030 FROM NUM-DAYS-DELQ                          09285000
092860       ELSE                                                       09286000
092870         MOVE ZEROS TO NUM-DAYS-DELQ.                             09287000
092880     IF NUM-DAYS-DELQ IS LESS THAN 20                             09288000
092890         MOVE ZEROS TO SECOND-NOTICE-SW.                          09289000
092900     IF NUM-DAYS-DELQ IS LESS THAN 10                             09290000
092910         MOVE ZEROS TO FIRST-NOTICE-SW.                           09291000
092920     SUBTRACT TEMP-PAYMENT FROM TEMP-TX-PAYMENT.                  09292000
092930     GO TO P2280-REDUCE-PART2.                                    09293000
092940                                                                  09294000
092950 P2300-CHK-689.                                                   09295000
092960     IF DSDSTXL-AMOUNT GREATER THAN ODB-LOAN-BAL                  09296000
092970         SUBTRACT ODB-LOAN-BAL FROM DSDSTXL-AMOUNT                09297000
092980             GIVING EXCESS-ODB-PAYMENT                            09298000
092990         MOVE ODB-LOAN-BAL TO DSDSTXL-AMOUNT.                     09299000
093000                                                                  09300000
093010 P2310-POST-ODB-CREDIT2.                                          09301000
093020     SUBTRACT DSDSTXL-AMOUNT FROM ODB-LOAN-BAL.                   09302000
093030     MOVE DSDSTXL-EFFECT-DT TO LAST-PMNT-DATE.                    09303000
093040     MOVE DSDSTXL-AMOUNT TO LAST-PMNT-AMT.                        09304000
093050     ADD DSDSTXL-AMOUNT TO AMT-ODB-PAY-ON-STMT.                   09305000
093060     MOVE '1' TO ODB-ACTIVITY-SW.                                 09306000
093070     IF DSDSTXL-CODE = 689                                        09307000
093080         GO TO P2130-POSTED-ODB.                                  09308000
093090     ADD DSDSTXL-AMOUNT TO ODB-MAN-PYMT-ACCUM.                    09309000
093100     IF DSDSTXL-CODE = 680                                        09310000
093110         MOVE 1 TO ACTIVITY-TDY                                   09311000
093120         MOVE OSB-DESC-0010-A TO DSDSTXL-CO-DESC                  09312000
093130         MOVE OSB-DESC-0010-B TO DSDSTXL-DESC                     09313000
093140       ELSE                                                       09314000
093150         MOVE OSB-DESC-0011-A TO DSDSTXL-CO-DESC                  09315000
093160         MOVE OSB-DESC-0011-B TO DSDSTXL-DESC.                    09316000
093170     GO TO P2130-POSTED-ODB.                                      09317000
093180                                                                  09318000
093190******************************************************************09319000
093200*        A U T O M A T I C   A D V A N C E   R O U T I N E       *09320000
093210******************************************************************09321000
093220 P2450-NEED-ADVANCE.                                              09322000
093230     IF ODB-NORMAL OR ODB-MANUAL-PAY                              09323000
093240         NEXT SENTENCE                                            09324000
093250       ELSE                                                       09325000
093260         GO TO P2520-ADV-EXIT.                                    09326000
093270     SUBTRACT ODB-LOAN-BAL FROM AUTH-CREDIT-LIMIT                 09327000
093280         GIVING TEMP-CR-AVAIL.                                    09328000
093290     IF TEMP-CR-AVAIL LESS THAN +.01                              09329000
093300         GO TO P2520-ADV-EXIT.                                    09330000
093310     MOVE ZEROS TO HOLD-ADVANCE-AMT.                              09331000
093320     IF ADVANCE-EXACT                                             09332000
093330         PERFORM P2550-ADV-EXACT-AMT THRU P2580-EXIT              09333000
093340         GO TO P2520-ADV-EXIT.                                    09334000
093350                                                                  09335000
093360 P2460-ADV-LOOP.                                                  09336000
093370     IF TEMP-CR-AVAIL GREATER THAN +100.00                        09337000
093380         NEXT SENTENCE                                            09338000
093390       ELSE                                                       09339000
093400         GO TO P2480-ODB-DDA-SUM-2.                               09340000
093410                                                                  09341000
093420 P2470-ODB-DDA-SUM-1.                                             09342000
093430     ADD TEMP-CURR-BAL                                            09343000
093440         HOLD-ADVANCE-AMT                                         09344000
093450         +100.00                                                  09345000
093460         GIVING TEMP-SUM.                                         09346000
093470     IF TEMP-SUM LESS THAN TEMP-TX-AMT                            09347000
093480         NEXT SENTENCE                                            09348000
093490       ELSE                                                       09349000
093500         GO TO P2500-USE-100.                                     09350000
093510     SUBTRACT +100.00 FROM TEMP-CR-AVAIL.                         09351000
093520     ADD +100.00 TO HOLD-ADVANCE-AMT.                             09352000
093530     GO TO P2460-ADV-LOOP.                                        09353000
093540                                                                  09354000
093550 P2480-ODB-DDA-SUM-2.                                             09355000
093560     ADD TEMP-CURR-BAL                                            09356000
093570         HOLD-ADVANCE-AMT                                         09357000
093580         TEMP-CR-AVAIL                                            09358000
093590         GIVING TEMP-SUM.                                         09359000
093600     IF POST-OD                                                   09360000
093610         GO TO P2510-ODB-DDA-SUM-2-POST-OD.                       09361000
093620     IF TEMP-SUM LESS THAN TEMP-TX-AMT                            09362000
093630         GO TO P2520-ADV-EXIT.                                    09363000
093640     ADD TEMP-CR-AVAIL TO HOLD-ADVANCE-AMT.                       09364000
093650                                                                  09365000
093660 P2490-ACCUM-THIS-ADV.                                            09366000
093670     ADD HOLD-ADVANCE-AMT TO ADVANCE-TX-AMT                       09367000
093680                             ODB-LOAN-BAL                         09368000
093690                             TEMP-CURR-BAL.                       09369000
093700     GO TO P2520-ADV-EXIT.                                        09370000
093710                                                                  09371000
093720 P2500-USE-100.                                                   09372000
093730     ADD +100.00 TO HOLD-ADVANCE-AMT.                             09373000
093740     GO TO P2490-ACCUM-THIS-ADV.                                  09374000
093750                                                                  09375000
093760 P2510-ODB-DDA-SUM-2-POST-OD.                                     09376000
093770     IF TEMP-SUM LESS THAN TEMP-TX-AMT                            09377000
093780         MOVE 02 TO HOLD-REASON-CODE                              09378000
093790         PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT         09379000
093800         GO TO P2520-ADV-EXIT.                                    09380000
093810     ADD TEMP-CR-AVAIL TO HOLD-ADVANCE-AMT.                       09381000
093820     GO TO P2490-ACCUM-THIS-ADV.                                  09382000
093830                                                                  09383000
093840 P2520-ADV-EXIT.                                                  09384000
093850     EXIT.                                                        09385000
093860                                                                  09386000
093870 P2550-ADV-EXACT-AMT.                                             09387000
093880     SUBTRACT TEMP-CURR-BAL FROM TEMP-TX-AMT GIVING TEMP-SUM.     09388000
093890     IF POST-OD                                                   09389000
093900         GO TO P2560-ODB-DDA-ADV-POST-OD.                         09390000
093910     IF TEMP-CR-AVAIL LESS THAN TEMP-SUM                          09391000
093920         GO TO P2580-EXIT.                                        09392000
093930     MOVE TEMP-SUM TO HOLD-ADVANCE-AMT.                           09393000
093940     GO TO P2570-ACCUM-THIS-ADV.                                  09394000
093950                                                                  09395000
093960 P2560-ODB-DDA-ADV-POST-OD.                                       09396000
093970     IF TEMP-CR-AVAIL LESS THAN TEMP-SUM                          09397000
093980         MOVE 02 TO HOLD-REASON-CODE                              09398000
093990         PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT         09399000
094000         GO TO P2580-EXIT.                                        09400000
094010     MOVE TEMP-SUM TO HOLD-ADVANCE-AMT.                           09401000
094020                                                                  09402000
094030 P2570-ACCUM-THIS-ADV.                                            09403000
094040     ADD HOLD-ADVANCE-AMT TO ADVANCE-TX-AMT                       09404000
094050                             ODB-LOAN-BAL                         09405000
094060                             TEMP-CURR-BAL.                       09406000
094070 P2580-EXIT.                                                      09407000
094080     EXIT.                                                        09408000
094090                                                                  09409000
094100 P2590-NEED-ML-HELOC-ADVANCE.                                     09410000
094110     IF DSDSTXL-CODE = 741                                        09411000
094120         GO TO P2590-EXIT                                         09412000
094130     END-IF.                                                      09413000
094140                                                                  09414000
094150     SUBTRACT TEMP-CURR-BAL FROM TEMP-TX-AMT GIVING TEMP-SUM.     09415000
094160                                                                  09416000
094170**** CALL ML02003 - WHEN GET ACCOUNT INFORMATION FROM THE         09417000
094180****                WEB SERVICE - FISERVE                         09418000
094190     IF ML02003-SW = 'Y'                                          09419000
094200         CONTINUE                                                 09420000
094210     ELSE                                                         09421000
094220         PERFORM P2591-CALL-ML02003 THRU P2591-EXIT               09422000
094230         MOVE 'Y' TO ML02003-SW                                   09423000
094240     END-IF.                                                      09424000
094250                                                                  09425000
094260     IF TEMP-HE-CR-AVAIL LESS THAN TEMP-SUM                       09426000
094270         GO TO P2590-EXIT                                         09427000
094280     END-IF.                                                      09428000
094290                                                                  09429000
094300     MOVE TEMP-SUM TO HOLD-HE-ADV-AMT                             09430000
094310                                                                  09431000
094320     ADD HOLD-HE-ADV-AMT   TO HE-ADVANCE-TX-AMT                   09432000
094330                              TEMP-CURR-BAL.                      09433000
094340     SUBTRACT TEMP-SUM          FROM TEMP-HE-CR-AVAIL             09434000
094350                              GIVING TEMP-HE-CR-AVAIL.            09435000
094360                                                                  09436000
094370 P2590-EXIT.                                                      09437000
094380     EXIT.                                                        09438000
094390                                                                  09439000
094400 P2591-CALL-ML02003.                                              09440000
094410     INITIALIZE ML02003-PARAMETERS.                               09441000
094420     IF HELOC-FIRST-TIME-SW = 'Y'                                 09442000
094430         MOVE 'F' TO ML02003-PROCESS-SW                           09443000
094440         MOVE 'N' TO HELOC-FIRST-TIME-SW                          09444000
094450     END-IF.                                                      09445000
094460                                                                  09446000
094470     MOVE 'DSDS100'                   TO ML02003-SOURCE-PROG.     09447000
094480     MOVE PROC-BK-NO                  TO ML02003-BANK-NBR.        09448000
094490     MOVE ML-HELOC-NBR                TO ML02003-ACCT-NBR.        09449000
094500     CALL 'ML02003' USING ML02003-PARAMETERS.                     09450000
094510     EVALUATE ML02003-STATUS-CODE                                 09451000
094520         WHEN SPACES                                              09452000
094530           CONTINUE                                               09453000
094540         WHEN OTHER                                               09454000
094550           DISPLAY 'CDCINFO (DSDS100) ML02003-STATUS-CODE '       09455000
094560                    PROC-BK-NO                                    09456000
094570              ' * ' ML-HELOC-NBR                                  09457000
094580              ' * ' ML02003-STATUS-CODE                           09458000
094590           GO TO P2591-SELECT-MLSDLYST                            09459000
094600     END-EVALUATE.                                                09460000
094610     DISPLAY 'CDCINFO (DSDS100) AVAIL-CREDIT '                    09461000
094620              PROC-BK-NO                                          09462000
094630        ' * ' ML-HELOC-NBR                                        09463000
094640        ' * ' ML02003-AVAIL-CREDIT.                               09464000
094650                                                                  09465000
094660     IF ML02003-FREEZE-REASON GREATER THAN SPACES                 09466000
094670         DISPLAY 'CDCINFO (DSDS100) ACCOUNT FROZEN ' ML-HELOC-NBR 09467000
094680         MOVE ZEROS TO TEMP-HE-CR-AVAIL                           09468000
094690     ELSE                                                         09469000
094700         MOVE ML02003-AVAIL-CREDIT TO TEMP-HE-CR-AVAIL            09470000
094710     END-IF.                                                      09471000
094720     GO TO P2591-EXIT.                                            09472000
094730                                                                  09473000
094740 P2591-SELECT-MLSDLYST.                                           09474000
094750     MOVE ML-HELOC-NBR     TO MLS-ACNT-REM.                       09475000
094760     EXEC SQL                                                     09476000
094770         SELECT                                                   09477000
094780             MLS_ACNT_REM,                                        09478000
094790             MLS_LN_FREEZE_CD,                                    09479000
094800             MLS_CTS_AVAIL_BAL                                    09480000
094810         INTO                                                     09481000
094820            :MLS-ACNT-REM,                                        09482000
094830            :MLS-LN-FREEZE-CD,                                    09483000
094840            :MLS-CTS-AVAIL-BAL                                    09484000
094850         FROM MLS.DLYSTRIP                                        09485000
094860         WHERE MLS_ACNT_REM = :MLS-ACNT-REM                       09486000
094870     END-EXEC.                                                    09487000
094880     EVALUATE SQLCODE                                             09488000
094890         WHEN ZEROS                                               09489000
094900             CONTINUE                                             09490000
094910         WHEN +100                                                09491000
094920             DISPLAY 'CDCINFO (DSDS100) ACCOUNT NOT FOUND ON '    09492000
094930                     'MLS.DLYSTRIP ' MLS-ACNT-REM                 09493000
094940             MOVE ZEROS TO MLS-CTS-AVAIL-BAL                      09494000
094950         WHEN OTHER                                               09495000
094960             CALL 'CDCUT90' USING SQLCA                           09496000
094970             CALL 'CDCDUMP' USING BY CONTENT '2044'               09497000
094980     END-EVALUATE.                                                09498000
094990                                                                  09499000
095000     IF MLS-LN-FREEZE-CD GREATER THAN SPACES                      09500000
095010         DISPLAY 'CDCINFO (DSDS100) ACCOUNT FROZEN ' ML-HELOC-NBR 09501000
095020         MOVE ZEROS TO TEMP-HE-CR-AVAIL                           09502000
095030     ELSE                                                         09503000
095040         MOVE MLS-CTS-AVAIL-BAL TO TEMP-HE-CR-AVAIL               09504000
095050     END-IF.                                                      09505000
095060 P2591-EXIT.                                                      09506000
095070     EXIT.                                                        09507000
095080                                                                  09508000
095090 P2600-NEED-CLSN-BR-ADVANCE.                                      09509000
095100     SET CLSN-BR-POST-TX-YES TO TRUE.                             09510000
095110                                                                  09511000
095120     IF TEMP-TX-AMT GREATER THAN TEMP-CURR-BAL                    09512000
095130         COMPUTE TEMP-SUM  = TEMP-TX-AMT - TEMP-CURR-BAL          09513000
095140     ELSE                                                         09514000
095150         MOVE TEMP-TX-AMT TO TEMP-SUM                             09515000
095160     END-IF.                                                      09516000
095170                                                                  09517000
095180     IF CLSN-BR-WORK-AVAIL-BAL GREATER THAN TEMP-TX-AMT           09518000
095190         GO TO P2601-CONTINUE                                     09519000
095200     END-IF                                                       09520000
095210     IF CLSN-BR-WORK-AVAIL-BAL LESS THAN TEMP-SUM                 09521000
095220         SET CLSN-BR-POST-TX-NO TO TRUE                           09522000
095230         GO TO P2601-EXIT                                         09523000
095240     END-IF.                                                      09524000
095250                                                                  09525000
095260 P2601-CONTINUE.                                                  09526000
095270     ADD  TEMP-SUM              TO CLSN-BR-ADV-TX-AMT             09527000
095280                                   TEMP-CURR-BAL.                 09528000
095290     SUBTRACT TEMP-SUM          FROM CLSN-BR-WORK-AVAIL-BAL.      09529000
095300 P2601-EXIT.                                                      09530000
095310     EXIT.                                                        09531000
095320                                                                  09532000
095330 P2602-SELECT-CLST34.                                             09533000
095340** CHECK THE DDA HAS THE CLSN TIED TO IT                          09534000
095350     MOVE BR-CLSN-TIED           TO WORK-CLSN-NUM.                09535000
095360     MOVE PROC-BK-NO             TO CL50-BANK-NBR.                09536000
095370     MOVE CLSN-CUST-NUM          TO CL50-CUST-NBR.                09537000
095380     MOVE CLSN-LOAN-NUM          TO CL50-LOAN-NBR.                09538000
095390     EXEC SQL                                                     09539000
095400         SELECT                                                   09540000
095410             CL50_VALUE                                           09541000
095420         INTO                                                     09542000
095430            :CL50-VALUE                                           09543000
095440         FROM CLS.CLST50_USERFIELDS                               09544000
095450         WHERE                                                    09545000
095460               CL50_BANK_NBR   = :CL50-BANK-NBR                   09546000
095470           AND CL50_CUST_NBR   = :CL50-CUST-NBR                   09547000
095480           AND CL50_LOAN_NBR   = :CL50-LOAN-NBR                   09548000
095490           AND CL50_PART_NBR   = 0                                09549000
095500           AND CL50_COLL_FORM  = 0                                09550000
095510           AND CL50_LITERAL_ID = 'CODES11004L'                    09551000
095520     END-EXEC.                                                    09552000
095530                                                                  09553000
095540     EVALUATE SQLCODE                                             09554000
095550         WHEN ZEROS                                               09555000
095560             MOVE CL50-VALUE-TEXT (1:9) TO CLSN-BR-DDA-NBR-X      09556000
095570             CALL 'CDCUT21' USING LENGTH-09                       09557000
095580                                  CLSN-BR-DDA-NBR-X               09558000
095590             CALL 'CDCUT70' USING BY CONTENT LENGTH OF            09559000
095600                                     CLSN-BR-DDA-NBR-X            09560000
095610                                  BY REFERENCE CLSN-BR-DDA-NBR-X  09561000
095620         WHEN +100                                                09562000
095630             MOVE ZEROS                 TO CLSN-BR-DDA-NBR        09563000
095640         WHEN OTHER                                               09564000
095650             CALL 'CDCUT90' USING SQLCA                           09565000
095660             CALL 'CDCDUMP' USING BY CONTENT '2045'               09566000
095670     END-EVALUATE.                                                09567000
095680     IF CLSN-BR-DDA-NBR = DSDS-ACCOUNT-NO                         09568000
095690         MOVE BR-CLSN-TIED TO HOLD-BR-CLSN-TIED                   09569000
095700     ELSE                                                         09570000
095710         DISPLAY 'CDCINFO (DSDS100) CLS50 DDA ACCT DOES NOT '     09571000
095720           'MATCH DSDS MASTER - MOVE ZEROS TO HOLD-BR-CLSN-TIED'  09572000
095730         DISPLAY '         BANK ' CL50-BANK-NBR                   09573000
095740                 ' DSDS ACCT NO ' DSDS-ACCOUNT-NO                 09574000
095750                 ' CLSN BR DDA '  CLSN-BR-DDA-NBR                 09575000
095760                 ' DSDS BR CLSN TIED ' BR-CLSN-TIED               09576000
095770***  MOVING ZEROS TO THE HOLD-BR-CLSN-TIED SO THE ACCOUNT DOES    09577000
095780***  NOT PROCESS THE BR - IT IS TREATED LIKE A REGULAR DDA.       09578000
095790         MOVE ZEROS        TO HOLD-BR-CLSN-TIED                   09579000
095800         MOVE ZEROS        TO CL34-AVAIL-BAL                      09580000
095810         MOVE ZEROS        TO CL34-PRIN-BAL                       09581000
095820         GO TO P2604-EXIT                                         09582000
095830     END-IF.                                                      09583000
095840                                                                  09584000
095850     MOVE PROC-BK-NO             TO CL34-BANK-NBR.                09585000
095860     MOVE BR-CLSN-TIED           TO CL34-CIF-KEY.                 09586000
095870     EXEC SQL                                                     09587000
095880         SELECT                                                   09588000
095890             CL34_AVAIL_BAL,                                      09589000
095900             CL34_PRIN_BAL                                        09590000
095910         INTO                                                     09591000
095920            :CL34-AVAIL-BAL,                                      09592000
095930            :CL34-PRIN-BAL                                        09593000
095940         FROM CLS.CLST34_BR_AVAILABLE                             09594000
095950         WHERE CL34_BANK_NBR = :CL34-BANK-NBR                     09595000
095960           AND CL34_CIF_KEY  = :CL34-CIF-KEY                      09596000
095970     END-EXEC.                                                    09597000
095980     EVALUATE SQLCODE                                             09598000
095990         WHEN ZEROS                                               09599000
096000             CONTINUE                                             09600000
096010         WHEN +100                                                09601000
096020             DISPLAY 'CDCINFO (DSDS100) CLSN BR TIED NOT FOUND '  09602000
096030                     CL34-BANK-NBR ' * ' DSDS-ACCOUNT-NO          09603000
096040                                   ' * ' CL34-CIF-KEY             09604000
096050             MOVE ZEROS TO CL34-AVAIL-BAL                         09605000
096060             MOVE ZEROS TO CL34-PRIN-BAL                          09606000
096070         WHEN OTHER                                               09607000
096080             CALL 'CDCUT90' USING SQLCA                           09608000
096090             CALL 'CDCDUMP' USING BY CONTENT '2046'               09609000
096100     END-EVALUATE.                                                09610000
096110     DISPLAY 'CDCINFO (DSDS100) SELECT CLST34 '                   09611000
096120     DISPLAY ' BANK ' CL34-BANK-NBR                               09612000
096130             ' DDA ' DSDS-ACCOUNT-NO                              09613000
096140             ' CIF KEY ' CL34-CIF-KEY                             09614000
096150             ' CL34-AVAIL-BAL ' CL34-AVAIL-BAL                    09615000
096160             ' CL34-PRIN-BAL ' CL34-PRIN-BAL.                     09616000
096170     MOVE CL34-AVAIL-BAL TO CLSN-BR-WORK-AVAIL-BAL.               09617000
096180 P2604-EXIT.                                                      09618000
096190     EXIT.                                                        09619000
096200                                                                  09620000
096210 P2605-UPDATE-CLST34.                                             09621000
096220****  UPDATE CL34_DDA_CURR_COLL_BAL                               09622000
096230****         FOR REPORTING ON CLS-628                             09623000
096240     EVALUATE BR-BAL-IND                                          09624000
096250       WHEN 1                                                     09625000
096260         MOVE CURRENT-BALANCE TO CL34-DDA-CURR-COLL-BAL           09626000
096270       WHEN 2                                                     09627000
096280         COMPUTE CLSN-BR-WORK-COLL-BAL = CURRENT-BALANCE -        09628000
096290                 (ONE-DAY-FLOAT-AMT   + TWO-DAY-FLOAT-AMT  +      09629000
096300                  THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +      09630000
096310                  FIVE-DAY-FLOAT-AMT)                             09631000
096320         MOVE CLSN-BR-WORK-COLL-BAL  TO CL34-DDA-CURR-COLL-BAL    09632000
096330       WHEN OTHER                                                 09633000
096340         MOVE CURRENT-BALANCE TO CL34-DDA-CURR-COLL-BAL           09634000
096350     END-EVALUATE.                                                09635000
096360                                                                  09636000
096370     MOVE PROC-BK-NO             TO CL34-BANK-NBR.                09637000
096380     MOVE BR-CLSN-TIED           TO CL34-CIF-KEY.                 09638000
096390     EXEC SQL                                                     09639000
096400         UPDATE CLS.CLST34_BR_AVAILABLE SET                       09640000
096410     CL34_DDA_CURR_COLL_BAL       = :CL34-DDA-CURR-COLL-BAL,      09641000
096420     CL34_UPDATE_TS               = CURRENT TIMESTAMP             09642000
096430         WHERE CL34_BANK_NBR = :CL34-BANK-NBR                     09643000
096440           AND CL34_CIF_KEY  = :CL34-CIF-KEY                      09644000
096450     END-EXEC.                                                    09645000
096460     EVALUATE SQLCODE                                             09646000
096470         WHEN ZEROS                                               09647000
096480             CONTINUE                                             09648000
096490         WHEN +100                                                09649000
096500             DISPLAY 'CDCINFO (DSDS100) CLSN BR TIED NOT FOUND '  09650000
096510                     ' * DDA CURR/COLL BAL NOT UPDATED '          09651000
096520                     PROC-BK-NO ' * '                             09652000
096530                     DSDS-ACCOUNT-NO ' * ' CL34-CIF-KEY           09653000
096540             MOVE ZEROS TO CL34-AVAIL-BAL                         09654000
096550             MOVE ZEROS TO CL34-PRIN-BAL                          09655000
096560         WHEN OTHER                                               09656000
096570             CALL 'CDCUT90' USING SQLCA                           09657000
096580             CALL 'CDCDUMP' USING BY CONTENT '2047'               09658000
096590     END-EVALUATE.                                                09659000
096600 P2606-EXIT.                                                      09660000
096610     EXIT.                                                        09661000
096620                                                                  09662000
096630******************************************************************09663000
096640*    B U I L D   A U T O M A T I C   A D V A N C E   T X S       *09664000
096650******************************************************************09665000
096660 P2650-BUILD-ADV-TX.                                              09666000
096670     IF ADVANCE-EXACT AND ODB-CURR-PEG-BAL                        09667000
096680         ADD ODB-PEGGED-BAL TO ADVANCE-TX-AMT                     09668000
096690                               ODB-LOAN-BAL.                      09669000
096700     MOVE 1 TO DSDSTXL-PENDING-SW.                                09670000
096710     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     09671000
096720     MOVE ADVANCE-TX-AMT TO DSDSTXL-AMOUNT                        09672000
096730                            LAST-ADV-AMT.                         09673000
096740     ADD ADVANCE-TX-AMT TO AMT-ODB-ADV-ON-STMT.                   09674000
096750     MOVE PROC-CURR-DATE TO LAST-ADV-DATE.                        09675000
096760     PERFORM P2660-BUILD-DDA-SIDE.                                09676000
096770     MOVE 686 TO DSDSTXL-CODE LAST-TX-CODE.                       09677000
096780     MOVE OSB-DESC-0012-A TO DSDSTXL-CO-DESC.                     09678000
096790     MOVE OSB-DESC-0012-B TO DSDSTXL-DESC.                        09679000
096800     IF ODB-PEG-BAL-TX-SW = 1                                     09680000
096810         MOVE OSB-DESC-0013-A TO DSDSTXL-CO-DESC                  09681000
096820         MOVE OSB-DESC-0013-B TO DSDSTXL-DESC.                    09682000
096830     MOVE ODB-PAY-ADV-KEY TO DSDSTXL-SORT-KEY.                    09683000
096840     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       09684000
096850     MOVE 1 TO ODB-ACTIVITY-SW.                                   09685000
096860     ADD 1 TO NUM-ADVANCES-YTD.                                   09686000
096870     ADD 1 TO NUM-BILL-TX.                                        09687000
096880     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     09688000
096890     GO TO P2670-BUILD-END.                                       09689000
096900                                                                  09690000
096910 P2660-BUILD-DDA-SIDE.                                            09691000
096920     MOVE 575 TO DSDSTXL-CODE.                                    09692000
096930     MOVE ODB-PLAN-DESC (SUB14) TO ODB-ADV-DESC-PLAN.             09693000
096940     MOVE LENGTH OF ODB-ADV-DESC-PLAN TO CDCUT34-LENGTH.          09694000
096950     CALL 'CDCUT34' USING CDCUT34-LENGTH                          09695000
096960                          ODB-ADV-DESC-PLAN.                      09696000
096970     MOVE ODB-ADV-DESC-1 TO DSDSTXL-CO-DESC.                      09697000
096980     MOVE ODB-ADV-DESC-2 TO DSDSTXL-DESC.                         09698000
096990     MOVE 'ADV' TO PJ-HOLD-CODE.                                  09699000
097000     MOVE DEP-KEY TO SAVE-CR-SORT-KEY.                            09700000
097010     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       09701000
097020     ADD 1 TO NUM-CREDITS.                                        09702000
097030     ADD 1 TO NUM-BILL-TX.                                        09703000
097040     ADD DSDSTXL-AMOUNT TO ADVANCES-TDY.                          09704000
097050     MOVE DSDSTXL-AMOUNT TO AMT-LAST-DEPOSIT.                     09705000
097060     MOVE DSDSTXL-DATE TO DATE-LAST-DEPOSIT.                      09706000
097070     MOVE ZEROS TO HOLD-TTX-ITEM-COUNT.                           09707000
097080     PERFORM P1325-NORM-CR-2.                                     09708000
097090     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            09709000
097100     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       09710000
097110                                                                  09711000
097120 P2670-BUILD-END.                                                 09712000
097130     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 09713000
097140                                                                  09714000
097150 P2680-BUILD-AUTO-ADV-NOTICE.                                     09715000
097160     IF NO-ADV-NOTICE                                             09716000
097170         GO TO P2700-EXIT.                                        09717000
097180     MOVE 093 TO SUB1.                                            09718000
097190     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               09719000
097200     IF HOLD-FREQ-RPT = 0                                         09720000
097210         GO TO P2700-EXIT.                                        09721000
097220     MOVE SPACES TO SPECIAL-WORK.                                 09722000
097230     MOVE 093 TO AN-REPORT-CODE.                                  09723000
097240     MOVE 'ODB'        TO AN-FILE-ID.                             09724000
097250     MOVE BCF-BANK-NO TO AN-BANK-NO.                              09725000
097260     MOVE ACCOUNT-ID TO AN-ACCT-ID.                               09726000
097270     MOVE ACCOUNT-NUMBER TO AN-ACCT-NO.                           09727000
097280     MOVE LOW-VALUES TO AN-CRF-REC-ID.                            09728000
097290     MOVE ODB-LOAN-BAL TO AN-LOAN-BAL.                            09729000
097300     MOVE ADVANCE-TX-AMT TO AN-ADV-AMT.                           09730000
097310     MOVE PROC-CURR-DATE TO AN-ADV-DT.                            09731000
097320     MOVE ODB-PLAN           TO AN-PLAN.                          09732000
097330     SUBTRACT ODB-LOAN-BAL FROM AUTH-CREDIT-LIMIT                 09733000
097340         GIVING AN-UNUSED.                                        09734000
097350     IF AN-UNUSED LESS THAN ZERO                                  09735000
097360         MOVE ZEROS TO AN-UNUSED.                                 09736000
097370     IF ODB-LOAN-BAL LESS THAN AUTH-CREDIT-LIMIT                  09737000
097380         MOVE 000 TO AN-MESSAGE                                   09738000
097390         GO TO P2690-WRITE-AUTO-ADV-NTC.                          09739000
097400     EVALUATE TRUE                                                09740000
097410         WHEN CASH-RESERVE                                        09741000
097420             MOVE 001 TO AN-MESSAGE                               09742000
097430         WHEN BUSINESS-RESERVE                                    09743000
097440             MOVE 002 TO AN-MESSAGE                               09744000
097450         WHEN EXECUTIVE-CREDIT                                    09745000
097460             MOVE 003 TO AN-MESSAGE                               09746000
097470         WHEN EQUITY-CREDIT                                       09747000
097480             MOVE 004 TO AN-MESSAGE                               09748000
097490         WHEN CHECKING-PLUS                                       09749000
097500             MOVE 005 TO AN-MESSAGE                               09750000
097510         WHEN PRIORITY-LINE                                       09751000
097520             MOVE 006 TO AN-MESSAGE                               09752000
097530         WHEN SECURITIES-LINE                                     09753000
097540             MOVE 007 TO AN-MESSAGE                               09754000
097550         WHEN HOME-EQUITY                                         09755000
097560             MOVE 008 TO AN-MESSAGE                               09756000
097570         WHEN EMPLOYEE-RESERVE                                    09757000
097580             MOVE 009 TO AN-MESSAGE                               09758000
097590         WHEN OTHER                                               09759000
097600             MOVE 001 TO AN-MESSAGE                               09760000
097610     END-EVALUATE.                                                09761000
097620                                                                  09762000
097630 P2690-WRITE-AUTO-ADV-NTC.                                        09763000
097640     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           09764000
097650                                                                  09765000
097660 P2700-EXIT.                                                      09766000
097670     EXIT.                                                        09767000
097680                                                                  09768000
097690 P2710-BUILD-HELOC-ADVANCE.                                       09769000
097700     MOVE 1 TO DSDSTXL-PENDING-SW.                                09770000
097710     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     09771000
097720                                                                  09772000
097730**** DDA SIDE                                                     09773000
097740     MOVE 591 TO DSDSTXL-CODE.                                    09774000
097750     MOVE HE-ADVANCE-TX-AMT  TO DSDSTXL-AMOUNT.                   09775000
097760     MOVE PROC-CURR-DATE     TO LAST-ADV-DATE.                    09776000
097770     ADD  DSDSTXL-AMOUNT     TO ML-HELOC-ADVANCES                 09777000
097780                                GEN-CREDIT-AMT.                   09778000
097790     ADD 1 TO GEN-CREDIT-CNT.                                     09779000
097800     MOVE OSB-DESC-0096-A    TO DSDSTXL-CO-DESC.                  09780000
097810     MOVE OSB-DESC-0096-B    TO DSDSTXL-DESC.                     09781000
097820     MOVE 'ADV'              TO PJ-HOLD-CODE.                     09782000
097830     MOVE DEP-KEY            TO SAVE-CR-SORT-KEY.                 09783000
097840     MOVE PROC-CURR-DATE     TO DSDSTXL-CHK-NO.                   09784000
097850     ADD 1                   TO NUM-CREDITS.                      09785000
097860     ADD 1                   TO NUM-BILL-TX.                      09786000
097870     ADD  DSDSTXL-AMOUNT     TO ADVANCES-TDY.                     09787000
097880     MOVE DSDSTXL-AMOUNT     TO AMT-LAST-DEPOSIT.                 09788000
097890     MOVE DSDSTXL-DATE       TO DATE-LAST-DEPOSIT.                09789000
097900     MOVE ZEROS              TO HOLD-TTX-ITEM-COUNT.              09790000
097910                                                                  09791000
097920     PERFORM P1325-NORM-CR-2.                                     09792000
097930     PERFORM P7020-BUILD-DEPOSIT-LIST      THRU P7029-EXIT.       09793000
097940     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       09794000
097950                                                                  09795000
097960     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 09796000
097970                                                                  09797000
097980     INITIALIZE ML-HELOC-ADVANCE-RECORD.                          09798000
097990     MOVE PROC-BK-NO        TO MLH-BANK-NBR                       09799000
098000     MOVE ACCOUNT-ID        TO MLH-ACCT-ID                        09800000
098010     MOVE ACCOUNT-NUMBER    TO MLH-ACCT-NBR                       09801000
098020     MOVE SHORT-NAME        TO MLH-SHORT-NAME                     09802000
098030     MOVE ML-HELOC-NBR      TO MLH-ML-HELOC-NBR                   09803000
098040     MOVE HE-ADVANCE-TX-AMT TO MLH-ADVANCE-AMT.                   09804000
098050     CALL 'CDCDT99' USING PROC-CURR-DATE                          09805000
098060                          MLH-PROCESS-DATE                        09806000
098070                          BY CONTENT 'PYYYYDDD'                   09807000
098080                          BY CONTENT 'CYYYY-MM-DD'.               09808000
098090                                                                  09809000
098100     WRITE ML-HELOC-ADV-OUT FROM ML-HELOC-ADVANCE-RECORD.         09810000
098110 P2719-EXIT.                                                      09811000
098120     EXIT.                                                        09812000
098130                                                                  09813000
098140 P2720-BUILD-CLSN-BR-ADVANCE.                                     09814000
098150     MOVE 1 TO DSDSTXL-PENDING-SW.                                09815000
098160     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     09816000
098170                                                                  09817000
098180**** DDA SIDE                                                     09818000
098190     DISPLAY 'CDCINFO (DSDS100) CLSN-BR-ADVANCE P2720 '           09819000
098200                      DSDS-ACCOUNT-NO ' * ' CLSN-BR-ADV-TX-AMT    09820000
098210     MOVE 638 TO DSDSTXL-CODE.                                    09821000
098220     MOVE CLSN-BR-ADV-TX-AMT TO DSDSTXL-AMOUNT.                   09822000
098230     MOVE PROC-CURR-DATE     TO LAST-ADV-DATE.                    09823000
098240     ADD  DSDSTXL-AMOUNT     TO CLSN-BR-ADVANCES                  09824000
098250                                GEN-CREDIT-AMT.                   09825000
098260     ADD 1 TO GEN-CREDIT-CNT.                                     09826000
098270     MOVE OSB-DESC-0100-A    TO DSDSTXL-CO-DESC.                  09827000
098280     MOVE OSB-DESC-0100-B    TO DSDSTXL-DESC.                     09828000
098290     MOVE 'ADV'              TO PJ-HOLD-CODE.                     09829000
098300     MOVE DEP-KEY            TO SAVE-CR-SORT-KEY.                 09830000
098310     MOVE PROC-CURR-DATE     TO DSDSTXL-CHK-NO.                   09831000
098320     ADD 1                   TO NUM-CREDITS.                      09832000
098330     ADD 1                   TO NUM-BILL-TX.                      09833000
098340     ADD  DSDSTXL-AMOUNT     TO ADVANCES-TDY.                     09834000
098350     MOVE DSDSTXL-AMOUNT     TO AMT-LAST-DEPOSIT.                 09835000
098360     MOVE DSDSTXL-DATE       TO DATE-LAST-DEPOSIT.                09836000
098370     MOVE ZEROS              TO HOLD-TTX-ITEM-COUNT.              09837000
098380                                                                  09838000
098390     PERFORM P1325-NORM-CR-2.                                     09839000
098400     PERFORM P7020-BUILD-DEPOSIT-LIST      THRU P7029-EXIT.       09840000
098410     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       09841000
098420                                                                  09842000
098430     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 09843000
098440                                                                  09844000
098450**** CLSN ADVANCE TRANSACTION                                     09845000
098460     INITIALIZE LIS-CL-TRANSACTION.                               09846000
098470     MOVE SPACES               TO TXN-DATA.                       09847000
098480     MOVE 40                   TO TXN-CODE.                       09848000
098490     MOVE PROC-BK-NO           TO TXN-BANK.                       09849000
098500     MOVE 0001                 TO TXN-BRANCH.                     09850000
098510     MOVE BR-CLSN-TIED         TO WORK-CLSN-NUM.                  09851000
098520     MOVE CLSN-CUST-NUM        TO TXN-CUST-NBR.                   09852000
098530     MOVE CLSN-LOAN-NUM        TO TXN-LOAN-NBR.                   09853000
098540     MOVE ZEROS                TO MON-PART-SOLD.                  09854000
098550     MOVE ZEROS                TO MON-PAID-TO-DATE.               09855000
098560     MOVE SPACES               TO MON-ACTION-CODE.                09856000
098570     CALL 'CDCDT99'         USING PROC-CURR-DATE                  09857000
098580                                  MON-EFFECT-DATE                 09858000
098590                                  BY CONTENT 'PYYYYDDD'           09859000
098600                                  BY CONTENT 'CMMDDYY'.           09860000
098610     MOVE ZEROS                TO MON-PYMT-AMT-INT.               09861000
098620     MOVE CLSN-BR-ADV-TX-AMT   TO MON-PYMT-AMT-PRIN.              09862000
098630     MOVE SPACES               TO MON-DDA-INTERFACE               09863000
098640                                  MON-PTS-CALC-CODE               09864000
098650                                  MON-PTS-FIAC-CODE               09865000
098660                                  MON-FEE-TYPE                    09866000
098670                                  MON-FILLER.                     09867000
098680     MOVE ZEROS                TO MON-PTS-END-DATE.               09868000
098690     MOVE SPACES               TO MONETARY-TXN-RECORD (71:6).     09869000
098700     MOVE '905'                TO MONETARY-TXN-RECORD (85:3).     09870000
098710     MOVE 'DSDS100'            TO MONETARY-TXN-RECORD (88:7).     09871000
098720     WRITE CLSN-BR-TX-FILE-OUT FROM MONETARY-TXN-RECORD.          09872000
098730 P2729-EXIT.                                                      09873000
098740     EXIT.                                                        09874000
098750                                                                  09875000
098760 P2730-BUILD-CLSN-BR-PAYMENT.                                     09876000
098770     MOVE 1 TO DSDSTXL-PENDING-SW.                                09877000
098780     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     09878000
098790                                                                  09879000
098800**** DDA SIDE                                                     09880000
098810     DISPLAY 'CDCINFO (DSDS100) CLSN-BR-PAYMENT P2730 '           09881000
098820                      DSDS-ACCOUNT-NO ' * ' CLSN-BR-PYMT-TX-AMT   09882000
098830     MOVE 939 TO DSDSTXL-CODE.                                    09883000
098840     MOVE CLSN-BR-PYMT-TX-AMT TO DSDSTXL-AMOUNT.                  09884000
098850     MOVE PROC-CURR-DATE      TO LAST-ADV-DATE.                   09885000
098860     ADD  DSDSTXL-AMOUNT      TO CLSN-BR-PAYMENTS                 09886000
098870                                 GEN-DEBIT-AMT.                   09887000
098880     ADD 1                    TO GEN-DEBIT-CNT.                   09888000
098890     ADD 1                    TO NUM-BILL-TX.                     09889000
098900     MOVE OSB-DESC-0101-A     TO DSDSTXL-CO-DESC.                 09890000
098910     MOVE OSB-DESC-0101-B     TO DSDSTXL-DESC.                    09891000
098920     MOVE 'PMT'               TO PJ-HOLD-CODE.                    09892000
098930     MOVE DEP-KEY             TO SAVE-CR-SORT-KEY.                09893000
098940     MOVE ZEROS               TO DSDSTXL-ENCL-TYPE                09894000
098950                                 DSDSTXL-SC-TYPE.                 09895000
098960     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                09896000
098970     MOVE PROC-CURR-DATE      TO DSDSTXL-CHK-NO.                  09897000
098980     ADD 1                    TO NUM-DEBITS.                      09898000
098990     MOVE DSDSTXL-AMOUNT      TO AMT-LAST-DEPOSIT.                09899000
099000     MOVE DSDSTXL-DATE        TO DATE-LAST-DEPOSIT.               09900000
099010     MOVE ZEROS               TO HOLD-TTX-ITEM-COUNT.             09901000
099020                                                                  09902000
099030     PERFORM P1665-NORM-DEBIT.                                    09903000
099040                                                                  09904000
099050     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 09905000
099060                                                                  09906000
099070**** CLSN PAYMENT TRANSACTION                                     09907000
099080     INITIALIZE LIS-CL-TRANSACTION.                               09908000
099090     MOVE SPACES               TO TXN-DATA.                       09909000
099100     MOVE 30                   TO TXN-CODE.                       09910000
099110     MOVE 'A'                  TO MON-ACTION-CODE.                09911000
099120     MOVE PROC-BK-NO           TO TXN-BANK.                       09912000
099130     MOVE 0001                 TO TXN-BRANCH.                     09913000
099140     MOVE BR-CLSN-TIED         TO WORK-CLSN-NUM.                  09914000
099150     MOVE CLSN-CUST-NUM        TO TXN-CUST-NBR.                   09915000
099160     MOVE CLSN-LOAN-NUM        TO TXN-LOAN-NBR.                   09916000
099170     MOVE ZEROS                TO MON-PART-SOLD.                  09917000
099180     MOVE ZEROS                TO MON-PAID-TO-DATE.               09918000
099190     CALL 'CDCDT99'         USING PROC-CURR-DATE                  09919000
099200                                  MON-EFFECT-DATE                 09920000
099210                                  BY CONTENT 'PYYYYDDD'           09921000
099220                                  BY CONTENT 'CMMDDYY'.           09922000
099230     MOVE ZEROS                TO MON-PYMT-AMT-INT.               09923000
099240     MOVE CLSN-BR-PYMT-TX-AMT  TO MON-PYMT-AMT-PRIN.              09924000
099250     MOVE SPACES               TO MON-DDA-INTERFACE               09925000
099260                                  MON-PTS-CALC-CODE               09926000
099270                                  MON-PTS-FIAC-CODE               09927000
099280                                  MON-FEE-TYPE                    09928000
099290                                  MON-FILLER.                     09929000
099300     MOVE ZEROS                TO MON-PTS-END-DATE.               09930000
099310     MOVE '905'                TO MONETARY-TXN-RECORD (85:3).     09931000
099320     MOVE 'DSDS100'            TO MONETARY-TXN-RECORD (88:7).     09932000
099330     WRITE CLSN-BR-TX-FILE-OUT FROM MONETARY-TXN-RECORD.          09933000
099340 P2739-EXIT.                                                      09934000
099350     EXIT.                                                        09935000
099360                                                                  09936000
099370******************************************************************09937000
099380*    T A K E   P A S T   D U E   P A Y M E N T                   *09938000
099390******************************************************************09939000
099400 P2750-TAKE-PAST-DUE-PMNT.                                        09940000
099410     IF ODB-BILL-AT-CYCLE                                         09941000
099420         GO TO P2790-EXIT.                                        09942000
099430     IF ODB-MANUAL-PAY OR ODB-MANUAL-PAY-CUTOFF                   09943000
099440         GO TO P2790-EXIT.                                        09944000
099450     IF BYPASS-PAST-DUE = 1                                       09945000
099460         GO TO P2790-EXIT.                                        09946000
099470     MOVE 1 TO BYPASS-PAST-DUE.                                   09947000
099480     SUBTRACT HOLD-ACCUM FROM CURRENT-BALANCE                     09948000
099490         GIVING TEMP-CURR-BAL.                                    09949000
099500     IF TEMP-CURR-BAL LESS THAN AMT-PAST-DUE                      09950000
099510         NEXT SENTENCE                                            09951000
099520       ELSE                                                       09952000
099530         GO TO P2780-GET-PAST-DUE.                                09953000
099540     IF NUM-PAST-DUE-PMNTS NOT GREATER THAN 01                    09954000
099550         GO TO P2790-EXIT.                                        09955000
099560     COMPUTE PAYMENT-FRACTION ROUNDED =                           09956000
099570         1.00 / NUM-PAST-DUE-PMNTS.                               09957000
099580     COMPUTE PAYMENT-DOLLARS ROUNDED =                            09958000
099590         PAYMENT-FRACTION * AMT-PAST-DUE.                         09959000
099600     MOVE PAYMENT-DOLLARS TO TEMP-PAYMENT.                        09960000
099610     IF TEMP-CURR-BAL LESS THAN TEMP-PAYMENT                      09961000
099620         GO TO P2790-EXIT.                                        09962000
099630     MOVE 02 TO NO-OF-TIMES.                                      09963000
099640                                                                  09964000
099650 P2760-CK-NUM-PAST-DUE.                                           09965000
099660     IF NUM-PAST-DUE-PMNTS GREATER THAN NO-OF-TIMES               09966000
099670         NEXT SENTENCE                                            09967000
099680       ELSE                                                       09968000
099690         GO TO P2770-FEWER-TIMES.                                 09969000
099700     ADD PAYMENT-DOLLARS TO TEMP-PAYMENT.                         09970000
099710     IF TEMP-CURR-BAL LESS THAN TEMP-PAYMENT                      09971000
099720         NEXT SENTENCE                                            09972000
099730       ELSE                                                       09973000
099740         ADD 01 TO NO-OF-TIMES                                    09974000
099750         GO TO P2760-CK-NUM-PAST-DUE.                             09975000
099760     SUBTRACT PAYMENT-DOLLARS FROM TEMP-PAYMENT.                  09976000
099770                                                                  09977000
099780 P2770-FEWER-TIMES.                                               09978000
099790     SUBTRACT 01 FROM NO-OF-TIMES.                                09979000
099800     SUBTRACT NO-OF-TIMES FROM NUM-PAST-DUE-PMNTS.                09980000
099810     COMPUTE TEMP-DAYS =                                          09981000
099820         NO-OF-TIMES * 30.                                        09982000
099830     IF TEMP-DAYS GREATER THAN NUM-DAYS-DELQ                      09983000
099840         MOVE ZEROS TO NUM-DAYS-DELQ                              09984000
099850       ELSE                                                       09985000
099860         SUBTRACT TEMP-DAYS FROM NUM-DAYS-DELQ.                   09986000
099870     SUBTRACT TEMP-PAYMENT FROM AMT-PAST-DUE.                     09987000
099880     SUBTRACT TEMP-PAYMENT FROM ODB-MAN-PYMT-ACCUM.               09988000
099890     IF NUM-DAYS-DELQ LESS THAN 020                               09989000
099900         MOVE '0' TO SECOND-NOTICE-SW.                            09990000
099910     IF NUM-DAYS-DELQ LESS THAN 010                               09991000
099920         MOVE '0' TO FIRST-NOTICE-SW.                             09992000
099930     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 09993000
099940     GO TO P2790-EXIT.                                            09994000
099950                                                                  09995000
099960 P2780-GET-PAST-DUE.                                              09996000
099970     MOVE AMT-PAST-DUE TO TEMP-PAYMENT.                           09997000
099980     SUBTRACT TEMP-PAYMENT FROM ODB-MAN-PYMT-ACCUM.               09998000
099990     MOVE ZEROS TO NUM-PAST-DUE-PMNTS.                            09999000
100000     MOVE ZEROS TO NUM-DAYS-DELQ.                                 10000000
100010     MOVE ZEROS TO AMT-PAST-DUE.                                  10001000
100020     MOVE ZEROS TO FIRST-NOTICE-SW.                               10002000
100030     MOVE ZEROS TO SECOND-NOTICE-SW.                              10003000
100040     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 10004000
100050                                                                  10005000
100060 P2790-EXIT.                                                      10006000
100070     EXIT.                                                        10007000
100080                                                                  10008000
100090******************************************************************10009000
100100*    B U I L D   A U T O M A T I C   P A Y M E N T   T X S       *10010000
100110******************************************************************10011000
100120 P2800-BUILD-PMNT-TX.                                             10012000
100130     IF TEMP-PAYMENT = ZERO                                       10013000
100140         GO TO P2830-EXIT.                                        10014000
100150     MOVE ZEROS TO HOLD-ODB-AMT-TO-CHRG.                          10015000
100160     IF ODB-ACCT-TO-BE-CHRG = ZERO                                10016000
100170         GO TO P2805-CONT.                                        10017000
100180     IF CURRENT-BALANCE GREATER THAN ZERO                         10018000
100190         NEXT SENTENCE                                            10019000
100200       ELSE                                                       10020000
100210         GO TO P2820-BUILD-PENDING.                               10021000
100220     IF PAYOFF-DAILY-PARTIAL                                      10022000
100230         NEXT SENTENCE                                            10023000
100240       ELSE                                                       10024000
100250         GO TO P2820-BUILD-PENDING.                               10025000
100260     IF TEMP-PAYMENT GREATER THAN CURRENT-BALANCE                 10026000
100270         GO TO P2820-BUILD-PENDING.                               10027000
100280                                                                  10028000
100290 P2805-CONT.                                                      10029000
100300     MOVE 1 TO DSDSTXL-PENDING-SW.                                10030000
100310     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     10031000
100320     MOVE TEMP-PAYMENT TO DSDSTXL-AMOUNT                          10032000
100330                          LAST-PMNT-AMT.                          10033000
100340     ADD TEMP-PAYMENT TO AMT-ODB-PAY-ON-STMT                      10034000
100350                         ODB-MAN-PYMT-ACCUM.                      10035000
100360     MOVE 689 TO DSDSTXL-CODE LAST-TX-CODE.                       10036000
100370     MOVE PROC-CURR-DATE TO LAST-PMNT-DATE.                       10037000
100380     IF CYCLE-THIS-SC-EARN = 0                                    10038000
100390         MOVE ODB-PAY-ADV-KEY TO DSDSTXL-SORT-KEY                 10039000
100400       ELSE                                                       10040000
100410         MOVE ODB-MIN-PAY-KEY TO DSDSTXL-SORT-KEY.                10041000
100420     IF ODB-INT-ONLY                                              10042000
100430         MOVE OSB-DESC-0014-A TO DSDSTXL-CO-DESC                  10043000
100440         MOVE OSB-DESC-0014-B TO DSDSTXL-DESC                     10044000
100450         GO TO P2810-CONT.                                        10045000
100460     IF TEMP-PAYMENT = ODB-LOAN-BAL                               10046000
100470         MOVE OSB-DESC-0015-A TO DSDSTXL-CO-DESC                  10047000
100480         MOVE OSB-DESC-0015-B TO DSDSTXL-DESC                     10048000
100490       ELSE                                                       10049000
100500         MOVE OSB-DESC-0016-A TO DSDSTXL-CO-DESC                  10050000
100510         MOVE OSB-DESC-0016-B TO DSDSTXL-DESC.                    10051000
100520     IF ODB-PEG-BAL-TX-SW = 1                                     10052000
100530         MOVE OSB-DESC-0017-A TO DSDSTXL-CO-DESC                  10053000
100540         MOVE OSB-DESC-0017-B TO DSDSTXL-DESC.                    10054000
100550                                                                  10055000
100560 P2810-CONT.                                                      10056000
100570     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10057000
100580     MOVE '1' TO ODB-ACTIVITY-SW.                                 10058000
100590     SUBTRACT DSDSTXL-AMOUNT FROM ODB-LOAN-BAL.                   10059000
100600     ADD 1 TO NUM-BILL-TX.                                        10060000
100610     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     10061000
100620                                                                  10062000
100630                                                                  10063000
100640 P2815-BUILD-DDA-TX.                                              10064000
100650     MOVE 751 TO DSDSTXL-CODE.                                    10065000
100660     MOVE OSB-DESC-0018-A TO DSDSTXL-CO-DESC.                     10066000
100670     MOVE OSB-DESC-0018-B TO DSDSTXL-DESC.                        10067000
100680     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             10068000
100690     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                10069000
100700     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10070000
100710     MOVE 'PMT' TO PJ-HOLD-CODE.                                  10071000
100720     ADD 1 TO NUM-BILL-TX.                                        10072000
100730     PERFORM P1665-NORM-DEBIT.                                    10073000
100740     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 10074000
100750     GO TO P2830-EXIT.                                            10075000
100760                                                                  10076000
100770 P2820-BUILD-PENDING.                                             10077000
100780     MOVE BCF-BANK-NO TO PEND-BANK-NBR.                           10078000
100790     MOVE ACCOUNT-ID TO PEND-ACCT-ID.                             10079000
100800     MOVE ODB-ACCT-TO-BE-CHRG TO PEND-ACCT-NBR.                   10080000
100810     MOVE ACCOUNT-NUMBER TO PTW-ODB-ACCT-NO.                      10081000
100820     MOVE 752 TO PEND-TX-CODE.                                    10082000
100830     MOVE TEMP-PAYMENT TO PEND-TX-AMOUNT                          10083000
100840                          HOLD-ODB-AMT-TO-CHRG.                   10084000
100850     MOVE PROC-NEXT-DATE TO PEND-EFFECT-DATE.                     10085000
100860     MOVE 99913 TO PEND-BATCH-NBR.                                10086000
100870     ADD 1 TO PEND-SEQUENCE-NBR.                                  10087000
100880     MOVE ODB-PLAN-DESC (SUB14) TO PTW-TX-DESC.                   10088000
100890     MOVE LENGTH OF PTW-TX-DESC TO CDCUT34-LENGTH.                10089000
100900     CALL 'CDCUT34' USING CDCUT34-LENGTH                          10090000
100910                          PTW-TX-DESC.                            10091000
100920     MOVE PTW-TX-DESC-WK TO PEND-TX-DESC.                         10092000
100930     MOVE 'DSDS100' TO PEND-SOURCE-PROG.                          10093000
100940     EXEC SQL                                                     10094000
100950         INSERT INTO DSDS.PEND                                    10095000
100960             (PEND_BANK_NBR,                                      10096000
100970              PEND_ACCT_ID,                                       10097000
100980              PEND_ACCT_NBR,                                      10098000
100990              PEND_TX_CODE,                                       10099000
101000              PEND_TX_AMOUNT,                                     10100000
101010              PEND_EFFECT_DATE,                                   10101000
101020              PEND_BATCH_NBR,                                     10102000
101030              PEND_SEQUENCE_NBR,                                  10103000
101040              PEND_TX_DESC,                                       10104000
101050              PEND_SOURCE_PROG)                                   10105000
101060         VALUES                                                   10106000
101070             (:PEND-BANK-NBR,                                     10107000
101080              :PEND-ACCT-ID,                                      10108000
101090              :PEND-ACCT-NBR,                                     10109000
101100              :PEND-TX-CODE,                                      10110000
101110              :PEND-TX-AMOUNT,                                    10111000
101120              :PEND-EFFECT-DATE,                                  10112000
101130              :PEND-BATCH-NBR,                                    10113000
101140              :PEND-SEQUENCE-NBR,                                 10114000
101150              :PEND-TX-DESC,                                      10115000
101160              :PEND-SOURCE-PROG)                                  10116000
101170     END-EXEC.                                                    10117000
101180     EVALUATE SQLCODE                                             10118000
101190         WHEN ZEROS                                               10119000
101200             CONTINUE                                             10120000
101210         WHEN +100                                                10121000
101220             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      10122000
101230             CALL 'CDCUT90' USING SQLCA                           10123000
101240             CALL 'CDCDUMP' USING BY CONTENT '2048'               10124000
101250         WHEN OTHER                                               10125000
101260             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      10126000
101270             CALL 'CDCUT90' USING SQLCA                           10127000
101280             CALL 'CDCDUMP' USING BY CONTENT '2049'               10128000
101290     END-EVALUATE.                                                10129000
101300     ADD 1 TO PEND-SEQUENCE-NBR.                                  10130000
101310     MOVE 689 TO PEND-TX-CODE.                                    10131000
101320     MOVE ACCOUNT-NUMBER TO PEND-ACCT-NBR.                        10132000
101330     IF ODB-INT-ONLY                                              10133000
101340         STRING                                                   10134000
101350         OSB-DESC-0014-A DELIMITED BY SIZE                        10135000
101360         OSB-DESC-0014-B DELIMITED BY SIZE                        10136000
101370             INTO PEND-TX-DESC                                    10137000
101380             GO TO P2825-CONT.                                    10138000
101390     IF TEMP-PAYMENT = ODB-LOAN-BAL                               10139000
101400         STRING                                                   10140000
101410         OSB-DESC-0015-A DELIMITED BY SIZE                        10141000
101420         OSB-DESC-0015-B DELIMITED BY SIZE                        10142000
101430             INTO PEND-TX-DESC                                    10143000
101440       ELSE                                                       10144000
101450         STRING                                                   10145000
101460         OSB-DESC-0016-A DELIMITED BY SIZE                        10146000
101470         OSB-DESC-0016-B DELIMITED BY SIZE                        10147000
101480             INTO PEND-TX-DESC.                                   10148000
101490     IF ODB-PEG-BAL-TX-SW = 1                                     10149000
101500         STRING                                                   10150000
101510         OSB-DESC-0017-A DELIMITED BY SIZE                        10151000
101520         OSB-DESC-0017-B DELIMITED BY SIZE                        10152000
101530             INTO PEND-TX-DESC.                                   10153000
101540                                                                  10154000
101550 P2825-CONT.                                                      10155000
101560     EXEC SQL                                                     10156000
101570         INSERT INTO DSDS.PEND                                    10157000
101580             (PEND_BANK_NBR,                                      10158000
101590              PEND_ACCT_ID,                                       10159000
101600              PEND_ACCT_NBR,                                      10160000
101610              PEND_TX_CODE,                                       10161000
101620              PEND_TX_AMOUNT,                                     10162000
101630              PEND_EFFECT_DATE,                                   10163000
101640              PEND_BATCH_NBR,                                     10164000
101650              PEND_SEQUENCE_NBR,                                  10165000
101660              PEND_TX_DESC,                                       10166000
101670              PEND_SOURCE_PROG)                                   10167000
101680         VALUES                                                   10168000
101690             (:PEND-BANK-NBR,                                     10169000
101700              :PEND-ACCT-ID,                                      10170000
101710              :PEND-ACCT-NBR,                                     10171000
101720              :PEND-TX-CODE,                                      10172000
101730              :PEND-TX-AMOUNT,                                    10173000
101740              :PEND-EFFECT-DATE,                                  10174000
101750              :PEND-BATCH-NBR,                                    10175000
101760              :PEND-SEQUENCE-NBR,                                 10176000
101770              :PEND-TX-DESC,                                      10177000
101780              :PEND-SOURCE-PROG)                                  10178000
101790     END-EXEC.                                                    10179000
101800     EVALUATE SQLCODE                                             10180000
101810         WHEN ZEROS                                               10181000
101820             CONTINUE                                             10182000
101830         WHEN +100                                                10183000
101840             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      10184000
101850             CALL 'CDCUT90' USING SQLCA                           10185000
101860             CALL 'CDCDUMP' USING BY CONTENT '2050'               10186000
101870         WHEN OTHER                                               10187000
101880             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      10188000
101890             CALL 'CDCUT90' USING SQLCA                           10189000
101900             CALL 'CDCDUMP' USING BY CONTENT '2051'               10190000
101910     END-EVALUATE.                                                10191000
101920     EXEC SQL                                                     10192000
101930         COMMIT                                                   10193000
101940     END-EXEC.                                                    10194000
101950                                                                  10195000
101960 P2830-EXIT.                                                      10196000
101970     EXIT.                                                        10197000
101980                                                                  10198000
101990******************************************************************10199000
102000*               O D B   C Y C L E   R O U T I N E                *10200000
102010******************************************************************10201000
102020 P2850-CYCLE-ODB.                                                 10202000
102030     IF ODB-MONTHLY-PYMT                                          10203000
102040         MOVE 1 TO HOLD-ODB-PYMT-FREQ                             10204000
102050         GO TO P2860-POST.                                        10205000
102060     IF ODB-QUARTERLY-PYMT                                        10206000
102070         IF TDY-MO = 03 OR 06 OR 09 OR 12                         10207000
102080             MOVE 3 TO HOLD-ODB-PYMT-FREQ                         10208000
102090             GO TO P2860-POST.                                    10209000
102100     IF ODB-SEMI-ANNUAL-PYMT                                      10210000
102110         IF TDY-MO = 06 OR 12                                     10211000
102120             MOVE 6 TO HOLD-ODB-PYMT-FREQ                         10212000
102130             GO TO P2860-POST.                                    10213000
102140     MOVE 0 TO HOLD-ODB-PYMT-FREQ.                                10214000
102150     GO TO P2970-UPDATE-CYCLE.                                    10215000
102160                                                                  10216000
102170 P2860-POST.                                                      10217000
102180     PERFORM P3100-POST-FIN-CHRG THRU P3109-EXIT.                 10218000
102190     PERFORM P3150-POST-CR-LIFE THRU P3159-EXIT.                  10219000
102200     IF DAYS-IN-CYCLE = ZEROS                                     10220000
102210         MOVE ZEROS TO AVG-BAL-TO-COMPUTE                         10221000
102220         MOVE ZEROS TO HOLD-2ND-AVG-BAL                           10222000
102230       ELSE                                                       10223000
102240         COMPUTE AVG-BAL-TO-COMPUTE ROUNDED =                     10224000
102250             GROSS-LOAN-BAL / DAYS-IN-CYCLE                       10225000
102260         COMPUTE HOLD-2ND-AVG-BAL ROUNDED =                       10226000
102270             2ND-GROSS-LOAN-BAL / DAYS-IN-CYCLE                   10227000
102280     END-IF.                                                      10228000
102290     IF ODB-NUM-PYMTS-TO-WAIVE GREATER THAN ZERO                  10229000
102300         SUBTRACT 1 FROM ODB-NUM-PYMTS-TO-WAIVE                   10230000
102310         MOVE 19 TO HOLD-REASON-CODE                              10231000
102320         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         10232000
102330         GO TO P2970-UPDATE-CYCLE.                                10233000
102340     IF ODB-LOAN-BAL = ZERO                                       10234000
102350         GO TO P2970-UPDATE-CYCLE.                                10235000
102360                                                                  10236000
102370 P2870-CALC-TEMP-PAYMENT.                                         10237000
102380     MULTIPLY ODB-MIN-PYMT-AMT BY HOLD-ODB-PYMT-FREQ              10238000
102390         GIVING HOLD-ODB-MIN-PYMT-AMT.                            10239000
102400     IF ODB-P-AND-I                                               10240000
102410         GO TO P2880-PRINCIPAL-AND-INT.                           10241000
102420     IF ODB-INT-ONLY                                              10242000
102430         GO TO P2885-INTEREST-ONLY.                               10243000
102440     ADD HOLD-ODB-INT-AMT TO HOLD-ODB-MIN-PYMT-AMT.               10244000
102450     IF ODB-FIX-PYMT-AND-I                                        10245000
102460         GO TO P2890-FIXED-PYMT-AND-INT.                          10246000
102470     IF ODB-FIX-PC-PYMT-AND-I                                     10247000
102480         GO TO P2895-FIXED-PC-PYMT-AND-INT.                       10248000
102490                                                                  10249000
102500 P2880-PRINCIPAL-AND-INT.                                         10250000
102510     COMPUTE PAYMENT-DOLLARS ROUNDED =                            10251000
102520         ODB-LOAN-BAL * ODB-MIN-PYMT-PC * HOLD-ODB-PYMT-FREQ.     10252000
102530     MOVE PAYMENT-DOLLARS TO TEMP-PAYMENT.                        10253000
102540     IF HOLD-ODB-MIN-PYMT-AMT GREATER THAN TEMP-PAYMENT           10254000
102550         MOVE HOLD-ODB-MIN-PYMT-AMT TO TEMP-PAYMENT.              10255000
102560     IF TEMP-PAYMENT GREATER THAN ODB-LOAN-BAL                    10256000
102570         MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                       10257000
102580     GO TO P2910-POST-CK.                                         10258000
102590                                                                  10259000
102600 P2885-INTEREST-ONLY.                                             10260000
102610     MOVE HOLD-ODB-INT-AMT TO TEMP-PAYMENT.                       10261000
102620     GO TO P2910-POST-CK.                                         10262000
102630                                                                  10263000
102640 P2890-FIXED-PYMT-AND-INT.                                        10264000
102650     IF ODB-FIXED-PYMT-AMT = ZERO                                 10265000
102660         GO TO P2880-PRINCIPAL-AND-INT.                           10266000
102670     COMPUTE TEMP-PAYMENT ROUNDED =                               10267000
102680         ODB-FIXED-PYMT-AMT * HOLD-ODB-PYMT-FREQ +                10268000
102690         HOLD-ODB-INT-AMT.                                        10269000
102700     IF TEMP-PAYMENT GREATER THAN ODB-LOAN-BAL                    10270000
102710         MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                       10271000
102720     GO TO P2910-POST-CK.                                         10272000
102730                                                                  10273000
102740 P2895-FIXED-PC-PYMT-AND-INT.                                     10274000
102750     IF ODB-FIXED-PYMT-PC = ZERO                                  10275000
102760         GO TO P2880-PRINCIPAL-AND-INT.                           10276000
102770     COMPUTE PAYMENT-DOLLARS ROUNDED =                            10277000
102780         ODB-LOAN-BAL * ODB-FIXED-PYMT-PC * HOLD-ODB-PYMT-FREQ.   10278000
102790     ADD PAYMENT-DOLLARS  HOLD-ODB-INT-AMT GIVING TEMP-PAYMENT.   10279000
102800     IF HOLD-ODB-MIN-PYMT-AMT GREATER THAN TEMP-PAYMENT           10280000
102810         MOVE HOLD-ODB-MIN-PYMT-AMT TO TEMP-PAYMENT.              10281000
102820     IF TEMP-PAYMENT GREATER THAN ODB-LOAN-BAL                    10282000
102830         MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                       10283000
102840     GO TO P2910-POST-CK.                                         10284000
102850                                                                  10285000
102860 P2910-POST-CK.                                                   10286000
102870     IF MAN-MIN-PMNT-DIFF-NOT-USED                                10287000
102880         GO TO P2915-POST-CK-CONT.                                10288000
102890     IF ODB-MAN-PYMT-ACCUM = ZERO                                 10289000
102900         GO TO P2915-POST-CK-CONT.                                10290000
102910     IF ODB-MAN-PYMT-ACCUM LESS THAN TEMP-PAYMENT                 10291000
102920         NEXT SENTENCE                                            10292000
102930       ELSE                                                       10293000
102940         GO TO P2970-UPDATE-CYCLE.                                10294000
102950     SUBTRACT ODB-MAN-PYMT-ACCUM FROM TEMP-PAYMENT.               10295000
102960     IF TEMP-PAYMENT LESS THAN +5.00                              10296000
102970         GO TO P2970-UPDATE-CYCLE.                                10297000
102980                                                                  10298000
102990 P2915-POST-CK-CONT.                                              10299000
103000     IF ODB-BILL-AT-CYCLE                                         10300000
103010         PERFORM P3450-CREATE-ODB-BILL THRU P3479-EXIT            10301000
103020         GO TO P2970-UPDATE-CYCLE.                                10302000
103030     IF ODB-ACCT-TO-BE-CHRG GREATER THAN ZERO                     10303000
103040         GO TO P2940-POST-PAYMENT.                                10304000
103050     IF ODB-MANUAL-PAY OR ODB-MANUAL-PAY-CUTOFF                   10305000
103060         GO TO P2950-INSF-BAL.                                    10306000
103070     IF ODB-CURR-PEG-BAL OR ODB-COLL-PEG-BAL                      10307000
103080         GO TO P2950-INSF-BAL.                                    10308000
103090     IF PAYMENT-AT-CYCLE                                          10309000
103100         GO TO P2935-CHK-CURR-BAL.                                10310000
103110     IF CURRENT-BALANCE GREATER THAN ZERO                         10311000
103120         NEXT SENTENCE                                            10312000
103130       ELSE                                                       10313000
103140         GO TO P2950-INSF-BAL.                                    10314000
103150     IF CURRENT-BALANCE LESS THAN ODB-LOAN-BAL                    10315000
103160         GO TO P2920-CHK-PARTIAL.                                 10316000
103170     MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                           10317000
103180     GO TO P2940-POST-PAYMENT.                                    10318000
103190                                                                  10319000
103200 P2920-CHK-PARTIAL.                                               10320000
103210     IF PAYOFF-DAILY-PARTIAL                                      10321000
103220         NEXT SENTENCE                                            10322000
103230       ELSE                                                       10323000
103240         GO TO P2935-CHK-CURR-BAL.                                10324000
103250     MOVE CURRENT-BALANCE TO TEMP-PAYMENT.                        10325000
103260                                                                  10326000
103270 P2935-CHK-CURR-BAL.                                              10327000
103280     SUBTRACT HOLD-ACCUM FROM CURRENT-BALANCE                     10328000
103290         GIVING TEMP-CURR-BAL.                                    10329000
103300     IF TEMP-CURR-BAL LESS THAN TEMP-PAYMENT                      10330000
103310         GO TO P2950-INSF-BAL.                                    10331000
103320                                                                  10332000
103330 P2940-POST-PAYMENT.                                              10333000
103340     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 10334000
103350     MOVE ZEROS TO NUM-DAYS-DELQ  NUM-PAST-DUE-PMNTS.             10335000
103360     GO TO P2970-UPDATE-CYCLE.                                    10336000
103370                                                                  10337000
103380 P2950-INSF-BAL.                                                  10338000
103390     IF TEMP-PAYMENT GREATER THAN ODB-MAN-PYMT-ACCUM              10339000
103400         NEXT SENTENCE                                            10340000
103410       ELSE                                                       10341000
103420         GO TO P2970-UPDATE-CYCLE.                                10342000
103430     ADD TEMP-PAYMENT TO AMT-PAST-DUE.                            10343000
103440     IF AMT-PAST-DUE GREATER THAN ODB-LOAN-BAL                    10344000
103450         MOVE ODB-LOAN-BAL TO AMT-PAST-DUE.                       10345000
103460     ADD 1 TO NUM-PAST-DUE-PMNTS                                  10346000
103470              NUM-TIMES-DELQ.                                     10347000
103480     IF EQUITY-CREDIT OR PRIORITY-LINE OR HOME-EQUITY OR          10348000
103490        (PROC-BK-NO = 01 AND EMPLOYEE-RESERVE)                    10349000
103500         IF NUM-PAST-DUE-PMNTS GREATER THAN 006                   10350000
103510             GO TO P2960-CUTOFF                                   10351000
103520           ELSE                                                   10352000
103530             IF NUM-PAST-DUE-PMNTS GREATER THAN 001               10353000
103540                 MOVE '6' TO HISTORY-CARD-IND                     10354000
103550                 PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT     10355000
103560             END-IF                                               10356000
103570             GO TO P2970-UPDATE-CYCLE.                            10357000
103580     IF NUM-PAST-DUE-PMNTS GREATER THAN 001                       10358000
103590         GO TO P2960-CUTOFF.                                      10359000
103600     GO TO P2970-UPDATE-CYCLE.                                    10360000
103610                                                                  10361000
103620 P2960-CUTOFF.                                                    10362000
103630     IF ODB-CUTOFF OR ODB-MANUAL-PAY-CUTOFF                       10363000
103640         MOVE '2' TO HISTORY-CARD-IND                             10364000
103650         PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT             10365000
103660         GO TO P2970-UPDATE-CYCLE.                                10366000
103670     IF ODB-NORMAL OR ODB-MANUAL-PAY                              10367000
103680         NEXT SENTENCE                                            10368000
103690       ELSE                                                       10369000
103700         GO TO P2970-UPDATE-CYCLE.                                10370000
103710     IF ODB-NORMAL                                                10371000
103720         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                10372000
103730         MOVE '02' TO ODB-STATUS-CODE                             10373000
103740                      HOLD-NEW-ODB-STAT                           10374000
103750       ELSE                                                       10375000
103760         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                10376000
103770         MOVE '06' TO ODB-STATUS-CODE                             10377000
103780                      HOLD-NEW-ODB-STAT                           10378000
103790     END-IF.                                                      10379000
103800     MOVE 'Y' TO HOLD-EXTRACT-IND.                                10380000
103810     PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT.        10381000
103820     MOVE '2' TO HISTORY-CARD-IND.                                10382000
103830     PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.                10383000
103840                                                                  10384000
103850 P2970-UPDATE-CYCLE.                                              10385000
103860     MOVE PREV-STMT-BAL TO HOLD-PREV-ODB-STMT-BAL.                10386000
103870     IF CYCLE-THIS-STMT = 1                                       10387000
103880         MOVE ODB-LOAN-BAL TO PREV-STMT-BAL.                      10388000
103890     MOVE GROSS-LOAN-BAL     TO HOLD-GROSS-LOAN-BAL.              10389000
103900     MOVE 2ND-GROSS-LOAN-BAL TO HOLD-2ND-GROSS-LOAN-BAL.          10390000
103910     MOVE ZEROS              TO GROSS-LOAN-BAL.                   10391000
103920     MOVE ZEROS              TO 2ND-GROSS-LOAN-BAL.               10392000
103930     IF HOLD-ODB-PYMT-FREQ GREATER THAN 0                         10393000
103940         MOVE ZEROS TO ODB-MAN-PYMT-ACCUM.                        10394000
103950                                                                  10395000
103960 P2980-GET-NEW-ODB-RATES.                                         10396000
103970     MOVE FIRST-INT-RATE  TO HOLD-PREV-XX-ODB-RATE1.              10397000
103980     MOVE FIRST-INT-AMT   TO HOLD-PREV-XX-ODB-AMT1.               10398000
103990     MOVE SECOND-INT-RATE TO HOLD-PREV-XX-ODB-RATE2.              10399000
104000     IF ODB-FIXED-RATE                                            10400000
104010         GO TO P2990-GET-NEW-CR-L-RATES.                          10401000
104020     MOVE FIRST-INT-RATE TO ODB-PREV-INT-RATE.                    10402000
104030     MOVE XX-ODB-RATE1 (SUB14) TO FIRST-INT-RATE.                 10403000
104040     MOVE XX-ODB-AMT1 (SUB14)  TO FIRST-INT-AMT.                  10404000
104050     MOVE XX-ODB-RATE2 (SUB14) TO SECOND-INT-RATE.                10405000
104060     IF ODB-NO-VARIANCE                                           10406000
104070         GO TO P2990-GET-NEW-CR-L-RATES.                          10407000
104080     IF ODB-PLUS-VARIANCE                                         10408000
104090         ADD FIRST-INT-RATE  ODB-RATE-VARIANCE GIVING ODB-RATE-WK 10409000
104100       ELSE                                                       10410000
104110         SUBTRACT ODB-RATE-VARIANCE FROM FIRST-INT-RATE           10411000
104120             GIVING ODB-RATE-WK.                                  10412000
104130     IF ODB-RATE-WK GREATER THAN ZERO AND                         10413000
104140        ODB-RATE-WK LESS THAN XX-ODB-USURY (SUB14)                10414000
104150         GO TO P2990-GET-NEW-CR-L-RATES.                          10415000
104160     MOVE 27 TO HOLD-REASON-CODE.                                 10416000
104170     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            10417000
104180                                                                  10418000
104190 P2990-GET-NEW-CR-L-RATES.                                        10419000
104200     IF NO-CR-LIFE                                                10420000
104210         MOVE ZEROS TO CRED-LIFE-RATE                             10421000
104220         GO TO P2999-EXIT.                                        10422000
104230     IF SINGLE-CR-LIFE                                            10423000
104240         MOVE ODB-CL-SINGLE-RATE (SUB14) TO CRED-LIFE-RATE        10424000
104250         GO TO P2999-EXIT.                                        10425000
104260     IF JOINT-CR-LIFE                                             10426000
104270         MOVE ODB-CL-JOINT-RATE (SUB14) TO CRED-LIFE-RATE.        10427000
104280                                                                  10428000
104290 P2999-EXIT.                                                      10429000
104300     EXIT.                                                        10430000
104310                                                                  10431000
104320******************************************************************10432000
104330*    P O S T   F I N A N C E   C H A R G E                       *10433000
104340******************************************************************10434000
104350 P3100-POST-FIN-CHRG.                                             10435000
104360     IF MONTHLY-ACCUM-INT = ZERO                                  10436000
104370         MOVE ZEROS TO ODB-ACCRUED-F-C                            10437000
104380                       HOLD-ODB-INT-AMT                           10438000
104390         GO TO P3109-EXIT.                                        10439000
104400     MOVE 1 TO DSDSTXL-PENDING-SW.                                10440000
104410     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     10441000
104420     MOVE MONTHLY-ACCUM-INT TO DSDSTXL-AMOUNT                     10442000
104430                               LAST-INT-AMT                       10443000
104440                               HOLD-ODB-INT-AMT.                  10444000
104450     ADD  MONTHLY-ACCUM-INT TO TDY-COLL-BY-PLAN-ODB (SUB10)       10445000
104460                               TDY-COLL-BY-PLAN-ODB (11)          10446000
104470                               ODB-ACCUM-INT-CHARGED              10447000
104480                               ODB-LOAN-BAL.                      10448000
104490     MOVE MONTHLY-ACCUM-INT TO OBGL-COLL-INT-AMT.                 10449000
104500     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             10450000
104510     IF ODB-SECURED-BY-RE-2 OR EQUITY-CREDIT OR HOME-EQUITY OR    10451000
104520        (PROC-BK-NO = 01 AND EMPLOYEE-RESERVE)                    10452000
104530         ADD MONTHLY-ACCUM-INT TO ODB-YTD-INT-SECURED             10453000
104540       ELSE                                                       10454000
104550         ADD MONTHLY-ACCUM-INT TO YTD-ODB-INT.                    10455000
104560     IF CYCLE-THIS-STMT = 1 OR                                    10456000
104570        CYCLE-THIS-SC-EARN = 1                                    10457000
104580         MOVE PROC-THRU-DATE TO LAST-INT-DATE                     10458000
104590       ELSE                                                       10459000
104600         MOVE PROC-CURR-DATE TO LAST-INT-DATE.                    10460000
104610     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10461000
104620     MOVE ZEROS TO MONTHLY-ACCUM-INT                              10462000
104630                   ODB-ACCRUED-F-C.                               10463000
104640     MOVE OSB-DESC-0019-A TO DSDSTXL-CO-DESC.                     10464000
104650     MOVE OSB-DESC-0019-B TO DSDSTXL-DESC.                        10465000
104660     MOVE 687 TO DSDSTXL-CODE.                                    10466000
104670     MOVE ODB-FIN-CHG-KEY TO DSDSTXL-SORT-KEY.                    10467000
104680     ADD 1 TO NUM-BILL-TX.                                        10468000
104690     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     10469000
104700     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 10470000
104710                                                                  10471000
104720 P3109-EXIT.                                                      10472000
104730     EXIT.                                                        10473000
104740                                                                  10474000
104750******************************************************************10475000
104760*    P O S T   C R E D I T   L I F E                             *10476000
104770******************************************************************10477000
104780 P3150-POST-CR-LIFE.                                              10478000
104790     IF ODB-ACCUM-CR-LIFE LESS THAN +.010                         10479000
104800         MOVE ZEROS TO ODB-ACCUM-CR-LIFE                          10480000
104810         GO TO P3159-EXIT.                                        10481000
104820     MOVE 1 TO DSDSTXL-PENDING-SW.                                10482000
104830     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     10483000
104840     MOVE 688 TO DSDSTXL-CODE.                                    10484000
104850     MOVE OSB-DESC-0020-A TO DSDSTXL-CO-DESC.                     10485000
104860     MOVE OSB-DESC-0020-B TO DSDSTXL-DESC.                        10486000
104870     MOVE ODB-INS-CHG-KEY TO DSDSTXL-SORT-KEY.                    10487000
104880     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10488000
104890     MOVE ZEROS TO DSDSTXL-AMOUNT.                                10489000
104900     ADD ODB-ACCUM-CR-LIFE TO ODB-LOAN-BAL                        10490000
104910                              DSDSTXL-AMOUNT                      10491000
104920                              CR-LIFE-PAID-MTD                    10492000
104930                              AMT-ODB-ADV-ON-STMT                 10493000
104940                              HOLD-ODB-INT-AMT.                   10494000
104950     MOVE ZEROS TO ODB-ACCUM-CR-LIFE.                             10495000
104960     ADD 1 TO NUM-BILL-TX.                                        10496000
104970     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     10497000
104980     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 10498000
104990                                                                  10499000
105000 P3159-EXIT.                                                      10500000
105010     EXIT.                                                        10501000
105020                                                                  10502000
105030******************************************************************10503000
105040*    O D B   M O N T H L Y   O R   A N N U A L   F E E           *10504000
105050******************************************************************10505000
105060 P3200-ODB-FEE.                                                   10506000
105070     IF CLOSED                                                    10507000
105080         GO TO P3249-EXIT.                                        10508000
105090     IF ODB-NORMAL OR                                             10509000
105100        ODB-MANUAL-PAY OR                                         10510000
105110        ODB-CUTOFF OR                                             10511000
105120        ODB-MANUAL-PAY-CUTOFF                                     10512000
105130         NEXT SENTENCE                                            10513000
105140       ELSE                                                       10514000
105150         GO TO P3249-EXIT.                                        10515000
105160     IF ODB-FEE-GRANDFATHER OR                                    10516000
105170        ODB-FEE-NO-FEE OR                                         10517000
105180        ODB-FEE-WAIVE                                             10518000
105190         GO TO P3249-EXIT.                                        10519000
105200     IF DTE-LAST-CYCLE-STMT = ZEROS                               10520000
105210         GO TO P3249-EXIT.                                        10521000
105220     IF ODB-FEE-MONTHLY-CHARGE                                    10522000
105230         GO TO P3210-MONTHLY-FEE.                                 10523000
105240     GO TO P3220-ANNUAL-FEE.                                      10524000
105250                                                                  10525000
105260 P3210-MONTHLY-FEE.                                               10526000
105270     MOVE 1 TO DSDSTXL-PENDING-SW.                                10527000
105280     ADD 1 TO NUM-BILL-TX.                                        10528000
105290     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     10529000
105300     MOVE 'ODB' TO PJ-HOLD-CODE.                                  10530000
105310     MOVE 749 TO DSDSTXL-CODE.                                    10531000
105320     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10532000
105330     MOVE ODB-FEE-AMOUNT (SUB14) TO DSDSTXL-AMOUNT.               10533000
105340     MOVE ODB-PLAN-DESC (SUB14) TO ODB-M-FEE-DESC-PLAN.           10534000
105350     MOVE LENGTH OF ODB-M-FEE-DESC-PLAN TO CDCUT34-LENGTH.        10535000
105360     CALL 'CDCUT34' USING CDCUT34-LENGTH                          10536000
105370                          ODB-M-FEE-DESC-PLAN.                    10537000
105380     MOVE ODB-M-FEE-DESC-1 TO DSDSTXL-CO-DESC.                    10538000
105390     MOVE ODB-M-FEE-DESC-2 TO DSDSTXL-DESC.                       10539000
105400     MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY.                     10540000
105410     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             10541000
105420     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          10542000
105430                           MONTHLY-FEES-BY-PLAN-ODB (SUB10)       10543000
105440                           ODB-FEE-MTD.                           10544000
105450     MOVE DSDSTXL-AMOUNT    TO OBGL-MO-FEE-AMT.                   10545000
105460     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             10546000
105470     ADD 1 TO GEN-DEBIT-CNT.                                      10547000
105480     PERFORM P1665-NORM-DEBIT.                                    10548000
105490     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 10549000
105500     GO TO P3249-EXIT.                                            10550000
105510                                                                  10551000
105520 P3220-ANNUAL-FEE.                                                10552000
105530     MOVE ODB-REVIEW-DATE TO ODB-REVIEW-DATE-WK2.                 10553000
105540     IF TDY-MO = ODB-RD-MO2                                       10554000
105550         NEXT SENTENCE                                            10555000
105560       ELSE                                                       10556000
105570         GO TO P3249-EXIT.                                        10557000
105580     MOVE 1 TO DSDSTXL-PENDING-SW.                                10558000
105590     ADD 1 TO NUM-BILL-TX.                                        10559000
105600     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     10560000
105610     MOVE 'ODB' TO PJ-HOLD-CODE.                                  10561000
105620     MOVE 749 TO DSDSTXL-CODE.                                    10562000
105630     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       10563000
105640     MOVE ODB-FEE-AMOUNT (SUB14) TO DSDSTXL-AMOUNT.               10564000
105650     MOVE ODB-PLAN-DESC (SUB14) TO ODB-A-FEE-DESC-PLAN.           10565000
105660     MOVE LENGTH OF ODB-A-FEE-DESC-PLAN TO CDCUT34-LENGTH.        10566000
105670     CALL 'CDCUT34' USING CDCUT34-LENGTH                          10567000
105680                          ODB-A-FEE-DESC-PLAN.                    10568000
105690     MOVE ODB-A-FEE-DESC-1 TO DSDSTXL-CO-DESC.                    10569000
105700     MOVE ODB-A-FEE-DESC-2 TO DSDSTXL-DESC.                       10570000
105710     MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY.                     10571000
105720     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             10572000
105730     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          10573000
105740                           MONTHLY-FEES-BY-PLAN-ODB (SUB10)       10574000
105750                           ODB-FEE-MTD.                           10575000
105760     MOVE DSDSTXL-AMOUNT    TO OBGL-MO-FEE-AMT.                   10576000
105770     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             10577000
105780     ADD 1 TO GEN-DEBIT-CNT.                                      10578000
105790     PERFORM P1665-NORM-DEBIT.                                    10579000
105800     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 10580000
105810     GO TO P3249-EXIT.                                            10581000
105820                                                                  10582000
105830 P3249-EXIT.                                                      10583000
105840     EXIT.                                                        10584000
105850                                                                  10585000
105860******************************************************************10586000
105870*    O D B   P A S T   D U E   N O T I C E S                     *10587000
105880******************************************************************10588000
105890 P3250-CHK-ODB-NOTICE.                                            10589000
105900     IF ODB-NORMAL OR ODB-MANUAL-PAY                              10590000
105910         NEXT SENTENCE                                            10591000
105920       ELSE                                                       10592000
105930         GO TO P3270-CHK-CUTOFF.                                  10593000
105940     IF NUM-DAYS-DELQ LESS THAN +010                              10594000
105950         GO TO P3270-CHK-CUTOFF.                                  10595000
105960     IF 1ST-NOTICE-SENT                                           10596000
105970         GO TO P3260-CHK-NTC-2.                                   10597000
105980     EVALUATE PROC-CURR-DAYS                                      10598000
105990         WHEN +1                                                  10599000
106000             CONTINUE                                             10600000
106010         WHEN +2                                                  10601000
106020             IF NUM-DAYS-DELQ LESS THAN +011                      10602000
106030                 GO TO P3270-CHK-CUTOFF                           10603000
106040             END-IF                                               10604000
106050         WHEN +3                                                  10605000
106060             IF NUM-DAYS-DELQ LESS THAN +012                      10606000
106070                 GO TO P3270-CHK-CUTOFF                           10607000
106080             END-IF                                               10608000
106090         WHEN +4                                                  10609000
106100             IF NUM-DAYS-DELQ LESS THAN +013                      10610000
106110                 GO TO P3270-CHK-CUTOFF                           10611000
106120             END-IF                                               10612000
106130         WHEN OTHER                                               10613000
106140             CONTINUE                                             10614000
106150     END-EVALUATE.                                                10615000
106160     IF ODB-BILL-AT-CYCLE                                         10616000
106170         ADD 1 TO NUM-TIMES-DELQ.                                 10617000
106180     MOVE SPACES TO SPECIAL-WORK.                                 10618000
106190     MOVE 001 TO PR-MESSAGE.                                      10619000
106200     PERFORM P3290-BUILD-PAST-DUE-NTC THRU P3310-EXIT.            10620000
106210     GO TO P3270-CHK-CUTOFF.                                      10621000
106220                                                                  10622000
106230 P3260-CHK-NTC-2.                                                 10623000
106240     IF NUM-DAYS-DELQ LESS THAN +020                              10624000
106250         GO TO P3270-CHK-CUTOFF.                                  10625000
106260     IF 2ND-NOTICE-SENT                                           10626000
106270         GO TO P3270-CHK-CUTOFF.                                  10627000
106280     EVALUATE PROC-CURR-DAYS                                      10628000
106290         WHEN +1                                                  10629000
106300             CONTINUE                                             10630000
106310         WHEN +2                                                  10631000
106320             IF NUM-DAYS-DELQ LESS THAN +021                      10632000
106330                 GO TO P3270-CHK-CUTOFF                           10633000
106340             END-IF                                               10634000
106350         WHEN +3                                                  10635000
106360             IF NUM-DAYS-DELQ LESS THAN +022                      10636000
106370                 GO TO P3270-CHK-CUTOFF                           10637000
106380             END-IF                                               10638000
106390         WHEN +4                                                  10639000
106400             IF NUM-DAYS-DELQ LESS THAN +023                      10640000
106410                 GO TO P3270-CHK-CUTOFF                           10641000
106420             END-IF                                               10642000
106430         WHEN OTHER                                               10643000
106440             CONTINUE                                             10644000
106450     END-EVALUATE.                                                10645000
106460     MOVE SPACES TO SPECIAL-WORK.                                 10646000
106470     MOVE 002 TO PR-MESSAGE.                                      10647000
106480     PERFORM P3290-BUILD-PAST-DUE-NTC THRU P3310-EXIT.            10648000
106490     GO TO P3270-CHK-CUTOFF.                                      10649000
106500                                                                  10650000
106510 P3270-CHK-CUTOFF.                                                10651000
106520     IF ODB-NORMAL OR ODB-MANUAL-PAY                              10652000
106530         GO TO P3280-CHK-OVER-LIMIT.                              10653000
106540     IF ODB-CLOSED-DELETE                                         10654000
106550         GO TO P3320-EXIT.                                        10655000
106560     MOVE 01 TO HOLD-REASON-CODE.                                 10656000
106570     PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT.            10657000
106580     GO TO P3320-EXIT.                                            10658000
106590                                                                  10659000
106600 P3280-CHK-OVER-LIMIT.                                            10660000
106610     IF ODB-LOAN-BAL GREATER THAN AUTH-CREDIT-LIMIT               10661000
106620         NEXT SENTENCE                                            10662000
106630       ELSE                                                       10663000
106640         GO TO P3320-EXIT.                                        10664000
106650     MOVE 02 TO HOLD-REASON-CODE.                                 10665000
106660     PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT.            10666000
106670     GO TO P3320-EXIT.                                            10667000
106680                                                                  10668000
106690 P3290-BUILD-PAST-DUE-NTC.                                        10669000
106700     IF NO-PAY-REMINDER                                           10670000
106710         GO TO P3310-EXIT.                                        10671000
106720     MOVE 092 TO SUB1.                                            10672000
106730     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               10673000
106740     IF HOLD-FREQ-RPT = 0                                         10674000
106750         GO TO P3310-EXIT.                                        10675000
106760     MOVE 092 TO PR-REPORT-CODE.                                  10676000
106770     MOVE 'ODB'        TO PR-FILE-ID.                             10677000
106780     MOVE BCF-BANK-NO TO PR-BANK-NO.                              10678000
106790     MOVE ACCOUNT-ID TO PR-ACCT-ID.                               10679000
106800     MOVE ACCOUNT-NUMBER TO PR-ACCT-NO.                           10680000
106810     MOVE LOW-VALUES TO PR-CRF-REC-ID.                            10681000
106820     MOVE ODB-LOAN-BAL TO PR-LOAN-BAL.                            10682000
106830     MOVE AMT-PAST-DUE TO PR-AMT-DUE.                             10683000
106840     MOVE PROC-CURR-DATE TO PR-DT.                                10684000
106850     IF DTE-LAST-SPEC-STMT = ZERO                                 10685000
106860         MOVE DTE-LAST-CYCLE-STMT TO PR-LAST-STMT-DT              10686000
106870       ELSE                                                       10687000
106880         MOVE DTE-LAST-SPEC-STMT TO PR-LAST-STMT-DT.              10688000
106890     MOVE ODB-PLAN-DESC (SUB14) TO PR-PLAN-DESC.                  10689000
106900     MOVE ODB-PLAN TO PR-PLAN-TYPE.                               10690000
106910     MOVE ODB-COLLATERAL-CODE TO PR-COLLATERAL-CODE.              10691000
106920     MOVE ODB-STATUS-CODE TO PR-ODB-STATUS.                       10692000
106930     MOVE ODB-BILLING-IND TO PR-BILL-IND.                         10693000
106940     IF PR-MESSAGE = 001                                          10694000
106950         MOVE '1' TO FIRST-NOTICE-SW                              10695000
106960         GO TO P3300-WRITE-PAST-DUE-NTC.                          10696000
106970     IF PR-MESSAGE = 002                                          10697000
106980         MOVE '1' TO SECOND-NOTICE-SW.                            10698000
106990                                                                  10699000
107000 P3300-WRITE-PAST-DUE-NTC.                                        10700000
107010     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           10701000
107020                                                                  10702000
107030 P3310-EXIT.                                                      10703000
107040     EXIT.                                                        10704000
107050                                                                  10705000
107060 P3320-EXIT.                                                      10706000
107070     EXIT.                                                        10707000
107080                                                                  10708000
107090******************************************************************10709000
107100*        O D B   D A I L Y   P A Y O F F   R O U T I N E         *10710000
107110******************************************************************10711000
107120 P3350-DAILY-ODB-PAYOFF.                                          10712000
107130     IF CYCLE-THIS-SC-EARN = 1                                    10713000
107140         GO TO P3380-EXIT.                                        10714000
107150     IF ODB-LOAN-BAL = ZERO                                       10715000
107160         GO TO P3380-EXIT.                                        10716000
107170     IF ODB-MANUAL-PAY OR ODB-MANUAL-PAY-CUTOFF                   10717000
107180         GO TO P3380-EXIT.                                        10718000
107190     IF NO-ODB-PEG-BAL                                            10719000
107200         NEXT SENTENCE                                            10720000
107210       ELSE                                                       10721000
107220         GO TO P3380-EXIT.                                        10722000
107230     IF CURRENT-BALANCE NOT GREATER THAN ZERO                     10723000
107240         GO TO P3380-EXIT.                                        10724000
107250     IF CURRENT-BALANCE LESS THAN ODB-LOAN-BAL                    10725000
107260         GO TO P3360-CHK-PARTIAL.                                 10726000
107270     COMPUTE TEMP-LOAN-BAL =                                      10727000
107280         ODB-LOAN-BAL +                                           10728000
107290         ODB-ACCUM-CR-LIFE +                                      10729000
107300         MONTHLY-ACCUM-INT.                                       10730000
107310     IF CURRENT-BALANCE LESS THAN TEMP-LOAN-BAL                   10731000
107320         IF PAYOFF-DAILY-PARTIAL                                  10732000
107330             PERFORM P3100-POST-FIN-CHRG THRU P3109-EXIT          10733000
107340             PERFORM P3150-POST-CR-LIFE THRU P3159-EXIT           10734000
107350             MOVE CURRENT-BALANCE TO TEMP-PAYMENT                 10735000
107360             GO TO P3370-DAILY-PAYOFF                             10736000
107370         ELSE                                                     10737000
107380             GO TO P3380-EXIT                                     10738000
107390         END-IF                                                   10739000
107400     END-IF.                                                      10740000
107410     PERFORM P3100-POST-FIN-CHRG THRU P3109-EXIT.                 10741000
107420     PERFORM P3150-POST-CR-LIFE THRU P3159-EXIT.                  10742000
107430     MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                           10743000
107440     GO TO P3370-DAILY-PAYOFF.                                    10744000
107450                                                                  10745000
107460 P3360-CHK-PARTIAL.                                               10746000
107470     IF PAYOFF-DAILY-PARTIAL                                      10747000
107480         NEXT SENTENCE                                            10748000
107490       ELSE                                                       10749000
107500         GO TO P3380-EXIT.                                        10750000
107510     MOVE CURRENT-BALANCE TO TEMP-PAYMENT.                        10751000
107520                                                                  10752000
107530 P3370-DAILY-PAYOFF.                                              10753000
107540     IF AMT-PAST-DUE = ZERO                                       10754000
107550         PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT              10755000
107560         GO TO P3380-EXIT.                                        10756000
107570     IF TEMP-PAYMENT GREATER THAN AMT-PAST-DUE                    10757000
107580         SUBTRACT AMT-PAST-DUE FROM ODB-MAN-PYMT-ACCUM            10758000
107590         MOVE ZERO TO AMT-PAST-DUE                                10759000
107600       ELSE                                                       10760000
107610         SUBTRACT TEMP-PAYMENT FROM ODB-MAN-PYMT-ACCUM            10761000
107620                                    AMT-PAST-DUE.                 10762000
107630     IF NUM-PAST-DUE-PMNTS GREATER THAN 01                        10763000
107640         SUBTRACT 01 FROM NUM-PAST-DUE-PMNTS.                     10764000
107650     IF AMT-PAST-DUE = ZEROS                                      10765000
107660         MOVE ZEROS TO NUM-PAST-DUE-PMNTS                         10766000
107670                       NUM-DAYS-DELQ                              10767000
107680                       FIRST-NOTICE-SW                            10768000
107690                       SECOND-NOTICE-SW.                          10769000
107700     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 10770000
107710                                                                  10771000
107720 P3380-EXIT.                                                      10772000
107730     EXIT.                                                        10773000
107740                                                                  10774000
107750******************************************************************10775000
107760*      O D B   P E G G E D   B A L A N C E   R O U T I N E       *10776000
107770******************************************************************10777000
107780 P3400-ODB-PEGGED-BALANCE.                                        10778000
107790     IF NO-ODB-PEG-BAL                                            10779000
107800         GO TO P3430-EXIT.                                        10780000
107810     IF ODB-NORMAL OR ODB-MANUAL-PAY                              10781000
107820         NEXT SENTENCE                                            10782000
107830       ELSE                                                       10783000
107840         GO TO P3430-EXIT.                                        10784000
107850     IF ODB-CURR-PEG-BAL                                          10785000
107860         MOVE CURRENT-BALANCE TO TEMP-CURR-BAL                    10786000
107870       ELSE                                                       10787000
107880         COMPUTE TEMP-CURR-BAL =                                  10788000
107890             CURRENT-BALANCE -                                    10789000
107900             (ONE-DAY-FLOAT-AMT + TWO-DAY-FLOAT-AMT +             10790000
107910             THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +           10791000
107920             FIVE-DAY-FLOAT-AMT).                                 10792000
107930     IF ODB-PEGGED-BAL = TEMP-CURR-BAL                            10793000
107940         GO TO P3430-EXIT.                                        10794000
107950     IF ODB-PEGGED-BAL LESS THAN TEMP-CURR-BAL                    10795000
107960         GO TO P3410-NEED-PAYMENT.                                10796000
107970     GO TO P3420-NEED-ADVANCE.                                    10797000
107980                                                                  10798000
107990 P3410-NEED-PAYMENT.                                              10799000
108000     IF ODB-LOAN-BAL = ZERO                                       10800000
108010         GO TO P3430-EXIT.                                        10801000
108020     SUBTRACT ODB-PEGGED-BAL FROM TEMP-CURR-BAL                   10802000
108030         GIVING TEMP-PAYMENT.                                     10803000
108040     IF TEMP-PAYMENT GREATER THAN ODB-LOAN-BAL                    10804000
108050         MOVE ODB-LOAN-BAL TO TEMP-PAYMENT.                       10805000
108060     MOVE 1 TO ODB-PEG-BAL-TX-SW.                                 10806000
108070     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 10807000
108080     MOVE 0 TO ODB-PEG-BAL-TX-SW.                                 10808000
108090     GO TO P3430-EXIT.                                            10809000
108100                                                                  10810000
108110 P3420-NEED-ADVANCE.                                              10811000
108120     IF ODB-LOAN-BAL LESS THAN AUTH-CREDIT-LIMIT                  10812000
108130         SUBTRACT ODB-LOAN-BAL FROM AUTH-CREDIT-LIMIT             10813000
108140             GIVING TEMP-CR-AVAIL                                 10814000
108150       ELSE                                                       10815000
108160         GO TO P3430-EXIT.                                        10816000
108170     SUBTRACT TEMP-CURR-BAL FROM ODB-PEGGED-BAL                   10817000
108180         GIVING ADVANCE-TX-AMT.                                   10818000
108190     IF ADVANCE-TX-AMT GREATER THAN TEMP-CR-AVAIL                 10819000
108200         MOVE TEMP-CR-AVAIL TO ADVANCE-TX-AMT.                    10820000
108210     ADD ADVANCE-TX-AMT TO ODB-LOAN-BAL.                          10821000
108220     MOVE 1 TO ODB-PEG-BAL-TX-SW.                                 10822000
108230     PERFORM P2650-BUILD-ADV-TX THRU P2700-EXIT.                  10823000
108240     MOVE 0 TO ODB-PEG-BAL-TX-SW.                                 10824000
108250                                                                  10825000
108260 P3430-EXIT.                                                      10826000
108270     EXIT.                                                        10827000
108280                                                                  10828000
108290******************************************************************10829000
108300*      O D B   B I L L I N G   R O U T I N E                     *10830000
108310******************************************************************10831000
108320 P3450-CREATE-ODB-BILL.                                           10832000
108330     MOVE 098 TO SUB1.                                            10833000
108340     MOVE SPACES TO SPECIAL-WORK.                                 10834000
108350     MOVE 098 TO OB-REPORT-CODE.                                  10835000
108360     MOVE 'ODB'        TO OB-FILE-ID.                             10836000
108370     MOVE BCF-BANK-NO TO OB-BANK-NO.                              10837000
108380     MOVE ACCOUNT-ID TO OB-ACCT-ID.                               10838000
108390     MOVE ACCOUNT-NUMBER TO OB-ACCT-NO.                           10839000
108400     MOVE ODB-STATUS-CODE TO OB-ODB-STATUS.                       10840000
108410     MOVE ODB-PLAN-TYPE (SUB14) TO OB-ODB-PLAN-TYPE.              10841000
108420     MOVE ODB-PLAN-DESC (SUB14) TO OB-ODB-PLAN-DESC.              10842000
108430     MOVE LOAN-OFFICER-CODE TO OB-ODB-LOAN-OFFICER.               10843000
108440     MOVE AUTH-CREDIT-LIMIT TO OB-ODB-CR-LIMIT.                   10844000
108450     MOVE ODB-LOAN-BAL TO OB-ODB-LOAN-BAL.                        10845000
108460     MOVE AMT-PAST-DUE TO OB-PREV-AMT-DUE.                        10846000
108470     IF AMT-PAST-DUE GREATER THAN ZERO                            10847000
108480         ADD 1 TO NUM-TIMES-DELQ.                                 10848000
108490     ADD 1 TO NUM-PAST-DUE-PMNTS.                                 10849000
108500     MOVE TEMP-PAYMENT TO OB-CURR-AMT-DUE.                        10850000
108510     ADD TEMP-PAYMENT TO AMT-PAST-DUE.                            10851000
108520     MOVE PROC-CURR-DATE TO OB-CURR-DATE.                         10852000
108530     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           10853000
108540                                                                  10854000
108550 P3460-CHECK-PAST-DUE-PMNTS.                                      10855000
108560     IF EQUITY-CREDIT OR PRIORITY-LINE OR HOME-EQUITY OR          10856000
108570        (PROC-BK-NO = 01 AND EMPLOYEE-RESERVE)                    10857000
108580         IF NUM-PAST-DUE-PMNTS GREATER THAN 006                   10858000
108590             GO TO P3470-CUTOFF                                   10859000
108600           ELSE                                                   10860000
108610             MOVE '6' TO HISTORY-CARD-IND                         10861000
108620             PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT         10862000
108630             GO TO P3479-EXIT.                                    10863000
108640     IF NUM-PAST-DUE-PMNTS GREATER THAN 001                       10864000
108650         GO TO P3470-CUTOFF.                                      10865000
108660     GO TO P3479-EXIT.                                            10866000
108670                                                                  10867000
108680 P3470-CUTOFF.                                                    10868000
108690     IF ODB-CUTOFF OR ODB-MANUAL-PAY-CUTOFF                       10869000
108700         MOVE '2' TO HISTORY-CARD-IND                             10870000
108710         PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT             10871000
108720         GO TO P3479-EXIT.                                        10872000
108730     IF ODB-NORMAL OR ODB-MANUAL-PAY                              10873000
108740         NEXT SENTENCE                                            10874000
108750       ELSE                                                       10875000
108760         GO TO P3479-EXIT.                                        10876000
108770     IF ODB-NORMAL                                                10877000
108780         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                10878000
108790         MOVE '02' TO ODB-STATUS-CODE                             10879000
108800                      HOLD-NEW-ODB-STAT                           10880000
108810       ELSE                                                       10881000
108820         MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT                10882000
108830         MOVE '06' TO ODB-STATUS-CODE                             10883000
108840                      HOLD-NEW-ODB-STAT                           10884000
108850     END-IF.                                                      10885000
108860     MOVE 'Y' TO HOLD-EXTRACT-IND.                                10886000
108870     PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT.        10887000
108880     MOVE '2' TO HISTORY-CARD-IND.                                10888000
108890     PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.                10889000
108900                                                                  10890000
108910 P3479-EXIT.                                                      10891000
108920     EXIT.                                                        10892000
108930                                                                  10893000
108940******************************************************************10894000
108950* CLSN BUSINESS RESERVE PROCESSING                               *10895000
108960******************************************************************10896000
108970 P3480-CLSN-BR-PROCESSING.                                        10897000
108980******************************************************************10898000
108990                                                                  10899000
109000     EVALUATE BR-BAL-IND                                          10900000
109010       WHEN 1                                                     10901000
109020         PERFORM P3485-CLSN-BR-BAL-CURR THRU P3489-EXIT           10902000
109030       WHEN 2                                                     10903000
109040         PERFORM P3490-CLSN-BR-BAL-COLL THRU P3494-EXIT           10904000
109050       WHEN OTHER                                                 10905000
109060         PERFORM P3485-CLSN-BR-BAL-CURR THRU P3489-EXIT           10906000
109070     END-EVALUATE.                                                10907000
109080                                                                  10908000
109090     IF CLSN-BR-ADV-TX-AMT     = ZEROS                            10909000
109100       AND CLSN-BR-PYMT-TX-AMT = ZEROS                            10910000
109110         PERFORM P2605-UPDATE-CLST34 THRU P2606-EXIT              10911000
109120         GO TO P3484-EXIT                                         10912000
109130     END-IF.                                                      10913000
109140                                                                  10914000
109150     DISPLAY 'CDCINFO (DSDS100) P3480-1 ' DSDS-ACCOUNT-NO         10915000
109160             ' AD ' CLSN-BR-ADV-TX-AMT                            10916000
109170             ' PY ' CLSN-BR-PYMT-TX-AMT.                          10917000
109180                                                                  10918000
109190     IF CLSN-BR-ADV-TX-AMT = CLSN-BR-PYMT-TX-AMT                  10919000
109200         MOVE ZEROS TO CLSN-BR-ADV-TX-AMT                         10920000
109210         MOVE ZEROS TO CLSN-BR-PYMT-TX-AMT                        10921000
109220         GO TO P3484-EXIT                                         10922000
109230     END-IF.                                                      10923000
109240                                                                  10924000
109250     IF CLSN-BR-ADV-TX-AMT GREATER THAN CLSN-BR-PYMT-TX-AMT       10925000
109260         SUBTRACT CLSN-BR-PYMT-TX-AMT FROM CLSN-BR-ADV-TX-AMT     10926000
109270                                    GIVING CLSN-BR-ADV-TX-AMT     10927000
109280         MOVE ZEROS TO CLSN-BR-PYMT-TX-AMT                        10928000
109290         GO TO P3481-CONTINUE                                     10929000
109300     END-IF.                                                      10930000
109310                                                                  10931000
109320     IF CLSN-BR-PYMT-TX-AMT GREATER THAN CLSN-BR-ADV-TX-AMT       10932000
109330         SUBTRACT CLSN-BR-ADV-TX-AMT FROM CLSN-BR-PYMT-TX-AMT     10933000
109340                                   GIVING CLSN-BR-PYMT-TX-AMT     10934000
109350         MOVE ZEROS TO CLSN-BR-ADV-TX-AMT                         10935000
109360     END-IF.                                                      10936000
109370                                                                  10937000
109380 P3481-CONTINUE.                                                  10938000
109390     IF CLSN-BR-ADV-TX-AMT > CL34-AVAIL-BAL                       10939000
109400         DISPLAY 'P3481-2 ' DSDS-ACCOUNT-NO                       10940000
109410             ' AD ' CLSN-BR-ADV-TX-AMT                            10941000
109420             ' AV ' CL34-AVAIL-BAL                                10942000
109430         MOVE CL34-AVAIL-BAL         TO CLSN-BR-ADV-TX-AMT        10943000
109440     END-IF.                                                      10944000
109450                                                                  10945000
109460     IF CLSN-BR-PYMT-TX-AMT > CLSN-BR-WORK-PRIN-BAL               10946000
109470         DISPLAY 'P3481-3 ' DSDS-ACCOUNT-NO                       10947000
109480           ' PY ' CLSN-BR-PYMT-TX-AMT                             10948000
109490           ' PR ' CLSN-BR-WORK-PRIN-BAL                           10949000
109500         MOVE CLSN-BR-WORK-PRIN-BAL  TO CLSN-BR-PYMT-TX-AMT       10950000
109510     END-IF.                                                      10951000
109520                                                                  10952000
109530     PERFORM P2605-UPDATE-CLST34 THRU P2606-EXIT.                 10953000
109540                                                                  10954000
109550     IF CLSN-BR-ADV-TX-AMT GREATER THAN ZEROS                     10955000
109560         PERFORM P2720-BUILD-CLSN-BR-ADVANCE  THRU P2729-EXIT     10956000
109570     END-IF.                                                      10957000
109580     IF CLSN-BR-PYMT-TX-AMT GREATER THAN ZEROS                    10958000
109590         PERFORM P2730-BUILD-CLSN-BR-PAYMENT  THRU P2739-EXIT     10959000
109600     END-IF.                                                      10960000
109610 P3484-EXIT.                                                      10961000
109620     EXIT.                                                        10962000
109630                                                                  10963000
109640**** CLSN BR - BR-BAL-IND = 1 (CURRENT BALANCE)                   10964000
109650 P3485-CLSN-BR-BAL-CURR.                                          10965000
109660** IF CURRENT BALANCE IS NEGATIVE AND THE CLSN HAS FUNDS AVAIBABLE10966000
109670**   ADD AMOUNT AVAILABLE TO THE CLSN-BR-ADV-TX-AMT TO MAKE THE   10967000
109680**   ACCOUNT LESS NEGATIVE                                        10968000
109690     COMPUTE CLSN-BR-WORK-BALANCE = CURRENT-BALANCE               10969000
109700                                  + CLSN-BR-ADV-TX-AMT.           10970000
109710     IF CLSN-BR-WORK-BALANCE < 0                                  10971000
109720         COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL          10972000
109730                                        - CLSN-BR-ADV-TX-AMT      10973000
109740         COMPUTE CLSN-BR-AMT-NEEDED = CURRENT-BALANCE * -1        10974000
109750         IF CLSN-BR-WORK-AVAIL-BAL < CLSN-BR-AMT-NEEDED           10975000
109760             ADD CLSN-BR-WORK-AVAIL-BAL TO CLSN-BR-ADV-TX-AMT     10976000
109770         ELSE                                                     10977000
109780             ADD CLSN-BR-WORK-BALANCE   TO CLSN-BR-ADV-TX-AMT     10978000
109790         END-IF                                                   10979000
109800     END-IF.                                                      10980000
109810                                                                  10981000
109820     COMPUTE CLSN-BR-WORK-BALANCE = CURRENT-BALANCE               10982000
109830                                  + CLSN-BR-ADV-TX-AMT.           10983000
109840                                                                  10984000
109850     IF CLSN-BR-WORK-BALANCE < BR-PEG-BAL-AMT                     10985000
109860         COMPUTE CLSN-BR-AMT-NEEDED = BR-PEG-BAL-AMT              10986000
109870                                    - CLSN-BR-WORK-BALANCE        10987000
109880         ADD CLSN-BR-AMT-NEEDED TO CLSN-BR-ADV-TX-AMT             10988000
109890     END-IF.                                                      10989000
109900                                                                  10990000
109910     IF CLSN-BR-ADV-TX-AMT > 0                                    10991000
109920         CONTINUE                                                 10992000
109930     ELSE                                                         10993000
109940         GO TO P3486-CHECK-FOR-PAYMENT                            10994000
109950     END-IF.                                                      10995000
109960                                                                  10996000
109970     MOVE CURRENT-BALANCE          TO CLSN-BR-WORK-CURR-BAL.      10997000
109980                                                                  10998000
109990     COMPUTE CLSN-BR-WORK-BALANCE = CURRENT-BALANCE               10999000
110000                                  + CLSN-BR-ADV-TX-AMT.           11000000
110010                                                                  11001000
110020     IF CLSN-BR-WORK-BALANCE = BR-PEG-BAL-AMT                     11002000
110030         GO TO P3489-EXIT                                         11003000
110040     END-IF.                                                      11004000
110050                                                                  11005000
110060     IF CLSN-BR-WORK-BALANCE < BR-PEG-BAL-AMT                     11006000
110070         COMPUTE CLSN-BR-WORK-ADV-AMT = BR-PEG-BAL-AMT            11007000
110080                                      - CLSN-BR-WORK-BALANCE      11008000
110090         IF CLSN-BR-WORK-ADV-AMT < CLSN-BR-WORK-AVAIL-BAL         11009000
110100             ADD CLSN-BR-WORK-ADV-AMT TO CLSN-BR-ADV-TX-AMT       11010000
110110         END-IF                                                   11011000
110120     END-IF.                                                      11012000
110130                                                                  11013000
110140 P3486-CHECK-FOR-PAYMENT.                                         11014000
110150     IF BR-SWEEP-PYMT-IND = 'Y'                                   11015000
110160         CONTINUE                                                 11016000
110170     ELSE                                                         11017000
110180         GO TO P3489-EXIT                                         11018000
110190     END-IF.                                                      11019000
110200                                                                  11020000
110210     COMPUTE CLSN-BR-WORK-PRIN-BAL  = CL34-PRIN-BAL               11021000
110220                                    + CLSN-BR-ADV-TX-AMT.         11022000
110230     COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL              11023000
110240                                    - CLSN-BR-ADV-TX-AMT.         11024000
110250                                                                  11025000
110260     IF CLSN-BR-WORK-PRIN-BAL = ZEROS                             11026000
110270         GO TO P3487-CONTINUE                                     11027000
110280     END-IF.                                                      11028000
110290                                                                  11029000
110300     MOVE CURRENT-BALANCE TO CLSN-BR-WORK-BALANCE.                11030000
110310                                                                  11031000
110320     ADD      CLSN-BR-ADV-TX-AMT    TO CLSN-BR-WORK-BALANCE.      11032000
110330     SUBTRACT CLSN-BR-PYMT-TX-AMT FROM CLSN-BR-WORK-BALANCE.      11033000
110340                                                                  11034000
110350     IF CLSN-BR-WORK-BALANCE = BR-PEG-BAL-AMT                     11035000
110360         GO TO P3487-CONTINUE                                     11036000
110370     END-IF.                                                      11037000
110380                                                                  11038000
110390     IF CLSN-BR-WORK-BALANCE > BR-PEG-BAL-AMT                     11039000
110400         COMPUTE CLSN-BR-PYMT-TX-AMT = CLSN-BR-WORK-BALANCE       11040000
110410                                     - BR-PEG-BAL-AMT             11041000
110420         IF CLSN-BR-PYMT-TX-AMT > CLSN-BR-WORK-PRIN-BAL           11042000
110430             MOVE CLSN-BR-WORK-PRIN-BAL TO CLSN-BR-PYMT-TX-AMT    11043000
110440         END-IF                                                   11044000
110450     END-IF.                                                      11045000
110460                                                                  11046000
110470     IF CLSN-BR-WORK-BALANCE < 0                                  11047000
110480         MOVE ZEROS                TO CLSN-BR-PYMT-TX-AMT         11048000
110490         GO TO P3487-CONTINUE                                     11049000
110500     END-IF.                                                      11050000
110510                                                                  11051000
110520 P3487-CONTINUE.                                                  11052000
110530     IF CLSN-BR-WORK-BALANCE < 0                                  11053000
110540         COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL          11054000
110550                                        - CLSN-BR-ADV-TX-AMT      11055000
110560         COMPUTE CLSN-BR-AMT-NEEDED = CLSN-BR-WORK-BALANCE * -1   11056000
110570         IF CLSN-BR-AMT-NEEDED < CLSN-BR-WORK-AVAIL-BAL           11057000
110580             ADD CLSN-BR-AMT-NEEDED TO CLSN-BR-ADV-TX-AMT         11058000
110590         ELSE                                                     11059000
110600             ADD CLSN-BR-WORK-AVAIL-BAL TO CLSN-BR-ADV-TX-AMT     11060000
110610         END-IF                                                   11061000
110620     END-IF.                                                      11062000
110630 P3489-EXIT.                                                      11063000
110640     EXIT.                                                        11064000
110650                                                                  11065000
110660**** CLSN BR - BR-BAL-IND = 2 (COLLECTED BALANCE)                 11066000
110670 P3490-CLSN-BR-BAL-COLL.                                          11067000
110680     COMPUTE CLSN-BR-WORK-TOT-FLOAT = ONE-DAY-FLOAT-AMT   +       11068000
110690                 TWO-DAY-FLOAT-AMT  + THREE-DAY-FLOAT-AMT +       11069000
110700                 FOUR-DAY-FLOAT-AMT + FIVE-DAY-FLOAT-AMT.         11070000
110710                                                                  11071000
110720     COMPUTE CLSN-BR-WORK-COLL-BAL  = CURRENT-BALANCE             11072000
110730                                    - CLSN-BR-WORK-TOT-FLOAT      11073000
110740                                    + CLSN-BR-ADV-TX-AMT          11074000
110750                                    - CLSN-BR-PYMT-TX-AMT.        11075000
110760     COMPUTE CLSN-BR-AMT-NEEDED     = CLSN-BR-WORK-COLL-BAL       11076000
110770                                    - BR-PEG-BAL-AMT.             11077000
110780     IF CLSN-BR-AMT-NEEDED < 0                                    11078000
110790         COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL          11079000
110800                                        - CLSN-BR-ADV-TX-AMT      11080000
110810         MULTIPLY CLSN-BR-AMT-NEEDED BY -1                        11081000
110820                                 GIVING CLSN-BR-AMT-NEEDED        11082000
110830         DISPLAY 'CDCINFO (DSDS100) '                             11083000
110840                 'P3490-1 CURRENT-BALANCE   < 0 ' DSDS-ACCOUNT-NO 11084000
110850           ' AN ' CLSN-BR-AMT-NEEDED                              11085000
110860           ' WC ' CLSN-BR-WORK-COLL-BAL                           11086000
110870           ' WA ' CLSN-BR-WORK-AVAIL-BAL                          11087000
110880           ' AD ' CLSN-BR-ADV-TX-AMT                              11088000
110890         IF CLSN-BR-WORK-AVAIL-BAL < CLSN-BR-AMT-NEEDED           11089000
110900             ADD CLSN-BR-WORK-AVAIL-BAL TO CLSN-BR-ADV-TX-AMT     11090000
110910         ELSE                                                     11091000
110920             ADD CLSN-BR-AMT-NEEDED     TO CLSN-BR-ADV-TX-AMT     11092000
110930         END-IF                                                   11093000
110940         DISPLAY 'CDCINFO (DSDS100) '                             11094000
110950                 'P3490-2 ' DSDS-ACCOUNT-NO                       11095000
110960           ' WC ' CLSN-BR-WORK-COLL-BAL                           11096000
110970           ' WA ' CLSN-BR-WORK-AVAIL-BAL                          11097000
110980           ' AD ' CLSN-BR-ADV-TX-AMT                              11098000
110990     ELSE                                                         11099000
111000         IF BR-SWEEP-PYMT-IND = 'Y'                               11100000
111010             CONTINUE                                             11101000
111020         ELSE                                                     11102000
111030             GO TO P3494-EXIT                                     11103000
111040         END-IF                                                   11104000
111050         COMPUTE CLSN-BR-WORK-PRIN-BAL  = CL34-PRIN-BAL           11105000
111060                                        + CLSN-BR-ADV-TX-AMT      11106000
111070         MOVE CLSN-BR-AMT-NEEDED        TO CLSN-BR-PYMT-TX-AMT    11107000
111080         IF CLSN-BR-PYMT-TX-AMT > CLSN-BR-WORK-PRIN-BAL           11108000
111090             MOVE CLSN-BR-WORK-PRIN-BAL TO CLSN-BR-PYMT-TX-AMT    11109000
111100         END-IF                                                   11110000
111110     END-IF.                                                      11111000
111120                                                                  11112000
111130 P3491-CHECK-FOR-PAYMENT.                                         11113000
111140     IF BR-SWEEP-PYMT-IND = 'Y'                                   11114000
111150         CONTINUE                                                 11115000
111160     ELSE                                                         11116000
111170         GO TO P3494-EXIT                                         11117000
111180     END-IF.                                                      11118000
111190                                                                  11119000
111200     COMPUTE CLSN-BR-WORK-PRIN-BAL  = CL34-PRIN-BAL               11120000
111210                                    + CLSN-BR-ADV-TX-AMT.         11121000
111220     COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL              11122000
111230                                    - CLSN-BR-ADV-TX-AMT.         11123000
111240     DISPLAY 'CDCINFO (DSDS100) '                                 11124000
111250             'P3491-1 ' DSDS-ACCOUNT-NO                           11125000
111260             ' PR ' CLSN-BR-WORK-PRIN-BAL                         11126000
111270             ' AV ' CLSN-BR-WORK-AVAIL-BAL.                       11127000
111280                                                                  11128000
111290     IF CLSN-BR-WORK-PRIN-BAL = ZEROS                             11129000
111300         GO TO P3492-CONTINUE                                     11130000
111310     END-IF.                                                      11131000
111320                                                                  11132000
111330     COMPUTE CLSN-BR-WORK-TOT-FLOAT = ONE-DAY-FLOAT-AMT   +       11133000
111340                 TWO-DAY-FLOAT-AMT  + THREE-DAY-FLOAT-AMT +       11134000
111350                 FOUR-DAY-FLOAT-AMT + FIVE-DAY-FLOAT-AMT.         11135000
111360     COMPUTE CLSN-BR-WORK-BALANCE   = CURRENT-BALANCE             11136000
111370                                    - CLSN-BR-WORK-TOT-FLOAT      11137000
111380                                    + CLSN-BR-ADV-TX-AMT          11138000
111390                                    - CLSN-BR-PYMT-TX-AMT.        11139000
111400                                                                  11140000
111410     DISPLAY 'CDCINFO (DSDS100) '                                 11141000
111420             'P3491-2 ' DSDS-ACCOUNT-NO                           11142000
111430             ' BI ' BR-BAL-IND                                    11143000
111440             ' WB ' CLSN-BR-WORK-BALANCE                          11144000
111450             ' CB ' CURRENT-BALANCE                               11145000
111460             ' TF ' CLSN-BR-WORK-TOT-FLOAT                        11146000
111470             ' AD ' CLSN-BR-ADV-TX-AMT                            11147000
111480             ' PY ' CLSN-BR-PYMT-TX-AMT                           11148000
111490             ' PB ' BR-PEG-BAL-AMT                                11149000
111500                                                                  11150000
111510     IF CLSN-BR-WORK-BALANCE = BR-PEG-BAL-AMT                     11151000
111520         GO TO P3492-CONTINUE                                     11152000
111530     END-IF.                                                      11153000
111540                                                                  11154000
111550     IF CLSN-BR-WORK-BALANCE > BR-PEG-BAL-AMT                     11155000
111560         IF CLSN-BR-WORK-TOT-FLOAT > BR-PEG-BAL-AMT               11156000
111570             COMPUTE CLSN-BR-WORK-PYMT-AMT = CURRENT-BALANCE      11157000
111580                                         - CLSN-BR-WORK-TOT-FLOAT 11158000
111590             ADD CLSN-BR-WORK-PYMT-AMT  TO CLSN-BR-PYMT-TX-AMT    11159000
111600         ELSE                                                     11160000
111610             COMPUTE CLSN-BR-WORK-PYMT-AMT = CLSN-BR-WORK-BALANCE 11161000
111620                                           - BR-PEG-BAL-AMT       11162000
111630             ADD CLSN-BR-WORK-PYMT-AMT  TO CLSN-BR-PYMT-TX-AMT    11163000
111640         END-IF                                                   11164000
111650         IF CLSN-BR-PYMT-TX-AMT > CLSN-BR-WORK-PRIN-BAL           11165000
111660             MOVE CLSN-BR-WORK-PRIN-BAL TO CLSN-BR-PYMT-TX-AMT    11166000
111670         END-IF                                                   11167000
111680     ELSE                                                         11168000
111690         DISPLAY 'CDCINFO (DSDS100) P3492 WB < PEG '              11169000
111700                       DSDS-ACCOUNT-NO                            11170000
111710                 ' * ' CLSN-BR-WORK-BALANCE                       11171000
111720                 ' * ' BR-PEG-BAL-AMT                             11172000
111730*        MOVE CLSN-BR-WORK-BALANCE      TO CLSN-BR-PYMT-TX-AMT    11173000
111740     END-IF.                                                      11174000
111750                                                                  11175000
111760     IF CLSN-BR-WORK-BALANCE < 0                                  11176000
111770         MOVE ZEROS                TO CLSN-BR-PYMT-TX-AMT         11177000
111780     END-IF.                                                      11178000
111790                                                                  11179000
111800 P3492-CONTINUE.                                                  11180000
111810     IF CLSN-BR-WORK-BALANCE < 0                                  11181000
111820         COMPUTE CLSN-BR-WORK-AVAIL-BAL = CL34-AVAIL-BAL          11182000
111830                                        - CLSN-BR-ADV-TX-AMT      11183000
111840         DISPLAY 'CDCINFO (DSDS100) '                             11184000
111850                 'P3492-1 CURRENT-BALANCE   < 0 '                 11185000
111860           ' AC ' DSDS-ACCOUNT-NO                                 11186000
111870           ' WB ' CLSN-BR-WORK-BALANCE                            11187000
111880           ' WA ' CLSN-BR-WORK-AVAIL-BAL                          11188000
111890           ' AV ' CLSN-BR-ADV-TX-AMT                              11189000
111900           ' PY ' CLSN-BR-PYMT-TX-AMT                             11190000
111910         COMPUTE CLSN-BR-AMT-NEEDED = CLSN-BR-WORK-BALANCE * -1   11191000
111920         IF CLSN-BR-AMT-NEEDED < CLSN-BR-WORK-AVAIL-BAL           11192000
111930             ADD CLSN-BR-AMT-NEEDED TO CLSN-BR-ADV-TX-AMT         11193000
111940         ELSE                                                     11194000
111950             ADD CLSN-BR-WORK-AVAIL-BAL TO CLSN-BR-ADV-TX-AMT     11195000
111960         END-IF                                                   11196000
111970         DISPLAY 'CDCINFO (DSDS100) '                             11197000
111980                 'P3492-2 CURRENT-BALANCE   < 0 '                 11198000
111990           ' AC ' DSDS-ACCOUNT-NO                                 11199000
112000           ' NE ' CLSN-BR-AMT-NEEDED                              11200000
112010           ' WB ' CLSN-BR-WORK-BALANCE                            11201000
112020           ' WA ' CLSN-BR-WORK-AVAIL-BAL                          11202000
112030           ' AV ' CLSN-BR-ADV-TX-AMT                              11203000
112040           ' PY ' CLSN-BR-PYMT-TX-AMT                             11204000
112050     END-IF.                                                      11205000
112060 P3494-EXIT.                                                      11206000
112070     EXIT.                                                        11207000
112080                                                                  11208000
112090******************************************************************11209000
112100*    M A T U R E   R E P U R C H A S E   A G R E E M E N T S     *11210000
112110******************************************************************11211000
112120 P3500-MATURE-RP.                                                 11212000
112130     IF INV-BALANCE = ZERO                                        11213000
112140         GO TO P3549-EXIT.                                        11214000
112150     PERFORM P7260-MATURE-RP-RPT THRU P7269-EXIT.                 11215000
112160     IF TERM-REPO OR INTERBANK-TERM-REPO                          11216000
112170         PERFORM P4100-POST-INV-INT THRU P4199-EXIT               11217000
112180         GO TO P3510-RETURN-INV-AMT.                              11218000
112190     IF INV-INT-PAY-DAILY                                         11219000
112200         PERFORM P4100-POST-INV-INT THRU P4199-EXIT.              11220000
112210                                                                  11221000
112220 P3510-RETURN-INV-AMT.                                            11222000
112230     IF INV-BALANCE = ZERO                                        11223000
112240         GO TO P3549-EXIT.                                        11224000
112250     MOVE 1 TO DSDSTXL-PENDING-SW.                                11225000
112260     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     11226000
112270     MOVE INV-BALANCE TO DSDSTXL-AMOUNT.                          11227000
112280     ADD INV-BALANCE TO AMT-INV-MAT-ON-STMT.                      11228000
112290                                                                  11229000
112300 P3520-BUILD-DDA-TX.                                              11230000
112310     MOVE 555 TO DSDSTXL-CODE.                                    11231000
112320     MOVE 'MRP' TO PJ-HOLD-CODE.                                  11232000
112330     MOVE OSB-DESC-0021-A TO INV-MAT-DESC-1.                      11233000
112340     EVALUATE INV-PLAN                                            11234000
112350         WHEN 'RP'                                                11235000
112360             MOVE 'RP' TO INV-MAT-DESC-2                          11236000
112370         WHEN 'TE'                                                11237000
112380             MOVE 'TAX EXEMPT FUND' TO INV-MAT-DESC-2             11238000
112390         WHEN 'TF'                                                11239000
112400             MOVE 'TREASURY FUND' TO INV-MAT-DESC-2               11240000
112410         WHEN 'TR'                                                11241000
112420             MOVE 'TERM REPO' TO INV-MAT-DESC-2                   11242000
112430         WHEN 'FF'                                                11243000
112440             MOVE 'FED FUNDS' TO INV-MAT-DESC-2                   11244000
112450         WHEN 'CF'                                                11245000
112460             MOVE 'CASH MGMT TRUST' TO INV-MAT-DESC-2             11246000
112470         WHEN OTHER                                               11247000
112480             MOVE 'RP' TO INV-MAT-DESC-2                          11248000
112490     END-EVALUATE.                                                11249000
112500     MOVE INV-TX-DESC-16 TO DSDSTXL-CO-DESC.                      11250000
112510     MOVE INV-TX-DESC-10 TO DSDSTXL-DESC.                         11251000
112520     MOVE MAT-INT-INV-KEY TO SAVE-CR-SORT-KEY.                    11252000
112530     ADD 1 TO NUM-BILL-TX.                                        11253000
112540     PERFORM P1325-NORM-CR-2.                                     11254000
112550     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            11255000
112560     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       11256000
112570                                                                  11257000
112580 P3530-BUILD-INV-TX.                                              11258000
112590     MOVE 676 TO DSDSTXL-CODE.                                    11259000
112600     MOVE INV-DESC1 TO DSDSTXL-CO-DESC.                           11260000
112610     IF TAX-EXEMPT-FUND OR                                        11261000
112620        TREASURY-FUND OR                                          11262000
112630        CASH-MGMT-TRUST-FUND                                      11263000
112640         MOVE INV-DESC2 TO DESCRIPTION-WORK                       11264000
112650         MOVE SPACES TO DESC-WORK-2                               11265000
112660         MOVE DESCRIPTION-WORK TO INV-DESC2.                      11266000
112670     MOVE INV-DESC2 TO DSDSTXL-DESC.                              11267000
112680     MOVE INV-MAT-KEY TO DSDSTXL-SORT-KEY.                        11268000
112690     MOVE ZEROS TO INV-BALANCE.                                   11269000
112700     MOVE SPACES TO INV-COLLATERAL-DESC.                          11270000
112710     ADD 1 TO NUM-BILL-TX.                                        11271000
112720     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     11272000
112730     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 11273000
112740                                                                  11274000
112750 P3549-EXIT.                                                      11275000
112760     EXIT.                                                        11276000
112770                                                                  11277000
112780******************************************************************11278000
112790*  P U R C H A S E   R E P U R C H A S E   A G R E E M E N T S   *11279000
112800******************************************************************11280000
112810 P3600-PURCHASE-RP.                                               11281000
112820     MOVE ZEROS TO INV-SHORT-BAL-DAILY-FAC.                       11282000
112830     IF INV-NORMAL                                                11283000
112840         NEXT SENTENCE                                            11284000
112850       ELSE                                                       11285000
112860         GO TO P3999-EXIT.                                        11286000
112870     MOVE ZEROS TO HOLD-RP-AMT                                    11287000
112880                   HOLD-RP-COLLAT-CNT                             11288000
112890                   HOLD-RP-DAILY-INT                              11289000
112900                   HOLD-RP-SECURE-AMT                             11290000
112910                   HOLD-RP-TX-AMT.                                11291000
112920     MOVE ' ' TO HOLD-RP-DISP-IND.                                11292000
112930     COMPUTE HOLD-RP-COLL-BAL =                                   11293000
112940         CURRENT-BALANCE +                                        11294000
112950         CASH-MANAGEMENT-BAL-IN-IMMA -                            11295000
112960         INSF-AMT -                                               11296000
112970         ONE-DAY-FLOAT-AMT -                                      11297000
112980         TWO-DAY-FLOAT-AMT -                                      11298000
112990         THREE-DAY-FLOAT-AMT -                                    11299000
113000         FOUR-DAY-FLOAT-AMT -                                     11300000
113010         FIVE-DAY-FLOAT-AMT.                                      11301000
113020     MOVE INV-PEGGED-BAL TO HOLD-INV-PEGGED-BAL.                  11302000
113030     IF CASH-MANAGEMENT-SWEEP                                     11303000
113040         COMPUTE HOLD-CASH-MANAGEMENT-WORK-AMT =                  11304000
113050             CASH-MANAGEMENT-PEGGED-BAL +                         11305000
113060             CASH-MANAGEMENT-BAL-IN-IMMA                          11306000
113070         IF HOLD-CASH-MANAGEMENT-WORK-AMT GREATER THAN            11307000
113080                 INV-PEGGED-BAL                                   11308000
113090             MOVE 19 TO HOLD-REASON-CODE                          11309000
113100             PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT         11310000
113110             MOVE '4' TO HOLD-RP-DISP-IND                         11311000
113120             GO TO P3990-PUR-RP-END.                              11312000
113130     IF CASH-MANAGEMENT-TRNSFR-CNT GREATER THAN +5                11313000
113140         MOVE CASH-MANAGEMENT-PEGGED-BAL TO HOLD-INV-PEGGED-BAL   11314000
113150       ELSE                                                       11315000
113160         MOVE INV-PEGGED-BAL TO HOLD-INV-PEGGED-BAL.              11316000
113170     IF CURRENT-BALANCE NEGATIVE                                  11317000
113180         MOVE '2' TO HOLD-RP-DISP-IND                             11318000
113190         GO TO P3620-BAL-SHORT.                                   11319000
113200     IF HOLD-RP-COLL-BAL GREATER THAN HOLD-INV-PEGGED-BAL         11320000
113210         GO TO P3630-CHK-ODB-PMNT.                                11321000
113220     MOVE '1' TO HOLD-RP-DISP-IND.                                11322000
113230     IF HOLD-RP-COLL-BAL = HOLD-INV-PEGGED-BAL                    11323000
113240         GO TO P3990-PUR-RP-END.                                  11324000
113250                                                                  11325000
113260 P3610-CHK-ODB-ADV.                                               11326000
113270     IF ODB-PLAN = SPACES                                         11327000
113280         GO TO P3620-BAL-SHORT.                                   11328000
113290     IF ODB-NORMAL                                                11329000
113300         NEXT SENTENCE                                            11330000
113310       ELSE                                                       11331000
113320         GO TO P3620-BAL-SHORT.                                   11332000
113330     IF INV-NO-ODB-ADV                                            11333000
113340         GO TO P3620-BAL-SHORT.                                   11334000
113350     IF ODB-LOAN-BAL = AUTH-CREDIT-LIMIT OR                       11335000
113360        ODB-LOAN-BAL GREATER THAN AUTH-CREDIT-LIMIT               11336000
113370         GO TO P3990-PUR-RP-END.                                  11337000
113380     SUBTRACT ODB-LOAN-BAL FROM AUTH-CREDIT-LIMIT                 11338000
113390         GIVING TEMP-CR-AVAIL.                                    11339000
113400     SUBTRACT HOLD-RP-COLL-BAL FROM HOLD-INV-PEGGED-BAL           11340000
113410         GIVING HOLD-RP-WORK-AMT.                                 11341000
113420     IF HOLD-RP-WORK-AMT GREATER THAN TEMP-CR-AVAIL               11342000
113430         MOVE TEMP-CR-AVAIL TO ADVANCE-TX-AMT                     11343000
113440       ELSE                                                       11344000
113450         MOVE HOLD-RP-WORK-AMT TO ADVANCE-TX-AMT.                 11345000
113460     ADD ADVANCE-TX-AMT TO ODB-LOAN-BAL.                          11346000
113470     PERFORM P2650-BUILD-ADV-TX THRU P2700-EXIT.                  11347000
113480     GO TO P3990-PUR-RP-END.                                      11348000
113490                                                                  11349000
113500 P3620-BAL-SHORT.                                                 11350000
113510     IF INV-NO-ADJUSTMENT OR INV-ADJUST-PEGGED                    11351000
113520         GO TO P3990-PUR-RP-END.                                  11352000
113530     SUBTRACT HOLD-RP-COLL-BAL FROM HOLD-INV-PEGGED-BAL           11353000
113540         GIVING HOLD-RP-WORK-AMT.                                 11354000
113550     ADD HOLD-RP-WORK-AMT TO INV-SHORT-BAL.                       11355000
113560     MOVE HOLD-RP-WORK-AMT TO INV-SHORT-BAL-DAILY-FAC.            11356000
113570     MOVE ZEROS TO HOLD-RP-WORK-AMT.                              11357000
113580     MOVE 07 TO HOLD-REASON-CODE.                                 11358000
113590     PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                11359000
113600     GO TO P3990-PUR-RP-END.                                      11360000
113610                                                                  11361000
113620 P3630-CHK-ODB-PMNT.                                              11362000
113630     IF ODB-PLAN = SPACES                                         11363000
113640         GO TO P3660-CHK-BAL-SHORT.                               11364000
113650     IF INV-NO-ODB-PAY                                            11365000
113660         GO TO P3660-CHK-BAL-SHORT.                               11366000
113670     IF ODB-LOAN-BAL = ZERO                                       11367000
113680         GO TO P3680-CHK-INSF-PEND.                               11368000
113690     IF INV-ODB-PAY-TO-PEG                                        11369000
113700         SUBTRACT HOLD-INV-PEGGED-BAL FROM HOLD-RP-COLL-BAL       11370000
113710             GIVING HOLD-RP-EXCESS                                11371000
113720       ELSE                                                       11372000
113730         MOVE HOLD-RP-COLL-BAL TO HOLD-RP-EXCESS.                 11373000
113740     MOVE ODB-LOAN-BAL TO TEMP-LOAN-BAL.                          11374000
113750     IF HOLD-RP-EXCESS LESS THAN TEMP-LOAN-BAL                    11375000
113760         GO TO P3650-ODB-PMNT.                                    11376000
113770                                                                  11377000
113780 P3640-ODB-PAYOFF.                                                11378000
113790     MOVE TEMP-LOAN-BAL TO TEMP-PAYMENT.                          11379000
113800     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 11380000
113810     GO TO P3670-RECALC-COLL-BAL.                                 11381000
113820                                                                  11382000
113830 P3650-ODB-PMNT.                                                  11383000
113840     MOVE HOLD-RP-EXCESS TO TEMP-PAYMENT.                         11384000
113850     PERFORM P2800-BUILD-PMNT-TX THRU P2830-EXIT.                 11385000
113860     GO TO P3670-RECALC-COLL-BAL.                                 11386000
113870                                                                  11387000
113880 P3660-CHK-BAL-SHORT.                                             11388000
113890     IF INV-NO-ADJUSTMENT OR INV-ADJUST-PEGGED                    11389000
113900         GO TO P3680-CHK-INSF-PEND.                               11390000
113910     IF INV-SHORT-BAL = ZERO                                      11391000
113920         GO TO P3680-CHK-INSF-PEND.                               11392000
113930     SUBTRACT HOLD-INV-PEGGED-BAL FROM HOLD-RP-COLL-BAL           11393000
113940         GIVING HOLD-RP-WORK-AMT.                                 11394000
113950     SUBTRACT HOLD-RP-WORK-AMT FROM ZERO                          11395000
113960         GIVING INV-SHORT-BAL-DAILY-FAC.                          11396000
113970     IF HOLD-RP-WORK-AMT LESS THAN INV-SHORT-BAL                  11397000
113980         SUBTRACT HOLD-RP-WORK-AMT FROM INV-SHORT-BAL             11398000
113990         MOVE '1' TO HOLD-RP-DISP-IND                             11399000
114000         MOVE 08 TO HOLD-REASON-CODE                              11400000
114010         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT             11401000
114020         GO TO P3990-PUR-RP-END.                                  11402000
114030     SUBTRACT INV-SHORT-BAL FROM HOLD-RP-WORK-AMT                 11403000
114040         GIVING HOLD-RP-COLL-BAL.                                 11404000
114050     MOVE ZEROS TO INV-SHORT-BAL.                                 11405000
114060     MOVE 09 TO HOLD-REASON-CODE.                                 11406000
114070     PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                11407000
114080     IF HOLD-RP-COLL-BAL = ZEROS                                  11408000
114090         MOVE '1' TO HOLD-RP-DISP-IND                             11409000
114100         GO TO P3990-PUR-RP-END.                                  11410000
114110     ADD HOLD-INV-PEGGED-BAL TO HOLD-RP-COLL-BAL.                 11411000
114120     GO TO P3680-CHK-INSF-PEND.                                   11412000
114130                                                                  11413000
114140 P3670-RECALC-COLL-BAL.                                           11414000
114150     COMPUTE HOLD-RP-COLL-BAL =                                   11415000
114160         CURRENT-BALANCE -                                        11416000
114170         INSF-AMT -                                               11417000
114180         ONE-DAY-FLOAT-AMT -                                      11418000
114190         TWO-DAY-FLOAT-AMT -                                      11419000
114200         THREE-DAY-FLOAT-AMT -                                    11420000
114210         FOUR-DAY-FLOAT-AMT -                                     11421000
114220         FIVE-DAY-FLOAT-AMT.                                      11422000
114230     IF CASH-MANAGEMENT-SWEEP                                     11423000
114240         ADD CASH-MANAGEMENT-BAL-IN-IMMA TO HOLD-RP-COLL-BAL.     11424000
114250     IF HOLD-RP-COLL-BAL GREATER THAN HOLD-INV-PEGGED-BAL         11425000
114260         GO TO P3680-CHK-INSF-PEND.                               11426000
114270     MOVE '1' TO HOLD-RP-DISP-IND.                                11427000
114280     GO TO P3990-PUR-RP-END.                                      11428000
114290                                                                  11429000
114300 P3680-CHK-INSF-PEND.                                             11430000
114310     IF NSF-PENDING                                               11431000
114320         MOVE '3' TO HOLD-RP-DISP-IND                             11432000
114330         GO TO P3990-PUR-RP-END.                                  11433000
114340                                                                  11434000
114350 P3690-CALC-RP-AMT.                                               11435000
114360     SUBTRACT HOLD-INV-PEGGED-BAL FROM HOLD-RP-COLL-BAL           11436000
114370         GIVING HOLD-RP-WORK-AMT.                                 11437000
114380     IF INV-SWEEP-FIXED-AMT                                       11438000
114390         GO TO P3700-CHK-LIMIT.                                   11439000
114400     IF HOLD-RP-WORK-AMT LESS THAN INV-INCREMENT                  11440000
114410         MOVE '1' TO HOLD-RP-DISP-IND                             11441000
114420         GO TO P3990-PUR-RP-END.                                  11442000
114430     DIVIDE HOLD-RP-WORK-AMT BY INV-INCREMENT                     11443000
114440         GIVING HOLD-RP-NUM-INCR.                                 11444000
114450     MULTIPLY HOLD-RP-NUM-INCR BY INV-INCREMENT                   11445000
114460         GIVING HOLD-RP-AMT.                                      11446000
114470     IF HOLD-RP-AMT GREATER THAN INV-LIMIT                        11447000
114480         MOVE 18 TO HOLD-REASON-CODE                              11448000
114490         MOVE INV-LIMIT TO HOLD-RP-AMT.                           11449000
114500     MOVE HOLD-RP-AMT TO HOLD-RP-WORK-AMT.                        11450000
114510     IF INV-COLLATERAL-FACTOR = +1.0000                           11451000
114520         MOVE HOLD-RP-AMT TO HOLD-RP-COLLAT-AMT                   11452000
114530       ELSE                                                       11453000
114540         MULTIPLY HOLD-RP-AMT BY INV-COLLATERAL-FACTOR            11454000
114550             GIVING HOLD-RP-COLLAT-AMT ROUNDED.                   11455000
114560     GO TO P3710-CHK-COLLAT-CODE.                                 11456000
114570                                                                  11457000
114580 P3700-CHK-LIMIT.                                                 11458000
114590     IF HOLD-RP-WORK-AMT LESS THAN INV-LIMIT                      11459000
114600         MOVE 10 TO HOLD-REASON-CODE                              11460000
114610         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT             11461000
114620         MOVE '1' TO HOLD-RP-DISP-IND                             11462000
114630         GO TO P3990-PUR-RP-END.                                  11463000
114640     MOVE INV-LIMIT TO HOLD-RP-AMT                                11464000
114650                       HOLD-RP-WORK-AMT.                          11465000
114660     IF INV-COLLATERAL-FACTOR = +1.0000                           11466000
114670         MOVE HOLD-RP-AMT TO HOLD-RP-COLLAT-AMT                   11467000
114680       ELSE                                                       11468000
114690         MULTIPLY HOLD-RP-AMT BY INV-COLLATERAL-FACTOR            11469000
114700             GIVING HOLD-RP-COLLAT-AMT ROUNDED.                   11470000
114710                                                                  11471000
114720 P3710-CHK-COLLAT-CODE.                                           11472000
114730     IF TAX-EXEMPT-FUND AND INV-COLLATERAL-CODE = 'US'            11473000
114740         MOVE OSB-DESC-0056-A TO COL-DESC1                        11474000
114750         MOVE OSB-DESC-0056-B TO COL-DESC2                        11475000
114760         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11476000
114770         MOVE ZEROS TO HOLD-RP-MARKET-VALUE                       11477000
114780         MOVE +01.000 TO COLLAT-RATIO                             11478000
114790         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11479000
114800         GO TO P3990-PUR-RP-END.                                  11480000
114810     IF TREASURY-FUND AND INV-COLLATERAL-CODE = 'US'              11481000
114820         MOVE OSB-DESC-0057-A TO COL-DESC1                        11482000
114830         MOVE OSB-DESC-0057-B TO COL-DESC2                        11483000
114840         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11484000
114850         MOVE ZEROS TO HOLD-RP-MARKET-VALUE                       11485000
114860         MOVE +01.000 TO COLLAT-RATIO                             11486000
114870         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11487000
114880         GO TO P3990-PUR-RP-END.                                  11488000
114890     IF FED-FUNDS AND INV-COLLATERAL-CODE = 'US'                  11489000
114900         MOVE OSB-DESC-0058-A TO COL-DESC1                        11490000
114910         MOVE OSB-DESC-0058-B TO COL-DESC2                        11491000
114920         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11492000
114930         MOVE ZEROS TO HOLD-RP-MARKET-VALUE                       11493000
114940         MOVE +01.000 TO COLLAT-RATIO                             11494000
114950         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11495000
114960         GO TO P3990-PUR-RP-END.                                  11496000
114970     IF CASH-MGMT-TRUST-FUND AND INV-COLLATERAL-CODE = 'US'       11497000
114980         MOVE OSB-DESC-0061-A TO COL-DESC1                        11498000
114990         MOVE OSB-DESC-0061-B TO COL-DESC2                        11499000
115000         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11500000
115010         MOVE ZEROS TO HOLD-RP-MARKET-VALUE                       11501000
115020         MOVE +01.000 TO COLLAT-RATIO                             11502000
115030         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11503000
115040         GO TO P3990-PUR-RP-END.                                  11504000
115050     IF INV-COLLATERAL-CODE = 'US'                                11505000
115060         MOVE OSB-DESC-0059-A TO COL-DESC1                        11506000
115070         MOVE OSB-DESC-0059-B TO COL-DESC2                        11507000
115080         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11508000
115090                             HOLD-RP-MARKET-VALUE                 11509000
115100         MOVE +01.000 TO COLLAT-RATIO                             11510000
115110         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11511000
115120         GO TO P3990-PUR-RP-END.                                  11512000
115130                                                                  11513000
115140 P3720-START-COLLAT-1.                                            11514000
115150     MOVE PROC-BK-NO TO DSDS-COLLAT-BK.                           11515000
115160     MOVE ZEROS TO DSDS-COLLAT-RATE.                              11516000
115170     MOVE ZEROS TO DSDS-COLLAT-SEQ.                               11517000
115180     MOVE ZEROS TO TOT-COLLAT-AVAIL.                              11518000
115190     START DSDS-COLLATERAL-FILE                                   11519000
115200         KEY GREATER THAN DSDS-COLLAT-REC-ID.                     11520000
115210     IF VSAM-SUCCESSFUL                                           11521000
115220         GO TO P3725-FIND-COLLAT-REC-1.                           11522000
115230     DISPLAY 'NO COLLATERAL FOR BANK ' PROC-BK-NO UPON CONSOLE.   11523000
115240     GO TO P3730-CHK-TOT-COLLAT-1.                                11524000
115250                                                                  11525000
115260 P3725-FIND-COLLAT-REC-1.                                         11526000
115270     READ DSDS-COLLATERAL-FILE NEXT INTO DSDS-COLLATERAL-RECORD.  11527000
115280     IF VSAM-END-OF-FILE                                          11528000
115290         GO TO P3730-CHK-TOT-COLLAT-1.                            11529000
115300     IF VSAM-SUCCESSFUL                                           11530000
115310         NEXT SENTENCE                                            11531000
115320       ELSE                                                       11532000
115330         DISPLAY 'COLLATERAL VSAM READ ERROR' UPON CONSOLE        11533000
115340         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  11534000
115350         CALL 'CDCDUMP' USING BY CONTENT '2052'.                  11535000
115360     IF COLLAT-BK-NO GREATER THAN PROC-BK-NO                      11536000
115370         GO TO P3730-CHK-TOT-COLLAT-1.                            11537000
115380     IF INV-COLLATERAL-CODE = COLLAT-ESCROW-CODE                  11538000
115390         ADD COLLAT-AVAIL-BAL TO TOT-COLLAT-AVAIL.                11539000
115400     GO TO P3725-FIND-COLLAT-REC-1.                               11540000
115410                                                                  11541000
115420 P3730-CHK-TOT-COLLAT-1.                                          11542000
115430     IF TERM-REPO OR INTERBANK-TERM-REPO                          11543000
115440       IF HOLD-RP-COLLAT-AMT GREATER THAN TOT-COLLAT-AVAIL        11544000
115450         MOVE SPACES                TO INV-COLLATERAL-DESC        11545000
115460         MOVE HOLD-RP-AMT           TO HOLD-RP-TX-AMT             11546000
115470                                       HOLD-RP-MARKET-VALUE       11547000
115480         MOVE BCF-BANK-NO           TO CER-BANK-NBR               11548000
115490         MOVE ACCOUNT-ID            TO CER-ACCT-ID                11549000
115500         MOVE ACCOUNT-NUMBER        TO CER-ACCT-NBR               11550000
115510         MOVE SHORT-NAME            TO CER-SHORT-NAME             11551000
115520         MOVE INV-PLAN              TO CER-INV-PLAN               11552000
115530         MOVE HOLD-RP-AMT           TO CER-PROJ-RP-AMT            11553000
115540                                       CER-ACTUAL-RP-AMT          11554000
115550         MOVE HOLD-RP-COLLAT-AMT    TO CER-PROJ-RP-COLLAT-AMT     11555000
115560         MOVE ZEROS                 TO CER-ACTUAL-RP-COLLAT-AMT   11556000
115570         MOVE INV-COLLATERAL-FACTOR TO CER-COLLAT-FACTOR          11557000
115580         MOVE INV-COLLATERAL-CODE   TO CER-COLLAT-CODE            11558000
115590         WRITE COLLAT-EXCEPT-OUT  FROM COLLATERAL-EXCEPTION-RECORD11559000
115600         PERFORM P3900-BUILD-PUR-RP-REC THRU P3909-EXIT           11560000
115610         GO TO P3990-PUR-RP-END.                                  11561000
115620                                                                  11562000
115630     IF HOLD-RP-COLLAT-AMT GREATER THAN TOT-COLLAT-AVAIL          11563000
115640         NEXT SENTENCE                                            11564000
115650     ELSE                                                         11565000
115660         GO TO P3740-START-COLLAT-2.                              11566000
115670                                                                  11567000
115680     DISPLAY 'CDCINFO-COLLAT EXCEPTION '.                         11568000
115690     DISPLAY BCF-BANK-NO ' '                                      11569000
115700             ACCOUNT-NUMBER ' '                                   11570000
115710             TOT-COLLAT-AVAIL.                                    11571000
115720                                                                  11572000
115730     MOVE BCF-BANK-NO            TO CER-BANK-NBR.                 11573000
115740     MOVE ACCOUNT-ID             TO CER-ACCT-ID.                  11574000
115750     MOVE ACCOUNT-NUMBER         TO CER-ACCT-NBR.                 11575000
115760     MOVE SHORT-NAME             TO CER-SHORT-NAME.               11576000
115770     MOVE INV-PLAN               TO CER-INV-PLAN.                 11577000
115780     MOVE HOLD-RP-AMT            TO CER-PROJ-RP-AMT.              11578000
115790     MOVE HOLD-RP-COLLAT-AMT     TO CER-PROJ-RP-COLLAT-AMT.       11579000
115800     MOVE TOT-COLLAT-AVAIL       TO HOLD-RP-COLLAT-AMT            11580000
115810                                    CER-ACTUAL-RP-COLLAT-AMT.     11581000
115820     MOVE INV-COLLATERAL-FACTOR  TO CER-COLLAT-FACTOR.            11582000
115830     MOVE INV-COLLATERAL-CODE    TO CER-COLLAT-CODE.              11583000
115840                                                                  11584000
115850     IF INV-COLLATERAL-FACTOR = +1.0000                           11585000
115860         MOVE HOLD-RP-COLLAT-AMT TO HOLD-RP-AMT                   11586000
115870     ELSE                                                         11587000
115880         DIVIDE HOLD-RP-COLLAT-AMT BY INV-COLLATERAL-FACTOR       11588000
115890             GIVING HOLD-RP-AMT.                                  11589000
115900                                                                  11590000
115910     MOVE HOLD-RP-AMT            TO HOLD-RP-WORK-AMT              11591000
115920                                    CER-ACTUAL-RP-AMT.            11592000
115930                                                                  11593000
115940     WRITE COLLAT-EXCEPT-OUT FROM COLLATERAL-EXCEPTION-RECORD.    11594000
115950                                                                  11595000
115960     IF HOLD-RP-COLLAT-AMT EQUAL ZEROES                           11596000
115970        MOVE '1' TO HOLD-RP-DISP-IND                              11597000
115980        GO TO P3990-PUR-RP-END.                                   11598000
115990                                                                  11599000
116000 P3740-START-COLLAT-2.                                            11600000
116010     MOVE PROC-BK-NO TO DSDS-COLLAT-BK.                           11601000
116020     MOVE ZEROS TO DSDS-COLLAT-RATE                               11602000
116030                   HOLD-RP-COLLAT-RATE.                           11603000
116040     MOVE ZEROS TO DSDS-COLLAT-SEQ.                               11604000
116050     MOVE ZEROS TO TOT-COLLAT-AVAIL.                              11605000
116060     START DSDS-COLLATERAL-FILE                                   11606000
116070         KEY GREATER THAN DSDS-COLLAT-REC-ID.                     11607000
116080     IF VSAM-SUCCESSFUL                                           11608000
116090         GO TO P3750-FIND-COLLAT-REC-2.                           11609000
116100     DISPLAY 'NO COLLATERAL FOR BANK ' PROC-BK-NO UPON CONSOLE.   11610000
116110     GO TO P3770-CHK-TOT-COLLAT-2.                                11611000
116120                                                                  11612000
116130 P3750-FIND-COLLAT-REC-2.                                         11613000
116140     READ DSDS-COLLATERAL-FILE NEXT INTO DSDS-COLLATERAL-RECORD.  11614000
116150     IF VSAM-END-OF-FILE                                          11615000
116160         GO TO P3770-CHK-TOT-COLLAT-2.                            11616000
116170     IF VSAM-SUCCESSFUL                                           11617000
116180         NEXT SENTENCE                                            11618000
116190       ELSE                                                       11619000
116200         DISPLAY 'COLLATERAL VSAM READ ERROR' UPON CONSOLE        11620000
116210         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  11621000
116220         CALL 'CDCDUMP' USING BY CONTENT '2053'.                  11622000
116230     IF COLLAT-BK-NO GREATER THAN PROC-BK-NO                      11623000
116240         GO TO P3770-CHK-TOT-COLLAT-2.                            11624000
116250     IF INV-COLLATERAL-CODE = COLLAT-ESCROW-CODE                  11625000
116260         NEXT SENTENCE                                            11626000
116270       ELSE                                                       11627000
116280         GO TO P3750-FIND-COLLAT-REC-2.                           11628000
116290     IF COLLAT-AVAIL-BAL = ZERO                                   11629000
116300         GO TO P3750-FIND-COLLAT-REC-2.                           11630000
116310     IF HOLD-RP-COLLAT-RATE = ZEROS                               11631000
116320         MOVE COLLAT-RATE TO HOLD-RP-COLLAT-RATE.                 11632000
116330     IF COLLAT-RATE = HOLD-RP-COLLAT-RATE                         11633000
116340         NEXT SENTENCE                                            11634000
116350       ELSE                                                       11635000
116360         GO TO P3780-START-COLLAT-3.                              11636000
116370     IF HOLD-RP-COLLAT-AMT GREATER THAN COLLAT-AVAIL-BAL          11637000
116380         ADD COLLAT-AVAIL-BAL TO TOT-COLLAT-AVAIL                 11638000
116390         GO TO P3750-FIND-COLLAT-REC-2.                           11639000
116400     MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT.                          11640000
116410     MOVE HOLD-RP-COLLAT-AMT TO HOLD-RP-MARKET-VALUE.             11641000
116420     PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT.                  11642000
116430                                                                  11643000
116440 P3760-UPDATE-COLLAT-REC-2.                                       11644000
116450     SUBTRACT HOLD-RP-MARKET-VALUE FROM COLLAT-AVAIL-BAL.         11645000
116460     REWRITE DSDS-COLLAT-REC FROM DSDS-COLLATERAL-RECORD.         11646000
116470     IF VSAM-SUCCESSFUL                                           11647000
116480         GO TO P3990-PUR-RP-END.                                  11648000
116490     DISPLAY 'COLLATERAL VSAM REWRITE ERROR' UPON CONSOLE.        11649000
116500     DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE.     11650000
116510     CALL 'CDCDUMP' USING BY CONTENT '2054'.                      11651000
116520                                                                  11652000
116530 P3770-CHK-TOT-COLLAT-2.                                          11653000
116540     IF HOLD-RP-COLLAT-AMT GREATER THAN TOT-COLLAT-AVAIL          11654000
116550         MOVE OSB-DESC-0059-A TO COL-DESC1                        11655000
116560         MOVE OSB-DESC-0059-B TO COL-DESC2                        11656000
116570         MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                       11657000
116580                             HOLD-RP-MARKET-VALUE                 11658000
116590         MOVE +01.000 TO COLLAT-RATIO                             11659000
116600         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11660000
116610         GO TO P3990-PUR-RP-END.                                  11661000
116620                                                                  11662000
116630 P3780-START-COLLAT-3.                                            11663000
116640     MOVE PROC-BK-NO TO DSDS-COLLAT-BK.                           11664000
116650     MOVE ZEROS TO DSDS-COLLAT-RATE.                              11665000
116660     MOVE ZEROS TO DSDS-COLLAT-SEQ.                               11666000
116670     START DSDS-COLLATERAL-FILE                                   11667000
116680         KEY GREATER THAN DSDS-COLLAT-REC-ID.                     11668000
116690     IF VSAM-SUCCESSFUL                                           11669000
116700         GO TO P3790-FIND-COLLAT-REC-3.                           11670000
116710     DISPLAY 'COLLATERAL VSAM START ERROR' UPON CONSOLE.          11671000
116720     DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE.     11672000
116730     CALL 'CDCDUMP' USING BY CONTENT '2055'.                      11673000
116740                                                                  11674000
116750 P3790-FIND-COLLAT-REC-3.                                         11675000
116760     READ DSDS-COLLATERAL-FILE NEXT INTO DSDS-COLLATERAL-RECORD.  11676000
116770     IF VSAM-END-OF-FILE                                          11677000
116780         GO TO P3830-NO-COLLAT-3.                                 11678000
116790     IF VSAM-SUCCESSFUL                                           11679000
116800         NEXT SENTENCE                                            11680000
116810       ELSE                                                       11681000
116820         DISPLAY 'COLLATERAL VSAM READ ERROR' UPON CONSOLE        11682000
116830         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  11683000
116840         CALL 'CDCDUMP' USING BY CONTENT '2056'.                  11684000
116850     IF COLLAT-BK-NO GREATER THAN PROC-BK-NO                      11685000
116860         GO TO P3830-NO-COLLAT-3.                                 11686000
116870     IF INV-COLLATERAL-CODE = COLLAT-ESCROW-CODE                  11687000
116880         NEXT SENTENCE                                            11688000
116890       ELSE                                                       11689000
116900         GO TO P3790-FIND-COLLAT-REC-3.                           11690000
116910     IF COLLAT-AVAIL-BAL = ZERO                                   11691000
116920         GO TO P3790-FIND-COLLAT-REC-3.                           11692000
116930     IF HOLD-RP-COLLAT-AMT GREATER THAN COLLAT-AVAIL-BAL          11693000
116940         NEXT SENTENCE                                            11694000
116950       ELSE                                                       11695000
116960         GO TO P3800-FIND-COLLAT-REC-3-CONT.                      11696000
116970     IF INV-COLLATERAL-FACTOR = +1.0000                           11697000
116980         MOVE COLLAT-AVAIL-BAL TO HOLD-RP-TX-AMT                  11698000
116990                                  HOLD-RP-MARKET-VALUE            11699000
117000         SUBTRACT COLLAT-AVAIL-BAL FROM HOLD-RP-COLLAT-AMT        11700000
117010         SUBTRACT HOLD-RP-TX-AMT FROM HOLD-RP-WORK-AMT            11701000
117020         PERFORM P3810-UPDATE-COLLAT-REC-3 THRU P3819-EXIT        11702000
117030         PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT               11703000
117040         GO TO P3790-FIND-COLLAT-REC-3.                           11704000
117050     DIVIDE COLLAT-AVAIL-BAL BY INV-COLLATERAL-FACTOR             11705000
117060         GIVING HOLD-RP-TX-AMT ROUNDED.                           11706000
117070     MOVE COLLAT-AVAIL-BAL TO HOLD-RP-MARKET-VALUE.               11707000
117080     SUBTRACT COLLAT-AVAIL-BAL FROM HOLD-RP-COLLAT-AMT.           11708000
117090     SUBTRACT HOLD-RP-TX-AMT FROM HOLD-RP-WORK-AMT.               11709000
117100     PERFORM P3810-UPDATE-COLLAT-REC-3 THRU P3819-EXIT.           11710000
117110     PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT.                  11711000
117120     GO TO P3790-FIND-COLLAT-REC-3.                               11712000
117130                                                                  11713000
117140 P3800-FIND-COLLAT-REC-3-CONT.                                    11714000
117150     MOVE HOLD-RP-WORK-AMT TO HOLD-RP-TX-AMT.                     11715000
117160     MOVE HOLD-RP-COLLAT-AMT TO  HOLD-RP-MARKET-VALUE.            11716000
117170     PERFORM P3810-UPDATE-COLLAT-REC-3 THRU P3819-EXIT.           11717000
117180     PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT.                  11718000
117190     GO TO P3990-PUR-RP-END.                                      11719000
117200                                                                  11720000
117210 P3810-UPDATE-COLLAT-REC-3.                                       11721000
117220     SUBTRACT HOLD-RP-MARKET-VALUE FROM COLLAT-AVAIL-BAL.         11722000
117230     REWRITE DSDS-COLLAT-REC FROM DSDS-COLLATERAL-RECORD.         11723000
117240     IF VSAM-SUCCESSFUL                                           11724000
117250         GO TO P3819-EXIT.                                        11725000
117260     DISPLAY 'COLLATERAL VSAM REWRITE ERROR' UPON CONSOLE.        11726000
117270     DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE.     11727000
117280     CALL 'CDCDUMP' USING BY CONTENT '2057'.                      11728000
117290                                                                  11729000
117300 P3819-EXIT.                                                      11730000
117310     EXIT.                                                        11731000
117320                                                                  11732000
117330 P3830-NO-COLLAT-3.                                               11733000
117340     MOVE OSB-DESC-0059-A TO COL-DESC1.                           11734000
117350     MOVE OSB-DESC-0059-B TO COL-DESC2.                           11735000
117360     MOVE HOLD-RP-AMT TO HOLD-RP-TX-AMT                           11736000
117370                         HOLD-RP-MARKET-VALUE.                    11737000
117380     MOVE +01.000 TO COLLAT-RATIO.                                11738000
117390     PERFORM P3840-INIT-PUR-TXS THRU P3909-EXIT.                  11739000
117400     GO TO P3990-PUR-RP-END.                                      11740000
117410                                                                  11741000
117420 P3840-INIT-PUR-TXS.                                              11742000
117430     IF USE-TIERED-RP-RATES                                       11743000
117440         MOVE HOLD-RP-AMT TO INV-BALANCE                          11744000
117450         PERFORM P4300-GET-INV-RATE THRU P4399-EXIT.              11745000
117460     MOVE 1 TO DSDSTXL-PENDING-SW.                                11746000
117470     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     11747000
117480     MOVE HOLD-RP-TX-AMT TO DSDSTXL-AMOUNT.                       11748000
117490     ADD HOLD-RP-TX-AMT TO AMT-INV-PUR-ON-STMT.                   11749000
117500     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       11750000
117510                                                                  11751000
117520 P3850-BUILD-DDA-TX.                                              11752000
117530     MOVE 785 TO DSDSTXL-CODE.                                    11753000
117540     MOVE 'PRP' TO PJ-HOLD-CODE.                                  11754000
117550     MOVE OSB-DESC-0022-A TO INV-PUR-DESC-1.                      11755000
117560     EVALUATE INV-PLAN                                            11756000
117570         WHEN 'RP'                                                11757000
117580             MOVE 'RP' TO INV-PUR-DESC-2                          11758000
117590         WHEN 'TE'                                                11759000
117600             MOVE 'TAX EXEMPT FUND' TO INV-PUR-DESC-2             11760000
117610         WHEN 'TF'                                                11761000
117620             MOVE 'TREASURY FUND' TO INV-PUR-DESC-2               11762000
117630         WHEN 'TR'                                                11763000
117640             MOVE 'TERM REPO' TO INV-PUR-DESC-2                   11764000
117650         WHEN 'FF'                                                11765000
117660             MOVE 'FED FUNDS' TO INV-PUR-DESC-2                   11766000
117670         WHEN 'CF'                                                11767000
117680             MOVE 'CASH MGMT TRUST' TO INV-PUR-DESC-2             11768000
117690         WHEN OTHER                                               11769000
117700             MOVE 'RP' TO INV-PUR-DESC-2                          11770000
117710     END-EVALUATE.                                                11771000
117720     MOVE INV-TX-DESC-16 TO DSDSTXL-CO-DESC.                      11772000
117730     MOVE INV-TX-DESC-10 TO DSDSTXL-DESC.                         11773000
117740     MOVE PUR-INV-KEY TO SAVE-DR-SORT-KEY.                        11774000
117750     ADD 1 TO NUM-BILL-TX.                                        11775000
117760     IF INV-COLL-ONLY-IND = 'N'                                   11776000
117770         PERFORM P1665-NORM-DEBIT.                                11777000
117780                                                                  11778000
117790 P3860-BUILD-INV-DESC.                                            11779000
117800     MOVE COL-DESC2 TO DESC-WORK-1.                               11780000
117810     IF INV-PLUS-VARIANCE                                         11781000
117820         ADD INV-RATE-VARIANCE  INV-RATE  GIVING  HOLD-RP-RATE    11782000
117830         MULTIPLY HOLD-RP-RATE BY 100 GIVING DESC-RATE            11783000
117840         GO TO P3870-BUILD-INV-TX.                                11784000
117850     IF INV-MINUS-VARIANCE                                        11785000
117860         SUBTRACT INV-RATE-VARIANCE FROM INV-RATE                 11786000
117870             GIVING HOLD-RP-RATE                                  11787000
117880         IF HOLD-RP-RATE NEGATIVE                                 11788000
117890             MOVE ZEROS TO HOLD-RP-RATE                           11789000
117900         END-IF                                                   11790000
117910         MULTIPLY HOLD-RP-RATE BY 100 GIVING DESC-RATE            11791000
117920         GO TO P3870-BUILD-INV-TX.                                11792000
117930     MOVE INV-RATE TO HOLD-RP-RATE.                               11793000
117940     MULTIPLY HOLD-RP-RATE BY 100 GIVING DESC-RATE.               11794000
117950                                                                  11795000
117960 P3870-BUILD-INV-TX.                                              11796000
117970     MOVE 671 TO DSDSTXL-CODE.                                    11797000
117980     MOVE COL-DESC1 TO DSDSTXL-CO-DESC INV-DESC1.                 11798000
117990     MOVE DESCRIPTION-WORK TO DSDSTXL-DESC INV-DESC2.             11799000
118000     MOVE INV-PUR-KEY TO DSDSTXL-SORT-KEY.                        11800000
118010     MOVE COLLAT-CUSIP TO DSDSTXL-INV-CUSIP.                      11801000
118020     MOVE HOLD-RP-AMT TO INV-BALANCE.                             11802000
118030     ADD 1 TO NUM-BILL-TX.                                        11803000
118040     IF HOLD-RP-MARKET-VALUE = ZERO OR COLLAT-RATIO = ZERO        11804000
118050         MOVE ZERO TO HOLD-RP-SECURE-AMT                          11805000
118060       ELSE                                                       11806000
118070         DIVIDE HOLD-RP-MARKET-VALUE BY COLLAT-RATIO              11807000
118080             GIVING HOLD-RP-SECURE-AMT ROUNDED.                   11808000
118090     IF INV-COLL-ONLY-IND = 'N'                                   11809000
118100         PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT. 11810000
118110     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 11811000
118120                                                                  11812000
118130 P3880-DAILY-INT-FOR-COLLAT-REC.                                  11813000
118140     IF HOLD-RP-COLLAT-CNT = ZERO                                 11814000
118150         NEXT SENTENCE                                            11815000
118160       ELSE                                                       11816000
118170         GO TO P3890-INIT-COLLAT-REC.                             11817000
118180     PERFORM P0590-ACCR-INV-INT THRU P0599-EXIT.                  11818000
118190     MOVE HOLD-DAILY-ACCR TO HOLD-RP-DAILY-INT.                   11819000
118200                                                                  11820000
118210 P3890-INIT-COLLAT-REC.                                           11821000
118220     ADD 1 TO HOLD-RP-COLLAT-CNT.                                 11822000
118230     PERFORM P8230-BUILD-COLLAT-NTC THRU P8239-EXIT.              11823000
118240                                                                  11824000
118250 P3900-BUILD-PUR-RP-REC.                                          11825000
118260     PERFORM P7270-PURCHASE-RP-RPT THRU P7279-EXIT.               11826000
118270                                                                  11827000
118280 P3909-EXIT.                                                      11828000
118290     EXIT.                                                        11829000
118300                                                                  11830000
118310 P3990-PUR-RP-END.                                                11831000
118320     IF HOLD-REASON-CODE = 18                                     11832000
118330         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.            11833000
118340     IF HOLD-RP-COLLAT-CNT GREATER THAN 1                         11834000
118350         MOVE OSB-DESC-0023-A TO INV-DESC1                        11835000
118360         MOVE OSB-DESC-0023-B TO INV-DESC2.                       11836000
118370     IF HOLD-RP-COLLAT-CNT GREATER THAN 0                         11837000
118380         MOVE 999 TO HOLD-RP-COLLAT-CNT                           11838000
118390         PERFORM P8230-BUILD-COLLAT-NTC THRU P8239-EXIT.          11839000
118400     IF INV-NO-ADJUSTMENT OR INV-ADJUST-PEGGED                    11840000
118410         MOVE ZEROS TO INV-SHORT-BAL.                             11841000
118420     IF T-SHARE                                                   11842000
118430         PERFORM P4300-GET-INV-RATE THRU P4399-EXIT.              11843000
118440     IF HOLD-RP-DISP-IND NOT = ' '                                11844000
118450         PERFORM P7270-PURCHASE-RP-RPT THRU P7279-EXIT.           11845000
118460                                                                  11846000
118470 P3999-EXIT.                                                      11847000
118480     EXIT.                                                        11848000
118490                                                                  11849000
118500******************************************************************11850000
118510*        I N V E S T M E N T   C Y C L E   R O U T I N E         *11851000
118520******************************************************************11852000
118530 P4000-CYCLE-INV.                                                 11853000
118540     IF INV-CLOSED                                                11854000
118550         GO TO P4099-EXIT.                                        11855000
118560     IF TERM-REPO OR INTERBANK-TERM-REPO                          11856000
118570         NEXT SENTENCE                                            11857000
118580       ELSE                                                       11858000
118590         PERFORM P4100-POST-INV-INT THRU P4199-EXIT.              11859000
118600                                                                  11860000
118610 P4010-UPDATE-CYCLE.                                              11861000
118620     IF CYCLE-THIS-STMT = 0                                       11862000
118630         GO TO P4099-EXIT.                                        11863000
118640     ADD INV-ACCRUED-INT                                          11864000
118650         INV-INT-REPORTABLE                                       11865000
118660             GIVING INV-INT-PAID-LAST-CYC.                        11866000
118670     SUBTRACT INV-ACCRUED-INT FROM ZERO                           11867000
118680         GIVING INV-INT-REPORTABLE.                               11868000
118690     MOVE INV-LAST-STMT-BAL TO HOLD-PREV-INV-STMT-BAL.            11869000
118700     MOVE INV-BALANCE TO INV-LAST-STMT-BAL.                       11870000
118710     MOVE INV-GROSS-BAL TO INV-GROSS-BAL-LAST-CYC.                11871000
118720     MOVE INV-DAYS-INVESTED TO INV-DAYS-INVEST-LAST-CYC.          11872000
118730     MOVE INV-GROSS-INT TO INV-GROSS-INT-LAST-CYC.                11873000
118740     MOVE ZEROS TO INV-GROSS-BAL                                  11874000
118750                   INV-GROSS-INT                                  11875000
118760                   INV-DAYS-INVESTED.                             11876000
118770     MOVE DAYS-IN-CYCLE TO INV-DAYS-IN-PREV-CYCLE.                11877000
118780                                                                  11878000
118790 P4099-EXIT.                                                      11879000
118800     EXIT.                                                        11880000
118810                                                                  11881000
118820******************************************************************11882000
118830*        P O S T   I N V E S T M E N T   I N T E R E S T         *11883000
118840******************************************************************11884000
118850 P4100-POST-INV-INT.                                              11885000
118860     IF INV-ACCRUED-INT = ZERO                                    11886000
118870         GO TO P4199-EXIT.                                        11887000
118880     ADD +.005 TO INV-ACCRUED-INT.                                11888000
118890                                                                  11889000
118900 P4110-POST-INV-INT-2.                                            11890000
118910     MOVE 1 TO DSDSTXL-PENDING-SW.                                11891000
118920     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     11892000
118930     MOVE INV-ACCRUED-INT TO DSDSTXL-AMOUNT.                      11893000
118940     ADD INV-ACCRUED-INT TO INV-INT-REPORTABLE                    11894000
118950                            INV-INT-PAID-YTD                      11895000
118960                            TDY-PAID-BY-PLAN-INV (SUB11)          11896000
118970                            TDY-PAID-BY-PLAN-INV (11).            11897000
118980     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       11898000
118990     MOVE ZEROS TO INV-ACCRUED-INT.                               11899000
119000     MOVE 675 TO DSDSTXL-CODE.                                    11900000
119010     MOVE OSB-DESC-0024-A TO DSDSTXL-CO-DESC.                     11901000
119020     MOVE OSB-DESC-0024-B TO DSDSTXL-DESC.                        11902000
119030     MOVE INV-INT-KEY TO DSDSTXL-SORT-KEY.                        11903000
119040     ADD 1 TO NUM-BILL-TX.                                        11904000
119050     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     11905000
119060                                                                  11906000
119070 P4120-BUILD-DDA-INT-TX.                                          11907000
119080     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             11908000
119090     MOVE 640 TO DSDSTXL-CODE.                                    11909000
119100     MOVE OSB-DESC-0025-A TO DSDSTXL-CO-DESC.                     11910000
119110     MOVE OSB-DESC-0025-B TO DSDSTXL-DESC.                        11911000
119120     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL                      11912000
119130                           GEN-CREDIT-AMT.                        11913000
119140     ADD 1 TO GEN-CREDIT-CNT.                                     11914000
119150     ADD 1 TO NUM-BILL-TX.                                        11915000
119160     MOVE 'RPI' TO PJ-HOLD-CODE.                                  11916000
119170     PERFORM P1325-NORM-CR-2.                                     11917000
119180                                                                  11918000
119190 P4130-CHK-INV-WITH.                                              11919000
119200     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             11920000
119210     IF NOT-IN-WITHHOLD-STATUS                                    11921000
119220         GO TO P4160-POST-INV-INT-END.                            11922000
119230     MOVE DSDSTXL-AMOUNT TO HOLD-EARNINGS.                        11923000
119240     MOVE +02 TO IRSPL-GROUP-ID.                                  11924000
119250     PERFORM P1810-POST-CYCLE-EARN-WH THRU P1819-EXIT.            11925000
119260     IF HOLD-TAX-WITHHELD = ZERO                                  11926000
119270         GO TO P4160-POST-INV-INT-END.                            11927000
119280                                                                  11928000
119290 P4140-BUILD-INV-TAX-TX.                                          11929000
119300     MOVE HOLD-TAX-WITHHELD TO DSDSTXL-AMOUNT.                    11930000
119310     MOVE 679 TO DSDSTXL-CODE.                                    11931000
119320     MOVE OSB-DESC-0026-A TO DSDSTXL-CO-DESC.                     11932000
119330     MOVE OSB-DESC-0026-B TO DSDSTXL-DESC.                        11933000
119340     MOVE INV-TAX-KEY TO DSDSTXL-SORT-KEY.                        11934000
119350     ADD 1 TO NUM-BILL-TX.                                        11935000
119360     PERFORM P8570-BUILD-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     11936000
119370                                                                  11937000
119380 P4150-BUILD-DDA-TAX-TX.                                          11938000
119390     MOVE 801 TO DSDSTXL-CODE.                                    11939000
119400     MOVE OSB-DESC-0027-A TO DSDSTXL-CO-DESC.                     11940000
119410     MOVE OSB-DESC-0027-B TO DSDSTXL-DESC.                        11941000
119420     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                11942000
119430     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       11943000
119440     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             11944000
119450     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          11945000
119460                           INV-TAX-WITHHELD-YTD                   11946000
119470                           TDY-WITH-BY-PLAN-INV (SUB11)           11947000
119480                           TDY-WITH-BY-PLAN-INV (11).             11948000
119490     ADD 1 TO GEN-DEBIT-CNT                                       11949000
119500              NUM-BILL-TX.                                        11950000
119510     PERFORM P1665-NORM-DEBIT.                                    11951000
119520                                                                  11952000
119530 P4160-POST-INV-INT-END.                                          11953000
119540     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 11954000
119550                                                                  11955000
119560 P4199-EXIT.                                                      11956000
119570     EXIT.                                                        11957000
119580                                                                  11958000
119590******************************************************************11959000
119600*  C H E C K   I N V E S T M E N T   M A T U R I T Y   D A T E   *11960000
119610******************************************************************11961000
119620 P4200-CHECK-INV-MATURITY.                                        11962000
119630     IF INV-CLOSED AND INV-CLOSED-CYC-STMT                        11963000
119640         GO TO P4299-EXIT.                                        11964000
119650     IF REPURCHASE OR                                             11965000
119660        TAX-EXEMPT-FUND OR                                        11966000
119670        TREASURY-FUND OR                                          11967000
119680        FED-FUNDS OR                                              11968000
119690        CASH-MGMT-TRUST-FUND                                      11969000
119700         MOVE ZEROS TO INV-MATURE-DATE                            11970000
119710         PERFORM P3500-MATURE-RP THRU P3549-EXIT                  11971000
119720         MOVE 1 TO INV-MAT-TDY                                    11972000
119730         GO TO P4299-EXIT.                                        11973000
119740                                                                  11974000
119750* INACTIVE TR, IR OR TS                                           11975000
119760     IF (INV-TERM          = +0 OR +1) AND                        11976000
119770        INV-MATURE-DATE   = ZERO AND                              11977000
119780        INV-NEXT-TERM     = +1   AND                              11978000
119790        INV-NEXT-MAT-DATE = ZERO                                  11979000
119800         GO TO P4299-EXIT.                                        11980000
119810                                                                  11981000
119820* FORCED MATURITY TR, IR OR TS                                    11982000
119830     IF INV-NEXT-TERM GREATER THAN +89999                         11983000
119840         GO TO P4260-FORCED-INV-MATURITY.                         11984000
119850                                                                  11985000
119860* NEW TR, IT OR TS                                                11986000
119870     IF (INV-TERM          = +0 OR +1) AND                        11987000
119880        INV-MATURE-DATE = ZERO                                    11988000
119890         GO TO P4220-NEW-INV.                                     11989000
119900                                                                  11990000
119910* MATURING TR, IR OR TS                                           11991000
119920     IF INV-MATURE-DATE GREATER THAN PROC-LAST-DATE AND           11992000
119930                        LESS    THAN PROC-NEXT-DATE               11993000
119940         GO TO P4240-MATURING-INV.                                11994000
119950                                                                  11995000
119960* ACTIVE TR, IR OR TS                                             11996000
119970     GO TO P4299-EXIT.                                            11997000
119980                                                                  11998000
119990 P4220-NEW-INV.                                                   11999000
120000     PERFORM P3500-MATURE-RP THRU P3549-EXIT.                     12000000
120010                                                                  12001000
120020     MOVE INV-TERM TO HOLD-OLD-INV-TERM.                          12002000
120030     MOVE INV-NEXT-TERM TO INV-TERM                               12003000
120040                           HOLD-NEW-INV-TERM.                     12004000
120050     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12005000
120060     PERFORM P8489-INV-TERM-CHANGE THRU P8489-EXIT.               12006000
120070                                                                  12007000
120080                                                                  12008000
120090     CALL 'CDCDT48' USING INV-MATURE-DATE                         12009000
120100                          HOLD-OLD-INV-MAT-DATE.                  12010000
120110     MOVE INV-NEXT-MAT-DATE TO INV-MATURE-DATE.                   12011000
120120     CALL 'CDCDT48' USING INV-MATURE-DATE                         12012000
120130                          HOLD-NEW-INV-MAT-DATE.                  12013000
120140     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12014000
120150     PERFORM P8490-INV-MAT-DATE-CHANGE THRU P8490-EXIT.           12015000
120160                                                                  12016000
120170                                                                  12017000
120180     MOVE INV-NEXT-TERM TO HOLD-OLD-INV-NEXT-TERM.                12018000
120190     MOVE +1 TO INV-NEXT-TERM                                     12019000
120200                HOLD-NEW-INV-NEXT-TERM.                           12020000
120210     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12021000
120220     PERFORM P8491-INV-NEXT-TERM-CHANGE THRU P8491-EXIT.          12022000
120230                                                                  12023000
120240                                                                  12024000
120250     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12025000
120260                          HOLD-OLD-INV-NEXT-MAT-DATE.             12026000
120270     MOVE ZEROS TO INV-NEXT-MAT-DATE.                             12027000
120280     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12028000
120290                          HOLD-NEW-INV-NEXT-MAT-DATE.             12029000
120300     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12030000
120310     PERFORM P8492-INV-NEXT-MAT-DATE-CHANGE THRU P8492-EXIT.      12031000
120320                                                                  12032000
120330                                                                  12033000
120340     MOVE 1 TO INV-MAT-TDY.                                       12034000
120350     GO TO P4299-EXIT.                                            12035000
120360                                                                  12036000
120370 P4240-MATURING-INV.                                              12037000
120380     PERFORM P3500-MATURE-RP THRU P3549-EXIT.                     12038000
120390                                                                  12039000
120400     MOVE INV-TERM TO HOLD-OLD-INV-TERM.                          12040000
120410     MOVE INV-NEXT-TERM TO INV-TERM                               12041000
120420                           HOLD-NEW-INV-TERM.                     12042000
120430     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12043000
120440     PERFORM P8489-INV-TERM-CHANGE THRU P8489-EXIT.               12044000
120450                                                                  12045000
120460                                                                  12046000
120470     CALL 'CDCDT48' USING INV-MATURE-DATE                         12047000
120480                          HOLD-OLD-INV-MAT-DATE.                  12048000
120490     MOVE INV-NEXT-MAT-DATE TO INV-MATURE-DATE.                   12049000
120500     CALL 'CDCDT48' USING INV-MATURE-DATE                         12050000
120510                          HOLD-NEW-INV-MAT-DATE.                  12051000
120520     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12052000
120530     PERFORM P8490-INV-MAT-DATE-CHANGE THRU P8490-EXIT.           12053000
120540                                                                  12054000
120550                                                                  12055000
120560     MOVE INV-NEXT-TERM TO HOLD-OLD-INV-NEXT-TERM.                12056000
120570     MOVE +1 TO INV-NEXT-TERM                                     12057000
120580                HOLD-NEW-INV-NEXT-TERM.                           12058000
120590     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12059000
120600     PERFORM P8491-INV-NEXT-TERM-CHANGE THRU P8491-EXIT.          12060000
120610                                                                  12061000
120620                                                                  12062000
120630     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12063000
120640                          HOLD-OLD-INV-NEXT-MAT-DATE.             12064000
120650     MOVE ZEROS TO INV-NEXT-MAT-DATE.                             12065000
120660     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12066000
120670                          HOLD-NEW-INV-NEXT-MAT-DATE.             12067000
120680     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12068000
120690     PERFORM P8492-INV-NEXT-MAT-DATE-CHANGE THRU P8492-EXIT.      12069000
120700                                                                  12070000
120710                                                                  12071000
120720     IF INV-MATURE-DATE = ZEROS                                   12072000
120730         GO TO P4299-EXIT.                                        12073000
120740                                                                  12074000
120750     MOVE 1 TO INV-MAT-TDY.                                       12075000
120760     GO TO P4299-EXIT.                                            12076000
120770                                                                  12077000
120780 P4260-FORCED-INV-MATURITY.                                       12078000
120790     PERFORM P3500-MATURE-RP THRU P3549-EXIT.                     12079000
120800                                                                  12080000
120810     MOVE INV-TERM TO HOLD-OLD-INV-TERM.                          12081000
120820     SUBTRACT 90000 FROM INV-NEXT-TERM                            12082000
120830         GIVING INV-TERM                                          12083000
120840                HOLD-NEW-INV-TERM.                                12084000
120850     IF INV-TERM = ZERO                                           12085000
120860         MOVE +1 TO INV-TERM                                      12086000
120870                    HOLD-NEW-INV-TERM.                            12087000
120880     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12088000
120890     PERFORM P8489-INV-TERM-CHANGE THRU P8489-EXIT.               12089000
120900                                                                  12090000
120910                                                                  12091000
120920     CALL 'CDCDT48' USING INV-MATURE-DATE                         12092000
120930                          HOLD-OLD-INV-MAT-DATE.                  12093000
120940     MOVE INV-NEXT-MAT-DATE TO INV-MATURE-DATE.                   12094000
120950     CALL 'CDCDT48' USING INV-MATURE-DATE                         12095000
120960                          HOLD-NEW-INV-MAT-DATE.                  12096000
120970     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12097000
120980     PERFORM P8490-INV-MAT-DATE-CHANGE THRU P8490-EXIT.           12098000
120990                                                                  12099000
121000                                                                  12100000
121010     MOVE INV-NEXT-TERM TO HOLD-OLD-INV-NEXT-TERM.                12101000
121020     MOVE +1 TO INV-NEXT-TERM                                     12102000
121030                HOLD-NEW-INV-NEXT-TERM.                           12103000
121040     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12104000
121050     PERFORM P8491-INV-NEXT-TERM-CHANGE THRU P8491-EXIT.          12105000
121060                                                                  12106000
121070                                                                  12107000
121080     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12108000
121090                          HOLD-OLD-INV-NEXT-MAT-DATE.             12109000
121100     MOVE ZEROS TO INV-NEXT-MAT-DATE.                             12110000
121110     CALL 'CDCDT48' USING INV-NEXT-MAT-DATE                       12111000
121120                          HOLD-NEW-INV-NEXT-MAT-DATE.             12112000
121130     MOVE 'Y' TO HOLD-EXTRACT-IND.                                12113000
121140     PERFORM P8492-INV-NEXT-MAT-DATE-CHANGE THRU P8492-EXIT.      12114000
121150                                                                  12115000
121160                                                                  12116000
121170     IF INV-MATURE-DATE = ZEROS                                   12117000
121180         GO TO P4299-EXIT.                                        12118000
121190                                                                  12119000
121200     MOVE 1 TO INV-MAT-TDY.                                       12120000
121210     GO TO P4299-EXIT.                                            12121000
121220                                                                  12122000
121230 P4299-EXIT.                                                      12123000
121240     EXIT.                                                        12124000
121250                                                                  12125000
121260******************************************************************12126000
121270*             G E T   I N V E S T M E N T   R A T E              *12127000
121280******************************************************************12128000
121290 P4300-GET-INV-RATE.                                              12129000
121300     IF INV-FIXED-RATE                                            12130000
121310         GO TO P4399-EXIT.                                        12131000
121320     EVALUATE TRUE                                                12132000
121330         WHEN REPURCHASE                                          12133000
121340             GO TO P4310-INV-RP-RATE                              12134000
121350         WHEN T-SHARE                                             12135000
121360             GO TO P4320-INV-TS-RATE                              12136000
121370         WHEN TERM-REPO                                           12137000
121380             GO TO P4330-INV-TR-RATE                              12138000
121390         WHEN TAX-EXEMPT-FUND                                     12139000
121400             GO TO P4340-INV-TE-RATE                              12140000
121410         WHEN TREASURY-FUND                                       12141000
121420             GO TO P4350-INV-TF-RATE                              12142000
121430         WHEN INTERBANK-TERM-REPO                                 12143000
121440             GO TO P4360-INV-IR-RATE                              12144000
121450         WHEN FED-FUNDS                                           12145000
121460             GO TO P4370-INV-FF-RATE                              12146000
121470         WHEN CASH-MGMT-TRUST-FUND                                12147000
121480             GO TO P4380-INV-CF-RATE                              12148000
121490         WHEN OTHER                                               12149000
121500             GO TO P4310-INV-RP-RATE                              12150000
121510     END-EVALUATE.                                                12151000
121520                                                                  12152000
121530 P4310-INV-RP-RATE.                                               12153000
121540     IF USE-TIERED-RP-RATES                                       12154000
121550         EVALUATE INV-OVERNIGHT-RATE-IND                          12155000
121560             WHEN '1'                                             12156000
121570                 MOVE 083 TO ADM-RTE-TYPE                         12157000
121580                 GO TO P4390-CALL-FOR-RATE                        12158000
121590             WHEN '2'                                             12159000
121600                 MOVE 084 TO ADM-RTE-TYPE                         12160000
121610                 GO TO P4390-CALL-FOR-RATE                        12161000
121620             WHEN '3'                                             12162000
121630                 MOVE 085 TO ADM-RTE-TYPE                         12163000
121640                 GO TO P4390-CALL-FOR-RATE                        12164000
121650             WHEN '4'                                             12165000
121660                 MOVE 086 TO ADM-RTE-TYPE                         12166000
121670                 GO TO P4390-CALL-FOR-RATE                        12167000
121680             WHEN '5'                                             12168000
121690                 MOVE 087 TO ADM-RTE-TYPE                         12169000
121700                 GO TO P4390-CALL-FOR-RATE                        12170000
121710             WHEN OTHER                                           12171000
121720                 MOVE 083 TO ADM-RTE-TYPE                         12172000
121730                 GO TO P4390-CALL-FOR-RATE                        12173000
121740         END-EVALUATE                                             12174000
121750       ELSE                                                       12175000
121760         EVALUATE INV-OVERNIGHT-RATE-IND                          12176000
121770             WHEN '1'                                             12177000
121780                 MOVE OVERNIGHT-RATE-1 TO INV-RATE                12178000
121790             WHEN '2'                                             12179000
121800                 MOVE OVERNIGHT-RATE-2 TO INV-RATE                12180000
121810             WHEN '3'                                             12181000
121820                 MOVE OVERNIGHT-RATE-3 TO INV-RATE                12182000
121830             WHEN '4'                                             12183000
121840                 MOVE OVERNIGHT-RATE-4 TO INV-RATE                12184000
121850             WHEN '5'                                             12185000
121860                 MOVE OVERNIGHT-RATE-5 TO INV-RATE                12186000
121870             WHEN OTHER                                           12187000
121880                 MOVE OVERNIGHT-RATE-1 TO INV-RATE                12188000
121890         END-EVALUATE                                             12189000
121900     END-IF.                                                      12190000
121910     GO TO P4395-CHK-INV-RATE.                                    12191000
121920                                                                  12192000
121930 P4320-INV-TS-RATE.                                               12193000
121940     MOVE 055 TO ADM-RTE-TYPE.                                    12194000
121950     GO TO P4390-CALL-FOR-RATE.                                   12195000
121960                                                                  12196000
121970 P4330-INV-TR-RATE.                                               12197000
121980     MOVE 052 TO ADM-RTE-TYPE.                                    12198000
121990     GO TO P4390-CALL-FOR-RATE.                                   12199000
122000                                                                  12200000
122010 P4340-INV-TE-RATE.                                               12201000
122020     MOVE TAX-EXEMPT-RATE TO INV-RATE.                            12202000
122030     GO TO P4395-CHK-INV-RATE.                                    12203000
122040                                                                  12204000
122050 P4350-INV-TF-RATE.                                               12205000
122060     MOVE TREASURY-FUND-RATE TO INV-RATE.                         12206000
122070     GO TO P4395-CHK-INV-RATE.                                    12207000
122080                                                                  12208000
122090 P4360-INV-IR-RATE.                                               12209000
122100     MOVE 052 TO ADM-RTE-TYPE.                                    12210000
122110     GO TO P4390-CALL-FOR-RATE.                                   12211000
122120                                                                  12212000
122130 P4370-INV-FF-RATE.                                               12213000
122140     MOVE FED-FUNDS-RT TO INV-RATE.                               12214000
122150     GO TO P4395-CHK-INV-RATE.                                    12215000
122160                                                                  12216000
122170 P4380-INV-CF-RATE.                                               12217000
122180     MOVE CASH-MGMT-TRUST-RATE TO INV-RATE.                       12218000
122190     GO TO P4395-CHK-INV-RATE.                                    12219000
122200                                                                  12220000
122210 P4390-CALL-FOR-RATE.                                             12221000
122220     MOVE INV-TERM TO RTE-TERM.                                   12222000
122230     MOVE INV-BALANCE TO RTE-AMOUNT.                              12223000
122240     CALL 'ADMS010' USING ADM-RATE-PARAMETERS.                    12224000
122250     IF GOOD-RETURN OF RETURN-STAT                                12225000
122260         MOVE RETURN-RATE TO INV-RATE                             12226000
122270         GO TO P4395-CHK-INV-RATE.                                12227000
122280     DISPLAY 'BAD RETURN FOR TYPE ' ADM-RTE-TYPE ' RATE REQUEST'  12228000
122290         UPON CONSOLE.                                            12229000
122300     DISPLAY 'ACCT NO = ' ACCOUNT-NUMBER UPON CONSOLE.            12230000
122310     DISPLAY 'INV PLAN = ' INV-PLAN UPON CONSOLE.                 12231000
122320     DISPLAY 'RETURN = ' RETURN-STAT UPON CONSOLE.                12232000
122330     GO TO P4399-EXIT.                                            12233000
122340                                                                  12234000
122350 P4395-CHK-INV-RATE.                                              12235000
122360     IF INV-RATE-FLOOR = ZEROS AND                                12236000
122370        INV-RATE-CEILING = ZEROS                                  12237000
122380         GO TO P4399-EXIT.                                        12238000
122390     MOVE INV-RATE TO HOLD-INV-RATE.                              12239000
122400     IF INV-NO-VARIANCE                                           12240000
122410         NEXT SENTENCE                                            12241000
122420       ELSE                                                       12242000
122430         IF INV-PLUS-VARIANCE                                     12243000
122440             ADD INV-RATE-VARIANCE TO HOLD-INV-RATE               12244000
122450           ELSE                                                   12245000
122460             SUBTRACT INV-RATE-VARIANCE FROM HOLD-INV-RATE.       12246000
122470     IF HOLD-INV-RATE LESS THAN INV-RATE-FLOOR                    12247000
122480         MOVE INV-RATE-FLOOR TO INV-RATE                          12248000
122490         MOVE 14 TO HOLD-REASON-CODE                              12249000
122500         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT             12250000
122510         GO TO P4399-EXIT.                                        12251000
122520     IF HOLD-INV-RATE GREATER THAN INV-RATE-CEILING               12252000
122530         MOVE INV-RATE-CEILING TO INV-RATE                        12253000
122540         MOVE 15 TO HOLD-REASON-CODE                              12254000
122550         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.            12255000
122560                                                                  12256000
122570 P4399-EXIT.                                                      12257000
122580     EXIT.                                                        12258000
122590                                                                  12259000
122600******************************************************************12260000
122610*       C H E C K   I N V E S T M E N T   A C T I V I T Y        *12261000
122620******************************************************************12262000
122630*P4400-CHECK-INV-ACTIVITY.                                        12263000
122640*    IF INV-CLOSED AND INV-CLOSED-CYC-STMT                        12264000
122650*        GO TO P4499-EXIT.                                        12265000
122660*    IF ACTIVITY-TDY = 0                                          12266000
122670*        GO TO P4499-EXIT.                                        12267000
122680*    IF INV-NOT-RENEW-RATE-CHNG-MAT OR                            12268000
122690*       INV-RENEW-RATE-CHNG-MAT                                   12269000
122700*        GO TO P4499-EXIT.                                        12270000
122710*    MOVE 1 TO INV-MAT-TDY.                                       12271000
122720*    IF TERM-REPO OR INTERBANK-TERM-REPO                          12272000
122730*        PERFORM P4100-POST-INV-INT THRU P4199-EXIT.              12273000
122740*    MOVE 05 TO HOLD-REASON-CODE.                                 12274000
122750*    PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                12275000
122760*    IF INV-RENEW-RATE-CHNG-ACT                                   12276000
122770*        PERFORM P4210-CHANGE-MATURITY THRU P4299-EXIT            12277000
122780*        GO TO P4499-EXIT.                                        12278000
122790*    IF INV-MATURE-DATE = ZERO                                    12279000
122800*        NEXT SENTENCE                                            12280000
122810*      ELSE                                                       12281000
122820*        MOVE 02 TO HOLD-REASON-CODE                              12282000
122830*        PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.            12283000
122840*    MOVE +001 TO INV-TERM.                                       12284000
122850*    MOVE ZEROS TO INV-MATURE-DATE.                               12285000
122860*    MOVE SPACE TO INV-RENEWAL-CODE.                              12286000
122870*                                                                 12287000
122880*P4499-EXIT.                                                      12288000
122890*    EXIT.                                                        12289000
122900                                                                  12290000
122910******************************************************************12291000
122920* A D J U S T   I N V E S T M E N T   P E G G E D  B A L A N C E *12292000
122930******************************************************************12293000
122940 P4500-ADJUST-INV-PEGGED-BAL.                                     12294000
122950     IF INV-CLOSED                                                12295000
122960         GO TO P4599-EXIT.                                        12296000
122970     IF INV-NO-ADJUSTMENT OR INV-USE-SHORT-BAL                    12297000
122980         GO TO P4599-EXIT.                                        12298000
122990     IF CYCLE-THIS-SC-EARN = 0                                    12299000
123000         GO TO P4599-EXIT.                                        12300000
123010     IF BCFSCR-EARN-RATE = ZERO                                   12301000
123020         GO TO P4580-NO-ADJUSTMENT.                               12302000
123030     MOVE BCFSCR-EARN-RATE  TO HOLD-PEG-EARN-RATE.                12303000
123040     MULTIPLY 12 BY HOLD-PEG-EARN-RATE.                           12304000
123050     IF ACCT-ANAL-BANK                                            12305000
123060         GO TO P4520-CALC-NEW-PEG-FOR-AA.                         12306000
123070                                                                  12307000
123080 P4510-CALC-NEW-INV-PEG.                                          12308000
123090     IF HOLD-PEG-SC-AMT = ZERO                                    12309000
123100         GO TO P4580-NO-ADJUSTMENT.                               12310000
123110     MULTIPLY HOLD-PEG-SC-AMT BY 12 GIVING HOLD-PEG-BAL-WK1.      12311000
123120     DIVIDE HOLD-PEG-BAL-WK1 BY HOLD-PEG-EARN-RATE                12312000
123130         GIVING HOLD-PEG-BAL-WK2 ROUNDED.                         12313000
123140     COMPUTE HOLD-PEG-BAL-WK1 ROUNDED =                           12314000
123150         HOLD-PEG-BAL-WK2 / (1 - FED-RESERVE-REQMNT).             12315000
123160     SUBTRACT HOLD-PEG-BAL-WK1 FROM AVG-COLL-BAL-CYC (1)          12316000
123170         GIVING HOLD-PEG-BAL-WK2.                                 12317000
123180     GO TO P4540-CONT-CALC.                                       12318000
123190                                                                  12319000
123200 P4520-CALC-NEW-PEG-FOR-AA.                                       12320000
123210     IF HIST-NOT-AVAILABLE (2)                                    12321000
123220         GO TO P4580-NO-ADJUSTMENT.                               12322000
123230     IF HIST-TOT-AA-CHRG-AMT (2) = ZERO                           12323000
123240         GO TO P4580-NO-ADJUSTMENT.                               12324000
123250     MOVE HIST-TOT-AA-CHRG-AMT (2) TO HOLD-PEG-SC-AMT.            12325000
123260     MULTIPLY HOLD-PEG-SC-AMT BY 12 GIVING HOLD-PEG-BAL-WK1.      12326000
123270     DIVIDE HOLD-PEG-BAL-WK1 BY HOLD-PEG-EARN-RATE                12327000
123280         GIVING HOLD-PEG-BAL-WK2 ROUNDED.                         12328000
123290     COMPUTE HOLD-PEG-BAL-WK1 ROUNDED =                           12329000
123300         HOLD-PEG-BAL-WK2 / (1 - FED-RESERVE-REQMNT).             12330000
123310     SUBTRACT HOLD-PEG-BAL-WK1 FROM AVG-COLL-BAL-CYC (2)          12331000
123320         GIVING HOLD-PEG-BAL-WK2.                                 12332000
123330                                                                  12333000
123340 P4540-CONT-CALC.                                                 12334000
123350     IF INV-PEGGED-BAL = ZERO                                     12335000
123360         IF HOLD-PEG-BAL-WK2 LESS THAN ZERO                       12336000
123370             NEXT SENTENCE                                        12337000
123380           ELSE                                                   12338000
123390             MOVE HOLD-PEG-BAL-WK2 TO HOLD-PEG-NEW                12339000
123400             GO TO P4560-CHECK-NEW-INV-PEG.                       12340000
123410     SUBTRACT HOLD-PEG-BAL-WK2 FROM INV-PEGGED-BAL                12341000
123420         GIVING HOLD-PEG-BAL-WK1.                                 12342000
123430     IF HOLD-PEG-BAL-WK1 LESS THAN ZERO                           12343000
123440         MOVE ZERO TO HOLD-PEG-BAL-WK1.                           12344000
123450     IF INV-PEG-BAL-ADJ-INCR = ZERO OR 00001                      12345000
123460         MOVE HOLD-PEG-BAL-WK1 TO HOLD-PEG-NEW                    12346000
123470         GO TO P4560-CHECK-NEW-INV-PEG.                           12347000
123480     COMPUTE HOLD-PEG-BAL-WK2 =                                   12348000
123490         HOLD-PEG-BAL-WK1 + (INV-PEG-BAL-ADJ-INCR / 2).           12349000
123500     DIVIDE HOLD-PEG-BAL-WK2 BY INV-PEG-BAL-ADJ-INCR              12350000
123510         GIVING HOLD-PEG-CNT.                                     12351000
123520     MULTIPLY HOLD-PEG-CNT BY INV-PEG-BAL-ADJ-INCR                12352000
123530         GIVING HOLD-PEG-NEW.                                     12353000
123540                                                                  12354000
123550 P4560-CHECK-NEW-INV-PEG.                                         12355000
123560     ADD INV-PEG-BAL-DIFFERENTIAL TO HOLD-PEG-NEW.                12356000
123570     IF HOLD-PEG-NEW LESS THAN ZERO                               12357000
123580         MOVE ZERO TO HOLD-PEG-NEW.                               12358000
123590     IF HOLD-PEG-NEW = INV-PEGGED-BAL                             12359000
123600         GO TO P4580-NO-ADJUSTMENT.                               12360000
123610     IF HOLD-PEG-NEW GREATER THAN INV-PEGGED-BAL                  12361000
123620         MOVE 11 TO HOLD-REASON-CODE                              12362000
123630       ELSE                                                       12363000
123640         MOVE 12 TO HOLD-REASON-CODE.                             12364000
123650     MOVE INV-PEGGED-BAL TO INV-PREV-PEGGED-BAL.                  12365000
123660     MOVE HOLD-PEG-NEW TO INV-PEGGED-BAL.                         12366000
123670     MOVE PROC-CURR-DATE TO INV-PEG-BAL-CHNG-DATE.                12367000
123680     PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                12368000
123690     PERFORM P8510-BUILD-PEG-ADJ-NTC THRU P8519-EXIT.             12369000
123700     GO TO P4599-EXIT.                                            12370000
123710                                                                  12371000
123720 P4580-NO-ADJUSTMENT.                                             12372000
123730     MOVE 13 TO HOLD-REASON-CODE.                                 12373000
123740     PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.                12374000
123750                                                                  12375000
123760 P4599-EXIT.                                                      12376000
123770     EXIT.                                                        12377000
123780                                                                  12378000
123790******************************************************************12379000
123800*  GET COLLATERAL ONLY FOR TERM REPOS                            *12380000
123810******************************************************************12381000
123820 P4600-GET-COLLAT-ONLY.                                           12382000
123830     IF INV-BALANCE = ZEROS                                       12383000
123840         GO TO P4699-EXIT.                                        12384000
123850     MOVE 'Y' TO INV-COLL-ONLY-IND.                               12385000
123860     MOVE ZEROS TO HOLD-RP-COLLAT-CNT                             12386000
123870                   HOLD-RP-DAILY-INT                              12387000
123880                   HOLD-RP-SECURE-AMT.                            12388000
123890     MOVE INV-BALANCE TO HOLD-RP-WORK-AMT                         12389000
123900                         HOLD-RP-AMT.                             12390000
123910     IF INV-COLLATERAL-FACTOR = +1.0000                           12391000
123920         MOVE HOLD-RP-AMT TO HOLD-RP-COLLAT-AMT                   12392000
123930       ELSE                                                       12393000
123940         MULTIPLY HOLD-RP-AMT BY INV-COLLATERAL-FACTOR            12394000
123950             GIVING HOLD-RP-COLLAT-AMT ROUNDED.                   12395000
123960     COMPUTE HOLD-RP-COLL-BAL =                                   12396000
123970         CURRENT-BALANCE +                                        12397000
123980         CASH-MANAGEMENT-BAL-IN-IMMA -                            12398000
123990         INSF-AMT -                                               12399000
124000         ONE-DAY-FLOAT-AMT -                                      12400000
124010         TWO-DAY-FLOAT-AMT -                                      12401000
124020         THREE-DAY-FLOAT-AMT -                                    12402000
124030         FOUR-DAY-FLOAT-AMT -                                     12403000
124040         FIVE-DAY-FLOAT-AMT.                                      12404000
124050     MOVE INV-PEGGED-BAL TO HOLD-INV-PEGGED-BAL.                  12405000
124060     MOVE ' ' TO HOLD-RP-DISP-IND.                                12406000
124070     PERFORM P3710-CHK-COLLAT-CODE THRU P3999-EXIT.               12407000
124080     MOVE 'N' TO INV-COLL-ONLY-IND.                               12408000
124090                                                                  12409000
124100 P4699-EXIT.                                                      12410000
124110     EXIT.                                                        12411000
124120                                                                  12412000
124130******************************************************************12413000
124140*  GET INV BALANCE FOR ICS SWEEP TRANSACTION                     *12414000
124150******************************************************************12415000
124160 P4700-ICS-SWEEP-PROCESS.                                         12416000
124170     INITIALIZE ICS-FA-TRAN-REC.                                  12417000
124180     IF INV-NORMAL                                                12418000
124190         NEXT SENTENCE                                            12419000
124200       ELSE                                                       12420000
124210         GO TO P4799-EXIT                                         12421000
124220     END-IF.                                                      12422000
124230     COMPUTE ICS-WORK-COLL-BAL =                                  12423000
124240         CURRENT-BALANCE +                                        12424000
124250         CASH-MANAGEMENT-BAL-IN-IMMA -                            12425000
124260         INSF-AMT -                                               12426000
124270         ONE-DAY-FLOAT-AMT -                                      12427000
124280         TWO-DAY-FLOAT-AMT -                                      12428000
124290         THREE-DAY-FLOAT-AMT -                                    12429000
124300         FOUR-DAY-FLOAT-AMT -                                     12430000
124310         FIVE-DAY-FLOAT-AMT.                                      12431000
124320     COMPUTE ICS-WORK-SWEEP-AMT =                                 12432000
124330         ICS-WORK-COLL-BAL -                                      12433000
124340         INV-PEGGED-BAL.                                          12434000
124350     IF ICS-WORK-SWEEP-AMT EQUAL ZEROS                            12435000
124360        GO TO P4799-EXIT                                          12436000
124370     END-IF.                                                      12437000
124380     IF ICS-WORK-SWEEP-AMT GREATER THAN ZEROS                     12438000
124390        MOVE ICS-WORK-SWEEP-AMT TO ICS-DEBIT-TX-AMT               12439000
124400        GO TO P4720-BUILD-ICS-DEBIT                               12440000
124410     ELSE                                                         12441000
124420        IF INV-BALANCE EQUAL ZEROS                                12442000
124430          GO TO P4799-EXIT                                        12443000
124440        ELSE                                                      12444000
124450          MULTIPLY ICS-WORK-SWEEP-AMT BY -1 GIVING                12445000
124460                                      ICS-CRED-TX-AMT             12446000
124470          IF ICS-CRED-TX-AMT GREATER THAN INV-BALANCE             12447000
124480             MOVE INV-BALANCE TO ICS-CRED-TX-AMT                  12448000
124490          END-IF                                                  12449000
124500        END-IF                                                    12450000
124510     END-IF.                                                      12451000
124520                                                                  12452000
124530 P4710-BUILD-ICS-CREDIT.                                          12453000
124540     MOVE 1 TO DSDSTXL-PENDING-SW.                                12454000
124550     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     12455000
124560                                                                  12456000
124570     MOVE 570 TO DSDSTXL-CODE.                                    12457000
124580     MOVE ICS-CRED-TX-AMT     TO DSDSTXL-AMOUNT.                  12458000
124590     ADD  DSDSTXL-AMOUNT      TO ICS-SWEEP-CREDITS                12459000
124600                                 GEN-CREDIT-AMT.                  12460000
124610     ADD 1 TO GEN-CREDIT-CNT.                                     12461000
124620     MOVE OSB-DESC-0102-A     TO DSDSTXL-CO-DESC.                 12462000
124630     MOVE OSB-DESC-0102-B     TO DSDSTXL-DESC.                    12463000
124640     MOVE 'ICS'               TO PJ-HOLD-CODE.                    12464000
124650     MOVE DEP-KEY             TO SAVE-CR-SORT-KEY.                12465000
124660     MOVE PROC-CURR-DATE      TO DSDSTXL-CHK-NO.                  12466000
124670     ADD 1                    TO NUM-CREDITS.                     12467000
124680     ADD 1                    TO NUM-BILL-TX.                     12468000
124690                                                                  12469000
124700     PERFORM P1325-NORM-CR-2.                                     12470000
124710                                                                  12471000
124720     PERFORM P7020-BUILD-DEPOSIT-LIST      THRU P7029-EXIT.       12472000
124730     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       12473000
124740                                                                  12474000
124750     MOVE PROC-BK-NO          TO ICS-FA-TRAN-BANK-NO.             12475000
124760     MOVE DSDS-ACCOUNT-NO     TO ICS-FA-TRAN-ACCT-NBR.            12476000
124770     MOVE PROC-CURR-DATE      TO ICS-FA-TRAN-DATE.                12477000
124780     MOVE 'W'                 TO ICS-FA-TRAN-TYPE.                12478000
124790     MOVE DSDS-ACCOUNT-NO     TO ICS-FA-ACCT-NBR.                 12479000
124800     MOVE ICS-CRED-TX-AMT     TO ICS-FA-TRAN-AMOUNT.              12480000
124810     SUBTRACT ICS-CRED-TX-AMT FROM INV-BALANCE.                   12481000
124820     WRITE ICS-FA-TRAN-FILE-OUT FROM ICS-FA-TRAN-REC.             12482000
124830                                                                  12483000
124840     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 12484000
124850     GO TO P4799-EXIT.                                            12485000
124860                                                                  12486000
124870 P4720-BUILD-ICS-DEBIT.                                           12487000
124880     MOVE 1 TO DSDSTXL-PENDING-SW.                                12488000
124890     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     12489000
124900                                                                  12490000
124910     MOVE 850 TO DSDSTXL-CODE.                                    12491000
124920     MOVE ICS-DEBIT-TX-AMT    TO DSDSTXL-AMOUNT.                  12492000
124930     ADD  DSDSTXL-AMOUNT      TO ICS-SWEEP-DEBITS                 12493000
124940                                 GEN-DEBIT-AMT.                   12494000
124950     ADD 1                    TO GEN-DEBIT-CNT.                   12495000
124960     ADD 1                    TO NUM-BILL-TX.                     12496000
124970     MOVE OSB-DESC-0103-A     TO DSDSTXL-CO-DESC.                 12497000
124980     MOVE OSB-DESC-0103-B     TO DSDSTXL-DESC.                    12498000
124990     MOVE 'ICS'               TO PJ-HOLD-CODE.                    12499000
125000     MOVE DEP-KEY             TO SAVE-CR-SORT-KEY.                12500000
125010     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                12501000
125020     MOVE PROC-CURR-DATE      TO DSDSTXL-CHK-NO.                  12502000
125030     ADD 1                    TO NUM-DEBITS.                      12503000
125040                                                                  12504000
125050     PERFORM P1665-NORM-DEBIT.                                    12505000
125060                                                                  12506000
125070     MOVE PROC-BK-NO          TO ICS-FA-TRAN-BANK-NO.             12507000
125080     MOVE DSDS-ACCOUNT-NO     TO ICS-FA-TRAN-ACCT-NBR.            12508000
125090     MOVE PROC-CURR-DATE      TO ICS-FA-TRAN-DATE.                12509000
125100     MOVE 'D'                 TO ICS-FA-TRAN-TYPE.                12510000
125110     MOVE DSDS-ACCOUNT-NO     TO ICS-FA-ACCT-NBR.                 12511000
125120     MOVE ICS-DEBIT-TX-AMT    TO ICS-FA-TRAN-AMOUNT.              12512000
125130     ADD  ICS-DEBIT-TX-AMT    TO INV-BALANCE.                     12513000
125140     WRITE ICS-FA-TRAN-FILE-OUT FROM ICS-FA-TRAN-REC.             12514000
125150                                                                  12515000
125160     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 12516000
125170                                                                  12517000
125180 P4799-EXIT.                                                      12518000
125190     EXIT.                                                        12519000
125200                                                                  12520000
125210******************************************************************12521000
125220*  A D J U S T   C A S H   M G M T   P E G G E D  B A L A N C E  *12522000
125230******************************************************************12523000
125240 P4900-ADJUST-CM-PEGGED-BAL.                                      12524000
125250     IF ADJUST-CASH-MGMT-PEG-BAL                                  12525000
125260         NEXT SENTENCE                                            12526000
125270       ELSE                                                       12527000
125280         GO TO P4999-EXIT.                                        12528000
125290     IF CYCLE-THIS-SC-EARN = 0                                    12529000
125300         GO TO P4999-EXIT.                                        12530000
125310     IF BCFSCR-EARN-RATE = ZERO                                   12531000
125320         GO TO P4980-NO-ADJUSTMENT.                               12532000
125330     MOVE BCFSCR-EARN-RATE TO HOLD-PEG-EARN-RATE.                 12533000
125340     MULTIPLY 12 BY HOLD-PEG-EARN-RATE.                           12534000
125350     IF ACCT-ANAL-BANK                                            12535000
125360         GO TO P4920-CALC-NEW-CM-PEG-FOR-AA.                      12536000
125370                                                                  12537000
125380 P4910-CALC-NEW-CM-PEG.                                           12538000
125390     IF HOLD-PEG-SC-AMT = ZERO                                    12539000
125400         GO TO P4980-NO-ADJUSTMENT.                               12540000
125410     MULTIPLY HOLD-PEG-SC-AMT BY 12 GIVING HOLD-PEG-BAL-WK1.      12541000
125420     DIVIDE HOLD-PEG-BAL-WK1 BY HOLD-PEG-EARN-RATE                12542000
125430         GIVING HOLD-PEG-BAL-WK2 ROUNDED.                         12543000
125440     COMPUTE HOLD-PEG-BAL-WK1 ROUNDED =                           12544000
125450         HOLD-PEG-BAL-WK2 / (1 - FED-RESERVE-REQMNT).             12545000
125460     SUBTRACT HOLD-PEG-BAL-WK1 FROM AVG-COLL-BAL-CYC (1)          12546000
125470         GIVING HOLD-PEG-BAL-WK2.                                 12547000
125480     GO TO P4940-CONT-CALC.                                       12548000
125490                                                                  12549000
125500 P4920-CALC-NEW-CM-PEG-FOR-AA.                                    12550000
125510     IF HIST-NOT-AVAILABLE (2)                                    12551000
125520         GO TO P4980-NO-ADJUSTMENT.                               12552000
125530     IF HIST-TOT-AA-CHRG-AMT (2) = ZERO                           12553000
125540         GO TO P4980-NO-ADJUSTMENT.                               12554000
125550     MOVE HIST-TOT-AA-CHRG-AMT (2) TO HOLD-PEG-SC-AMT.            12555000
125560     MULTIPLY HOLD-PEG-SC-AMT BY 12 GIVING HOLD-PEG-BAL-WK1.      12556000
125570     DIVIDE HOLD-PEG-BAL-WK1 BY HOLD-PEG-EARN-RATE                12557000
125580         GIVING HOLD-PEG-BAL-WK2 ROUNDED.                         12558000
125590     COMPUTE HOLD-PEG-BAL-WK1 ROUNDED =                           12559000
125600         HOLD-PEG-BAL-WK2 / (1 - FED-RESERVE-REQMNT).             12560000
125610     SUBTRACT HOLD-PEG-BAL-WK1 FROM AVG-COLL-BAL-CYC (2)          12561000
125620         GIVING HOLD-PEG-BAL-WK2.                                 12562000
125630                                                                  12563000
125640 P4940-CONT-CALC.                                                 12564000
125650     IF CASH-MANAGEMENT-PEGGED-BAL = ZERO                         12565000
125660         IF HOLD-PEG-BAL-WK2 LESS THAN ZERO                       12566000
125670             NEXT SENTENCE                                        12567000
125680           ELSE                                                   12568000
125690             MOVE HOLD-PEG-BAL-WK2 TO HOLD-PEG-NEW                12569000
125700             GO TO P4960-CHECK-NEW-CM-PEG.                        12570000
125710     SUBTRACT HOLD-PEG-BAL-WK2 FROM CASH-MANAGEMENT-PEGGED-BAL    12571000
125720         GIVING HOLD-PEG-BAL-WK1.                                 12572000
125730     IF HOLD-PEG-BAL-WK1 LESS THAN ZERO                           12573000
125740         MOVE ZERO TO HOLD-PEG-BAL-WK1.                           12574000
125750     IF CASH-MGMT-PEG-BAL-ADJ-INCR = ZERO OR 00001                12575000
125760         MOVE HOLD-PEG-BAL-WK1 TO HOLD-PEG-NEW                    12576000
125770         GO TO P4960-CHECK-NEW-CM-PEG.                            12577000
125780     COMPUTE HOLD-PEG-BAL-WK2 =                                   12578000
125790         HOLD-PEG-BAL-WK1 + (CASH-MGMT-PEG-BAL-ADJ-INCR / 2).     12579000
125800     DIVIDE HOLD-PEG-BAL-WK2 BY CASH-MGMT-PEG-BAL-ADJ-INCR        12580000
125810         GIVING HOLD-PEG-CNT.                                     12581000
125820     MULTIPLY HOLD-PEG-CNT BY CASH-MGMT-PEG-BAL-ADJ-INCR          12582000
125830         GIVING HOLD-PEG-NEW.                                     12583000
125840                                                                  12584000
125850 P4960-CHECK-NEW-CM-PEG.                                          12585000
125860     ADD CASH-MGMT-PEG-BAL-ADJ-DIFF TO HOLD-PEG-NEW.              12586000
125870     IF HOLD-PEG-NEW LESS THAN ZERO                               12587000
125880         MOVE ZERO TO HOLD-PEG-NEW.                               12588000
125890     IF HOLD-PEG-NEW = CASH-MANAGEMENT-PEGGED-BAL                 12589000
125900         GO TO P4980-NO-ADJUSTMENT.                               12590000
125910     IF HOLD-PEG-NEW GREATER THAN CASH-MANAGEMENT-PEGGED-BAL      12591000
125920         MOVE 01 TO HOLD-REASON-CODE                              12592000
125930       ELSE                                                       12593000
125940         MOVE 02 TO HOLD-REASON-CODE.                             12594000
125950     MOVE CASH-MANAGEMENT-PEGGED-BAL TO                           12595000
125960         CASH-MGMT-PREV-PEGGED-BAL.                               12596000
125970     MOVE HOLD-PEG-NEW TO CASH-MANAGEMENT-PEGGED-BAL.             12597000
125980     MOVE PROC-CURR-DATE TO CASH-MGMT-PEG-BAL-CHNG-DATE.          12598000
125990     PERFORM P7840-CM-EXCEPTIONS THRU P7849-EXIT.                 12599000
126000     GO TO P4999-EXIT.                                            12600000
126010                                                                  12601000
126020 P4980-NO-ADJUSTMENT.                                             12602000
126030     MOVE 03 TO HOLD-REASON-CODE.                                 12603000
126040     PERFORM P7840-CM-EXCEPTIONS THRU P7849-EXIT.                 12604000
126050                                                                  12605000
126060 P4999-EXIT.                                                      12606000
126070     EXIT.                                                        12607000
126080                                                                  12608000
126090******************************************************************12609000
126100*    P R O C E S S  U P D A T E D  M A S T E R  R E C O R D      *12610000
126110******************************************************************12611000
126120 P5000-UPDATE-MASTER.                                             12612000
126130     IF BANK-CTL-ACCTS                                            12613000
126140         NEXT SENTENCE                                            12614000
126150       ELSE                                                       12615000
126160         GO TO P5005-UP-MSTR2.                                    12616000
126170     IF ACTIVITY-TDY = 1                                          12617000
126180         MOVE DATE-LAST-CUST-ACT TO HOLD-OLD-CUST-ACT-DATE        12618000
126190         MOVE PROC-CURR-DATE     TO DATE-LAST-CUST-ACT            12619000
126200         MOVE DATE-LAST-CUST-ACT TO HOLD-NEW-CUST-ACT-DATE        12620000
126210         IF INACTIVE                                              12621000
126220             MOVE STAT-2X TO HOLD-OLD-STAT-2X                     12622000
126230             MOVE 010 TO STATUS-CODE                              12623000
126240             MOVE '01'    TO HOLD-NEW-STAT-2X                     12624000
126250             MOVE 'Y' TO HOLD-EXTRACT-IND                         12625000
126260             PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT    12626000
126270             PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.    12627000
126280     IF BANK-UNPOST-ITEMS                                         12628000
126290         IF ACCOUNT-NUMBER = UNPOST-ACCT-NO (SUB-ID)              12629000
126300             GO TO P5800-UNPOSTED-ITEMS-ACCOUNT.                  12630000
126310                                                                  12631000
126320 P5005-UP-MSTR2.                                                  12632000
126330     IF LIST-POST-SW = 1                                          12633000
126340         PERFORM P8680-END-OF-LIST THRU P8689-EXIT.               12634000
126350     IF BANK-CTL-ACCTS                                            12635000
126360         GO TO P5060-END-MSTR2.                                   12636000
126370     IF ACTIVITY-TDY = 1                                          12637000
126380         MOVE DATE-LAST-CUST-ACT TO HOLD-OLD-CUST-ACT-DATE        12638000
126390         MOVE PROC-CURR-DATE     TO DATE-LAST-CUST-ACT            12639000
126400         MOVE DATE-LAST-CUST-ACT TO HOLD-NEW-CUST-ACT-DATE        12640000
126410         IF INACTIVE                                              12641000
126420             MOVE STAT-2X TO HOLD-OLD-STAT-2X                     12642000
126430             MOVE 010 TO STATUS-CODE                              12643000
126440             MOVE '01'    TO HOLD-NEW-STAT-2X                     12644000
126450             MOVE 'Y' TO HOLD-EXTRACT-IND                         12645000
126460             PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT    12646000
126470             PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.    12647000
126480     IF NSF-PENDING                                               12648000
126490         PERFORM P8270-ADD-INSF-HOLD THRU P8279-EXIT.             12649000
126500     IF UNPOST-AMT GREATER THAN ZEROS                             12650000
126510         PERFORM P8260-ADD-UNPOST-HOLD THRU P8269-EXIT.           12651000
126520     IF HE-ADVANCE-TX-AMT NOT = ZERO                              12652000
126530         PERFORM P2710-BUILD-HELOC-ADVANCE THRU P2719-EXIT.       12653000
126540     IF HOLD-BR-CLSN-TIED NOT = ZERO                              12654000
126550         PERFORM P3480-CLSN-BR-PROCESSING THRU P3484-EXIT         12655000
126560     END-IF.                                                      12656000
126570     IF ODB-PLAN = SPACES                                         12657000
126580         GO TO P5010-NOT-ODB.                                     12658000
126590     IF ADVANCE-TX-AMT NOT = ZERO                                 12659000
126600         PERFORM P2650-BUILD-ADV-TX THRU P2700-EXIT.              12660000
126610     IF AMT-PAST-DUE GREATER THAN ZERO                            12661000
126620         MOVE 0 TO BYPASS-PAST-DUE                                12662000
126630         PERFORM P2750-TAKE-PAST-DUE-PMNT THRU P2790-EXIT.        12663000
126640     PERFORM P3400-ODB-PEGGED-BALANCE THRU P3430-EXIT.            12664000
126650                                                                  12665000
126660 P5010-NOT-ODB.                                                   12666000
126670     IF CURRENT-BALANCE NOT LESS THAN ZERO                        12667000
126680         GO TO P5045-CUR-BAL-NOT-MINUS.                           12668000
126690******************************************************************12669000
126700*    A C C O U N T  B A L A N C E  I S  O V E R D R A W N        *12670000
126710******************************************************************12671000
126720     IF WORK-OD-FEE      GREATER THAN 0                           12672000
126730         NEXT SENTENCE                                            12673000
126740       ELSE                                                       12674000
126750         GO TO P5023-BUILD-DAILY-OD-CHARGE.                       12675000
126760     IF OA-NSF-CNT GREATER THAN ZERO AND                          12676000
126770         E-ITEMS-NSF GREATER THAN ZERO                            12677000
126780         COMPUTE TEMP-I-CHG = E-ITEMS-NSF * WORK-OD-FEE           12678000
126790         PERFORM P5020-BUILD-OD-CHARGE THRU P5021-EXIT            12679000
126800         COMPUTE TEMP-I-CHG = OA-NSF-CNT * WORK-OD-FEE            12680000
126810         GO TO P5022-BUILD-OA-OD-CHARGE.                          12681000
126820                                                                  12682000
126830     IF OA-NSF-CNT GREATER THAN ZERO                              12683000
126840         COMPUTE TEMP-I-CHG = OA-NSF-CNT * WORK-OD-FEE            12684000
126850         GO TO P5022-BUILD-OA-OD-CHARGE.                          12685000
126860     IF IMM-FEE-PER-DAY                                           12686000
126870         MOVE WORK-OD-FEE      TO TEMP-I-CHG                      12687000
126880         PERFORM P5020-BUILD-OD-CHARGE THRU P5021-EXIT            12688000
126890         GO TO P5023-BUILD-DAILY-OD-CHARGE.                       12689000
126900     IF IMM-ITEM-CHG                                              12690000
126910         GO TO P5015-TIMES-OD-CHARGE.                             12691000
126920     IF E-ITEMS-NSF GREATER THAN ZERO                             12692000
126930         COMPUTE TEMP-I-CHG = E-ITEMS-NSF * WORK-OD-FEE           12693000
126940         PERFORM P5020-BUILD-OD-CHARGE THRU P5021-EXIT            12694000
126950         GO TO P5023-BUILD-DAILY-OD-CHARGE                        12695000
126960     END-IF.                                                      12696000
126970     GO TO P5023-BUILD-DAILY-OD-CHARGE.                           12697000
126980                                                                  12698000
126990 P5015-TIMES-OD-CHARGE.                                           12699000
127000     SUBTRACT NUM-FREE-OVERDRAFTS FROM INSF-CNT.                  12700000
127010     IF INSF-CNT GREATER THAN 0                                   12701000
127020         NEXT SENTENCE                                            12702000
127030       ELSE                                                       12703000
127040         GO TO P5023-BUILD-DAILY-OD-CHARGE.                       12704000
127050     COMPUTE TEMP-I-CHG =                                         12705000
127060         INSF-CNT * WORK-OD-FEE.                                  12706000
127070     PERFORM P5020-BUILD-OD-CHARGE THRU P5021-EXIT.               12707000
127080     GO TO P5023-BUILD-DAILY-OD-CHARGE.                           12708000
127090                                                                  12709000
127100******************************************************************12710000
127110*            B U I L D  O V E R D R A F T  C H A R G E           *12711000
127120******************************************************************12712000
127130 P5020-BUILD-OD-CHARGE.                                           12713000
127140                                                                  12714000
127150     MOVE 1 TO DSDSTXL-PENDING-SW.                                12715000
127160     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     12716000
127170     IF IMM-ITEM-CHG                                              12717000
127180         MOVE 792 TO DSDSTXL-CODE                                 12718000
127190         MOVE OSB-DESC-0028-A TO DSDSTXL-CO-DESC                  12719000
127200         MOVE OSB-DESC-0028-B TO DSDSTXL-DESC                     12720000
127210         MOVE 'NSF' TO PJ-HOLD-CODE                               12721000
127220       ELSE                                                       12722000
127230         MOVE 791 TO DSDSTXL-CODE                                 12723000
127240         MOVE OSB-DESC-0029-A TO DSDSTXL-CO-DESC                  12724000
127250         MOVE OSB-DESC-0029-B TO DSDSTXL-DESC                     12725000
127260         MOVE 'O-D' TO PJ-HOLD-CODE.                              12726000
127270     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                12727000
127280     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       12728000
127290     MOVE TEMP-I-CHG TO DSDSTXL-AMOUNT.                           12729000
127300     IF PERSONAL                                                  12730000
127310         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-RETAIL               12731000
127320       ELSE                                                       12732000
127330         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-COMMERCIAL.          12733000
127340     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT.                         12734000
127350     ADD 1 TO GEN-DEBIT-CNT.                                      12735000
127360     ADD 1 TO NUM-BILL-TX.                                        12736000
127370     PERFORM P1665-NORM-DEBIT.                                    12737000
127380     IF DSDSTXL-CODE = 791                                        12738000
127390         IF HSA-ACCT OR CESA-ACCT                                 12739000
127400             PERFORM P9150-SAC-DEBIT-PROCESSING THRU P9159-EXIT   12740000
127410         END-IF                                                   12741000
127420     END-IF.                                                      12742000
127430                                                                  12743000
127440     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 12744000
127450                                                                  12745000
127460 P5021-EXIT.                                                      12746000
127470     EXIT.                                                        12747000
127480                                                                  12748000
127490******************************************************************12749000
127500*      B U I L D   O A   O V E R D R A F T   C H A R G E         *12750000
127510******************************************************************12751000
127520 P5022-BUILD-OA-OD-CHARGE.                                        12752000
127530     MOVE 1 TO DSDSTXL-PENDING-SW.                                12753000
127540     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     12754000
127550     MOVE 791 TO DSDSTXL-CODE.                                    12755000
127560     MOVE OSB-DESC-0029-A TO DSDSTXL-CO-DESC.                     12756000
127570     MOVE OSB-DESC-0029-B TO DSDSTXL-DESC.                        12757000
127580     MOVE 'O-D' TO PJ-HOLD-CODE.                                  12758000
127590     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                12759000
127600     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       12760000
127610     MOVE TEMP-I-CHG TO DSDSTXL-AMOUNT.                           12761000
127620     IF PERSONAL                                                  12762000
127630         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-RETAIL-OA            12763000
127640       ELSE                                                       12764000
127650         ADD DSDSTXL-AMOUNT TO OVERDRAFT-FEE-COMMERCIAL-OA.       12765000
127660     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT.                         12766000
127670     ADD DSDSTXL-AMOUNT TO OD-ACCESS-FEES-IN-OD-BAL.              12767000
127680     ADD 1 TO GEN-DEBIT-CNT.                                      12768000
127690     ADD 1 TO NUM-BILL-TX.                                        12769000
127700     PERFORM P1665-NORM-DEBIT.                                    12770000
127710                                                                  12771000
127720     IF DSDSTXL-CODE = 791                                        12772000
127730         IF HSA-ACCT OR CESA-ACCT                                 12773000
127740             PERFORM P9150-SAC-DEBIT-PROCESSING THRU P9159-EXIT   12774000
127750         END-IF                                                   12775000
127760     END-IF.                                                      12776000
127770                                                                  12777000
127780     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 12778000
127790                                                                  12779000
127800******************************************************************12780000
127810* B U I L D   D A I L Y    O V E R D R A F T   C H A R G E       *12781000
127820******************************************************************12782000
127830 P5023-BUILD-DAILY-OD-CHARGE.                                     12783000
127840     IF BEG-BAL-PLUS                                              12784000
127850         GO TO P5025-CHK-BK-OD-TYPE.                              12785000
127860     IF CURRENT-BALANCE NEGATIVE                                  12786000
127870         CONTINUE                                                 12787000
127880       ELSE                                                       12788000
127890         GO TO P5025-CHK-BK-OD-TYPE.                              12789000
127900     IF DAILY-OD-FEE-AMT = ZEROS                                  12790000
127910         GO TO P5025-CHK-BK-OD-TYPE.                              12791000
127920     IF DTE-FIRST-OVERDRAWN = ZEROS                               12792000
127930         GO TO P5025-CHK-BK-OD-TYPE.                              12793000
127940     EVALUATE TRUE                                                12794000
127950        WHEN DAILY-OD-FEE-RETAIL                                  12795000
127960          IF PERSONAL                                             12796000
127970              CONTINUE                                            12797000
127980            ELSE                                                  12798000
127990              GO TO P5025-CHK-BK-OD-TYPE                          12799000
128000          END-IF                                                  12800000
128010        WHEN DAILY-OD-FEE-COMMERCIAL                              12801000
128020          IF PERSONAL                                             12802000
128030              GO TO P5025-CHK-BK-OD-TYPE                          12803000
128040          END-IF                                                  12804000
128050        WHEN DAILY-OD-FEE-BOTH                                    12805000
128060          CONTINUE                                                12806000
128070        WHEN NO-DAILY-OD-FEE                                      12807000
128080          GO TO P5025-CHK-BK-OD-TYPE                              12808000
128090     END-EVALUATE.                                                12809000
128100     IF DTE-FIRST-OVERDRAWN LESS THAN WORK-7DAYS-AGO              12810000
128110       OR DTE-FIRST-OVERDRAWN = WORK-7DAYS-AGO                    12811000
128120         CONTINUE                                                 12812000
128130       ELSE                                                       12813000
128140         GO TO P5025-CHK-BK-OD-TYPE.                              12814000
128150                                                                  12815000
128160     MOVE 1 TO DSDSTXL-PENDING-SW.                                12816000
128170     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     12817000
128180     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       12818000
128190     COMPUTE DSDSTXL-AMOUNT = DAILY-OD-FEE-AMT * WORK-DAYS-2-CHG. 12819000
128200     MOVE DSDSTXL-AMOUNT TO DAILY-OD-FEE.                         12820000
128210     MOVE 186 TO DSDSTXL-CODE.                                    12821000
128220     MOVE 186 TO HOLD-TX-CODE-IN.                                 12822000
128230     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                12823000
128240     PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.             12824000
128250     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 12825000
128260                                                                  12826000
128270 P5025-CHK-BK-OD-TYPE.                                            12827000
128280     IF POST-OD                                                   12828000
128290         GO TO P5035-POST-OD-MSTR.                                12829000
128300                                                                  12830000
128310 P5030-REJECT-OD-MSTR.                                            12831000
128320     ADD 1 TO NUM-DAYS-OD-MO.                                     12832000
128330     IF 460-710-SW = 1                                            12833000
128340         IF BEG-BAL-MINUS                                         12834000
128350             ADD 1 TO NUM-TIMES-OD-MO                             12835000
128360             GO TO P5048-CHK-OVERDRAFT-BANKING.                   12836000
128370     IF BEG-BAL-PLUS                                              12837000
128380         ADD 1 TO NUM-TIMES-OD-MO.                                12838000
128390     GO TO P5048-CHK-OVERDRAFT-BANKING.                           12839000
128400                                                                  12840000
128410 P5035-POST-OD-MSTR.                                              12841000
128420     IF TODAYS-DEBIT GREATER THAN 0                               12842000
128430         ADD 1 TO NUM-TIMES-OD-MO.                                12843000
128440     IF SUB-NUM-TMS-OD-SW = 1                                     12844000
128450         SUBTRACT 1 FROM NUM-TIMES-OD-MO.                         12845000
128460     IF THERE-WERE-NO-TXS-ON-THIS-ACCT                            12846000
128470         NEXT SENTENCE                                            12847000
128480       ELSE                                                       12848000
128490         GO TO P5040-CONT-POST-OD.                                12849000
128500     IF BEG-BAL-MINUS                                             12850000
128510         ADD PROC-PRE-DAYS  PROC-CURR-DAYS TO NUM-DAYS-OD-MO.     12851000
128520     GO TO P5048-CHK-OVERDRAFT-BANKING.                           12852000
128530                                                                  12853000
128540 P5040-CONT-POST-OD.                                              12854000
128550     IF 470-480-SW = 0                                            12855000
128560         IF BEG-BAL-MINUS                                         12856000
128570             ADD PROC-PRE-DAYS  PROC-CURR-DAYS TO NUM-DAYS-OD-MO  12857000
128580             GO TO P5048-CHK-OVERDRAFT-BANKING                    12858000
128590           ELSE                                                   12859000
128600             GO TO P5048-CHK-OVERDRAFT-BANKING.                   12860000
128610     IF ADD-TO-DAYS-OD-SW = 1                                     12861000
128620         ADD PROC-PRE-DAYS  PROC-CURR-DAYS TO NUM-DAYS-OD-MO.     12862000
128630     GO TO P5048-CHK-OVERDRAFT-BANKING.                           12863000
128640                                                                  12864000
128650 P5045-CUR-BAL-NOT-MINUS.                                         12865000
128660     IF IMM-ITEM-CHG                                              12866000
128670         SUBTRACT NUM-FREE-OVERDRAFTS FROM INSF-CNT               12867000
128680         IF INSF-CNT GREATER THAN ZERO                            12868000
128690             IF WORK-OD-FEE      GREATER THAN ZERO                12869000
128700                 COMPUTE TEMP-I-CHG =                             12870000
128710                     INSF-CNT * WORK-OD-FEE                       12871000
128720                 PERFORM P5020-BUILD-OD-CHARGE THRU P5021-EXIT    12872000
128730                 IF CURRENT-BALANCE NEGATIVE                      12873000
128740                     GO TO P5025-CHK-BK-OD-TYPE.                  12874000
128750                                                                  12875000
128760 P5048-CHK-OVERDRAFT-BANKING.                                     12876000
128770     IF ODB-PLAN = SPACES                                         12877000
128780         GO TO P5050-CHK-INVESTMENTS.                             12878000
128790     IF CYCLE-THIS-STMT = 1                                       12879000
128800         GO TO P5050-CHK-INVESTMENTS.                             12880000
128810     IF PAYOFF-DAILY-ALL OR                                       12881000
128820        PAYOFF-DAILY-PARTIAL                                      12882000
128830         PERFORM P3350-DAILY-ODB-PAYOFF THRU P3380-EXIT.          12883000
128840                                                                  12884000
128850 P5050-CHK-INVESTMENTS.                                           12885000
128860     IF INV-PLAN = SPACES                                         12886000
128870         GO TO P5060-END-MSTR2.                                   12887000
128880     IF INV-PLAN = 'IC'                                           12888000
128890         PERFORM P4700-ICS-SWEEP-PROCESS THRU P4799-EXIT          12889000
128900         GO TO P5060-END-MSTR2                                    12890000
128910     END-IF.                                                      12891000
128920     IF INV-MAT-TDY = 1                                           12892000
128930         GO TO P5055-INV-MATURED-TODAY.                           12893000
128940*    PERFORM P4400-CHECK-INV-ACTIVITY THRU P4499-EXIT.            12894000
128950*    IF INV-MAT-TDY = 1                                           12895000
128960*        GO TO P5055-INV-MATURED-TODAY.                           12896000
128970     IF TERM-REPO OR INTERBANK-TERM-REPO                          12897000
128980         PERFORM P4600-GET-COLLAT-ONLY THRU P4699-EXIT            12898000
128990         GO TO P5060-END-MSTR2.                                   12899000
129000     PERFORM P3600-PURCHASE-RP THRU P3999-EXIT.                   12900000
129010     GO TO P5060-END-MSTR2.                                       12901000
129020                                                                  12902000
129030 P5055-INV-MATURED-TODAY.                                         12903000
129040     PERFORM P4300-GET-INV-RATE THRU P4399-EXIT.                  12904000
129050     PERFORM P3600-PURCHASE-RP THRU P3999-EXIT.                   12905000
129060                                                                  12906000
129070 P5060-END-MSTR2.                                                 12907000
129080     IF CURRENT-BALANCE LESS THAN LOW-BALANCE-CYCLE               12908000
129090         IF 942-AMT = ZEROS                                       12909000
129100             MOVE CURRENT-BALANCE TO LOW-BALANCE-CYCLE            12910000
129110                                     LOW-BAL-TO-LOAD.             12911000
129120     IF CURRENT-BALANCE LESS THAN LOW-BALANCE-MONTH               12912000
129130         IF 942-AMT = ZEROS                                       12913000
129140             MOVE CURRENT-BALANCE TO LOW-BALANCE-MONTH            12914000
129150                                     HOLD-LOW-BAL-MTH.            12915000
129160     IF CURRENT-BALANCE GREATER THAN HIGH-BALANCE-CYCLE           12916000
129170         MOVE CURRENT-BALANCE     TO HIGH-BALANCE-CYCLE.          12917000
129180                                                                  12918000
129190     IF ACCUM-AMT-LAST-DEP GREATER THAN ZEROS                     12919000
129200         MOVE ACCUM-AMT-LAST-DEP TO AMT-LAST-DEPOSIT2             12920000
129210     END-IF.                                                      12921000
129220                                                                  12922000
129230 P5065-PREP-MSTR-CURR-DAY.                                        12923000
129240     MOVE ZEROS TO CURR-ACCR-CNTR                                 12924000
129250                   CURR-ACCR-CNTR-INV.                            12925000
129260     PERFORM P0530-CURR-ACCRUAL-ROUTINE THRU P0559-EXIT           12926000
129270         PROC-CURR-DAYS TIMES.                                    12927000
129280** ESCHEAT PROCESSING CHECKS                                      12928000
129290     IF ESCHEAT                                                   12929000
129300         IF TDY-MO  = MONTH-ESCHEAT-PROCESS                       12930000
129310           AND PROC-CYCLE-CODE (1) = 'Y'                          12931000
129320             PERFORM P9110-ESCHEAT-PROCESSING THRU P9119-EXIT.    12932000
129330                                                                  12933000
129340 P5070-CHECK-CYCLE-SWITCHES.                                      12934000
129350     IF PROC-MONTH-END                                            12935000
129360         IF BCFSCR-COMMERCIAL-PLUS-FDIC                           12936000
129370             PERFORM P5770-FDIC-CHRG-AVG-CURR-BAL THRU P5779-EXIT 12937000
129380         END-IF                                                   12938000
129390     END-IF.                                                      12939000
129400                                                                  12940000
129410     IF PROC-MONTH-END                                            12941000
129420       IF SAV-ACCOUNT                                             12942000
129430         IF CYCLE-THIS-STMT = 0                                   12943000
129440           IF CYCLE-THIS-SC-EARN = 0                              12944000
129450             EVALUATE TDY-MO                                      12945000
129460               WHEN 01                                            12946000
129470               WHEN 04                                            12947000
129480               WHEN 07                                            12948000
129490               WHEN 10                                            12949000
129500                 IF STMT-CYCLE-CODE = 32 OR 33                    12950000
129510                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12951000
129520                 END-IF                                           12952000
129530               WHEN 02                                            12953000
129540               WHEN 05                                            12954000
129550               WHEN 08                                            12955000
129560               WHEN 11                                            12956000
129570                 IF STMT-CYCLE-CODE = 31 OR 33                    12957000
129580                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12958000
129590                 END-IF                                           12959000
129600               WHEN 03                                            12960000
129610               WHEN 06                                            12961000
129620               WHEN 09                                            12962000
129630               WHEN 12                                            12963000
129640                 IF STMT-CYCLE-CODE = 31 OR 32                    12964000
129650                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12965000
129660                 END-IF                                           12966000
129670               WHEN OTHER                                         12967000
129680                 CONTINUE                                         12968000
129690             END-EVALUATE                                         12969000
129700           END-IF                                                 12970000
129710         END-IF                                                   12971000
129720       END-IF                                                     12972000
129730     END-IF.                                                      12973000
129740                                                                  12974000
129750     IF PROC-BUS-DAY-OF-MO = 11                                   12975000
129760       IF SAV-ACCOUNT                                             12976000
129770         IF CYCLE-THIS-STMT = 0                                   12977000
129780           IF CYCLE-THIS-SC-EARN = 0                              12978000
129790             EVALUATE TDY-MO                                      12979000
129800               WHEN 01                                            12980000
129810               WHEN 04                                            12981000
129820               WHEN 07                                            12982000
129830               WHEN 10                                            12983000
129840                 IF STMT-CYCLE-CODE = 42 OR 43                    12984000
129850                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12985000
129860                 END-IF                                           12986000
129870               WHEN 02                                            12987000
129880               WHEN 05                                            12988000
129890               WHEN 08                                            12989000
129900               WHEN 11                                            12990000
129910                 IF STMT-CYCLE-CODE = 41 OR 43                    12991000
129920                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12992000
129930                 END-IF                                           12993000
129940               WHEN 03                                            12994000
129950               WHEN 06                                            12995000
129960               WHEN 09                                            12996000
129970               WHEN 12                                            12997000
129980                 IF STMT-CYCLE-CODE = 41 OR 42                    12998000
129990                   PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT   12999000
130000                 END-IF                                           13000000
130010               WHEN OTHER                                         13001000
130020                 CONTINUE                                         13002000
130030             END-EVALUATE                                         13003000
130040           END-IF                                                 13004000
130050         END-IF                                                   13005000
130060       END-IF                                                     13006000
130070     END-IF.                                                      13007000
130080                                                                  13008000
130090     IF CYCLE-THIS-STMT = 1                                       13009000
130100         PERFORM P5400-CYCLE-STATEMENT THRU P5759-CYC-STMT-EXIT   13010000
130110         GO TO P5075-CYCLE-STMT-RETURN.                           13011000
130120     IF CYCLE-THIS-SC-EARN = 1                                    13012000
130130         PERFORM P5410-CYCLE-SC-EARN THRU P5739-CYC-SC-E-EXIT     13013000
130140         IF SC-CLOSED-SW = 1                                      13014000
130150             MOVE 0 TO SC-CLOSED-SW                               13015000
130160             PERFORM P5750-CK-AUTO-CLOSE THRU P5759-CYC-STMT-EXIT.13016000
130170     IF SPEC-SC-THIS-SPEC-CHKR = 1                                13017000
130180         PERFORM P5760-FEE-ACCT-STMT THRU P5769-EXIT.             13018000
130190     IF SC-HDR-SW = 1                                             13019000
130200         PERFORM P8830-BUILD-SC-TRAILER THRU P8839-EXIT.          13020000
130210     IF REQUEST-STMT = 1                                          13021000
130220         PERFORM P8340-CHECK-WHICH-STMT THRU P8349-EXIT           13022000
130230         PERFORM P0390-PREP-MSTR-CK-INV-CYC THRU P0394-EXIT       13023000
130240         PERFORM P9030-CHK-CMA THRU P9039-EXIT                    13024000
130250         PERFORM P8620-BUILD-PD-TRAILER THRU P8629-EXIT           13025000
130260         PERFORM P9020-BUILD-OSB-SUMMARY THRU P9029-EXIT          13026000
130270         IF STMT-WITH-CHECKS                                      13027000
130280             MOVE ZEROS TO NUM-ENCLOSURES                         13028000
130290         END-IF                                                   13029000
130300*        MOVE ZEROS TO NUM-ENCLOSURES                             13030000
130310         MOVE PROC-CURR-DATE TO DTE-LAST-SPEC-STMT                13031000
130320         MOVE CURRENT-BALANCE TO AMT-LAST-SPEC-STMT               13032000
130330         MOVE ODB-LOAN-BAL TO ODB-AMT-LAST-SPEC-STMT              13033000
130340         MOVE INV-BALANCE TO INV-AMT-LAST-SPEC-STMT.              13034000
130350     IF REQ-STMT-NO-ENCL = 1                                      13035000
130360         PERFORM P8340-CHECK-WHICH-STMT THRU P8349-EXIT           13036000
130370         PERFORM P0390-PREP-MSTR-CK-INV-CYC THRU P0394-EXIT       13037000
130380         PERFORM P9030-CHK-CMA THRU P9039-EXIT                    13038000
130390         PERFORM P8620-BUILD-PD-TRAILER THRU P8629-EXIT           13039000
130400         PERFORM P9020-BUILD-OSB-SUMMARY THRU P9029-EXIT.         13040000
130410                                                                  13041000
130420 P5073-CHK-LAST-STMT-DATE.                                        13042000
130430     MOVE ZEROS TO DAYS-11.                                       13043000
130440     IF CLOSED                                                    13044000
130450         GO TO P5075-CYCLE-STMT-RETURN.                           13045000
130460     IF DTE-LAST-CYCLE-STMT = ZEROS AND                           13046000
130470        DSDS-LAST-MAINT-DATE = ZEROS                              13047000
130480         GO TO P5075-CYCLE-STMT-RETURN.                           13048000
130490     IF STMT-CYCLE-CODE = 84                                      13049000
130500         GO TO P5075-CYCLE-STMT-RETURN                            13050000
130510     END-IF.                                                      13051000
130520     IF DTE-LAST-CYCLE-STMT = ZEROS                               13052000
130530         CALL 'CDCDT11' USING DSDS-LAST-MAINT-DATE                13053000
130540                              PROC-CURR-DATE                      13054000
130550                              DAYS-11                             13055000
130560       ELSE                                                       13056000
130570         CALL 'CDCDT11' USING DTE-LAST-CYCLE-STMT                 13057000
130580                              PROC-CURR-DATE                      13058000
130590                              DAYS-11.                            13059000
130600     IF DAYS-11 GREATER THAN 370                                  13060000
130610         MOVE SPACES TO STOCK-WORK                                13061000
130620*****************************   LAST STMT DATE OLDER THAN 1 YEAR *13062000
130630         MOVE 28 TO HOLD-REASON-CODE                              13063000
130640         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.        13064000
130650                                                                  13065000
130660 P5075-CYCLE-STMT-RETURN.                                         13066000
130670     PERFORM P0560-MEMO-ACCRUAL-ROUTINE THRU P0569-EXIT           13067000
130680         PROC-MEMO-DAYS TIMES.                                    13068000
130690     IF BEG-BAL-PLUS                                              13069000
130700         IF CURRENT-BALANCE NEGATIVE                              13070000
130710             MOVE PROC-CURR-DATE TO DTE-FIRST-OVERDRAWN           13071000
130720             GO TO P5080-CONT-UPDATE                              13072000
130730           ELSE                                                   13073000
130740             GO TO P5080-CONT-UPDATE.                             13074000
130750     IF CURRENT-BALANCE NOT NEGATIVE                              13075000
130760         MOVE PROC-CURR-DATE TO DTE-LAST-OVERDRAWN.               13076000
130770                                                                  13077000
130780 P5080-CONT-UPDATE.                                               13078000
130790     ADD INT-PAID-YTD TO YTD-INT-BY-IDENT (SUB-ID).               13079000
130800     IF ODB-PLAN = SPACES                                         13080000
130810         COMPUTE CURR-BAL-ELG-WITH =                              13081000
130820             CURR-NET-COLL-BAL - HOLD-ACCUM + WORK-OD-LIMIT       13082000
130830         GO TO P5085-BYPASS-HC.                                   13083000
130840     COMPUTE CURR-BAL-ELG-WITH =                                  13084000
130850         CURR-NET-COLL-BAL + AUTH-CREDIT-LIMIT - ODB-LOAN-BAL.    13085000
130860     PERFORM P3250-CHK-ODB-NOTICE THRU P3320-EXIT.                13086000
130870     IF CYCLE-THIS-HC = 1                                         13087000
130880         MOVE ODB-NEXT-REVIEW-DT TO ODB-REVIEW-DATE.              13088000
130890                                                                  13089000
130900 P5085-BYPASS-HC.                                                 13090000
130910     IF BANK-CTL-ACCTS                                            13091000
130920         MOVE CURR-NET-COLL-BAL TO CURR-BAL-ELG-WITH              13092000
130930         GO TO P5175-BANK-CTL-ACCTS.                              13093000
130940     IF OPENED                                                    13094000
130950         GO TO P5090-CHK-ACTIVE-DATE.                             13095000
130960     IF RESTRICTED-PCO AND PRIMARY-OFFICER = 'WEB'                13096000
130970         GO TO P5090-CHK-ACTIVE-DATE.                             13097000
130980     IF LOST-CONTACT                                              13098000
130990         GO TO P5094-LOST-CONTACT.                                13099000
131000     IF LOST-CONTACT-DATE > 0                                     13100000
131010         IF INACTIVE OR RESTRICTED OR RESTRICTED-PCO              13101000
131020             OR RESTRICTED-PDO OR COURT-RESTRICT OR               13102000
131030             RESTRICTED-ACH OR GARNISH-LEVY OR WATCHED            13103000
131040             OR WATCHED-ACH                                       13104000
131050             GO TO P5094-LOST-CONTACT                             13105000
131060         END-IF                                                   13106000
131070     END-IF.                                                      13107000
131080                                                                  13108000
131090     IF DECEASED                                                  13109000
131100         GO TO P5095-DECEASED.                                    13110000
131110     IF INACTIVE OR DORMANT OR ESCHEAT OR DORMANT-DECEASED OR     13111000
131120        RESTRICTED OR RESTRICTED-PCO OR RESTRICTED-PDO OR         13112000
131130        COURT-RESTRICT OR RESTRICTED-ACH OR GARNISH-LEVY          13113000
131140         GO TO P5105-UPDATE-STATUS-INDICATORS.                    13114000
131150     IF CLOSED                                                    13115000
131160         GO TO P5100-CLOSED-STATUS.                               13116000
131170                                                                  13117000
131180 P5090-CHK-ACTIVE-DATE.                                           13118000
131190     IF DATE-OPENED = ZEROS AND                                   13119000
131200        DATE-LAST-CUST-ACT = ZEROS                                13120000
131210         GO TO P5098-CHECK-STATUS-IND.                            13121000
131220     MOVE ZEROS TO MONTHS-12.                                     13122000
131230     IF DATE-LAST-CUST-ACT = ZEROS                                13123000
131240         CALL 'CDCDT12' USING DATE-OPENED                         13124000
131250                              PROC-CURR-DATE                      13125000
131260                              MONTHS-12                           13126000
131270       ELSE                                                       13127000
131280         CALL 'CDCDT12' USING DATE-LAST-CUST-ACT                  13128000
131290                              PROC-CURR-DATE                      13129000
131300                              MONTHS-12.                          13130000
131310     IF IMM-ACCOUNT                                               13131000
131320         IF MONTHS-12 LESS THAN NO-MO-INACT-STAT-IMM              13132000
131330             GO TO P5098-CHECK-STATUS-IND.                        13133000
131340     IF NOT IMM-ACCOUNT                                           13134000
131350         IF MONTHS-12 LESS THAN NO-MO-INACT-STAT                  13135000
131360             GO TO P5098-CHECK-STATUS-IND.                        13136000
131370                                                                  13137000
131380     IF CESA-ACCT OR HSA-ACCT                                     13138000
131390         MOVE DSDS-BANK-NO    TO DSSAC-BANK-NBR                   13139000
131400         MOVE DSDS-ACCOUNT-ID TO DSSAC-ACCT-ID                    13140000
131410         MOVE DSDS-ACCOUNT-NO TO DSSAC-ACCT-NBR                   13141000
131420         EXEC SQL                                                 13142000
131430             SELECT                                               13143000
131440                 CDH_EFFECTIVE_DATE                               13144000
131450             INTO                                                 13145000
131460                :CDH-EFFECTIVE-DATE                               13146000
131470             FROM DSDS.SACXREF                                    13147000
131480             JOIN CD.MASTER                                       13148000
131490               ON DSSAC_FA_BANK_NBR = CDMST_BANK_NBR              13149000
131500              AND DSSAC_FA_FILE_KEY = CDMST_ACCT_NBR              13150000
131510             JOIN CD.HISTORY                                      13151000
131520               ON CDMST_BANK_NBR = CDH_BANK_NBR                   13152000
131530              AND CDMST_ACCT_NBR = CDH_ACCT_NBR                   13153000
131540              AND CDH_TX_CODE IN (330,335,370,430,313,314,315,341,13154000
131550                                  342,343,362,363,366,367,380,381,13155000
131560                                  382,383,441,442,443)            13156000
131570              AND NOT(CDH_TX_CODE = 313                           13157000
131580                      AND CDH_WITHDRAW_CODE = 91)                 13158000
131590              AND CDH_TX_AMT > 0                                  13159000
131600             WHERE DSSAC_BANK_NBR = :DSSAC-BANK-NBR               13160000
131610               AND DSSAC_ACCT_ID  = :DSSAC-ACCT-ID                13161000
131620               AND DSSAC_ACCT_NBR = :DSSAC-ACCT-NBR               13162000
131630               AND DSSAC_FA_FILE_ID = 'IMMA'                      13163000
131640             ORDER BY CDH_EFFECTIVE_DATE DESC                     13164000
131650             FETCH FIRST 1 ROW ONLY                               13165000
131660         END-EXEC                                                 13166000
131670         EVALUATE SQLCODE                                         13167000
131680             WHEN ZEROS                                           13168000
131690                 CALL 'CDCDT46' USING CDH-EFFECTIVE-DATE          13169000
131700                                      CD-LST-ACT-DT-JUL           13170000
131710                 CALL 'CDCDT12' USING CD-LST-ACT-DT-JUL           13171000
131720                                      PROC-CURR-DATE              13172000
131730                                      MONTHS-12                   13173000
131740                 IF MONTHS-12 LESS THAN NO-MO-INACT-STAT          13174000
131750                     GO TO P5098-CHECK-STATUS-IND                 13175000
131760                 END-IF                                           13176000
131770             WHEN +100                                            13177000
131780                 CONTINUE                                         13178000
131790             WHEN OTHER                                           13179000
131800                 CALL 'CDCUT90' USING SQLCA                       13180000
131810                 CALL 'CDCDUMP' USING BY CONTENT '2058'           13181000
131820         END-EVALUATE                                             13182000
131830     END-IF.                                                      13183000
131840                                                                  13184000
131850     MOVE STAT-2X TO HOLD-OLD-STAT-2X                             13185000
131860     MOVE 031     TO STATUS-CODE.                                 13186000
131870     MOVE '03'    TO HOLD-NEW-STAT-2X                             13187000
131880     MOVE 'Y' TO HOLD-EXTRACT-IND.                                13188000
131890     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            13189000
131900                                                                  13190000
131910     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE.                 13191000
131920     PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT.           13192000
131930     GO TO P5105-UPDATE-STATUS-INDICATORS.                        13193000
131940                                                                  13194000
131950 P5094-LOST-CONTACT.                                              13195000
131960     IF CC-ACCOUNT                                                13196000
131970         GO TO P5098-CHECK-STATUS-IND.                            13197000
131980     IF DATE-OPENED = ZEROS AND                                   13198000
131990        DATE-LAST-CUST-ACT = ZEROS                                13199000
132000         GO TO P5098-CHECK-STATUS-IND.                            13200000
132010     MOVE ZEROS TO MONTHS-12.                                     13201000
132020     IF DATE-LAST-CUST-ACT = ZEROS                                13202000
132030         CALL 'CDCDT12' USING DATE-OPENED                         13203000
132040                              PROC-CURR-DATE                      13204000
132050                              MONTHS-12                           13205000
132060       ELSE                                                       13206000
132070         CALL 'CDCDT12' USING DATE-LAST-CUST-ACT                  13207000
132080                              PROC-CURR-DATE                      13208000
132090                              MONTHS-12.                          13209000
132100                                                                  13210000
132110     IF SAV-ACCOUNT                                               13211000
132120         IF STMT-CYCLE-CODE GREATER THAN ZEROS                    13212000
132130                       AND LESS THAN 31                           13213000
132140            OR STMT-CYCLE-CODE = 46                               13214000
132150             IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-1            13215000
132160                GO TO P5105-UPDATE-STATUS-INDICATORS              13216000
132170             END-IF                                               13217000
132180           ELSE                                                   13218000
132190             IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-2            13219000
132200                GO TO P5105-UPDATE-STATUS-INDICATORS              13220000
132210             END-IF                                               13221000
132220         END-IF                                                   13222000
132230       ELSE                                                       13223000
132240         IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-1                13224000
132250            GO TO P5105-UPDATE-STATUS-INDICATORS                  13225000
132260         END-IF                                                   13226000
132270     END-IF.                                                      13227000
132280                                                                  13228000
132290     IF STAT-2X EQUAL '07'                                        13229000
132300         CONTINUE                                                 13230000
132310     ELSE                                                         13231000
132320         MOVE DSDS-BANK-NO    TO ACCTR-BANK-NBR                   13232000
132330         IF DSDS-ACCOUNT-ID EQUAL 1                               13233000
132340             MOVE 'DDA'       TO ACCTR-FILE-ID                    13234000
132350         ELSE                                                     13235000
132360             MOVE 'SAV'       TO ACCTR-FILE-ID                    13236000
132370         END-IF                                                   13237000
132380         MOVE SPACES          TO CIF-XREF-KEY                     13238000
132390         MOVE DSDS-ACCOUNT-ID TO XKEY-DSDS-ACCT-ID                13239000
132400         MOVE DSDS-ACCOUNT-NO TO XKEY-DSDS-ACCT-NBR               13240000
132410         MOVE CIF-XREF-KEY    TO ACCTR-KEY                        13241000
132420         EXEC SQL                                                 13242000
132430             SELECT 1 INTO :WK-EXIST                              13243000
132440             FROM CIF.ACCTRMX                                     13244000
132450             WHERE ACCTR_BANK_NBR = :ACCTR-BANK-NBR               13245000
132460               AND ACCTR_FILE_ID  = :ACCTR-FILE-ID                13246000
132470               AND ACCTR_KEY      = :ACCTR-KEY                    13247000
132480               AND ACCTR_CODE     = 27                            13248000
132490         END-EXEC                                                 13249000
132500         EVALUATE SQLCODE                                         13250000
132510             WHEN ZEROS                                           13251000
132520                 CONTINUE                                         13252000
132530             WHEN +100                                            13253000
132540                 MOVE HIGH-VALUES     TO CIFU521-PARAMETERS       13254000
132550                 MOVE 99993           TO CIFU521-USERID           13255000
132560                 MOVE 'DSDS100'       TO CIFU521-SOURCE           13256000
132570                 MOVE 'BATCH'         TO CIFU521-TERMID           13257000
132580                 MOVE 'I'             TO CIFU521-FUNCTION         13258000
132590                 MOVE DSDS-BANK-NO    TO CIFU521-BANK-NBR         13259000
132600                 MOVE ACCTR-FILE-ID   TO CIFU521-FILE-ID          13260000
132610                 MOVE CIF-XREF-KEY    TO CIFU521-FILE-KEY         13261000
132620                 MOVE 1               TO CIFU521-TYPE             13262000
132630                 MOVE 27              TO CIFU521-CODE             13263000
132690                 MOVE SPACES          TO CIFU521-COMMENT1         13263104
132690                 MOVE SPACES          TO CIFU521-COMMENT2         13263204
132640                 STRING 'ACCOUNT STATUS WAS ' DELIMITED BY SIZE   13264000
132650                            STAT-2X           DELIMITED BY SIZE   13265000
132660                        ' AT THE TIME THE ACCOUNT WENT DORMANT.'  13266000
132670                                              DELIMITED BY SIZE   13267000
132680                                    INTO CIFU521-COMMENT1         13268000
132700                 CALL 'CIFU521B'   USING CIFU521-PARAMETERS       13270000
132710                 IF CIFU521-SQLCODE EQUAL CIFU521W-OK             13271000
132720                     CONTINUE                                     13272000
132730                 ELSE                                             13273000
132740                     DISPLAY 'CDCERROR - DSDS100 - '              13274000
132750                         CIFU521-ERROR-TEXT                       13275000
132760                 END-IF                                           13276000
132770             WHEN OTHER                                           13277000
132780                 CONTINUE                                         13278000
132790         END-EVALUATE                                             13279000
132800     END-IF.                                                      13280000
132810                                                                  13281000
132820     MOVE STAT-2X         TO HOLD-OLD-STAT-2X.                    13282000
132830     MOVE 021             TO STATUS-CODE.                         13283000
132840     MOVE '02'            TO HOLD-NEW-STAT-2X.                    13284000
132850     MOVE PROC-CURR-DATE     TO DORMANT-DATE.                     13285000
132860     MOVE 'Y' TO HOLD-EXTRACT-IND.                                13286000
132870     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            13287000
132880     IF STMT-CYCLE-CODE = 46                                      13288000
132890         NEXT SENTENCE                                            13289000
132900       ELSE                                                       13290000
132910         MOVE STMT-CYCLE-CODE    TO HOLD-OLD-STMT-CYCLE           13291000
132920         MOVE 84                 TO STMT-CYCLE-CODE               13292000
132930         MOVE 84                 TO HOLD-NEW-STMT-CYCLE           13293000
132940         MOVE SC-EARN-CYCLE-CODE TO HOLD-OLD-SC-EARN-CYC          13294000
132950         MOVE 22                 TO SC-EARN-CYCLE-CODE            13295000
132960         MOVE 22                 TO HOLD-NEW-SC-EARN-CYC          13296000
132970         MOVE 'Y' TO HOLD-EXTRACT-IND                             13297000
132980         PERFORM P8486-STMT-CYCLE-CODE-CHANGE THRU P8486-EXIT     13298000
132990         PERFORM P8487-SC-EARN-CYC-CODE-CHANGE THRU P8487-EXIT.   13299000
133000     IF OA-ACTIVE-30-90 OR                                        13300000
133010        OA-ACTIVE-FIXED OR                                        13301000
133020        OA-ACTIVE                                                 13302000
133030         MOVE 90 TO OD-ACCESS-CODE                                13303000
133040         MOVE 'Y' TO HOLD-EXTRACT-IND                             13304000
133050         PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT        13305000
133060         MOVE ZEROS TO OD-ACCESS-LIMIT                            13306000
133070         MOVE 'Y' TO HOLD-EXTRACT-IND                             13307000
133080         PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.       13308000
133090     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE.                 13309000
133100     PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT.           13310000
133110     GO TO P5105-UPDATE-STATUS-INDICATORS.                        13311000
133120                                                                  13312000
133130 P5095-DECEASED.                                                  13313000
133140     IF CC-ACCOUNT                                                13314000
133150         GO TO P5098-CHECK-STATUS-IND.                            13315000
133160     IF DATE-OPENED = ZEROS AND                                   13316000
133170        DATE-LAST-CUST-ACT = ZEROS AND                            13317000
133180        LOST-CONTACT-DATE = ZEROS                                 13318000
133190         GO TO P5098-CHECK-STATUS-IND.                            13319000
133200                                                                  13320000
133210     IF LOST-CONTACT-DATE = ZEROS                                 13321000
133220         GO TO P5098-CHECK-STATUS-IND.                            13322000
133230                                                                  13323000
133240     MOVE ZEROS TO MONTHS-12.                                     13324000
133250     IF DATE-LAST-CUST-ACT = ZEROS                                13325000
133260         CALL 'CDCDT12' USING DATE-OPENED                         13326000
133270                              PROC-CURR-DATE                      13327000
133280                              MONTHS-12                           13328000
133290       ELSE                                                       13329000
133300         CALL 'CDCDT12' USING DATE-LAST-CUST-ACT                  13330000
133310                              PROC-CURR-DATE                      13331000
133320                              MONTHS-12.                          13332000
133330     IF SAV-ACCOUNT                                               13333000
133340         IF STMT-CYCLE-CODE GREATER THAN ZEROS                    13334000
133350                       AND LESS THAN 31                           13335000
133360            OR STMT-CYCLE-CODE = 46                               13336000
133370             IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-1            13337000
133380                GO TO P5105-UPDATE-STATUS-INDICATORS              13338000
133390             END-IF                                               13339000
133400           ELSE                                                   13340000
133410             IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-2            13341000
133420                GO TO P5105-UPDATE-STATUS-INDICATORS              13342000
133430             END-IF                                               13343000
133440         END-IF                                                   13344000
133450       ELSE                                                       13345000
133460         IF MONTHS-12 LESS THAN NO-MONTH-DORMANT-1                13346000
133470            GO TO P5105-UPDATE-STATUS-INDICATORS                  13347000
133480         END-IF                                                   13348000
133490     END-IF.                                                      13349000
133500                                                                  13350000
133510     MOVE STAT-2X         TO HOLD-OLD-STAT-2X.                    13351000
133520     MOVE 161             TO STATUS-CODE.                         13352000
133530     MOVE '16'            TO HOLD-NEW-STAT-2X.                    13353000
133540     MOVE PROC-CURR-DATE     TO DORMANT-DATE.                     13354000
133550     MOVE 'Y' TO HOLD-EXTRACT-IND.                                13355000
133560     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            13356000
133570                                                                  13357000
133580     IF STMT-CYCLE-CODE = 46                                      13358000
133590         NEXT SENTENCE                                            13359000
133600       ELSE                                                       13360000
133610         MOVE STMT-CYCLE-CODE    TO HOLD-OLD-STMT-CYCLE           13361000
133620         MOVE 84                 TO STMT-CYCLE-CODE               13362000
133630         MOVE 84                 TO HOLD-NEW-STMT-CYCLE           13363000
133640         MOVE SC-EARN-CYCLE-CODE TO HOLD-OLD-SC-EARN-CYC          13364000
133650         MOVE 22                 TO SC-EARN-CYCLE-CODE            13365000
133660         MOVE 22                 TO HOLD-NEW-SC-EARN-CYC          13366000
133670         MOVE 'Y' TO HOLD-EXTRACT-IND                             13367000
133680         PERFORM P8486-STMT-CYCLE-CODE-CHANGE THRU P8486-EXIT     13368000
133690         PERFORM P8487-SC-EARN-CYC-CODE-CHANGE THRU P8487-EXIT.   13369000
133700     IF OA-ACTIVE-30-90 OR                                        13370000
133710        OA-ACTIVE-FIXED OR                                        13371000
133720        OA-ACTIVE                                                 13372000
133730         MOVE 90 TO OD-ACCESS-CODE                                13373000
133740         MOVE 'Y' TO HOLD-EXTRACT-IND                             13374000
133750         PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT        13375000
133760         MOVE ZEROS TO OD-ACCESS-LIMIT                            13376000
133770         MOVE 'Y' TO HOLD-EXTRACT-IND                             13377000
133780         PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.       13378000
133790     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE.                 13379000
133800     PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT.           13380000
133810     GO TO P5105-UPDATE-STATUS-INDICATORS.                        13381000
133820                                                                  13382000
133830 P5098-CHECK-STATUS-IND.                                          13383000
133840     IF OPENED                                                    13384000
133850         IF STAT-1X NOT = '0'                                     13385000
133860             IF STAT-1X NOT = '9'                                 13386000
133870                 PERFORM P7100-BUILD-NEW-ACCT THRU P7109-EXIT.    13387000
133880                                                                  13388000
133890*** THIS IS TO GET THE ACCOUNTS OPENED ON THE WEB                 13389000
133900     IF RESTRICTED-PCO AND PRIMARY-OFFICER = 'WEB'                13390000
133910         IF STAT-1X NOT = '0'                                     13391000
133920             IF STAT-1X NOT = '9'                                 13392000
133930                 PERFORM P7100-BUILD-NEW-ACCT THRU P7109-EXIT.    13393000
133940                                                                  13394000
133950     GO TO P5105-UPDATE-STATUS-INDICATORS.                        13395000
133960                                                                  13396000
133970 P5100-CLOSED-STATUS.                                             13397000
133980     PERFORM P7090-BUILD-CLOSED-ACCTS THRU P7099-EXIT.            13398000
133990     IF TODAY                                                     13399000
134000         PERFORM P8280-DELETE-HOLDS THRU P8289-EXIT.              13400000
134010                                                                  13401000
134020 P5105-UPDATE-STATUS-INDICATORS.                                  13402000
134030     IF REGULAR                                                   13403000
134040         GO TO P5125-CHK-SIG-BAL-CHNG.                            13404000
134050     IF PROC-FRIDAY                                               13405000
134060         IF TODAY OR THIS-WEEK                                    13406000
134070             MOVE '3' TO STAT-1X.                                 13407000
134080                                                                  13408000
134090 P5110-UPDATE-WHERE-TO.                                           13409000
134100     IF END-OF-PERIOD                                             13410000
134110         GO TO P5115-UPDATE-CHK-PERIOD.                           13411000
134120     GO TO P5125-CHK-SIG-BAL-CHNG.                                13412000
134130                                                                  13413000
134140 P5115-UPDATE-CHK-PERIOD.                                         13414000
134150     IF PROC-MONTH-END                                            13415000
134160         IF TODAY OR THIS-WEEK OR THIS-MONTH                      13416000
134170             MOVE '4' TO STAT-1X.                                 13417000
134180     IF PROC-QTR-END                                              13418000
134190         IF THIS-QUARTER                                          13419000
134200             MOVE '5' TO STAT-1X.                                 13420000
134210     IF PROC-YEAR-END                                             13421000
134220         IF THIS-YEAR                                             13422000
134230             MOVE '0' TO STAT-1X.                                 13423000
134240                                                                  13424000
134250 P5125-CHK-SIG-BAL-CHNG.                                          13425000
134260     IF CYCLE-THIS-STMT = 0                                       13426000
134270         GO TO P5145-CHK-BELOW-MIN.                               13427000
134280     IF OPENED                                                    13428000
134290         IF THIS-MONTH                                            13429000
134300             GO TO P5145-CHK-BELOW-MIN.                           13430000
134310     IF GROSS-CURR-BAL-MNTH = ZERO                                13431000
134320         GO TO P5145-CHK-BELOW-MIN.                               13432000
134330     IF DAYS-IN-CAL-MONTH = ZERO                                  13433000
134340         GO TO P5145-CHK-BELOW-MIN.                               13434000
134350     DIVIDE GROSS-CURR-BAL-MNTH BY DAYS-IN-CAL-MONTH              13435000
134360         GIVING HOLD-AVERAGE.                                     13436000
134370     IF HOLD-AVERAGE LESS    THAN SIG-BAL-CHNG-AMT (SUB-ID)       13437000
134380         GO TO P5145-CHK-BELOW-MIN.                               13438000
134390     IF AVG-CURR-BAL-MO (2) NOT NUMERIC                           13439000
134400         GO TO P5145-CHK-BELOW-MIN.                               13440000
134410     SUBTRACT HOLD-AVERAGE FROM AVG-CURR-BAL-MO (2)               13441000
134420         GIVING HOLD-FLOAT.                                       13442000
134430     IF HOLD-FLOAT   NOT GREATER THAN ZERO                        13443000
134440         SUBTRACT HOLD-FLOAT FROM ZERO GIVING HOLD-FLOAT.         13444000
134450     MULTIPLY HOLD-AVERAGE BY SIG-BAL-CHNG-PCT (SUB-ID)           13445000
134460         GIVING HOLD-AVERAGE.                                     13446000
134470     IF HOLD-FLOAT GREATER THAN HOLD-AVERAGE                      13447000
134480         MOVE 09 TO HOLD-REASON-CODE                              13448000
134490         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.        13449000
134500                                                                  13450000
134510 P5145-CHK-BELOW-MIN.                                             13451000
134520     IF ACCOUNT-ID GREATER THAN 003                               13452000
134530       IF CURRENT-BALANCE LESS THAN MIN-BALANCE-PRIME-INT (SUB18) 13453000
134540           IF CLOSED                                              13454000
134550               NEXT SENTENCE                                      13455000
134560             ELSE                                                 13456000
134570               MOVE 07 TO HOLD-REASON-CODE                        13457000
134580               PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.  13458000
134590                                                                  13459000
134600 P5150-CHK-FOR-KITES.                                             13460000
134610     IF PUBLIC-FUND OR CORRESP-BANK                               13461000
134620         GO TO P5160-CHK-ODB-RPTS.                                13462000
134630     IF ZERO-BAL-ACCT-IND = 'Y'                                   13463000
134640         GO TO P5160-CHK-ODB-RPTS.                                13464000
134650     IF INV-PLAN = SPACES OR 'IC'                                 13465000
134660         NEXT SENTENCE                                            13466000
134670       ELSE                                                       13467000
134680         IF INV-NORMAL                                            13468000
134690             GO TO P5160-CHK-ODB-RPTS.                            13469000
134700     IF DEPOSITS-TDY = ZERO                                       13470000
134710         GO TO P5155-CHK-NEG-NET.                                 13471000
134720     SUBTRACT ADVANCES-TDY FROM DEPOSITS-TDY GIVING DEP-LESS-ADV. 13472000
134730     IF CURRENT-BALANCE IS LESS THAN DEP-LESS-ADV AND             13473000
134740        PAYMENT-AT-CYCLE                                          13474000
134750         ADD 001 TO NUM-KITES                                     13475000
134760         ADD 1 TO UNCOLL-WITHD-MO.                                13476000
134770     IF AMT-CREDITS LESS THAN +1000.00                            13477000
134780         GO TO P5155-CHK-NEG-NET.                                 13478000
134790     IF NUM-KITES NOT LESS THAN MAX-KITE-SUSP-NUM                 13479000
134800         IF CASH-MGT-ACCT-IND = 'Y'                               13480000
134810             MOVE 'C' TO KITE-IND                                 13481000
134820             PERFORM P7030-BUILD-KITE-SUSPECT THRU P7039-EXIT     13482000
134830             GO TO P5160-CHK-ODB-RPTS                             13483000
134840           ELSE                                                   13484000
134850             MOVE 'K' TO KITE-IND                                 13485000
134860             PERFORM P7030-BUILD-KITE-SUSPECT THRU P7039-EXIT     13486000
134870             GO TO P5160-CHK-ODB-RPTS.                            13487000
134880                                                                  13488000
134890 P5155-CHK-NEG-NET.                                               13489000
134900     IF CURRENT-BALANCE LESS THAN ZERO                            13490000
134910         GO TO P5160-CHK-ODB-RPTS.                                13491000
134920     IF CURR-NET-COLL-BAL LESS THAN -99.99                        13492000
134930         MOVE 'N' TO KITE-IND                                     13493000
134940         PERFORM P7030-BUILD-KITE-SUSPECT THRU P7039-EXIT         13494000
134950         MOVE 'K' TO KITE-IND.                                    13495000
134960                                                                  13496000
134970 P5160-CHK-ODB-RPTS.                                              13497000
134980     IF ODB-PLAN = SPACES                                         13498000
134990         GO TO P5165-CHK-INV-RPTS.                                13499000
135000     PERFORM P7130-ODB-TRIAL-BALANCE THRU P7139-EXIT.             13500000
135010     IF NOT PROC-YEAR-END                                         13501000
135020         PERFORM P7710-BUILD-ODB-INT-YTD THRU P7719-EXIT.         13502000
135030     IF AMT-PAST-DUE NOT EQUAL ZERO AND                           13503000
135040        NUM-DAYS-DELQ GREATER THAN 014                            13504000
135050         MOVE 03 TO HOLD-REASON-CODE                              13505000
135060         PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT.        13506000
135070     IF AMT-PAST-DUE NOT EQUAL ZERO                               13507000
135080         PERFORM P7330-BUILD-AGING-ACCTS THRU P7339-EXIT.         13508000
135090     IF PROC-MONTH-END                                            13509000
135100         IF ODB-LOAN-BAL = ZEROS AND                              13510000
135110            AUTH-CREDIT-LIMIT = ZEROS                             13511000
135120             MOVE 04 TO HOLD-REASON-CODE                          13512000
135130             PERFORM P7140-BUILD-CUTOFF-ACCTS THRU P7149-EXIT.    13513000
135140     PERFORM P7670-ODB-CR-LIFE-RPT THRU P7679-EXIT.               13514000
135150     PERFORM P7600-ODB-MONTHLY-PL-RPT THRU P7609-EXIT.            13515000
135160     IF ODB-FIX-PYMT-AND-I                                        13516000
135170         IF ODB-FIXED-PYMT-AMT = ZERO                             13517000
135180             MOVE 29 TO HOLD-REASON-CODE                          13518000
135190             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.    13519000
135200     IF ODB-FIX-PC-PYMT-AND-I                                     13520000
135210         IF ODB-FIXED-PYMT-PC = ZERO                              13521000
135220             MOVE 30 TO HOLD-REASON-CODE                          13522000
135230             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.    13523000
135240     IF SECURITIES-LINE                                           13524000
135250         PERFORM P8520-BUILD-ADDTNL-MARGIN-NTC THRU P8529-EXIT.   13525000
135260     PERFORM P7370-ODB-MATURITY-LIST THRU P7379-EXIT.             13526000
135270                                                                  13527000
135280 P5165-CHK-INV-RPTS.                                              13528000
135290     IF INV-PLAN = SPACES OR 'IC'                                 13529000
135300         GO TO P5170-CHK-OTHER-RPTS.                              13530000
135310     PERFORM P4500-ADJUST-INV-PEGGED-BAL THRU P4599-EXIT.         13531000
135320     PERFORM P7280-RP-TRIAL-BALANCE THRU P7289-EXIT               13532000
135330     PERFORM P7290-MANAGE-RPT THRU P7299-EXIT.                    13533000
135340     PERFORM P7300-RP-NEW-ACCOUNTS THRU P7309-EXIT.               13534000
135350     PERFORM P7310-RP-CLOSED-ACCOUNTS THRU P7319-EXIT.            13535000
135360     IF INV-TARGET-BALANCE GREATER THAN ZERO                      13536000
135370         PERFORM P8530-CHK-TARGET-BALANCE THRU P8539-EXIT.        13537000
135380                                                                  13538000
135390 P5170-CHK-OTHER-RPTS.                                            13539000
135400     PERFORM P7010-BUILD-TRIAL-BALANCE THRU P7019-EXIT.           13540000
135410     IF DORMANT OR INACTIVE OR LOST-CONTACT OR DORMANT-DECEASED   13541000
135420         PERFORM P7112-DI-CHECK-32 THRU P7119-EXIT.               13542000
135430     PERFORM P8290-LIST-HOLDS THRU P8299-EXIT.                    13543000
135440     IF CORPORATION OR NOT-FOR-PROFIT-CORP                        13544000
135450         PERFORM P7440-BUILD-CORP-ACCTS THRU P7449-EXIT.          13545000
135460     IF RELATED-ACCT-CODE GREATER THAN ZERO                       13546000
135470         PERFORM P7430-BUILD-REL-SC-JRNL THRU P7439-EXIT.         13547000
135480     PERFORM P7450-BUILD-LARGE-AVG-BAL THRU P7459-EXIT.           13548000
135490     PERFORM P7470-BUILD-SUMMARY-OF-ACCTS THRU P7489-EXIT.        13549000
135500     IF CURRENT-BALANCE LESS THAN ZERO                            13550000
135510         PERFORM P7050-BUILD-OVERDRAWN-ACCTS THRU P7059-EXIT      13551000
135520         PERFORM P8760-BUILD-OD-ACCTS-FILE THRU P8769-EXIT.       13552000
135530     PERFORM P7650-MONTHLY-OVERDRAFTS THRU P7659-EXIT.            13553000
135540*    IF MT-16-SW = 1                                              13554000
135550*        MOVE 0 TO MT-16-SW                                       13555000
135560*        MOVE 16 TO HOLD-REASON-CODE                              13556000
135570*        PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.        13557000
135580     PERFORM P7390-CHECK-COMM-SUSPECT THRU P7399-EXIT.            13558000
135590     IF INSF-NOTICE-SW = 1                                        13559000
135600         PERFORM P8380-BUILD-NSF-REC THRU P8382-EXIT              13560000
135610         MOVE 003 TO IN-CONTINUATION                              13561000
135620         PERFORM P8385-WRITE-NSF THRU P8389-BUILD-NSF-EXIT        13562000
135630         MOVE 0 TO INSF-NOTICE-SW.                                13563000
135640     PERFORM P7460-BUILD-NEG-NET THRU P7469-EXIT.                 13564000
135650     IF WATCHED OR WATCHED-ACH                                    13565000
135660         MOVE ' ' TO HOLD-WA-TX-DISP                              13566000
135670         PERFORM P7250-BUILD-WATCHED-ACCT THRU P7259-EXIT.        13567000
135680     PERFORM P7630-ZERO-BALANCE-LIST THRU P7639-EXIT.             13568000
135690     PERFORM P7660-GROWTH-SAV-EXCPTS THRU P7669-EXIT.             13569000
135700     PERFORM P7720-AR-ACCOUNT-LIST THRU P7729-EXIT.               13570000
135710     PERFORM P8450-BUILD-NSF-FILE-2 THRU P8459-EXIT.              13571000
135720     IF BAI-ACCOUNT                                               13572000
135730         PERFORM P8710-BUILD-BAI-ACCT-SUMMARY THRU P8719-EXIT.    13573000
135740     IF DDA-ACCOUNT OR NOW-ACCOUNT OR CMM-ACCOUNT                 13574000
135750         PERFORM P8740-WRITE-SHADOW-ACCT THRU P8749-EXIT.         13575000
135760     PERFORM P7580-100K-AND-OVER THRU P7589-EXIT.                 13576000
135770     PERFORM P4900-ADJUST-CM-PEGGED-BAL THRU P4999-EXIT.          13577000
135780     IF DO-ACCT-RECON                                             13578000
135790         PERFORM P9015-BUILD-AR-CYCLE THRU P9019-EXIT.            13579000
135800     PERFORM P8780-BUILD-ACCT-ANAL-DYL-BAL THRU P8789-EXIT.       13580000
135810     PERFORM P8800-BUILD-ACCT-ANAL-CNT-TX  THRU P8809-EXIT.       13581000
135820     PERFORM P8810-BUILD-ACCT-ANAL-ADJ-TX  THRU P8819-EXIT.       13582000
135830     IF CESA-ACCT OR HSA-ACCT                                     13583000
135840        IF CURRENT-BALANCE EQUAL ZEROS                            13584000
135850            NEXT SENTENCE                                         13585000
135860          ELSE                                                    13586000
135870            MOVE 853                TO RPT859-RPT-NBR             13587000
135880                                       SORT859-RPT-NBR            13588000
135890            MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT           13589000
135900                                       RPT859-DDA-ACCT-NBR        13590000
135910            MOVE 44                 TO RPT859-EXCEPT-CODE         13591000
135920            MOVE CURRENT-BALANCE    TO RPT859-SAC-BALANCE         13592000
135930            MOVE ZEROS              TO RPT859-TX-CODE             13593000
135940            MOVE ZEROS              TO RPT859-TX-AMOUNT           13594000
135950            PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.     13595000
135960*    IF OVERDRAWN IN THE PAST 6 MONTHS.                           13596000
135970     MOVE -00006 TO NUM-MONTHS.                                   13597000
135980     CALL 'CDCDT33' USING PROC-CURR-DATE                          13598000
135990                          NUM-MONTHS                              13599000
136000                          WORK-6MONTHS-AGO.                       13600000
136010     IF DTE-LAST-OVERDRAWN GREATER THAN WORK-6MONTHS-AGO          13601000
136020         IF CURRENT-BALANCE LESS THAN ZERO                        13602000
136030             CONTINUE                                             13603000
136040           ELSE                                                   13604000
136050             PERFORM P8760-BUILD-OD-ACCTS-FILE THRU P8769-EXIT.   13605000
136060                                                                  13606000
136070     GO TO P5180-CHECK-FOR-END-OF-PERIOD.                         13607000
136080                                                                  13608000
136090 P5175-BANK-CTL-ACCTS.                                            13609000
136100     PERFORM P7720-AR-ACCOUNT-LIST THRU P7729-EXIT.               13610000
136110     PERFORM P8450-BUILD-NSF-FILE-2 THRU P8459-EXIT.              13611000
136120     PERFORM P7010-BUILD-TRIAL-BALANCE THRU P7019-EXIT.           13612000
136130     IF CURRENT-BALANCE LESS THAN ZERO                            13613000
136140         PERFORM P7050-BUILD-OVERDRAWN-ACCTS THRU P7059-EXIT.     13614000
136150     IF WATCHED OR WATCHED-ACH                                    13615000
136160         MOVE ' ' TO HOLD-WA-TX-DISP                              13616000
136170         PERFORM P7250-BUILD-WATCHED-ACCT THRU P7259-EXIT.        13617000
136180     IF BAI-ACCOUNT                                               13618000
136190         PERFORM P8710-BUILD-BAI-ACCT-SUMMARY THRU P8719-EXIT.    13619000
136200     IF DDA-ACCOUNT OR NOW-ACCOUNT OR CMM-ACCOUNT                 13620000
136210         PERFORM P8740-WRITE-SHADOW-ACCT THRU P8749-EXIT.         13621000
136220     IF DO-ACCT-RECON                                             13622000
136230         PERFORM P9015-BUILD-AR-CYCLE THRU P9019-EXIT.            13623000
136240     PERFORM P8780-BUILD-ACCT-ANAL-DYL-BAL THRU P8789-EXIT.       13624000
136250     PERFORM P8800-BUILD-ACCT-ANAL-CNT-TX  THRU P8809-EXIT.       13625000
136260     PERFORM P8810-BUILD-ACCT-ANAL-ADJ-TX  THRU P8819-EXIT.       13626000
136270                                                                  13627000
136280 P5180-CHECK-FOR-END-OF-PERIOD.                                   13628000
136290     IF END-OF-PERIOD                                             13629000
136300         GO TO P5185-END-OF-PERIOD.                               13630000
136310     GO TO P5190-ACCUM-MASTER.                                    13631000
136320                                                                  13632000
136330 P5185-END-OF-PERIOD.                                             13633000
136340     IF PROC-MONTH-END                                            13634000
136350         PERFORM P6500-MONTHEND-RTN THRU P6509-EXIT.              13635000
136360     IF PROC-QTR-END                                              13636000
136370         PERFORM P6510-QTREND-RTN THRU P6519-EXIT.                13637000
136380     IF PROC-YEAR-END                                             13638000
136390         PERFORM P6530-YEAREND-RTN THRU P6539-EXIT.               13639000
136400     PERFORM P6620-SET-12-MO-AVG THRU P6629-EXIT.                 13640000
136410                                                                  13641000
136420 P5190-ACCUM-MASTER.                                              13642000
136430     IF PROC-DSD                                                  13643000
136440         IF CLOSED                                                13644000
136450             ADD 1 TO NUM-CLOSED-ACCTS                            13645000
136460             GO TO P5215-ACCUM-MSTR-ODB.                          13646000
136470     IF CLOSED                                                    13647000
136480         ADD 1 TO NUM-CLOSED-ACCTS                                13648000
136490         IF TODAY OR THIS-WEEK OR THIS-MONTH OR (PROC-MONTH-END   13649000
136500                            AND THIS-QUARTER)                     13650000
136510             GO TO P5195-ACCUM-MSTR-2                             13651000
136520           ELSE                                                   13652000
136530             GO TO P5225-WRITE-MASTER.                            13653000
136540     ADD 1 TO NUM-OPEN-ACCTS.                                     13654000
136550     IF CURRENT-BALANCE = 0                                       13655000
136560         ADD 1 TO NUM-ZERO-ACCTS.                                 13656000
136570                                                                  13657000
136580 P5195-ACCUM-MSTR-2.                                              13658000
136590     MOVE ACCT-TYPE-CODE TO SUB9.                                 13659000
136600     ADD CURRENT-BALANCE TO CUR-BAL-BY-TYPE (SUB9)                13660000
136610                            CUR-BAL-BY-TYPE (100)                 13661000
136620                            CUR-BAL-BY-IDENT (11)                 13662000
136630                            CUR-BAL-BY-IDENT (SUB13).             13663000
136640     ADD 1 TO NUMBER-BY-TYPE (SUB9)                               13664000
136650              NUMBER-BY-TYPE (100)                                13665000
136660              NUMBER-BY-IDENT (11)                                13666000
136670              NUMBER-BY-IDENT (SUB13).                            13667000
136680     IF PERSONAL                                                  13668000
136690         ADD 1 TO NUMBER-BY-IDENT-PERS (11)                       13669000
136700                  NUMBER-BY-IDENT-PERS (SUB13)                    13670000
136710         ADD CURRENT-BALANCE TO CUR-BAL-BY-IDENT-PERS (11)        13671000
136720                                CUR-BAL-BY-IDENT-PERS (SUB13)     13672000
136730       ELSE                                                       13673000
136740         ADD 1 TO NUMBER-BY-IDENT-NON-PERS (11)                   13674000
136750                  NUMBER-BY-IDENT-NON-PERS (SUB13)                13675000
136760         ADD CURRENT-BALANCE TO CUR-BAL-BY-IDENT-NON-PERS (11)    13676000
136770                                CUR-BAL-BY-IDENT-NON-PERS (SUB13).13677000
136780     IF PROC-MONTH-END                                            13678000
136790         ADD AVG-CURR-BAL-MO (2) TO AVG-CURR-BAL-MO-BY-IDENT      13679000
136800             (SUB13)                                              13680000
136810         ADD AVG-COLL-BAL-MO (2) TO AVG-COLL-BAL-MO-BY-IDENT      13681000
136820             (SUB13)                                              13682000
136830       ELSE                                                       13683000
136840         IF DAYS-IN-CAL-MONTH NOT = ZERO                          13684000
136850             COMPUTE HOLD-AVG-CURR-MO ROUNDED =                   13685000
136860                 GROSS-CURR-BAL-MNTH / DAYS-IN-CAL-MONTH          13686000
136870             COMPUTE HOLD-AVG-COLL-MO ROUNDED =                   13687000
136880                 GROSS-COLL-BAL-MNTH / DAYS-IN-CAL-MONTH          13688000
136890             ADD HOLD-AVG-CURR-MO TO AVG-CURR-BAL-MO-BY-IDENT     13689000
136900                 (SUB13)                                          13690000
136910             ADD HOLD-AVG-COLL-MO TO AVG-COLL-BAL-MO-BY-IDENT     13691000
136920                 (SUB13).                                         13692000
136930                                                                  13693000
136940 P5200-ACCUM-MSTR-3.                                              13694000
136950     EVALUATE TRUE                                                13695000
136960         WHEN BANK-CTL-ACCTS                                      13696000
136970             MOVE 001 TO SUB6                                     13697000
136980         WHEN CURRENT-BALANCE LESS THAN ZERO                      13698000
136990             IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-SUSPENDED OR   13699000
137000                OA-ACTIVE-FIXED                                   13700000
137010                 MOVE 003 TO SUB6                                 13701000
137020               ELSE                                               13702000
137030                 MOVE 002 TO SUB6                                 13703000
137040             END-IF                                               13704000
137050         WHEN CURRENT-BALANCE LESS THAN +50.00                    13705000
137060             MOVE 004 TO SUB6                                     13706000
137070         WHEN CURRENT-BALANCE LESS THAN +200.00                   13707000
137080             MOVE 005 TO SUB6                                     13708000
137090         WHEN CURRENT-BALANCE LESS THAN +500.00                   13709000
137100             MOVE 006 TO SUB6                                     13710000
137110         WHEN CURRENT-BALANCE LESS THAN +750.00                   13711000
137120             MOVE 007 TO SUB6                                     13712000
137130         WHEN CURRENT-BALANCE LESS THAN +1000.00                  13713000
137140             MOVE 008 TO SUB6                                     13714000
137150         WHEN CURRENT-BALANCE LESS THAN +1200.00                  13715000
137160             MOVE 009 TO SUB6                                     13716000
137170         WHEN CURRENT-BALANCE LESS THAN +1500.00                  13717000
137180             MOVE 010 TO SUB6                                     13718000
137190         WHEN CURRENT-BALANCE LESS THAN +5000.00                  13719000
137200             MOVE 011 TO SUB6                                     13720000
137210         WHEN CURRENT-BALANCE LESS THAN +10000.00                 13721000
137220             MOVE 012 TO SUB6                                     13722000
137230         WHEN CURRENT-BALANCE LESS THAN +25000.00                 13723000
137240             MOVE 013 TO SUB6                                     13724000
137250         WHEN CURRENT-BALANCE LESS THAN +100000.00                13725000
137260             MOVE 014 TO SUB6                                     13726000
137270         WHEN CURRENT-BALANCE =         +100000.00                13727000
137280             MOVE 015 TO SUB6                                     13728000
137290         WHEN CURRENT-BALANCE LESS THAN +250000.01                13729000
137300             MOVE 016 TO SUB6                                     13730000
137310         WHEN OTHER                                               13731000
137320             MOVE 017 TO SUB6                                     13732000
137330     END-EVALUATE.                                                13733000
137340                                                                  13734000
137350     ADD CURRENT-BALANCE TO CUR-BAL-BY-STRATA (SUB6)              13735000
137360                            CUR-BAL-BY-STRATA (18).               13736000
137370     ADD 1 TO NUMBER-BY-STRATA (SUB6)                             13737000
137380              NUMBER-BY-STRATA (18).                              13738000
137390                                                                  13739000
137400 P5205-ACCUM-MSTR-4.                                              13740000
137410     EVALUATE TRUE                                                13741000
137420         WHEN BANK-CTL-ACCTS                                      13742000
137430             MOVE 001 TO SUB6                                     13743000
137440         WHEN CURRENT-BALANCE LESS THAN ZERO                      13744000
137450             IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-SUSPENDED OR   13745000
137460                OA-ACTIVE-FIXED                                   13746000
137470                 MOVE 003 TO SUB6                                 13747000
137480               ELSE                                               13748000
137490                 MOVE 002 TO SUB6                                 13749000
137500             END-IF                                               13750000
137510         WHEN CURRENT-BALANCE LESS THAN +100.00                   13751000
137520             MOVE 004 TO SUB6                                     13752000
137530         WHEN CURRENT-BALANCE LESS THAN +300.00                   13753000
137540             MOVE 005 TO SUB6                                     13754000
137550         WHEN CURRENT-BALANCE LESS THAN +750.00                   13755000
137560             MOVE 006 TO SUB6                                     13756000
137570         WHEN CURRENT-BALANCE LESS THAN +1000.00                  13757000
137580             MOVE 007 TO SUB6                                     13758000
137590         WHEN CURRENT-BALANCE LESS THAN +2500.00                  13759000
137600             MOVE 008 TO SUB6                                     13760000
137610         WHEN CURRENT-BALANCE LESS THAN +5000.00                  13761000
137620             MOVE 009 TO SUB6                                     13762000
137630         WHEN CURRENT-BALANCE LESS THAN +10000.00                 13763000
137640             MOVE 010 TO SUB6                                     13764000
137650         WHEN CURRENT-BALANCE LESS THAN +25000.00                 13765000
137660             MOVE 011 TO SUB6                                     13766000
137670         WHEN CURRENT-BALANCE LESS THAN +50000.00                 13767000
137680             MOVE 012 TO SUB6                                     13768000
137690         WHEN CURRENT-BALANCE LESS THAN +100000.00                13769000
137700             MOVE 013 TO SUB6                                     13770000
137710         WHEN CURRENT-BALANCE LESS THAN +500000.00                13771000
137720             MOVE 014 TO SUB6                                     13772000
137730         WHEN OTHER                                               13773000
137740             MOVE 015 TO SUB6                                     13774000
137750     END-EVALUATE.                                                13775000
137760                                                                  13776000
137770     ADD CURRENT-BALANCE TO CUR-BAL-BY-STRATA-SC (SUB6)           13777000
137780                            CUR-BAL-BY-STRATA-SC (16).            13778000
137790     ADD 1 TO NUMBER-BY-STRATA-SC (SUB6)                          13779000
137800              NUMBER-BY-STRATA-SC (16).                           13780000
137810                                                                  13781000
137820 P5210-ACCUM-MSTR-5.                                              13782000
137830     ADD CURRENT-BALANCE TO END-CUR-BAL.                          13783000
137840     ADD 1 TO END-NUM-ACCTS.                                      13784000
137850     ADD ACCRUED-INTEREST TO END-ACCR-BY-IDENT (11)               13785000
137860                             END-ACCR-BY-IDENT (SUB13).           13786000
137870     EVALUATE TRUE                                                13787000
137880         WHEN STMT-WITH-CHECKS                                    13788000
137890             ADD 1 TO NUM-ACCTS-WITH-CHKS                         13789000
137900         WHEN STMT-TRUNCATED                                      13790000
137910             ADD 1 TO NUM-ACCTS-TRUNCATED                         13791000
137920         WHEN STMT-IMAGED                                         13792000
137930             ADD 1 TO NUM-ACCTS-IMAGED                            13793000
137940         WHEN OTHER                                               13794000
137950             CONTINUE                                             13795000
137960     END-EVALUATE.                                                13796000
137970     IF PROC-DSS                                                  13797000
137980         GO TO P5225-WRITE-MASTER.                                13798000
137990     IF STMT-IMAGED                                               13799000
138000         ADD 1 TO NUM-IMAGED-ACCTS.                               13800000
138010                                                                  13801000
138020 P5215-ACCUM-MSTR-ODB.                                            13802000
138030     IF ODB-PLAN = SPACES                                         13803000
138040         GO TO P5220-ACCUM-MSTR-INV.                              13804000
138050     IF ODB-CLOSED-DELETE                                         13805000
138060         ADD 1 TO NUM-OTHER-ODB                                   13806000
138070       ELSE                                                       13807000
138080         ADD 1 TO NUM-APPROVED-ODB.                               13808000
138090     IF ODB-LOAN-BAL NOT = ZERO                                   13809000
138100         ADD 1 TO END-NUM-LOANS                                   13810000
138110         ADD ODB-LOAN-BAL TO END-LOAN-BAL.                        13811000
138120     IF SINGLE-CR-LIFE OR JOINT-CR-LIFE                           13812000
138130         IF ODB-LOAN-BAL NOT = ZERO                               13813000
138140             ADD 1 TO NUM-CR-LIFE-ACCTS                           13814000
138150             ADD ODB-LOAN-BAL TO AMT-CR-LIFE-ACCTS.               13815000
138160     ADD ODB-LOAN-BAL TO BAL-BY-PLAN-ODB (SUB10)                  13816000
138170                         BAL-BY-PLAN-ODB (11).                    13817000
138180     IF PERSONAL                                                  13818000
138190         ADD ODB-LOAN-BAL TO BAL-BY-PLAN-PERS-ODB (SUB10)         13819000
138200                             BAL-BY-PLAN-PERS-ODB (11)            13820000
138210       ELSE                                                       13821000
138220         ADD ODB-LOAN-BAL TO BAL-BY-PLAN-NON-PERS-ODB (SUB10)     13822000
138230                             BAL-BY-PLAN-NON-PERS-ODB (11).       13823000
138240     ADD ODB-ACCRUED-F-C TO END-ACCR-BY-PLAN-ODB (SUB10)          13824000
138250                            END-ACCR-BY-PLAN-ODB (11).            13825000
138260     IF PROC-YEAR-END                                             13826000
138270         ADD ODB-INT-PAID-PREV-YR TO AMT-ODB-FIN-CHRG-UNSECURED   13827000
138280         ADD ODB-PREV-YR-INT-SECURED TO AMT-ODB-FIN-CHRG-SECURED  13828000
138290       ELSE                                                       13829000
138300         ADD YTD-ODB-INT TO AMT-ODB-FIN-CHRG-UNSECURED            13830000
138310         ADD ODB-YTD-INT-SECURED TO AMT-ODB-FIN-CHRG-SECURED.     13831000
138320                                                                  13832000
138330 P5220-ACCUM-MSTR-INV.                                            13833000
138340     IF INV-PLAN = SPACES OR 'IC'                                 13834000
138350         GO TO P5225-WRITE-MASTER.                                13835000
138360     IF INV-CLOSED                                                13836000
138370         ADD 1 TO NUM-OTHER-INV                                   13837000
138380       ELSE                                                       13838000
138390         ADD 1 TO NUM-APPROVED-INV.                               13839000
138400     ADD INV-BALANCE TO BAL-BY-PLAN-INV (SUB11)                   13840000
138410                        BAL-BY-PLAN-INV (11).                     13841000
138420     IF PERSONAL                                                  13842000
138430         ADD INV-BALANCE TO BAL-BY-PLAN-PERS-INV (SUB11)          13843000
138440                            BAL-BY-PLAN-PERS-INV (11)             13844000
138450       ELSE                                                       13845000
138460         ADD INV-BALANCE TO BAL-BY-PLAN-NON-PERS-INV (SUB11)      13846000
138470                            BAL-BY-PLAN-NON-PERS-INV (11).        13847000
138480     ADD INV-ACCRUED-INT TO END-ACCR-BY-PLAN-INV (SUB11)          13848000
138490                            END-ACCR-BY-PLAN-INV (11).            13849000
138500                                                                  13850000
138510 P5225-WRITE-MASTER.                                              13851000
138520     MOVE CURRENT-BALANCE TO OLD-CURR-BAL.                        13852000
138530     MOVE DSDS-MASTER-RECORD TO DSDS-M-FILE-RECORD.               13853000
138540     REWRITE DSDS-M-FILE-RECORD.                                  13854000
138550     IF VSAM-SUCCESSFUL                                           13855000
138560         NEXT SENTENCE                                            13856000
138570       ELSE                                                       13857000
138580         DISPLAY 'CDCERROR-MASTER WRITE ERROR' UPON CONSOLE       13858000
138590         DISPLAY 'CDCERROR-MASTER REWRITE ERROR' UPON CONSOLE     13859000
138600         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  13860000
138610         CALL 'CDCDUMP' USING BY CONTENT '2059'.                  13861000
138620     ADD 1 TO UPDATE-MSTR.                                        13862000
138630                                                                  13863000
138640     IF GOT-HISTORY = 1                                           13864000
138650         MOVE DSDS-HISTORY-RECORD TO DSDS-H-FILE-RECORD           13865000
138660         REWRITE DSDS-H-FILE-RECORD                               13866000
138670         IF VSAM-SUCCESSFUL                                       13867000
138680             ADD 1 TO UPDATE-HIST                                 13868000
138690           ELSE                                                   13869000
138700             DISPLAY 'CDCERROR-HISTORY REWRITE ERROR' UPON CONSOLE13870000
138710             DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS           13871000
138720                 UPON CONSOLE                                     13872000
138730             CALL 'CDCDUMP' USING BY CONTENT '2060'.              13873000
138740                                                                  13874000
138750 P5230-CHK-RPTS-AFTER-UPDATE.                                     13875000
138760     PERFORM P7610-BUILD-ACCT-HIST THRU P7619-EXIT.               13876000
138770                                                                  13877000
138780 P5235-MASTER-END.                                                13878000
138790     PERFORM P0300-READ-MSTR THRU P0399-READ-MSTR-EXIT.           13879000
138800     GO TO P1000-MATCH-MSTR-TX.                                   13880000
138810                                                                  13881000
138820******************************************************************13882000
138830*                C Y C L E   S T A T E M E N T S                 *13883000
138840******************************************************************13884000
138850 P5400-CYCLE-STATEMENT.                                           13885000
138860     IF CYCLE-THIS-SC-EARN = 1                                    13886000
138870         PERFORM P5410-CYCLE-SC-EARN THRU P5739-CYC-SC-E-EXIT     13887000
138880         GO TO P5740-CYC-STMT-END.                                13888000
138890     INITIALIZE DOLLAR-ITEMS.                                     13889000
138900     INITIALIZE COUNT-ITEMS.                                      13890000
138910     MOVE ZEROS TO HOLD-EARNINGS.                                 13891000
138920     MOVE ZEROS TO HOLD-TAX-WITHHELD.                             13892000
138930     MOVE ZEROS TO HOLD-SC-AMT.                                   13893000
138940     MOVE ' ' TO HOLD-DISP.                                       13894000
138950     GO TO P5740-CYC-STMT-END.                                    13895000
138960                                                                  13896000
138970 P5410-CYCLE-SC-EARN.                                             13897000
138980     PERFORM P8106-GET-HISTORY THRU P8109-EXIT.                   13898000
138990     IF PERSONAL                                                  13899000
139000         GO TO P5420-CYC-SC-1.                                    13900000
139010     IF DAYS-IN-CYCLE = ZEROS                                     13901000
139020         MOVE ZEROS TO AVG-CURR-BAL-CYC (1)                       13902000
139030                       AVG-COLL-BAL-CYC (1)                       13903000
139040       ELSE                                                       13904000
139050         DIVIDE GROSS-CURR-BAL-CYCL BY DAYS-IN-CYCLE              13905000
139060             GIVING AVG-CURR-BAL-CYC (1)                          13906000
139070         DIVIDE GROSS-COLL-BAL-CYCL BY DAYS-IN-CYCLE              13907000
139080             GIVING AVG-COLL-BAL-CYC (1).                         13908000
139090     GO TO P5440-CYC-SC-3.                                        13909000
139100                                                                  13910000
139110 P5420-CYC-SC-1.                                                  13911000
139120     IF DDA-ACCOUNT                                               13912000
139130         IF DAYS-IN-CYCLE = ZEROS                                 13913000
139140             MOVE ZEROS TO AVG-CURR-BAL-CYC (1)                   13914000
139150                           AVG-COLL-BAL-CYC (1)                   13915000
139160             GO TO P5440-CYC-SC-3                                 13916000
139170           ELSE                                                   13917000
139180             DIVIDE GROSS-CURR-BAL-CYCL BY DAYS-IN-CYCLE          13918000
139190                 GIVING AVG-CURR-BAL-CYC (1)                      13919000
139200             DIVIDE GROSS-COLL-BAL-CYCL BY DAYS-IN-CYCLE          13920000
139210                 GIVING AVG-COLL-BAL-CYC (1)                      13921000
139220             GO TO P5440-CYC-SC-3.                                13922000
139230     IF TIS-DAYS-CYC = ZEROS                                      13923000
139240         MOVE ZEROS TO AVG-CURR-BAL-CYC (1)                       13924000
139250                       AVG-COLL-BAL-CYC (1)                       13925000
139260       ELSE                                                       13926000
139270         DIVIDE TIS-GRS-CUR-BAL-CYC BY TIS-DAYS-CYC               13927000
139280             GIVING AVG-CURR-BAL-CYC (1)                          13928000
139290         DIVIDE TIS-GRS-COL-BAL-CYC BY TIS-DAYS-CYC               13929000
139300             GIVING AVG-COLL-BAL-CYC (1).                         13930000
139310                                                                  13931000
139320                                                                  13932000
139330 P5440-CYC-SC-3.                                                  13933000
139340     MOVE AMT-CREDITS          TO AMT-CYCLE-CREDITS (1).          13934000
139350     MOVE AMT-DEBITS           TO AMT-CYCLE-DEBITS (1).           13935000
139360     MOVE NUM-SERV-CHG-DEBITS  TO NUM-SC-DEBITS (1).              13936000
139370     MOVE NUM-SERV-CHG-CREDIT  TO NUM-SC-CREDITS (1).             13937000
139380     MOVE NUM-SERV-CHG-ITEMS   TO NUM-SC-ITEMS (1).               13938000
139390                                                                  13939000
139400 P5450-CYC-SC-4.                                                  13940000
139410     IF ODB-PLAN = SPACES                                         13941000
139420         NEXT SENTENCE                                            13942000
139430       ELSE                                                       13943000
139440         PERFORM P2850-CYCLE-ODB THRU P2999-EXIT                  13944000
139450         PERFORM P3200-ODB-FEE   THRU P3249-EXIT.                 13945000
139460     IF INV-PLAN = SPACES OR 'IC'                                 13946000
139470         NEXT SENTENCE                                            13947000
139480       ELSE                                                       13948000
139490         PERFORM P4000-CYCLE-INV THRU P4099-EXIT.                 13949000
139500     IF CURRENT-BALANCE LESS THAN LOW-BALANCE-CYCLE               13950000
139510         IF 942-AMT = ZEROS                                       13951000
139520             MOVE CURRENT-BALANCE TO LOW-BALANCE-CYCLE.           13952000
139530     EVALUATE TRUE                                                13953000
139540         WHEN EARN-AVG-CURR (SUB18)                               13954000
139550             MOVE AVG-CURR-BAL-CYC (1) TO HOLD-IMM-AVG-INV-BAL    13955000
139560         WHEN EARN-AVG-COLL (SUB18)                               13956000
139570             MOVE AVG-COLL-BAL-CYC (1) TO HOLD-IMM-AVG-INV-BAL    13957000
139580         WHEN EARN-LOW-BAL (SUB18)                                13958000
139590             MOVE LOW-BALANCE-CYCLE TO HOLD-IMM-AVG-INV-BAL       13959000
139600         WHEN EARN-INVESTABLE-BAL (SUB18)                         13960000
139610             COMPUTE HOLD-IMM-AVG-INV-BAL ROUNDED =               13961000
139620                 AVG-COLL-BAL-CYC (1) *                           13962000
139630                 (1 - EARN-INT-ACCR-RESERVE (SUB18))              13963000
139640         WHEN OTHER                                               13964000
139650             MOVE AVG-COLL-BAL-CYC (1) TO HOLD-IMM-AVG-INV-BAL    13965000
139660     END-EVALUATE.                                                13966000
139670     IF GROSS-RATE GREATER THAN ZERO AND LESS THAN +99.9999999    13967000
139680         COMPUTE HOLD-IMM-RATE-WORK =                             13968000
139690             GROSS-RATE / GROSS-RATE-DAYS                         13969000
139700       ELSE                                                       13970000
139710         MOVE ZEROS TO HOLD-IMM-RATE-WORK.                        13971000
139720     INITIALIZE DOLLAR-ITEMS.                                     13972000
139730     INITIALIZE COUNT-ITEMS.                                      13973000
139740     INITIALIZE FEE-ITEMS.                                        13974000
139750     MOVE ZEROS TO HOLD-EARNINGS.                                 13975000
139760     MOVE ZEROS TO HOLD-TAX-WITHHELD.                             13976000
139770     MOVE ZEROS TO HOLD-SC-AMT.                                   13977000
139780     MOVE 0 TO EXCESS-WD-SW.                                      13978000
139790     MOVE SPACE TO HOLD-EARN-DISP.                                13979000
139800     MOVE NUM-SERV-CHG-DEBITS TO CALC-DEBITS.                     13980000
139810     MOVE NUM-SERV-CHG-ITEMS TO CALC-ITEMS.                       13981000
139820     IF BCFSCR-CHARGE-A-TIME                                      13982000
139830         PERFORM P5760-FEE-ACCT-STMT THRU P5769-EXIT.             13983000
139840     MOVE ONE-MONTH-QUARTER-HISTORY (1) TO HOLD-HISTORY.          13984000
139850     MOVE FED-RESERVE-REQMNT TO HOLD-RESERVE-REQMNT.              13985000
139860     MOVE HOLD-DAYS-IN-YEAR TO HOLD-AVERAGE.                      13986000
139870     IF DATE-LAST-CUST-ACT = ZEROS                                13987000
139880         MOVE ZEROS TO MONTHS-12                                  13988000
139890       ELSE                                                       13989000
139900         CALL 'CDCDT12' USING DATE-LAST-CUST-ACT                  13990000
139910                              PROC-CURR-DATE                      13991000
139920                              MONTHS-12.                          13992000
139930     MOVE MONTHS-12 TO HOLD-CALC-ITEMS.                           13993000
139940     MOVE ID-PROT-ONLY     TO ID-PROTECTION-ONLY-FEE.             13994000
139950     MOVE ID-PROT-PLUS     TO ID-PROTECTION-PLUS-FEE.             13995000
139960     MOVE ID-PROT-DISC     TO ID-PROTECTION-DISC-FEE.             13996000
139970     MOVE ID-PROT-EMPL     TO ID-PROTECTION-EMPL-FEE.             13997000
139980     MOVE 'C' TO HOLD-DISP.                                       13998000
139990     IF PROC-DSD                                                  13999000
140000         GO TO P5460-DDA-SC-ROUTINES.                             14000000
140010     GO TO P5470-SAV-SC-ROUTINES.                                 14001000
140020                                                                  14002000
140030******************************************************************14003000
140040* D E M A N D   D E P O S I T   S. C.   R O U T I N E   C A L L  *14004000
140050******************************************************************14005000
140060 P5460-DDA-SC-ROUTINES.                                           14006000
140070     PERFORM P8050-GET-RBB THRU P8059-EXIT.                       14007000
140080     EVALUATE PROC-BK-NO                                          14008000
140090         WHEN 01                                                  14009000
140100             CALL 'DDSC01' USING DSDS-MASTER-RECORD               14010000
140110                                 SC-ROUTINE-WORK-FIELDS           14011000
140120                                 RELATIONSHIP-BANKING-BALANCES    14012000
140130         WHEN 02                                                  14013000
140140             CALL 'DDSC02' USING DSDS-MASTER-RECORD               14014000
140150                                 SC-ROUTINE-WORK-FIELDS           14015000
140160                                 RELATIONSHIP-BANKING-BALANCES    14016000
140170         WHEN 10                                                  14017000
140180             CALL 'DDSC10' USING DSDS-MASTER-RECORD               14018000
140190                                 SC-ROUTINE-WORK-FIELDS           14019000
140200                                 RELATIONSHIP-BANKING-BALANCES    14020000
140210         WHEN 11                                                  14021000
140220             CALL 'DDSC11' USING DSDS-MASTER-RECORD               14022000
140230                                 SC-ROUTINE-WORK-FIELDS           14023000
140240                                 RELATIONSHIP-BANKING-BALANCES    14024000
140250         WHEN 14                                                  14025000
140260             CALL 'DDSC14' USING DSDS-MASTER-RECORD               14026000
140270                                 SC-ROUTINE-WORK-FIELDS           14027000
140280                                 RELATIONSHIP-BANKING-BALANCES    14028000
140290         WHEN 15                                                  14029000
140300             CALL 'DDSC15' USING DSDS-MASTER-RECORD               14030000
140310                                 SC-ROUTINE-WORK-FIELDS           14031000
140320                                 RELATIONSHIP-BANKING-BALANCES    14032000
140330         WHEN 16                                                  14033000
140340             CALL 'DDSC16' USING DSDS-MASTER-RECORD               14034000
140350                                 SC-ROUTINE-WORK-FIELDS           14035000
140360                                 RELATIONSHIP-BANKING-BALANCES    14036000
140370         WHEN 20                                                  14037000
140380             CALL 'DDSC20' USING DSDS-MASTER-RECORD               14038000
140390                                 SC-ROUTINE-WORK-FIELDS           14039000
140400                                 RELATIONSHIP-BANKING-BALANCES    14040000
140410         WHEN 22                                                  14041000
140420             CALL 'DDSC22' USING DSDS-MASTER-RECORD               14042000
140430                                 SC-ROUTINE-WORK-FIELDS           14043000
140440                                 RELATIONSHIP-BANKING-BALANCES    14044000
140450         WHEN 24                                                  14045000
140460             CALL 'DDSC24' USING DSDS-MASTER-RECORD               14046000
140470                                 SC-ROUTINE-WORK-FIELDS           14047000
140480                                 RELATIONSHIP-BANKING-BALANCES    14048000
140490         WHEN 27                                                  14049000
140500             CALL 'DDSC27' USING DSDS-MASTER-RECORD               14050000
140510                                 SC-ROUTINE-WORK-FIELDS           14051000
140520                                 RELATIONSHIP-BANKING-BALANCES    14052000
140530         WHEN 29                                                  14053000
140540             CALL 'DDSC29' USING DSDS-MASTER-RECORD               14054000
140550                                 SC-ROUTINE-WORK-FIELDS           14055000
140560                                 RELATIONSHIP-BANKING-BALANCES    14056000
140570         WHEN 39                                                  14057000
140580             CALL 'DDSC39' USING DSDS-MASTER-RECORD               14058000
140590                                 SC-ROUTINE-WORK-FIELDS           14059000
140600                                 RELATIONSHIP-BANKING-BALANCES    14060000
140610         WHEN 45                                                  14061000
140620             CALL 'DDSC45' USING DSDS-MASTER-RECORD               14062000
140630                                 SC-ROUTINE-WORK-FIELDS           14063000
140640                                 RELATIONSHIP-BANKING-BALANCES    14064000
140650         WHEN OTHER                                               14065000
140660             CALL DSD-SC-MODULE                                   14066000
140670                           USING DSDS-MASTER-RECORD               14067000
140680                                 SC-ROUTINE-WORK-FIELDS           14068000
140690                                 RELATIONSHIP-BANKING-BALANCES    14069000
140700     END-EVALUATE.                                                14070000
140710                                                                  14071000
140720     EVALUATE SC-RETURN                                           14072000
140730         WHEN 0                                                   14073000
140740             GO TO P5600-SC-RETURN                                14074000
140750         WHEN 1                                                   14075000
140760             GO TO P5735-SC-END-3                                 14076000
140770         WHEN 2                                                   14077000
140780             PERFORM P7180-BUILD-SC-CLOSED THRU P7189-EXIT        14078000
140790             GO TO P5600-SC-RETURN                                14079000
140800         WHEN 3                                                   14080000
140810             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14081000
140820             GO TO P5600-SC-RETURN                                14082000
140830         WHEN 4                                                   14083000
140840             PERFORM P7180-BUILD-SC-CLOSED THRU P7189-EXIT        14084000
140850             ADD .00500 TO ACCRUED-INTEREST                       14085000
140860             MOVE ACCRUED-INTEREST TO HOLD-EARNINGS               14086000
140870             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14087000
140880             GO TO P5600-SC-RETURN                                14088000
140890         WHEN 5                                                   14089000
140900             ADD .00500 TO ACCRUED-INTEREST                       14090000
140910             MOVE ACCRUED-INTEREST TO HOLD-EARNINGS               14091000
140920             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14092000
140930             GO TO P5600-SC-RETURN                                14093000
140940         WHEN 6                                                   14094000
140950             PERFORM P7180-BUILD-SC-CLOSED THRU P7189-EXIT        14095000
140960             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14096000
140970             GO TO P5600-SC-RETURN                                14097000
140980         WHEN 7                                                   14098000
140990             COMPUTE ACCR-DIFF = ACCRUED-INTEREST -               14099000
141000                                 MIN-ACCR-INTEREST                14100000
141010             MOVE ACCR-DIFF TO HOLD-EARNINGS                      14101000
141020             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14102000
141030             MOVE MIN-ACCR-INTEREST TO ACCRUED-INTEREST           14103000
141040             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14104000
141050             IF AVG-COLL-BAL-CYC (1) GREATER THAN ZEROS           14105000
141060                 COMPUTE WORK-INT-RATE ROUNDED =                  14106000
141070                         MIN-ACCR-INTEREST /                      14107000
141080                         AVG-COLL-BAL-CYC (1) * HOLD-DAYS-IN-YEAR 14108000
141090                 MOVE WORK-INT-RATE TO GROSS-RATE                 14109000
141100                 IF GROSS-RATE-DAYS GREATER THAN ZEROS            14110000
141110                     COMPUTE HOLD-IMM-RATE-WORK =                 14111000
141120                             GROSS-RATE / GROSS-RATE-DAYS         14112000
141130                 ELSE                                             14113000
141140                     MOVE ZEROS TO HOLD-IMM-RATE-WORK             14114000
141150                 END-IF                                           14115000
141160             ELSE                                                 14116000
141170                 MOVE ZEROS             TO GROSS-RATE             14117000
141180                 MOVE ZEROS             TO HOLD-IMM-RATE-WORK     14118000
141190             END-IF                                               14119000
141200             GO TO P5600-SC-RETURN                                14120000
141210         WHEN OTHER                                               14121000
141220             MOVE 18 TO HOLD-REASON-CODE                          14122000
141230             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT     14123000
141240             MOVE 'N' TO HOLD-DISP                                14124000
141250             MOVE 6 TO HOLD-NC-DISP                               14125000
141260             GO TO P5600-SC-RETURN                                14126000
141270     END-EVALUATE.                                                14127000
141280                                                                  14128000
141290******************************************************************14129000
141300*        S A V I N G S   S. C.   R O U T I N E   C A L L         *14130000
141310******************************************************************14131000
141320 P5470-SAV-SC-ROUTINES.                                           14132000
141330     PERFORM P8050-GET-RBB THRU P8059-EXIT.                       14133000
141340     EVALUATE PROC-BK-NO                                          14134000
141350         WHEN 01                                                  14135000
141360             CALL 'DSSC01' USING DSDS-MASTER-RECORD               14136000
141370                                 SC-ROUTINE-WORK-FIELDS           14137000
141380                                 RELATIONSHIP-BANKING-BALANCES    14138000
141390         WHEN 02                                                  14139000
141400             CALL 'DSSC02' USING DSDS-MASTER-RECORD               14140000
141410                                 SC-ROUTINE-WORK-FIELDS           14141000
141420                                 RELATIONSHIP-BANKING-BALANCES    14142000
141430         WHEN 10                                                  14143000
141440             CALL 'DSSC10' USING DSDS-MASTER-RECORD               14144000
141450                                 SC-ROUTINE-WORK-FIELDS           14145000
141460                                 RELATIONSHIP-BANKING-BALANCES    14146000
141470         WHEN 11                                                  14147000
141480             CALL 'DSSC11' USING DSDS-MASTER-RECORD               14148000
141490                                 SC-ROUTINE-WORK-FIELDS           14149000
141500                                 RELATIONSHIP-BANKING-BALANCES    14150000
141510         WHEN 14                                                  14151000
141520             CALL 'DSSC14' USING DSDS-MASTER-RECORD               14152000
141530                                 SC-ROUTINE-WORK-FIELDS           14153000
141540                                 RELATIONSHIP-BANKING-BALANCES    14154000
141550         WHEN 15                                                  14155000
141560             CALL 'DSSC15' USING DSDS-MASTER-RECORD               14156000
141570                                 SC-ROUTINE-WORK-FIELDS           14157000
141580                                 RELATIONSHIP-BANKING-BALANCES    14158000
141590         WHEN 16                                                  14159000
141600             CALL 'DSSC16' USING DSDS-MASTER-RECORD               14160000
141610                                 SC-ROUTINE-WORK-FIELDS           14161000
141620                                 RELATIONSHIP-BANKING-BALANCES    14162000
141630         WHEN 20                                                  14163000
141640             CALL 'DSSC20' USING DSDS-MASTER-RECORD               14164000
141650                                 SC-ROUTINE-WORK-FIELDS           14165000
141660                                 RELATIONSHIP-BANKING-BALANCES    14166000
141670         WHEN 22                                                  14167000
141680             CALL 'DSSC22' USING DSDS-MASTER-RECORD               14168000
141690                                 SC-ROUTINE-WORK-FIELDS           14169000
141700                                 RELATIONSHIP-BANKING-BALANCES    14170000
141710         WHEN 24                                                  14171000
141720             CALL 'DSSC24' USING DSDS-MASTER-RECORD               14172000
141730                                 SC-ROUTINE-WORK-FIELDS           14173000
141740                                 RELATIONSHIP-BANKING-BALANCES    14174000
141750         WHEN 27                                                  14175000
141760             CALL 'DSSC27' USING DSDS-MASTER-RECORD               14176000
141770                                 SC-ROUTINE-WORK-FIELDS           14177000
141780                                 RELATIONSHIP-BANKING-BALANCES    14178000
141790         WHEN 29                                                  14179000
141800             CALL 'DSSC29' USING DSDS-MASTER-RECORD               14180000
141810                                 SC-ROUTINE-WORK-FIELDS           14181000
141820                                 RELATIONSHIP-BANKING-BALANCES    14182000
141830         WHEN 39                                                  14183000
141840             CALL 'DSSC39' USING DSDS-MASTER-RECORD               14184000
141850                                 SC-ROUTINE-WORK-FIELDS           14185000
141860                                 RELATIONSHIP-BANKING-BALANCES    14186000
141870         WHEN 45                                                  14187000
141880             CALL 'DSSC45' USING DSDS-MASTER-RECORD               14188000
141890                                 SC-ROUTINE-WORK-FIELDS           14189000
141900                                 RELATIONSHIP-BANKING-BALANCES    14190000
141910         WHEN OTHER                                               14191000
141920             CALL DSS-SC-MODULE                                   14192000
141930                           USING DSDS-MASTER-RECORD               14193000
141940                                 SC-ROUTINE-WORK-FIELDS           14194000
141950                                 RELATIONSHIP-BANKING-BALANCES    14195000
141960     END-EVALUATE.                                                14196000
141970                                                                  14197000
141980     MOVE 'B'     TO DSDM050P-RETURN-CODE.                        14198000
141990     MOVE ZEROS                    TO HOLD-TRNSF-ACCT-ID          14199000
142000     MOVE ZEROS                    TO HOLD-TRNSF-ACCT-NBR         14200000
142010     IF EARNINGS-DISP-CODE = '3'                                  14201000
142020         MOVE PROC-BK-NO     TO DSDM050P-BANK                     14202000
142030         MOVE ACCOUNT-ID     TO DSDM050P-ACCT-ID                  14203000
142040         MOVE ACCOUNT-NUMBER TO DSDM050P-ACCT-NBR                 14204000
142050         CALL 'DSDM050' USING DSDM050P-PARAMETERS                 14205000
142060         IF DSDM050P-RETURN-CODE = 'B'                            14206000
142070             MOVE EARNINGS-DISP-CODE       TO HOLD-OLD-EARN-DISP  14207000
142080             MOVE '2'                      TO HOLD-NEW-EARN-DISP  14208000
142090                                              EARNINGS-DISP-CODE  14209000
142100             PERFORM P8495-EARN-DISP-CODE-CHANGE THRU P8495-EXIT  14210000
142110             MOVE ZEROS                    TO HOLD-TRNSF-ACCT-ID  14211000
142120             MOVE ZEROS                    TO HOLD-TRNSF-ACCT-NBR 14212000
142130         ELSE                                                     14213000
142140             MOVE DSDM050P-RETURN-ACCT-ID  TO HOLD-TRNSF-ACCT-ID  14214000
142150             MOVE DSDM050P-RETURN-ACCT-NBR TO HOLD-TRNSF-ACCT-NBR 14215000
142160         END-IF                                                   14216000
142170     END-IF.                                                      14217000
142180                                                                  14218000
142190     EVALUATE SC-RETURN                                           14219000
142200         WHEN 0                                                   14220000
142210             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14221000
142220             GO TO P5600-SC-RETURN                                14222000
142230         WHEN 1                                                   14223000
142240             ADD .00500 TO ACCRUED-INTEREST                       14224000
142250             MOVE ACCRUED-INTEREST TO HOLD-EARNINGS               14225000
142260             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14226000
142270             GO TO P5600-SC-RETURN                                14227000
142280         WHEN 2                                                   14228000
142290             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14229000
142300             PERFORM P7180-BUILD-SC-CLOSED THRU P7189-EXIT        14230000
142310             GO TO P5600-SC-RETURN                                14231000
142320         WHEN 3                                                   14232000
142330             GO TO P5510-CC-NO-INTEREST                           14233000
142340         WHEN 4                                                   14234000
142350             GO TO P5520-CC-WITH-INTEREST                         14235000
142360         WHEN 5                                                   14236000
142370             COMPUTE ACCR-DIFF = ACCRUED-INTEREST -               14237000
142380                                 MIN-ACCR-INTEREST                14238000
142390             MOVE ACCR-DIFF TO HOLD-EARNINGS                      14239000
142400             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14240000
142410             MOVE MIN-ACCR-INTEREST TO ACCRUED-INTEREST           14241000
142420             PERFORM P5500-CYCLE-EARNINGS THRU P5509-EXIT         14242000
142430             IF AVG-COLL-BAL-CYC (1) GREATER THAN ZEROS           14243000
142440                 COMPUTE WORK-INT-RATE ROUNDED =                  14244000
142450                         MIN-ACCR-INTEREST /                      14245000
142460                         AVG-COLL-BAL-CYC (1) * HOLD-DAYS-IN-YEAR 14246000
142470                 MOVE WORK-INT-RATE TO GROSS-RATE                 14247000
142480                 IF GROSS-RATE-DAYS GREATER THAN ZEROS            14248000
142490                     COMPUTE HOLD-IMM-RATE-WORK =                 14249000
142500                             GROSS-RATE / GROSS-RATE-DAYS         14250000
142510                 ELSE                                             14251000
142520                     MOVE ZEROS TO HOLD-IMM-RATE-WORK             14252000
142530                 END-IF                                           14253000
142540             ELSE                                                 14254000
142550                 MOVE ZEROS             TO GROSS-RATE             14255000
142560                 MOVE ZEROS             TO HOLD-IMM-RATE-WORK     14256000
142570             END-IF                                               14257000
142580             GO TO P5600-SC-RETURN                                14258000
142590         WHEN 6                                                   14259000
142600             GO TO P5540-CC-WITH-INTEREST                         14260000
142610         WHEN 7                                                   14261000
142620             PERFORM P7180-BUILD-SC-CLOSED THRU P7189-EXIT        14262000
142630             ADD .00500 TO ACCRUED-INTEREST                       14263000
142640             MOVE ACCRUED-INTEREST TO HOLD-EARNINGS               14264000
142650             PERFORM P5502-NO-CREDIT THRU P5509-EXIT              14265000
142660             GO TO P5600-SC-RETURN                                14266000
142670         WHEN 8                                                   14267000
142680             GO TO P5560-CC-WITH-INTEREST                         14268000
142690         WHEN OTHER                                               14269000
142700             MOVE 18 TO HOLD-REASON-CODE                          14270000
142710             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT     14271000
142720             MOVE 'N' TO HOLD-DISP                                14272000
142730             MOVE 6 TO HOLD-NC-DISP                               14273000
142740             GO TO P5600-SC-RETURN                                14274000
142750     END-EVALUATE.                                                14275000
142760                                                                  14276000
142770******************************************************************14277000
142780* SUBROUTINE - C Y C L E   E A R N I N G S                       *14278000
142790******************************************************************14279000
142800 P5500-CYCLE-EARNINGS.                                            14280000
142810     MOVE ACCRUED-INTEREST TO HOLD-ACTUAL-ACCR-INT.               14281000
142820     ADD +.00500 TO ACCRUED-INTEREST.                             14282000
142830     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      14283000
142840     IF 942-AMT = ZEROS                                           14284000
142850         NEXT SENTENCE                                            14285000
142860       ELSE                                                       14286000
142870         IF 942-AMT NOT = HOLD-EARNINGS                           14287000
142880             COMPUTE 942-DIFF =                                   14288000
142890                 942-AMT - HOLD-EARNINGS                          14289000
142900             MOVE 942-DIFF TO 942-DIFF-DISPLAY                    14290000
142910             ADD 942-DIFF TO TDY-EXP-BY-IDENT (11)                14291000
142920                             TDY-EXP-BY-IDENT (SUB13)             14292000
142930             MOVE 942-AMT TO ACCRUED-INTEREST                     14293000
142940                             HOLD-EARNINGS.                       14294000
142950     EVALUATE TRUE                                                14295000
142960         WHEN CLOSED                                              14296000
142970             GO TO P5502-NO-CREDIT                                14297000
142980         WHEN ACCRUED-INTEREST LESS THAN BCFSCR-MIN-INT-AMT       14298000
142990             GO TO P5502-NO-CREDIT                                14299000
143000         WHEN ADD-ON                                              14300000
143010             PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT           14301000
143020             MOVE '1' TO HOLD-EARN-DISP                           14302000
143030             GO TO P5504-UPDATE-EARNINGS                          14303000
143040         WHEN CHECK                                               14304000
143050             MOVE 091 TO SUB1                                     14305000
143060             PERFORM P7190-BUILD-CHECK THRU P7199-EXIT            14306000
143070             MOVE '2' TO HOLD-EARN-DISP                           14307000
143080             GO TO P5504-UPDATE-EARNINGS                          14308000
143090         WHEN NO-EARN-CREDIT                                      14309000
143100             GO TO P5502-NO-CREDIT                                14310000
143110         WHEN OTHER                                               14311000
143120             GO TO P5504-UPDATE-EARNINGS                          14312000
143130     END-EVALUATE.                                                14313000
143140                                                                  14314000
143150 P5502-NO-CREDIT.                                                 14315000
143160     MOVE '9' TO HOLD-EARN-DISP.                                  14316000
143170     ADD HOLD-EARNINGS TO TDY-DROP-BY-IDENT (11)                  14317000
143180                          TDY-DROP-BY-IDENT (SUB13).              14318000
143190     MOVE ZEROS TO ACCRUED-INTEREST.                              14319000
143200                                                                  14320000
143210 P5504-UPDATE-EARNINGS.                                           14321000
143220     ADD ACCRUED-INTEREST TO TDY-PAID-BY-IDENT (11)               14322000
143230                             TDY-PAID-BY-IDENT (SUB13)            14323000
143240                             INT-PAID-YTD.                        14324000
143250     ADD HOLD-TAX-WITHHELD TO TDY-WITH-BY-IDENT (11)              14325000
143260                              TDY-WITH-BY-IDENT (SUB13)           14326000
143270                              TAX-WITHHELD-YTD.                   14327000
143280     MOVE INT-PAID-3RD-CYCLE TO INT-PAID-4TH-CYCLE.               14328000
143290     MOVE INT-PAID-2ND-CYCLE TO INT-PAID-3RD-CYCLE.               14329000
143300     MOVE INT-PAID-1ST-CYCLE TO INT-PAID-2ND-CYCLE.               14330000
143310     MOVE ACCRUED-INTEREST TO INT-PAID-LAST-CYCLE                 14331000
143320                              INT-PAID-1ST-CYCLE.                 14332000
143330     MOVE HOLD-TAX-WITHHELD TO TAX-WITHHELD-LAST-CYCLE.           14333000
143340     MOVE ZEROS TO HOLD-APYE-INT-RATE.                            14334000
143350                                                                  14335000
143360 P5506-CALC-APYE.                                                 14336000
143370     IF HOLD-IMM-RATE-WORK = ZERO AND                             14337000
143380        GROSS-RATE GREATER THAN ZERO AND                          14338000
143390        GROSS-RATE-DAYS = 1                                       14339000
143400         MOVE GROSS-RATE TO HOLD-IMM-RATE-WORK.                   14340000
143410     IF HOLD-IMM-AVG-INV-BAL = ZEROS OR                           14341000
143420        HOLD-ACTUAL-ACCR-INT = ZEROS OR                           14342000
143430        TIS-DAYS-CYC = ZEROS                                      14343000
143440         GO TO P5509-EXIT.                                        14344000
143450     COMPUTE HOLD-APYE-INT-RATE =                                 14345000
143460         ((1 + HOLD-ACTUAL-ACCR-INT / HOLD-IMM-AVG-INV-BAL) **    14346000
143470          (HOLD-DAYS-IN-YEAR / TIS-DAYS-CYC) - 1).                14347000
143480     ADD +.000005 TO HOLD-APYE-INT-RATE.                          14348000
143490                                                                  14349000
143500 P5509-EXIT.                                                      14350000
143510     EXIT.                                                        14351000
143520                                                                  14352000
143530******************************************************************14353000
143540*    C H R I S T M A S   C L U B   S A V I N G S                 *14354000
143550******************************************************************14355000
143560 P5510-CC-NO-INTEREST.                                            14356000
143570     IF BANK-CTL-ACCTS                                            14357000
143580         GO TO P5600-SC-RETURN.                                   14358000
143590     IF CURRENT-BALANCE NOT GREATER THAN ZERO                     14359000
143600         GO TO P5600-SC-RETURN.                                   14360000
143610     IF DSDM050P-RETURN-CODE = 'G'                                14361000
143620         PERFORM P5523-CC-TRANSFER     THRU P5523-EXIT            14362000
143630         GO TO P5735-SC-END-3                                     14363000
143640     END-IF.                                                      14364000
143650******* CREATE CLUB CHECK AND DEBIT ACCOUNT **********************14365000
143660     MOVE 095 TO SUB1.                                            14366000
143670     MOVE CURRENT-BALANCE TO HOLD-EARNINGS.                       14367000
143680     PERFORM P7190-BUILD-CHECK THRU P7199-EXIT.                   14368000
143690     MOVE 1 TO DSDSTXL-PENDING-SW.                                14369000
143700     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14370000
143710     MOVE 851 TO DSDSTXL-CODE.                                    14371000
143720     MOVE OSB-DESC-0030-A TO DSDSTXL-CO-DESC.                     14372000
143730     MOVE OSB-DESC-0030-B TO DSDSTXL-DESC.                        14373000
143740     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                14374000
143750     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       14375000
143760     MOVE 'CCC' TO PJ-HOLD-CODE.                                  14376000
143770     MOVE CURRENT-BALANCE TO DSDSTXL-AMOUNT.                      14377000
143780     ADD CURRENT-BALANCE TO BK-CC-CYC-C-BUCKET                    14378000
143790                            GEN-DEBIT-AMT.                        14379000
143800     ADD 1 TO GEN-DEBIT-CNT.                                      14380000
143810     ADD 1 TO NUM-BILL-TX.                                        14381000
143820     PERFORM P1665-NORM-DEBIT.                                    14382000
143830     MOVE ZEROS TO HOLD-SC-PLUS.                                  14383000
143840     MOVE ' ' TO HOLD-DISP.                                       14384000
143850     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14385000
143860     GO TO P5735-SC-END-3.                                        14386000
143870                                                                  14387000
143880******************************************************************14388000
143890**** C T B   -   C H R I S T M A S   C L U B   W/ I N T E R E S T*14389000
143900******************************************************************14390000
143910 P5520-CC-WITH-INTEREST.                                          14391000
143920     IF BANK-CTL-ACCTS                                            14392000
143930         GO TO P5600-SC-RETURN.                                   14393000
143940     IF CURRENT-BALANCE NOT GREATER THAN ZERO AND                 14394000
143950        ACCRUED-INTEREST NOT GREATER THAN ZERO                    14395000
143960         GO TO P5600-SC-RETURN.                                   14396000
143970     IF CURRENT-BALANCE NOT GREATER THAN ZERO                     14397000
143980         MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                   14398000
143990         PERFORM P5502-NO-CREDIT THRU P5509-EXIT                  14399000
144000         GO TO P5600-SC-RETURN.                                   14400000
144010     ADD .00500 TO ACCRUED-INTEREST.                              14401000
144020     IF CURRENT-BALANCE NOT GREATER THAN +4.99                    14402000
144030         MOVE ACCRUED-INTEREST TO HOLD-EARNINGS                   14403000
144040         PERFORM P5502-NO-CREDIT THRU P5509-EXIT                  14404000
144050         GO TO P5521-CONTINUE.                                    14405000
144060     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      14406000
144070     PERFORM P8410-BUILD-INT-TX    THRU P8419-EXIT                14407000
144080     PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT.               14408000
144090 P5521-CONTINUE.                                                  14409000
144100     IF DSDM050P-RETURN-CODE = 'G'                                14410000
144110         PERFORM P5523-CC-TRANSFER     THRU P5523-EXIT            14411000
144120         GO TO P5524-END-CC-WITH-INT                              14412000
144130     END-IF.                                                      14413000
144140                                                                  14414000
144150 P5522-CC-CHECK.                                                  14415000
144160     IF CURRENT-BALANCE = ZERO                                    14416000
144170         GO TO P5524-END-CC-WITH-INT.                             14417000
144180     MOVE 095 TO SUB1.                                            14418000
144190     MOVE 1 TO DSDSTXL-PENDING-SW.                                14419000
144200     MOVE CURRENT-BALANCE TO HOLD-EARNINGS.                       14420000
144210     PERFORM P7190-BUILD-CHECK THRU P7199-EXIT.                   14421000
144220     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14422000
144230     MOVE 851 TO DSDSTXL-CODE.                                    14423000
144240     MOVE OSB-DESC-0030-A TO DSDSTXL-CO-DESC.                     14424000
144250     MOVE OSB-DESC-0030-B TO DSDSTXL-DESC.                        14425000
144260     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                14426000
144270     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       14427000
144280     MOVE 'CCC' TO PJ-HOLD-CODE.                                  14428000
144290     MOVE HOLD-EARNINGS TO DSDSTXL-AMOUNT.                        14429000
144300     ADD HOLD-EARNINGS TO BK-CC-CYC-C-BUCKET                      14430000
144310                          GEN-DEBIT-AMT.                          14431000
144320     ADD 1 TO GEN-DEBIT-CNT                                       14432000
144330              NUM-BILL-TX.                                        14433000
144340     PERFORM P1665-NORM-DEBIT.                                    14434000
144350     MOVE ZEROS TO HOLD-SC-PLUS.                                  14435000
144360     MOVE SPACE TO HOLD-DISP.                                     14436000
144370     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14437000
144380     GO TO P5524-END-CC-WITH-INT.                                 14438000
144390                                                                  14439000
144400 P5523-CC-TRANSFER.                                               14440000
144410     IF CURRENT-BALANCE = ZERO                                    14441000
144420         GO TO P5523-EXIT.                                        14442000
144430     MOVE 1 TO DSDSTXL-PENDING-SW.                                14443000
144440     MOVE CURRENT-BALANCE TO HOLD-EARNINGS.                       14444000
144450     MOVE DSDM050P-RETURN-ACCT-ID  TO HOLD-TRNSF-ACCT-ID.         14445000
144460     MOVE DSDM050P-RETURN-ACCT-NBR TO HOLD-TRNSF-ACCT-NBR.        14446000
144470                                                                  14447000
144480     MOVE DSDM050P-RETURN-BANK      TO PEND-BANK-NBR.             14448000
144490     MOVE DSDM050P-RETURN-ACCT-ID   TO PEND-ACCT-ID.              14449000
144500     MOVE DSDM050P-RETURN-ACCT-NBR  TO PEND-ACCT-NBR.             14450000
144510                                                                  14451000
144520     MOVE 540                       TO PEND-TX-CODE.              14452000
144530     MOVE CURRENT-BALANCE           TO PEND-TX-AMOUNT             14453000
144540     MOVE PROC-NEXT-DATE            TO PEND-EFFECT-DATE.          14454000
144550     MOVE 99913                     TO PEND-BATCH-NBR.            14455000
144560     ADD 1                          TO PEND-SEQUENCE-NBR.         14456000
144570     MOVE 'CHRISTMAS CLUB DEPOSIT'  TO PEND-TX-DESC.              14457000
144580     PERFORM P5527-INSERT-CC-PEND-TX  THRU P5527-EXIT.            14458000
144590     PERFORM P5528-INSERT-CC-FINQ-DEP THRU P5528-EXIT.            14459000
144600                                                                  14460000
144610     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14461000
144620     MOVE 851                 TO DSDSTXL-CODE.                    14462000
144630     MOVE OSB-DESC-0097-A     TO DSDSTXL-CO-DESC.                 14463000
144640     MOVE OSB-DESC-0097-B     TO DSDSTXL-DESC.                    14464000
144650     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                14465000
144660     MOVE PROC-CURR-DATE      TO DSDSTXL-CHK-NO.                  14466000
144670     MOVE 'CCT' TO PJ-HOLD-CODE.                                  14467000
144680     MOVE HOLD-EARNINGS       TO DSDSTXL-AMOUNT.                  14468000
144690     DISPLAY 'PEND     ' PEND-BANK-NBR ' * ' PEND-ACCT-NBR        14469000
144700             ' TRANSFER ' DSDSTXL-AMOUNT                          14470000
144710     ADD HOLD-EARNINGS        TO BK-CC-CYC-T-BUCKET               14471000
144720                                 GEN-DEBIT-AMT.                   14472000
144730     ADD 1 TO GEN-DEBIT-CNT                                       14473000
144740              NUM-BILL-TX.                                        14474000
144750     PERFORM P1665-NORM-DEBIT.                                    14475000
144760     MOVE ZEROS TO HOLD-SC-PLUS.                                  14476000
144770     MOVE SPACE TO HOLD-DISP.                                     14477000
144780     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14478000
144790*** BUILD REPORT RECORD FOR THE TRANSFER                          14479000
144800     MOVE 019 TO SUB1.                                            14480000
144810     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               14481000
144820     IF HOLD-FREQ-RPT = 0                                         14482000
144830         GO TO P5523-EXIT.                                        14483000
144840     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  14484000
144850 P5523-EXIT.                                                      14485000
144860     EXIT.                                                        14486000
144870                                                                  14487000
144880 P5524-END-CC-WITH-INT.                                           14488000
144890     GO TO P5735-SC-END-3.                                        14489000
144900                                                                  14490000
144910 P5527-INSERT-CC-PEND-TX.                                         14491000
144920     MOVE 'DSDS100C'                TO PEND-SOURCE-PROG.          14492000
144930     EXEC SQL                                                     14493000
144940         INSERT INTO DSDS.PEND                                    14494000
144950             (PEND_BANK_NBR,                                      14495000
144960              PEND_ACCT_ID,                                       14496000
144970              PEND_ACCT_NBR,                                      14497000
144980              PEND_TX_CODE,                                       14498000
144990              PEND_TX_AMOUNT,                                     14499000
145000              PEND_EFFECT_DATE,                                   14500000
145010              PEND_BATCH_NBR,                                     14501000
145020              PEND_SEQUENCE_NBR,                                  14502000
145030              PEND_TX_DESC,                                       14503000
145040              PEND_SOURCE_PROG)                                   14504000
145050         VALUES                                                   14505000
145060             (:PEND-BANK-NBR,                                     14506000
145070              :PEND-ACCT-ID,                                      14507000
145080              :PEND-ACCT-NBR,                                     14508000
145090              :PEND-TX-CODE,                                      14509000
145100              :PEND-TX-AMOUNT,                                    14510000
145110              :PEND-EFFECT-DATE,                                  14511000
145120              :PEND-BATCH-NBR,                                    14512000
145130              :PEND-SEQUENCE-NBR,                                 14513000
145140              :PEND-TX-DESC,                                      14514000
145150              :PEND-SOURCE-PROG)                                  14515000
145160     END-EXEC.                                                    14516000
145170     EVALUATE SQLCODE                                             14517000
145180         WHEN ZEROS                                               14518000
145190             CONTINUE                                             14519000
145200         WHEN +100                                                14520000
145210             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      14521000
145220             CALL 'CDCUT90' USING SQLCA                           14522000
145230             CALL 'CDCDUMP' USING BY CONTENT '2061'               14523000
145240         WHEN OTHER                                               14524000
145250             DISPLAY 'PEND INSERT DID NOT WORK' UPON CONSOLE      14525000
145260             CALL 'CDCUT90' USING SQLCA                           14526000
145270             CALL 'CDCDUMP' USING BY CONTENT '2062'               14527000
145280     END-EVALUATE.                                                14528000
145290 P5527-EXIT.                                                      14529000
145300     EXIT.                                                        14530000
145310                                                                  14531000
145320 P5528-INSERT-CC-FINQ-DEP.                                        14532000
145330     MOVE PEND-BANK-NBR            TO DEP-BANK-NBR.               14533000
145340     MOVE PEND-ACCT-ID             TO DEP-ACCT-ID.                14534000
145350     MOVE PEND-ACCT-NBR            TO DEP-ACCT-NBR.               14535000
145360     MOVE 99993                    TO DEP-SOURCE-USER.            14536000
145370     MOVE 'DSDS100C'               TO DEP-SOURCE-PROG.            14537000
145380     MOVE PROC-CURR-DATE           TO DEP-PLACE-DATE.             14538000
145390     MOVE PROC-NEXT-DATE           TO DEP-RELEASE-DATE.           14539000
145400     MOVE PEND-TX-AMOUNT           TO DEP-AMOUNT.                 14540000
145410     MOVE PEND-TX-AMOUNT           TO DEP-AMOUNT-AVAIL.           14541000
145420     MOVE 22                       TO DEP-TX-DESC-LEN             14542000
145430     MOVE 'CHRISTMAS CLUB DEPOSIT' TO DEP-TX-DESC-TEXT            14543000
145440     MOVE 0                        TO DEP-TYPE.                   14544000
145450     EXEC SQL                                                     14545000
145460         INSERT INTO FINQ.DEPOSIT                                 14546000
145470             (DEP_BANK_NBR,                                       14547000
145480              DEP_ACCT_ID,                                        14548000
145490              DEP_ACCT_NBR,                                       14549000
145500              DEP_SOURCE_USER,                                    14550000
145510              DEP_SOURCE_PROG,                                    14551000
145520              DEP_PLACE_DATE,                                     14552000
145530              DEP_RELEASE_DATE,                                   14553000
145540              DEP_AMOUNT,                                         14554000
145550              DEP_AMOUNT_AVAIL,                                   14555000
145560              DEP_LAST_UPDATE,                                    14556000
145570              DEP_TX_DESC,                                        14557000
145580              DEP_TYPE)                                           14558000
145590         VALUES                                                   14559000
145600             (:DEP-BANK-NBR,                                      14560000
145610              :DEP-ACCT-ID,                                       14561000
145620              :DEP-ACCT-NBR,                                      14562000
145630              :DEP-SOURCE-USER,                                   14563000
145640              :DEP-SOURCE-PROG,                                   14564000
145650              :DEP-PLACE-DATE,                                    14565000
145660              :DEP-RELEASE-DATE,                                  14566000
145670              :DEP-AMOUNT,                                        14567000
145680              :DEP-AMOUNT-AVAIL,                                  14568000
145690              CURRENT TIMESTAMP,                                  14569000
145700              :DEP-TX-DESC,                                       14570000
145710              :DEP-TYPE)                                          14571000
145720     END-EXEC.                                                    14572000
145730     EVALUATE SQLCODE                                             14573000
145740         WHEN ZEROS                                               14574000
145750             CONTINUE                                             14575000
145760         WHEN OTHER                                               14576000
145770             CALL 'CDCUT90' USING SQLCA                           14577000
145780             CALL 'CDCDUMP' USING BY CONTENT '2063'               14578000
145790     END-EVALUATE.                                                14579000
145800 P5528-EXIT.                                                      14580000
145810     EXIT.                                                        14581000
145820******************************************************************14582000
145830**** CITY BK -   C H R I S T M A S   C L U B   W/ I N T E R E S T*14583000
145840******************************************************************14584000
145850 P5540-CC-WITH-INTEREST.                                          14585000
145860     IF BANK-CTL-ACCTS                                            14586000
145870         GO TO P5600-SC-RETURN.                                   14587000
145880     IF CURRENT-BALANCE NOT GREATER THAN ZERO AND                 14588000
145890        ACCRUED-INTEREST NOT GREATER THAN ZERO                    14589000
145900         GO TO P5600-SC-RETURN.                                   14590000
145910     ADD .00500 TO ACCRUED-INTEREST.                              14591000
145920     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      14592000
145930     MOVE '2' TO HOLD-EARN-DISP.                                  14593000
145940     PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT.                  14594000
145950     PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT.               14595000
145960     IF DSDM050P-RETURN-CODE = 'G'                                14596000
145970         PERFORM P5523-CC-TRANSFER     THRU P5523-EXIT            14597000
145980         GO TO P5544-END-CC-WITH-INT                              14598000
145990     END-IF.                                                      14599000
146000                                                                  14600000
146010 P5542-CC-CHECK.                                                  14601000
146020     IF CURRENT-BALANCE = ZERO                                    14602000
146030         GO TO P5544-END-CC-WITH-INT.                             14603000
146040     MOVE 095 TO SUB1.                                            14604000
146050     MOVE 1 TO DSDSTXL-PENDING-SW.                                14605000
146060     MOVE CURRENT-BALANCE TO HOLD-EARNINGS.                       14606000
146070     PERFORM P7190-BUILD-CHECK THRU P7199-EXIT.                   14607000
146080     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14608000
146090     MOVE 851 TO DSDSTXL-CODE.                                    14609000
146100     MOVE OSB-DESC-0030-A TO DSDSTXL-CO-DESC.                     14610000
146110     MOVE OSB-DESC-0030-B TO DSDSTXL-DESC.                        14611000
146120     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                14612000
146130     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       14613000
146140     MOVE 'CCC' TO PJ-HOLD-CODE.                                  14614000
146150     MOVE HOLD-EARNINGS TO DSDSTXL-AMOUNT.                        14615000
146160     ADD HOLD-EARNINGS TO BK-CC-CYC-C-BUCKET                      14616000
146170                          GEN-DEBIT-AMT.                          14617000
146180     ADD 1 TO GEN-DEBIT-CNT                                       14618000
146190              NUM-BILL-TX.                                        14619000
146200     PERFORM P1665-NORM-DEBIT.                                    14620000
146210     MOVE ZEROS TO HOLD-SC-PLUS.                                  14621000
146220     MOVE SPACE TO HOLD-DISP.                                     14622000
146230     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14623000
146240                                                                  14624000
146250 P5544-END-CC-WITH-INT.                                           14625000
146260     GO TO P5735-SC-END-3.                                        14626000
146270                                                                  14627000
146280******************************************************************14628000
146290**** C H R I S T M A S   C L U B   W I T H   I N T E R E S T     *14629000
146300******************************************************************14630000
146310 P5560-CC-WITH-INTEREST.                                          14631000
146320     IF BANK-CTL-ACCTS                                            14632000
146330         GO TO P5600-SC-RETURN.                                   14633000
146340     IF CURRENT-BALANCE NOT GREATER THAN ZERO AND                 14634000
146350        ACCRUED-INTEREST NOT GREATER THAN ZERO                    14635000
146360         GO TO P5600-SC-RETURN.                                   14636000
146370     ADD CURRENT-BALANCE                                          14637000
146380         ACCRUED-INTEREST                                         14638000
146390         GIVING HOLD-EARNINGS.                                    14639000
146400     IF HOLD-EARNINGS GREATER THAN +4.99                          14640000
146410         GO TO P5561-CC-INTEREST.                                 14641000
146420     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      14642000
146430     PERFORM P5502-NO-CREDIT THRU P5509-EXIT.                     14643000
146440     GO TO P5562-CC-CHECK.                                        14644000
146450                                                                  14645000
146460 P5561-CC-INTEREST.                                               14646000
146470     ADD .00500 TO ACCRUED-INTEREST.                              14647000
146480     MOVE ACCRUED-INTEREST TO HOLD-EARNINGS.                      14648000
146490     MOVE '2' TO HOLD-EARN-DISP.                                  14649000
146500     PERFORM P8410-BUILD-INT-TX THRU P8419-EXIT.                  14650000
146510     PERFORM P5504-UPDATE-EARNINGS THRU P5509-EXIT.               14651000
146520     IF DSDM050P-RETURN-CODE = 'G'                                14652000
146530         PERFORM P5523-CC-TRANSFER     THRU P5523-EXIT            14653000
146540         GO TO P5564-END-CC-WITH-INT                              14654000
146550     END-IF.                                                      14655000
146560                                                                  14656000
146570 P5562-CC-CHECK.                                                  14657000
146580     IF CURRENT-BALANCE = ZERO                                    14658000
146590         GO TO P5564-END-CC-WITH-INT.                             14659000
146600     MOVE 095 TO SUB1.                                            14660000
146610     MOVE 1 TO DSDSTXL-PENDING-SW.                                14661000
146620     MOVE CURRENT-BALANCE TO HOLD-EARNINGS.                       14662000
146630     PERFORM P7190-BUILD-CHECK THRU P7199-EXIT.                   14663000
146640     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14664000
146650     MOVE 851 TO DSDSTXL-CODE.                                    14665000
146660     MOVE OSB-DESC-0030-A TO DSDSTXL-CO-DESC.                     14666000
146670     MOVE OSB-DESC-0030-B TO DSDSTXL-DESC.                        14667000
146680     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                14668000
146690     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       14669000
146700     MOVE 'CCC' TO PJ-HOLD-CODE.                                  14670000
146710     MOVE HOLD-EARNINGS TO DSDSTXL-AMOUNT.                        14671000
146720     ADD HOLD-EARNINGS TO BK-CC-CYC-C-BUCKET                      14672000
146730                          GEN-DEBIT-AMT.                          14673000
146740     ADD 1 TO GEN-DEBIT-CNT                                       14674000
146750              NUM-BILL-TX.                                        14675000
146760     PERFORM P1665-NORM-DEBIT.                                    14676000
146770     MOVE ZEROS TO HOLD-SC-PLUS.                                  14677000
146780     MOVE SPACE TO HOLD-DISP.                                     14678000
146790     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14679000
146800                                                                  14680000
146810 P5564-END-CC-WITH-INT.                                           14681000
146820     GO TO P5735-SC-END-3.                                        14682000
146830                                                                  14683000
146840******************************************************************14684000
146850*            E N D  O F  S E R V I C E  C H A R G E              *14685000
146860******************************************************************14686000
146870 P5600-SC-RETURN.                                                 14687000
146880                                                                  14688000
146890     IF CLOSED                                                    14689000
146900         COMPUTE FOR-ATM-FEE-DROPPED =                            14690000
146910             FOR-ATM-FEE-DROPPED +                                14691000
146920             (NUM-FOR-ATM-SC-DEBITS * +1)                         14692000
146930         GO TO P5640-REG-SC.                                      14693000
146940                                                                  14694000
146950******************************************************************14695000
146960*  IF AN ACCOUNT HAS ACCOUNT ANALYSIS (REGARDLESS OF SC ROUTINE) *14696000
146970*      - AND RECEIVES A PAPER STATEMENT - TX CODE 478 WITH AN    *14697000
146980*            ITEM COUNT OF 1 WILL BE SENT TO AA                  *14698000
146990*      - AND RECEIVES A IMAGE STATEMENT - TX CODE 479 WITH AN    *14699000
147000*            ITEM COUNT OF 1 WILL BE SENT TO AA                  *14700000
147010*      - ZEROS WILL BE MOVED TO HOLD-IMAGE-STMT-FEE              *14701000
147020*                           AND HOLD-PAPER-STATEMENT-FEE         *14702000
147030*        SO THAT EXTERNAL SERVICE CHARGE TRANSACTIONS ARE NOT    *14703000
147040*        GENERATED ALSO FOR THESE ACCOUNTS                       *14704000
147050******************************************************************14705000
147060     IF ACCT-ANAL-ACCT-IND = 'Y'                                  14706000
147070         MOVE ZEROS                   TO HOLD-IMAGE-STMT-FEE      14707000
147080         MOVE ZEROS                   TO HOLD-PAPER-STATEMENT-FEE 14708000
147090     END-IF.                                                      14709000
147100                                                                  14710000
147110     IF CYCLE-THIS-STMT = 1                                       14711000
147120         CONTINUE                                                 14712000
147130     ELSE                                                         14713000
147140         GO TO P5602-CONTINUE                                     14714000
147150     END-IF.                                                      14715000
147160                                                                  14716000
147170     IF ACCT-ANAL-ACCT-IND = 'Y'                                  14717000
147180         MOVE SPACES                  TO AA-FILEREC               14718000
147190         MOVE 01                      TO AA-INSYSTEM              14719000
147200         MOVE PROC-BK-NO              TO AA-BKNBR                 14720000
147210         MOVE 01                      TO AA-APPL                  14721000
147220         MOVE ACCOUNT-NUMBER          TO AA-ACCOUNT               14722000
147230         MOVE 01                      TO AA-RECCODE               14723000
147240         INITIALIZE                      AA-TRANSACTION           14724000
147250         MOVE PROC-CURR-DATE          TO AA-TRPROCDT              14725000
147260                                         AA-TREFFDT               14726000
147270         IF STMT-IMAGED                                           14727000
147280             MOVE 479                 TO AA-TREXTC                14728000
147290                                         AA-TRITC                 14729000
147300             MOVE 1                   TO AA-TRITEMCT              14730000
147310             WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC               14731000
147320         END-IF                                                   14732000
147330         IF DTE-LAST-CYCLE-STMT = ZEROS                           14733000
147340             CONTINUE                                             14734000
147350         ELSE                                                     14735000
147360             IF HOLD-ESI-PAPER  = 'Y'                             14736000
147370                 MOVE 478                 TO AA-TREXTC            14737000
147380                                             AA-TRITC             14738000
147390                 MOVE 1                   TO AA-TRITEMCT          14739000
147400                 WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC           14740000
147410             END-IF                                               14741000
147420         END-IF                                                   14742000
147430     END-IF.                                                      14743000
147440                                                                  14744000
147450 P5602-CONTINUE.                                                  14745000
147460     IF HOLD-FOR-ATM-FEE-REFUND     = ZEROS AND                   14746000
147470        HOLD-CHECK-HANDLING-FEE     = ZEROS AND                   14747000
147480        HOLD-IMAGE-STMT-FEE         = ZEROS AND                   14748000
147490        HOLD-CHECK-HANDLING-FEE-HC  = ZEROS AND                   14749000
147500        HOLD-CHECK-IMAGING-FEE-HC   = ZEROS AND                   14750000
147510        HOLD-NON-SAFEKEEP-FEE-HC    = ZEROS AND                   14751000
147520        HOLD-MEMBERSHIP-FEE         = ZEROS AND                   14752000
147530        HOLD-STMT-ENCL-ITEM-FEE     = ZEROS AND                   14753000
147540        HOLD-DORMANT-FEE-HC         = ZEROS AND                   14754000
147550        HOLD-INACTIVE-FEE-HC        = ZEROS AND                   14755000
147560        HOLD-LOST-CONTACT-FEE-HC    = ZEROS AND                   14756000
147570        HOLD-PLUS-PACKAGE-FEE       = ZEROS AND                   14757000
147580        HOLD-2SIGN-VERIFICATION-FEE = ZEROS AND                   14758000
147590        HOLD-EXCESS-DEBIT-FEE-HC    = ZEROS AND                   14759000
147600        HOLD-PAPER-STATEMENT-FEE    = ZEROS                       14760000
147610         GO TO P5640-REG-SC.                                      14761000
147620     MOVE 1 TO DSDSTXL-PENDING-SW.                                14762000
147630     ADD 1 TO NUM-BILL-TX.                                        14763000
147640     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     14764000
147650     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       14765000
147660     IF HOLD-FOR-ATM-FEE-REFUND GREATER THAN ZEROS                14766000
147670         MOVE 547 TO DSDSTXL-CODE                                 14767000
147680         MOVE 'AFR' TO PJ-HOLD-CODE                               14768000
147690         MOVE HOLD-FOR-ATM-FEE-REFUND TO DSDSTXL-AMOUNT           14769000
147700         MOVE OSB-DESC-0078-A TO DSDSTXL-CO-DESC                  14770000
147710         MOVE OSB-DESC-0078-B TO DSDSTXL-DESC                     14771000
147720         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14772000
147730         ADD DSDSTXL-AMOUNT TO GEN-CREDIT-AMT                     14773000
147740                               FOREIGN-ATM-FEES-REFUND            14774000
147750         ADD 1 TO GEN-CREDIT-CNT                                  14775000
147760         PERFORM P1325-NORM-CR-2.                                 14776000
147770     IF HOLD-CHECK-HANDLING-FEE GREATER THAN ZEROS                14777000
147780         MOVE HOLD-CHECK-HANDLING-FEE TO DSDSTXL-AMOUNT           14778000
147790         MOVE 151 TO DSDSTXL-CODE                                 14779000
147800         MOVE 151 TO HOLD-TX-CODE-IN                              14780000
147810         PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.         14781000
147820     IF HOLD-IMAGE-STMT-FEE GREATER THAN ZEROS                    14782000
147830         MOVE HOLD-IMAGE-STMT-FEE TO DSDSTXL-AMOUNT               14783000
147840         MOVE 160 TO DSDSTXL-CODE                                 14784000
147850         MOVE 160 TO HOLD-TX-CODE-IN                              14785000
147860         PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.         14786000
147870     IF HOLD-CHECK-HANDLING-FEE-HC GREATER THAN ZEROS             14787000
147880         MOVE 789 TO DSDSTXL-CODE                                 14788000
147890         MOVE 'CHF' TO PJ-HOLD-CODE                               14789000
147900         MOVE HOLD-CHECK-HANDLING-FEE-HC TO DSDSTXL-AMOUNT        14790000
147910         MOVE OSB-DESC-0083-A TO DSDSTXL-CO-DESC                  14791000
147920         MOVE OSB-DESC-0083-B TO DSDSTXL-DESC                     14792000
147930         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14793000
147940         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14794000
147950         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14795000
147960                               CHECK-HANDLING-FEES-HC             14796000
147970         ADD 1 TO GEN-DEBIT-CNT                                   14797000
147980         PERFORM P1665-NORM-DEBIT.                                14798000
147990     IF HOLD-CHECK-IMAGING-FEE-HC GREATER THAN ZEROS              14799000
148000         MOVE 789 TO DSDSTXL-CODE                                 14800000
148010         MOVE 'CIM' TO PJ-HOLD-CODE                               14801000
148020         MOVE HOLD-CHECK-IMAGING-FEE-HC TO DSDSTXL-AMOUNT         14802000
148030         MOVE OSB-DESC-0076-A TO DSDSTXL-CO-DESC                  14803000
148040         MOVE OSB-DESC-0076-B TO DSDSTXL-DESC                     14804000
148050         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14805000
148060         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14806000
148070         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14807000
148080                               CHECK-IMAGING-FEES-HC              14808000
148090         ADD 1 TO GEN-DEBIT-CNT                                   14809000
148100         PERFORM P1665-NORM-DEBIT.                                14810000
148110     IF HOLD-NON-SAFEKEEP-FEE-HC GREATER THAN ZEROS               14811000
148120         MOVE 789 TO DSDSTXL-CODE                                 14812000
148130         MOVE 'NSK' TO PJ-HOLD-CODE                               14813000
148140         MOVE HOLD-NON-SAFEKEEP-FEE-HC TO DSDSTXL-AMOUNT          14814000
148150         MOVE OSB-DESC-0075-A TO DSDSTXL-CO-DESC                  14815000
148160         MOVE OSB-DESC-0075-B TO DSDSTXL-DESC                     14816000
148170         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14817000
148180         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14818000
148190         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14819000
148200                               NON-SAFEKEEP-FEES-HC               14820000
148210         ADD 1 TO GEN-DEBIT-CNT                                   14821000
148220         PERFORM P1665-NORM-DEBIT.                                14822000
148230     IF HOLD-MEMBERSHIP-FEE GREATER THAN ZEROS                    14823000
148240         MOVE 789 TO DSDSTXL-CODE                                 14824000
148250         MOVE 'MSF' TO PJ-HOLD-CODE                               14825000
148260         MOVE HOLD-MEMBERSHIP-FEE TO DSDSTXL-AMOUNT               14826000
148270         MOVE OSB-DESC-0086-A TO DSDSTXL-CO-DESC                  14827000
148280         MOVE OSB-DESC-0086-B TO DSDSTXL-DESC                     14828000
148290         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14829000
148300         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14830000
148310         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14831000
148320                               MEMBERSHIP-FEES                    14832000
148330         ADD 1 TO GEN-DEBIT-CNT                                   14833000
148340         PERFORM P1665-NORM-DEBIT.                                14834000
148350     IF HOLD-STMT-ENCL-ITEM-FEE GREATER THAN ZEROS                14835000
148360         MOVE HOLD-STMT-ENCL-ITEM-FEE TO DSDSTXL-AMOUNT           14836000
148370         MOVE 162 TO DSDSTXL-CODE                                 14837000
148380         MOVE 162 TO HOLD-TX-CODE-IN                              14838000
148390         PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.         14839000
148400     IF HOLD-DORMANT-FEE-HC GREATER THAN ZEROS                    14840000
148410         MOVE 789 TO DSDSTXL-CODE                                 14841000
148420         MOVE 'D-F' TO PJ-HOLD-CODE                               14842000
148430         MOVE HOLD-DORMANT-FEE-HC TO DSDSTXL-AMOUNT               14843000
148440         MOVE OSB-DESC-0088-A TO DSDSTXL-CO-DESC                  14844000
148450         MOVE OSB-DESC-0088-B TO DSDSTXL-DESC                     14845000
148460         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14846000
148470         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14847000
148480         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14848000
148490                               DORMANT-INACT-LOST-FEES            14849000
148500         ADD 1 TO GEN-DEBIT-CNT                                   14850000
148510         PERFORM P1665-NORM-DEBIT.                                14851000
148520     IF HOLD-INACTIVE-FEE-HC GREATER THAN ZEROS                   14852000
148530         MOVE 789 TO DSDSTXL-CODE                                 14853000
148540         MOVE 'I-F' TO PJ-HOLD-CODE                               14854000
148550         MOVE HOLD-INACTIVE-FEE-HC TO DSDSTXL-AMOUNT              14855000
148560         MOVE OSB-DESC-0089-A TO DSDSTXL-CO-DESC                  14856000
148570         MOVE OSB-DESC-0089-B TO DSDSTXL-DESC                     14857000
148580         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14858000
148590         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14859000
148600         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14860000
148610                               DORMANT-INACT-LOST-FEES            14861000
148620         ADD 1 TO GEN-DEBIT-CNT                                   14862000
148630         PERFORM P1665-NORM-DEBIT.                                14863000
148640     IF HOLD-LOST-CONTACT-FEE-HC GREATER THAN ZEROS               14864000
148650         MOVE 789 TO DSDSTXL-CODE                                 14865000
148660         MOVE 'LCF' TO PJ-HOLD-CODE                               14866000
148670         MOVE HOLD-LOST-CONTACT-FEE-HC TO DSDSTXL-AMOUNT          14867000
148680         MOVE OSB-DESC-0084-A TO DSDSTXL-CO-DESC                  14868000
148690         MOVE OSB-DESC-0084-B TO DSDSTXL-DESC                     14869000
148700         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14870000
148710         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14871000
148720         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14872000
148730                               DORMANT-INACT-LOST-FEES            14873000
148740         ADD 1 TO GEN-DEBIT-CNT                                   14874000
148750         PERFORM P1665-NORM-DEBIT.                                14875000
148760     IF HOLD-PLUS-PACKAGE-FEE GREATER THAN ZEROS                  14876000
148770         MOVE 789 TO DSDSTXL-CODE                                 14877000
148780         MOVE 'PPF' TO PJ-HOLD-CODE                               14878000
148790         MOVE HOLD-PLUS-PACKAGE-FEE TO DSDSTXL-AMOUNT             14879000
148800         MOVE OSB-DESC-0090-A TO DSDSTXL-CO-DESC                  14880000
148810         MOVE OSB-DESC-0090-B TO DSDSTXL-DESC                     14881000
148820         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14882000
148830         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14883000
148840         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14884000
148850                               PLUS-PACKAGE-FEES                  14885000
148860         ADD 1 TO GEN-DEBIT-CNT                                   14886000
148870         PERFORM P1665-NORM-DEBIT.                                14887000
148880     IF HOLD-2SIGN-VERIFICATION-FEE GREATER THAN ZEROS            14888000
148890         MOVE HOLD-2SIGN-VERIFICATION-FEE TO DSDSTXL-AMOUNT       14889000
148900         MOVE ITEM-COUNT-2SIG-REQ         TO DSDSTXL-ITEM-COUNT   14890000
148910         MOVE 177 TO DSDSTXL-CODE                                 14891000
148920         MOVE 177 TO HOLD-TX-CODE-IN                              14892000
148930         PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.         14893000
148940     IF HOLD-EXCESS-DEBIT-FEE-HC GREATER THAN ZERO                14894000
148950         MOVE 789 TO DSDSTXL-CODE                                 14895000
148960         MOVE HOLD-EXCESS-DEBIT-FEE-HC TO DSDSTXL-AMOUNT          14896000
148970         MOVE OSB-DESC-0033-A TO DSDSTXL-CO-DESC                  14897000
148980         MOVE OSB-DESC-0033-B TO DSDSTXL-DESC                     14898000
148990         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  14899000
149000         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          14900000
149010         PERFORM P1665-NORM-DEBIT                                 14901000
149020         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      14902000
149030                               SC-FEE-BY-SC (SUB5)                14903000
149040                               CURR-MO-SERV-CHRG                  14904000
149050         ADD 1 TO GEN-DEBIT-CNT.                                  14905000
149060     IF HOLD-PAPER-STATEMENT-FEE GREATER THAN ZEROS               14906000
149070         MOVE HOLD-PAPER-STATEMENT-FEE TO DSDSTXL-AMOUNT          14907000
149080         MOVE 184 TO DSDSTXL-CODE                                 14908000
149090         MOVE 184 TO HOLD-TX-CODE-IN                              14909000
149100         PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.         14910000
149110     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 14911000
149120     GO TO P5640-REG-SC.                                          14912000
149130                                                                  14913000
149140 P5640-REG-SC.                                                    14914000
149150     IF NUM-CYCLES-TO-WAIVE-SC GREATER THAN ZERO                  14915000
149160         SUBTRACT 1 FROM NUM-CYCLES-TO-WAIVE-SC                   14916000
149170         MOVE 08 TO HOLD-REASON-CODE                              14917000
149180         PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT         14918000
149190         MOVE 'W' TO HOLD-DISP.                                   14919000
149200     IF PERSONAL                                                  14920000
149210         MOVE ZEROS TO EXT-SERV-CHG-AMT                           14921000
149220                       HOLD-SC-EARN                               14922000
149230       ELSE                                                       14923000
149240         ADD EXT-SERV-CHG-AMT TO HOLD-CHARGES.                    14924000
149250     MOVE HOLD-CHARGES TO HOLD-PEG-SC-AMT.                        14925000
149260     SUBTRACT HOLD-CHARGES FROM HOLD-SC-EARN GIVING HOLD-SC-AMT.  14926000
149270     IF HOLD-SC-AMT LESS THAN ZERO                                14927000
149280         NEXT SENTENCE                                            14928000
149290       ELSE                                                       14929000
149300         MOVE ZEROS TO HOLD-SC-PLUS                               14930000
149310         MOVE 'P' TO HOLD-DISP                                    14931000
149320         GO TO P5730-SC-END-2.                                    14932000
149330     SUBTRACT HOLD-SC-AMT FROM 0 GIVING HOLD-SC-PLUS.             14933000
149340                                                                  14934000
149350 P5650-CONT.                                                      14935000
149360     IF SC-CLOSED-SW = 1                                          14936000
149370         GO TO P5670-SC-END-CONT.                                 14937000
149380     IF DORMANT OR INACTIVE OR DORMANT-DECEASED                   14938000
149390         IF SC-DISP-EXEMPT                                        14939000
149400             GO TO P5660-SC-EXEMPT                                14940000
149410           ELSE                                                   14941000
149420             GO TO P5670-SC-END-CONT.                             14942000
149430     IF SC-DISP-EXEMPT                                            14943000
149440         GO TO P5660-SC-EXEMPT.                                   14944000
149450     GO TO P5670-SC-END-CONT.                                     14945000
149460                                                                  14946000
149470 P5660-SC-EXEMPT.                                                 14947000
149480     IF HOLD-DISP = 'N'                                           14948000
149490         GO TO P5730-SC-END-2.                                    14949000
149500     IF BANK-EMPLOYEE                                             14950000
149510         MOVE 'N' TO HOLD-DISP                                    14951000
149520         MOVE 4 TO HOLD-NC-DISP                                   14952000
149530         GO TO P5730-SC-END-2.                                    14953000
149540     MOVE 'W' TO HOLD-DISP.                                       14954000
149550                                                                  14955000
149560 P5670-SC-END-CONT.                                               14956000
149570     IF HOLD-DISP = 'B'                                           14957000
149580         MOVE 'C' TO HOLD-DISP                                    14958000
149590         GO TO P5680-NO-WV-SAV.                                   14959000
149600**** DO NOT WAIVE SERVICE CHARGE THE FIRST TIME ACCOUNT CYCLES FOR14960000
149610**** PREPAID CARDS.                                               14961000
149620     IF DTE-LAST-CYCLE-STMT = ZERO                                14962000
149630         IF BCFSCR-PREPAID-CARD                                   14963000
149640             CONTINUE                                             14964000
149650         ELSE                                                     14965000
149660             MOVE 'W' TO HOLD-DISP                                14966000
149670             GO TO P5730-SC-END-2                                 14967000
149680         END-IF                                                   14968000
149690     END-IF.                                                      14969000
149700                                                                  14970000
149710 P5680-NO-WV-SAV.                                                 14971000
149720     IF HOLD-DISP = 'C'                                           14972000
149730         NEXT SENTENCE                                            14973000
149740       ELSE                                                       14974000
149750         GO TO P5730-SC-END-2.                                    14975000
149760     IF SC-CLOSED-SW = 1                                          14976000
149770         GO TO P5690-CREATE-SC-TX.                                14977000
149780     IF CLOSED                                                    14978000
149790         MOVE 'N' TO HOLD-DISP                                    14979000
149800         MOVE 5 TO HOLD-NC-DISP                                   14980000
149810         GO TO P5730-SC-END-2.                                    14981000
149820     IF HOLD-SC-AMT NOT LESS THAN ZERO                            14982000
149830         GO TO P5730-SC-END-2.                                    14983000
149840     IF SC-DISP-ANALYSIS OR SC-DISP-BID                           14984000
149850         MOVE 'A' TO HOLD-DISP                                    14985000
149860         GO TO P5730-SC-END-2.                                    14986000
149870     IF OD-WITH-SC                                                14987000
149880         GO TO P5690-CREATE-SC-TX.                                14988000
149890     IF HOLD-SC-PLUS GREATER THAN CURRENT-BALANCE                 14989000
149900         MOVE 'N' TO HOLD-DISP                                    14990000
149910         MOVE 1 TO HOLD-NC-DISP                                   14991000
149920         GO TO P5730-SC-END-2.                                    14992000
149930                                                                  14993000
149940******************************************************************14994000
149950*    C R E A T E  S E R V I C E  C H A R G E - T X  7 9 0        *14995000
149960******************************************************************14996000
149970 P5690-CREATE-SC-TX.                                              14997000
149980     IF ACCT-ANAL-BANK                                            14998000
149990         IF ACCT-ANAL-ACCT-IND = 'Y'                              14999000
150000             GO TO P5730-SC-END-2.                                15000000
150010     IF PERSONAL                                                  15001000
150020         GO TO P5700-CREATE-SC-TX-PERS.                           15002000
150030     MOVE 1 TO DSDSTXL-PENDING-SW.                                15003000
150040     ADD 1 TO NUM-BILL-TX.                                        15004000
150050     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     15005000
150060     MOVE 'S-C' TO PJ-HOLD-CODE.                                  15006000
150070     MOVE 789 TO DSDSTXL-CODE.                                    15007000
150080     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       15008000
150090     MOVE HOLD-SC-PLUS TO DSDSTXL-AMOUNT.                         15009000
150100     MOVE OSB-DESC-0034-A TO DSDSTXL-CO-DESC.                     15010000
150110     MOVE OSB-DESC-0034-B TO DSDSTXL-DESC.                        15011000
150120     MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY.                     15012000
150130     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             15013000
150140     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                          15014000
150150                           SC-FEE-BY-SC (SUB5)                    15015000
150160                           CURR-MO-SERV-CHRG.                     15016000
150170     ADD 1 TO GEN-DEBIT-CNT.                                      15017000
150180     PERFORM P1665-NORM-DEBIT.                                    15018000
150190     GO TO P5725-SC-END-1.                                        15019000
150200                                                                  15020000
150210 P5700-CREATE-SC-TX-PERS.                                         15021000
150220     MOVE 1 TO DSDSTXL-PENDING-SW.                                15022000
150230     ADD 1 TO NUM-BILL-TX.                                        15023000
150240     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     15024000
150250     MOVE 'S-C' TO PJ-HOLD-CODE.                                  15025000
150260     MOVE 789 TO DSDSTXL-CODE.                                    15026000
150270     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       15027000
150280     ADD HOLD-MAINT-FEE                                           15028000
150290         HOLD-DEBIT-CHG                                           15029000
150300         HOLD-CREDIT-CHG                                          15030000
150310         HOLD-ITEM-CHG                                            15031000
150320         HOLD-ADDL-MIN-FEE                                        15032000
150330         HOLD-NON-SAFEKEEP-FEE                                    15033000
150340         HOLD-IMAGE-FEE                                           15034000
150350         HOLD-ACH-DEB-FEE                                         15035000
150360         HOLD-FT-DEB-FEE                                          15036000
150370         HOLD-INFOLINE-DEB-FEE                                    15037000
150380         HOLD-ATM-DEB-FEE                                         15038000
150390         HOLD-POS-DEB-FEE                                         15039000
150400         HOLD-TELE-DEB-FEE                                        15040000
150410         HOLD-ANNUAL-FEE                                          15041000
150420         HOLD-CARD-FEE                                            15042000
150430         HOLD-LOST-CONTACT-FEE                                    15043000
150440         GIVING TEMP-SC-WK.                                       15044000
150450     IF TEMP-SC-WK = HOLD-SC-PLUS                                 15045000
150460         NEXT SENTENCE                                            15046000
150470       ELSE                                                       15047000
150480         MOVE HOLD-SC-PLUS TO HOLD-MAINT-FEE                      15048000
150490         MOVE ZEROS TO HOLD-DEBIT-CHG                             15049000
150500                       HOLD-CREDIT-CHG                            15050000
150510                       HOLD-ITEM-CHG                              15051000
150520                       HOLD-ADDL-MIN-FEE                          15052000
150530                       HOLD-NON-SAFEKEEP-FEE                      15053000
150540                       HOLD-IMAGE-FEE                             15054000
150550                       HOLD-ACH-DEB-FEE                           15055000
150560                       HOLD-FT-DEB-FEE                            15056000
150570                       HOLD-INFOLINE-DEB-FEE                      15057000
150580                       HOLD-ATM-DEB-FEE                           15058000
150590                       HOLD-POS-DEB-FEE                           15059000
150600                       HOLD-TELE-DEB-FEE                          15060000
150610                       HOLD-ANNUAL-FEE                            15061000
150620                       HOLD-CARD-FEE                              15062000
150630                       HOLD-LOST-CONTACT-FEE.                     15063000
150640     IF HOLD-MAINT-FEE GREATER THAN ZERO                          15064000
150650         MOVE HOLD-MAINT-FEE TO DSDSTXL-AMOUNT                    15065000
150660         IF BCFSCR-PREPAID-CARD                                   15066000
150670             MOVE OSB-DESC-0099-A TO DSDSTXL-CO-DESC              15067000
150680             MOVE OSB-DESC-0099-B TO DSDSTXL-DESC                 15068000
150690         ELSE                                                     15069000
150700             MOVE OSB-DESC-0063-A TO DSDSTXL-CO-DESC              15070000
150710             MOVE OSB-DESC-0063-B TO DSDSTXL-DESC                 15071000
150720         END-IF                                                   15072000
150730         IF SC-ROUTINE = 65 OR 66                                 15073000
150740             MOVE OSB-DESC-0104-A TO DSDSTXL-CO-DESC              15074000
150750             MOVE OSB-DESC-0104-B TO DSDSTXL-DESC                 15075000
150760         END-IF                                                   15076000
150770         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15077000
150780         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15078000
150790         PERFORM P1665-NORM-DEBIT                                 15079000
150800         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15080000
150810                               SC-FEE-BY-SC (SUB5)                15081000
150820                               CURR-MO-SERV-CHRG                  15082000
150830         ADD 1 TO GEN-DEBIT-CNT.                                  15083000
150840     IF HOLD-DEBIT-CHG GREATER THAN ZERO                          15084000
150850         MOVE HOLD-DEBIT-CHG TO DSDSTXL-AMOUNT                    15085000
150860         MOVE OSB-DESC-0064-A TO DSDSTXL-CO-DESC                  15086000
150870         MOVE OSB-DESC-0064-B TO DSDSTXL-DESC                     15087000
150880         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15088000
150890         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15089000
150900         PERFORM P1665-NORM-DEBIT                                 15090000
150910         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15091000
150920                               SC-FEE-BY-SC (SUB5)                15092000
150930                               CURR-MO-SERV-CHRG                  15093000
150940         ADD 1 TO GEN-DEBIT-CNT.                                  15094000
150950     IF HOLD-CREDIT-CHG GREATER THAN ZERO                         15095000
150960         MOVE HOLD-CREDIT-CHG TO DSDSTXL-AMOUNT                   15096000
150970         MOVE OSB-DESC-0065-A TO DSDSTXL-CO-DESC                  15097000
150980         MOVE OSB-DESC-0065-B TO DSDSTXL-DESC                     15098000
150990         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15099000
151000         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15100000
151010         PERFORM P1665-NORM-DEBIT                                 15101000
151020         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15102000
151030                               SC-FEE-BY-SC (SUB5)                15103000
151040                               CURR-MO-SERV-CHRG                  15104000
151050         ADD 1 TO GEN-DEBIT-CNT.                                  15105000
151060     IF HOLD-ITEM-CHG GREATER THAN ZERO                           15106000
151070         MOVE HOLD-ITEM-CHG TO DSDSTXL-AMOUNT                     15107000
151080         MOVE OSB-DESC-0066-A TO DSDSTXL-CO-DESC                  15108000
151090         MOVE OSB-DESC-0066-B TO DSDSTXL-DESC                     15109000
151100         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15110000
151110         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15111000
151120         PERFORM P1665-NORM-DEBIT                                 15112000
151130         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15113000
151140                               SC-FEE-BY-SC (SUB5)                15114000
151150                               CURR-MO-SERV-CHRG                  15115000
151160         ADD 1 TO GEN-DEBIT-CNT.                                  15116000
151170     IF HOLD-ADDL-MIN-FEE GREATER THAN ZERO                       15117000
151180         MOVE HOLD-ADDL-MIN-FEE TO DSDSTXL-AMOUNT                 15118000
151190         MOVE OSB-DESC-0067-A TO DSDSTXL-CO-DESC                  15119000
151200         MOVE OSB-DESC-0067-B TO DSDSTXL-DESC                     15120000
151210         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15121000
151220         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15122000
151230         PERFORM P1665-NORM-DEBIT                                 15123000
151240         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15124000
151250                               SC-FEE-BY-SC (SUB5)                15125000
151260                               CURR-MO-SERV-CHRG                  15126000
151270         ADD 1 TO GEN-DEBIT-CNT.                                  15127000
151280     IF HOLD-NON-SAFEKEEP-FEE GREATER THAN ZERO                   15128000
151290         MOVE HOLD-NON-SAFEKEEP-FEE TO DSDSTXL-AMOUNT             15129000
151300         MOVE OSB-DESC-0075-A TO DSDSTXL-CO-DESC                  15130000
151310         MOVE OSB-DESC-0075-B TO DSDSTXL-DESC                     15131000
151320         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15132000
151330         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15133000
151340         PERFORM P1665-NORM-DEBIT                                 15134000
151350         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15135000
151360                               SC-FEE-BY-SC (SUB5)                15136000
151370                               CURR-MO-SERV-CHRG                  15137000
151380         ADD 1 TO GEN-DEBIT-CNT.                                  15138000
151390     IF HOLD-IMAGE-FEE GREATER THAN ZERO                          15139000
151400         MOVE HOLD-IMAGE-FEE TO DSDSTXL-AMOUNT                    15140000
151410         MOVE OSB-DESC-0076-A TO DSDSTXL-CO-DESC                  15141000
151420         MOVE OSB-DESC-0076-B TO DSDSTXL-DESC                     15142000
151430         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15143000
151440         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15144000
151450         PERFORM P1665-NORM-DEBIT                                 15145000
151460         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15146000
151470                               SC-FEE-BY-SC (SUB5)                15147000
151480                               CURR-MO-SERV-CHRG                  15148000
151490         ADD 1 TO GEN-DEBIT-CNT.                                  15149000
151500     IF HOLD-ACH-DEB-FEE GREATER THAN ZERO                        15150000
151510         MOVE HOLD-ACH-DEB-FEE TO DSDSTXL-AMOUNT                  15151000
151520         MOVE OSB-DESC-0069-A TO DSDSTXL-CO-DESC                  15152000
151530         MOVE OSB-DESC-0069-B TO DSDSTXL-DESC                     15153000
151540         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15154000
151550         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15155000
151560         PERFORM P1665-NORM-DEBIT                                 15156000
151570         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15157000
151580                               SC-FEE-BY-SC (SUB5)                15158000
151590                               CURR-MO-SERV-CHRG                  15159000
151600         ADD 1 TO GEN-DEBIT-CNT.                                  15160000
151610     IF HOLD-FT-DEB-FEE GREATER THAN ZERO                         15161000
151620         MOVE HOLD-FT-DEB-FEE TO DSDSTXL-AMOUNT                   15162000
151630         MOVE OSB-DESC-0070-A TO DSDSTXL-CO-DESC                  15163000
151640         MOVE OSB-DESC-0070-B TO DSDSTXL-DESC                     15164000
151650         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15165000
151660         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15166000
151670         PERFORM P1665-NORM-DEBIT                                 15167000
151680         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15168000
151690                               SC-FEE-BY-SC (SUB5)                15169000
151700                               CURR-MO-SERV-CHRG                  15170000
151710         ADD 1 TO GEN-DEBIT-CNT.                                  15171000
151720     IF HOLD-INFOLINE-DEB-FEE GREATER THAN ZERO                   15172000
151730         MOVE HOLD-INFOLINE-DEB-FEE TO DSDSTXL-AMOUNT             15173000
151740         MOVE OSB-DESC-0071-A TO DSDSTXL-CO-DESC                  15174000
151750         MOVE OSB-DESC-0071-B TO DSDSTXL-DESC                     15175000
151760         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15176000
151770         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15177000
151780         PERFORM P1665-NORM-DEBIT                                 15178000
151790         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15179000
151800                               SC-FEE-BY-SC (SUB5)                15180000
151810                               CURR-MO-SERV-CHRG                  15181000
151820         ADD 1 TO GEN-DEBIT-CNT.                                  15182000
151830     IF HOLD-ATM-DEB-FEE GREATER THAN ZERO                        15183000
151840         MOVE HOLD-ATM-DEB-FEE TO DSDSTXL-AMOUNT                  15184000
151850         MOVE OSB-DESC-0072-A TO DSDSTXL-CO-DESC                  15185000
151860         MOVE OSB-DESC-0072-B TO DSDSTXL-DESC                     15186000
151870         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15187000
151880         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15188000
151890         PERFORM P1665-NORM-DEBIT                                 15189000
151900         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15190000
151910                               SC-FEE-BY-SC (SUB5)                15191000
151920                               CURR-MO-SERV-CHRG                  15192000
151930         ADD 1 TO GEN-DEBIT-CNT.                                  15193000
151940     IF HOLD-POS-DEB-FEE GREATER THAN ZERO                        15194000
151950         MOVE HOLD-POS-DEB-FEE TO DSDSTXL-AMOUNT                  15195000
151960         MOVE OSB-DESC-0073-A TO DSDSTXL-CO-DESC                  15196000
151970         MOVE OSB-DESC-0073-B TO DSDSTXL-DESC                     15197000
151980         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15198000
151990         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15199000
152000         PERFORM P1665-NORM-DEBIT                                 15200000
152010         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15201000
152020                               SC-FEE-BY-SC (SUB5)                15202000
152030                               CURR-MO-SERV-CHRG                  15203000
152040         ADD 1 TO GEN-DEBIT-CNT.                                  15204000
152050     IF HOLD-TELE-DEB-FEE GREATER THAN ZERO                       15205000
152060         MOVE HOLD-TELE-DEB-FEE TO DSDSTXL-AMOUNT                 15206000
152070         MOVE OSB-DESC-0074-A TO DSDSTXL-CO-DESC                  15207000
152080         MOVE OSB-DESC-0074-B TO DSDSTXL-DESC                     15208000
152090         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15209000
152100         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15210000
152110         PERFORM P1665-NORM-DEBIT                                 15211000
152120         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15212000
152130                               SC-FEE-BY-SC (SUB5)                15213000
152140                               CURR-MO-SERV-CHRG                  15214000
152150         ADD 1 TO GEN-DEBIT-CNT.                                  15215000
152160     IF HOLD-ANNUAL-FEE GREATER THAN ZERO                         15216000
152170         MOVE HOLD-ANNUAL-FEE TO DSDSTXL-AMOUNT                   15217000
152180         MOVE OSB-DESC-0077-A TO DSDSTXL-CO-DESC                  15218000
152190         MOVE OSB-DESC-0077-B TO DSDSTXL-DESC                     15219000
152200         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15220000
152210         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15221000
152220         PERFORM P1665-NORM-DEBIT                                 15222000
152230         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15223000
152240                               SC-FEE-BY-SC (SUB5)                15224000
152250                               CURR-MO-SERV-CHRG                  15225000
152260         ADD 1 TO GEN-DEBIT-CNT.                                  15226000
152270     IF HOLD-CARD-FEE GREATER THAN ZERO                           15227000
152280         MOVE HOLD-CARD-FEE TO DSDSTXL-AMOUNT                     15228000
152290         MOVE OSB-DESC-0081-A TO DSDSTXL-CO-DESC                  15229000
152300         MOVE OSB-DESC-0081-B TO DSDSTXL-DESC                     15230000
152310         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15231000
152320         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15232000
152330         PERFORM P1665-NORM-DEBIT                                 15233000
152340         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15234000
152350                               SC-FEE-BY-SC (SUB5)                15235000
152360                               CURR-MO-SERV-CHRG                  15236000
152370         ADD 1 TO GEN-DEBIT-CNT.                                  15237000
152380     IF HOLD-LOST-CONTACT-FEE GREATER THAN ZERO                   15238000
152390         MOVE HOLD-LOST-CONTACT-FEE TO DSDSTXL-AMOUNT             15239000
152400         MOVE OSB-DESC-0084-A TO DSDSTXL-CO-DESC                  15240000
152410         MOVE OSB-DESC-0084-B TO DSDSTXL-DESC                     15241000
152420         MOVE NON-SER-SC-KEY TO SAVE-DR-SORT-KEY                  15242000
152430         MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE          15243000
152440         PERFORM P1665-NORM-DEBIT                                 15244000
152450         ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT                      15245000
152460                               SC-FEE-BY-SC (SUB5)                15246000
152470                               CURR-MO-SERV-CHRG                  15247000
152480         ADD 1 TO GEN-DEBIT-CNT.                                  15248000
152490     GO TO P5725-SC-END-1.                                        15249000
152500                                                                  15250000
152510 P5725-SC-END-1.                                                  15251000
152520     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 15252000
152530                                                                  15253000
152540 P5730-SC-END-2.                                                  15254000
152550     PERFORM P7150-BUILD-IE-SC-JRNL THRU P7159-EXIT.              15255000
152560     IF IMM-ACCOUNT OR SAV-ACCOUNT                                15256000
152570         PERFORM P7560-IMM-EXCEPTIONS THRU P7569-EXIT.            15257000
152580                                                                  15258000
152590 P5735-SC-END-3.                                                  15259000
152600     IF ACCT-ANAL-BANK                                            15260000
152610         IF ACCT-ANAL-ACCT-IND = 'Y'                              15261000
152620             MOVE ZEROS TO SERV-CHG-AMT (1)                       15262000
152630                           SC-BY-MNTH-AMT (TDY-MO)                15263000
152640             MOVE SERVICE-CHG-CODE TO SERV-CHG-CODE (1)           15264000
152650                                      SC-BY-MNTH-CODE (TDY-MO)    15265000
152660             MOVE 'A' TO SERV-CHG-DISP (1)                        15266000
152670                         SC-BY-MNTH-DISP (TDY-MO)                 15267000
152680             GO TO P5737-SC-END-4.                                15268000
152690     IF BCFSCR-CHARGE-A-TIME                                      15269000
152700         MOVE ACCUM-SERV-CHGS TO SERV-CHG-AMT (1)                 15270000
152710                                 SC-BY-MNTH-AMT (TDY-MO)          15271000
152720       ELSE                                                       15272000
152730         MOVE HOLD-SC-AMT TO SERV-CHG-AMT (1)                     15273000
152740                             SC-BY-MNTH-AMT (TDY-MO).             15274000
152750     MOVE SERVICE-CHG-CODE TO SERV-CHG-CODE (1)                   15275000
152760                              SC-BY-MNTH-CODE (TDY-MO).           15276000
152770     MOVE HOLD-DISP TO SERV-CHG-DISP (1)                          15277000
152780                       SC-BY-MNTH-DISP (TDY-MO).                  15278000
152790     IF HOLD-DISP = 'N'                                           15279000
152800         EVALUATE HOLD-NC-DISP                                    15280000
152810             WHEN 1                                               15281000
152820                 MOVE 'I' TO SERV-CHG-DISP (1)                    15282000
152830                             SC-BY-MNTH-DISP (TDY-MO)             15283000
152840             WHEN 2                                               15284000
152850                 MOVE 'D' TO SERV-CHG-DISP (1)                    15285000
152860                             SC-BY-MNTH-DISP (TDY-MO)             15286000
152870             WHEN 3                                               15287000
152880                 MOVE 'M' TO SERV-CHG-DISP (1)                    15288000
152890                             SC-BY-MNTH-DISP (TDY-MO)             15289000
152900             WHEN 4                                               15290000
152910                 MOVE 'E' TO SERV-CHG-DISP (1)                    15291000
152920                             SC-BY-MNTH-DISP (TDY-MO)             15292000
152930             WHEN 5                                               15293000
152940                 MOVE 'R' TO SERV-CHG-DISP (1)                    15294000
152950                             SC-BY-MNTH-DISP (TDY-MO)             15295000
152960             WHEN 6                                               15296000
152970                 MOVE 'X' TO SERV-CHG-DISP (1)                    15297000
152980                             SC-BY-MNTH-DISP (TDY-MO)             15298000
152990         END-EVALUATE.                                            15299000
153000                                                                  15300000
153010 P5737-SC-END-4.                                                  15301000
153020     MOVE ZEROS TO NUM-SERV-CHG-DEBITS.                           15302000
153030     MOVE ZEROS TO NUM-SERV-CHG-CREDIT.                           15303000
153040     MOVE ZEROS TO NUM-SERV-CHG-ITEMS.                            15304000
153050     MOVE NUM-REG-SC-DEBITS TO HIST-NUM-REG-SC-DEB (1).           15305000
153060     MOVE NUM-ACH-SC-DEBITS TO HIST-NUM-ACH-SC-DEB (1).           15306000
153070     MOVE NUM-FT-SC-DEBITS TO HIST-NUM-FT-SC-DEB (1).             15307000
153080     MOVE NUM-INFOLINE-SC-DEBITS TO HIST-NUM-INFOLINE-SC-DEB (1). 15308000
153090     MOVE NUM-ATM-SC-DEBITS TO HIST-NUM-ATM-SC-DEB (1).           15309000
153100     MOVE NUM-POS-SC-DEBITS TO HIST-NUM-POS-SC-DEB (1).           15310000
153110     MOVE NUM-LIMIT-OF-6-DEBITS TO HIST-NUM-LIMIT-OF-6-DEB (1).   15311000
153120     MOVE NUM-TELE-SC-DEBITS TO HIST-NUM-TELE-SC-DEB (1).         15312000
153130     MOVE NUM-3RD-PARTY-DEBITS TO HIST-NUM-3RD-PARTY-DEB (1).     15313000
153140     MOVE NUM-FOR-ATM-SC-DEBITS TO HIST-NUM-FOR-ATM-SC-DEB (1).   15314000
153150     MOVE NUM-CHKPLUS-SC-DEBITS TO HIST-NUM-CHKPLUS-SC-DEB (1).   15315000
153160     MOVE ZEROS                 TO HIST-NUM-PAYLINE-SC-DEB (1).   15316000
153170     MOVE NUM-ACH-SC-CREDITS    TO HIST-NUM-ACH-SC-CRED (1).      15317000
153180     MOVE NUM-E-DEPOSIT         TO HIST-NUM-E-DEPOSIT (1).        15318000
153190     MOVE NUM-MOBILE-RDC        TO HIST-NUM-MOBILE-RDC (1).       15319000
153200     MOVE NUM-DESKTOP-SCAN      TO HIST-NUM-DESKTOP-SCAN (1).     15320000
153210     MOVE NUM-E-DEPOSIT-ITEMS   TO HIST-NUM-E-DEPOSIT-ITEMS (1).  15321000
153220     MOVE NUM-MOBILE-RDC-ITEMS  TO HIST-NUM-MOBILE-RDC-ITEMS (1). 15322000
153230     MOVE NUM-DESKTOP-SCAN-ITEMS TO                               15323000
153240                               HIST-NUM-DESKTOP-SCAN-ITEMS (1).   15324000
153250     MOVE LOW-BALANCE-CYCLE TO LOW-BAL-CYCLE (1).                 15325000
153260     MOVE +999999999 TO LOW-BALANCE-CYCLE.                        15326000
153270     MOVE HIGH-BALANCE-CYCLE TO HIST-HIGH-BAL-CYCLE (1).          15327000
153280     MOVE -999999999 TO HIGH-BALANCE-CYCLE.                       15328000
153290     MOVE DAYS-IN-CYCLE TO HOLD-DAYS-IN-CYCLE.                    15329000
153300     IF CLOSED                                                    15330000
153310         IF DTE-LAST-CYCLE-STMT = ZEROS                           15331000
153320             CALL 'CDCDT11' USING DATE-OPENED                     15332000
153330                                  DATE-CLOSED                     15333000
153340                                  DAYS-11                         15334000
153350           ELSE                                                   15335000
153360             CALL 'CDCDT11' USING DTE-LAST-CYCLE-STMT             15336000
153370                                  DATE-CLOSED                     15337000
153380                                  DAYS-11                         15338000
153390         END-IF                                                   15339000
153400         MOVE DAYS-11 TO HOLD-DAYS-IN-CYCLE                       15340000
153410     END-IF.                                                      15341000
153420     MOVE GROSS-RATE TO PREV-GROSS-RATE.                          15342000
153430     MOVE GROSS-RATE-DAYS TO PREV-GROSS-RATE-DAYS.                15343000
153440     MOVE TIS-GRS-CUR-BAL-CYC TO TIS-GRS-CUR-BAL-PREV-CYC.        15344000
153450     MOVE TIS-GRS-COL-BAL-CYC TO TIS-GRS-COL-BAL-PREV-CYC.        15345000
153460     MOVE TIS-DAYS-CYC TO TIS-DAYS-PREV-CYC.                      15346000
153470     IF DDA-ACCOUNT                                               15347000
153480         MOVE INT-PAID-3RD-CYCLE TO INT-PAID-4TH-CYCLE            15348000
153490         MOVE INT-PAID-2ND-CYCLE TO INT-PAID-3RD-CYCLE            15349000
153500         MOVE INT-PAID-1ST-CYCLE TO INT-PAID-2ND-CYCLE            15350000
153510         MOVE ACCRUED-INTEREST TO INT-PAID-LAST-CYCLE             15351000
153520                                  INT-PAID-1ST-CYCLE.             15352000
153530     IF IMM-ACCOUNT                                               15353000
153540         IF NUM-3RD-PARTY-DEBITS GREATER THAN 6                   15354000
153550             SUBTRACT 6 FROM NUM-3RD-PARTY-DEBITS                 15355000
153560                 GIVING HOLD-XCESS-3P                             15356000
153570           ELSE                                                   15357000
153580             MOVE ZEROS TO HOLD-XCESS-3P                          15358000
153590         END-IF                                                   15359000
153600         IF NUM-LIMIT-OF-6-DEBITS GREATER THAN 6                  15360000
153610             SUBTRACT 6 FROM NUM-LIMIT-OF-6-DEBITS                15361000
153620                 GIVING HOLD-XCESS-L6                             15362000
153630           ELSE                                                   15363000
153640             MOVE ZEROS TO HOLD-XCESS-L6                          15364000
153650         END-IF                                                   15365000
153660         IF HOLD-XCESS-3P GREATER THAN HOLD-XCESS-L6              15366000
153670             MOVE HOLD-XCESS-3P TO HOLD-XCESS-3P-L6-FOR-AA        15367000
153680           ELSE                                                   15368000
153690             MOVE HOLD-XCESS-L6 TO HOLD-XCESS-3P-L6-FOR-AA        15369000
153700         END-IF.                                                  15370000
153710     MOVE ZEROS TO DAYS-IN-CYCLE                                  15371000
153720                   GROSS-CURR-BAL-CYCL                            15372000
153730                   GROSS-COLL-BAL-CYCL                            15373000
153740                   EXT-SERV-CHG-AMT                               15374000
153750                   SERV-CHG-FEES                                  15375000
153760                   ACCUM-SERV-CHGS                                15376000
153770                   ACCRUED-INTEREST                               15377000
153780                   MIN-ACCR-INTEREST                              15378000
153790                   NUM-FT-ACH-DEBITS                              15379000
153800                   NUM-3RD-PARTY-DEBITS                           15380000
153810                   IMM-NTC-MM-CTR                                 15381000
153820                   NUM-TELE-DEBITS                                15382000
153830                   NUM-TELE-CREDIT                                15383000
153840                   GROSS-RATE                                     15384000
153850                   GROSS-RATE-DAYS                                15385000
153860                   TIS-GRS-CUR-BAL-CYC                            15386000
153870                   TIS-GRS-COL-BAL-CYC                            15387000
153880                   TIS-DAYS-CYC                                   15388000
153890                   NUM-REG-SC-DEBITS                              15389000
153900                   NUM-ACH-SC-DEBITS                              15390000
153910                   NUM-FT-SC-DEBITS                               15391000
153920                   NUM-INFOLINE-SC-DEBITS                         15392000
153930                   NUM-ATM-SC-DEBITS                              15393000
153940                   NUM-POS-SC-DEBITS                              15394000
153950                   NUM-LIMIT-OF-6-DEBITS                          15395000
153960                   NUM-TELE-SC-DEBITS                             15396000
153970                   NUM-FOR-ATM-SC-DEBITS                          15397000
153980                   NUM-CHKPLUS-SC-DEBITS                          15398000
153990                   NUM-ACH-SC-CREDITS                             15399000
154000                   NUM-E-DEPOSIT                                  15400000
154010                   NUM-MOBILE-RDC                                 15401000
154020                   NUM-DESKTOP-SCAN                               15402000
154030                   NUM-E-DEPOSIT-ITEMS                            15403000
154040                   NUM-MOBILE-RDC-ITEMS                           15404000
154050                   NUM-DESKTOP-SCAN-ITEMS                         15405000
154060                   CASH-MANAGEMENT-TRNSFR-CNT                     15406000
154070                   ITEM-COUNT-2SIG-REQ.                           15407000
154080     IF ACCT-ANAL-ACCT-IND = 'N'                                  15408000
154090         IF HOLD-DISP = 'C'                                       15409000
154100             SUBTRACT HOLD-SC-PLUS FROM CURR-NET-COLL-BAL         15410000
154110     END-IF.                                                      15411000
154120     IF SC-HDR-SW = 1                                             15412000
154130         PERFORM P8830-BUILD-SC-TRAILER THRU P8839-EXIT.          15413000
154140     MOVE ZEROS TO NUM-LOCAL-ITEMS.                               15414000
154150                                                                  15415000
154160 P5739-CYC-SC-E-EXIT.                                             15416000
154170     EXIT.                                                        15417000
154180                                                                  15418000
154190 P5740-CYC-STMT-END.                                              15419000
154200     PERFORM P8400-CHANGE-OD-ACCESS-LIMIT THRU P8409-EXIT.        15420000
154210     PERFORM P8340-CHECK-WHICH-STMT THRU P8349-EXIT.              15421000
154220     PERFORM P0390-PREP-MSTR-CK-INV-CYC THRU P0394-EXIT.          15422000
154230     PERFORM P9030-CHK-CMA THRU P9039-EXIT.                       15423000
154240     PERFORM P8620-BUILD-PD-TRAILER THRU P8629-EXIT.              15424000
154250     PERFORM P9020-BUILD-OSB-SUMMARY THRU P9029-EXIT.             15425000
154260     PERFORM P9040-UPDATE-ARCUST     THRU P9049-EXIT.             15426000
154270     IF CYCLE-THIS-SC-EARN = 1                                    15427000
154280         MOVE '0' TO ODB-ACTIVITY-SW                              15428000
154290         PERFORM P7540-CYCLE-CODE-46-EXCEPTIONS THRU P7549-EXIT.  15429000
154300     IF INV-CLOSED-CYC-STMT                                       15430000
154310         CALL 'CDCDT17' USING INV-MATURE-DATE                     15431000
154320                              INV-DATE-WK                         15432000
154330         IF TDY-YR = INV-DT-YR AND                                15433000
154340            TDY-MO = INV-DT-MO                                    15434000
154350             NEXT SENTENCE                                        15435000
154360           ELSE                                                   15436000
154370             MOVE INV-STATUS-CODE TO HOLD-OLD-INV-STAT            15437000
154380             MOVE '09' TO INV-STATUS-CODE                         15438000
154390                          HOLD-NEW-INV-STAT                       15439000
154400             MOVE 'Y' TO HOLD-EXTRACT-IND                         15440000
154410             PERFORM P8482-INV-STATUS-CODE-CHANGE THRU P8482-EXIT 15441000
154420         END-IF                                                   15442000
154430     END-IF.                                                      15443000
154440     MOVE 0 TO SC-CLOSED-SW.                                      15444000
154450     IF AMT-LAST-CYCLE-STMT     = ZERO  AND                       15445000
154460        CURRENT-BALANCE         = ZERO  AND                       15446000
154470        NUM-ENCLOSURES          = ZERO  AND                       15447000
154480        NUM-CREDITS             = ZERO  AND                       15448000
154490        NUM-DEBITS              = ZERO  AND                       15449000
154500        DTE-LAST-CYCLE-STMT NOT = ZERO                            15450000
154510         MOVE 1 TO NO-ACTIVITY-STMT.                              15451000
154520     MOVE ' ' TO SPEC-REPORT-ID.                                  15452000
154530     MOVE PROC-CURR-DATE TO DTE-LAST-CYCLE-STMT.                  15453000
154540     MOVE CURRENT-BALANCE TO AMT-LAST-CYCLE-STMT.                 15454000
154550     MOVE ZEROS TO NUM-ENCLOSURES                                 15455000
154560                   NUM-CREDITS                                    15456000
154570                   NUM-DEBITS                                     15457000
154580                   DTE-LAST-SPEC-STMT                             15458000
154590                   AMT-LAST-SPEC-STMT                             15459000
154600                   ODB-AMT-LAST-SPEC-STMT                         15460000
154610                   INV-AMT-LAST-SPEC-STMT                         15461000
154620                   NUM-KITES                                      15462000
154630                   AMT-CREDITS                                    15463000
154640                   AMT-DEBITS                                     15464000
154650                   NUM-CHECKS-ON-STMT                             15465000
154660                   AMT-CHECKS-ON-STMT                             15466000
154670                   AMT-INV-PUR-ON-STMT                            15467000
154680                   AMT-INV-MAT-ON-STMT                            15468000
154690                   AMT-ODB-ADV-ON-STMT                            15469000
154700                   AMT-ODB-PAY-ON-STMT                            15470000
154710                   DAYS-SINCE-LAST-STMT                           15471000
154720                   GR-CUR-SINCE-LST-STMT                          15472000
154730                   GR-COL-SINCE-LST-STMT                          15473000
154740                   OD-FEES-CTD                                    15474000
154750                   RET-CHK-FEES-CTD                               15475000
154760                   OD-FEES-REF-CTD                                15476000
154770                   RET-CHK-FEES-REF-CTD.                          15477000
154780     IF PROC-DSS                                                  15478000
154790         MOVE 'N' TO SAVEUP-IND                                   15479000
154800     END-IF.                                                      15480000
154810     IF TDY-MO = 01                                               15481000
154820         MOVE ZEROS TO OD-FEES-YTD                                15482000
154830                       RET-CHK-FEES-YTD                           15483000
154840                       OD-FEES-REF-YTD                            15484000
154850                       RET-CHK-FEES-REF-YTD                       15485000
154860                       NSF-FEES-WVD-YTD.                          15486000
154870                                                                  15487000
154880******************************************************************15488000
154890*        C H E C K   F O R   A U T O   C L O S E                 *15489000
154900******************************************************************15490000
154910 P5750-CK-AUTO-CLOSE.                                             15491000
154920     IF CLOSED                                                    15492000
154930         ADD 1 TO NUM-CLOSED-STMTS                                15493000
154940         GO TO P5759-CYC-STMT-EXIT.                               15494000
154950     IF BANK-CTL-ACCTS OR FIXED-ACCT OR BANK-EMPLOYEE             15495000
154960         GO TO P5759-CYC-STMT-EXIT.                               15496000
154970     IF CURRENT-BALANCE NOT = ZERO                                15497000
154980         GO TO P5759-CYC-STMT-EXIT.                               15498000
154990     IF ODB-PLAN = SPACES AND                                     15499000
155000        INV-PLAN = SPACES                                         15500000
155010         NEXT SENTENCE                                            15501000
155020       ELSE                                                       15502000
155030         IF ODB-LOAN-BAL      = ZERO AND                          15503000
155040            MONTHLY-ACCUM-INT = ZERO AND                          15504000
155050            ODB-ACCUM-CR-LIFE = ZERO AND                          15505000
155060            INV-BALANCE       = ZERO AND                          15506000
155070            INV-ACCRUED-INT   = ZERO AND                          15507000
155080            ML-HELOC-NBR      = ZERO                              15508000
155090             NEXT SENTENCE                                        15509000
155100           ELSE                                                   15510000
155110             GO TO P5759-CYC-STMT-EXIT.                           15511000
155120     IF BR-CLSN-TIED > 0                                          15512000
155130         GO TO P5759-CYC-STMT-EXIT                                15513000
155140     END-IF.                                                      15514000
155150     IF NO-ACTIVITY-STMT = 0                                      15515000
155160         GO TO P5759-CYC-STMT-EXIT.                               15516000
155170     ADD 1 TO NUM-CLOSED-STMTS.                                   15517000
155180                                                                  15518000
155190     MOVE STAT-2X TO HOLD-OLD-STAT-2X.                            15519000
155200     MOVE 091 TO STATUS-CODE.                                     15520000
155210     MOVE '09'    TO HOLD-NEW-STAT-2X.                            15521000
155220     MOVE 'Y' TO HOLD-EXTRACT-IND.                                15522000
155230     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            15523000
155240                                                                  15524000
155250     ADD 1 TO NUM-CLOSED-TODAY.                                   15525000
155260     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE.                 15526000
155270     ADD ACCRUED-INTEREST TO TDY-DROP-BY-IDENT (SUB13).           15527000
155280     ADD ACCRUED-INTEREST TO TDY-DROP-BY-IDENT (11).              15528000
155290     MOVE ZEROS TO ACCRUED-INTEREST.                              15529000
155300     MOVE ZEROS TO MIN-ACCR-INTEREST.                             15530000
155310     IF ODB-PLAN = SPACES                                         15531000
155320         NEXT SENTENCE                                            15532000
155330       ELSE                                                       15533000
155340         IF ODB-STATUS-CODE = '04'                                15534000
155350             NEXT SENTENCE                                        15535000
155360           ELSE                                                   15536000
155370             MOVE '4' TO HISTORY-CARD-IND                         15537000
155380             MOVE ODB-STATUS-CODE TO HOLD-OLD-ODB-STAT            15538000
155390             MOVE '04' TO ODB-STATUS-CODE                         15539000
155400                          HOLD-NEW-ODB-STAT                       15540000
155410             MOVE PROC-CURR-DATE TO DATE-CANCELLED                15541000
155420             MOVE 'Y' TO HOLD-EXTRACT-IND                         15542000
155430             PERFORM P8483-ODB-STATUS-CODE-CHANGE THRU P8483-EXIT 15543000
155440             PERFORM P8370-CHECK-HIST-HDR THRU P8379-EXIT.        15544000
155450     IF INV-PLAN = SPACES                                         15545000
155460         NEXT SENTENCE                                            15546000
155470       ELSE                                                       15547000
155480         MOVE INV-STATUS-CODE TO HOLD-OLD-INV-STAT                15548000
155490         MOVE '09' TO INV-STATUS-CODE                             15549000
155500                      HOLD-NEW-INV-STAT                           15550000
155510         MOVE 'Y' TO HOLD-EXTRACT-IND                             15551000
155520         PERFORM P8482-INV-STATUS-CODE-CHANGE THRU P8482-EXIT     15552000
155530         MOVE PROC-CURR-DATE TO INV-MATURE-DATE.                  15553000
155540     MOVE PROC-CURR-DATE TO DATE-CLOSED.                          15554000
155550     MOVE OD-ACCESS-LIMIT TO HOLD-OLD-ACCESS-LIMIT                15555000
155560     MOVE ZEROS TO OD-ACCESS-LIMIT                                15556000
155570                   HOLD-NEW-ACCESS-LIMIT                          15557000
155580     IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED           15558000
155590                  OR OA-SUSPENDED                                 15559000
155600         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              15560000
155610         MOVE 90 TO OD-ACCESS-CODE                                15561000
155620                    HOLD-NEW-ACCESS-CODE                          15562000
155630       ELSE                                                       15563000
155640         MOVE OD-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE              15564000
155650         MOVE 00 TO OD-ACCESS-CODE                                15565000
155660                    HOLD-NEW-ACCESS-CODE                          15566000
155670     END-IF.                                                      15567000
155680     MOVE 'Y' TO HOLD-EXTRACT-IND.                                15568000
155690     PERFORM P8484-ACCESS-CODE-CHANGE  THRU P8484-EXIT.           15569000
155700     PERFORM P8485-ACCESS-LIMIT-CHANGE THRU P8485-EXIT.           15570000
155710                                                                  15571000
155720     PERFORM P8795-CLOSE-ACCT-ANAL THRU P8799-EXIT.               15572000
155730                                                                  15573000
155740 P5759-CYC-STMT-EXIT.                                             15574000
155750     EXIT.                                                        15575000
155760                                                                  15576000
155770******************************************************************15577000
155780*    FEE ACCOUNT - SERVICE CHARGE MEMO TRANSACTION ROUTINE       *15578000
155790******************************************************************15579000
155800 P5760-FEE-ACCT-STMT.                                             15580000
155810     IF SERV-CHG-FEES = ZERO                                      15581000
155820         GO TO P5765-NO-FEE-CHARGE.                               15582000
155830     MOVE SERV-CHG-FEES TO HOLD-CHARGES.                          15583000
155840     ADD SERV-CHG-FEES TO ACCUM-SERV-CHGS.                        15584000
155850     MOVE ZEROS TO SERV-CHG-FEES.                                 15585000
155860     MOVE 1 TO DSDSTXL-PENDING-SW.                                15586000
155870     ADD 1 TO NUM-BILL-TX.                                        15587000
155880     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     15588000
155890     MOVE 'S-C' TO PJ-HOLD-CODE.                                  15589000
155900     MOVE HOLD-CHARGES TO DSDSTXL-AMOUNT.                         15590000
155910     MOVE OSB-DESC-0064-A TO DSDSTXL-CO-DESC.                     15591000
155920     MOVE OSB-DESC-0064-B TO DSDSTXL-DESC.                        15592000
155930     MOVE NON-SER-SC-KEY TO DSDSTXL-SORT-KEY.                     15593000
155940     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       15594000
155950     MOVE 789 TO DSDSTXL-CODE.                                    15595000
155960     PERFORM P8570-BUILD-POSTED-DTL THRU P8571-EXIT.              15596000
155970     PERFORM P8574-WRITE-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     15597000
155980                                                                  15598000
155990 P5765-NO-FEE-CHARGE.                                             15599000
156000     MOVE ZEROS TO HOLD-CHARGES.                                  15600000
156010     MOVE 'N' TO HOLD-DISP.                                       15601000
156020     MOVE 2 TO HOLD-NC-DISP                                       15602000
156030     IF DSDSTXL-PENDING-SW = 1                                    15603000
156040         PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.             15604000
156050                                                                  15605000
156060 P5769-EXIT.                                                      15606000
156070     EXIT.                                                        15607000
156080                                                                  15608000
156090******************************************************************15609000
156100*               B U I L D   F D I C   C H A R G E                *15610000
156110******************************************************************15611000
156120 P5770-FDIC-CHRG-AVG-CURR-BAL.                                    15612000
156130     IF BANK-CTL-ACCTS                                            15613000
156140         GO TO P5779-EXIT.                                        15614000
156150     IF CLOSED                                                    15615000
156160         GO TO P5779-EXIT.                                        15616000
156170     IF DAYS-IN-CYCLE = ZEROS                                     15617000
156180         GO TO P5779-EXIT.                                        15618000
156190     IF CYCLE-THIS-STMT = 1                                       15619000
156200         DIVIDE GROSS-CURR-BAL-CYCL BY DAYS-IN-CYCLE              15620000
156210             GIVING WORK-AVERAGE-BAL                              15621000
156220     ELSE                                                         15622000
156230         DIVIDE GROSS-CURR-BAL-MNTH BY DAYS-IN-CAL-MONTH          15623000
156240             GIVING WORK-AVERAGE-BAL                              15624000
156250     END-IF.                                                      15625000
156260     IF WORK-AVERAGE-BAL LESS THAN +1000                          15626000
156270         GO TO P5779-EXIT.                                        15627000
156280     COMPUTE AVG-BAL-IN-1000S ROUNDED =                           15628000
156290         WORK-AVERAGE-BAL / 1000.                                 15629000
156300                                                                  15630000
156310     MOVE ZEROS TO HOLD-FDIC-CHARGE.                              15631000
156320 P5772-CHK-BAL-IN-1000S.                                          15632000
156330     IF AVG-BAL-IN-1000S GREATER THAN 99999                       15633000
156340         NEXT SENTENCE                                            15634000
156350     ELSE                                                         15635000
156360         GO TO P5774-CONTINUE.                                    15636000
156370     COMPUTE HOLD-FDIC-CHARGE ROUNDED =                           15637000
156380         90000 * FDIC-INSURANCE-RATE2.                            15638000
156390     PERFORM P5776-FDIC-TX THRU P5778-EXIT.                       15639000
156400     SUBTRACT 90000 FROM AVG-BAL-IN-1000S.                        15640000
156410     GO TO P5772-CHK-BAL-IN-1000S.                                15641000
156420                                                                  15642000
156430 P5774-CONTINUE.                                                  15643000
156440     IF AVG-BAL-IN-1000S GREATER THAN 250                         15644000
156450         COMPUTE WORK-FDIC-FEE ROUNDED =                          15645000
156460             250 * FDIC-INSURANCE-RATE                            15646000
156470         ADD  WORK-FDIC-FEE TO HOLD-FDIC-CHARGE                   15647000
156480         COMPUTE AVG-BAL = AVG-BAL-IN-1000S - 250                 15648000
156490         COMPUTE WORK-FDIC-FEE ROUNDED =                          15649000
156500             AVG-BAL * FDIC-INSURANCE-RATE2                       15650000
156510         ADD WORK-FDIC-FEE  TO HOLD-FDIC-CHARGE                   15651000
156520     ELSE                                                         15652000
156530         COMPUTE HOLD-FDIC-CHARGE ROUNDED =                       15653000
156540             AVG-BAL-IN-1000S * FDIC-INSURANCE-RATE               15654000
156550     END-IF.                                                      15655000
156560     IF HOLD-FDIC-CHARGE = ZEROS                                  15656000
156570         GO TO P5779-EXIT.                                        15657000
156580 P5776-FDIC-TX.                                                   15658000
156590     IF HOLD-FDIC-CHARGE = ZEROS                                  15659000
156600         GO TO P5778-EXIT.                                        15660000
156610     MOVE 1 TO DSDSTXL-PENDING-SW.                                15661000
156620     ADD 1 TO NUM-BILL-TX.                                        15662000
156630     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     15663000
156640     MOVE HOLD-FDIC-CHARGE TO DSDSTXL-AMOUNT.                     15664000
156650     MOVE 111 TO DSDSTXL-CODE.                                    15665000
156660     MOVE 111 TO HOLD-TX-CODE-IN                                  15666000
156670     IF FDIC-INSURANCE-RATE2 = ZEROS                              15667000
156680         IF AVG-BAL-IN-1000S GREATER THAN 250                     15668000
156690             MOVE 250 TO AVG-BAL-IN-1000S.                        15669000
156700     MOVE AVG-BAL-IN-1000S TO DSDSTXL-ITEM-COUNT.                 15670000
156710     PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.             15671000
156720     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 15672000
156730                                                                  15673000
156740 P5778-EXIT.                                                      15674000
156750     EXIT.                                                        15675000
156760                                                                  15676000
156770 P5779-EXIT.                                                      15677000
156780     EXIT.                                                        15678000
156790                                                                  15679000
156800******************************************************************15680000
156810*    U P D A T E   U N P O S T E D   I T E M S   A C C O U N T   *15681000
156820******************************************************************15682000
156830 P5800-UNPOSTED-ITEMS-ACCOUNT.                                    15683000
156840     IF LIST-POST-SW = 1                                          15684000
156850         PERFORM P8680-END-OF-LIST THRU P8689-EXIT.               15685000
156860     IF UNPOSTED-CREDIT-097 = ZERO                                15686000
156870         GO TO P5810-CK-DEBIT-097.                                15687000
156880     MOVE 1 TO DSDSTXL-PENDING-SW.                                15688000
156890     PERFORM P8205-TX-INIT-2 THRU P8219-EXIT.                     15689000
156900     MOVE 540 TO DSDSTXL-CODE.                                    15690000
156910     MOVE OSB-DESC-0035-A TO DSDSTXL-CO-DESC.                     15691000
156920     MOVE OSB-DESC-0035-B TO DSDSTXL-DESC.                        15692000
156930     MOVE UNPOSTED-CREDIT-097 TO DSDSTXL-AMOUNT.                  15693000
156940     MOVE ZEROS TO UNPOSTED-CREDIT-097.                           15694000
156950     PERFORM P1325-NORM-CR-2.                                     15695000
156960     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            15696000
156970     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       15697000
156980                                                                  15698000
156990 P5810-CK-DEBIT-097.                                              15699000
157000     IF UNPOSTED-DEBIT-097 = ZERO                                 15700000
157010         GO TO P5820-CHK-CC-BUCKET.                               15701000
157020     MOVE 1 TO DSDSTXL-PENDING-SW.                                15702000
157030     PERFORM P8205-TX-INIT-2 THRU P8219-EXIT.                     15703000
157040     MOVE 990 TO DSDSTXL-CODE.                                    15704000
157050     MOVE OSB-DESC-0036-A TO DSDSTXL-CO-DESC.                     15705000
157060     MOVE OSB-DESC-0036-B TO DSDSTXL-DESC.                        15706000
157070     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                15707000
157080     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       15708000
157090     MOVE UNPOSTED-DEBIT-097 TO DSDSTXL-AMOUNT.                   15709000
157100     MOVE ZEROS TO UNPOSTED-DEBIT-097.                            15710000
157110     PERFORM P1665-NORM-DEBIT.                                    15711000
157120                                                                  15712000
157130 P5820-CHK-CC-BUCKET.                                             15713000
157140     IF BK-CC-CYC-C-BUCKET = ZERO                                 15714000
157150         GO TO P5821-TRNSFR-CC-BUCKET.                            15715000
157160     MOVE BK-CC-CYC-C-BUCKET TO DSDSTXL-AMOUNT.                   15716000
157170     MOVE ZEROS TO BK-CC-CYC-C-BUCKET.                            15717000
157180     MOVE 1 TO DSDSTXL-PENDING-SW.                                15718000
157190     PERFORM P8205-TX-INIT-2 THRU P8219-EXIT.                     15719000
157200     MOVE 540 TO DSDSTXL-CODE.                                    15720000
157210     MOVE OSB-DESC-0068-A TO DSDSTXL-CO-DESC.                     15721000
157220     MOVE OSB-DESC-0068-B TO DSDSTXL-DESC.                        15722000
157230     MOVE 'CCC' TO PJ-HOLD-CODE.                                  15723000
157240     ADD DSDSTXL-AMOUNT TO GEN-CREDIT-AMT.                        15724000
157250     ADD 1 TO GEN-CREDIT-CNT.                                     15725000
157260     PERFORM P1325-NORM-CR-2.                                     15726000
157270     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            15727000
157280     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       15728000
157290                                                                  15729000
157300*** CREATE TRANSACTION TO THE UNPOSTED CC ACCOUNT                 15730000
157310     MOVE PROC-BK-NO                TO PEND-BANK-NBR.             15731000
157320     MOVE 010                       TO PEND-ACCT-ID.              15732000
157330     MOVE 999999998                 TO PEND-ACCT-NBR.             15733000
157340                                                                  15734000
157350     MOVE 990                       TO PEND-TX-CODE.              15735000
157360     MOVE DSDSTXL-AMOUNT            TO PEND-TX-AMOUNT             15736000
157370     MOVE PROC-NEXT-DATE            TO PEND-EFFECT-DATE.          15737000
157380     MOVE 99913                     TO PEND-BATCH-NBR.            15738000
157390     ADD 1                          TO PEND-SEQUENCE-NBR.         15739000
157400     MOVE 'CHRISTMAS CLUB CHECKS  ' TO PEND-TX-DESC.              15740000
157410     PERFORM P5527-INSERT-CC-PEND-TX THRU P5527-EXIT.             15741000
157420                                                                  15742000
157430*** CREATE TRANSACTION TO THE CD INTEREST CHECKING ACCOUNT        15743000
157440     MOVE PROC-BK-NO                TO PEND-BANK-NBR.             15744000
157450     MOVE 001                       TO PEND-ACCT-ID.              15745000
157460                                                                  15746000
157470     MOVE PROC-BK-NO TO CDBC-BANK-NBR.                            15747000
157480     EXEC SQL                                                     15748000
157490         SELECT                                                   15749000
157500             CDBC_DDA_ACCT_NBR                                    15750000
157510         INTO                                                     15751000
157520            :CDBC-DDA-ACCT-NBR                                    15752000
157530         FROM CD.BANKCTL                                          15753000
157540         WHERE CDBC_BANK_NBR = :CDBC-BANK-NBR                     15754000
157550     END-EXEC.                                                    15755000
157560     EVALUATE SQLCODE                                             15756000
157570         WHEN ZEROS                                               15757000
157580             CONTINUE                                             15758000
157590         WHEN OTHER                                               15759000
157600             CALL 'CDCUT90' USING SQLCA                           15760000
157610             CALL 'CDCDUMP' USING BY CONTENT '2064'               15761000
157620     END-EVALUATE.                                                15762000
157630                                                                  15763000
157640     MOVE CDBC-DDA-ACCT-NBR         TO PEND-ACCT-NBR.             15764000
157650                                                                  15765000
157660     MOVE 540                       TO PEND-TX-CODE.              15766000
157670     MOVE DSDSTXL-AMOUNT            TO PEND-TX-AMOUNT             15767000
157680     MOVE PROC-NEXT-DATE            TO PEND-EFFECT-DATE.          15768000
157690     MOVE 99913                     TO PEND-BATCH-NBR.            15769000
157700     ADD 1                          TO PEND-SEQUENCE-NBR.         15770000
157710     MOVE 'CHRISTMAS CLUB CHECKS  ' TO PEND-TX-DESC.              15771000
157720     PERFORM P5527-INSERT-CC-PEND-TX THRU P5527-EXIT.             15772000
157730                                                                  15773000
157740 P5821-TRNSFR-CC-BUCKET.                                          15774000
157750     IF BK-CC-CYC-T-BUCKET = ZERO                                 15775000
157760         GO TO P5830-UNPOSTED-UPDATE-COMP.                        15776000
157770     MOVE BK-CC-CYC-T-BUCKET TO DSDSTXL-AMOUNT.                   15777000
157780     MOVE 1                  TO DSDSTXL-PENDING-SW.               15778000
157790     PERFORM P8205-TX-INIT-2 THRU P8219-EXIT.                     15779000
157800     MOVE 540                TO DSDSTXL-CODE.                     15780000
157810     MOVE OSB-DESC-0098-A    TO DSDSTXL-CO-DESC.                  15781000
157820     MOVE OSB-DESC-0098-B    TO DSDSTXL-DESC.                     15782000
157830     MOVE 'CCT'              TO PJ-HOLD-CODE.                     15783000
157840     ADD DSDSTXL-AMOUNT      TO GEN-CREDIT-AMT.                   15784000
157850     ADD 1                   TO GEN-CREDIT-CNT.                   15785000
157860     PERFORM P1325-NORM-CR-2.                                     15786000
157870     PERFORM P7020-BUILD-DEPOSIT-LIST THRU P7029-EXIT.            15787000
157880     PERFORM P7680-DEPOSIT-LIST-IN-AMT-SEQ THRU P7689-EXIT.       15788000
157890                                                                  15789000
157900     MOVE PROC-BK-NO                TO PEND-BANK-NBR.             15790000
157910     MOVE 010                       TO PEND-ACCT-ID.              15791000
157920     MOVE 999999998                 TO PEND-ACCT-NBR.             15792000
157930                                                                  15793000
157940     MOVE 990                       TO PEND-TX-CODE.              15794000
157950     MOVE BK-CC-CYC-T-BUCKET        TO PEND-TX-AMOUNT             15795000
157960     MOVE PROC-NEXT-DATE            TO PEND-EFFECT-DATE.          15796000
157970     MOVE 99913                     TO PEND-BATCH-NBR.            15797000
157980     ADD 1                          TO PEND-SEQUENCE-NBR.         15798000
157990     MOVE 'CHRISTMAS CLUB TRANSFER' TO PEND-TX-DESC.              15799000
158000     PERFORM P5527-INSERT-CC-PEND-TX THRU P5527-EXIT.             15800000
158010     MOVE ZEROS              TO BK-CC-CYC-T-BUCKET.               15801000
158020                                                                  15802000
158030 P5830-UNPOSTED-UPDATE-COMP.                                      15803000
158040     IF DSDSTXL-PENDING-SW = 1                                    15804000
158050         PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.             15805000
158060     GO TO P5065-PREP-MSTR-CURR-DAY.                              15806000
158070                                                                  15807000
158080******************************************************************15808000
158090*                E N D   O F   B A N K                           *15809000
158100******************************************************************15810000
158110 P6000-END-OF-BANK.                                               15811000
158120     MOVE 1 TO LAST-TIME-SW.                                      15812000
158130     PERFORM P7548-CHECK-RPT-54 THRU P7549-EXIT.                  15813000
158140     PERFORM P8220-COLLATERAL-RPT THRU P8229-EXIT.                15814000
158150     PERFORM P6700-TOTAL-POSTING-JRNL THRU P6749-EXIT.            15815000
158160     PERFORM P0150-GET-CNTL-REC.                                  15816000
158170     PERFORM P6800-DAILY-TOTALS THRU P6899-EXIT.                  15817000
158180     MOVE NUM-APPROVED-ODB TO CURR-NUM-ODB-ACCTS.                 15818000
158190     MOVE NUM-APPROVED-INV TO CURR-NUM-INV-ACCTS.                 15819000
158200     MOVE END-NUM-ACCTS TO CURR-TOT-NUM-ACCTS.                    15820000
158210     ADD NUM-BILL-TX TO CURR-TOT-NUM-TXS.                         15821000
158220     MOVE NUM-IMAGED-ACCTS TO CURR-NUM-IMG-ACCTS.                 15822000
158230     IF PROC-MONTH-END                                            15823000
158240         MOVE CURR-NUM-ODB-ACCTS TO PREV-NUM-ODB-ACCTS            15824000
158250         MOVE CURR-NUM-INV-ACCTS TO PREV-NUM-INV-ACCTS            15825000
158260         MOVE CURR-TOT-NUM-ACCTS TO PREV-TOT-NUM-ACCTS            15826000
158270         MOVE CURR-TOT-NUM-TXS   TO PREV-TOT-NUM-TXS              15827000
158280         MOVE CURR-NUM-IMG-ACCTS TO PREV-NUM-IMG-ACCTS            15828000
158290         MOVE ZEROS TO CURR-TOT-NUM-TXS                           15829000
158300         INITIALIZE MFC-CONTENTS-101                              15830000
158310         INITIALIZE MFC-CONTENTS-102                              15831000
158320         INITIALIZE MFC-CONTENTS-103                              15832000
158330         INITIALIZE MFC-CONTENTS-104                              15833000
158340         INITIALIZE MFC-CONTENTS-105                              15834000
158350         INITIALIZE MFC-CONTENTS-106                              15835000
158360         INITIALIZE MFC-CONTENTS-107                              15836000
158370         INITIALIZE MFC-CONTENTS-108                              15837000
158380         INITIALIZE MFC-CONTENTS-109                              15838000
158390         INITIALIZE MFC-CONTENTS-110                              15839000
158400         INITIALIZE MFC-CONTENTS-111                              15840000
158410         INITIALIZE MFC-CONTENTS-112                              15841000
158420         INITIALIZE MFC-CONTENTS-113                              15842000
158430         INITIALIZE MFC-CONTENTS-114                              15843000
158440         INITIALIZE MFC-CONTENTS-115                              15844000
158450         INITIALIZE MFC-CONTENTS-116                              15845000
158460         INITIALIZE MFC-CONTENTS-117                              15846000
158470         INITIALIZE MFC-CONTENTS-118                              15847000
158480         INITIALIZE MFC-CONTENTS-119                              15848000
158490         INITIALIZE MFC-CONTENTS-120                              15849000
158500         INITIALIZE MFC-CONTENTS-121                              15850000
158510         INITIALIZE MFC-CONTENTS-122                              15851000
158520         INITIALIZE MFC-CONTENTS-123                              15852000
158530         INITIALIZE MFC-CONTENTS-124                              15853000
158540         INITIALIZE MFC-CONTENTS-125.                             15854000
158550     PERFORM P0170-UPDATE-CNTL-REC THRU P0179-EXIT.               15855000
158560     DISPLAY 'MSTR READ     - ' READ-MSTR UPON CONSOLE.           15856000
158570     DISPLAY 'MSTR UPDATED  - ' UPDATE-MSTR UPON CONSOLE.         15857000
158580     DISPLAY 'HIST SEARCHED - ' SEARCH-HIST UPON CONSOLE.         15858000
158590     DISPLAY 'HIST UPDATED  - ' UPDATE-HIST UPON CONSOLE.         15859000
158600     MOVE ZERO TO READ-MSTR     UPDATE-MSTR.                      15860000
158610     MOVE ZERO TO SEARCH-HIST   UPDATE-HIST.                      15861000
158620     MOVE ZERO TO SAVE-ACCOUNT-ID.                                15862000
158630     DISPLAY 'COUNT 1 = ' COUNT-1.                                15863000
158640     DISPLAY 'COUNT 2 = ' COUNT-2.                                15864000
158650     DISPLAY 'COUNT 3 = ' COUNT-3.                                15865000
158660     DISPLAY 'COUNT 4 = ' COUNT-4.                                15866000
158670     DISPLAY 'BANK NO. ' BCF-BANK-NO ' PROCESSING COMPLETED.'     15867000
158680         UPON CONSOLE.                                            15868000
158690     PERFORM P0050-READ-PROC-CTL THRU P0055-EXIT.                 15869000
158700     PERFORM P0090-READ-BK-CTL THRU P0290-END-JOURNAL-HEADS.      15870000
158710     PERFORM P0300-READ-MSTR THRU P0399-READ-MSTR-EXIT.           15871000
158720     IF DSDSTXL-PENDING-SW = 1                                    15872000
158730         PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.             15873000
158731     IF PROC-DSS                                                  15873101
158732       IF DSDSTXL-EOF = 1                                         15873201
158733          MOVE DSDSTXL-BANK-SAVE TO DSDSTXL-BANK-NO               15873301
158734       END-IF                                                     15873401
158735     END-IF.                                                      15873501
158740     GO TO P1000-MATCH-MSTR-TX.                                   15874000
158750                                                                  15875000
158760******************************************************************15876000
158770* SUBROUTINE - M O N T H E N D  P R O C E S S I N G              *15877000
158780******************************************************************15878000
158790 P6500-MONTHEND-RTN.                                              15879000
158800     PERFORM P8106-GET-HISTORY THRU P8109-EXIT.                   15880000
158810     IF DAYS-IN-CAL-MONTH = ZERO                                  15881000
158820         MOVE ZEROS TO AVG-CURR-BAL-MO (1)                        15882000
158830         MOVE ZEROS TO AVG-COLL-BAL-MO (1)                        15883000
158840         GO TO P6503-MONTHEND-3.                                  15884000
158850     DIVIDE GROSS-CURR-BAL-MNTH BY DAYS-IN-CAL-MONTH              15885000
158860         GIVING AVG-CURR-BAL-MO (1).                              15886000
158870     DIVIDE GROSS-COLL-BAL-MNTH BY DAYS-IN-CAL-MONTH              15887000
158880         GIVING AVG-COLL-BAL-MO (1).                              15888000
158890                                                                  15889000
158900 P6503-MONTHEND-3.                                                15890000
158910     MOVE NUM-NSF-CHECKS-MO  TO NUM-NSF-CHECKS (1).               15891000
158920     MOVE NUM-APPR-OD-MO     TO NUM-APPR-OD (1).                  15892000
158930     MOVE NUM-DAYS-OD-MO     TO NUM-DAY-OD (1).                   15893000
158940     MOVE NUM-TIMES-OD-MO    TO NUM-TIMES-OD (1).                 15894000
158950     MOVE UNCOLL-WITHD-MO    TO UNCOLL-WITHD (1).                 15895000
158960     IF HIST-NOT-AVAILABLE (1)                                    15896000
158970         MOVE ' ' TO SERV-CHG-DISP (1).                           15897000
158980     MOVE SERV-CHG-AMT (1) TO SC-BY-MNTH-AMT (TDY-MO).            15898000
158990     MOVE SERV-CHG-CODE (1) TO SC-BY-MNTH-CODE (TDY-MO).          15899000
159000     MOVE SERV-CHG-DISP (1) TO SC-BY-MNTH-DISP (TDY-MO).          15900000
159010     MOVE +999999999.99 TO LOW-BALANCE-MONTH.                     15901000
159020     ADD CR-LIFE-PAID-MTD TO CR-LIFE-PAID-YTD.                    15902000
159030     MOVE CURR-MO-SERV-CHRG TO PREV-MO-SERV-CHRG.                 15903000
159040     MOVE ODB-FEE-MTD TO ODB-FEE-PREV-MO.                         15904000
159050     ADD ODB-FEE-MTD TO ODB-FEE-YTD.                              15905000
159060     MOVE ZEROS TO CR-LIFE-PAID-MTD.                              15906000
159070     MOVE ZEROS TO GROSS-CURR-BAL-MNTH.                           15907000
159080     MOVE ZEROS TO DAYS-IN-CAL-MONTH.                             15908000
159090     MOVE ZEROS TO GROSS-COLL-BAL-MNTH.                           15909000
159100     MOVE ZEROS TO NUM-NSF-CHECKS-MO.                             15910000
159110     MOVE ZEROS TO NUM-APPR-OD-MO.                                15911000
159120     MOVE ZEROS TO NUM-DAYS-OD-MO.                                15912000
159130     MOVE ZEROS TO NUM-TIMES-OD-MO.                               15913000
159140     MOVE ZEROS TO UNCOLL-WITHD-MO.                               15914000
159150     MOVE ZEROS TO CURR-MO-SERV-CHRG.                             15915000
159160     MOVE ZEROS TO ODB-FEE-MTD.                                   15916000
159170                                                                  15917000
159180 P6506-SHIFT-HISTORY-MONTHS.                                      15918000
159190     MOVE ONE-MONTH-QUARTER-HISTORY (3)                           15919000
159200                             TO ONE-MONTH-QUARTER-HISTORY (4).    15920000
159210     MOVE ONE-MONTH-QUARTER-HISTORY-2 (3)                         15921000
159220                             TO ONE-MONTH-QUARTER-HISTORY-2 (4).  15922000
159230     MOVE ONE-MONTH-QUARTER-HISTORY (2)                           15923000
159240                             TO ONE-MONTH-QUARTER-HISTORY (3).    15924000
159250     MOVE ONE-MONTH-QUARTER-HISTORY-2 (2)                         15925000
159260                             TO ONE-MONTH-QUARTER-HISTORY-2 (3).  15926000
159270     MOVE ONE-MONTH-QUARTER-HISTORY (1)                           15927000
159280                             TO ONE-MONTH-QUARTER-HISTORY (2).    15928000
159290     MOVE ONE-MONTH-QUARTER-HISTORY-2 (1)                         15929000
159300                             TO ONE-MONTH-QUARTER-HISTORY-2 (2).  15930000
159310     MOVE CLEAR-HISTORY      TO ONE-MONTH-QUARTER-HISTORY (1).    15931000
159320     INITIALIZE ONE-MONTH-QUARTER-HISTORY-2 (1).                  15932000
159330     ADD MONTH-END-MO  01  GIVING  MO-QTR-IND (1).                15933000
159340     MOVE MONTH-END-YR TO YEAR-IND (1).                           15934000
159350     IF MO-QTR-IND (1) = 13                                       15935000
159360         MOVE 01 TO MO-QTR-IND (1)                                15936000
159370         ADD 01 TO YEAR-IND (1).                                  15937000
159380                                                                  15938000
159390 P6509-EXIT.                                                      15939000
159400     EXIT.                                                        15940000
159410                                                                  15941000
159420******************************************************************15942000
159430* SUBROUTINE - Q U A R T E R E N D  P R O C E S S I N G          *15943000
159440******************************************************************15944000
159450 P6510-QTREND-RTN.                                                15945000
159460     MOVE ONE-MONTH-QUARTER-HISTORY (7)                           15946000
159470                             TO ONE-MONTH-QUARTER-HISTORY (8).    15947000
159480     MOVE ONE-MONTH-QUARTER-HISTORY-2 (7)                         15948000
159490                             TO ONE-MONTH-QUARTER-HISTORY-2 (8).  15949000
159500     MOVE ONE-MONTH-QUARTER-HISTORY (6)                           15950000
159510                             TO ONE-MONTH-QUARTER-HISTORY (7).    15951000
159520     MOVE ONE-MONTH-QUARTER-HISTORY-2 (6)                         15952000
159530                             TO ONE-MONTH-QUARTER-HISTORY-2 (7).  15953000
159540     MOVE ONE-MONTH-QUARTER-HISTORY (5)                           15954000
159550                             TO ONE-MONTH-QUARTER-HISTORY (6).    15955000
159560     MOVE ONE-MONTH-QUARTER-HISTORY-2 (5)                         15956000
159570                             TO ONE-MONTH-QUARTER-HISTORY-2 (6).  15957000
159580     PERFORM P6600-AVG-3-MONTHS-HISTORY THRU P6610-EXIT.          15958000
159590                                                                  15959000
159600 P6519-EXIT.                                                      15960000
159610     EXIT.                                                        15961000
159620                                                                  15962000
159630******************************************************************15963000
159640* SUBROUTINE - Y E A R E N D  P R O C E S S I N G                *15964000
159650******************************************************************15965000
159660 P6530-YEAREND-RTN.                                               15966000
159670     IF CLOSED                                                    15967000
159680         PERFORM P7090-BUILD-CLOSED-ACCTS THRU P7099-EXIT.        15968000
159690                                                                  15969000
159700 P6532-CHK-FOR-ODB.                                               15970000
159710     IF ODB-PLAN = SPACES                                         15971000
159720         GO TO P6534-CHK-FOR-INV.                                 15972000
159730     PERFORM P7710-BUILD-ODB-INT-YTD THRU P7719-EXIT.             15973000
159740     MOVE YTD-ODB-INT TO ODB-INT-PAID-PREV-YR.                    15974000
159750     MOVE ODB-YTD-INT-SECURED TO ODB-PREV-YR-INT-SECURED.         15975000
159760     MOVE CR-LIFE-PAID-YTD TO CR-LIFE-PAID-PREV-YR.               15976000
159770     MOVE ODB-FEE-YTD TO ODB-FEE-PREV-YR.                         15977000
159780     MOVE ZEROS TO YTD-ODB-INT.                                   15978000
159790     MOVE ZEROS TO ODB-YTD-INT-SECURED.                           15979000
159800     MOVE ZEROS TO CR-LIFE-PAID-YTD.                              15980000
159810     MOVE ZEROS TO NUM-ADVANCES-YTD.                              15981000
159820     MOVE ZEROS TO ODB-FEE-YTD.                                   15982000
159830                                                                  15983000
159840 P6534-CHK-FOR-INV.                                               15984000
159850     IF INV-PLAN = SPACES OR 'IC'                                 15985000
159860         GO TO P6536-CONT-YEAREND.                                15986000
159870     MOVE INV-INT-PAID-YTD TO INV-INT-PAID-PREV-YR.               15987000
159880     MOVE INV-TAX-WITHHELD-YTD TO INV-TAX-WITHHELD-PREV-YR.       15988000
159890     MOVE INV-GROSS-BAL-YTD TO INV-GROSS-BAL-PREV-YR.             15989000
159900     MOVE INV-GROSS-INT-YTD TO INV-GROSS-INT-PREV-YR.             15990000
159910     MOVE ZEROS TO INV-INT-PAID-YTD.                              15991000
159920     MOVE ZEROS TO INV-TAX-WITHHELD-YTD.                          15992000
159930     MOVE ZEROS TO INV-GROSS-BAL-YTD.                             15993000
159940     MOVE ZEROS TO INV-GROSS-INT-YTD.                             15994000
159950                                                                  15995000
159960 P6536-CONT-YEAREND.                                              15996000
159970     MOVE INT-PAID-YTD TO INT-PAID-PREV-YR.                       15997000
159980     MOVE TAX-WITHHELD-YTD TO TAX-WITHHELD-PREV-YR.               15998000
159990     MOVE ZEROS TO INT-PAID-YTD.                                  15999000
160000     MOVE ZEROS TO TAX-WITHHELD-YTD.                              16000000
160010     IF CLOSED                                                    16001000
160020         NEXT SENTENCE                                            16002000
160030       ELSE                                                       16003000
160040         GO TO P6539-EXIT.                                        16004000
160050     SET DSDS-CLOSE TO TRUE.                                      16005000
160060     SET DSDS-HIST-CLOSE TO TRUE.                                 16006000
160070                                                                  16007000
160080 P6539-EXIT.                                                      16008000
160090     EXIT.                                                        16009000
160100                                                                  16010000
160110******************************************************************16011000
160120*    A V E R A G E   L A S T   3   M O N T H S   H I S T O R Y   *16012000
160130******************************************************************16013000
160140 P6600-AVG-3-MONTHS-HISTORY.                                      16014000
160150     MOVE 1 TO ADD-COUNT.                                         16015000
160160     MOVE 0 TO ADD-COUNT-2.                                       16016000
160170     MOVE ZEROS TO HOLD-AVG-CURR-CYC.                             16017000
160180     MOVE ZEROS TO HOLD-AVG-CURR-MO.                              16018000
160190     MOVE ZEROS TO HOLD-AVG-COLL-CYC.                             16019000
160200     MOVE ZEROS TO HOLD-AVG-COLL-MO.                              16020000
160210     ADD AVG-CURR-BAL-CYC (2) TO HOLD-AVG-CURR-CYC.               16021000
160220     ADD AVG-CURR-BAL-MO (2)  TO HOLD-AVG-CURR-MO.                16022000
160230     ADD AVG-COLL-BAL-CYC (2) TO HOLD-AVG-COLL-CYC.               16023000
160240     ADD AVG-COLL-BAL-MO (2)  TO HOLD-AVG-COLL-MO.                16024000
160250     IF PROC-DSD                                                  16025000
160260         GO TO P6602-CONT.                                        16026000
160270     IF AVG-CURR-BAL-CYC (2) = ZERO AND                           16027000
160280        AVG-COLL-BAL-CYC (2) = ZERO                               16028000
160290         GO TO P6602-CONT.                                        16029000
160300     ADD 1 TO ADD-COUNT-2.                                        16030000
160310                                                                  16031000
160320 P6602-CONT.                                                      16032000
160330     IF HIST-NOT-AVAILABLE (3)                                    16033000
160340         GO TO P6604-CONT.                                        16034000
160350     ADD AVG-CURR-BAL-CYC (3) TO HOLD-AVG-CURR-CYC.               16035000
160360     ADD AVG-CURR-BAL-MO (3)  TO HOLD-AVG-CURR-MO.                16036000
160370     ADD AVG-COLL-BAL-CYC (3) TO HOLD-AVG-COLL-CYC.               16037000
160380     ADD AVG-COLL-BAL-MO (3)  TO HOLD-AVG-COLL-MO.                16038000
160390     ADD 1 TO ADD-COUNT.                                          16039000
160400     IF PROC-DSD                                                  16040000
160410         GO TO P6604-CONT.                                        16041000
160420     IF AVG-CURR-BAL-CYC (3) = ZERO AND                           16042000
160430        AVG-COLL-BAL-CYC (3) = ZERO                               16043000
160440         GO TO P6604-CONT.                                        16044000
160450     ADD 1 TO ADD-COUNT-2.                                        16045000
160460                                                                  16046000
160470 P6604-CONT.                                                      16047000
160480     IF HIST-NOT-AVAILABLE (4)                                    16048000
160490         GO TO P6606-CONT.                                        16049000
160500     ADD AVG-CURR-BAL-CYC (4) TO HOLD-AVG-CURR-CYC.               16050000
160510     ADD AVG-CURR-BAL-MO (4)  TO HOLD-AVG-CURR-MO.                16051000
160520     ADD AVG-COLL-BAL-CYC (4) TO HOLD-AVG-COLL-CYC.               16052000
160530     ADD AVG-COLL-BAL-MO (4)  TO HOLD-AVG-COLL-MO.                16053000
160540     ADD 1 TO ADD-COUNT.                                          16054000
160550     IF PROC-DSD                                                  16055000
160560         GO TO P6606-CONT.                                        16056000
160570     IF AVG-CURR-BAL-CYC (4) = ZERO AND                           16057000
160580        AVG-COLL-BAL-CYC (4) = ZERO                               16058000
160590         GO TO P6606-CONT.                                        16059000
160600     ADD 1 TO ADD-COUNT-2.                                        16060000
160610                                                                  16061000
160620 P6606-CONT.                                                      16062000
160630     IF PROC-DSD                                                  16063000
160640         IF ADD-COUNT = ZERO                                      16064000
160650             MOVE ZEROS TO AVG-CURR-BAL-CYC (5)                   16065000
160660                           AVG-COLL-BAL-CYC (5)                   16066000
160670             GO TO P6608-CONT                                     16067000
160680           ELSE                                                   16068000
160690             COMPUTE AVG-CURR-BAL-CYC (5) ROUNDED =               16069000
160700                 HOLD-AVG-CURR-CYC / ADD-COUNT                    16070000
160710             COMPUTE AVG-COLL-BAL-CYC (5) ROUNDED =               16071000
160720                 HOLD-AVG-COLL-CYC / ADD-COUNT                    16072000
160730             GO TO P6608-CONT.                                    16073000
160740     IF ADD-COUNT-2 = ZERO                                        16074000
160750         MOVE ZEROS TO AVG-CURR-BAL-CYC (5)                       16075000
160760                       AVG-COLL-BAL-CYC (5)                       16076000
160770       ELSE                                                       16077000
160780         COMPUTE AVG-CURR-BAL-CYC (5) ROUNDED =                   16078000
160790             HOLD-AVG-CURR-CYC / ADD-COUNT-2                      16079000
160800         COMPUTE AVG-COLL-BAL-CYC (5) ROUNDED =                   16080000
160810             HOLD-AVG-COLL-CYC / ADD-COUNT-2.                     16081000
160820                                                                  16082000
160830 P6608-CONT.                                                      16083000
160840     IF ADD-COUNT = ZERO                                          16084000
160850         MOVE ZEROS TO AVG-CURR-BAL-MO (5)                        16085000
160860                       AVG-COLL-BAL-MO (5)                        16086000
160870       ELSE                                                       16087000
160880         COMPUTE AVG-CURR-BAL-MO (5) ROUNDED =                    16088000
160890             HOLD-AVG-CURR-MO / ADD-COUNT                         16089000
160900         COMPUTE AVG-COLL-BAL-MO (5) ROUNDED =                    16090000
160910             HOLD-AVG-COLL-MO / ADD-COUNT.                        16091000
160920     ADD NUM-NSF-CHECKS (2)                                       16092000
160930         NUM-NSF-CHECKS (3)                                       16093000
160940         NUM-NSF-CHECKS (4)                                       16094000
160950         GIVING  NUM-NSF-CHECKS (5).                              16095000
160960     ADD NUM-APPR-OD (2)                                          16096000
160970         NUM-APPR-OD (3)                                          16097000
160980         NUM-APPR-OD (4)                                          16098000
160990         GIVING  NUM-APPR-OD (5).                                 16099000
161000     ADD NUM-DAY-OD (2)                                           16100000
161010         NUM-DAY-OD (3)                                           16101000
161020         NUM-DAY-OD (4)                                           16102000
161030         GIVING  NUM-DAY-OD (5).                                  16103000
161040     ADD NUM-TIMES-OD (2)                                         16104000
161050         NUM-TIMES-OD (3)                                         16105000
161060         NUM-TIMES-OD (4)                                         16106000
161070         GIVING  NUM-TIMES-OD (5).                                16107000
161080     ADD NUM-SC-DEBITS (2)                                        16108000
161090         NUM-SC-DEBITS (3)                                        16109000
161100         NUM-SC-DEBITS (4)                                        16110000
161110         GIVING  NUM-SC-DEBITS (5).                               16111000
161120     ADD NUM-SC-CREDITS (2)                                       16112000
161130         NUM-SC-CREDITS (3)                                       16113000
161140         NUM-SC-CREDITS (4)                                       16114000
161150         GIVING  NUM-SC-CREDITS (5).                              16115000
161160     ADD NUM-SC-ITEMS (2)                                         16116000
161170         NUM-SC-ITEMS (3)                                         16117000
161180         NUM-SC-ITEMS (4)                                         16118000
161190         GIVING  NUM-SC-ITEMS (5).                                16119000
161200     ADD UNCOLL-WITHD (2)                                         16120000
161210         UNCOLL-WITHD (3)                                         16121000
161220         UNCOLL-WITHD (4)                                         16122000
161230         GIVING  UNCOLL-WITHD (5).                                16123000
161240     ADD AMT-CYCLE-DEBITS (2)                                     16124000
161250         AMT-CYCLE-DEBITS (3)                                     16125000
161260         AMT-CYCLE-DEBITS (4)                                     16126000
161270         GIVING  AMT-CYCLE-DEBITS (5).                            16127000
161280     ADD AMT-CYCLE-CREDITS (2)                                    16128000
161290         AMT-CYCLE-CREDITS (3)                                    16129000
161300         AMT-CYCLE-CREDITS (4)                                    16130000
161310         GIVING  AMT-CYCLE-CREDITS (5).                           16131000
161320     MOVE ZEROS TO SERV-CHG-AMT (5).                              16132000
161330     MOVE SERV-CHG-CODE (2) TO SERV-CHG-CODE (5).                 16133000
161340     MOVE SPACE TO SERV-CHG-DISP (5).                             16134000
161350     MOVE LOW-BAL-CYCLE (2) TO LOW-BAL-CYCLE (5).                 16135000
161360     IF LOW-BAL-CYCLE (3) LESS THAN LOW-BAL-CYCLE (5)             16136000
161370         MOVE LOW-BAL-CYCLE (3) TO LOW-BAL-CYCLE (5).             16137000
161380     IF LOW-BAL-CYCLE (4) LESS THAN LOW-BAL-CYCLE (5)             16138000
161390         MOVE LOW-BAL-CYCLE (4) TO LOW-BAL-CYCLE (5).             16139000
161400     MOVE HIST-HIGH-BAL-CYCLE (2) TO HIST-HIGH-BAL-CYCLE (5).     16140000
161410     IF HIST-HIGH-BAL-CYCLE (3) GREATER THAN                      16141000
161420        HIST-HIGH-BAL-CYCLE (5)                                   16142000
161430         MOVE HIST-HIGH-BAL-CYCLE (3) TO HIST-HIGH-BAL-CYCLE (5). 16143000
161440     IF HIST-HIGH-BAL-CYCLE (4) GREATER THAN                      16144000
161450        HIST-HIGH-BAL-CYCLE (5)                                   16145000
161460         MOVE HIST-HIGH-BAL-CYCLE (4) TO HIST-HIGH-BAL-CYCLE (5). 16146000
161470     MOVE MONTH-END-YR TO YEAR-IND (5).                           16147000
161480     MOVE MONTH-END-MO TO MO-QTR-IND (5).                         16148000
161490     ADD HIST-NUM-REG-SC-DEB (2)                                  16149000
161500         HIST-NUM-REG-SC-DEB (3)                                  16150000
161510         HIST-NUM-REG-SC-DEB (4)                                  16151000
161520         GIVING  HIST-NUM-REG-SC-DEB (5).                         16152000
161530     ADD HIST-NUM-ACH-SC-DEB (2)                                  16153000
161540         HIST-NUM-ACH-SC-DEB (3)                                  16154000
161550         HIST-NUM-ACH-SC-DEB (4)                                  16155000
161560         GIVING  HIST-NUM-ACH-SC-DEB (5).                         16156000
161570     ADD HIST-NUM-ACH-SC-CRED (2)                                 16157000
161580         HIST-NUM-ACH-SC-CRED (3)                                 16158000
161590         HIST-NUM-ACH-SC-CRED (4)                                 16159000
161600         GIVING  HIST-NUM-ACH-SC-CRED (5).                        16160000
161610     ADD HIST-NUM-FT-SC-DEB (2)                                   16161000
161620         HIST-NUM-FT-SC-DEB (3)                                   16162000
161630         HIST-NUM-FT-SC-DEB (4)                                   16163000
161640         GIVING  HIST-NUM-FT-SC-DEB (5).                          16164000
161650     ADD HIST-NUM-INFOLINE-SC-DEB (2)                             16165000
161660         HIST-NUM-INFOLINE-SC-DEB (3)                             16166000
161670         HIST-NUM-INFOLINE-SC-DEB (4)                             16167000
161680         GIVING  HIST-NUM-INFOLINE-SC-DEB (5).                    16168000
161690     ADD HIST-NUM-ATM-SC-DEB (2)                                  16169000
161700         HIST-NUM-ATM-SC-DEB (3)                                  16170000
161710         HIST-NUM-ATM-SC-DEB (4)                                  16171000
161720         GIVING  HIST-NUM-ATM-SC-DEB (5).                         16172000
161730     ADD HIST-NUM-POS-SC-DEB (2)                                  16173000
161740         HIST-NUM-POS-SC-DEB (3)                                  16174000
161750         HIST-NUM-POS-SC-DEB (4)                                  16175000
161760         GIVING  HIST-NUM-POS-SC-DEB (5).                         16176000
161770     ADD HIST-NUM-LIMIT-OF-6-DEB (2)                              16177000
161780         HIST-NUM-LIMIT-OF-6-DEB (3)                              16178000
161790         HIST-NUM-LIMIT-OF-6-DEB (4)                              16179000
161800         GIVING  HIST-NUM-LIMIT-OF-6-DEB (5).                     16180000
161810     ADD HIST-NUM-TELE-SC-DEB (2)                                 16181000
161820         HIST-NUM-TELE-SC-DEB (3)                                 16182000
161830         HIST-NUM-TELE-SC-DEB (4)                                 16183000
161840         GIVING  HIST-NUM-TELE-SC-DEB (5).                        16184000
161850     ADD HIST-NUM-3RD-PARTY-DEB (2)                               16185000
161860         HIST-NUM-3RD-PARTY-DEB (3)                               16186000
161870         HIST-NUM-3RD-PARTY-DEB (4)                               16187000
161880         GIVING  HIST-NUM-3RD-PARTY-DEB (5).                      16188000
161890     ADD HIST-NUM-FOR-ATM-SC-DEB (2)                              16189000
161900         HIST-NUM-FOR-ATM-SC-DEB (3)                              16190000
161910         HIST-NUM-FOR-ATM-SC-DEB (4)                              16191000
161920         GIVING  HIST-NUM-FOR-ATM-SC-DEB (5).                     16192000
161930     ADD HIST-NUM-CHKPLUS-SC-DEB (2)                              16193000
161940         HIST-NUM-CHKPLUS-SC-DEB (3)                              16194000
161950         HIST-NUM-CHKPLUS-SC-DEB (4)                              16195000
161960         GIVING  HIST-NUM-CHKPLUS-SC-DEB (5).                     16196000
161970     ADD HIST-NUM-PAYLINE-SC-DEB (2)                              16197000
161980         HIST-NUM-PAYLINE-SC-DEB (3)                              16198000
161990         HIST-NUM-PAYLINE-SC-DEB (4)                              16199000
162000         GIVING  HIST-NUM-PAYLINE-SC-DEB (5).                     16200000
162010     ADD HIST-NUM-E-DEPOSIT (2)                                   16201000
162020         HIST-NUM-E-DEPOSIT (3)                                   16202000
162030         HIST-NUM-E-DEPOSIT (4)                                   16203000
162040         GIVING  HIST-NUM-E-DEPOSIT (5).                          16204000
162050     ADD HIST-NUM-MOBILE-RDC (2)                                  16205000
162060         HIST-NUM-MOBILE-RDC (3)                                  16206000
162070         HIST-NUM-MOBILE-RDC (4)                                  16207000
162080         GIVING  HIST-NUM-MOBILE-RDC (5).                         16208000
162090     ADD HIST-NUM-DESKTOP-SCAN (2)                                16209000
162100         HIST-NUM-DESKTOP-SCAN (3)                                16210000
162110         HIST-NUM-DESKTOP-SCAN (4)                                16211000
162120         GIVING  HIST-NUM-DESKTOP-SCAN (5).                       16212000
162130     ADD HIST-NUM-E-DEPOSIT-ITEMS (2)                             16213000
162140         HIST-NUM-E-DEPOSIT-ITEMS (3)                             16214000
162150         HIST-NUM-E-DEPOSIT-ITEMS (4)                             16215000
162160         GIVING  HIST-NUM-E-DEPOSIT-ITEMS (5).                    16216000
162170     ADD HIST-NUM-MOBILE-RDC-ITEMS (2)                            16217000
162180         HIST-NUM-MOBILE-RDC-ITEMS (3)                            16218000
162190         HIST-NUM-MOBILE-RDC-ITEMS (4)                            16219000
162200         GIVING  HIST-NUM-MOBILE-RDC-ITEMS (5).                   16220000
162210     ADD HIST-NUM-DESKTOP-SCAN-ITEMS (2)                          16221000
162220         HIST-NUM-DESKTOP-SCAN-ITEMS (3)                          16222000
162230         HIST-NUM-DESKTOP-SCAN-ITEMS (4)                          16223000
162240         GIVING  HIST-NUM-DESKTOP-SCAN-ITEMS (5).                 16224000
162250                                                                  16225000
162260                                                                  16226000
162270 P6610-EXIT.                                                      16227000
162280     EXIT.                                                        16228000
162290                                                                  16229000
162300******************************************************************16230000
162310*    S E T   1 2   M O N T H   A V E R A G E S                   *16231000
162320******************************************************************16232000
162330 P6620-SET-12-MO-AVG.                                             16233000
162340     IF GOT-HISTORY = 0                                           16234000
162350         GO TO P6629-EXIT.                                        16235000
162360     MOVE ZEROS TO WK-NUM-ENTRIES                                 16236000
162370                   WK-CURR-BAL-12-MO                              16237000
162380                   WK-COLL-BAL-12-MO                              16238000
162390                   AVG-CURR-BAL-LST-12-MO                         16239000
162400                   AVG-COLL-BAL-LST-12-MO                         16240000
162410                   NUM-NSF-CHKS-LST-12-MO                         16241000
162420                   NUM-TIMES-OD-LST-12-MO.                        16242000
162430                                                                  16243000
162440     IF HIST-NOT-AVAILABLE (5)                                    16244000
162450         NEXT SENTENCE                                            16245000
162460       ELSE                                                       16246000
162470         ADD 1                   TO WK-NUM-ENTRIES                16247000
162480         ADD NUM-NSF-CHECKS (5)  TO NUM-NSF-CHKS-LST-12-MO        16248000
162490         ADD NUM-TIMES-OD (5)    TO NUM-TIMES-OD-LST-12-MO        16249000
162500         ADD AVG-CURR-BAL-MO (5) TO WK-CURR-BAL-12-MO             16250000
162510         ADD AVG-COLL-BAL-MO (5) TO WK-COLL-BAL-12-MO.            16251000
162520                                                                  16252000
162530     IF HIST-NOT-AVAILABLE (6)                                    16253000
162540         NEXT SENTENCE                                            16254000
162550       ELSE                                                       16255000
162560         ADD 1                   TO WK-NUM-ENTRIES                16256000
162570         ADD NUM-NSF-CHECKS (6)  TO NUM-NSF-CHKS-LST-12-MO        16257000
162580         ADD NUM-TIMES-OD (6)    TO NUM-TIMES-OD-LST-12-MO        16258000
162590         ADD AVG-CURR-BAL-MO (6) TO WK-CURR-BAL-12-MO             16259000
162600         ADD AVG-COLL-BAL-MO (6) TO WK-COLL-BAL-12-MO.            16260000
162610                                                                  16261000
162620     IF HIST-NOT-AVAILABLE (7)                                    16262000
162630         NEXT SENTENCE                                            16263000
162640       ELSE                                                       16264000
162650         ADD 1                   TO WK-NUM-ENTRIES                16265000
162660         ADD NUM-NSF-CHECKS (7)  TO NUM-NSF-CHKS-LST-12-MO        16266000
162670         ADD NUM-TIMES-OD (7)    TO NUM-TIMES-OD-LST-12-MO        16267000
162680         ADD AVG-CURR-BAL-MO (7) TO WK-CURR-BAL-12-MO             16268000
162690         ADD AVG-COLL-BAL-MO (7) TO WK-COLL-BAL-12-MO.            16269000
162700                                                                  16270000
162710     IF MONTH-END-MO = 03 OR 06 OR 09 OR 12                       16271000
162720         IF HIST-NOT-AVAILABLE (8)                                16272000
162730             GO TO P6622-COMPUTE-AVERAGE                          16273000
162740           ELSE                                                   16274000
162750             ADD 1                   TO WK-NUM-ENTRIES            16275000
162760             ADD NUM-NSF-CHECKS (8)  TO NUM-NSF-CHKS-LST-12-MO    16276000
162770             ADD NUM-TIMES-OD (8)    TO NUM-TIMES-OD-LST-12-MO    16277000
162780             ADD AVG-CURR-BAL-MO (8) TO WK-CURR-BAL-12-MO         16278000
162790             ADD AVG-COLL-BAL-MO (8) TO WK-COLL-BAL-12-MO         16279000
162800             GO TO P6622-COMPUTE-AVERAGE.                         16280000
162810                                                                  16281000
162820     IF MONTH-END-MO = 01 OR 04 OR 07 OR 10                       16282000
162830         IF HIST-NOT-AVAILABLE (2)                                16283000
162840             GO TO P6622-COMPUTE-AVERAGE                          16284000
162850           ELSE                                                   16285000
162860             ADD 1                   TO WK-NUM-ENTRIES            16286000
162870             ADD NUM-NSF-CHECKS (2)  TO NUM-NSF-CHKS-LST-12-MO    16287000
162880             ADD NUM-TIMES-OD (2)    TO NUM-TIMES-OD-LST-12-MO    16288000
162890             ADD AVG-CURR-BAL-MO (2) TO WK-CURR-BAL-12-MO         16289000
162900             ADD AVG-COLL-BAL-MO (2) TO WK-COLL-BAL-12-MO         16290000
162910             GO TO P6622-COMPUTE-AVERAGE.                         16291000
162920                                                                  16292000
162930     IF HIST-NOT-AVAILABLE (2)                                    16293000
162940         NEXT SENTENCE                                            16294000
162950       ELSE                                                       16295000
162960         ADD 1                   TO WK-NUM-ENTRIES                16296000
162970         ADD NUM-NSF-CHECKS (2)  TO NUM-NSF-CHKS-LST-12-MO        16297000
162980         ADD NUM-TIMES-OD (2)    TO NUM-TIMES-OD-LST-12-MO        16298000
162990         ADD AVG-CURR-BAL-MO (2) TO WK-CURR-BAL-12-MO             16299000
163000         ADD AVG-COLL-BAL-MO (2) TO WK-COLL-BAL-12-MO.            16300000
163010                                                                  16301000
163020     IF HIST-NOT-AVAILABLE (3)                                    16302000
163030         NEXT SENTENCE                                            16303000
163040       ELSE                                                       16304000
163050         ADD 1                   TO WK-NUM-ENTRIES                16305000
163060         ADD NUM-NSF-CHECKS (3)  TO NUM-NSF-CHKS-LST-12-MO        16306000
163070         ADD NUM-TIMES-OD (3)    TO NUM-TIMES-OD-LST-12-MO        16307000
163080         ADD AVG-CURR-BAL-MO (3) TO WK-CURR-BAL-12-MO             16308000
163090         ADD AVG-COLL-BAL-MO (3) TO WK-COLL-BAL-12-MO.            16309000
163100                                                                  16310000
163110 P6622-COMPUTE-AVERAGE.                                           16311000
163120     IF WK-NUM-ENTRIES = ZERO                                     16312000
163130         GO TO P6629-EXIT.                                        16313000
163140     COMPUTE AVG-CURR-BAL-LST-12-MO =                             16314000
163150         WK-CURR-BAL-12-MO / WK-NUM-ENTRIES.                      16315000
163160     COMPUTE AVG-COLL-BAL-LST-12-MO =                             16316000
163170         WK-COLL-BAL-12-MO / WK-NUM-ENTRIES.                      16317000
163180                                                                  16318000
163190 P6629-EXIT.                                                      16319000
163200     EXIT.                                                        16320000
163210                                                                  16321000
163220******************************************************************16322000
163230*        T O T A L   P O S T I N G   J O U R N A L               *16323000
163240******************************************************************16324000
163250 P6700-TOTAL-POSTING-JRNL.                                        16325000
163260     IF PJ-DEB-SW GREATER THAN 0                                  16326000
163270         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.             16327000
163280     IF PJ-CRE-SW GREATER THAN 0                                  16328000
163290         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.             16329000
163300     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16330000
163310     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16331000
163320     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16332000
163330     MOVE 'TOTAL POSTED CREDITS' TO PJ-TOTAL-DESC.                16333000
163340     MOVE PJ-CRE-NO TO PJ-TOTAL-NO.                               16334000
163350     MOVE PJ-CRE-AMT TO PJ-TOTAL-AMOUNT.                          16335000
163360     MOVE PJ-TOTAL-LINE TO PJ-DETAIL-LINE.                        16336000
163370     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16337000
163380     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16338000
163390     MOVE PJ-DEB-NO TO PJ-TOTAL-NO.                               16339000
163400     MOVE PJ-DEB-AMT TO PJ-TOTAL-AMOUNT.                          16340000
163410     MOVE 'TOTAL POSTED DEBITS' TO PJ-TOTAL-DESC.                 16341000
163420     MOVE PJ-TOTAL-LINE TO PJ-DETAIL-LINE.                        16342000
163430     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 16343000
163440     IF LAST-TIME-SW = 1                                          16344000
163450         NEXT SENTENCE                                            16345000
163460       ELSE                                                       16346000
163470         PERFORM P0280-PRINT-JOURNAL-HEADS THRU                   16347000
163480                 P0290-END-JOURNAL-HEADS.                         16348000
163490     MOVE 0 TO LAST-TIME-SW.                                      16349000
163500     MOVE ZEROS TO PJ-CRE-NO.                                     16350000
163510     MOVE ZEROS TO PJ-DEB-NO.                                     16351000
163520     MOVE ZEROS TO PJ-DEB-AMT.                                    16352000
163530     MOVE ZEROS TO PJ-CRE-AMT.                                    16353000
163540                                                                  16354000
163550 P6749-EXIT.                                                      16355000
163560     EXIT.                                                        16356000
163570                                                                  16357000
163580******************************************************************16358000
163590* SUBROUTINE - P R I N T  P O S T I N G  J O U R N A L           *16359000
163600******************************************************************16360000
163610 P6750-PRINT-JOURNAL.                                             16361000
163620     MOVE 0 TO PJ-DEB-SW.                                         16362000
163630     MOVE 0 TO PJ-CRE-SW.                                         16363000
163640     MOVE 080 TO SUB1.                                            16364000
163650     IF LINE-CNT GREATER THAN 54                                  16365000
163660         PERFORM P0280-PRINT-JOURNAL-HEADS THRU                   16366000
163670             P0290-END-JOURNAL-HEADS                              16367000
163680         IF PJ-DETAIL-LINE = SPACES                               16368000
163690             NEXT SENTENCE                                        16369000
163700           ELSE                                                   16370000
163710             MOVE ACCOUNT-CLASS TO PJ-ACCT-ID                     16371000
163720             MOVE EDIT-ACCT-NO TO PJ-ACCT-NO.                     16372000
163730     MOVE PROC-BK-NO TO PL-BANK-NO.                               16373000
163740     MOVE 080 TO PL-REPORT-CODE.                                  16374000
163750     IF PROC-DSD                                                  16375000
163760         MOVE 001 TO PL-ACCT-ID                                   16376000
163770       ELSE                                                       16377000
163780         MOVE 004 TO PL-ACCT-ID.                                  16378000
163790     ADD 1 TO SEQ-NO-WK.                                          16379000
163800     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16380000
163810     MOVE PJ-DETAIL-LINE TO PL-PRINT-LINE.                        16381000
163820     MOVE '1' TO PL-CC.                                           16382000
163830     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16383000
163840     MOVE SPACES TO PJ-DETAIL-LINE.                               16384000
163850     ADD 1 TO LINE-CNT.                                           16385000
163860                                                                  16386000
163870 P6799-EXIT.                                                      16387000
163880     EXIT.                                                        16388000
163890                                                                  16389000
163900******************************************************************16390000
163910**** P R I N T * D A I L Y   T O T A L S * P R I N T *************16391000
163920******************************************************************16392000
163930 P6800-DAILY-TOTALS.                                              16393000
163940     MOVE SPACES TO DT-DETAIL-LINE-1                              16394000
163950                    DT-DETAIL-LINE-2                              16395000
163960                    DT-DETAIL-LINE-3.                             16396000
163970     MOVE 82 TO H-MODULE-NO  PL-REPORT-CODE.                      16397000
163980     MOVE PROC-BK-NO TO PL-BANK-NO.                               16398000
163990     MOVE ZEROS TO SEQ-NO-WK.                                     16399000
164000     IF PROC-DSD                                                  16400000
164010         MOVE 001 TO PL-ACCT-ID                                   16401000
164020       ELSE                                                       16402000
164030         MOVE 004 TO PL-ACCT-ID.                                  16403000
164040     MOVE ZEROS TO PAGE-CNT.                                      16404000
164050     MOVE 'D A I L Y   T O T A L S' TO H-REPT-NAME.               16405000
164060     MOVE SPACES TO H-DISTRIBUTION.                               16406000
164070                                                                  16407000
164080 P6802-PRINT-DAILY-TOT-HEADS.                                     16408000
164090     MOVE ZEROS TO LINE-CNT.                                      16409000
164100     ADD 1 TO PAGE-CNT.                                           16410000
164110     MOVE PAGE-CNT TO H-PAGE-NO.                                  16411000
164120     ADD 1 TO SEQ-NO-WK.                                          16412000
164130     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16413000
164140     MOVE DSDS-HEAD-1 TO PL-PRINT-LINE.                           16414000
164150     MOVE '0' TO PL-CC.                                           16415000
164160     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16416000
164170     ADD 1 TO SEQ-NO-WK.                                          16417000
164180     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16418000
164190     MOVE DSDS-HEAD-2 TO PL-PRINT-LINE.                           16419000
164200     MOVE '1' TO PL-CC.                                           16420000
164210     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16421000
164220     ADD 1 TO SEQ-NO-WK.                                          16422000
164230     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16423000
164240     MOVE SPACE-LINE TO PL-PRINT-LINE.                            16424000
164250     MOVE '1' TO PL-CC.                                           16425000
164260     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16426000
164270     ADD 3 TO LINE-CNT.                                           16427000
164280                                                                  16428000
164290 P6804-EXIT.                                                      16429000
164300     EXIT.                                                        16430000
164310                                                                  16431000
164320 P6806-DT-TYPE-HEADS.                                             16432000
164330     ADD 1 TO SEQ-NO-WK.                                          16433000
164340     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16434000
164350     MOVE DT-HEADING-LINE-10A TO PL-PRINT-LINE.                   16435000
164360     MOVE '2' TO PL-CC.                                           16436000
164370     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT                    16437000
164380     ADD 1 TO SEQ-NO-WK.                                          16438000
164390     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16439000
164400     MOVE DT-HEADING-LINE-9 TO PL-PRINT-LINE.                     16440000
164410     MOVE '2' TO PL-CC.                                           16441000
164420     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16442000
164430     ADD 1 TO SEQ-NO-WK.                                          16443000
164440     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16444000
164450     MOVE DT-HEADING-LINE-10 TO PL-PRINT-LINE.                    16445000
164460     MOVE '1' TO PL-CC.                                           16446000
164470     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16447000
164480     ADD 1 TO SEQ-NO-WK.                                          16448000
164490     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16449000
164500     MOVE SPACE-LINE TO PL-PRINT-LINE.                            16450000
164510     MOVE '1' TO PL-CC.                                           16451000
164520     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16452000
164530     ADD 6 TO LINE-CNT.                                           16453000
164540                                                                  16454000
164550 P6808-DT-TYPE-DTL.                                               16455000
164560     MOVE ZEROS TO SUB6.                                          16456000
164570                                                                  16457000
164580 P6810-DT-INCR-TYPE-LOOP.                                         16458000
164590     ADD 1 TO SUB6.                                               16459000
164600     IF SUB6 GREATER THAN 99                                      16460000
164610         GO TO P6824-DT-TYPE-TOTAL-ALL.                           16461000
164620     IF SUB6 = 10 OR 20 OR 30 OR 40 OR 50 OR 60 OR 70 OR 80 OR 90 16462000
164630         GO TO P6814-DT-TYPE-SUBTOTAL.                            16463000
164640                                                                  16464000
164650 P6812-DT-SUB-TOT-RETURN.                                         16465000
164660     IF NUMBER-BY-TYPE (SUB6) = ZERO                              16466000
164670         GO TO P6810-DT-INCR-TYPE-LOOP.                           16467000
164680     MOVE TYP-DESC (SUB6)        TO DT1-DESCRIPTION.              16468000
164690     MOVE NUMBER-BY-TYPE (SUB6)  TO DT1-NUMBER.                   16469000
164700     ADD  NUMBER-BY-TYPE (SUB6)  TO NUMBER-SUBTYPE.               16470000
164710     MOVE CUR-BAL-BY-TYPE (SUB6) TO DT1-BALANCE.                  16471000
164720     ADD  CUR-BAL-BY-TYPE (SUB6) TO CUR-BAL-SUBTYPE.              16472000
164730     MOVE NO-DEB-BY-TYPE (SUB6)  TO DT1-NO-DEBITS.                16473000
164740     ADD  NO-DEB-BY-TYPE (SUB6)  TO NO-DEB-SUBTYPE.               16474000
164750     MOVE NO-CRE-BY-TYPE (SUB6)  TO DT1-NO-CREDITS.               16475000
164760     ADD  NO-CRE-BY-TYPE (SUB6)  TO NO-CRE-SUBTYPE.               16476000
164770     MOVE AMT-CRE-BY-TYPE (SUB6) TO DT1-AMT-CREDITS.              16477000
164780     ADD  AMT-CRE-BY-TYPE (SUB6) TO AMT-CRE-SUBTYPE.              16478000
164790     MOVE AMT-DEB-BY-TYPE (SUB6) TO DT1-AMT-DEBITS.               16479000
164800     ADD  AMT-DEB-BY-TYPE (SUB6) TO AMT-DEB-SUBTYPE.              16480000
164810     IF NUMBER-BY-TYPE (100) = ZEROS                              16481000
164820         MOVE ZEROS TO HOLD-DT-PERCENT                            16482000
164830       ELSE                                                       16483000
164840         COMPUTE HOLD-DT-PERCENT =                                16484000
164850             100 *                                                16485000
164860             (NUMBER-BY-TYPE (SUB6) / NUMBER-BY-TYPE (100)).      16486000
164870     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      16487000
164880     IF CUR-BAL-BY-TYPE (100) = ZEROS                             16488000
164890         MOVE ZEROS TO HOLD-DT-PERCENT                            16489000
164900       ELSE                                                       16490000
164910         COMPUTE HOLD-DT-PERCENT =                                16491000
164920             100 *                                                16492000
164930             (CUR-BAL-BY-TYPE (SUB6) / CUR-BAL-BY-TYPE (100)).    16493000
164940     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     16494000
164950     IF LINE-CNT GREATER THAN 62                                  16495000
164960         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT      16496000
164970         PERFORM P6806-DT-TYPE-HEADS.                             16497000
164980     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16498000
164990     ADD 1 TO DAILY-TOT-SW.                                       16499000
165000     PERFORM P6910-WRITE-ACRS-TYPE THRU P6919-EXIT.               16500000
165010     GO TO P6810-DT-INCR-TYPE-LOOP.                               16501000
165020                                                                  16502000
165030 P6814-DT-TYPE-SUBTOTAL.                                          16503000
165040     IF DAILY-TOT-SW = 1                                          16504000
165050         GO TO P6816-NO-SUB-DT.                                   16505000
165060     IF DAILY-TOT-SW = 0                                          16506000
165070         GO TO P6817-EXIT.                                        16507000
165080     IF LINE-CNT GREATER THAN 62                                  16508000
165090         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT      16509000
165100         PERFORM P6806-DT-TYPE-HEADS.                             16510000
165110     MOVE DT-DASH-LINE-2 TO DT-DETAIL-LINE-1.                     16511000
165120     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16512000
165130     MOVE CUR-BAL-SUBTYPE TO DT1-BALANCE.                         16513000
165140     MOVE NUMBER-SUBTYPE TO DT1-NUMBER.                           16514000
165150     MOVE NO-DEB-SUBTYPE TO DT1-NO-DEBITS.                        16515000
165160     MOVE NO-CRE-SUBTYPE TO DT1-NO-CREDITS.                       16516000
165170     MOVE AMT-CRE-SUBTYPE TO DT1-AMT-CREDITS.                     16517000
165180     MOVE AMT-DEB-SUBTYPE TO DT1-AMT-DEBITS.                      16518000
165190     IF NUMBER-BY-TYPE (100) = ZEROS                              16519000
165200         MOVE ZEROS TO HOLD-DT-PERCENT                            16520000
165210       ELSE                                                       16521000
165220       COMPUTE HOLD-DT-PERCENT =                                  16522000
165230           100 *                                                  16523000
165240           (NUMBER-SUBTYPE / NUMBER-BY-TYPE (100)).               16524000
165250     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      16525000
165260     IF CUR-BAL-BY-TYPE (100) = ZEROS                             16526000
165270         MOVE ZEROS TO HOLD-DT-PERCENT                            16527000
165280       ELSE                                                       16528000
165290       COMPUTE HOLD-DT-PERCENT =                                  16529000
165300           100 *                                                  16530000
165310           (CUR-BAL-SUBTYPE / CUR-BAL-BY-TYPE (100)).             16531000
165320     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     16532000
165330     MOVE SPACES TO DT1-DESCRIPTION.                              16533000
165340     IF LINE-CNT GREATER THAN 62                                  16534000
165350         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT      16535000
165360         PERFORM P6806-DT-TYPE-HEADS.                             16536000
165370     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16537000
165380                                                                  16538000
165390 P6816-NO-SUB-DT.                                                 16539000
165400     MOVE ZEROS TO NUMBER-SUBTYPE.                                16540000
165410     MOVE ZEROS TO CUR-BAL-SUBTYPE.                               16541000
165420     MOVE ZEROS TO NO-DEB-SUBTYPE.                                16542000
165430     MOVE ZEROS TO NO-CRE-SUBTYPE.                                16543000
165440     MOVE ZEROS TO AMT-CRE-SUBTYPE.                               16544000
165450     MOVE ZEROS TO AMT-DEB-SUBTYPE.                               16545000
165460     MOVE 0 TO DAILY-TOT-SW.                                      16546000
165470     MOVE SPACE-LINE TO DT-DETAIL-LINE-1.                         16547000
165480     IF LINE-CNT GREATER THAN 62                                  16548000
165490         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT      16549000
165500         PERFORM P6806-DT-TYPE-HEADS.                             16550000
165510     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16551000
165520                                                                  16552000
165530 P6817-EXIT.                                                      16553000
165540     EXIT.                                                        16554000
165550                                                                  16555000
165560 P6818-END-DT-TYPE-SUB.                                           16556000
165570     GO TO P6812-DT-SUB-TOT-RETURN.                               16557000
165580                                                                  16558000
165590 P6820-PRINT-DT-1-LINE.                                           16559000
165600     IF LINE-CNT GREATER THAN 62                                  16560000
165610         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.     16561000
165620     ADD 1 TO SEQ-NO-WK.                                          16562000
165630     MOVE SEQ-NO-WK TO PL-SEQ-NO.                                 16563000
165640     MOVE DT-DETAIL-LINE-1 TO PL-PRINT-LINE.                      16564000
165650     MOVE '1' TO PL-CC.                                           16565000
165660     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   16566000
165670     MOVE SPACES TO DT-DETAIL-LINE-1.                             16567000
165680     ADD 1 TO LINE-CNT.                                           16568000
165690                                                                  16569000
165700 P6822-EXIT.                                                      16570000
165710     EXIT.                                                        16571000
165720                                                                  16572000
165730 P6824-DT-TYPE-TOTAL-ALL.                                         16573000
165740     IF DAILY-TOT-SW NOT = 0                                      16574000
165750         PERFORM P6814-DT-TYPE-SUBTOTAL THRU P6817-EXIT.          16575000
165760     IF NUMBER-BY-TYPE (100) = ZERO                               16576000
165770         GO TO P6828-DO-DT-STRATA-HEADINGS.                       16577000
165780     MOVE 'GRAND TOTAL' TO DT1-DESCRIPTION.                       16578000
165790     MOVE 100.00 TO DT1-PERCENT-NO.                               16579000
165800     MOVE 100.00 TO DT1-PERCENT-BAL.                              16580000
165810     MOVE NUMBER-BY-TYPE (100) TO DT1-NUMBER.                     16581000
165820     MOVE CUR-BAL-BY-TYPE (100) TO DT1-BALANCE.                   16582000
165830     MOVE NO-DEB-BY-TYPE (100) TO DT1-NO-DEBITS.                  16583000
165840     MOVE NO-CRE-BY-TYPE (100) TO DT1-NO-CREDITS.                 16584000
165850     MOVE AMT-DEB-BY-TYPE (100) TO DT1-AMT-DEBITS.                16585000
165860     MOVE AMT-CRE-BY-TYPE (100) TO DT1-AMT-CREDITS.               16586000
165870     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16587000
165880                                                                  16588000
165890 P6828-DO-DT-STRATA-HEADINGS.                                     16589000
165900     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         16590000
165910     MOVE DT-HEADING-LINE-3 TO DT-DETAIL-LINE-1.                  16591000
165920     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16592000
165930     MOVE DT-HEADING-LINE-4 TO DT-DETAIL-LINE-1.                  16593000
165940     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       16594000
165950                                                                  16595000
165960 P6830-DO-STRATA-DTL.                                             16596000
165970     MOVE DT-HEADING-LINE-12 TO DT-DETAIL-LINE-1.                 16597000
165980     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       16598000
165990     MOVE ZEROS TO SUB6.                                          16599000
166000                                                                  16600000
166010 P6832-DT-STRATA-LOOP.                                            16601000
166020     ADD 1 TO SUB6.                                               16602000
166030     IF SUB6 GREATER THAN 17                                      16603000
166040         GO TO P6834-DT-STRATA-GRAND.                             16604000
166050     IF NUMBER-BY-STRATA (SUB6) = ZERO                            16605000
166060         GO TO P6832-DT-STRATA-LOOP.                              16606000
166070     MOVE STRATA-DESC-BY-CLASS (SUB6) TO DT1-DESCRIPTION.         16607000
166080     MOVE NUMBER-BY-STRATA (SUB6) TO DT1-NUMBER.                  16608000
166090     MOVE CUR-BAL-BY-STRATA (SUB6) TO DT1-BALANCE.                16609000
166100     IF NUMBER-BY-STRATA (18) = ZEROS                             16610000
166110         MOVE ZERO TO HOLD-DT-PERCENT                             16611000
166120       ELSE                                                       16612000
166130         COMPUTE HOLD-DT-PERCENT =                                16613000
166140             100 *                                                16614000
166150             (NUMBER-BY-STRATA (SUB6) / NUMBER-BY-STRATA (18)).   16615000
166160     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      16616000
166170     IF CUR-BAL-BY-STRATA (18) = ZEROS                            16617000
166180         MOVE ZERO TO HOLD-DT-PERCENT                             16618000
166190       ELSE                                                       16619000
166200         COMPUTE HOLD-DT-PERCENT =                                16620000
166210             100 *                                                16621000
166220             (CUR-BAL-BY-STRATA (SUB6) / CUR-BAL-BY-STRATA (18)). 16622000
166230     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     16623000
166240     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16624000
166250     PERFORM P6920-WRITE-ACRS-STRATA THRU P6929-EXIT.             16625000
166260     GO TO P6832-DT-STRATA-LOOP.                                  16626000
166270                                                                  16627000
166280 P6834-DT-STRATA-GRAND.                                           16628000
166290     MOVE DT-DASH-LINE-1 TO DT-DETAIL-LINE-1.                     16629000
166300     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16630000
166310     MOVE NUMBER-BY-STRATA (18) TO DT1-NUMBER.                    16631000
166320     MOVE 100.00 TO DT1-PERCENT-NO.                               16632000
166330     MOVE 100.00 TO DT1-PERCENT-BAL.                              16633000
166340     MOVE CUR-BAL-BY-STRATA (18) TO DT1-BALANCE.                  16634000
166350     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16635000
166360     MOVE 18 TO SUB6.                                             16636000
166370     PERFORM P6920-WRITE-ACRS-STRATA THRU P6929-EXIT.             16637000
166380                                                                  16638000
166390 P6844-DT-END-STRATA-TOTALS.                                      16639000
166400     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         16640000
166410     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16641000
166420     MOVE SPACES TO DT-DETAIL-LINE-2.                             16642000
166430     MOVE DT-HEADING-LINE-5 TO DT-DETAIL-LINE-1.                  16643000
166440     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16644000
166450     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16645000
166460     MOVE 'BEGINNING BALANCE' TO DT2-DESCRIPTION1.                16646000
166470     MOVE BEG-CUR-BAL TO DT2-BALANCE1.                            16647000
166480     MOVE BEG-NUM-ACCTS TO DT2-NUMBER1.                           16648000
166490     IF ODB-BANK                                                  16649000
166500         MOVE 'BEGINNING LOAN BALANCE' TO DT2-DESCRIPTION2        16650000
166510         MOVE BEG-LOAN-BAL TO DT2-BALANCE2                        16651000
166520         MOVE BEG-NUM-LOANS TO DT2-NUMBER2.                       16652000
166530     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16653000
166540     MOVE SPACES TO DT-DETAIL-LINE-2.                             16654000
166550     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16655000
166560     MOVE ' PLUS DEPOSITS' TO DT2-DESCRIPTION1.                   16656000
166570     MOVE NUM-REG-CREDITS TO DT2-NUMBER1.                         16657000
166580     MOVE AMT-REG-CREDITS TO DT2-BALANCE1.                        16658000
166590     IF ODB-BANK                                                  16659000
166600         MOVE ' PLUS AUTOMATIC ADVANCES' TO DT2-DESCRIPTION2      16660000
166610         MOVE NUM-AUTO-ADVANCES TO DT2-NUMBER2                    16661000
166620         MOVE AMT-AUTO-ADVANCES TO DT2-BALANCE2.                  16662000
166630     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16663000
166640     MOVE SPACES TO DT-DETAIL-LINE-2.                             16664000
166650     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16665000
166660     MOVE ' LESS WITHDRAWALS' TO DT2-DESCRIPTION1.                16666000
166670     MOVE NUM-REG-DEBITS TO DT2-NUMBER1.                          16667000
166680     MOVE AMT-REG-DEBITS TO DT2-BALANCE1.                         16668000
166690     IF ODB-BANK                                                  16669000
166700         MOVE ' LESS AUTOMATIC PAYMENTS' TO DT2-DESCRIPTION2      16670000
166710         MOVE NUM-AUTO-PAYMENTS TO DT2-NUMBER2                    16671000
166720         MOVE AMT-AUTO-PAYMENTS TO DT2-BALANCE2.                  16672000
166730     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16673000
166740     MOVE SPACES TO DT-DETAIL-LINE-2.                             16674000
166750     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16675000
166760     MOVE ' PLUS FT CREDITS' TO DT2-DESCRIPTION1.                 16676000
166770     MOVE NUM-FT-CREDITS TO DT2-NUMBER1.                          16677000
166780     MOVE AMT-FT-CREDITS TO DT2-BALANCE1.                         16678000
166790     IF ODB-BANK                                                  16679000
166800         MOVE ' PLUS MANUAL ADVANCES' TO DT2-DESCRIPTION2         16680000
166810         MOVE NUM-MANUAL-ADVANCES TO DT2-NUMBER2                  16681000
166820         MOVE AMT-MANUAL-ADVANCES TO DT2-BALANCE2.                16682000
166830     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16683000
166840     MOVE SPACES TO DT-DETAIL-LINE-2.                             16684000
166850     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16685000
166860     MOVE ' LESS FT DEBITS' TO DT2-DESCRIPTION1.                  16686000
166870     MOVE NUM-FT-DEBITS  TO DT2-NUMBER1.                          16687000
166880     MOVE AMT-FT-DEBITS  TO DT2-BALANCE1.                         16688000
166890     IF ODB-BANK                                                  16689000
166900         MOVE ' LESS MANUAL PAYMENTS' TO DT2-DESCRIPTION2         16690000
166910         MOVE NUM-MANUAL-PAYMENTS TO DT2-NUMBER2                  16691000
166920         MOVE AMT-MANUAL-PAYMENTS TO DT2-BALANCE2.                16692000
166930     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16693000
166940     MOVE SPACES TO DT-DETAIL-LINE-2.                             16694000
166950     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16695000
166960     MOVE ' PLUS ADS CREDITS' TO DT2-DESCRIPTION1.                16696000
166970     MOVE NUM-ADS-CREDITS TO DT2-NUMBER1.                         16697000
166980     MOVE AMT-ADS-CREDITS TO DT2-BALANCE1.                        16698000
166990     IF ODB-BANK                                                  16699000
167000         MOVE ' PLUS OVERLINE ADVANCES' TO DT2-DESCRIPTION2       16700000
167010         MOVE NUM-OVER-ADVANCES   TO DT2-NUMBER2                  16701000
167020         MOVE AMT-OVER-ADVANCES   TO DT2-BALANCE2.                16702000
167030     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16703000
167040     MOVE SPACES TO DT-DETAIL-LINE-2.                             16704000
167050     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16705000
167060     MOVE ' LESS ADS DEBITS'  TO DT2-DESCRIPTION1.                16706000
167070     MOVE NUM-ADS-DEBITS  TO DT2-NUMBER1.                         16707000
167080     MOVE AMT-ADS-DEBITS  TO DT2-BALANCE1.                        16708000
167090     IF ODB-BANK                                                  16709000
167100         MOVE ' PLUS OTHER DEBITS'      TO DT2-DESCRIPTION2       16710000
167110         MOVE NUM-OTH-ODB-DEB     TO DT2-NUMBER2                  16711000
167120         MOVE AMT-OTH-ODB-DEB     TO DT2-BALANCE2.                16712000
167130     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16713000
167140     MOVE SPACES TO DT-DETAIL-LINE-2.                             16714000
167150     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16715000
167160     MOVE ' PLUS ATM CREDITS' TO DT2-DESCRIPTION1.                16716000
167170     MOVE NUM-ATM-CREDITS TO DT2-NUMBER1.                         16717000
167180     MOVE AMT-ATM-CREDITS TO DT2-BALANCE1.                        16718000
167190     IF ODB-BANK                                                  16719000
167200         MOVE ' LESS OTHER CREDITS'     TO DT2-DESCRIPTION2       16720000
167210         MOVE NUM-OTH-ODB-CRE     TO DT2-NUMBER2                  16721000
167220         MOVE AMT-OTH-ODB-CRE     TO DT2-BALANCE2.                16722000
167230     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16723000
167240     MOVE SPACES TO DT-DETAIL-LINE-2.                             16724000
167250     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16725000
167260     MOVE ' LESS ATM DEBITS'  TO DT2-DESCRIPTION1.                16726000
167270     MOVE NUM-ATM-DEBITS  TO DT2-NUMBER1.                         16727000
167280     MOVE AMT-ATM-DEBITS  TO DT2-BALANCE1.                        16728000
167290     IF ODB-BANK                                                  16729000
167300         MOVE ' PLUS FINANCE CHARGES'   TO DT2-DESCRIPTION2       16730000
167310         MOVE NUM-FINANCE-CHARGE  TO DT2-NUMBER2                  16731000
167320         MOVE AMT-FINANCE-CHARGE  TO DT2-BALANCE2.                16732000
167330     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16733000
167340     MOVE SPACES TO DT-DETAIL-LINE-2.                             16734000
167350     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16735000
167360     MOVE ' PLUS PAYROLL CREDITS' TO DT2-DESCRIPTION1.            16736000
167370     MOVE NUM-PAY-CREDITS TO DT2-NUMBER1.                         16737000
167380     MOVE AMT-PAY-CREDITS TO DT2-BALANCE1.                        16738000
167390     IF ODB-BANK                                                  16739000
167400         MOVE ' PLUS CREDIT LIFE'       TO DT2-DESCRIPTION2       16740000
167410         MOVE NUM-CR-LIFE-CHARGE  TO DT2-NUMBER2                  16741000
167420         MOVE AMT-CR-LIFE-CHARGE  TO DT2-BALANCE2.                16742000
167430     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16743000
167440     MOVE SPACES TO DT-DETAIL-LINE-2.                             16744000
167450     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16745000
167460     MOVE ' LESS PAYROLL DEBITS'  TO DT2-DESCRIPTION1.            16746000
167470     MOVE NUM-PAY-DEBITS  TO DT2-NUMBER1.                         16747000
167480     MOVE AMT-PAY-DEBITS  TO DT2-BALANCE1.                        16748000
167490     IF ODB-BANK                                                  16749000
167500         MOVE 'ENDING LOAN BALANCE'     TO DT2-DESCRIPTION2       16750000
167510         MOVE END-NUM-LOANS       TO DT2-NUMBER2                  16751000
167520         MOVE END-LOAN-BAL        TO DT2-BALANCE2.                16752000
167530     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16753000
167540     MOVE SPACES TO DT-DETAIL-LINE-2.                             16754000
167550     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16755000
167560     IF ODB-BANK                                                  16756000
167570         MOVE ' PLUS ADVANCES'        TO DT2-DESCRIPTION1         16757000
167580         MOVE NUM-ODB-CREDITS-DDA TO DT2-NUMBER1                  16758000
167590         MOVE AMT-ODB-CREDITS-DDA TO DT2-BALANCE1                 16759000
167600         MOVE 'APPROVED ODB LINES' TO DT2-DESCRIPTION2            16760000
167610         MOVE NUM-APPROVED-ODB TO DT2-NUMBER2                     16761000
167620         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16762000
167630         MOVE SPACES TO DT-DETAIL-LINE-2                          16763000
167640         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            16764000
167650         MOVE ' LESS PAYMENTS'        TO DT2-DESCRIPTION1         16765000
167660         MOVE NUM-ODB-DEBITS-DDA  TO DT2-NUMBER1                  16766000
167670         MOVE AMT-ODB-DEBITS-DDA TO DT2-BALANCE1                  16767000
167680         MOVE 'OTHER ODB LINES' TO DT2-DESCRIPTION2               16768000
167690         MOVE NUM-OTHER-ODB TO DT2-NUMBER2                        16769000
167700         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16770000
167710         MOVE SPACES TO DT-DETAIL-LINE-2                          16771000
167720         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            16772000
167730         MOVE 'CREDIT-LIFE IN FORCE' TO DT2-DESCRIPTION2          16773000
167740         MOVE NUM-CR-LIFE-ACCTS TO DT2-NUMBER2                    16774000
167750         MOVE AMT-CR-LIFE-ACCTS TO DT2-BALANCE2                   16775000
167760         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16776000
167770         MOVE SPACES TO DT-DETAIL-LINE-2                          16777000
167780         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           16778000
167790     MOVE SPACES TO DT-DETAIL-LINE-2.                             16779000
167800     IF ODB-BANK                                                  16780000
167810         MOVE 'ODB FIN. CHRG. DROPPED'  TO DT2-DESCRIPTION2       16781000
167820         MOVE NUM-FIN-CHG-DROP    TO DT2-NUMBER2                  16782000
167830         MOVE AMT-FIN-CHG-DROP    TO DT2-BALANCE2.                16783000
167840     MOVE 'ENDING BALANCE'        TO DT2-DESCRIPTION1.            16784000
167850     MOVE END-NUM-ACCTS   TO DT2-NUMBER1.                         16785000
167860     MOVE END-CUR-BAL     TO DT2-BALANCE1.                        16786000
167870     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16787000
167880     MOVE SPACES TO DT-DETAIL-LINE-2.                             16788000
167890     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16789000
167900     IF ODB-BANK                                                  16790000
167910         MOVE 'ODB CREDIT LIFE DROPPED' TO DT2-DESCRIPTION2       16791000
167920         MOVE NUM-CR-LIFE-DROP    TO DT2-NUMBER2                  16792000
167930         MOVE AMT-CR-LIFE-DROP    TO DT2-BALANCE2                 16793000
167940         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16794000
167950         MOVE SPACES TO DT-DETAIL-LINE-2                          16795000
167960         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            16796000
167970         MOVE 'ODB EXCESS PAYMENTS' TO DT2-DESCRIPTION2           16797000
167980         MOVE NUM-ODB-EXCESS-PMNT TO DT2-NUMBER2                  16798000
167990         MOVE AMT-ODB-EXCESS-PMNT TO DT2-BALANCE2                 16799000
168000         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16800000
168010         MOVE SPACES TO DT-DETAIL-LINE-2.                         16801000
168020     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16802000
168030     IF NUM-INV-MATURITIES NOT = ZERO                             16803000
168040         MOVE ' PLUS INV MATURITIES'  TO DT2-DESCRIPTION1         16804000
168050         MOVE NUM-INV-MATURITIES TO DT2-NUMBER1                   16805000
168060         MOVE AMT-INV-MATURITIES TO DT2-BALANCE1                  16806000
168070         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16807000
168080         MOVE SPACES TO DT-DETAIL-LINE-2                          16808000
168090         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           16809000
168100     IF NUM-INV-PURCHASES NOT = ZERO                              16810000
168110         MOVE ' LESS INV PURCHASES'  TO DT2-DESCRIPTION1          16811000
168120         MOVE NUM-INV-PURCHASES TO DT2-NUMBER1                    16812000
168130         MOVE AMT-INV-PURCHASES TO DT2-BALANCE1                   16813000
168140         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16814000
168150         MOVE SPACES TO DT-DETAIL-LINE-2                          16815000
168160         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           16816000
168170     IF NUM-INV-INTEREST NOT = ZERO                               16817000
168180         MOVE ' PLUS INV INTEREST' TO DT2-DESCRIPTION1            16818000
168190         MOVE NUM-INV-INTEREST TO DT2-NUMBER1                     16819000
168200         MOVE AMT-INV-INTEREST TO DT2-BALANCE1                    16820000
168210         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16821000
168220         MOVE SPACES TO DT-DETAIL-LINE-2                          16822000
168230         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           16823000
168240     MOVE 'GENERATED CREDITS' TO DT2-DESCRIPTION1.                16824000
168250     MOVE GEN-CREDIT-CNT TO DT2-NUMBER1.                          16825000
168260     MOVE GEN-CREDIT-AMT TO DT2-BALANCE1.                         16826000
168270     IF ODB-BANK                                                  16827000
168280         MOVE 'ODB YTD FIN CHG UNSECURE' TO DT2-DESCRIPTION2      16828000
168290         MOVE AMT-ODB-FIN-CHRG-UNSECURED TO DT2-BALANCE2.         16829000
168300     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16830000
168310     MOVE SPACES TO DT-DETAIL-LINE-2.                             16831000
168320     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16832000
168330     MOVE 'GENERATED DEBITS' TO DT2-DESCRIPTION1.                 16833000
168340     MOVE GEN-DEBIT-CNT TO DT2-NUMBER1.                           16834000
168350     MOVE GEN-DEBIT-AMT TO DT2-BALANCE1.                          16835000
168360     IF ODB-BANK                                                  16836000
168370         MOVE 'ODB YTD FIN CHG SECURED' TO DT2-DESCRIPTION2       16837000
168380         MOVE AMT-ODB-FIN-CHRG-SECURED TO DT2-BALANCE2.           16838000
168390     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16839000
168400     MOVE SPACES TO DT-DETAIL-LINE-2.                             16840000
168410     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16841000
168420     MOVE 'ZBA CREDITS' TO DT2-DESCRIPTION1.                      16842000
168430     MOVE NUM-ZBA-CREDITS TO DT2-NUMBER1.                         16843000
168440     MOVE AMT-ZBA-CREDITS TO DT2-BALANCE1.                        16844000
168450     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16845000
168460     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16846000
168470     MOVE 'ZBA DEBITS' TO DT2-DESCRIPTION1.                       16847000
168480     MOVE NUM-ZBA-DEBITS TO DT2-NUMBER1.                          16848000
168490     MOVE AMT-ZBA-DEBITS TO DT2-BALANCE1.                         16849000
168500     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16850000
168510     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16851000
168520     MOVE 'ODP CREDITS' TO DT2-DESCRIPTION1.                      16852000
168530     MOVE NUM-ODP-CREDITS TO DT2-NUMBER1.                         16853000
168540     MOVE AMT-ODP-CREDITS TO DT2-BALANCE1.                        16854000
168550     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16855000
168560     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16856000
168570     MOVE 'ODP DEBITS' TO DT2-DESCRIPTION1.                       16857000
168580     MOVE NUM-ODP-DEBITS TO DT2-NUMBER1.                          16858000
168590     MOVE AMT-ODP-DEBITS TO DT2-BALANCE1.                         16859000
168600     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16860000
168610     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16861000
168620                                                                  16862000
168630     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16863000
168640     MOVE 'ML HELOC CREDITS' TO DT2-DESCRIPTION1.                 16864000
168650     MOVE NUM-HELOC-CREDITS TO DT2-NUMBER1.                       16865000
168660     MOVE AMT-HELOC-CREDITS TO DT2-BALANCE1.                      16866000
168670     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16867000
168680     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16868000
168690     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16869000
168700                                                                  16870000
168710     MOVE 'CLSN BR CREDITS'   TO DT2-DESCRIPTION1.                16871000
168720     MOVE NUM-CLSN-BR-CREDITS TO DT2-NUMBER1.                     16872000
168730     MOVE AMT-CLSN-BR-CREDITS TO DT2-BALANCE1.                    16873000
168740     MOVE DT-DETAIL-LINE-2    TO DT-DETAIL-LINE-1.                16874000
168750     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16875000
168760     MOVE 'CLSN BR DEBITS'    TO DT2-DESCRIPTION1.                16876000
168770     MOVE NUM-CLSN-BR-DEBITS  TO DT2-NUMBER1.                     16877000
168780     MOVE AMT-CLSN-BR-DEBITS  TO DT2-BALANCE1.                    16878000
168790     MOVE DT-DETAIL-LINE-2    TO DT-DETAIL-LINE-1.                16879000
168800     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16880000
168810     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16881000
168820                                                                  16882000
168830     MOVE 'ICS CREDITS'       TO DT2-DESCRIPTION1.                16883000
168840     MOVE NUM-ICS-CREDITS     TO DT2-NUMBER1.                     16884000
168850     MOVE AMT-ICS-CREDITS     TO DT2-BALANCE1.                    16885000
168860     MOVE DT-DETAIL-LINE-2    TO DT-DETAIL-LINE-1.                16886000
168870     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16887000
168880     MOVE 'ICS DEBITS'        TO DT2-DESCRIPTION1.                16888000
168890     MOVE NUM-ICS-DEBITS      TO DT2-NUMBER1.                     16889000
168900     MOVE AMT-ICS-DEBITS      TO DT2-BALANCE1.                    16890000
168910     MOVE DT-DETAIL-LINE-2    TO DT-DETAIL-LINE-1.                16891000
168920     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16892000
168930     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16893000
168940                                                                  16894000
168950     MOVE SPACES TO DT-DETAIL-LINE-2.                             16895000
168960     MOVE 'CLOSED ACCOUNTS'       TO DT2-DESCRIPTION1.            16896000
168970     MOVE NUM-CLOSED-ACCTS TO DT2-NUMBER1.                        16897000
168980     MOVE 'ACCOUNTS CLOSED TODAY/' TO DT2-DESCRIPTION2.           16898000
168990     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16899000
169000     MOVE SPACES TO DT-DETAIL-LINE-2.                             16900000
169010     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16901000
169020     MOVE 'ACCTS WITH ZERO BALANCE' TO DT2-DESCRIPTION1.          16902000
169030     MOVE NUM-ZERO-ACCTS   TO DT2-NUMBER1.                        16903000
169040     MOVE 'FOREIGN ATM FEES DROPPED' TO DT2-DESCRIPTION2.         16904000
169050     MOVE NUM-CLOSED-TODAY TO DT2-NUMBER2.                        16905000
169060     MOVE FOR-ATM-FEE-DROPPED TO DT2-BALANCE2.                    16906000
169070     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16907000
169080     MOVE SPACES TO DT-DETAIL-LINE-2.                             16908000
169090     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16909000
169100     MOVE 'ACCOUNTS ERASED' TO DT2-DESCRIPTION1.                  16910000
169110     MOVE NUM-ERASED-ACCTS TO DT2-NUMBER1.                        16911000
169120     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16912000
169130     MOVE SPACES TO DT-DETAIL-LINE-2.                             16913000
169140     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16914000
169150     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16915000
169160     MOVE '  INT. PAID YTD BY IDENT' TO DT2-DESCRIPTION1.         16916000
169170     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16917000
169180     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16918000
169190     MOVE 1 TO SUB6.                                              16919000
169200                                                                  16920000
169210 P6846-DT-YTD-INT-LOOP.                                           16921000
169220     IF YTD-INT-BY-IDENT (SUB6) NOT = ZERO                        16922000
169230         MOVE DESC-BY-IDENT (SUB6) TO DT2-DESCRIPTION1            16923000
169240         MOVE YTD-INT-BY-IDENT (SUB6) TO DT2-BALANCE1             16924000
169250         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                16925000
169260         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           16926000
169270     ADD 1 TO SUB6.                                               16927000
169280     IF SUB6 = 11                                                 16928000
169290         NEXT SENTENCE                                            16929000
169300       ELSE                                                       16930000
169310         GO TO P6846-DT-YTD-INT-LOOP.                             16931000
169320     MOVE SPACES TO DT-DETAIL-LINE-2.                             16932000
169330     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16933000
169340     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16934000
169350     MOVE 'NUMBER OF ACCTS ' TO DT2-DESCRIPTION1.                 16935000
169360     MOVE END-NUM-ACCTS TO DT2-NUMBER1.                           16936000
169370     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16937000
169380     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16938000
169390     MOVE 'BILLING TX COUNT' TO DT2-DESCRIPTION1.                 16939000
169400     MOVE NUM-BILL-TX TO DT2-NUMBER1.                             16940000
169410     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16941000
169420     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16942000
169430     MOVE 'DEPOSITED ITEM COUNT' TO DT2-DESCRIPTION1.             16943000
169440     MOVE NUM-DEPOSITED-ITEMS TO DT2-NUMBER1.                     16944000
169450     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16945000
169460     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16946000
169470     MOVE 'WIRE TRANSFERS IN' TO DT2-DESCRIPTION1.                16947000
169480     MOVE NUM-WIRES-IN TO DT2-NUMBER1.                            16948000
169490     MOVE AMT-WIRES-IN TO DT2-BALANCE1.                           16949000
169500     MOVE 'INTL WIRE TRANSFERS IN' TO DT2-DESCRIPTION2.           16950000
169510     MOVE NUM-INTL-WIRES-IN TO DT2-NUMBER2.                       16951000
169520     MOVE AMT-INTL-WIRES-IN TO DT2-BALANCE2.                      16952000
169530     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16953000
169540     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16954000
169550     MOVE 'WIRE TRANSFERS OUT' TO DT2-DESCRIPTION1.               16955000
169560     MOVE NUM-WIRES-OUT TO DT2-NUMBER1.                           16956000
169570     MOVE AMT-WIRES-OUT TO DT2-BALANCE1.                          16957000
169580     MOVE 'INTL WIRE TRANSFERS OUT' TO DT2-DESCRIPTION2.          16958000
169590     MOVE NUM-INTL-WIRES-OUT TO DT2-NUMBER2.                      16959000
169600     MOVE AMT-INTL-WIRES-OUT TO DT2-BALANCE2.                     16960000
169610     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16961000
169620     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16962000
169630     MOVE 'MOBILE RDC FEES   ' TO DT2-DESCRIPTION1.               16963000
169640     MOVE NUM-MOBILE-RDC-FEE TO DT2-NUMBER1.                      16964000
169650     MOVE AMT-MOBILE-RDC-FEE TO DT2-BALANCE1.                     16965000
169660     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   16966000
169670     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16967000
169680     MOVE 'WIRE TT&L PAYMENT' TO DT2-DESCRIPTION1.                16968000
169690     MOVE NUM-WIRES-TTL TO DT2-NUMBER1.                           16969000
169700     MOVE AMT-WIRES-TTL TO DT2-BALANCE1.                          16970000
169710     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16971000
169720     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16972000
169730     MOVE SPACES TO DT-DETAIL-LINE-2.                             16973000
169740     MOVE DT-HEADING-LINE-5A TO DT-DETAIL-LINE-1.                 16974000
169750     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16975000
169760     MOVE 'ACCTS BY STMT IMAGE IND' TO DT4-DESCRIPTION1.          16976000
169770     MOVE NUM-ACCTS-WITH-CHKS TO DT4-NUMBER1.                     16977000
169780     MOVE NUM-ACCTS-TRUNCATED TO DT4-NUMBER2.                     16978000
169790     MOVE NUM-ACCTS-IMAGED TO DT4-NUMBER3.                        16979000
169800     MOVE DT-DETAIL-LINE-4 TO DT-DETAIL-LINE-1.                   16980000
169810     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16981000
169820     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16982000
169830     MOVE DT-HEADING-LINE-5B TO DT-DETAIL-LINE-1.                 16983000
169840     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16984000
169850     MOVE '  PRIMARY CYCLE STMTS' TO DT4-DESCRIPTION1.            16985000
169860     MOVE NUM-STMTS-CHKS-PRI TO DT4-NUMBER1.                      16986000
169870     MOVE NUM-STMTS-TRUNC-PRI TO DT4-NUMBER2.                     16987000
169880     MOVE NUM-STMTS-IMAGE-PRI TO DT4-NUMBER3.                     16988000
169890     MOVE DT-DETAIL-LINE-4 TO DT-DETAIL-LINE-1.                   16989000
169900     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16990000
169910     MOVE '  SECONDARY CYCLE STMTS' TO DT4-DESCRIPTION1.          16991000
169920     MOVE NUM-STMTS-CHKS-SEC TO DT4-NUMBER1.                      16992000
169930     MOVE NUM-STMTS-TRUNC-SEC TO DT4-NUMBER2.                     16993000
169940     MOVE NUM-STMTS-IMAGE-SEC TO DT4-NUMBER3.                     16994000
169950     MOVE DT-DETAIL-LINE-4 TO DT-DETAIL-LINE-1.                   16995000
169960     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16996000
169970     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               16997000
169980     MOVE '  STATEMENT ENCLOSURES' TO DT2-DESCRIPTION1.           16998000
169990     MOVE NUM-CYCLE-ENCL TO DT2-NUMBER1.                          16999000
170000     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17000000
170010     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17001000
170020     MOVE '  REQUESTS - CODE 397' TO DT2-DESCRIPTION1.            17002000
170030     MOVE NUM-REQUEST-397 TO DT2-NUMBER1.                         17003000
170040     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17004000
170050     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17005000
170060     MOVE '  REQUESTS - CODE 398' TO DT2-DESCRIPTION1.            17006000
170070     MOVE NUM-REQUEST-398 TO DT2-NUMBER1.                         17007000
170080     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17008000
170090     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17009000
170100     MOVE '  REQUESTS - CODE 399' TO DT2-DESCRIPTION1.            17010000
170110     MOVE NUM-REQUEST-399 TO DT2-NUMBER1.                         17011000
170120     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17012000
170130     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17013000
170140     IF NUM-MAIL-CODE-M GREATER THAN ZERO                         17014000
170150         MOVE '  MAIL CODE - M' TO DT2-DESCRIPTION1               17015000
170160         MOVE NUM-MAIL-CODE-M TO DT2-NUMBER1                      17016000
170170         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17017000
170180         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17018000
170190     IF NUM-MAIL-CODE-H GREATER THAN ZERO                         17019000
170200         MOVE '  MAIL CODE - H' TO DT2-DESCRIPTION1               17020000
170210         MOVE NUM-MAIL-CODE-H TO DT2-NUMBER1                      17021000
170220         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17022000
170230         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17023000
170240     IF NUM-MAIL-CODE-E GREATER THAN ZERO                         17024000
170250         MOVE '  MAIL CODE - E' TO DT2-DESCRIPTION1               17025000
170260         MOVE NUM-MAIL-CODE-E TO DT2-NUMBER1                      17026000
170270         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17027000
170280         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17028000
170290     IF NUM-MAIL-CODE-A GREATER THAN ZERO                         17029000
170300         MOVE '  MAIL CODE - A' TO DT2-DESCRIPTION1               17030000
170310         MOVE NUM-MAIL-CODE-A TO DT2-NUMBER1                      17031000
170320         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17032000
170330         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17033000
170340     IF NUM-MAIL-CODE-C GREATER THAN ZERO                         17034000
170350         MOVE '  MAIL CODE - C' TO DT2-DESCRIPTION1               17035000
170360         MOVE NUM-MAIL-CODE-C TO DT2-NUMBER1                      17036000
170370         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17037000
170380         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17038000
170390     IF NUM-MAIL-CODE-D GREATER THAN ZERO                         17039000
170400         MOVE '  MAIL CODE - D' TO DT2-DESCRIPTION1               17040000
170410         MOVE NUM-MAIL-CODE-D TO DT2-NUMBER1                      17041000
170420         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17042000
170430         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17043000
170440     IF NUM-MAIL-CODE-G GREATER THAN ZERO                         17044000
170450         MOVE '  MAIL CODE - G' TO DT2-DESCRIPTION1               17045000
170460         MOVE NUM-MAIL-CODE-G TO DT2-NUMBER1                      17046000
170470         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17047000
170480         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17048000
170490     IF NUM-MAIL-CODE-X GREATER THAN ZERO                         17049000
170500         MOVE '  MAIL CODE - X' TO DT2-DESCRIPTION1               17050000
170510         MOVE NUM-MAIL-CODE-X TO DT2-NUMBER1                      17051000
170520         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17052000
170530         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17053000
170540     IF NUM-MAIL-CODE-OTHER GREATER THAN ZERO                     17054000
170550         MOVE '  MAIL CODE - OTHER' TO DT2-DESCRIPTION1           17055000
170560         MOVE NUM-MAIL-CODE-OTHER TO DT2-NUMBER1                  17056000
170570         MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1                17057000
170580         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.           17058000
170590     MOVE '  CLOSED STATEMENTS' TO DT2-DESCRIPTION1.              17059000
170600     MOVE NUM-CLOSED-STMTS TO DT2-NUMBER1.                        17060000
170610     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17061000
170620     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17062000
170630     MOVE SPACES TO DT-DETAIL-LINE-2.                             17063000
170640     DISPLAY 'BANK NO. ' H-BK-NO ' BILLING TX COUNT '             17064000
170650         NUM-BILL-TX UPON CONSOLE.                                17065000
170660     DISPLAY '            BILLING ACCTS ' END-NUM-ACCTS           17066000
170670         UPON CONSOLE.                                            17067000
170680     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         17068000
170690     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17069000
170700     MOVE DT-HEADING-LINE-6 TO DT-DETAIL-LINE-1.                  17070000
170710     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17071000
170720     MOVE DT-HEADING-LINE-7 TO DT-DETAIL-LINE-1.                  17072000
170730     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17073000
170740     MOVE DT-HEADING-LINE-8 TO DT-DETAIL-LINE-1.                  17074000
170750     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17075000
170760     MOVE ZEROS TO SUB6.                                          17076000
170770                                                                  17077000
170780 P6848-DO-IDENT-TOT-LOOP.                                         17078000
170790     ADD 1 TO SUB6.                                               17079000
170800     IF SUB6 GREATER THAN 10                                      17080000
170810         GO TO P6850-TOTAL-IDENT.                                 17081000
170820     IF NUMBER-BY-IDENT (SUB6) = ZERO                             17082000
170830         GO TO P6848-DO-IDENT-TOT-LOOP.                           17083000
170840     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17084000
170850                                                                  17085000
170860     COMPUTE WORK-DROP-DIFF ROUNDED = BEG-ACCR-BY-IDENT (SUB6)    17086000
170870                                    + TDY-EXP-BY-IDENT  (SUB6)    17087000
170880                                    - TDY-PAID-BY-IDENT (SUB6)    17088000
170890                                    - TDY-DROP-BY-IDENT (SUB6)    17089000
170900                                    - TDY-WITH-BY-IDENT (SUB6)    17090000
170910                                    - END-ACCR-BY-IDENT (SUB6)    17091000
170920                                                                  17092000
170930     IF WORK-DROP-DIFF LESS THAN ZEROS                            17093000
170940         SUBTRACT WORK-DROP-DIFF FROM TDY-EXP-BY-IDENT (SUB6)     17094000
170950         SUBTRACT WORK-DROP-DIFF FROM TDY-EXP-BY-IDENT (11)       17095000
170960     ELSE                                                         17096000
170970         ADD WORK-DROP-DIFF TO TDY-DROP-BY-IDENT (SUB6)           17097000
170980         ADD WORK-DROP-DIFF TO TDY-DROP-BY-IDENT (11)             17098000
170990     END-IF.                                                      17099000
171000                                                                  17100000
171010     MOVE NUMBER-BY-IDENT (SUB6) TO DT1-NUMBER.                   17101000
171020     MOVE DESC-BY-IDENT (SUB6) TO DT1-DESCRIPTION.                17102000
171030     MOVE CUR-BAL-BY-IDENT (SUB6) TO DT1-BALANCE.                 17103000
171040     IF NUMBER-BY-IDENT (11) = ZEROS                              17104000
171050         MOVE ZEROS TO HOLD-DT-PERCENT                            17105000
171060       ELSE                                                       17106000
171070         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17107000
171080             100 *                                                17108000
171090             (NUMBER-BY-IDENT (SUB6) / NUMBER-BY-IDENT (11)).     17109000
171100     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17110000
171110     IF CUR-BAL-BY-IDENT (11) = ZEROS                             17111000
171120         MOVE ZEROS TO HOLD-DT-PERCENT                            17112000
171130       ELSE                                                       17113000
171140         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17114000
171150             100 *                                                17115000
171160             (CUR-BAL-BY-IDENT (SUB6) / CUR-BAL-BY-IDENT (11)).   17116000
171170     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17117000
171180     MOVE BEG-ACCR-BY-IDENT (SUB6) TO DT1-BEGIN-ACCRU.            17118000
171190     MOVE TDY-EXP-BY-IDENT (SUB6) TO DT1-TODAYS-EXP.              17119000
171200     MOVE TDY-PAID-BY-IDENT (SUB6) TO DT1-PAID-TODAY.             17120000
171210     MOVE END-ACCR-BY-IDENT (SUB6) TO DT1-END-ACCRU.              17121000
171220     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17122000
171230     IF TDY-DROP-BY-IDENT (SUB6) = ZERO                           17123000
171240         NEXT SENTENCE                                            17124000
171250       ELSE                                                       17125000
171260         MOVE TDY-DROP-BY-IDENT (SUB6) TO DT1-PAID-TODAY.         17126000
171270     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17127000
171280     MOVE NUMBER-BY-IDENT-PERS (SUB6) TO DT1-NUMBER.              17128000
171290     MOVE CUR-BAL-BY-IDENT-PERS (SUB6) TO DT1-BALANCE.            17129000
171300     IF NUMBER-BY-IDENT (11) = ZEROS                              17130000
171310         MOVE ZEROS TO HOLD-DT-PERCENT                            17131000
171320       ELSE                                                       17132000
171330         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17133000
171340             100 *                                                17134000
171350             (NUMBER-BY-IDENT-PERS (SUB6) / NUMBER-BY-IDENT (11)).17135000
171360     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17136000
171370     IF CUR-BAL-BY-IDENT (11) = ZEROS                             17137000
171380         MOVE ZEROS TO HOLD-DT-PERCENT                            17138000
171390       ELSE                                                       17139000
171400         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17140000
171410             100 *                                                17141000
171420             (CUR-BAL-BY-IDENT-PERS (SUB6) /                      17142000
171430              CUR-BAL-BY-IDENT (11)).                             17143000
171440     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17144000
171450     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17145000
171460     IF TDY-WITH-BY-IDENT (SUB6) = ZERO                           17146000
171470         NEXT SENTENCE                                            17147000
171480       ELSE                                                       17148000
171490         MOVE TDY-WITH-BY-IDENT (SUB6) TO DT1-PAID-TODAY.         17149000
171500     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17150000
171510     MOVE NUMBER-BY-IDENT-NON-PERS (SUB6) TO DT1-NUMBER.          17151000
171520     MOVE CUR-BAL-BY-IDENT-NON-PERS (SUB6) TO DT1-BALANCE.        17152000
171530     IF NUMBER-BY-IDENT (11) = ZEROS                              17153000
171540         MOVE ZEROS TO HOLD-DT-PERCENT                            17154000
171550       ELSE                                                       17155000
171560         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17156000
171570             100 *                                                17157000
171580             (NUMBER-BY-IDENT-NON-PERS (SUB6) /                   17158000
171590              NUMBER-BY-IDENT (11)).                              17159000
171600     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17160000
171610     IF CUR-BAL-BY-IDENT (11) = ZEROS                             17161000
171620         MOVE ZEROS TO HOLD-DT-PERCENT                            17162000
171630       ELSE                                                       17163000
171640         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17164000
171650             100 *                                                17165000
171660             (CUR-BAL-BY-IDENT-NON-PERS (SUB6) /                  17166000
171670              CUR-BAL-BY-IDENT (11)).                             17167000
171680     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17168000
171690     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17169000
171700     PERFORM P6930-WRITE-ACRS-IDENT THRU P6939-EXIT.              17170000
171710     GO TO P6848-DO-IDENT-TOT-LOOP.                               17171000
171720                                                                  17172000
171730 P6850-TOTAL-IDENT.                                               17173000
171740     MOVE DT-DASH-LINE-3 TO DT-DETAIL-LINE-1.                     17174000
171750     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17175000
171760     MOVE 'GRAND TOTAL' TO DT1-DESCRIPTION.                       17176000
171770     MOVE 100.00 TO DT1-PERCENT-NO.                               17177000
171780     MOVE 100.00 TO DT1-PERCENT-BAL.                              17178000
171790     MOVE NUMBER-BY-IDENT (11)   TO DT1-NUMBER.                   17179000
171800     MOVE CUR-BAL-BY-IDENT (11)  TO DT1-BALANCE.                  17180000
171810     MOVE BEG-ACCR-BY-IDENT (11) TO DT1-BEGIN-ACCRU.              17181000
171820     MOVE TDY-EXP-BY-IDENT (11)  TO DT1-TODAYS-EXP.               17182000
171830     MOVE TDY-PAID-BY-IDENT (11) TO DT1-PAID-TODAY.               17183000
171840     MOVE END-ACCR-BY-IDENT (11) TO DT1-END-ACCRU.                17184000
171850     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17185000
171860     IF TDY-DROP-BY-IDENT (11) = ZERO                             17186000
171870         NEXT SENTENCE                                            17187000
171880       ELSE                                                       17188000
171890         MOVE TDY-DROP-BY-IDENT (11) TO DT1-PAID-TODAY.           17189000
171900     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17190000
171910     MOVE NUMBER-BY-IDENT-PERS (11) TO DT1-NUMBER.                17191000
171920     MOVE CUR-BAL-BY-IDENT-PERS (11) TO DT1-BALANCE.              17192000
171930     IF NUMBER-BY-IDENT (11) = ZEROS                              17193000
171940         MOVE ZEROS TO HOLD-DT-PERCENT                            17194000
171950       ELSE                                                       17195000
171960         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17196000
171970             100 *                                                17197000
171980             (NUMBER-BY-IDENT-PERS (11) / NUMBER-BY-IDENT (11)).  17198000
171990     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17199000
172000     IF CUR-BAL-BY-IDENT (11) = ZEROS                             17200000
172010         MOVE ZEROS TO HOLD-DT-PERCENT                            17201000
172020       ELSE                                                       17202000
172030         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17203000
172040             100 *                                                17204000
172050             (CUR-BAL-BY-IDENT-PERS (11) / CUR-BAL-BY-IDENT (11)).17205000
172060     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17206000
172070     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17207000
172080     IF TDY-WITH-BY-IDENT (11) = ZERO                             17208000
172090         NEXT SENTENCE                                            17209000
172100       ELSE                                                       17210000
172110         MOVE TDY-WITH-BY-IDENT (11) TO DT1-PAID-TODAY.           17211000
172120     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17212000
172130     MOVE NUMBER-BY-IDENT-NON-PERS (11) TO DT1-NUMBER.            17213000
172140     MOVE CUR-BAL-BY-IDENT-NON-PERS (11) TO DT1-BALANCE.          17214000
172150     IF NUMBER-BY-IDENT (11) = ZEROS                              17215000
172160         MOVE ZEROS TO HOLD-DT-PERCENT                            17216000
172170       ELSE                                                       17217000
172180         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17218000
172190             100 *                                                17219000
172200             (NUMBER-BY-IDENT-NON-PERS (11) /                     17220000
172210              NUMBER-BY-IDENT (11)).                              17221000
172220     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17222000
172230     IF CUR-BAL-BY-IDENT (11) = ZEROS                             17223000
172240         MOVE ZEROS TO HOLD-DT-PERCENT                            17224000
172250       ELSE                                                       17225000
172260         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17226000
172270             100 *                                                17227000
172280             (CUR-BAL-BY-IDENT-NON-PERS (11) /                    17228000
172290              CUR-BAL-BY-IDENT (11)).                             17229000
172300     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17230000
172310     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 3 TIMES.       17231000
172320     MOVE SPACES TO DT-DETAIL-LINE-2.                             17232000
172330     MOVE '  AVG CURR BAL BY IDENT' TO DT2-DESCRIPTION1.          17233000
172340     MOVE '  AVG COLL BAL BY IDENT' TO DT2-DESCRIPTION2.          17234000
172350     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17235000
172360     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17236000
172370     MOVE 0 TO SUB6.                                              17237000
172380                                                                  17238000
172390 P6852-AVG-BAL-BY-IDENT.                                          17239000
172400     ADD 1 TO SUB6.                                               17240000
172410     IF SUB6 = 11                                                 17241000
172420         GO TO P6854-CHK-ODB-TOT.                                 17242000
172430     IF AVG-CURR-BAL-MO-BY-IDENT (SUB6) = ZERO                    17243000
172440         GO TO P6852-AVG-BAL-BY-IDENT.                            17244000
172450     MOVE DESC-BY-IDENT (SUB6) TO DT2-DESCRIPTION1                17245000
172460                                  DT2-DESCRIPTION2.               17246000
172470     MOVE AVG-CURR-BAL-MO-BY-IDENT (SUB6) TO DT2-BALANCE1.        17247000
172480     MOVE AVG-COLL-BAL-MO-BY-IDENT (SUB6) TO DT2-BALANCE2.        17248000
172490     MOVE DT-DETAIL-LINE-2 TO DT-DETAIL-LINE-1.                   17249000
172500     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17250000
172510     GO TO P6852-AVG-BAL-BY-IDENT.                                17251000
172520                                                                  17252000
172530 P6854-CHK-ODB-TOT.                                               17253000
172540     IF PLAN-ID-ODB (1) = SPACES                                  17254000
172550         GO TO P6860-CHK-INV-TOT.                                 17255000
172560     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         17256000
172570     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17257000
172580     MOVE DT-HEADING-LINE-17 TO DT-DETAIL-LINE-1.                 17258000
172590     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17259000
172600     MOVE DT-HEADING-LINE-18 TO DT-DETAIL-LINE-1.                 17260000
172610     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17261000
172620     MOVE DT-HEADING-LINE-19 TO DT-DETAIL-LINE-1.                 17262000
172630     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17263000
172640     MOVE ZEROS TO SUB6.                                          17264000
172650                                                                  17265000
172660 P6856-DO-ODB-TOT-LOOP.                                           17266000
172670     ADD 1 TO SUB6.                                               17267000
172680     IF SUB6 GREATER THAN 10                                      17268000
172690         GO TO P6858-DO-ODB-GRAND-TOT.                            17269000
172700     IF PLAN-ID-ODB (SUB6) = SPACES                               17270000
172710         GO TO P6858-DO-ODB-GRAND-TOT.                            17271000
172720     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17272000
172730     MOVE NUM-BY-PLAN-ODB (SUB6) TO DT1-NUMBER.                   17273000
172740     EVALUATE TRUE                                                17274000
172750         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (1)              17275000
172760             MOVE ODB-PLAN-DESC (1)  TO DT1-DESCRIPTION           17276000
172770         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (2)              17277000
172780             MOVE ODB-PLAN-DESC (2)  TO DT1-DESCRIPTION           17278000
172790         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (3)              17279000
172800             MOVE ODB-PLAN-DESC (3)  TO DT1-DESCRIPTION           17280000
172810         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (4)              17281000
172820             MOVE ODB-PLAN-DESC (4)  TO DT1-DESCRIPTION           17282000
172830         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (5)              17283000
172840             MOVE ODB-PLAN-DESC (5)  TO DT1-DESCRIPTION           17284000
172850         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (6)              17285000
172860             MOVE ODB-PLAN-DESC (6)  TO DT1-DESCRIPTION           17286000
172870         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (7)              17287000
172880             MOVE ODB-PLAN-DESC (7)  TO DT1-DESCRIPTION           17288000
172890         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (8)              17289000
172900             MOVE ODB-PLAN-DESC (8)  TO DT1-DESCRIPTION           17290000
172910         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (9)              17291000
172920             MOVE ODB-PLAN-DESC (9)  TO DT1-DESCRIPTION           17292000
172930         WHEN PLAN-ID-ODB (SUB6) = ODB-PLAN-TYPE (10)             17293000
172940             MOVE ODB-PLAN-DESC (10) TO DT1-DESCRIPTION           17294000
172950         WHEN OTHER                                               17295000
172960             MOVE 'UNKNOWN' TO DT1-DESCRIPTION                    17296000
172970     END-EVALUATE.                                                17297000
172980     IF PROC-BK-NO = 01 AND PLAN-ID-ODB (SUB6) = 'EM'             17298000
172990         MOVE 'IL HOME EQUITY' TO DT1-DESCRIPTION.                17299000
173000     MOVE BAL-BY-PLAN-ODB (SUB6) TO DT1-BALANCE.                  17300000
173010     IF NUM-BY-PLAN-ODB (11) = ZEROS                              17301000
173020         MOVE ZEROS TO HOLD-DT-PERCENT                            17302000
173030       ELSE                                                       17303000
173040         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17304000
173050             100 *                                                17305000
173060             (NUM-BY-PLAN-ODB (SUB6) / NUM-BY-PLAN-ODB (11)).     17306000
173070     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17307000
173080     IF BAL-BY-PLAN-ODB (11) = ZEROS                              17308000
173090         MOVE ZEROS TO HOLD-DT-PERCENT                            17309000
173100       ELSE                                                       17310000
173110         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17311000
173120             100 *                                                17312000
173130             (BAL-BY-PLAN-ODB (SUB6) / BAL-BY-PLAN-ODB (11)).     17313000
173140     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17314000
173150     MOVE BEG-ACCR-BY-PLAN-ODB (SUB6) TO DT1-BEGIN-ACCRU.         17315000
173160     MOVE TDY-ACCR-BY-PLAN-ODB (SUB6) TO DT1-TODAYS-EXP.          17316000
173170     MOVE TDY-COLL-BY-PLAN-ODB (SUB6) TO DT1-PAID-TODAY.          17317000
173180     MOVE END-ACCR-BY-PLAN-ODB (SUB6) TO DT1-END-ACCRU.           17318000
173190     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17319000
173200     IF TDY-DROP-BY-PLAN-ODB (SUB6) = ZERO                        17320000
173210         NEXT SENTENCE                                            17321000
173220       ELSE                                                       17322000
173230         MOVE TDY-DROP-BY-PLAN-ODB (SUB6) TO DT1-PAID-TODAY.      17323000
173240     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17324000
173250     MOVE NUM-BY-PLAN-PERS-ODB (SUB6) TO DT1-NUMBER.              17325000
173260     MOVE BAL-BY-PLAN-PERS-ODB (SUB6) TO DT1-BALANCE.             17326000
173270     IF NUM-BY-PLAN-ODB (11) = ZEROS                              17327000
173280         MOVE ZEROS TO HOLD-DT-PERCENT                            17328000
173290       ELSE                                                       17329000
173300         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17330000
173310             100 *                                                17331000
173320             (NUM-BY-PLAN-PERS-ODB (SUB6) / NUM-BY-PLAN-ODB (11)).17332000
173330     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17333000
173340     IF BAL-BY-PLAN-ODB (11) = ZEROS                              17334000
173350         MOVE ZEROS TO HOLD-DT-PERCENT                            17335000
173360       ELSE                                                       17336000
173370         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17337000
173380             100 *                                                17338000
173390             (BAL-BY-PLAN-PERS-ODB (SUB6) /                       17339000
173400              BAL-BY-PLAN-ODB (11)).                              17340000
173410     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17341000
173420     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17342000
173430     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17343000
173440     MOVE NUM-BY-PLAN-NON-PERS-ODB (SUB6) TO DT1-NUMBER.          17344000
173450     MOVE BAL-BY-PLAN-NON-PERS-ODB (SUB6) TO DT1-BALANCE.         17345000
173460     IF NUM-BY-PLAN-ODB (11) = ZEROS                              17346000
173470         MOVE ZEROS TO HOLD-DT-PERCENT                            17347000
173480       ELSE                                                       17348000
173490         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17349000
173500             100 *                                                17350000
173510             (NUM-BY-PLAN-NON-PERS-ODB (SUB6) /                   17351000
173520              NUM-BY-PLAN-ODB (11)).                              17352000
173530     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17353000
173540     IF BAL-BY-PLAN-ODB (11) = ZEROS                              17354000
173550         MOVE ZEROS TO HOLD-DT-PERCENT                            17355000
173560       ELSE                                                       17356000
173570         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17357000
173580             100 *                                                17358000
173590             (BAL-BY-PLAN-NON-PERS-ODB (SUB6) /                   17359000
173600              BAL-BY-PLAN-ODB (11)).                              17360000
173610     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17361000
173620     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17362000
173630     GO TO P6856-DO-ODB-TOT-LOOP.                                 17363000
173640                                                                  17364000
173650 P6858-DO-ODB-GRAND-TOT.                                          17365000
173660     MOVE DT-DASH-LINE-3 TO DT-DETAIL-LINE-1.                     17366000
173670     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17367000
173680     MOVE 'GRAND TOTAL' TO DT1-DESCRIPTION.                       17368000
173690     MOVE 100.00 TO DT1-PERCENT-NO.                               17369000
173700     MOVE 100.00 TO DT1-PERCENT-BAL.                              17370000
173710     MOVE NUM-BY-PLAN-ODB (11) TO DT1-NUMBER.                     17371000
173720     MOVE BAL-BY-PLAN-ODB (11) TO DT1-BALANCE.                    17372000
173730     MOVE BEG-ACCR-BY-PLAN-ODB (11) TO DT1-BEGIN-ACCRU.           17373000
173740     MOVE TDY-ACCR-BY-PLAN-ODB (11) TO DT1-TODAYS-EXP.            17374000
173750     MOVE TDY-COLL-BY-PLAN-ODB (11) TO DT1-PAID-TODAY.            17375000
173760     MOVE END-ACCR-BY-PLAN-ODB (11) TO DT1-END-ACCRU.             17376000
173770     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17377000
173780     IF TDY-DROP-BY-PLAN-ODB (11) = ZERO                          17378000
173790         NEXT SENTENCE                                            17379000
173800       ELSE                                                       17380000
173810         MOVE TDY-DROP-BY-PLAN-ODB (11) TO DT1-PAID-TODAY.        17381000
173820     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17382000
173830     MOVE NUM-BY-PLAN-PERS-ODB (11) TO DT1-NUMBER.                17383000
173840     MOVE BAL-BY-PLAN-PERS-ODB (11) TO DT1-BALANCE.               17384000
173850     IF NUM-BY-PLAN-ODB (11) = ZEROS                              17385000
173860         MOVE ZEROS TO HOLD-DT-PERCENT                            17386000
173870       ELSE                                                       17387000
173880         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17388000
173890             100 *                                                17389000
173900             (NUM-BY-PLAN-PERS-ODB (11) / NUM-BY-PLAN-ODB (11)).  17390000
173910     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17391000
173920     IF BAL-BY-PLAN-ODB (11) = ZEROS                              17392000
173930         MOVE ZEROS TO HOLD-DT-PERCENT                            17393000
173940       ELSE                                                       17394000
173950         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17395000
173960             100 *                                                17396000
173970             (BAL-BY-PLAN-PERS-ODB (11) / BAL-BY-PLAN-ODB (11)).  17397000
173980     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17398000
173990     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17399000
174000     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17400000
174010     MOVE NUM-BY-PLAN-NON-PERS-ODB (11) TO DT1-NUMBER.            17401000
174020     MOVE BAL-BY-PLAN-NON-PERS-ODB (11) TO DT1-BALANCE.           17402000
174030     IF NUM-BY-PLAN-ODB (11) = ZEROS                              17403000
174040         MOVE ZEROS TO HOLD-DT-PERCENT                            17404000
174050       ELSE                                                       17405000
174060         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17406000
174070             100 *                                                17407000
174080             (NUM-BY-PLAN-NON-PERS-ODB (11) /                     17408000
174090              NUM-BY-PLAN-ODB (11)).                              17409000
174100     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17410000
174110     IF BAL-BY-PLAN-ODB (11) = ZEROS                              17411000
174120         MOVE ZEROS TO HOLD-DT-PERCENT                            17412000
174130       ELSE                                                       17413000
174140         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17414000
174150             100 *                                                17415000
174160             (BAL-BY-PLAN-NON-PERS-ODB (11) /                     17416000
174170              BAL-BY-PLAN-ODB (11)).                              17417000
174180     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17418000
174190     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17419000
174200                                                                  17420000
174210 P6860-CHK-INV-TOT.                                               17421000
174220     IF PLAN-ID-INV (1) = SPACES                                  17422000
174230         GO TO P6866-CHK-EXT-SC-TOT.                              17423000
174240     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         17424000
174250     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17425000
174260     MOVE DT-HEADING-LINE-20 TO DT-DETAIL-LINE-1.                 17426000
174270     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17427000
174280     MOVE DT-HEADING-LINE-7  TO DT-DETAIL-LINE-1.                 17428000
174290     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17429000
174300     MOVE DT-HEADING-LINE-8  TO DT-DETAIL-LINE-1.                 17430000
174310     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17431000
174320     MOVE ZEROS TO SUB6.                                          17432000
174330                                                                  17433000
174340 P6862-DO-INV-TOT-LOOP.                                           17434000
174350     ADD 1 TO SUB6.                                               17435000
174360     IF SUB6 GREATER THAN 10                                      17436000
174370         GO TO P6864-DO-INV-GRAND-TOT.                            17437000
174380     IF PLAN-ID-INV (SUB6) = SPACES                               17438000
174390         GO TO P6864-DO-INV-GRAND-TOT.                            17439000
174400     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17440000
174410     MOVE NUM-BY-PLAN-INV (SUB6) TO DT1-NUMBER.                   17441000
174420     EVALUATE PLAN-ID-INV (SUB6)                                  17442000
174430         WHEN 'RP'                                                17443000
174440             MOVE 'REPURCHASE' TO DT1-DESCRIPTION                 17444000
174450         WHEN 'TE'                                                17445000
174460             MOVE 'TAX EXEMPT FUND' TO DT1-DESCRIPTION            17446000
174470         WHEN 'TF'                                                17447000
174480             MOVE 'TREASURY FUND' TO DT1-DESCRIPTION              17448000
174490         WHEN 'TR'                                                17449000
174500             MOVE 'TERM REPO' TO DT1-DESCRIPTION                  17450000
174510         WHEN 'TS'                                                17451000
174520             MOVE 'T-SHARE' TO DT1-DESCRIPTION                    17452000
174530         WHEN 'IR'                                                17453000
174540             MOVE 'INTERBANK TERM REPO' TO DT1-DESCRIPTION        17454000
174550         WHEN 'FF'                                                17455000
174560             MOVE 'FED FUNDS' TO DT1-DESCRIPTION                  17456000
174570         WHEN 'CF'                                                17457000
174580             MOVE 'CASH MGMT TRUST FUND' TO DT1-DESCRIPTION       17458000
174590         WHEN OTHER                                               17459000
174600             MOVE 'UNKNOWN' TO DT1-DESCRIPTION                    17460000
174610     END-EVALUATE.                                                17461000
174620     MOVE BAL-BY-PLAN-INV (SUB6) TO DT1-BALANCE.                  17462000
174630     IF NUM-BY-PLAN-INV (11) = ZEROS                              17463000
174640         MOVE ZEROS TO HOLD-DT-PERCENT                            17464000
174650       ELSE                                                       17465000
174660         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17466000
174670             100 *                                                17467000
174680             (NUM-BY-PLAN-INV (SUB6) / NUM-BY-PLAN-INV (11)).     17468000
174690     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17469000
174700     IF BAL-BY-PLAN-INV (11) = ZEROS                              17470000
174710         MOVE ZEROS TO HOLD-DT-PERCENT                            17471000
174720       ELSE                                                       17472000
174730         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17473000
174740             100 *                                                17474000
174750             (BAL-BY-PLAN-INV (SUB6) / BAL-BY-PLAN-INV (11)).     17475000
174760     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17476000
174770     MOVE BEG-ACCR-BY-PLAN-INV (SUB6) TO DT1-BEGIN-ACCRU.         17477000
174780     MOVE TDY-ACCR-BY-PLAN-INV (SUB6) TO DT1-TODAYS-EXP.          17478000
174790     MOVE TDY-PAID-BY-PLAN-INV (SUB6) TO DT1-PAID-TODAY.          17479000
174800     MOVE END-ACCR-BY-PLAN-INV (SUB6) TO DT1-END-ACCRU.           17480000
174810     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17481000
174820     IF TDY-DROP-BY-PLAN-INV (SUB6) = ZERO                        17482000
174830         NEXT SENTENCE                                            17483000
174840       ELSE                                                       17484000
174850         MOVE TDY-DROP-BY-PLAN-INV (SUB6) TO DT1-PAID-TODAY.      17485000
174860     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17486000
174870     MOVE NUM-BY-PLAN-PERS-INV (SUB6) TO DT1-NUMBER.              17487000
174880     MOVE BAL-BY-PLAN-PERS-INV (SUB6) TO DT1-BALANCE.             17488000
174890     IF NUM-BY-PLAN-INV (11) = ZEROS                              17489000
174900         MOVE ZEROS TO HOLD-DT-PERCENT                            17490000
174910       ELSE                                                       17491000
174920         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17492000
174930             100 *                                                17493000
174940             (NUM-BY-PLAN-PERS-INV (SUB6) / NUM-BY-PLAN-INV (11)).17494000
174950     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17495000
174960     IF BAL-BY-PLAN-INV (11) = ZEROS                              17496000
174970         MOVE ZEROS TO HOLD-DT-PERCENT                            17497000
174980       ELSE                                                       17498000
174990         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17499000
175000             100 *                                                17500000
175010             (BAL-BY-PLAN-PERS-INV (SUB6) / BAL-BY-PLAN-INV (11)).17501000
175020     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17502000
175030     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17503000
175040     IF TDY-WITH-BY-PLAN-INV (SUB6) = ZERO                        17504000
175050         NEXT SENTENCE                                            17505000
175060       ELSE                                                       17506000
175070         MOVE TDY-WITH-BY-PLAN-INV (SUB6) TO DT1-PAID-TODAY.      17507000
175080     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17508000
175090     MOVE NUM-BY-PLAN-NON-PERS-INV (SUB6) TO DT1-NUMBER.          17509000
175100     MOVE BAL-BY-PLAN-NON-PERS-INV (SUB6) TO DT1-BALANCE.         17510000
175110     IF NUM-BY-PLAN-INV (11) = ZEROS                              17511000
175120         MOVE ZEROS TO HOLD-DT-PERCENT                            17512000
175130       ELSE                                                       17513000
175140         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17514000
175150             100 *                                                17515000
175160             (NUM-BY-PLAN-NON-PERS-INV (SUB6) /                   17516000
175170              NUM-BY-PLAN-INV (11)).                              17517000
175180     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17518000
175190     IF BAL-BY-PLAN-INV (11) = ZEROS                              17519000
175200         MOVE ZEROS TO HOLD-DT-PERCENT                            17520000
175210       ELSE                                                       17521000
175220         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17522000
175230             100 *                                                17523000
175240             (BAL-BY-PLAN-NON-PERS-INV (SUB6) /                   17524000
175250              BAL-BY-PLAN-INV (11)).                              17525000
175260     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17526000
175270     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17527000
175280     GO TO P6862-DO-INV-TOT-LOOP.                                 17528000
175290                                                                  17529000
175300 P6864-DO-INV-GRAND-TOT.                                          17530000
175310     MOVE DT-DASH-LINE-3 TO DT-DETAIL-LINE-1.                     17531000
175320     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17532000
175330     MOVE 'GRAND TOTAL' TO DT1-DESCRIPTION.                       17533000
175340     MOVE 100.00 TO DT1-PERCENT-NO.                               17534000
175350     MOVE 100.00 TO DT1-PERCENT-BAL.                              17535000
175360     MOVE NUM-BY-PLAN-INV (11) TO DT1-NUMBER.                     17536000
175370     MOVE BAL-BY-PLAN-INV (11) TO DT1-BALANCE.                    17537000
175380     MOVE BEG-ACCR-BY-PLAN-INV (11) TO DT1-BEGIN-ACCRU.           17538000
175390     MOVE TDY-ACCR-BY-PLAN-INV (11) TO DT1-TODAYS-EXP.            17539000
175400     MOVE TDY-PAID-BY-PLAN-INV (11) TO DT1-PAID-TODAY.            17540000
175410     MOVE END-ACCR-BY-PLAN-INV (11) TO DT1-END-ACCRU.             17541000
175420     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17542000
175430     IF TDY-DROP-BY-PLAN-INV (11) = ZERO                          17543000
175440         NEXT SENTENCE                                            17544000
175450       ELSE                                                       17545000
175460         MOVE TDY-DROP-BY-PLAN-INV (11) TO DT1-PAID-TODAY.        17546000
175470     MOVE '  PERSONAL' TO DT1-DESCRIPTION.                        17547000
175480     MOVE NUM-BY-PLAN-PERS-INV (11) TO DT1-NUMBER.                17548000
175490     MOVE BAL-BY-PLAN-PERS-INV (11) TO DT1-BALANCE.               17549000
175500     IF NUM-BY-PLAN-INV (11) = ZEROS                              17550000
175510         MOVE ZEROS TO HOLD-DT-PERCENT                            17551000
175520       ELSE                                                       17552000
175530         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17553000
175540             100 *                                                17554000
175550             (NUM-BY-PLAN-PERS-INV (11) / NUM-BY-PLAN-INV (11)).  17555000
175560     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17556000
175570     IF BAL-BY-PLAN-INV (11) = ZEROS                              17557000
175580         MOVE ZEROS TO HOLD-DT-PERCENT                            17558000
175590       ELSE                                                       17559000
175600         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17560000
175610             100 *                                                17561000
175620             (BAL-BY-PLAN-PERS-INV (11) / BAL-BY-PLAN-INV (11)).  17562000
175630     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17563000
175640     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17564000
175650     IF TDY-WITH-BY-PLAN-INV (11) = ZERO                          17565000
175660         NEXT SENTENCE                                            17566000
175670       ELSE                                                       17567000
175680         MOVE TDY-WITH-BY-PLAN-INV (11) TO DT1-PAID-TODAY.        17568000
175690     MOVE '  NON-PERSONAL' TO DT1-DESCRIPTION.                    17569000
175700     MOVE NUM-BY-PLAN-NON-PERS-INV (11) TO DT1-NUMBER.            17570000
175710     MOVE BAL-BY-PLAN-NON-PERS-INV (11) TO DT1-BALANCE.           17571000
175720     IF NUM-BY-PLAN-INV (11) = ZEROS                              17572000
175730         MOVE ZEROS TO HOLD-DT-PERCENT                            17573000
175740       ELSE                                                       17574000
175750         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17575000
175760             100 *                                                17576000
175770             (NUM-BY-PLAN-NON-PERS-INV (11) /                     17577000
175780              NUM-BY-PLAN-INV (11)).                              17578000
175790     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17579000
175800     IF BAL-BY-PLAN-INV (11) = ZEROS                              17580000
175810         MOVE ZEROS TO HOLD-DT-PERCENT                            17581000
175820       ELSE                                                       17582000
175830         COMPUTE HOLD-DT-PERCENT ROUNDED =                        17583000
175840             100 *                                                17584000
175850             (BAL-BY-PLAN-NON-PERS-INV (11) /                     17585000
175860              BAL-BY-PLAN-INV (11)).                              17586000
175870     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17587000
175880     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17588000
175890                                                                  17589000
175900 P6866-CHK-EXT-SC-TOT.                                            17590000
175910     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         17591000
175920     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17592000
175930     MOVE DT-HEADING-LINE-21 TO DT-DETAIL-LINE-1.                 17593000
175940     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17594000
175950     MOVE DT-HEADING-LINE-22 TO DT-DETAIL-LINE-1.                 17595000
175960     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17596000
175970     MOVE DT-HEADING-LINE-23 TO DT-DETAIL-LINE-1.                 17597000
175980     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17598000
175990     MOVE ZEROS TO SUB15.                                         17599000
176000                                                                  17600000
176010 P6868-DO-EXT-SC-LOOP.                                            17601000
176020     ADD 1 TO SUB15.                                              17602000
176030     IF SUB15 GREATER THAN 250                                    17603000
176040         GO TO P6870-DO-EXT-SC-TOT.                               17604000
176050     IF XSCC-TX-CODE (SUB15) = ZEROS                              17605000
176060         GO TO P6868-DO-EXT-SC-LOOP.                              17606000
176070     IF LINE-CNT GREATER THAN 62                                  17607000
176080         PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT      17608000
176090         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            17609000
176100         MOVE DT-HEADING-LINE-21 TO DT-DETAIL-LINE-1              17610000
176110         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            17611000
176120         MOVE DT-HEADING-LINE-22 TO DT-DETAIL-LINE-1              17612000
176130         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT            17613000
176140         MOVE DT-HEADING-LINE-23 TO DT-DETAIL-LINE-1              17614000
176150         PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.   17615000
176160     MOVE XSCC-REPORT-DESC (SUB15) TO DT3-DESC-1.                 17616000
176170     MOVE XSCC-TX-CODE (SUB15) TO DT3-CODE-1.                     17617000
176180     MOVE NUM-EXT-CHRGS (SUB15) TO DT3-NUM-1.                     17618000
176190     MOVE AMT-EXT-CHRGS (SUB15) TO DT3-AMT-1.                     17619000
176200     MOVE XSCC-HARD-CHRG-CODE (SUB15) TO DT3-CODE-2.              17620000
176210     MOVE NUM-HARD-CHRGS (SUB15) TO DT3-NUM-3.                    17621000
176220     MOVE AMT-HARD-CHRGS (SUB15) TO DT3-AMT-3.                    17622000
176230     PERFORM P8420-ADD-TO-XSC-TOTALS THRU P8429-EXIT.             17623000
176240     MOVE HOLD-NUM-EXT-CHRGS TO DT3-NUM-2.                        17624000
176250     MOVE HOLD-AMT-EXT-CHRGS TO DT3-AMT-2.                        17625000
176260     MOVE HOLD-NUM-HARD-CHRGS TO DT3-NUM-4.                       17626000
176270     MOVE HOLD-AMT-HARD-CHRGS TO DT3-AMT-4.                       17627000
176280     MOVE DT-DETAIL-LINE-3 TO DT-DETAIL-LINE-1.                   17628000
176290     MOVE SPACES TO DT-DETAIL-LINE-3.                             17629000
176300     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17630000
176310     GO TO P6868-DO-EXT-SC-LOOP.                                  17631000
176320                                                                  17632000
176330 P6870-DO-EXT-SC-TOT.                                             17633000
176340     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17634000
176350     MOVE '   EXT/HARD CHARGE TOTALS' TO DT3-DESC-1.              17635000
176360     MOVE NUM-EXT-CHRGS (SUB15) TO DT3-NUM-1.                     17636000
176370     MOVE AMT-EXT-CHRGS (SUB15) TO DT3-AMT-1.                     17637000
176380     MOVE NUM-HARD-CHRGS (SUB15) TO DT3-NUM-3.                    17638000
176390     MOVE AMT-HARD-CHRGS (SUB15) TO DT3-AMT-3.                    17639000
176400     MOVE TOT-NUM-EXT-CHRGS TO DT3-NUM-2.                         17640000
176410     MOVE TOT-AMT-EXT-CHRGS TO DT3-AMT-2.                         17641000
176420     MOVE TOT-NUM-HARD-CHRGS TO DT3-NUM-4.                        17642000
176430     MOVE TOT-AMT-HARD-CHRGS TO DT3-AMT-4.                        17643000
176440     MOVE DT-DETAIL-LINE-3 TO DT-DETAIL-LINE-1.                   17644000
176450     MOVE SPACES TO DT-DETAIL-LINE-3.                             17645000
176460     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17646000
176470     MOVE 1 TO SUB15.                                             17647000
176480     MOVE ZEROS TO SUB6.                                          17648000
176490                                                                  17649000
176500 P6880-DO-DT-STRATA-SC-HEADINGS.                                  17650000
176510     PERFORM P6802-PRINT-DAILY-TOT-HEADS THRU P6804-EXIT.         17651000
176520     MOVE DT-HEADING-LINE-3 TO DT-DETAIL-LINE-1.                  17652000
176530     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17653000
176540     MOVE DT-HEADING-LINE-4 TO DT-DETAIL-LINE-1.                  17654000
176550     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17655000
176560                                                                  17656000
176570 P6882-DO-STRATA-SC-DTL.                                          17657000
176580     MOVE DT-HEADING-LINE-13 TO DT-DETAIL-LINE-1.                 17658000
176590     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT 2 TIMES.       17659000
176600     MOVE ZEROS TO SUB6.                                          17660000
176610                                                                  17661000
176620 P6884-DT-STRATA-SC-LOOP.                                         17662000
176630     ADD 1 TO SUB6.                                               17663000
176640     IF SUB6 GREATER THAN 15                                      17664000
176650         GO TO P6886-DT-STRATA-SC-GRAND.                          17665000
176660     IF NUMBER-BY-STRATA-SC (SUB6) = ZERO                         17666000
176670         GO TO P6884-DT-STRATA-SC-LOOP.                           17667000
176680     MOVE STRATA-DESC-BY-SC (SUB6) TO DT1-DESCRIPTION.            17668000
176690     MOVE NUMBER-BY-STRATA-SC (SUB6) TO DT1-NUMBER.               17669000
176700     MOVE CUR-BAL-BY-STRATA-SC (SUB6) TO DT1-BALANCE.             17670000
176710     IF NUMBER-BY-STRATA-SC (16) = ZEROS                          17671000
176720         MOVE ZERO TO HOLD-DT-PERCENT                             17672000
176730       ELSE                                                       17673000
176740       COMPUTE HOLD-DT-PERCENT =                                  17674000
176750           100 *                                                  17675000
176760           (NUMBER-BY-STRATA-SC (SUB6) /                          17676000
176770            NUMBER-BY-STRATA-SC (16)).                            17677000
176780     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-NO.                      17678000
176790     IF CUR-BAL-BY-STRATA-SC (16) = ZEROS                         17679000
176800         MOVE ZERO TO HOLD-DT-PERCENT                             17680000
176810       ELSE                                                       17681000
176820       COMPUTE HOLD-DT-PERCENT =                                  17682000
176830           100 *                                                  17683000
176840           (CUR-BAL-BY-STRATA-SC (SUB6) /                         17684000
176850            CUR-BAL-BY-STRATA-SC (16)).                           17685000
176860     MOVE HOLD-DT-PERCENT TO DT1-PERCENT-BAL.                     17686000
176870     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17687000
176880     GO TO P6884-DT-STRATA-SC-LOOP.                               17688000
176890                                                                  17689000
176900 P6886-DT-STRATA-SC-GRAND.                                        17690000
176910     MOVE DT-DASH-LINE-1 TO DT-DETAIL-LINE-1.                     17691000
176920     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17692000
176930     MOVE NUMBER-BY-STRATA-SC (16) TO DT1-NUMBER.                 17693000
176940     MOVE 100.00 TO DT1-PERCENT-NO.                               17694000
176950     MOVE 100.00 TO DT1-PERCENT-BAL.                              17695000
176960     MOVE CUR-BAL-BY-STRATA-SC (16) TO DT1-BALANCE.               17696000
176970     PERFORM P6820-PRINT-DT-1-LINE THRU P6822-EXIT.               17697000
176980                                                                  17698000
176990 P6898-END-DT.                                                    17699000
177000     MOVE GEN-DEBIT-AMT       TO GENERATED-DEBITS.                17700000
177010     MOVE GEN-CREDIT-AMT      TO GENERATED-CREDITS.               17701000
177020     MOVE AMT-ZBA-DEBITS      TO ZBA-CMA-DEBITS.                  17702000
177030     MOVE AMT-ZBA-CREDITS     TO ZBA-CMA-CREDITS.                 17703000
177040     MOVE AMT-ODP-DEBITS      TO ODP-DEBITS.                      17704000
177050     MOVE AMT-ODP-CREDITS     TO ODP-CREDITS.                     17705000
177060     MOVE AMT-HELOC-CREDITS   TO ML-HELOC-ADVANCES.               17706000
177070     MOVE AMT-CLSN-BR-CREDITS TO CLSN-BR-ADVANCES.                17707000
177080     MOVE AMT-CLSN-BR-DEBITS  TO CLSN-BR-PAYMENTS.                17708000
177090     MOVE AMT-ICS-CREDITS     TO ICS-SWEEP-CREDITS.               17709000
177100     MOVE AMT-ICS-DEBITS      TO ICS-SWEEP-DEBITS.                17710000
177110                                                                  17711000
177120     PERFORM P6900-GL-TRANS THRU P6909-EXIT.                      17712000
177130     MOVE ZEROS TO LINE-CNT.                                      17713000
177140     MOVE ZEROS TO PAGE-CNT.                                      17714000
177150                                                                  17715000
177160 P6899-EXIT.                                                      17716000
177170     EXIT.                                                        17717000
177180                                                                  17718000
177190******************************************************************17719000
177200* SUBROUTINE - W R I T E  G L  T R A N S A C T I O N S           *17720000
177210******************************************************************17721000
177220 P6900-GL-TRANS.                                                  17722000
177230     CALL 'DSDM103' USING DSDM103-ACTION-CODE                     17723000
177240                          PROCESS-WORK                            17724000
177250                          TOTALS-BY-TYPE                          17725000
177260                          TOTALS-BY-SERVICE-CHARGE                17726000
177270                          TOTALS-BY-STRATIFICATION                17727000
177280                          TOTALS-BY-ACCOUNT-ID                    17728000
177290                          TOTALS-BY-PLAN-TYPE-ODB                 17729000
177300                          TOTALS-BY-PLAN-TYPE-INV                 17730000
177310                          EXT-SERV-CHRG-CODE-WORK-AREA            17731000
177320                          EXT-CHRG-HARD-CHRG-TOTALS               17732000
177330                          STOCK-WORK                              17733000
177340                          DSDS-HEAD-1                             17734000
177350                          DSDS-HEAD-2                             17735000
177360                          PAGE-CNT                                17736000
177370                          DSDM102-ACTION-CODE                     17737000
177380                          MISCELLANEOUS-FEES-WORK-AREA            17738000
177390                          BALANCE-ADJ-TABLE.                      17739000
177400                                                                  17740000
177410 P6909-EXIT.                                                      17741000
177420     EXIT.                                                        17742000
177430                                                                  17743000
177440******************************************************************17744000
177450* SUBROUTINE - W R I T E  A C R S  R E C O R D S                 *17745000
177460******************************************************************17746000
177470 P6910-WRITE-ACRS-TYPE.                                           17747000
177480     IF PROC-QTR-END                                              17748000
177490         CONTINUE                                                 17749000
177500     ELSE                                                         17750000
177510         GO TO P6919-EXIT                                         17751000
177520     END-IF.                                                      17752000
177530                                                                  17753000
177540     INITIALIZE ACRS-DSDS-FILE-LAYOUT.                            17754000
177550     MOVE PROC-BK-NO                TO ACRSTRAN-BANK-NBR          17755000
177560     CALL 'CDCDT99' USING PROC-CURR-DATE                          17756000
177570                          ACRS-DATE-WORK                          17757000
177580                          BY CONTENT 'PYYYYDDD'                   17758000
177590                          BY CONTENT 'CYYYYMMDD'.                 17759000
177600     EVALUATE ACRS-DATE-MM                                        17760000
177610       WHEN 03                                                    17761000
177620         MOVE 1 TO ACRSTRAN-QUARTER                               17762000
177630       WHEN 06                                                    17763000
177640         MOVE 2 TO ACRSTRAN-QUARTER                               17764000
177650       WHEN 09                                                    17765000
177660         MOVE 3 TO ACRSTRAN-QUARTER                               17766000
177670       WHEN 12                                                    17767000
177680         MOVE 4 TO ACRSTRAN-QUARTER                               17768000
177690     END-EVALUATE.                                                17769000
177700                                                                  17770000
177710     MOVE ACRS-DATE-YYYY            TO ACRSTRAN-YEAR              17771000
177720     MOVE 'DSDS'                    TO ACRSTRAN-SYSTEM            17772000
177730     MOVE 'DSDS100'                 TO ACRSTRAN-PROGRAM           17773000
177740     MOVE 'VRDS REPORT DSDXXX082'   TO ACRSTRAN-FIELD-COMMENT     17774000
177750                                                                  17775000
177760     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         17776000
177770     MOVE 082                       TO ACRS-FIELD-ID-1            17777000
177780     MOVE SPACES                    TO ACRS-FIELD-DESC.           17778000
177790                                                                  17779000
177800     IF PROC-FILE-ID EQUAL 'DSD'                                  17780000
177810         MOVE 001                   TO ACRS-FIELD-ID-2            17781000
177820         MOVE 'CHECKING '           TO ACRS-FIELD-DESC-1          17782000
177830     ELSE                                                         17783000
177840         MOVE 002                   TO ACRS-FIELD-ID-2            17784000
177850         MOVE 'SAVINGS '            TO ACRS-FIELD-DESC-1          17785000
177860     END-IF.                                                      17786000
177870     MOVE SUB6                      TO ACRS-FIELD-ID-3.           17787000
177880     MOVE ACRS-FIELD-ID-WORK        TO ACRSTRAN-FIELD-ID          17788000
177890                                                                  17789000
177900     MOVE CUR-BAL-BY-TYPE (SUB6)    TO ACRSTRAN-AMOUNT            17790000
177910     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           17791000
177920         MOVE 0                TO ACRSTRAN-POS-NEG                17792000
177930       ELSE                                                       17793000
177940         MOVE 1                TO ACRSTRAN-POS-NEG                17794000
177950     END-IF.                                                      17795000
177960     MOVE TYP-DESC (SUB6)           TO ACRS-FIELD-DESC-2          17796000
177970                                                                  17797000
177980     CALL 'CDCUT21' USING LENGTH-24                               17798000
177990                          ACRS-FIELD-DESC-2                       17799000
178000     CALL 'CDCUT21' USING LENGTH-50                               17800000
178010                          ACRS-FIELD-DESC-2-3                     17801000
178020     CALL 'CDCUT20' USING LENGTH-90                               17802000
178030                          ACRS-FIELD-DESC-2-3-4                   17803000
178040     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            17804000
178050                                                                  17805000
178060     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            17806000
178070     MOVE SPACES TO ACRS-FIELD-DESC.                              17807000
178080     MOVE SPACES TO ACRSTRAN-FIELD-DESC.                          17808000
178090                                                                  17809000
178100*** ACRS NUMBER OF ACCOUNTS RECORD                                17810000
178110     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         17811000
178120     MOVE 082                       TO ACRS-FIELD-ID-1            17812000
178130     MOVE SPACES                    TO ACRS-FIELD-DESC.           17813000
178140                                                                  17814000
178150     IF PROC-FILE-ID EQUAL 'DSD'                                  17815000
178160         MOVE 901                   TO ACRS-FIELD-ID-2            17816000
178170         MOVE 'CHECKING '           TO ACRS-FIELD-DESC-1          17817000
178180     ELSE                                                         17818000
178190         MOVE 902                   TO ACRS-FIELD-ID-2            17819000
178200         MOVE 'SAVINGS '            TO ACRS-FIELD-DESC-1          17820000
178210     END-IF.                                                      17821000
178220     MOVE SUB6                      TO ACRS-FIELD-ID-3.           17822000
178230     MOVE ACRS-FIELD-ID-WORK        TO ACRSTRAN-FIELD-ID          17823000
178240                                                                  17824000
178250     MOVE TYP-DESC (SUB6)           TO ACRS-FIELD-DESC-2          17825000
178260     MOVE 'NUMBER'                  TO ACRS-FIELD-DESC-3          17826000
178270                                                                  17827000
178280     CALL 'CDCUT21' USING LENGTH-24                               17828000
178290                          ACRS-FIELD-DESC-2                       17829000
178300     CALL 'CDCUT21' USING LENGTH-50                               17830000
178310                          ACRS-FIELD-DESC-2-3                     17831000
178320     CALL 'CDCUT20' USING LENGTH-90                               17832000
178330                          ACRS-FIELD-DESC-2-3-4                   17833000
178340     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            17834000
178350                                                                  17835000
178360     COMPUTE ACRSTRAN-AMOUNT EQUAL NUMBER-BY-TYPE (SUB6) * 1000.  17836000
178370     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           17837000
178380         MOVE 0                TO ACRSTRAN-POS-NEG                17838000
178390       ELSE                                                       17839000
178400         MOVE 1                TO ACRSTRAN-POS-NEG                17840000
178410     END-IF.                                                      17841000
178420     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            17842000
178430     MOVE SPACES TO ACRS-FIELD-DESC.                              17843000
178440     MOVE SPACES TO ACRSTRAN-FIELD-DESC.                          17844000
178450 P6919-EXIT.                                                      17845000
178460     EXIT.                                                        17846000
178470                                                                  17847000
178480 P6920-WRITE-ACRS-STRATA.                                         17848000
178490     IF PROC-QTR-END                                              17849000
178500         CONTINUE                                                 17850000
178510     ELSE                                                         17851000
178520         GO TO P6929-EXIT                                         17852000
178530     END-IF.                                                      17853000
178540                                                                  17854000
178550     INITIALIZE ACRS-DSDS-FILE-LAYOUT.                            17855000
178560     MOVE PROC-BK-NO                TO ACRSTRAN-BANK-NBR          17856000
178570     CALL 'CDCDT99' USING PROC-CURR-DATE                          17857000
178580                          ACRS-DATE-WORK                          17858000
178590                          BY CONTENT 'PYYYYDDD'                   17859000
178600                          BY CONTENT 'CYYYYMMDD'.                 17860000
178610     EVALUATE ACRS-DATE-MM                                        17861000
178620       WHEN 03                                                    17862000
178630         MOVE 1 TO ACRSTRAN-QUARTER                               17863000
178640       WHEN 06                                                    17864000
178650         MOVE 2 TO ACRSTRAN-QUARTER                               17865000
178660       WHEN 09                                                    17866000
178670         MOVE 3 TO ACRSTRAN-QUARTER                               17867000
178680       WHEN 12                                                    17868000
178690         MOVE 4 TO ACRSTRAN-QUARTER                               17869000
178700     END-EVALUATE.                                                17870000
178710                                                                  17871000
178720     MOVE ACRS-DATE-YYYY            TO ACRSTRAN-YEAR              17872000
178730     MOVE 'DSDS'                    TO ACRSTRAN-SYSTEM            17873000
178740     MOVE 'DSDS100'                 TO ACRSTRAN-PROGRAM           17874000
178750     MOVE 'VRDS REPORT DSDXXX082'   TO ACRSTRAN-FIELD-COMMENT     17875000
178760                                                                  17876000
178770     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         17877000
178780     MOVE 082                       TO ACRS-FIELD-ID-1            17878000
178790                                                                  17879000
178800     MOVE SPACES                    TO ACRS-FIELD-DESC            17880000
178810                                       ACRSTRAN-FIELD-DESC.       17881000
178820     IF PROC-FILE-ID EQUAL 'DSD'                                  17882000
178830         MOVE 001                   TO ACRS-FIELD-ID-2            17883000
178840         MOVE 'CHECKING'            TO ACRS-FIELD-DESC-1          17884000
178850     ELSE                                                         17885000
178860         MOVE 002                   TO ACRS-FIELD-ID-2            17886000
178870         MOVE 'SAVINGS'             TO ACRS-FIELD-DESC-1          17887000
178880     END-IF.                                                      17888000
178890     COMPUTE ACRS-FIELD-ID-3 EQUAL SUB6 + 100                     17889000
178900     MOVE ACRS-FIELD-ID-WORK        TO ACRSTRAN-FIELD-ID          17890000
178910                                                                  17891000
178920     MOVE CUR-BAL-BY-STRATA (SUB6)  TO ACRSTRAN-AMOUNT            17892000
178930     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           17893000
178940         MOVE 0                TO ACRSTRAN-POS-NEG                17894000
178950       ELSE                                                       17895000
178960         MOVE 1                TO ACRSTRAN-POS-NEG                17896000
178970     END-IF.                                                      17897000
178980     MOVE 'STRATIFICATION '           TO ACRS-FIELD-DESC-2        17898000
178990                                                                  17899000
179000     IF SUB6 EQUAL 18                                             17900000
179010         MOVE 'TOTAL'                 TO ACRS-FIELD-DESC-3        17901000
179020     ELSE                                                         17902000
179030         MOVE STRATA-DESC-BY-CLASS (SUB6) TO ACRS-FIELD-DESC-3    17903000
179040     END-IF.                                                      17904000
179050                                                                  17905000
179060     CALL 'CDCUT21' USING LENGTH-24                               17906000
179070                          ACRS-FIELD-DESC-2                       17907000
179080     CALL 'CDCUT21' USING LENGTH-50                               17908000
179090                          ACRS-FIELD-DESC-2-3                     17909000
179100     CALL 'CDCUT20' USING LENGTH-90                               17910000
179110                          ACRS-FIELD-DESC-2-3-4                   17911000
179120     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            17912000
179130     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            17913000
179140                                                                  17914000
179150*** ACRS NUMBER OF ACCOUNTS RECORD                                17915000
179160     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         17916000
179170     MOVE 082                       TO ACRS-FIELD-ID-1            17917000
179180                                                                  17918000
179190     MOVE SPACES                    TO ACRS-FIELD-DESC            17919000
179200                                       ACRSTRAN-FIELD-DESC.       17920000
179210     IF PROC-FILE-ID EQUAL 'DSD'                                  17921000
179220         MOVE 901                   TO ACRS-FIELD-ID-2            17922000
179230         MOVE 'CHECKING'            TO ACRS-FIELD-DESC-1          17923000
179240     ELSE                                                         17924000
179250         MOVE 902                   TO ACRS-FIELD-ID-2            17925000
179260         MOVE 'SAVINGS'             TO ACRS-FIELD-DESC-1          17926000
179270     END-IF.                                                      17927000
179280     COMPUTE ACRS-FIELD-ID-3 EQUAL SUB6 + 100                     17928000
179290     MOVE ACRS-FIELD-ID-WORK          TO ACRSTRAN-FIELD-ID        17929000
179300                                                                  17930000
179310     MOVE 'STRATIFICATION '           TO ACRS-FIELD-DESC-2        17931000
179320     IF SUB6 EQUAL 18                                             17932000
179330         MOVE 'TOTAL'                 TO ACRS-FIELD-DESC-3        17933000
179340     ELSE                                                         17934000
179350         MOVE STRATA-DESC-BY-CLASS (SUB6) TO ACRS-FIELD-DESC-3    17935000
179360     END-IF.                                                      17936000
179370                                                                  17937000
179380     MOVE 'NUMBER'                    TO ACRS-FIELD-DESC-4        17938000
179390                                                                  17939000
179400     CALL 'CDCUT21' USING LENGTH-24                               17940000
179410                          ACRS-FIELD-DESC-2                       17941000
179420     CALL 'CDCUT21' USING LENGTH-50                               17942000
179430                          ACRS-FIELD-DESC-2-3                     17943000
179440     CALL 'CDCUT20' USING LENGTH-90                               17944000
179450                          ACRS-FIELD-DESC-2-3-4                   17945000
179460     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            17946000
179470                                                                  17947000
179480     COMPUTE ACRSTRAN-AMOUNT EQUAL NUMBER-BY-STRATA (SUB6) * 1000.17948000
179490     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           17949000
179500         MOVE 0                TO ACRSTRAN-POS-NEG                17950000
179510       ELSE                                                       17951000
179520         MOVE 1                TO ACRSTRAN-POS-NEG                17952000
179530     END-IF.                                                      17953000
179540     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            17954000
179550 P6929-EXIT.                                                      17955000
179560     EXIT.                                                        17956000
179570                                                                  17957000
179580 P6930-WRITE-ACRS-IDENT.                                          17958000
179590     IF PROC-QTR-END                                              17959000
179600         CONTINUE                                                 17960000
179610     ELSE                                                         17961000
179620         GO TO P6939-EXIT                                         17962000
179630     END-IF.                                                      17963000
179640                                                                  17964000
179650     INITIALIZE ACRS-DSDS-FILE-LAYOUT.                            17965000
179660     MOVE PROC-BK-NO                TO ACRSTRAN-BANK-NBR          17966000
179670     CALL 'CDCDT99' USING PROC-CURR-DATE                          17967000
179680                          ACRS-DATE-WORK                          17968000
179690                          BY CONTENT 'PYYYYDDD'                   17969000
179700                          BY CONTENT 'CYYYYMMDD'.                 17970000
179710     EVALUATE ACRS-DATE-MM                                        17971000
179720       WHEN 03                                                    17972000
179730         MOVE 1 TO ACRSTRAN-QUARTER                               17973000
179740       WHEN 06                                                    17974000
179750         MOVE 2 TO ACRSTRAN-QUARTER                               17975000
179760       WHEN 09                                                    17976000
179770         MOVE 3 TO ACRSTRAN-QUARTER                               17977000
179780       WHEN 12                                                    17978000
179790         MOVE 4 TO ACRSTRAN-QUARTER                               17979000
179800     END-EVALUATE.                                                17980000
179810                                                                  17981000
179820     MOVE ACRS-DATE-YYYY            TO ACRSTRAN-YEAR              17982000
179830     MOVE 'DSDS'                    TO ACRSTRAN-SYSTEM            17983000
179840     MOVE 'DSDS100'                 TO ACRSTRAN-PROGRAM           17984000
179850     MOVE 'VRDS REPORT DSDXXX082'   TO ACRSTRAN-FIELD-COMMENT     17985000
179860                                                                  17986000
179870     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         17987000
179880     MOVE 082                       TO ACRS-FIELD-ID-1            17988000
179890                                                                  17989000
179900     MOVE SPACES                    TO ACRS-FIELD-DESC            17990000
179910                                       ACRSTRAN-FIELD-DESC.       17991000
179920     IF PROC-FILE-ID EQUAL 'DSD'                                  17992000
179930         MOVE 001                   TO ACRS-FIELD-ID-2            17993000
179940     ELSE                                                         17994000
179950         MOVE 002                   TO ACRS-FIELD-ID-2            17995000
179960     END-IF.                                                      17996000
179970                                                                  17997000
179980     COMPUTE ACRS-FIELD-ID-3 = SUB6 + 200                         17998000
179990     MOVE ACRS-FIELD-ID-WORK        TO ACRSTRAN-FIELD-ID          17999000
180000                                                                  18000000
180010     MOVE CUR-BAL-BY-IDENT-PERS (SUB6)  TO ACRSTRAN-AMOUNT        18001000
180020     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           18002000
180030         MOVE 0                TO ACRSTRAN-POS-NEG                18003000
180040       ELSE                                                       18004000
180050         MOVE 1                TO ACRSTRAN-POS-NEG                18005000
180060     END-IF.                                                      18006000
180070     MOVE DESC-BY-IDENT (SUB6)        TO ACRS-FIELD-DESC-2        18007000
180080     MOVE 'PERSONAL '                 TO ACRS-FIELD-DESC-3        18008000
180090                                                                  18009000
180100     CALL 'CDCUT21' USING LENGTH-24                               18010000
180110                          ACRS-FIELD-DESC-2                       18011000
180120     CALL 'CDCUT21' USING LENGTH-50                               18012000
180130                          ACRS-FIELD-DESC-2-3                     18013000
180140     CALL 'CDCUT20' USING LENGTH-100                              18014000
180150                          ACRS-FIELD-DESC.                        18015000
180160                                                                  18016000
180170     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            18017000
180180     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            18018000
180190                                                                  18019000
180200     COMPUTE ACRS-FIELD-ID-3 = SUB6 + 300                         18020000
180210     MOVE ACRS-FIELD-ID-WORK        TO ACRSTRAN-FIELD-ID          18021000
180220                                                                  18022000
180230     MOVE CUR-BAL-BY-IDENT-NON-PERS (SUB6)  TO ACRSTRAN-AMOUNT    18023000
180240     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           18024000
180250         MOVE 0                TO ACRSTRAN-POS-NEG                18025000
180260       ELSE                                                       18026000
180270         MOVE 1                TO ACRSTRAN-POS-NEG                18027000
180280     END-IF.                                                      18028000
180290     MOVE SPACES                      TO ACRS-FIELD-DESC.         18029000
180300     MOVE DESC-BY-IDENT (SUB6)        TO ACRS-FIELD-DESC-2        18030000
180310     MOVE 'NON-PERSONAL '             TO ACRS-FIELD-DESC-3        18031000
180320                                                                  18032000
180330     CALL 'CDCUT21' USING LENGTH-24                               18033000
180340                          ACRS-FIELD-DESC-2                       18034000
180350     CALL 'CDCUT21' USING LENGTH-50                               18035000
180360                          ACRS-FIELD-DESC-2-3                     18036000
180370     CALL 'CDCUT20' USING LENGTH-100                              18037000
180380                          ACRS-FIELD-DESC.                        18038000
180390     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            18039000
180400     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            18040000
180410                                                                  18041000
180420*** ACRS NUMBER OF ACCOUNTS RECORD                                18042000
180430     MOVE ZEROS                     TO ACRS-FIELD-ID-WORK         18043000
180440     MOVE 082                       TO ACRS-FIELD-ID-1            18044000
180450                                                                  18045000
180460     MOVE SPACES                    TO ACRS-FIELD-DESC            18046000
180470                                       ACRSTRAN-FIELD-DESC.       18047000
180480     IF PROC-FILE-ID EQUAL 'DSD'                                  18048000
180490         MOVE 901                   TO ACRS-FIELD-ID-2            18049000
180500     ELSE                                                         18050000
180510         MOVE 902                   TO ACRS-FIELD-ID-2            18051000
180520     END-IF.                                                      18052000
180530     COMPUTE ACRS-FIELD-ID-3 = SUB6 + 200                         18053000
180540     MOVE ACRS-FIELD-ID-WORK          TO ACRSTRAN-FIELD-ID        18054000
180550                                                                  18055000
180560     MOVE SPACES                      TO ACRS-FIELD-DESC.         18056000
180570     MOVE DESC-BY-IDENT (SUB6)        TO ACRS-FIELD-DESC-2        18057000
180580     MOVE 'PERSONAL '                 TO ACRS-FIELD-DESC-3        18058000
180590     MOVE 'NUMBER'                    TO ACRS-FIELD-DESC-4        18059000
180600                                                                  18060000
180610     CALL 'CDCUT21' USING LENGTH-24                               18061000
180620                          ACRS-FIELD-DESC-2                       18062000
180630     CALL 'CDCUT21' USING LENGTH-50                               18063000
180640                          ACRS-FIELD-DESC-2-3                     18064000
180650     CALL 'CDCUT20' USING LENGTH-100                              18065000
180660                          ACRS-FIELD-DESC                         18066000
180670     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            18067000
180680                                                                  18068000
180690     COMPUTE ACRSTRAN-AMOUNT EQUAL                                18069000
180700                           NUMBER-BY-IDENT-PERS (SUB6) * 1000.    18070000
180710     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           18071000
180720         MOVE 0                TO ACRSTRAN-POS-NEG                18072000
180730       ELSE                                                       18073000
180740         MOVE 1                TO ACRSTRAN-POS-NEG                18074000
180750     END-IF.                                                      18075000
180760     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            18076000
180770                                                                  18077000
180780     COMPUTE ACRS-FIELD-ID-3 = SUB6 + 300                         18078000
180790     MOVE ACRS-FIELD-ID-WORK          TO ACRSTRAN-FIELD-ID        18079000
180800                                                                  18080000
180810     MOVE SPACES                      TO ACRS-FIELD-DESC.         18081000
180820     MOVE DESC-BY-IDENT (SUB6)        TO ACRS-FIELD-DESC-2        18082000
180830     MOVE 'NON-PERSONAL '             TO ACRS-FIELD-DESC-3        18083000
180840     MOVE 'NUMBER'                    TO ACRS-FIELD-DESC-4        18084000
180850                                                                  18085000
180860     CALL 'CDCUT21' USING LENGTH-24                               18086000
180870                          ACRS-FIELD-DESC-2                       18087000
180880     CALL 'CDCUT21' USING LENGTH-50                               18088000
180890                          ACRS-FIELD-DESC-2-3                     18089000
180900     CALL 'CDCUT20' USING LENGTH-100                              18090000
180910                          ACRS-FIELD-DESC                         18091000
180920     MOVE ACRS-FIELD-DESC      TO ACRSTRAN-FIELD-DESC.            18092000
180930                                                                  18093000
180940     COMPUTE ACRSTRAN-AMOUNT EQUAL                                18094000
180950                           NUMBER-BY-IDENT-NON-PERS (SUB6) * 1000.18095000
180960     IF ACRSTRAN-AMOUNT LESS THAN ZEROS                           18096000
180970         MOVE 0                TO ACRSTRAN-POS-NEG                18097000
180980       ELSE                                                       18098000
180990         MOVE 1                TO ACRSTRAN-POS-NEG                18099000
181000     END-IF.                                                      18100000
181010     WRITE ACRS-TRAN-REC   FROM ACRS-DSDS-FILE-LAYOUT.            18101000
181020 P6939-EXIT.                                                      18102000
181030     EXIT.                                                        18103000
181040                                                                  18104000
181050******************************************************************18105000
181060* SUBROUTINE - W R I T E  S T O C K  P A P E R  R E P O R T S    *18106000
181070******************************************************************18107000
181080 P7000-WRITE-STOCK.                                               18108000
181090     CALL 'DSDM102' USING DSDM102-ACTION-CODE                     18109000
181100                          STOCK-WORK.                             18110000
181110                                                                  18111000
181120 P7009-EXIT.                                                      18112000
181130     EXIT.                                                        18113000
181140                                                                  18114000
181150******************************************************************18115000
181160* SUBROUTINE - T R I A L  B A L A N C E  R E P O R T             *18116000
181170******************************************************************18117000
181180 P7010-BUILD-TRIAL-BALANCE.                                       18118000
181190     IF CLOSED                                                    18119000
181200         IF TODAY OR PROC-YEAR-END                                18120000
181210             NEXT SENTENCE                                        18121000
181220           ELSE                                                   18122000
181230             GO TO P7019-EXIT.                                    18123000
181240     MOVE 001 TO SUB1.                                            18124000
181250     PERFORM P7018-TRIAL-BALANCE.                                 18125000
181260     GO TO P7014-CHECK-040.                                       18126000
181270                                                                  18127000
181280 P7014-CHECK-040.                                                 18128000
181290     MOVE 040 TO SUB1.                                            18129000
181300     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18130000
181310     IF HOLD-FREQ-RPT = 0                                         18131000
181320         GO TO P7019-EXIT.                                        18132000
181330                                                                  18133000
181340 P7018-TRIAL-BALANCE.                                             18134000
181350     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18135000
181360                                                                  18136000
181370 P7019-EXIT.                                                      18137000
181380     EXIT.                                                        18138000
181390                                                                  18139000
181400******************************************************************18140000
181410* SUBROUTINE - D E P O S I T  L I S T  R E P O R T               *18141000
181420******************************************************************18142000
181430 P7020-BUILD-DEPOSIT-LIST.                                        18143000
181440     MOVE 002 TO SUB1.                                            18144000
181450     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18145000
181460     IF HOLD-FREQ-RPT = 0                                         18146000
181470         GO TO P7029-EXIT.                                        18147000
181480     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18148000
181490                                                                  18149000
181500 P7029-EXIT.                                                      18150000
181510     EXIT.                                                        18151000
181520                                                                  18152000
181530******************************************************************18153000
181540* SUBROUTINE - K I T E  S U S P E C T  R E P O R T               *18154000
181550******************************************************************18155000
181560 P7030-BUILD-KITE-SUSPECT.                                        18156000
181570     MOVE 003 TO SUB1.                                            18157000
181580     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18158000
181590     IF HOLD-FREQ-RPT = 0                                         18159000
181600         GO TO P7039-EXIT.                                        18160000
181610     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18161000
181620                                                                  18162000
181630 P7039-EXIT.                                                      18163000
181640     EXIT.                                                        18164000
181650                                                                  18165000
181660******************************************************************18166000
181670* SUBROUTINE - O V E R D R A W N  A C C O U N T S  R P T.        *18167000
181680******************************************************************18168000
181690 P7050-BUILD-OVERDRAWN-ACCTS.                                     18169000
181700     IF BANK-UNPOST-ITEMS                                         18170000
181710         GO TO P7059-EXIT.                                        18171000
181720     MOVE 005 TO SUB1.                                            18172000
181730     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18173000
181740     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18174000
181750                                                                  18175000
181760 P7052-CHK-064.                                                   18176000
181770     MOVE 064 TO SUB1.                                            18177000
181780     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18178000
181790     IF HOLD-FREQ-RPT = 0                                         18179000
181800         GO TO P7054-CHK-083.                                     18180000
181810     IF WORK-OD-LIMIT LESS THAN SELECT-BAL-RPT-64                 18181000
181820         GO TO P7054-CHK-083.                                     18182000
181830     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18183000
181840                                                                  18184000
181850 P7054-CHK-083.                                                   18185000
181860     MOVE 083 TO SUB1.                                            18186000
181870     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18187000
181880     IF HOLD-FREQ-RPT = 0                                         18188000
181890         GO TO P7056-CHK-090.                                     18189000
181900     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18190000
181910                                                                  18191000
181920 P7056-CHK-090.                                                   18192000
181930     IF NON-OD-ACCESS-BANK                                        18193000
181940         GO TO P7059-EXIT.                                        18194000
181950     IF OD-ACCESS-CODE = 00                                       18195000
181960         GO TO P7059-EXIT.                                        18196000
181970     MOVE 090 TO SUB1.                                            18197000
181980     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18198000
181990     IF HOLD-FREQ-RPT = 0                                         18199000
182000         GO TO P7059-EXIT.                                        18200000
182010     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18201000
182020                                                                  18202000
182030 P7059-EXIT.                                                      18203000
182040     EXIT.                                                        18204000
182050                                                                  18205000
182060******************************************************************18206000
182070* SUBROUTINE - H O L D  R E P O R T                              *18207000
182080******************************************************************18208000
182090 P7060-BUILD-HOLD-REC.                                            18209000
182100     IF SPW-HA-RPT-REASON = 'F' OR 'N'                            18210000
182110         GO TO P7065-BUILD-HA-FROM-TX.                            18211000
182120     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18212000
182130     MOVE ' ' TO SPW-HA-RPT-REASON.                               18213000
182140     GO TO P7069-EXIT.                                            18214000
182150                                                                  18215000
182160 P7065-BUILD-HA-FROM-TX.                                          18216000
182170     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18217000
182180     MOVE ' ' TO SPW-HA-RPT-REASON.                               18218000
182190                                                                  18219000
182200 P7069-EXIT.                                                      18220000
182210     EXIT.                                                        18221000
182220                                                                  18222000
182230******************************************************************18223000
182240* SUBROUTINE - C L O S E D  A C C O U N T S  R E P O R T         *18224000
182250******************************************************************18225000
182260 P7090-BUILD-CLOSED-ACCTS.                                        18226000
182270     IF CLOSED                                                    18227000
182280         NEXT SENTENCE                                            18228000
182290       ELSE                                                       18229000
182300         GO TO P7099-EXIT.                                        18230000
182310     IF TODAY                                                     18231000
182320         NEXT SENTENCE                                            18232000
182330       ELSE                                                       18233000
182340         GO TO P7092-CA-CHECK-41.                                 18234000
182350     MOVE 009 TO SUB1.                                            18235000
182360     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18236000
182370     IF HOLD-FREQ-RPT = 0                                         18237000
182380         GO TO P7092-CA-CHECK-41.                                 18238000
182390     PERFORM P7094-BUILD-CA.                                      18239000
182400                                                                  18240000
182410 P7092-CA-CHECK-41.                                               18241000
182420     IF THIS-MONTH OR THIS-WEEK OR TODAY                          18242000
182430         NEXT SENTENCE                                            18243000
182440       ELSE                                                       18244000
182450         GO TO P7099-EXIT.                                        18245000
182460     MOVE 041 TO SUB1.                                            18246000
182470     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18247000
182480     IF HOLD-FREQ-RPT = 0                                         18248000
182490         GO TO P7099-EXIT.                                        18249000
182500                                                                  18250000
182510 P7094-BUILD-CA.                                                  18251000
182520     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18252000
182530     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18253000
182540                                                                  18254000
182550 P7099-EXIT.                                                      18255000
182560     EXIT.                                                        18256000
182570                                                                  18257000
182580******************************************************************18258000
182590* SUBROUTINE - N E W  A C C O U N T S  R E P O R T               *18259000
182600******************************************************************18260000
182610 P7100-BUILD-NEW-ACCT.                                            18261000
182620     IF TODAY                                                     18262000
182630         NEXT SENTENCE                                            18263000
182640       ELSE                                                       18264000
182650         GO TO P7103-NA-CHECK-42.                                 18265000
182660     MOVE 010 TO SUB1.                                            18266000
182670     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18267000
182680     IF HOLD-FREQ-RPT = 1                                         18268000
182690         PERFORM P7106-BUILD-NA.                                  18269000
182700                                                                  18270000
182710 P7103-NA-CHECK-42.                                               18271000
182720     IF TODAY OR THIS-WEEK OR THIS-MONTH                          18272000
182730         NEXT SENTENCE                                            18273000
182740       ELSE                                                       18274000
182750         GO TO P7109-EXIT.                                        18275000
182760     MOVE 042 TO SUB1.                                            18276000
182770     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18277000
182780     IF HOLD-FREQ-RPT = 0                                         18278000
182790         GO TO P7109-EXIT.                                        18279000
182800                                                                  18280000
182810 P7106-BUILD-NA.                                                  18281000
182820     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18282000
182830                                                                  18283000
182840 P7109-EXIT.                                                      18284000
182850     EXIT.                                                        18285000
182860                                                                  18286000
182870******************************************************************18287000
182880* SUBROUTINE - D O R M A N T / I N A C T I V E  R E P O R T      *18288000
182890******************************************************************18289000
182900 P7110-BUILD-DORM-INACTIVE.                                       18290000
182910     MOVE 011 TO SUB1.                                            18291000
182920     GO TO P7114-BUILD-DI.                                        18292000
182930                                                                  18293000
182940 P7112-DI-CHECK-32.                                               18294000
182950     MOVE 032 TO SUB1.                                            18295000
182960     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18296000
182970     IF HOLD-FREQ-RPT = 0                                         18297000
182980         GO TO P7119-EXIT.                                        18298000
182990                                                                  18299000
183000 P7114-BUILD-DI.                                                  18300000
183010     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18301000
183020                                                                  18302000
183030 P7119-EXIT.                                                      18303000
183040     EXIT.                                                        18304000
183050                                                                  18305000
183060******************************************************************18306000
183070* SUBROUTINE - O.D.B.  A C T I V I T Y  R E P O R T              *18307000
183080******************************************************************18308000
183090 P7120-BUILD-ODB-ACTIVITY.                                        18309000
183100     MOVE 012 TO SUB1.                                            18310000
183110     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18311000
183120                                                                  18312000
183130 P7122-ODB-ACTIVITY-73.                                           18313000
183140     IF SECURITIES-LINE                                           18314000
183150         NEXT SENTENCE                                            18315000
183160       ELSE                                                       18316000
183170         GO TO P7129-EXIT.                                        18317000
183180     MOVE 073 TO SUB1.                                            18318000
183190     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18319000
183200                                                                  18320000
183210 P7129-EXIT.                                                      18321000
183220     EXIT.                                                        18322000
183230                                                                  18323000
183240******************************************************************18324000
183250* SUBROUTINE - O.D.B.  T R I A L  B A L A N C E  R E P O R T     *18325000
183260******************************************************************18326000
183270 P7130-ODB-TRIAL-BALANCE.                                         18327000
183280     IF ODB-CLOSED-DELETE                                         18328000
183290         GO TO P7139-EXIT.                                        18329000
183300     MOVE 013 TO SUB1.                                            18330000
183310     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18331000
183320                                                                  18332000
183330 P7132-ODB-TB-CHECK-53.                                           18333000
183340     IF BANK-EMPLOYEE                                             18334000
183350         NEXT SENTENCE                                            18335000
183360       ELSE                                                       18336000
183370         GO TO P7134-ODB-TB-CHECK-74.                             18337000
183380     MOVE 053 TO SUB1.                                            18338000
183390     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18339000
183400     IF HOLD-FREQ-RPT = 0                                         18340000
183410         GO TO P7134-ODB-TB-CHECK-74.                             18341000
183420     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18342000
183430                                                                  18343000
183440 P7134-ODB-TB-CHECK-74.                                           18344000
183450     IF SECURITIES-LINE                                           18345000
183460         NEXT SENTENCE                                            18346000
183470       ELSE                                                       18347000
183480         GO TO P7139-EXIT.                                        18348000
183490     MOVE 074 TO SUB1.                                            18349000
183500     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18350000
183510                                                                  18351000
183520 P7139-EXIT.                                                      18352000
183530     EXIT.                                                        18353000
183540                                                                  18354000
183550******************************************************************18355000
183560* SUBROUTINE - O.D.B.  C U T O F F  A C C O U N T S  R P T.      *18356000
183570******************************************************************18357000
183580 P7140-BUILD-CUTOFF-ACCTS.                                        18358000
183590     IF ODB-PLAN = SPACES                                         18359000
183600         GO TO P7149-EXIT.                                        18360000
183610     IF ODB-CLOSED-DELETE                                         18361000
183620         GO TO P7149-EXIT.                                        18362000
183630     MOVE 014 TO SUB1.                                            18363000
183640     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18364000
183650     IF HOLD-FREQ-RPT = 0                                         18365000
183660         GO TO P7142-BUILD-CUTOFF-ACCTS-75.                       18366000
183670     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18367000
183680                                                                  18368000
183690 P7142-BUILD-CUTOFF-ACCTS-75.                                     18369000
183700     IF SECURITIES-LINE                                           18370000
183710         NEXT SENTENCE                                            18371000
183720       ELSE                                                       18372000
183730         GO TO P7149-EXIT.                                        18373000
183740     MOVE 075 TO SUB1.                                            18374000
183750     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18375000
183760     IF HOLD-FREQ-RPT = 0                                         18376000
183770         GO TO P7149-EXIT.                                        18377000
183780     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18378000
183790                                                                  18379000
183800 P7149-EXIT.                                                      18380000
183810     EXIT.                                                        18381000
183820                                                                  18382000
183830******************************************************************18383000
183840* SUBROUTINE - SERVICE CHARGE/INTEREST EARNINGS R E P O R T      *18384000
183850******************************************************************18385000
183860 P7150-BUILD-IE-SC-JRNL.                                          18386000
183870     IF BANK-CTL-ACCTS                                            18387000
183880         GO TO P7159-EXIT.                                        18388000
183890     MOVE 015 TO SUB1.                                            18389000
183900     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18390000
183910     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18391000
183920                                                                  18392000
183930 P7159-EXIT.                                                      18393000
183940     EXIT.                                                        18394000
183950                                                                  18395000
183960******************************************************************18396000
183970*SUBROUTINE - D A I L Y   E X T E R N A L   S E R V   C H A R G E*18397000
183980******************************************************************18398000
183990 P7160-DAILY-EXT-SC-RPT.                                          18399000
184000     MOVE 016 TO SUB1.                                            18400000
184010     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18401000
184020     IF HOLD-FREQ-RPT = 0                                         18402000
184030         GO TO P7169-EXIT.                                        18403000
184040     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18404000
184050                                                                  18405000
184060 P7169-EXIT.                                                      18406000
184070     EXIT.                                                        18407000
184080                                                                  18408000
184090******************************************************************18409000
184100* SUBROUTINE - A C C T S. C L O S E D  B Y  S.C.  R E P O R T    *18410000
184110******************************************************************18411000
184120 P7180-BUILD-SC-CLOSED.                                           18412000
184130     MOVE 018 TO SUB1.                                            18413000
184140     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18414000
184150                                                                  18415000
184160 P7189-EXIT.                                                      18416000
184170     EXIT.                                                        18417000
184180                                                                  18418000
184190******************************************************************18419000
184200* SUBROUTINE - C H E C K  A N D  C H E C K  R E G I S T E R      *18420000
184210******************************************************************18421000
184220 P7190-BUILD-CHECK.                                               18422000
184230     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18423000
184240     IF HOLD-FREQ-RPT = 0                                         18424000
184250         GO TO P7195-BUILD-REGISTER.                              18425000
184260     MOVE SPACES TO SPECIAL-WORK.                                 18426000
184270     MOVE SUB1 TO CK-REPORT-CODE.                                 18427000
184280     MOVE PROC-FILE-ID TO CK-FILE-ID.                             18428000
184290     MOVE BCF-BANK-NO TO CK-BANK-NO.                              18429000
184300     MOVE ACCOUNT-ID TO CK-ACCT-ID.                               18430000
184310     MOVE ACCOUNT-NUMBER TO CK-ACCT-NO.                           18431000
184320     MOVE LOW-VALUES TO CK-CRF-REC-ID.                            18432000
184330     MOVE HOLD-EARNINGS TO CK-AMT.                                18433000
184340     MOVE PROC-CURR-DATE TO CK-DT.                                18434000
184350     IF SUB1 = 095                                                18435000
184360         IF CLUB-CHECK-EFF-DATE = ZEROS OR                        18436000
184370            CLUB-CHECK-EFF-DATE LESS THAN PROC-CURR-DATE          18437000
184380             NEXT SENTENCE                                        18438000
184390           ELSE                                                   18439000
184400             MOVE CLUB-CHECK-EFF-DATE TO CK-DT.                   18440000
184410     IF BCFSCR-OSB-SERV-CHRG-DESC-IND = '1'                       18441000
184420         MOVE BCFSCR-OSB-SERV-CHRG-DESC TO CK-SC-DESC.            18442000
184430     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           18443000
184440                                                                  18444000
184450 P7195-BUILD-REGISTER.                                            18445000
184460     MOVE 019 TO SUB1.                                            18446000
184470     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18447000
184480     IF HOLD-FREQ-RPT = 0                                         18448000
184490         GO TO P7199-EXIT.                                        18449000
184500     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18450000
184510                                                                  18451000
184520 P7199-EXIT.                                                      18452000
184530     EXIT.                                                        18453000
184540                                                                  18454000
184550******************************************************************18455000
184560* SUBROUTINE - M A S T E R / T X  E X C E P T I O N S  R P T.    *18456000
184570******************************************************************18457000
184580 P7200-MSTR-TX-EXCEPTIONS.                                        18458000
184590     IF BUSINESS-RESERVE                                          18459006
184590        IF ODB-STATUS-CODE = '04'                                 18459105
184630           GO TO P7209-EXIT                                       18459205
184590        END-IF                                                    18459305
184590     END-IF.                                                      18459405
184590     IF BANK-CTL-ACCTS                                            18459505
184600         IF WATCHED-ACH                                           18460000
184610             NEXT SENTENCE                                        18461000
184620         ELSE                                                     18462000
184630             GO TO P7209-EXIT.                                    18463000
184640                                                                  18464000
184650     IF DSDSTXL-CODE = 689 OR 799                                 18465000
184660         GO TO P7209-EXIT.                                        18466000
184670     IF HOLD-REASON-CODE = 06                                     18467000
184680         MOVE 077 TO SUB1                                         18468000
184690       ELSE                                                       18469000
184700         MOVE 020 TO SUB1.                                        18470000
184710     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18471000
184720     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18472000
184730                                                                  18473000
184740 P7209-EXIT.                                                      18474000
184750     EXIT.                                                        18475000
184760                                                                  18476000
184770******************************************************************18477000
184780* SUBROUTINE - U N P O S T E D  I T E M  R E P O R T             *18478000
184790******************************************************************18479000
184800 P7210-BUILD-UNPOSTED-ITEM.                                       18480000
184810     IF HOLD-UI-REASON = 05 OR 07                                 18481000
184820         NEXT SENTENCE                                            18482000
184830       ELSE                                                       18483000
184840         IF WATCHED OR WATCHED-ACH                                18484000
184850             MOVE 'U' TO HOLD-WA-TX-DISP                          18485000
184860             PERFORM P7250-BUILD-WATCHED-ACCT THRU P7259-EXIT.    18486000
184870*    IF PROC-DSD                                                  18487000
184880*        PERFORM P8855-CREATE-OBS-EXCPT-UNPOST THRU P8859-EXIT.   18488000
184890     MOVE 021 TO SUB1.                                            18489000
184900     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18490000
184910     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18491000
184920     MOVE 070 TO SUB1.                                            18492000
184930     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18493000
184940     IF HOLD-FREQ-RPT = 1                                         18494000
184950         PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.              18495000
184960                                                                  18496000
184970 P7212-CHECK-UI-TX-CODE.                                          18497000
184980     IF DSDSTXL-CODE GREATER THAN 699 AND LESS THAN 991           18498000
184990         GO TO P7216-ADD-UNP-DEBIT.                               18499000
185000     IF DSDSTXL-CODE LESS THAN 460                                18500000
185010         GO TO P7219-EXIT.                                        18501000
185020     IF DSDSTXL-CODE = 460                                        18502000
185030         GO TO P7216-ADD-UNP-DEBIT.                               18503000
185040     IF DSDSTXL-CODE GREATER THAN 679 AND LESS THAN 700           18504000
185050         GO TO P7218-ADD-UNP-ODB.                                 18505000
185060                                                                  18506000
185070 P7214-ADD-UNP-CREDIT.                                            18507000
185080     PERFORM P8440-BUILD-NSF-FILE-1 THRU P8449-EXIT.              18508000
185090     IF HSA-ACCT OR CESA-ACCT                                     18509000
185100         IF HOLD-UI-REASON = 07                                   18510000
185110             GO TO P7215-CONTINUE                                 18511000
185120         END-IF                                                   18512000
185130         MOVE 853                TO RPT859-RPT-NBR                18513000
185140                                    SORT859-RPT-NBR               18514000
185150         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              18515000
185160                                    RPT859-DDA-ACCT-NBR           18516000
185170         MOVE 45                 TO RPT859-EXCEPT-CODE            18517000
185180         CALL 'CDCDT48' USING PROC-CURR-DATE                      18518000
185190                              RPT859-TX-DATE                      18519000
185200         MOVE DSDSTXL-ITEM-ID    TO RPT859-ITEM-ID                18520000
185210                                    SORT859-ITEM-ID               18521000
185220         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.        18522000
185230 P7215-CONTINUE.                                                  18523000
185240     PERFORM P8855-CREATE-OBS-EXCPT-UNPOST THRU P8859-EXIT.       18524000
185250     ADD DSDSTXL-AMOUNT TO UNPOSTED-CREDIT-097.                   18525000
185260     ADD DSDSTXL-AMOUNT TO NSF-ITEM-ACCT-TOT.                     18526000
185270     IF DSDSTXL-CODE = 538 OR 537 OR 642                          18527000
185280         ADD 1 TO NUM-ZBA-CREDITS                                 18528000
185290         ADD DSDSTXL-AMOUNT TO AMT-ZBA-CREDITS.                   18529000
185300     IF DSDSTXL-CODE = 536                                        18530000
185310         ADD 1 TO NUM-ODP-CREDITS                                 18531000
185320         ADD DSDSTXL-AMOUNT TO AMT-ODP-CREDITS.                   18532000
185330     GO TO P7219-EXIT.                                            18533000
185340                                                                  18534000
185350 P7216-ADD-UNP-DEBIT.                                             18535000
185360     PERFORM P8440-BUILD-NSF-FILE-1 THRU P8449-EXIT.              18536000
185370     IF HSA-ACCT OR CESA-ACCT                                     18537000
185380         IF HOLD-UI-REASON = 07                                   18538000
185390             GO TO P7217-CONTINUE                                 18539000
185400         END-IF                                                   18540000
185410         MOVE 853                TO RPT859-RPT-NBR                18541000
185420                                    SORT859-RPT-NBR               18542000
185430         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              18543000
185440                                    RPT859-DDA-ACCT-NBR           18544000
185450         MOVE 45                 TO RPT859-EXCEPT-CODE            18545000
185460         CALL 'CDCDT48' USING PROC-CURR-DATE                      18546000
185470                              RPT859-TX-DATE                      18547000
185480         MOVE DSDSTXL-ITEM-ID    TO RPT859-ITEM-ID                18548000
185490                                    SORT859-ITEM-ID               18549000
185500         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.        18550000
185510 P7217-CONTINUE.                                                  18551000
185520     PERFORM P8855-CREATE-OBS-EXCPT-UNPOST THRU P8859-EXIT.       18552000
185530     ADD DSDSTXL-AMOUNT TO UNPOSTED-DEBIT-097.                    18553000
185540     SUBTRACT DSDSTXL-AMOUNT FROM NSF-ITEM-ACCT-TOT.              18554000
185550     IF DSDSTXL-CODE = 869 OR 917 OR 942                          18555000
185560         ADD 1 TO NUM-ZBA-DEBITS                                  18556000
185570         ADD DSDSTXL-AMOUNT TO AMT-ZBA-DEBITS.                    18557000
185580     IF DSDSTXL-CODE = 916                                        18558000
185590         ADD 1 TO NUM-ODP-DEBITS                                  18559000
185600         ADD DSDSTXL-AMOUNT TO AMT-ODP-DEBITS.                    18560000
185610     GO TO P7219-EXIT.                                            18561000
185620                                                                  18562000
185630 P7218-ADD-UNP-ODB.                                               18563000
185640     PERFORM P8855-CREATE-OBS-EXCPT-UNPOST THRU P8859-EXIT.       18564000
185650     IF DSDSTXL-CODE = 680 OR 681 OR 689                          18565000
185660         ADD DSDSTXL-AMOUNT TO UNPOSTED-CREDIT-ODB                18566000
185670       ELSE                                                       18567000
185680         ADD DSDSTXL-AMOUNT TO UNPOSTED-DEBIT-ODB.                18568000
185690                                                                  18569000
185700 P7219-EXIT.                                                      18570000
185710     EXIT.                                                        18571000
185720                                                                  18572000
185730******************************************************************18573000
185740* SUBROUTINE - W A T C H E D   A C C O U N T S   R E P O R T     *18574000
185750******************************************************************18575000
185760 P7250-BUILD-WATCHED-ACCT.                                        18576000
185770     MOVE 025 TO SUB1.                                            18577000
185780     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18578000
185790     IF HOLD-FREQ-RPT = 0                                         18579000
185800         GO TO P7255-END-WA.                                      18580000
185810     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18581000
185820                                                                  18582000
185830 P7255-END-WA.                                                    18583000
185840     MOVE SPACE TO HOLD-WA-TX-DISP.                               18584000
185850                                                                  18585000
185860 P7259-EXIT.                                                      18586000
185870     EXIT.                                                        18587000
185880                                                                  18588000
185890******************************************************************18589000
185900*             M A T U R E D   R . P .   R E P O R T              *18590000
185910******************************************************************18591000
185920 P7260-MATURE-RP-RPT.                                             18592000
185930     MOVE 026 TO SUB1.                                            18593000
185940     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18594000
185950     IF HOLD-FREQ-RPT = 0                                         18595000
185960         GO TO P7269-EXIT.                                        18596000
185970     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18597000
185980                                                                  18598000
185990 P7269-EXIT.                                                      18599000
186000     EXIT.                                                        18600000
186010                                                                  18601000
186020******************************************************************18602000
186030*            P U R C H A S E   R . P .   R E P O R T             *18603000
186040******************************************************************18604000
186050 P7270-PURCHASE-RP-RPT.                                           18605000
186060     MOVE 027 TO SUB1.                                            18606000
186070     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18607000
186080     IF HOLD-FREQ-RPT = 0                                         18608000
186090         GO TO P7279-EXIT.                                        18609000
186100     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18610000
186110                                                                  18611000
186120 P7279-EXIT.                                                      18612000
186130     EXIT.                                                        18613000
186140                                                                  18614000
186150******************************************************************18615000
186160*              R . P .   T R I A L   B A L A N C E               *18616000
186170******************************************************************18617000
186180 P7280-RP-TRIAL-BALANCE.                                          18618000
186190     IF INV-CLOSED                                                18619000
186200         GO TO P7289-EXIT.                                        18620000
186210     MOVE 028 TO SUB1.                                            18621000
186220     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18622000
186230     IF HOLD-FREQ-RPT = 0                                         18623000
186240         GO TO P7289-EXIT.                                        18624000
186250     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18625000
186260                                                                  18626000
186270 P7289-EXIT.                                                      18627000
186280     EXIT.                                                        18628000
186290                                                                  18629000
186300******************************************************************18630000
186310*          R . P .   M A N A G E M E N T   R E P O R T           *18631000
186320******************************************************************18632000
186330 P7290-MANAGE-RPT.                                                18633000
186340     IF INV-CLOSED                                                18634000
186350         CALL 'CDCDT17' USING INV-MATURE-DATE                     18635000
186360                              INV-DATE-WK                         18636000
186370         IF TDY-YR = INV-DT-YR AND                                18637000
186380            TDY-MO = INV-DT-MO                                    18638000
186390             NEXT SENTENCE                                        18639000
186400           ELSE                                                   18640000
186410             GO TO P7299-EXIT.                                    18641000
186420     IF CLOSED                                                    18642000
186430         IF INV-NORMAL OR INV-CUTOFF OR INV-CLOSED-CYC-STMT       18643000
186440             MOVE INV-STATUS-CODE TO HOLD-OLD-INV-STAT            18644000
186450             MOVE '09' TO INV-STATUS-CODE                         18645000
186460                          HOLD-NEW-INV-STAT                       18646000
186470             MOVE 'Y' TO HOLD-EXTRACT-IND                         18647000
186480             PERFORM P8482-INV-STATUS-CODE-CHANGE THRU P8482-EXIT 18648000
186490             MOVE DATE-CLOSED TO INV-MATURE-DATE                  18649000
186500             GO TO P7299-EXIT.                                    18650000
186510     MOVE 029 TO SUB1.                                            18651000
186520     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18652000
186530     IF HOLD-FREQ-RPT = 0                                         18653000
186540         GO TO P7299-EXIT.                                        18654000
186550     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18655000
186560     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18656000
186570                                                                  18657000
186580 P7299-EXIT.                                                      18658000
186590     EXIT.                                                        18659000
186600                                                                  18660000
186610******************************************************************18661000
186620*               R . P .   N E W   A C C O U N T S                *18662000
186630******************************************************************18663000
186640 P7300-RP-NEW-ACCOUNTS.                                           18664000
186650     MOVE 030 TO SUB1.                                            18665000
186660     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18666000
186670     IF HOLD-FREQ-RPT = 0                                         18667000
186680         GO TO P7309-EXIT.                                        18668000
186690     CALL 'CDCDT17' USING INV-OPEN-DATE                           18669000
186700                          INV-DATE-WK.                            18670000
186710     IF TDY-YR = INV-DT-YR AND                                    18671000
186720        TDY-MO = INV-DT-MO                                        18672000
186730         NEXT SENTENCE                                            18673000
186740       ELSE                                                       18674000
186750         GO TO P7309-EXIT.                                        18675000
186760     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18676000
186770                                                                  18677000
186780 P7309-EXIT.                                                      18678000
186790     EXIT.                                                        18679000
186800                                                                  18680000
186810******************************************************************18681000
186820*            R . P .   C L O S E D   A C C O U N T S             *18682000
186830******************************************************************18683000
186840 P7310-RP-CLOSED-ACCOUNTS.                                        18684000
186850     IF INV-CLOSED OR INV-CLOSED-CYC-STMT                         18685000
186860         NEXT SENTENCE                                            18686000
186870       ELSE                                                       18687000
186880         GO TO P7319-EXIT.                                        18688000
186890     MOVE 031 TO SUB1.                                            18689000
186900     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18690000
186910     IF HOLD-FREQ-RPT = 0                                         18691000
186920         GO TO P7319-EXIT.                                        18692000
186930     CALL 'CDCDT17' USING INV-MATURE-DATE                         18693000
186940                          INV-DATE-WK.                            18694000
186950     IF TDY-YR = INV-DT-YR AND                                    18695000
186960        TDY-MO = INV-DT-MO                                        18696000
186970         NEXT SENTENCE                                            18697000
186980       ELSE                                                       18698000
186990         GO TO P7319-EXIT.                                        18699000
187000     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18700000
187010                                                                  18701000
187020 P7319-EXIT.                                                      18702000
187030     EXIT.                                                        18703000
187040                                                                  18704000
187050******************************************************************18705000
187060* SUBROUTINE - O.D.B.  A G I N G  A C C O U N T S  R E P O R T   *18706000
187070******************************************************************18707000
187080 P7330-BUILD-AGING-ACCTS.                                         18708000
187090     MOVE 033 TO SUB1.                                            18709000
187100     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18710000
187110     IF HOLD-FREQ-RPT = 0                                         18711000
187120         GO TO P7339-EXIT.                                        18712000
187130     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18713000
187140                                                                  18714000
187150 P7339-EXIT.                                                      18715000
187160     EXIT.                                                        18716000
187170                                                                  18717000
187180******************************************************************18718000
187190* SUBROUTINE - O.D.B.  M A T U R I T Y   L I S T                 *18719000
187200******************************************************************18720000
187210 P7370-ODB-MATURITY-LIST.                                         18721000
187220     IF ODB-CLOSED-DELETE                                         18722000
187230         GO TO P7379-EXIT.                                        18723000
187240     IF ODB-MATURITY-DATE = ZEROS                                 18724000
187250         GO TO P7379-EXIT.                                        18725000
187260     IF ODB-MATURITY-DATE LESS THAN ODB-MAT-END-DATE              18726000
187270         NEXT SENTENCE                                            18727000
187280       ELSE                                                       18728000
187290         GO TO P7379-EXIT.                                        18729000
187300     MOVE 037 TO SUB1.                                            18730000
187310     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18731000
187320     IF HOLD-FREQ-RPT = 0                                         18732000
187330         GO TO P7379-EXIT.                                        18733000
187340     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18734000
187350                                                                  18735000
187360 P7379-EXIT.                                                      18736000
187370     EXIT.                                                        18737000
187380                                                                  18738000
187390******************************************************************18739000
187400*        C O M M E R C I A L  A C C O U N T  S U S P E C T       *18740000
187410******************************************************************18741000
187420 P7390-CHECK-COMM-SUSPECT.                                        18742000
187430     MOVE 039 TO SUB1.                                            18743000
187440     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18744000
187450     IF HOLD-FREQ-RPT = 0                                         18745000
187460         GO TO P7399-EXIT.                                        18746000
187470     IF BCFSCR-COMMERCIAL OR BCFSCR-COMMERCIAL-PLUS-FDIC          18747000
187480         GO TO P7399-EXIT.                                        18748000
187490     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18749000
187500     IF PROC-MONTH-END                                            18750000
187510         NEXT SENTENCE                                            18751000
187520       ELSE                                                       18752000
187530         GO TO P7392-NOT-MONTH-END.                               18753000
187540     IF HIST-NOT-AVAILABLE (1)                                    18754000
187550         GO TO P7399-EXIT.                                        18755000
187560     IF NUM-SC-ITEMS (1) GREATER THAN SELECT-CNT-RPT-39           18756000
187570         GO TO P7398-DO-COMM-SUSPECT.                             18757000
187580     GO TO P7399-EXIT.                                            18758000
187590                                                                  18759000
187600 P7392-NOT-MONTH-END.                                             18760000
187610     IF HIST-NOT-AVAILABLE (2)                                    18761000
187620         GO TO P7399-EXIT.                                        18762000
187630     IF NUM-SC-ITEMS (2) GREATER THAN SELECT-CNT-RPT-39           18763000
187640         GO TO P7398-DO-COMM-SUSPECT.                             18764000
187650     GO TO P7399-EXIT.                                            18765000
187660                                                                  18766000
187670 P7398-DO-COMM-SUSPECT.                                           18767000
187680     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18768000
187690                                                                  18769000
187700 P7399-EXIT.                                                      18770000
187710     EXIT.                                                        18771000
187720                                                                  18772000
187730******************************************************************18773000
187740*SUBROUTINE - R E L A T E D  A C C T S.  S.C. J O U R N A L      *18774000
187750******************************************************************18775000
187760 P7430-BUILD-REL-SC-JRNL.                                         18776000
187770     IF CLOSED                                                    18777000
187780         GO TO P7439-EXIT.                                        18778000
187790     MOVE 043 TO SUB1.                                            18779000
187800     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18780000
187810     IF HOLD-FREQ-RPT = 0                                         18781000
187820         GO TO P7439-EXIT.                                        18782000
187830     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18783000
187840     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18784000
187850                                                                  18785000
187860 P7439-EXIT.                                                      18786000
187870     EXIT.                                                        18787000
187880                                                                  18788000
187890******************************************************************18789000
187900*SUBROUTINE - C O R P O R A T E  A C C T S.  R E P O R T         *18790000
187910******************************************************************18791000
187920 P7440-BUILD-CORP-ACCTS.                                          18792000
187930     MOVE 044 TO SUB1.                                            18793000
187940     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18794000
187950     IF HOLD-FREQ-RPT = 0                                         18795000
187960         GO TO P7449-EXIT.                                        18796000
187970     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18797000
187980     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18798000
187990                                                                  18799000
188000 P7449-EXIT.                                                      18800000
188010     EXIT.                                                        18801000
188020                                                                  18802000
188030******************************************************************18803000
188040* SUBROUTINE - L A R G E  A V E R A G E  B A L A N C E  R P T.   *18804000
188050******************************************************************18805000
188060 P7450-BUILD-LARGE-AVG-BAL.                                       18806000
188070     MOVE 045 TO SUB1.                                            18807000
188080     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18808000
188090     IF HOLD-FREQ-RPT = 0                                         18809000
188100         GO TO P7459-EXIT.                                        18810000
188110     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18811000
188120     IF CYCLE-THIS-STMT = 1                                       18812000
188130         MOVE AVG-COLL-BAL-CYC (1) TO HOLD-AVERAGE                18813000
188140       ELSE                                                       18814000
188150         IF DAYS-IN-CYCLE = ZEROS                                 18815000
188160             MOVE ZEROS TO HOLD-AVERAGE                           18816000
188170           ELSE                                                   18817000
188180             COMPUTE HOLD-AVERAGE ROUNDED =                       18818000
188190                 GROSS-COLL-BAL-CYCL / DAYS-IN-CYCLE.             18819000
188200     IF HOLD-AVERAGE LESS THAN SELECT-BAL-RPT-45                  18820000
188210         GO TO P7459-EXIT.                                        18821000
188220     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18822000
188230                                                                  18823000
188240 P7459-EXIT.                                                      18824000
188250     EXIT.                                                        18825000
188260                                                                  18826000
188270******************************************************************18827000
188280* SUBROUTINE - N E G A T I V E  N E T  C O L L E C T E D  R P T. *18828000
188290******************************************************************18829000
188300 P7460-BUILD-NEG-NET.                                             18830000
188310     MOVE 046 TO SUB1.                                            18831000
188320     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18832000
188330     IF HOLD-FREQ-RPT = 0                                         18833000
188340         GO TO P7469-EXIT.                                        18834000
188350     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18835000
188360     IF PROC-MONTH-END                                            18836000
188370         NEXT SENTENCE                                            18837000
188380       ELSE                                                       18838000
188390         GO TO P7462-NOT-MONTH-END.                               18839000
188400     IF AVG-COLL-BAL-CYC (1) NEGATIVE                             18840000
188410         GO TO P7468-DO-NEG-NET.                                  18841000
188420     GO TO P7469-EXIT.                                            18842000
188430                                                                  18843000
188440 P7462-NOT-MONTH-END.                                             18844000
188450     IF AVG-COLL-BAL-CYC (2) NEGATIVE                             18845000
188460         GO TO P7468-DO-NEG-NET.                                  18846000
188470     GO TO P7469-EXIT.                                            18847000
188480                                                                  18848000
188490 P7468-DO-NEG-NET.                                                18849000
188500     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18850000
188510                                                                  18851000
188520 P7469-EXIT.                                                      18852000
188530     EXIT.                                                        18853000
188540                                                                  18854000
188550******************************************************************18855000
188560* SUBROUTINE - S U M M A R Y  O F  A C C O U N T S  R E P O R T  *18856000
188570******************************************************************18857000
188580 P7470-BUILD-SUMMARY-OF-ACCTS.                                    18858000
188590     IF CLOSED                                                    18859000
188600         GO TO P7489-EXIT.                                        18860000
188610     MOVE 047 TO SUB1.                                            18861000
188620     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18862000
188630     IF HOLD-FREQ-RPT = 0                                         18863000
188640         GO TO P7472-CHECK-SA-48.                                 18864000
188650     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18865000
188660     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18866000
188670     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18867000
188680                                                                  18868000
188690 P7472-CHECK-SA-48.                                               18869000
188700     MOVE ZEROS TO HOLD-CS-SC-AMT.                                18870000
188710     MOVE 048 TO SUB1.                                            18871000
188720     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18872000
188730     IF HOLD-FREQ-RPT = 0                                         18873000
188740         GO TO P7474-CHECK-SA-49.                                 18874000
188750     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18875000
188760     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18876000
188770     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18877000
188780                                                                  18878000
188790 P7474-CHECK-SA-49.                                               18879000
188800     IF PRIMARY-OFFICER = SPACES                                  18880000
188810         GO TO P7476-CHECK-SA-50.                                 18881000
188820     MOVE 049 TO SUB1.                                            18882000
188830     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18883000
188840     IF HOLD-FREQ-RPT = 0                                         18884000
188850         GO TO P7476-CHECK-SA-50.                                 18885000
188860     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18886000
188870     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18887000
188880     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18888000
188890                                                                  18889000
188900 P7476-CHECK-SA-50.                                               18890000
188910     IF SC-DISP-CHARGE                                            18891000
188920         GO TO P7478-CHECK-SA-51.                                 18892000
188930     MOVE 050 TO SUB1.                                            18893000
188940     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18894000
188950     IF HOLD-FREQ-RPT = 0                                         18895000
188960         GO TO P7478-CHECK-SA-51.                                 18896000
188970     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18897000
188980     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18898000
188990     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18899000
189000                                                                  18900000
189010 P7478-CHECK-SA-51.                                               18901000
189020     MOVE 051 TO SUB1.                                            18902000
189030     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18903000
189040     IF HOLD-FREQ-RPT = 0                                         18904000
189050         GO TO P7480-CHECK-SA-52.                                 18905000
189060     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18906000
189070                                                                  18907000
189080 P7480-CHECK-SA-52.                                               18908000
189090     MOVE 052 TO SUB1.                                            18909000
189100     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18910000
189110     IF HOLD-FREQ-RPT = 0                                         18911000
189120         GO TO P7481-CHECK-SA-59.                                 18912000
189130     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18913000
189140                                                                  18914000
189150 P7481-CHECK-SA-59.                                               18915000
189160     MOVE 059 TO SUB1.                                            18916000
189170     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18917000
189180     IF HOLD-FREQ-RPT = 0                                         18918000
189190         GO TO P7482-CHECK-SA-69.                                 18919000
189200     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18920000
189210     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18921000
189220     PERFORM P7484-BUILD-SA-RPT THRU P7486-EXIT.                  18922000
189230                                                                  18923000
189240 P7482-CHECK-SA-69.                                               18924000
189250     IF SC-DISP-CHARGE                                            18925000
189260         GO TO P7489-EXIT.                                        18926000
189270     MOVE 069 TO SUB1.                                            18927000
189280     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18928000
189290     IF HOLD-FREQ-RPT = 0                                         18929000
189300         GO TO P7489-EXIT.                                        18930000
189310     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   18931000
189320     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                18932000
189330                                                                  18933000
189340 P7484-BUILD-SA-RPT.                                              18934000
189350     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  18935000
189360                                                                  18936000
189370 P7486-EXIT.                                                      18937000
189380     EXIT.                                                        18938000
189390                                                                  18939000
189400 P7489-EXIT.                                                      18940000
189410     EXIT.                                                        18941000
189420                                                                  18942000
189430******************************************************************18943000
189440*B B I - C Y C L E   C O D E   4 6   E X C E P T I O N   REPORT  *18944000
189450******************************************************************18945000
189460 P7540-CYCLE-CODE-46-EXCEPTIONS.                                  18946000
189470     IF PROC-DSS                                                  18947000
189480         GO TO P7549-EXIT.                                        18948000
189490     IF CLOSED                                                    18949000
189500         GO TO P7549-EXIT.                                        18950000
189510     IF DDA-SEC-STMT OR NO-STMT                                   18951000
189520         GO TO P7549-EXIT.                                        18952000
189530     IF STMT-CYCLE-CODE EQUAL 99                                  18953000
189540         GO TO P7549-EXIT                                         18954000
189550     END-IF.                                                      18955000
189560     MOVE 054 TO SUB1.                                            18956000
189570     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               18957000
189580     IF HOLD-FREQ-RPT = 0                                         18958000
189590         GO TO P7549-EXIT.                                        18959000
189600     MOVE PROC-BK-NO TO DSXRF-BANK-NBR.                           18960000
189610     MOVE ACCOUNT-ID TO DSXRF-ACCT-ID.                            18961000
189620     MOVE ACCOUNT-NUMBER TO DSXRF-ACCT-NBR.                       18962000
189630     EXEC SQL                                                     18963000
189640         SELECT                                                   18964000
189650             DSXRF_BANK_NBR,                                      18965000
189660             DSXRF_ACCT_ID,                                       18966000
189670             DSXRF_ACCT_NBR,                                      18967000
189680             DSXRF_OSB_BANK_NBR,                                  18968000
189690             DSXRF_OSB_FILE_ID,                                   18969000
189700             DSXRF_OSB_FILE_KEY                                   18970000
189710         INTO                                                     18971000
189720            :DSXRF-BANK-NBR,                                      18972000
189730            :DSXRF-ACCT-ID,                                       18973000
189740            :DSXRF-ACCT-NBR,                                      18974000
189750            :DSXRF-OSB-BANK-NBR,                                  18975000
189760            :DSXRF-OSB-FILE-ID,                                   18976000
189770            :DSXRF-OSB-FILE-KEY                                   18977000
189780         FROM DSDS.OSBXREF                                        18978000
189790         WHERE DSXRF_BANK_NBR = :DSXRF-BANK-NBR AND               18979000
189800               DSXRF_ACCT_ID  = :DSXRF-ACCT-ID  AND               18980000
189810               DSXRF_ACCT_NBR = :DSXRF-ACCT-NBR AND               18981000
189820               DSXRF_OSB_FILE_ID IN ('DB  ', 'MF  ', 'INV ')      18982000
189830     END-EXEC.                                                    18983000
189840                                                                  18984000
189850     EVALUATE SQLCODE                                             18985000
189860         WHEN ZEROS                                               18986000
189870         WHEN -811                                                18987000
189880             IF STMT-CYCLE-CODE = +046                            18988000
189890                 GO TO P7549-EXIT                                 18989000
189900               ELSE                                               18990000
189910                 GO TO P7541-CHANGE-CODES                         18991000
189920             END-IF                                               18992000
189930         WHEN +100                                                18993000
189940             IF STMT-CYCLE-CODE = +046                            18994000
189950                 GO TO P7541-CHANGE-CODES                         18995000
189960               ELSE                                               18996000
189970                 GO TO P7549-EXIT                                 18997000
189980             END-IF                                               18998000
189990         WHEN OTHER                                               18999000
190000             CALL 'CDCUT90' USING SQLCA                           19000000
190010             CALL 'CDCDUMP' USING BY CONTENT '2065'               19001000
190020     END-EVALUATE.                                                19002000
190030                                                                  19003000
190040 P7541-CHANGE-CODES.                                              19004000
190050     EVALUATE STMT-CYCLE-CODE                                     19005000
190060         WHEN +046                                                19006000
190070           IF DORMANT OR DORMANT-DECEASED                         19007000
190080               MOVE STMT-CYCLE-CODE    TO HOLD-OLD-STMT-CYCLE     19008000
190090               MOVE 84                 TO STMT-CYCLE-CODE         19009000
190100               MOVE 84                 TO HOLD-NEW-STMT-CYCLE     19010000
190110               MOVE SC-EARN-CYCLE-CODE TO HOLD-OLD-SC-EARN-CYC    19011000
190120               MOVE 22                 TO SC-EARN-CYCLE-CODE      19012000
190130               MOVE 22                 TO HOLD-NEW-SC-EARN-CYC    19013000
190140               IF FIXED-ACCT                                      19014000
190150                   MOVE ACCOUNT-TYP    TO HOLD-OLD-ACCT-TYPE      19015000
190160                   MOVE ACCOUNT-TYP    TO HOLD-NEW-ACCT-TYPE      19016000
190170                   MOVE '1'            TO HOLD-NEW-ACCT-TYPE (1:1)19017000
190180               END-IF                                             19018000
190190           ELSE                                                   19019000
190200               MOVE STMT-CYCLE-CODE    TO HOLD-OLD-STMT-CYCLE     19020000
190210               MOVE 30                 TO HOLD-NEW-STMT-CYCLE     19021000
190220               MOVE SC-EARN-CYCLE-CODE TO HOLD-OLD-SC-EARN-CYC    19022000
190230               MOVE 30                 TO HOLD-NEW-SC-EARN-CYC    19023000
190240               IF FIXED-ACCT AND ZERO-BAL-ACCT-IND = SPACE        19024000
190250                             AND ML-HELOC-NBR = ZEROS             19025000
190260                             AND SAC-IND = SPACE                  19026000
190270                   MOVE ACCOUNT-TYP    TO HOLD-OLD-ACCT-TYPE      19027000
190280                   MOVE ACCOUNT-TYP    TO HOLD-NEW-ACCT-TYPE      19028000
190290                   MOVE '1'            TO HOLD-NEW-ACCT-TYPE (1:1)19029000
190300               END-IF                                             19030000
190310           END-IF                                                 19031000
190320         WHEN OTHER                                               19032000
190330             MOVE STMT-CYCLE-CODE    TO HOLD-OLD-STMT-CYCLE       19033000
190340             MOVE 46                 TO HOLD-NEW-STMT-CYCLE       19034000
190350             MOVE SC-EARN-CYCLE-CODE TO HOLD-OLD-SC-EARN-CYC      19035000
190360             MOVE 46                 TO HOLD-NEW-SC-EARN-CYC      19036000
190370             IF AUTO-CLOSE                                        19037000
190380                 MOVE ACCOUNT-TYP    TO HOLD-OLD-ACCT-TYPE        19038000
190390                 MOVE ACCOUNT-TYP    TO HOLD-NEW-ACCT-TYPE        19039000
190400                 MOVE '0'            TO HOLD-NEW-ACCT-TYPE (1:1)  19040000
190410             END-IF                                               19041000
190420     END-EVALUATE.                                                19042000
190430                                                                  19043000
190440     MOVE 'N' TO HOLD-EXTRACT-IND.                                19044000
190450     PERFORM P8486-STMT-CYCLE-CODE-CHANGE  THRU P8486-EXIT.       19045000
190460     PERFORM P8487-SC-EARN-CYC-CODE-CHANGE THRU P8487-EXIT.       19046000
190470     PERFORM P8493-ACCT-TYPE-CHANGE        THRU P8493-EXIT.       19047000
190480                                                                  19048000
190490 P7542-SELECT-ALL-XREFS.                                          19049000
190500     IF ODB-PLAN = SPACES                                         19050000
190510         MOVE SPACE TO CYC-46-EXCEPT-PRIM-ODB-IND                 19051000
190520       ELSE                                                       19052000
190530         MOVE 'Y' TO CYC-46-EXCEPT-PRIM-ODB-IND.                  19053000
190540     EXEC SQL                                                     19054000
190550         DECLARE OSBXREF_CURSOR CURSOR FOR                        19055000
190560         SELECT                                                   19056000
190570             DSXRF_BANK_NBR,                                      19057000
190580             DSXRF_ACCT_ID,                                       19058000
190590             DSXRF_ACCT_NBR,                                      19059000
190600             DSXRF_OSB_BANK_NBR,                                  19060000
190610             DSXRF_OSB_FILE_ID,                                   19061000
190620             DSXRF_OSB_FILE_KEY                                   19062000
190630         FROM DSDS.OSBXREF                                        19063000
190640         WHERE DSXRF_BANK_NBR = :DSXRF-BANK-NBR AND               19064000
190650               DSXRF_ACCT_ID  = :DSXRF-ACCT-ID  AND               19065000
190660               DSXRF_ACCT_NBR = :DSXRF-ACCT-NBR                   19066000
190670         ORDER BY DSXRF_OSB_FILE_ID                               19067000
190680     END-EXEC.                                                    19068000
190690                                                                  19069000
190700     EXEC SQL                                                     19070000
190710         OPEN OSBXREF_CURSOR                                      19071000
190720     END-EXEC.                                                    19072000
190730                                                                  19073000
190740     EVALUATE SQLCODE                                             19074000
190750         WHEN ZEROS                                               19075000
190760             CONTINUE                                             19076000
190770         WHEN OTHER                                               19077000
190780             DISPLAY 'OPEN OSBXREF CURSOR DID NOT WORK'           19078000
190790                 UPON CONSOLE                                     19079000
190800             CALL 'CDCUT90' USING SQLCA                           19080000
190810             CALL 'CDCDUMP' USING BY CONTENT '2066'               19081000
190820     END-EVALUATE.                                                19082000
190830                                                                  19083000
190840 P7544-FETCH-OSBXREF.                                             19084000
190850     EXEC SQL                                                     19085000
190860         FETCH OSBXREF_CURSOR INTO                                19086000
190870            :DSXRF-BANK-NBR,                                      19087000
190880            :DSXRF-ACCT-ID,                                       19088000
190890            :DSXRF-ACCT-NBR,                                      19089000
190900            :DSXRF-OSB-BANK-NBR,                                  19090000
190910            :DSXRF-OSB-FILE-ID,                                   19091000
190920            :DSXRF-OSB-FILE-KEY                                   19092000
190930     END-EXEC.                                                    19093000
190940                                                                  19094000
190950     EVALUATE SQLCODE                                             19095000
190960         WHEN ZEROS                                               19096000
190970             CONTINUE                                             19097000
190980         WHEN +100                                                19098000
190990             GO TO P7547-CLOSE-OSBXREF                            19099000
191000         WHEN OTHER                                               19100000
191010             DISPLAY 'FETCH OSBXREF DID NOT WORK'                 19101000
191020                 UPON CONSOLE                                     19102000
191030             CALL 'CDCUT90' USING SQLCA                           19103000
191040             CALL 'CDCDUMP' USING BY CONTENT '2067'               19104000
191050     END-EVALUATE.                                                19105000
191060                                                                  19106000
191070     MOVE DSXRF-OSB-FILE-ID TO CYC-46-EXCEPT-FILE-ID.             19107000
191080     MOVE DSXRF-OSB-FILE-KEY TO CYC-46-EXCEPT-REC-ID.             19108000
191090     MOVE SPACE TO CYC-46-EXCEPT-SEC-ODB-IND.                     19109000
191100     IF DSXRF-OSB-FILE-ID = 'DDA'                                 19110000
191110         NEXT SENTENCE                                            19111000
191120       ELSE                                                       19112000
191130         GO TO P7545-WRITE-RPT-54.                                19113000
191140     MOVE DSXRF-OSB-BANK-NBR TO ACCT-BANK-NBR.                    19114000
191150     MOVE 'ODB' TO ACCT-FILE-ID.                                  19115000
191160     MOVE DSXRF-OSB-FILE-KEY TO ACCT-KEY.                         19116000
191170     EXEC SQL                                                     19117000
191180         SELECT                                                   19118000
191190             ACCT_BANK_NBR,                                       19119000
191200             ACCT_FILE_ID,                                        19120000
191210             ACCT_KEY,                                            19121000
191220             ACCT_ADDRESS_ID,                                     19122000
191230             ACCT_MAIL_CODE,                                      19123000
191240             ACCT_OPEN_DATE,                                      19124000
191250             ACCT_CLOSE_DATE,                                     19125000
191260             ACCT_STATUS,                                         19126000
191270             ACCT_PROG_MAINT_DT,                                  19127000
191280             ACCT_BALANCE,                                        19128000
191290             ACCT_DESC_CODE,                                      19129000
191300             ACCT_NAME_RPL,                                       19130000
191310             ACCT_NAME_EXT_RPL,                                   19131000
191320             ACCT_NAME_ADD1,                                      19132000
191330             ACCT_NAME_ADD2,                                      19133000
191340             ACCT_NAME_ADD3                                       19134000
191350         INTO                                                     19135000
191360            :ACCT-BANK-NBR,                                       19136000
191370            :ACCT-FILE-ID,                                        19137000
191380            :ACCT-KEY,                                            19138000
191390            :ACCT-ADDRESS-ID,                                     19139000
191400            :ACCT-MAIL-CODE,                                      19140000
191410            :ACCT-OPEN-DATE,                                      19141000
191420            :ACCT-CLOSE-DATE,                                     19142000
191430            :ACCT-STATUS,                                         19143000
191440            :ACCT-PROG-MAINT-DT,                                  19144000
191450            :ACCT-BALANCE,                                        19145000
191460            :ACCT-DESC-CODE,                                      19146000
191470            :ACCT-NAME-RPL,                                       19147000
191480            :ACCT-NAME-EXT-RPL,                                   19148000
191490            :ACCT-NAME-ADD1,                                      19149000
191500            :ACCT-NAME-ADD2,                                      19150000
191510            :ACCT-NAME-ADD3                                       19151000
191520         FROM CIF.ACCOUNT                                         19152000
191530         WHERE ACCT_BANK_NBR = :ACCT-BANK-NBR AND                 19153000
191540               ACCT_FILE_ID  = :ACCT-FILE-ID AND                  19154000
191550               ACCT_KEY      = :ACCT-KEY                          19155000
191560     END-EXEC.                                                    19156000
191570     EVALUATE SQLCODE                                             19157000
191580         WHEN ZEROS                                               19158000
191590             MOVE 'Y' TO CYC-46-EXCEPT-SEC-ODB-IND                19159000
191600         WHEN +100                                                19160000
191610             CONTINUE                                             19161000
191620         WHEN OTHER                                               19162000
191630             MOVE '?' TO CYC-46-EXCEPT-SEC-ODB-IND                19163000
191640     END-EVALUATE.                                                19164000
191650                                                                  19165000
191660 P7545-WRITE-RPT-54.                                              19166000
191670     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19167000
191680     MOVE 'Y' TO RPT-54-IND.                                      19168000
191690     GO TO P7544-FETCH-OSBXREF.                                   19169000
191700                                                                  19170000
191710 P7547-CLOSE-OSBXREF.                                             19171000
191720     EXEC SQL                                                     19172000
191730         CLOSE OSBXREF_CURSOR                                     19173000
191740     END-EXEC.                                                    19174000
191750                                                                  19175000
191760     EVALUATE SQLCODE                                             19176000
191770         WHEN ZEROS                                               19177000
191780             GO TO P7549-EXIT                                     19178000
191790         WHEN OTHER                                               19179000
191800             DISPLAY 'CLOSE OSBXREF DID NOT WORK'                 19180000
191810                 UPON CONSOLE                                     19181000
191820             CALL 'CDCUT90' USING SQLCA                           19182000
191830             CALL 'CDCDUMP' USING BY CONTENT '2068'               19183000
191840     END-EVALUATE.                                                19184000
191850                                                                  19185000
191860 P7548-CHECK-RPT-54.                                              19186000
191870     IF PROC-DSS                                                  19187000
191880         GO TO P7549-EXIT.                                        19188000
191890     IF RPT-54-IND = 'Y'                                          19189000
191900         GO TO P7549-EXIT.                                        19190000
191910     MOVE 054 TO SUB1.                                            19191000
191920     MOVE HIGH-VALUES TO CYC-46-EXCEPT-REC-ID.                    19192000
191930     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19193000
191940                                                                  19194000
191950 P7549-EXIT.                                                      19195000
191960     EXIT.                                                        19196000
191970                                                                  19197000
191980******************************************************************19198000
191990*           I M M   E X C E P T I O N S   R E P O R T            *19199000
192000******************************************************************19200000
192010 P7560-IMM-EXCEPTIONS.                                            19201000
192020     MOVE 'N' TO IMM-NTC-SW (TDY-MO).                             19202000
192030     IF BANK-CTL-ACCTS                                            19203000
192040        GO TO P7569-EXIT                                          19204000
192050     END-IF.                                                      19205000
192060     MOVE 056 TO SUB1.                                            19206000
192070     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19207000
192080     IF HOLD-FREQ-RPT = 0                                         19208000
192090         GO TO P7569-EXIT.                                        19209000
192100     IF SAV-ACCOUNT                                               19210000
192110        IF STMT-CYCLE-CODE GREATER THAN 30                        19211000
192120           IF STMT-CYCLE-CODE EQUAL 46                            19212000
192130              NEXT SENTENCE                                       19213000
192140           ELSE                                                   19214000
192150              GO TO P7562-QTRLY-SAV                               19215000
192160           END-IF                                                 19216000
192170        END-IF                                                    19217000
192180     END-IF.                                                      19218000
192190     IF NUM-3RD-PARTY-DEBITS GREATER THAN 6                       19219000
192200         GO TO P7565-BUILD-IMM-EXCEP.                             19220000
192210     ADD NUM-FT-ACH-DEBITS  NUM-3RD-PARTY-DEBITS  NUM-TELE-DEBITS 19221000
192220         GIVING HOLD-IMM-DEBITS.                                  19222000
192230     IF HOLD-IMM-DEBITS GREATER THAN 6                            19223000
192240         GO TO P7565-BUILD-IMM-EXCEP.                             19224000
192250     GO TO P7569-EXIT.                                            19225000
192260                                                                  19226000
192270 P7562-QTRLY-SAV.                                                 19227000
192280     IF IMM-NTC-MM-CTR GREATER THAN 6                             19228000
192290        GO TO P7565-BUILD-IMM-EXCEP.                              19229000
192300     MOVE ZEROS   TO IMM-NTC-MM-CTR.                              19230000
192310     GO TO P7569-EXIT.                                            19231000
192320 P7565-BUILD-IMM-EXCEP.                                           19232000
192330     MOVE 'Y' TO IMM-NTC-SW (TDY-MO).                             19233000
192340     ADD 1    TO IMM-NTC-CTR.                                     19234000
192350     MOVE ZEROES TO CTR-IMM.                                      19235000
192360     PERFORM VARYING SUB-IMM FROM 1 BY 1                          19236000
192370        UNTIL SUB-IMM GREATER THAN 12                             19237000
192380        IF IMM-NTC-SW (SUB-IMM) EQUAL 'Y'                         19238000
192390           ADD 1 TO CTR-IMM                                       19239000
192400        END-IF                                                    19240000
192410     END-PERFORM.                                                 19241000
192420     MOVE CTR-IMM TO IMM-NTC-NBR.                                 19242000
192430     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19243000
192440     MOVE ZEROS   TO IMM-NTC-MM-CTR.                              19244000
192450                                                                  19245000
192460 P7569-EXIT.                                                      19246000
192470     EXIT.                                                        19247000
192480                                                                  19248000
192490******************************************************************19249000
192500*     I N V E S T M E N T   E X C E P T I O N   R E P O R T      *19250000
192510******************************************************************19251000
192520 P7570-INV-EXCEPTIONS.                                            19252000
192530     MOVE 057 TO SUB1.                                            19253000
192540     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19254000
192550     IF HOLD-FREQ-RPT = 0                                         19255000
192560         GO TO P7579-EXIT.                                        19256000
192570     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19257000
192580                                                                  19258000
192590 P7579-EXIT.                                                      19259000
192600     EXIT.                                                        19260000
192610                                                                  19261000
192620******************************************************************19262000
192630*        $ 1 0 0 , 0 0 0   A N D   O V E R   R E P O R T         *19263000
192640******************************************************************19264000
192650 P7580-100K-AND-OVER.                                             19265000
192660     MOVE 058 TO SUB1.                                            19266000
192670     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19267000
192680     IF HOLD-FREQ-RPT = 0                                         19268000
192690         GO TO P7589-EXIT.                                        19269000
192700     IF CURRENT-BALANCE LESS THAN +100000.00                      19270000
192710         GO TO P7589-EXIT.                                        19271000
192720     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19272000
192730                                                                  19273000
192740 P7589-EXIT.                                                      19274000
192750     EXIT.                                                        19275000
192760                                                                  19276000
192770******************************************************************19277000
192780*SUBROUTINE - M O N T H L Y   P R I O R I T Y   L I N E   REPORT *19278000
192790******************************************************************19279000
192800 P7600-ODB-MONTHLY-PL-RPT.                                        19280000
192810     IF PRIORITY-LINE                                             19281000
192820         NEXT SENTENCE                                            19282000
192830       ELSE                                                       19283000
192840         GO TO P7609-EXIT.                                        19284000
192850     IF ODB-CLOSED-DELETE                                         19285000
192860         GO TO P7609-EXIT.                                        19286000
192870     MOVE 060 TO SUB1.                                            19287000
192880     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19288000
192890     IF HOLD-FREQ-RPT = 0                                         19289000
192900         GO TO P7609-EXIT.                                        19290000
192910     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19291000
192920                                                                  19292000
192930 P7609-EXIT.                                                      19293000
192940     EXIT.                                                        19294000
192950                                                                  19295000
192960******************************************************************19296000
192970* SUBROUTINE - A C C O U N T  H I S T O R Y  R E P O R T         *19297000
192980******************************************************************19298000
192990 P7610-BUILD-ACCT-HIST.                                           19299000
193000     MOVE 061 TO SUB1.                                            19300000
193010     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19301000
193020     IF HOLD-FREQ-RPT = 0                                         19302000
193030         GO TO P7619-EXIT.                                        19303000
193040     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   19304000
193050     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19305000
193060                                                                  19306000
193070 P7619-EXIT.                                                      19307000
193080     EXIT.                                                        19308000
193090                                                                  19309000
193100******************************************************************19310000
193110*SUBROUTINE - D E B I T   L I S T  I N  A M O U N T  O R D E R   *19311000
193120******************************************************************19312000
193130 P7620-DEBIT-LIST-IN-AMT-SEQ.                                     19313000
193140     MOVE 062 TO SUB1.                                            19314000
193150     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19315000
193160     IF HOLD-FREQ-RPT = 0                                         19316000
193170         GO TO P7629-EXIT.                                        19317000
193180     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19318000
193190                                                                  19319000
193200 P7629-EXIT.                                                      19320000
193210     EXIT.                                                        19321000
193220                                                                  19322000
193230******************************************************************19323000
193240* SUBROUTINE - Z E R O   B A L A N C E   A C C O U N T   L I S T *19324000
193250******************************************************************19325000
193260 P7630-ZERO-BALANCE-LIST.                                         19326000
193270     IF CLOSED                                                    19327000
193280         GO TO P7639-EXIT.                                        19328000
193290     IF CURRENT-BALANCE = ZERO                                    19329000
193300         NEXT SENTENCE                                            19330000
193310       ELSE                                                       19331000
193320         GO TO P7639-EXIT.                                        19332000
193330     IF DTE-LAST-CYCLE-STMT = ZEROES                              19333000
193340        GO TO P7639-EXIT                                          19334000
193350     END-IF.                                                      19335000
193360                                                                  19336000
193370     IF AUTO-CLOSE                                                19337000
193380        GO TO P7639-EXIT                                          19338000
193390     END-IF.                                                      19339000
193400                                                                  19340000
193410     IF STMT-CYCLE-CODE = +046                                    19341000
193420        GO TO P7639-EXIT                                          19342000
193430     END-IF.                                                      19343000
193440                                                                  19344000
193450     IF ML-HELOC-NBR GREATER THAN ZEROS                           19345000
193460        GO TO P7639-EXIT                                          19346000
193470     END-IF.                                                      19347000
193480                                                                  19348000
193490     IF HSA-ACCT OR CESA-ACCT                                     19349000
193500        GO TO P7639-EXIT                                          19350000
193510     END-IF.                                                      19351000
193520                                                                  19352000
193530     IF ODB-PLAN = SPACES                                         19353000
193540        GO TO P7632-CONT                                          19354000
193550     END-IF.                                                      19355000
193560                                                                  19356000
193570     IF ODB-NORMAL                                                19357000
193580        NEXT SENTENCE                                             19358000
193590     ELSE                                                         19359000
193600        GO TO P7632-CONT                                          19360000
193610     END-IF.                                                      19361000
193620                                                                  19362000
193630     IF ODB-LOAN-BAL GREATER THAN ZEROES                          19363000
193640        GO TO P7639-EXIT                                          19364000
193650     END-IF.                                                      19365000
193660                                                                  19366000
193670     IF ODB-MATURITY-DATE = ZEROES                                19367000
193680        GO TO P7632-CONT                                          19368000
193690     END-IF.                                                      19369000
193700                                                                  19370000
193710     IF AUTH-CREDIT-LIMIT GREATER THAN ZEROES                     19371000
193720        GO TO P7639-EXIT                                          19372000
193730     END-IF.                                                      19373000
193740                                                                  19374000
193750 P7632-CONT.                                                      19375000
193760     IF DATE-LAST-CUST-ACT = ZEROS                                19376000
193770         GO TO P7635-CONT.                                        19377000
193780     CALL 'CDCDT12' USING DATE-LAST-CUST-ACT                      19378000
193790                          PROC-CURR-DATE                          19379000
193800                          MONTHS-12.                              19380000
193810     IF MONTHS-12 LESS THAN 12                                    19381000
193820         GO TO P7639-EXIT.                                        19382000
193830                                                                  19383000
193840 P7635-CONT.                                                      19384000
193850     MOVE 063 TO SUB1.                                            19385000
193860     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19386000
193870     IF HOLD-FREQ-RPT = 0                                         19387000
193880         GO TO P7639-EXIT.                                        19388000
193890     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19389000
193900                                                                  19390000
193910 P7639-EXIT.                                                      19391000
193920     EXIT.                                                        19392000
193930                                                                  19393000
193940******************************************************************19394000
193950* SUBROUTINE - M O N T H L Y   O V E R D R A F T   R E P O R T   *19395000
193960******************************************************************19396000
193970 P7650-MONTHLY-OVERDRAFTS.                                        19397000
193980     MOVE 065 TO SUB1.                                            19398000
193990     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19399000
194000     IF HOLD-FREQ-RPT = 0                                         19400000
194010         GO TO P7659-EXIT.                                        19401000
194020     IF HOLD-LOW-BAL-MTH GREATER THAN SELECT-BAL-RPT-65           19402000
194030         GO TO P7659-EXIT.                                        19403000
194040     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19404000
194050                                                                  19405000
194060 P7659-EXIT.                                                      19406000
194070     EXIT.                                                        19407000
194080                                                                  19408000
194090******************************************************************19409000
194100* SUBROUTINE - G R O W T H   S A V I N G S   E X C E P T I O N S *19410000
194110******************************************************************19411000
194120 P7660-GROWTH-SAV-EXCPTS.                                         19412000
194130     IF CLOSED                                                    19413000
194140         GO TO P7669-EXIT.                                        19414000
194150     IF BCFSCR-GROWTH-SAVINGS                                     19415000
194160         NEXT SENTENCE                                            19416000
194170       ELSE                                                       19417000
194180         GO TO P7669-EXIT.                                        19418000
194190     MOVE 066 TO SUB1.                                            19419000
194200     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19420000
194210     IF HOLD-FREQ-RPT = 0                                         19421000
194220         GO TO P7669-EXIT.                                        19422000
194230     MOVE SPACE          TO U021-RETURN-CODE.                     19423000
194240     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    19424000
194250     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   19425000
194260     MOVE CIF-XREF-KEY   TO U021-FILE-KEY.                        19426000
194270     MOVE 'Y'            TO U021-DEMOGRAPHICS-IND.                19427000
194280     CALL 'CIFU021'   USING CIFU021-PARAMETERS.                   19428000
194290     IF U021-GOOD-RETURN                                          19429000
194300         NEXT SENTENCE                                            19430000
194310       ELSE                                                       19431000
194320         GO TO P7669-EXIT.                                        19432000
194330     IF U021-CUST-TYPE = 'N'                                      19433000
194340         GO TO P7669-EXIT.                                        19434000
194350     IF U021-CUSTI-BIRTH-DATE = '0001-01-01'                      19435000
194360         MOVE ZEROS TO HOLD-GE-DT-OF-BIRTH                        19436000
194370         MOVE '02' TO HOLD-GE-REASON                              19437000
194380         GO TO P7665-CONT-GSE.                                    19438000
194390     CALL 'CDCDT46' USING U021-CUSTI-BIRTH-DATE                   19439000
194400                          MJDATE-46.                              19440000
194410                                                                  19441000
194420     SUBTRACT MJDATE-46 FROM PROC-THRU-DATE GIVING MJDATE-DIFF.   19442000
194430                                                                  19443000
194440****                                                              19444000
194450**** NEED TO CHECK THE DOB YEAR FOR LEAP YEAR                     19445000
194460****                                                              19446000
194470     CALL 'CDCDT30' USING MJDATE-46                               19447000
194480                          HOLD-DAYS-IN-MMM                        19448000
194490                          HOLD-DAYS-IN-YYY.                       19449000
194500                                                                  19450000
194510     IF HOLD-DAYS-IN-YYY EQUAL 366                                19451000
194520        IF MJDATE-46-DDD GREATER THAN 059                         19452000
194530           ADD 1 TO MJDATE-DIFF                                   19453000
194540        END-IF                                                    19454000
194550     END-IF.                                                      19455000
194560                                                                  19456000
194570     IF MJDATE-DIFF LESS THAN SELECT-CRIT-RPT-66                  19457000
194580         GO TO P7669-EXIT.                                        19458000
194590     MOVE MJDATE-46 TO HOLD-GE-DT-OF-BIRTH.                       19459000
194600     MOVE '01' TO HOLD-GE-REASON.                                 19460000
194610                                                                  19461000
194620 P7665-CONT-GSE.                                                  19462000
194630     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19463000
194640                                                                  19464000
194650 P7669-EXIT.                                                      19465000
194660     EXIT.                                                        19466000
194670                                                                  19467000
194680******************************************************************19468000
194690*SUBROUTINE - M O N T H L Y   C R E D I T   L I F E   R E P O R T*19469000
194700******************************************************************19470000
194710 P7670-ODB-CR-LIFE-RPT.                                           19471000
194720     IF CR-LIFE-PAID-MTD = ZEROS                                  19472000
194730         GO TO P7679-EXIT.                                        19473000
194740     MOVE 067 TO SUB1.                                            19474000
194750     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19475000
194760     IF HOLD-FREQ-RPT = 0                                         19476000
194770         GO TO P7679-EXIT.                                        19477000
194780     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19478000
194790                                                                  19479000
194800 P7679-EXIT.                                                      19480000
194810     EXIT.                                                        19481000
194820                                                                  19482000
194830******************************************************************19483000
194840*SUBROUTINE - D E P O S I T  L I S T  I N  A M O U N T  O R D E R*19484000
194850******************************************************************19485000
194860 P7680-DEPOSIT-LIST-IN-AMT-SEQ.                                   19486000
194870     MOVE 068 TO SUB1.                                            19487000
194880     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19488000
194890     IF HOLD-FREQ-RPT = 0                                         19489000
194900         GO TO P7689-EXIT.                                        19490000
194910     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19491000
194920                                                                  19492000
194930 P7689-EXIT.                                                      19493000
194940     EXIT.                                                        19494000
194950                                                                  19495000
194960******************************************************************19496000
194970* SUBROUTINE - O.D.B.  Y-T-D  I N T E R E S T  R E P O R T       *19497000
194980******************************************************************19498000
194990 P7710-BUILD-ODB-INT-YTD.                                         19499000
195000     MOVE 071 TO SUB1.                                            19500000
195010     IF PROC-YEAR-END                                             19501000
195020         GO TO P7715-NO-BYPASS-OY.                                19502000
195030     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19503000
195040     IF HOLD-FREQ-RPT = 0                                         19504000
195050         GO TO P7719-EXIT.                                        19505000
195060                                                                  19506000
195070 P7715-NO-BYPASS-OY.                                              19507000
195080     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19508000
195090                                                                  19509000
195100 P7719-EXIT.                                                      19510000
195110     EXIT.                                                        19511000
195120                                                                  19512000
195130******************************************************************19513000
195140*A C C T   R E C O N C I L I A T I O N   A C C O U N T   L I S T *19514000
195150******************************************************************19515000
195160 P7720-AR-ACCOUNT-LIST.                                           19516000
195170     IF NO-ACCT-RECON                                             19517000
195180         GO TO P7729-EXIT.                                        19518000
195190     MOVE 072 TO SUB1.                                            19519000
195200     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19520000
195210     IF HOLD-FREQ-RPT = 0                                         19521000
195220         GO TO P7729-EXIT.                                        19522000
195230     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19523000
195240                                                                  19524000
195250 P7729-EXIT.                                                      19525000
195260     EXIT.                                                        19526000
195270                                                                  19527000
195280******************************************************************19528000
195290* C A S H   M A N A G E M E N T   E X C E P T I O N S   R P T    *19529000
195300******************************************************************19530000
195310 P7840-CM-EXCEPTIONS.                                             19531000
195320     MOVE 084 TO SUB1.                                            19532000
195330     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19533000
195340     IF HOLD-FREQ-RPT = 0                                         19534000
195350         GO TO P7849-EXIT.                                        19535000
195360     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19536000
195370                                                                  19537000
195380 P7849-EXIT.                                                      19538000
195390     EXIT.                                                        19539000
195400                                                                  19540000
195410******************************************************************19541000
195420* SUBROUTINE - E S C H E A T   R E P O R T                       *19542000
195430******************************************************************19543000
195440 P7960-BUILD-ESCHEAT.                                             19544000
195450     MOVE 096 TO SUB1.                                            19545000
195460     PERFORM P8020-CALL-DSDM101 THRU P8029-EXIT.                  19546000
195470 P7969-EXIT.                                                      19547000
195480     EXIT.                                                        19548000
195490                                                                  19549000
195500                                                                  19550000
195510******************************************************************19551000
195520* SUBROUTINE - B U I L D  S T O C K P A P E R  S O R T  K E Y    *19552000
195530******************************************************************19553000
195540 P8000-BUILD-SORT-KEY.                                            19554000
195550     MOVE SPACES TO HOLD-SORT-KEY.                                19555000
195560     IF NUMERIC-RPT-WK                                            19556000
195570         NEXT SENTENCE                                            19557000
195580       ELSE                                                       19558000
195590         GO TO P8005-ALPHA-SORT-KEY.                              19559000
195600     IF SEL-NONE-WK                                               19560000
195610         MOVE ACCOUNT-ID TO SK-ACCOUNT-ID                         19561000
195620         MOVE ACCOUNT-NUMBER TO SK-ACCOUNT-NO                     19562000
195630         GO TO P8009-EXIT.                                        19563000
195640     MOVE ACCOUNT-ID TO SKB-ACCOUNT-ID.                           19564000
195650     MOVE ACCOUNT-NUMBER TO SKB-ACCOUNT-NO.                       19565000
195660     IF SEL-ACCT-ID-WK                                            19566000
195670         MOVE SPACES TO SKB-XXX                                   19567000
195680         GO TO P8009-EXIT.                                        19568000
195690     IF SEL-OFFICER-WK                                            19569000
195700         MOVE PRIMARY-OFFICER TO SKB-XXX                          19570000
195710         GO TO P8009-EXIT.                                        19571000
195720     IF SEL-TYPE-WK                                               19572000
195730         MOVE SPACES TO SKB-XXX                                   19573000
195740         MOVE ACCT-TYPE-CODE TO SKB-XX.                           19574000
195750     GO TO P8009-EXIT.                                            19575000
195760                                                                  19576000
195770 P8005-ALPHA-SORT-KEY.                                            19577000
195780     IF SEL-NONE-WK                                               19578000
195790         MOVE SHORT-NAME TO SKA-SHORT-NAME                        19579000
195800         MOVE ACCOUNT-ID TO SKA-ACCOUNT-ID                        19580000
195810         MOVE ACCOUNT-NUMBER TO SKA-ACCOUNT-NO                    19581000
195820         GO TO P8009-EXIT.                                        19582000
195830     MOVE SHORT-NAME TO SKB-SHORT-NAME.                           19583000
195840     IF SEL-ACCT-ID-WK                                            19584000
195850         MOVE ACCOUNT-ID TO SK-ACCOUNT-ID                         19585000
195860         GO TO P8009-EXIT.                                        19586000
195870     IF SEL-OFFICER-WK                                            19587000
195880         MOVE PRIMARY-OFFICER TO SKB-XXX                          19588000
195890         GO TO P8009-EXIT.                                        19589000
195900     IF SEL-TYPE-WK                                               19590000
195910         MOVE SPACES TO SKB-XXX                                   19591000
195920         MOVE ACCT-TYPE-CODE TO SKB-XX.                           19592000
195930                                                                  19593000
195940 P8009-EXIT.                                                      19594000
195950     EXIT.                                                        19595000
195960                                                                  19596000
195970******************************************************************19597000
195980* SUBROUTINE - C O M M O N  S T O C K P A P E R  F I E L D S     *19598000
195990******************************************************************19599000
196000 P8010-STOCK-RPT-COMMON.                                          19600000
196010     MOVE SPACES TO STOCK-WORK.                                   19601000
196020                                                                  19602000
196030 P8015-STOCK-RPT-COMMON2.                                         19603000
196040     MOVE RDS-PARM-TAB (SUB1) TO RPT-PARM-TABLE-WK.               19604000
196050     MOVE SUB1 TO RP-REPORT-CODE.                                 19605000
196060     MOVE BCF-BANK-NO TO RP-BANK-NO.                              19606000
196070     PERFORM P8000-BUILD-SORT-KEY THRU P8009-EXIT.                19607000
196080     MOVE HOLD-SORT-KEY TO RP-SORT-KEY.                           19608000
196090     MOVE ACCOUNT-ID TO RP-ACCT-ID.                               19609000
196100     MOVE ACCOUNT-NUMBER TO RP-ACCT-NO.                           19610000
196110     MOVE LOW-VALUES TO RP-CRF-REC-ID.                            19611000
196120     MOVE SHORT-NAME TO RP-SHORT-NM.                              19612000
196130                                                                  19613000
196140 P8019-EXIT.                                                      19614000
196150     EXIT.                                                        19615000
196160                                                                  19616000
196170******************************************************************19617000
196180*B U I L D   S T O C K   P A P E R   R E P O R T   R E C O R D S *19618000
196190******************************************************************19619000
196200 P8020-CALL-DSDM101.                                              19620000
196210     MOVE RDS-PARM-TAB (SUB1) TO RPT-PARM-TABLE-WK.               19621000
196220     CALL 'DSDM101' USING DSDS-BCF-RECORD                         19622000
196230                          DSDS-MASTER-RECORD                      19623000
196240                          DSDS-HISTORY-RECORD                     19624000
196250                          DSDS-TRANSACTION-LONG                   19625000
196260                          POSTED-WORK                             19626000
196270                          REPORT-TABLE-WORK                       19627000
196280                          EARNINGS-ROUTINE-WORK-AREA              19628000
196290                          SC-ROUTINE-WORK-FIELDS                  19629000
196300                          STOCK-PAPER-WORK-FIELDS.                19630000
196310                                                                  19631000
196320 P8029-EXIT.                                                      19632000
196330     EXIT.                                                        19633000
196340                                                                  19634000
196350******************************************************************19635000
196360* SUBROUTINE - W R I T E   S P E C I A L   F O R M S             *19636000
196370******************************************************************19637000
196380 P8030-WRITE-SPECIAL-FORMS.                                       19638000
196390     WRITE SPECIAL-FORM FROM SPECIAL-WORK.                        19639000
196400                                                                  19640000
196410 P8039-EXIT.                                                      19641000
196420     EXIT.                                                        19642000
196430                                                                  19643000
196440******************************************************************19644000
196450* SUBROUTINE - G E T  RELATIONSHIP BANKING BALANCES              *19645000
196460******************************************************************19646000
196470 P8050-GET-RBB.                                                   19647000
196480     MOVE 'R' TO RBB-ACTION-CODE.                                 19648000
196490     MOVE BCF-BANK-NO TO RBB-BANK-NO.                             19649000
196500     MOVE ACCOUNT-ID TO RBB-ACCT-ID.                              19650000
196510     MOVE ACCOUNT-NUMBER TO RBB-ACCT-NO.                          19651000
196520     CALL 'DSDM065' USING RBB-ACTION-CODE                         19652000
196530                          RBB-ACTION-DATE                         19653000
196540                          RELATIONSHIP-BANKING-BALANCES           19654000
196550                          RBB-RETURN-CODE.                        19655000
196560     IF RBB-RETURN-CODE = SPACE                                   19656000
196570         GO TO P8059-EXIT.                                        19657000
196580     DISPLAY 'BAD RETURN FROM RBB' UPON CONSOLE.                  19658000
196590     DISPLAY 'RETURN = ' RBB-RETURN-CODE UPON CONSOLE.            19659000
196600     CALL 'CDCDUMP' USING BY CONTENT '2069'.                      19660000
196610                                                                  19661000
196620 P8059-EXIT.                                                      19662000
196630     EXIT.                                                        19663000
196640                                                                  19664000
196650 P8060-GET-MASTER-PAC.                                            19665000
196660     MOVE PROC-BK-NO        TO PACA-BANK-NBR.                     19666000
196670     MOVE ACCOUNT-ID        TO PACA-ACCT-ID.                      19667000
196680     MOVE ACCOUNT-NUMBER    TO PACA-ACCT-NBR.                     19668000
196690     EXEC SQL                                                     19669000
196700         SELECT                                                   19670000
196710             PACA_BANK_NBR,                                       19671000
196720             PACA_ACCT_ID,                                        19672000
196730             PACA_ACCT_NBR,                                       19673000
196740             PACA_INT_RATE                                        19674000
196750         INTO                                                     19675000
196760            :PACA-BANK-NBR,                                       19676000
196770            :PACA-ACCT-ID,                                        19677000
196780            :PACA-ACCT-NBR,                                       19678000
196790            :PACA-INT-RATE                                        19679000
196800         FROM DSDS.PACACTIVITY                                    19680000
196810         WHERE PACA_BANK_NBR = :PACA-BANK-NBR                     19681000
196820           AND PACA_ACCT_ID  = :PACA-ACCT-ID                      19682000
196830           AND PACA_ACCT_NBR = :PACA-ACCT-NBR                     19683000
196840     END-EXEC.                                                    19684000
196850     EVALUATE SQLCODE                                             19685000
196860         WHEN ZEROS                                               19686000
196870         WHEN -811                                                19687000
196880             MOVE PACA-INT-RATE TO INTEREST-RATE                  19688000
196890         WHEN OTHER                                               19689000
196900             CALL 'CDCUT90' USING SQLCA                           19690000
196910             CALL 'CDCDUMP' USING BY CONTENT '2070'               19691000
196920     END-EVALUATE.                                                19692000
196930 P8069-EXIT.                                                      19693000
196940     EXIT.                                                        19694000
196950                                                                  19695000
196960 P8070-GET-PAC.                                                   19696000
196970     MOVE PROC-BK-NO        TO PACA-PAC-BANK-NBR.                 19697000
196980     MOVE ACCOUNT-NUMBER    TO PACA-PAC-ACCT-NBR.                 19698000
196990     EXEC SQL                                                     19699000
197000         SELECT                                                   19700000
197010             PACA_PAC_BANK_NBR,                                   19701000
197020             PACA_PAC_ACCT_NBR,                                   19702000
197030             PACA_PAC_INT_RATE                                    19703000
197040         INTO                                                     19704000
197050            :PACA-PAC-BANK-NBR,                                   19705000
197060            :PACA-PAC-ACCT-NBR,                                   19706000
197070            :PACA-PAC-INT-RATE                                    19707000
197080         FROM DSDS.PACACTIVITY                                    19708000
197090         WHERE PACA_PAC_BANK_NBR = :PACA-PAC-BANK-NBR             19709000
197100           AND PACA_PAC_ACCT_NBR = :PACA-PAC-ACCT-NBR             19710000
197110     END-EXEC.                                                    19711000
197120     EVALUATE SQLCODE                                             19712000
197130         WHEN ZEROS                                               19713000
197140             MOVE PACA-PAC-INT-RATE TO INTEREST-RATE              19714000
197150         WHEN +100                                                19715000
197160             DISPLAY 'CDCINFO-DSDS100 PACACTIVITY NOT FOUND'      19716000
197170             DISPLAY 'CDCINFO-DSDS100 PACA-PAC-BANK-NBR = '       19717000
197180                                      PACA-PAC-BANK-NBR           19718000
197190             DISPLAY 'CDCINFO-DSDS100 PACA-PAC-ACCT-NBR = '       19719000
197200                                      PACA-PAC-ACCT-NBR           19720000
197210             MOVE ZEROES            TO INTEREST-RATE              19721000
197220         WHEN OTHER                                               19722000
197230             CALL 'CDCUT90' USING SQLCA                           19723000
197240             CALL 'CDCDUMP' USING BY CONTENT '2071'               19724000
197250     END-EVALUATE.                                                19725000
197260 P8079-EXIT.                                                      19726000
197270     EXIT.                                                        19727000
197280                                                                  19728000
197290******************************************************************19729000
197300* LOOKUP - E X T E R N A L  S.C.  IN  B A N K  C O N T R O L     *19730000
197310******************************************************************19731000
197320 P8080-CHK-EXT-SC-GEN.                                            19732000
197330     MOVE ZEROS TO SUB7.                                          19733000
197340                                                                  19734000
197350 P8085-PAGE-EXT-FEES.                                             19735000
197360     ADD 1 TO SUB7.                                               19736000
197370     IF SUB7 = 21                                                 19737000
197380         MOVE ZEROS TO SUB7                                       19738000
197390         GO TO P8089-EXIT.                                        19739000
197400     IF EXT-SC-TX-CODE (SUB7) NOT NUMERIC                         19740000
197410         GO TO P8085-PAGE-EXT-FEES.                               19741000
197420     IF DSDSTXL-CODE = EXT-SC-TX-CODE (SUB7)                      19742000
197430         GO TO P8089-EXIT.                                        19743000
197440     GO TO P8085-PAGE-EXT-FEES.                                   19744000
197450                                                                  19745000
197460 P8089-EXIT.                                                      19746000
197470     EXIT.                                                        19747000
197480                                                                  19748000
197490******************************************************************19749000
197500* LOOKUP - S H O U L D  A  R E P O R T  B E  P R I N T E D       *19750000
197510******************************************************************19751000
197520 P8100-CHECK-FREQUENCY.                                           19752000
197530     MOVE 0 TO HOLD-FREQ-RPT.                                     19753000
197540     MOVE RDS-PARM-TAB (SUB1) TO RPT-PARM-TABLE-WK.               19754000
197550     IF DONT-PROCESS-RPT-WK                                       19755000
197560         GO TO P8109-EXIT.                                        19756000
197570     IF PROCESS-WITH-SELECT-WK                                    19757000
197580         GO TO P8102-CHK-CRITERIA.                                19758000
197590     MOVE 1 TO HOLD-FREQ-RPT.                                     19759000
197600     GO TO P8104-CHK-HISTORY-NEEDED.                              19760000
197610                                                                  19761000
197620 P8102-CHK-CRITERIA.                                              19762000
197630     MOVE SELECT-CRITERIA-WK TO HOLD-SELECT-CRITERIA.             19763000
197640     IF SEL-BALANCE-WK                                            19764000
197650         MOVE 1 TO HOLD-FREQ-RPT                                  19765000
197660         GO TO P8104-CHK-HISTORY-NEEDED.                          19766000
197670     IF SEL-OFFICER-WK                                            19767000
197680         IF PRIMARY-OFFICER = HOLD-SELECT-CRITERIA                19768000
197690             MOVE 1 TO HOLD-FREQ-RPT                              19769000
197700             GO TO P8104-CHK-HISTORY-NEEDED                       19770000
197710           ELSE                                                   19771000
197720             IF SUB1 = 49                                         19772000
197730                 MOVE 1 TO HOLD-FREQ-RPT                          19773000
197740                 GO TO P8104-CHK-HISTORY-NEEDED.                  19774000
197750     IF SEL-TYPE-WK                                               19775000
197760         IF ACCT-TYPE-CODE = TYPE-CRITERIA                        19776000
197770             MOVE 1 TO HOLD-FREQ-RPT                              19777000
197780             GO TO P8104-CHK-HISTORY-NEEDED.                      19778000
197790     IF SEL-ACCT-ID-WK                                            19779000
197800         IF ACCOUNT-ID = ID-CRITERIA                              19780000
197810             MOVE 1 TO HOLD-FREQ-RPT                              19781000
197820             GO TO P8104-CHK-HISTORY-NEEDED.                      19782000
197830     IF SEL-SERV-CHG-WK                                           19783000
197840         MOVE 1 TO HOLD-FREQ-RPT                                  19784000
197850         GO TO P8104-CHK-HISTORY-NEEDED.                          19785000
197860     IF SEL-SC-RTN-WK                                             19786000
197870         IF SC-ROUTINE = TYPE-CRITERIA                            19787000
197880             MOVE 1 TO HOLD-FREQ-RPT                              19788000
197890             GO TO P8104-CHK-HISTORY-NEEDED.                      19789000
197900     GO TO P8109-EXIT.                                            19790000
197910                                                                  19791000
197920 P8104-CHK-HISTORY-NEEDED.                                        19792000
197930     IF SUB1 = 051 OR 052                                         19793000
197940         NEXT SENTENCE                                            19794000
197950       ELSE                                                       19795000
197960         GO TO P8109-EXIT.                                        19796000
197970     IF SEL-SERV-CHG-WK                                           19797000
197980         NEXT SENTENCE                                            19798000
197990       ELSE                                                       19799000
198000         MOVE 0 TO HOLD-FREQ-RPT                                  19800000
198010         GO TO P8109-EXIT.                                        19801000
198020     PERFORM P8106-GET-HISTORY THRU P8108-EXIT.                   19802000
198030     IF PROC-MONTH-END                                            19803000
198040         IF HIST-NOT-AVAILABLE (1)                                19804000
198050             MOVE 0 TO HOLD-FREQ-RPT                              19805000
198060             GO TO P8109-EXIT                                     19806000
198070           ELSE                                                   19807000
198080             GO TO P8105-CHK-SUB1.                                19808000
198090     IF HIST-NOT-AVAILABLE (2)                                    19809000
198100         MOVE 0 TO HOLD-FREQ-RPT                                  19810000
198110         GO TO P8109-EXIT.                                        19811000
198120                                                                  19812000
198130 P8105-CHK-SUB1.                                                  19813000
198140     IF SUB1 = 051                                                19814000
198150         PERFORM P8110-CHK-RPT-051 THRU P8119-EXIT                19815000
198160       ELSE                                                       19816000
198170         PERFORM P8120-CHK-RPT-052 THRU P8129-EXIT.               19817000
198180     GO TO P8109-EXIT.                                            19818000
198190                                                                  19819000
198200 P8106-GET-HISTORY.                                               19820000
198210     IF GOT-HISTORY = 1                                           19821000
198220         GO TO P8108-EXIT.                                        19822000
198230     IF MSTR-ID-HV = HIGH-VALUES                                  19823000
198240         GO TO P8108-EXIT.                                        19824000
198250     MOVE DSDS-M-RECORD-KEY TO DSDS-H-RECORD-KEY.                 19825000
198260     READ DSDS-HIST.                                              19826000
198270     IF VSAM-SUCCESSFUL                                           19827000
198280         NEXT SENTENCE                                            19828000
198290       ELSE                                                       19829000
198300         DISPLAY 'CDCERROR-HISTORY READ ERROR' UPON CONSOLE       19830000
198310         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  19831000
198320         DISPLAY 'BANK NO. ' BCF-BANK-NO                          19832000
198330             ' ACCT. I.D. ' ACCOUNT-ID                            19833000
198340             ' ACCT. NO. ' ACCOUNT-NUMBER UPON CONSOLE            19834000
198350         CALL 'CDCDUMP' USING BY CONTENT '2072'.                  19835000
198360     MOVE DSDS-H-FILE-RECORD TO DSDS-HISTORY-RECORD.              19836000
198370     ADD 1 TO SEARCH-HIST.                                        19837000
198380     MOVE 1 TO GOT-HISTORY.                                       19838000
198390                                                                  19839000
198400 P8107-INIT-HISTORY.                                              19840000
198410** INITIALIZE NEW HISTORY FILE FIELDS HERE                        19841000
198420     CONTINUE.                                                    19842000
198430** END INITIALIZATION                                             19843000
198440                                                                  19844000
198450 P8108-EXIT.                                                      19845000
198460     EXIT.                                                        19846000
198470                                                                  19847000
198480 P8109-EXIT.                                                      19848000
198490     EXIT.                                                        19849000
198500                                                                  19850000
198510******************************************************************19851000
198520* SUMMARY OF ACCT. BALANCES - PRELIMINARY CHECK FOR RPT. 51 & 52 *19852000
198530******************************************************************19853000
198540 P8110-CHK-RPT-051.                                               19854000
198550     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                19855000
198560     MULTIPLY -1 BY ID-CRITERIA GIVING SC-CRITERIA.               19856000
198570     IF HOLD-CS-SC-AMT GREATER THAN SC-CRITERIA                   19857000
198580         MOVE 0 TO HOLD-FREQ-RPT.                                 19858000
198590                                                                  19859000
198600 P8119-EXIT.                                                      19860000
198610     EXIT.                                                        19861000
198620                                                                  19862000
198630 P8120-CHK-RPT-052.                                               19863000
198640     PERFORM P8130-CALC-CS-SC-AMT THRU P8139-EXIT.                19864000
198650     MOVE ID-CRITERIA TO SC-CRITERIA.                             19865000
198660     IF HOLD-CS-SC-AMT LESS THAN SC-CRITERIA                      19866000
198670         MOVE 0 TO HOLD-FREQ-RPT.                                 19867000
198680                                                                  19868000
198690 P8129-EXIT.                                                      19869000
198700     EXIT.                                                        19870000
198710                                                                  19871000
198720 P8130-CALC-CS-SC-AMT.                                            19872000
198730     MOVE ZEROS TO HOLD-INT-PD-LST-CYC                            19873000
198740                   HOLD-SERV-CHG-AMT.                             19874000
198750     MOVE INT-PAID-LAST-CYCLE TO HOLD-INT-PD-LST-CYC.             19875000
198760     IF PROC-MONTH-END                                            19876000
198770         NEXT SENTENCE                                            19877000
198780       ELSE                                                       19878000
198790         GO TO P8132-CHECK-PREV-MO.                               19879000
198800     IF SERV-CHG-DISP (1) = 'C' OR 'A'                            19880000
198810         IF SERV-CHG-AMT (1) NEGATIVE                             19881000
198820             MULTIPLY SERV-CHG-AMT (1) BY -1                      19882000
198830                 GIVING HOLD-SERV-CHG-AMT                         19883000
198840           ELSE                                                   19884000
198850             MOVE SERV-CHG-AMT (1) TO HOLD-SERV-CHG-AMT.          19885000
198860     MOVE NUM-SC-DEBITS (1)    TO HOLD-SA-NO-DEBITS.              19886000
198870     MOVE NUM-SC-CREDITS (1)   TO HOLD-SA-NO-CREDITS.             19887000
198880     MOVE NUM-SC-ITEMS (1)     TO HOLD-SA-NO-DEP-ITEMS.           19888000
198890     MOVE AVG-COLL-BAL-CYC (1) TO HOLD-SA-S-C-CALC-AMT.           19889000
198900     GO TO P8138-CALC.                                            19890000
198910                                                                  19891000
198920 P8132-CHECK-PREV-MO.                                             19892000
198930     IF SERV-CHG-DISP (2) = 'C' OR 'A'                            19893000
198940         IF SERV-CHG-AMT (2) NEGATIVE                             19894000
198950             MULTIPLY SERV-CHG-AMT (2) BY -1                      19895000
198960                 GIVING HOLD-SERV-CHG-AMT                         19896000
198970           ELSE                                                   19897000
198980             MOVE SERV-CHG-AMT (2) TO HOLD-SERV-CHG-AMT.          19898000
198990     MOVE NUM-SC-DEBITS (2)    TO HOLD-SA-NO-DEBITS.              19899000
199000     MOVE NUM-SC-CREDITS (2)   TO HOLD-SA-NO-CREDITS.             19900000
199010     MOVE NUM-SC-ITEMS (2)     TO HOLD-SA-NO-DEP-ITEMS.           19901000
199020     MOVE AVG-COLL-BAL-CYC (2) TO HOLD-SA-S-C-CALC-AMT.           19902000
199030                                                                  19903000
199040 P8138-CALC.                                                      19904000
199050     COMPUTE HOLD-CS-SC-AMT ROUNDED =                             19905000
199060         (((HOLD-SA-NO-DEBITS * DEBIT-ITEM-COST) +                19906000
199070          (HOLD-SA-NO-CREDITS * CREDIT-ITEM-COST) +               19907000
199080          (HOLD-SA-NO-DEP-ITEMS * DEPOSIT-ITEM-COST) +            19908000
199090          MAINTENANCE-COST +                                      19909000
199100          HOLD-INT-PD-LST-CYC) * -1) +                            19910000
199110          HOLD-SERV-CHG-AMT +                                     19911000
199120          ((HOLD-SA-S-C-CALC-AMT * (1 - FED-RESERVE-REQMNT)) *    19912000
199130          (UST-BILL-RATE / 12)).                                  19913000
199140                                                                  19914000
199150 P8139-EXIT.                                                      19915000
199160     EXIT.                                                        19916000
199170                                                                  19917000
199180******************************************************************19918000
199190* SUBROUTINE - I N I T I A L I Z E   T R A N S A C T I O N S     *19919000
199200******************************************************************19920000
199210 P8200-TX-INIT-1.                                                 19921000
199220     MOVE BCF-BANK-NO    TO DSDSTXL-BANK-NO.                      19922000
199230     MOVE ACCOUNT-ID     TO DSDSTXL-ACCT-ID.                      19923000
199240     MOVE ACCOUNT-NUMBER TO DSDSTXL-ACCT-NO.                      19924000
199250                                                                  19925000
199260 P8205-TX-INIT-2.                                                 19926000
199270     MOVE ZEROS          TO DSDSTXL-ITEM-COUNT                    19927000
199280                            DSDSTXL-BAT-NO                        19928000
199290                            DSDSTXL-SEQ-NO                        19929000
199300                            DSDSTXL-FLOAT1                        19930000
199310                            DSDSTXL-FLOAT2                        19931000
199320                            DSDSTXL-ENCL-TYPE                     19932000
199330                            DSDSTXL-SC-TYPE                       19933000
199340                            DSDSTXL-CHK-NO                        19934000
199350                            DSDSTXL-POS-TX-DATE                   19935000
199360                            DSDSTXL-ACH-PAR-NBR.                  19936000
199370     MOVE SPACES         TO DSDSTXL-DESC                          19937000
199380                            DSDSTXL-CO-DESC                       19938000
199390                            DSDSTXL-POS-REF-NBR                   19939000
199400                            DSDSTXL-ACH-STD-ENTRY-CLASS           19940000
199410                            DSDSTXL-DESC-FORMAT                   19941000
199420                            DSDSTXL-FOR-ATM-DESC.                 19942000
199430     MOVE PROC-CURR-DATE TO DSDSTXL-EFFECT-DT                     19943000
199440                            DSDSTXL-DATE.                         19944000
199450     MOVE DSDSTXL-ENCL-TYPE TO SAVE-ENCL-SW.                      19945000
199460                                                                  19946000
199470 P8209-EXIT.                                                      19947000
199480     EXIT.                                                        19948000
199490                                                                  19949000
199500 P8210-TX-INIT-3.                                                 19950000
199510     MOVE BCF-BANK-NO             TO DSDSTXL-BANK-NO.             19951000
199520     MOVE ACCT-ID-CODE (SUB-ID)   TO DSDSTXL-ACCT-ID.             19952000
199530     MOVE UNPOST-ACCT-NO (SUB-ID) TO DSDSTXL-ACCT-NO.             19953000
199540                                                                  19954000
199550 P8219-EXIT.                                                      19955000
199560     EXIT.                                                        19956000
199570                                                                  19957000
199580******************************************************************19958000
199590*          R . P .   C O L L A T E R A L   R E P O R T           *19959000
199600******************************************************************19960000
199610 P8220-COLLATERAL-RPT.                                            19961000
199620     IF PROC-DSS                                                  19962000
199630         GO TO P8229-EXIT.                                        19963000
199640     MOVE 027 TO SUB1.                                            19964000
199650     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               19965000
199660     IF HOLD-FREQ-RPT = 0                                         19966000
199670         GO TO P8229-EXIT.                                        19967000
199680     PERFORM P8010-STOCK-RPT-COMMON THRU P8019-EXIT.              19968000
199690     MOVE 001 TO SORT-ACCT-ID                                     19969000
199700                 RP-ACCT-ID.                                      19970000
199710     MOVE 999999999 TO SORT-ACCT-NO.                              19971000
199720     MOVE HIGH-VALUES TO SORT-PLAN.                               19972000
199730     MOVE PROC-BK-NO TO DSDS-COLLAT-BK.                           19973000
199740     MOVE ZEROS TO DSDS-COLLAT-RATE.                              19974000
199750     MOVE ZEROS TO DSDS-COLLAT-SEQ.                               19975000
199760     START DSDS-COLLATERAL-FILE                                   19976000
199770         KEY GREATER THAN DSDS-COLLAT-REC-ID.                     19977000
199780     IF VSAM-SUCCESSFUL                                           19978000
199790         GO TO P8225-READ-COLLAT-FILE.                            19979000
199800     GO TO P8229-EXIT.                                            19980000
199810                                                                  19981000
199820 P8225-READ-COLLAT-FILE.                                          19982000
199830     READ DSDS-COLLATERAL-FILE NEXT INTO DSDS-COLLATERAL-RECORD.  19983000
199840     IF VSAM-END-OF-FILE                                          19984000
199850         GO TO P8229-EXIT.                                        19985000
199860     IF VSAM-SUCCESSFUL                                           19986000
199870         NEXT SENTENCE                                            19987000
199880       ELSE                                                       19988000
199890         DISPLAY 'COLLATERAL VSAM READ ERROR' UPON CONSOLE        19989000
199900         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  19990000
199910         CALL 'CDCDUMP' USING BY CONTENT '2073'.                  19991000
199920     IF COLLAT-BK-NO GREATER THAN PROC-BK-NO                      19992000
199930         GO TO P8229-EXIT.                                        19993000
199940     MOVE COLLAT-SEQ-NO TO SORT-COLL-SEQ                          19994000
199950                           RP-ACCT-NO.                            19995000
199960     MOVE COLLAT-DESC TO RP-COLLATERAL-DESC.                      19996000
199970     MOVE COLLAT-MARKET-VALUE TO RP-CURR-BAL.                     19997000
199980     MOVE COLLAT-AVAIL-BAL TO RP-COLL-BAL.                        19998000
199990     MOVE COLLAT-ESCROW-CODE TO SORT-COLL-CODE                    19999000
200000                                RP-COLLATERAL-CODE.               20000000
200010     MOVE COLLAT-RATIO TO RP-COLLATERAL-RATIO.                    20001000
200020     MOVE COLLAT-RATE  TO SORT-COLL-RATE                          20002000
200030                          RP-COLLATERAL-RATE.                     20003000
200040     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   20004000
200050     GO TO P8225-READ-COLLAT-FILE.                                20005000
200060                                                                  20006000
200070 P8229-EXIT.                                                      20007000
200080     EXIT.                                                        20008000
200090                                                                  20009000
200100******************************************************************20010000
200110* SUBROUTINE - C O L L A T E R A L   N O T I C E S               *20011000
200120******************************************************************20012000
200130 P8230-BUILD-COLLAT-NTC.                                          20013000
200140     MOVE 097 TO SUB1.                                            20014000
200150     MOVE SPACES TO SPECIAL-WORK.                                 20015000
200160     MOVE 097 TO CN-REPORT-CODE.                                  20016000
200170     MOVE PROC-FILE-ID TO CN-FILE-ID.                             20017000
200180     MOVE BCF-BANK-NO TO CN-BANK-NO.                              20018000
200190     MOVE ACCOUNT-ID TO CN-ACCT-ID.                               20019000
200200     MOVE ACCOUNT-NUMBER TO CN-ACCT-NO.                           20020000
200210     MOVE LOW-VALUES TO CN-CRF-REC-ID.                            20021000
200220     MOVE HOLD-RP-COLLAT-CNT TO CN-CONTINUATION.                  20022000
200230     MOVE INV-PLAN TO CN-INV-PLAN.                                20023000
200240     IF HOLD-RP-COLLAT-CNT = 999 OR HOLD-RP-MARKET-VALUE = ZEROS  20024000
200250         MOVE HOLD-RP-AMT TO CN-INVEST-AMT                        20025000
200260       ELSE                                                       20026000
200270         MOVE HOLD-RP-MARKET-VALUE TO CN-INVEST-AMT.              20027000
200280     MOVE HOLD-RP-RATE TO CN-EARN-RATE.                           20028000
200290     MOVE INV-MATURE-DATE TO CN-MATURE-DATE.                      20029000
200300     MOVE HOLD-RP-SECURE-AMT TO CN-SECURE-AMT.                    20030000
200310     MOVE INV-COLLATERAL-DESC TO CN-SECURE-DESC.                  20031000
200320     MOVE INV-TERM TO CN-INV-TERM.                                20032000
200330     MOVE INV-TERM-INDICATOR TO CN-INV-TERM-IND.                  20033000
200340     MULTIPLY HOLD-RP-DAILY-INT BY DAYS-TO-NEXT-DATE              20034000
200350         GIVING CN-DAILY-INT-AMT.                                 20035000
200360     MOVE COLLAT-CUSIP TO CN-CUSIP.                               20036000
200370     MOVE INV-COLLAT-NTC-IND TO CN-COLLAT-NTC-IND.                20037000
200380     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           20038000
200390                                                                  20039000
200400 P8235-BUILD-CASH-MGMT-COLLAT.                                    20040000
200410     MOVE CN-BANK-NO TO CMC-BANK-NO.                              20041000
200420     MOVE CN-ACCT-ID TO CMC-ACCT-ID.                              20042000
200430     MOVE CN-ACCT-NO TO CMC-ACCT-NO.                              20043000
200440     IF HOLD-RP-COLLAT-CNT = 999                                  20044000
200450         MOVE 'T' TO CMC-RECORD-TYPE                              20045000
200460       ELSE                                                       20046000
200470         MOVE 'D' TO CMC-RECORD-TYPE.                             20047000
200480     MOVE CN-INV-PLAN TO CMC-INV-PLAN.                            20048000
200490     MOVE CN-INVEST-AMT TO CMC-MARKET-VALUE.                      20049000
200500     MOVE CN-EARN-RATE TO CMC-RATE-EARNED.                        20050000
200510     MOVE CN-DAILY-INT-AMT TO CMC-INT-EARNED.                     20051000
200520     CALL 'CDCDT99' USING CN-MATURE-DATE                          20052000
200530                          CMC-MATURE-DATE                         20053000
200540                          BY CONTENT 'PYYYYDDD'                   20054000
200550                          BY CONTENT 'CMMDDYY'.                   20055000
200560     MOVE CN-SECURE-AMT TO CMC-PAR-VALUE.                         20056000
200570     MOVE CN-CUSIP TO CMC-CUSIP.                                  20057000
200580     MOVE CN-SECURE-DESC TO CMC-COLLAT-DESC.                      20058000
200590     MOVE 'X' TO CMC-END-CHARACTER.                               20059000
200600     WRITE CASH-MGMT-COLLAT-OUT FROM CASH-MGMT-COLLAT-WORK.       20060000
200610                                                                  20061000
200620 P8239-EXIT.                                                      20062000
200630     EXIT.                                                        20063000
200640                                                                  20064000
200650******************************************************************20065000
200660* SUBROUTINE - A F F I L I A T E   H O L D   P R O C E S S I N G *20066000
200670******************************************************************20067000
200680 P8250-CHECK-AFFCHK-HOLD.                                         20068000
200690     MOVE ZERO TO AFFCHK-HIT-SW.                                  20069000
200700     IF SAVE-DR-SORT-KEY = SER-CHK-KEY                            20070000
200710       OR DSDSTXL-DESC EQUAL 'BPCHECK   '                         20071000
200720         NEXT SENTENCE                                            20072000
200730       ELSE                                                       20073000
200740         GO TO P8259-EXIT.                                        20074000
200750     IF DSDSTXL-CODE = 870 OR 874 OR 878                          20075000
200760         GO TO P8259-EXIT.                                        20076000
200770     MOVE DSDSTXL-BANK-NO TO AFFCHK-BANK-NBR.                     20077000
200780     MOVE DSDSTXL-ACCT-ID TO AFFCHK-ACCT-ID.                      20078000
200790     MOVE DSDSTXL-ACCT-NO TO AFFCHK-ACCT-NBR.                     20079000
200800     MOVE DSDSTXL-CHK-NO  TO AFFCHK-CHK-NBR.                      20080000
200810     MOVE DSDSTXL-AMOUNT  TO AFFCHK-AMOUNT.                       20081000
200820     READ AFFCHK-HOLD-FILE.                                       20082000
200830     IF VSAM-RECORD-NOT-FOUND                                     20083000
200840         GO TO P8252-CHECK-FOR-ZBA.                               20084000
200850     IF VSAM-SUCCESSFUL                                           20085000
200860         NEXT SENTENCE                                            20086000
200870       ELSE                                                       20087000
200880         DISPLAY 'CDCERROR-AFFCHK HOLD READ ERROR' UPON CONSOLE   20088000
200890         CALL 'CDCDUMP' USING BY CONTENT '2074'.                  20089000
200900     MOVE DSDSTXL-ACCT-NO TO HOLD-ACCT-NBR.                       20090000
200910     IF HOLD-ACCUM LESS THAN DSDSTXL-AMOUNT                       20091000
200920         NEXT SENTENCE                                            20092000
200930       ELSE                                                       20093000
200940         SUBTRACT DSDSTXL-AMOUNT FROM HOLD-ACCUM.                 20094000
200950     GO TO P8256-UPDATE-FINQ-HOLD.                                20095000
200960                                                                  20096000
200970 P8252-CHECK-FOR-ZBA.                                             20097000
200980     IF ZERO-BAL-ACCT-IND = 'Y'                                   20098000
200990         NEXT SENTENCE                                            20099000
201000       ELSE                                                       20100000
201010         GO TO P8259-EXIT.                                        20101000
201020     IF ZBCM-BANK-NBR NOT NUMERIC OR                              20102000
201030        ZBCM-ACCOUNT-ID NOT NUMERIC OR                            20103000
201040        ZBCM-ACCOUNT-NBR NOT NUMERIC                              20104000
201050         MOVE ZEROS TO ZBCM-BANK-NBR                              20105000
201060                       ZBCM-ACCOUNT-ID                            20106000
201070                       ZBCM-ACCOUNT-NBR.                          20107000
201080     IF DSDSTXL-BANK-NO = ZBCM-BANK-NBR AND                       20108000
201090        DSDSTXL-ACCT-ID = ZBCM-ACCOUNT-ID AND                     20109000
201100        DSDSTXL-ACCT-NO = ZBCM-ACCOUNT-NBR                        20110000
201110        IF ZBA-HIT-SW   = 1                                       20111000
201120            GO TO P8254-CHECK-AFFCHK-HOLD-ZBA                     20112000
201130          ELSE                                                    20113000
201140            GO TO P8259-EXIT.                                     20114000
201150     MOVE DSDSTXL-BANK-NO TO ZBCM-BANK-NBR.                       20115000
201160     MOVE DSDSTXL-ACCT-ID TO ZBCM-ACCOUNT-ID.                     20116000
201170     MOVE DSDSTXL-ACCT-NO TO ZBCM-ACCOUNT-NBR.                    20117000
201180     EXEC SQL                                                     20118000
201190         SELECT                                                   20119000
201200             ZBCM_LINK_ACCT_NBR                                   20120000
201210         INTO                                                     20121000
201220            :ZBCM-LINK-ACCT-NBR                                   20122000
201230         FROM DSDS.ZBACMA                                         20123000
201240         WHERE ZBCM_BANK_NBR    = :ZBCM-BANK-NBR                  20124000
201250           AND ZBCM_ACCOUNT_ID  = :ZBCM-ACCOUNT-ID                20125000
201260           AND ZBCM_ACCOUNT_NBR = :ZBCM-ACCOUNT-NBR               20126000
201270     END-EXEC.                                                    20127000
201280     EVALUATE SQLCODE                                             20128000
201290         WHEN ZEROS                                               20129000
201300             MOVE 1 TO ZBA-HIT-SW                                 20130000
201310             GO TO P8254-CHECK-AFFCHK-HOLD-ZBA                    20131000
201320         WHEN +100                                                20132000
201330             MOVE ZEROS TO ZBA-HIT-SW                             20133000
201340             GO TO P8259-EXIT                                     20134000
201350         WHEN OTHER                                               20135000
201360             CALL 'CDCUT90' USING SQLCA                           20136000
201370             CALL 'CDCDUMP' USING BY CONTENT '2075'               20137000
201380     END-EVALUATE.                                                20138000
201390                                                                  20139000
201400 P8254-CHECK-AFFCHK-HOLD-ZBA.                                     20140000
201410     MOVE DSDSTXL-BANK-NO    TO AFFCHK-BANK-NBR.                  20141000
201420     MOVE DSDSTXL-ACCT-ID    TO AFFCHK-ACCT-ID.                   20142000
201430     MOVE ZBCM-LINK-ACCT-NBR TO AFFCHK-ACCT-NBR.                  20143000
201440     MOVE DSDSTXL-CHK-NO     TO AFFCHK-CHK-NBR.                   20144000
201450     MOVE DSDSTXL-AMOUNT     TO AFFCHK-AMOUNT.                    20145000
201460     READ AFFCHK-HOLD-FILE.                                       20146000
201470     IF VSAM-RECORD-NOT-FOUND                                     20147000
201480         GO TO P8259-EXIT.                                        20148000
201490     IF VSAM-SUCCESSFUL                                           20149000
201500         NEXT SENTENCE                                            20150000
201510       ELSE                                                       20151000
201520         DISPLAY 'CDCERROR-AFFCHK HOLD READ ERROR' UPON CONSOLE   20152000
201530         CALL 'CDCDUMP' USING BY CONTENT '2076'.                  20153000
201540     MOVE ZBCM-LINK-ACCT-NBR TO HOLD-ACCT-NBR.                    20154000
201550     IF HOLD-ACCUM LESS THAN DSDSTXL-AMOUNT                       20155000
201560         NEXT SENTENCE                                            20156000
201570       ELSE                                                       20157000
201580         SUBTRACT DSDSTXL-AMOUNT FROM HOLD-ACCUM.                 20158000
201590     GO TO P8256-UPDATE-FINQ-HOLD.                                20159000
201600                                                                  20160000
201610 P8256-UPDATE-FINQ-HOLD.                                          20161000
201620     MOVE 1 TO AFFCHK-HIT-SW.                                     20162000
201630     MOVE DSDSTXL-BANK-NO TO HOLD-BANK-NBR.                       20163000
201640     MOVE DSDSTXL-ACCT-ID TO HOLD-ACCT-ID.                        20164000
201650     MOVE 005 TO HOLD-TYPE OF FINQ-HOLD.                          20165000
201660     MOVE DSDSTXL-CHK-NO TO HOLD-CHECK-NBR.                       20166000
201670     EXEC SQL                                                     20167000
201680         UPDATE FINQ.HOLD                                         20168000
201690         SET                                                      20169000
201700             HOLD_RELEASE_DATE = 0                                20170000
201710         WHERE                                                    20171000
201720             HOLD_BANK_NBR     = :HOLD-BANK-NBR AND               20172000
201730             HOLD_ACCT_ID      = :HOLD-ACCT-ID AND                20173000
201740             HOLD_ACCT_NBR     = :HOLD-ACCT-NBR AND               20174000
201750             HOLD_TYPE         = :FINQ-HOLD.HOLD-TYPE AND         20175000
201760             HOLD_CHECK_NBR    = :HOLD-CHECK-NBR                  20176000
201770     END-EXEC.                                                    20177000
201780     EVALUATE SQLCODE                                             20178000
201790         WHEN ZEROS                                               20179000
201800             EXEC SQL                                             20180000
201810                 COMMIT                                           20181000
201820             END-EXEC                                             20182000
201830             GO TO P8259-EXIT                                     20183000
201840         WHEN +100                                                20184000
201850             GO TO P8258-UPDATE-FINQ-HOLD-2                       20185000
201860         WHEN OTHER                                               20186000
201870             CALL 'CDCUT90' USING SQLCA                           20187000
201880             CALL 'CDCDUMP' USING BY CONTENT '2077'               20188000
201890     END-EVALUATE.                                                20189000
201900                                                                  20190000
201910 P8258-UPDATE-FINQ-HOLD-2.                                        20191000
201920     MOVE DSDSTXL-CHK-NO TO HOLD-LST-4-DIGITS.                    20192000
201930     IF HOLD-LST-4-DIGITS = ZEROS                                 20193000
201940         GO TO P8259-EXIT.                                        20194000
201950                                                                  20195000
201960     EXEC SQL                                                     20196000
201970         UPDATE FINQ.HOLD                                         20197000
201980         SET                                                      20198000
201990             HOLD_RELEASE_DATE = 0                                20199000
202000         WHERE                                                    20200000
202010             HOLD_BANK_NBR     = :HOLD-BANK-NBR AND               20201000
202020             HOLD_ACCT_ID      = :HOLD-ACCT-ID AND                20202000
202030             HOLD_ACCT_NBR     = :HOLD-ACCT-NBR AND               20203000
202040             HOLD_TYPE         = :FINQ-HOLD.HOLD-TYPE AND         20204000
202050             HOLD_LST_4_DIGITS = :HOLD-LST-4-DIGITS               20205000
202060     END-EXEC.                                                    20206000
202070     EVALUATE SQLCODE                                             20207000
202080         WHEN ZEROS                                               20208000
202090             EXEC SQL                                             20209000
202100                 COMMIT                                           20210000
202110             END-EXEC                                             20211000
202120         WHEN +100                                                20212000
202130             CONTINUE                                             20213000
202140         WHEN OTHER                                               20214000
202150             CALL 'CDCUT90' USING SQLCA                           20215000
202160             CALL 'CDCDUMP' USING BY CONTENT '2078'               20216000
202170     END-EVALUATE.                                                20217000
202180                                                                  20218000
202190 P8259-EXIT.                                                      20219000
202200     EXIT.                                                        20220000
202210                                                                  20221000
202220******************************************************************20222000
202230* SUBROUTINE - A D D   H O L D   F O R   U N P O S T   I T E M S *20223000
202240******************************************************************20224000
202250 P8260-ADD-UNPOST-HOLD.                                           20225000
202260     IF NSF-NOT-PENDING                                           20226000
202270         MOVE '2' TO INSF-PEND-SW.                                20227000
202280     MOVE BCF-BANK-NO TO HOLD-BANK-NBR.                           20228000
202290     MOVE ACCOUNT-ID TO HOLD-ACCT-ID.                             20229000
202300     MOVE ACCOUNT-NUMBER TO HOLD-ACCT-NBR.                        20230000
202310     MOVE 008 TO HOLD-TYPE OF FINQ-HOLD.                          20231000
202320     MOVE 99993 TO HOLD-SOURCE-USER.                              20232000
202330     MOVE 'DSDS100' TO HOLD-SOURCE-PROG.                          20233000
202340     MOVE PROC-CURR-DATE TO HOLD-PLACE-DATE.                      20234000
202350     MOVE PROC-NEXT-DATE TO HOLD-RELEASE-DATE OF FINQ-HOLD.       20235000
202360     MOVE UNPOST-AMT TO HOLD-AMOUNT.                              20236000
202370     MOVE ZEROS TO HOLD-CHECK-NBR.                                20237000
202380     MOVE ZEROS TO HOLD-LST-4-DIGITS.                             20238000
202390     MOVE 'UNPOSTED ITEMS' TO HOLD-TX-DESC-TEXT.                  20239000
202400     CALL 'CDCUT36' USING BY CONTENT LENGTH OF HOLD-TX-DESC-TEXT  20240000
202410                          BY REFERENCE HOLD-TX-DESC.              20241000
202420     EXEC SQL                                                     20242000
202430         INSERT INTO FINQ.HOLD                                    20243000
202440                   (HOLD_BANK_NBR,                                20244000
202450                    HOLD_ACCT_ID,                                 20245000
202460                    HOLD_ACCT_NBR,                                20246000
202470                    HOLD_TYPE,                                    20247000
202480                    HOLD_SOURCE_USER,                             20248000
202490                    HOLD_SOURCE_PROG,                             20249000
202500                    HOLD_PLACE_DATE,                              20250000
202510                    HOLD_RELEASE_DATE,                            20251000
202520                    HOLD_AMOUNT,                                  20252000
202530                    HOLD_CHECK_NBR,                               20253000
202540                    HOLD_LAST_UPDATE,                             20254000
202550                    HOLD_TX_DESC,                                 20255000
202560                    HOLD_LST_4_DIGITS)                            20256000
202570         VALUES                                                   20257000
202580                   (:HOLD-BANK-NBR,                               20258000
202590                    :HOLD-ACCT-ID,                                20259000
202600                    :HOLD-ACCT-NBR,                               20260000
202610                    :FINQ-HOLD.HOLD-TYPE,                         20261000
202620                    :HOLD-SOURCE-USER,                            20262000
202630                    :HOLD-SOURCE-PROG,                            20263000
202640                    :HOLD-PLACE-DATE,                             20264000
202650                    :FINQ-HOLD.HOLD-RELEASE-DATE,                 20265000
202660                    :HOLD-AMOUNT,                                 20266000
202670                    :HOLD-CHECK-NBR,                              20267000
202680                     CURRENT TIMESTAMP,                           20268000
202690                    :HOLD-TX-DESC,                                20269000
202700                    :HOLD-LST-4-DIGITS)                           20270000
202710     END-EXEC.                                                    20271000
202720     EVALUATE SQLCODE                                             20272000
202730         WHEN ZEROS                                               20273000
202740             CONTINUE                                             20274000
202750         WHEN +100                                                20275000
202760             DISPLAY 'UNPOST INSERT DID NOT WORK' UPON CONSOLE    20276000
202770             CALL 'CDCUT90' USING SQLCA                           20277000
202780             CALL 'CDCDUMP' USING BY CONTENT '2079'               20278000
202790         WHEN OTHER                                               20279000
202800             DISPLAY 'UNPOST INSERT DID NOT WORK' UPON CONSOLE    20280000
202810             CALL 'CDCUT90' USING SQLCA                           20281000
202820             CALL 'CDCDUMP' USING BY CONTENT '2080'               20282000
202830     END-EVALUATE.                                                20283000
202840     EXEC SQL                                                     20284000
202850         COMMIT                                                   20285000
202860     END-EXEC.                                                    20286000
202870     EVALUATE SQLCODE                                             20287000
202880         WHEN ZEROS                                               20288000
202890             CONTINUE                                             20289000
202900         WHEN +100                                                20290000
202910             DISPLAY 'UNPOST COMMIT DID NOT WORK' UPON CONSOLE    20291000
202920             CALL 'CDCUT90' USING SQLCA                           20292000
202930             CALL 'CDCDUMP' USING BY CONTENT '2081'               20293000
202940         WHEN OTHER                                               20294000
202950             DISPLAY 'UNPOST COMMIT DID NOT WORK' UPON CONSOLE    20295000
202960             CALL 'CDCUT90' USING SQLCA                           20296000
202970             CALL 'CDCDUMP' USING BY CONTENT '2082'               20297000
202980     END-EVALUATE.                                                20298000
202990     ADD UNPOST-AMT TO HOLD-ACCUM.                                20299000
203000     MOVE SPACES TO STOCK-WORK.                                   20300000
203010     MOVE 'G' TO SPW-HA-RPT-REASON.                               20301000
203020     MOVE 1 TO SUB2.                                              20302000
203030     MOVE UNPOST-AMT TO SPW-HOLD-AMT.                             20303000
203040     MOVE 5 TO SPW-HOLD-TYPE.                                     20304000
203050     MOVE 'UNPOST AMT' TO SPW-HOLD-PERSON.                        20305000
203060     MOVE PROC-CURR-DATE TO SPW-HOLD-PLACED-DATE.                 20306000
203070     MOVE PROC-NEXT-DATE TO SPW-HOLD-RELEASE-DATE.                20307000
203080     MOVE 006 TO SUB1.                                            20308000
203090     PERFORM P7060-BUILD-HOLD-REC THRU P7069-EXIT.                20309000
203100     MOVE SPACES TO SPW-HOLD-INFORMATION.                         20310000
203110                                                                  20311000
203120 P8269-EXIT.                                                      20312000
203130     EXIT.                                                        20313000
203140                                                                  20314000
203150******************************************************************20315000
203160* SUBROUTINE - A D D   H O L D   F O R   I N S F   I T E M S     *20316000
203170******************************************************************20317000
203180 P8270-ADD-INSF-HOLD.                                             20318000
203190     IF POST-OD                                                   20319000
203200         GO TO P8279-EXIT.                                        20320000
203210     MOVE BCF-BANK-NO TO HOLD-BANK-NBR.                           20321000
203220     MOVE ACCOUNT-ID TO HOLD-ACCT-ID.                             20322000
203230     MOVE ACCOUNT-NUMBER TO HOLD-ACCT-NBR.                        20323000
203240     MOVE 008 TO HOLD-TYPE OF FINQ-HOLD.                          20324000
203250     MOVE 99993 TO HOLD-SOURCE-USER.                              20325000
203260     MOVE 'DSDS100' TO HOLD-SOURCE-PROG.                          20326000
203270     MOVE PROC-CURR-DATE TO HOLD-PLACE-DATE.                      20327000
203280     MOVE PROC-NEXT-DATE TO HOLD-RELEASE-DATE OF FINQ-HOLD.       20328000
203290     MOVE INSF-AMT TO HOLD-AMOUNT.                                20329000
203300     MOVE ZEROS TO HOLD-CHECK-NBR.                                20330000
203310     MOVE ZEROS TO HOLD-LST-4-DIGITS.                             20331000
203320     MOVE 'NSF AMOUNT' TO HOLD-TX-DESC-TEXT.                      20332000
203330     CALL 'CDCUT36' USING BY CONTENT LENGTH OF HOLD-TX-DESC-TEXT  20333000
203340                          BY REFERENCE HOLD-TX-DESC.              20334000
203350                                                                  20335000
203360     EXEC SQL                                                     20336000
203370         INSERT INTO FINQ.HOLD                                    20337000
203380                   (HOLD_BANK_NBR,                                20338000
203390                    HOLD_ACCT_ID,                                 20339000
203400                    HOLD_ACCT_NBR,                                20340000
203410                    HOLD_TYPE,                                    20341000
203420                    HOLD_SOURCE_USER,                             20342000
203430                    HOLD_SOURCE_PROG,                             20343000
203440                    HOLD_PLACE_DATE,                              20344000
203450                    HOLD_RELEASE_DATE,                            20345000
203460                    HOLD_AMOUNT,                                  20346000
203470                    HOLD_CHECK_NBR,                               20347000
203480                    HOLD_LAST_UPDATE,                             20348000
203490                    HOLD_TX_DESC,                                 20349000
203500                    HOLD_LST_4_DIGITS)                            20350000
203510         VALUES                                                   20351000
203520                   (:HOLD-BANK-NBR,                               20352000
203530                    :HOLD-ACCT-ID,                                20353000
203540                    :HOLD-ACCT-NBR,                               20354000
203550                    :FINQ-HOLD.HOLD-TYPE,                         20355000
203560                    :HOLD-SOURCE-USER,                            20356000
203570                    :HOLD-SOURCE-PROG,                            20357000
203580                    :HOLD-PLACE-DATE,                             20358000
203590                    :FINQ-HOLD.HOLD-RELEASE-DATE,                 20359000
203600                    :HOLD-AMOUNT,                                 20360000
203610                    :HOLD-CHECK-NBR,                              20361000
203620                     CURRENT TIMESTAMP,                           20362000
203630                    :HOLD-TX-DESC,                                20363000
203640                    :HOLD-LST-4-DIGITS)                           20364000
203650     END-EXEC.                                                    20365000
203660     EVALUATE SQLCODE                                             20366000
203670         WHEN ZEROS                                               20367000
203680             CONTINUE                                             20368000
203690         WHEN +100                                                20369000
203700             DISPLAY 'INSF INSERT DID NOT WORK' UPON CONSOLE      20370000
203710             CALL 'CDCUT90' USING SQLCA                           20371000
203720             CALL 'CDCDUMP' USING BY CONTENT '2083'               20372000
203730         WHEN OTHER                                               20373000
203740             DISPLAY 'INSF INSERT DID NOT WORK' UPON CONSOLE      20374000
203750             CALL 'CDCUT90' USING SQLCA                           20375000
203760             CALL 'CDCDUMP' USING BY CONTENT '2084'               20376000
203770     END-EVALUATE.                                                20377000
203780                                                                  20378000
203790     EXEC SQL                                                     20379000
203800         COMMIT                                                   20380000
203810     END-EXEC.                                                    20381000
203820     EVALUATE SQLCODE                                             20382000
203830         WHEN ZEROS                                               20383000
203840             CONTINUE                                             20384000
203850         WHEN +100                                                20385000
203860             DISPLAY 'INSF COMMIT DID NOT WORK' UPON CONSOLE      20386000
203870             CALL 'CDCUT90' USING SQLCA                           20387000
203880             CALL 'CDCDUMP' USING BY CONTENT '2085'               20388000
203890         WHEN OTHER                                               20389000
203900             DISPLAY 'INSF COMMIT DID NOT WORK' UPON CONSOLE      20390000
203910             CALL 'CDCUT90' USING SQLCA                           20391000
203920             CALL 'CDCDUMP' USING BY CONTENT '2086'               20392000
203930     END-EVALUATE.                                                20393000
203940                                                                  20394000
203950     ADD INSF-AMT TO HOLD-ACCUM.                                  20395000
203960     MOVE SPACES TO STOCK-WORK.                                   20396000
203970     MOVE 'G' TO SPW-HA-RPT-REASON.                               20397000
203980     MOVE 1 TO SUB2.                                              20398000
203990     MOVE INSF-AMT TO SPW-HOLD-AMT.                               20399000
204000     MOVE 5 TO SPW-HOLD-TYPE.                                     20400000
204010     MOVE 'NSF AMOUNT' TO SPW-HOLD-PERSON.                        20401000
204020     MOVE PROC-CURR-DATE TO SPW-HOLD-PLACED-DATE.                 20402000
204030     MOVE PROC-NEXT-DATE TO SPW-HOLD-RELEASE-DATE.                20403000
204040     MOVE 006 TO SUB1.                                            20404000
204050     PERFORM P7060-BUILD-HOLD-REC THRU P7069-EXIT.                20405000
204060     MOVE SPACES TO SPW-HOLD-INFORMATION.                         20406000
204070                                                                  20407000
204080 P8279-EXIT.                                                      20408000
204090     EXIT.                                                        20409000
204100                                                                  20410000
204110******************************************************************20411000
204120*  D E L E T E   H O L D S   O N   C L O S E D   A C C O U N T   *20412000
204130******************************************************************20413000
204140 P8280-DELETE-HOLDS.                                              20414000
204150     MOVE BCF-BANK-NO TO HOLD-BANK-NBR.                           20415000
204160     MOVE ACCOUNT-ID TO HOLD-ACCT-ID.                             20416000
204170     MOVE ACCOUNT-NUMBER TO HOLD-ACCT-NBR.                        20417000
204180                                                                  20418000
204190     EXEC SQL                                                     20419000
204200         DECLARE C2 CURSOR FOR                                    20420000
204210         SELECT HOLD_BANK_NBR,                                    20421000
204220                HOLD_ACCT_ID,                                     20422000
204230                HOLD_ACCT_NBR,                                    20423000
204240                HOLD_AMOUNT,                                      20424000
204250                HOLD_TYPE,                                        20425000
204260                HOLD_SOURCE_USER,                                 20426000
204270                HOLD_PLACE_DATE,                                  20427000
204280                HOLD_RELEASE_DATE                                 20428000
204290         FROM FINQ.HOLD                                           20429000
204300         WHERE HOLD_BANK_NBR = :HOLD-BANK-NBR AND                 20430000
204310               HOLD_ACCT_ID  = :HOLD-ACCT-ID AND                  20431000
204320               HOLD_ACCT_NBR = :HOLD-ACCT-NBR                     20432000
204330     END-EXEC.                                                    20433000
204340                                                                  20434000
204350     EXEC SQL                                                     20435000
204360         OPEN C2                                                  20436000
204370     END-EXEC.                                                    20437000
204380                                                                  20438000
204390     EVALUATE SQLCODE                                             20439000
204400         WHEN ZEROS                                               20440000
204410             CONTINUE                                             20441000
204420         WHEN +100                                                20442000
204430             DISPLAY 'OPEN C2 DID NOT WORK' UPON CONSOLE          20443000
204440             CALL 'CDCUT90' USING SQLCA                           20444000
204450             CALL 'CDCDUMP' USING BY CONTENT '2087'               20445000
204460         WHEN OTHER                                               20446000
204470             DISPLAY 'OPEN C2 DID NOT WORK' UPON CONSOLE          20447000
204480             CALL 'CDCUT90' USING SQLCA                           20448000
204490             CALL 'CDCDUMP' USING BY CONTENT '2088'               20449000
204500     END-EVALUATE.                                                20450000
204510                                                                  20451000
204520 P8283-FETCH-C2.                                                  20452000
204530     EXEC SQL                                                     20453000
204540         FETCH C2                                                 20454000
204550         INTO :HOLD-BANK-NBR,                                     20455000
204560              :HOLD-ACCT-ID,                                      20456000
204570              :HOLD-ACCT-NBR,                                     20457000
204580              :HOLD-AMOUNT,                                       20458000
204590              :FINQ-HOLD.HOLD-TYPE,                               20459000
204600              :HOLD-SOURCE-USER,                                  20460000
204610              :HOLD-PLACE-DATE,                                   20461000
204620              :FINQ-HOLD.HOLD-RELEASE-DATE                        20462000
204630     END-EXEC.                                                    20463000
204640                                                                  20464000
204650     EVALUATE SQLCODE                                             20465000
204660         WHEN ZEROS                                               20466000
204670             GO TO P8286-DELETE-C2                                20467000
204680         WHEN +100                                                20468000
204690             GO TO P8288-COMMIT                                   20469000
204700         WHEN OTHER                                               20470000
204710             DISPLAY 'FETCH C2 DID NOT WORK' UPON CONSOLE         20471000
204720             CALL 'CDCUT90' USING SQLCA                           20472000
204730             CALL 'CDCDUMP' USING BY CONTENT '2089'               20473000
204740     END-EVALUATE.                                                20474000
204750                                                                  20475000
204760 P8286-DELETE-C2.                                                 20476000
204770     EXEC SQL                                                     20477000
204780         DELETE                                                   20478000
204790         FROM FINQ.HOLD                                           20479000
204800         WHERE CURRENT OF C2                                      20480000
204810     END-EXEC.                                                    20481000
204820                                                                  20482000
204830     EVALUATE SQLCODE                                             20483000
204840         WHEN ZEROS                                               20484000
204850             CONTINUE                                             20485000
204860         WHEN +100                                                20486000
204870             DISPLAY 'DELETE C2 DID NOT WORK' UPON CONSOLE        20487000
204880             CALL 'CDCUT90' USING SQLCA                           20488000
204890             CALL 'CDCDUMP' USING BY CONTENT '2090'               20489000
204900         WHEN OTHER                                               20490000
204910             DISPLAY 'DELETE C2 DID NOT WORK' UPON CONSOLE        20491000
204920             CALL 'CDCUT90' USING SQLCA                           20492000
204930             CALL 'CDCDUMP' USING BY CONTENT '2091'               20493000
204940     END-EVALUATE.                                                20494000
204950                                                                  20495000
204960     IF HOLD-AMOUNT = ZEROS                                       20496000
204970         GO TO P8283-FETCH-C2.                                    20497000
204980     MOVE SPACES TO STOCK-WORK.                                   20498000
204990     MOVE 'C' TO SPW-HA-RPT-REASON.                               20499000
205000     MOVE 1 TO SUB2.                                              20500000
205010     MOVE HOLD-AMOUNT TO SPW-HOLD-AMT.                            20501000
205020     MOVE HOLD-TYPE OF FINQ-HOLD TO HOLD-TYPE-WORK.               20502000
205030     MOVE HOLD-TYPE-X TO SPW-HOLD-TYPE.                           20503000
205040     MOVE HOLD-SOURCE-USER     TO HOLD-SOURCE-USER-NUM            20504000
205050     MOVE HOLD-SOURCE-USER-NUM TO SPW-HOLD-PERSON.                20505000
205060                                                                  20506000
205070     MOVE HOLD-PLACE-DATE TO SPW-HOLD-PLACED-DATE.                20507000
205080     MOVE HOLD-RELEASE-DATE OF FINQ-HOLD TO                       20508000
205090         SPW-HOLD-RELEASE-DATE.                                   20509000
205100     MOVE 006 TO SUB1.                                            20510000
205110     PERFORM P7060-BUILD-HOLD-REC THRU P7069-EXIT.                20511000
205120     MOVE SPACES TO SPW-HOLD-INFORMATION.                         20512000
205130     GO TO P8283-FETCH-C2.                                        20513000
205140                                                                  20514000
205150 P8288-COMMIT.                                                    20515000
205160     EXEC SQL                                                     20516000
205170         COMMIT                                                   20517000
205180     END-EXEC.                                                    20518000
205190                                                                  20519000
205200     EVALUATE SQLCODE                                             20520000
205210         WHEN ZEROS                                               20521000
205220             CONTINUE                                             20522000
205230         WHEN +100                                                20523000
205240             DISPLAY 'DELETE COMMIT DID NOT WORK' UPON CONSOLE    20524000
205250             CALL 'CDCUT90' USING SQLCA                           20525000
205260             CALL 'CDCDUMP' USING BY CONTENT '2093'               20526000
205270         WHEN OTHER                                               20527000
205280             DISPLAY 'DELETE COMMIT DID NOT WORK' UPON CONSOLE    20528000
205290             CALL 'CDCUT90' USING SQLCA                           20529000
205300             CALL 'CDCDUMP' USING BY CONTENT '2094'               20530000
205310     END-EVALUATE.                                                20531000
205320                                                                  20532000
205330 P8289-EXIT.                                                      20533000
205340     EXIT.                                                        20534000
205350                                                                  20535000
205360******************************************************************20536000
205370* SUBROUTINE - L I S T   H O L D S                               *20537000
205380******************************************************************20538000
205390 P8290-LIST-HOLDS.                                                20539000
205400     IF HOLD-ACCUM = ZEROS                                        20540000
205410         GO TO P8299-EXIT.                                        20541000
205420     MOVE 034 TO SUB1.                                            20542000
205430     MOVE SPACES TO STOCK-WORK.                                   20543000
205440     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               20544000
205450     IF HOLD-FREQ-RPT = 0                                         20545000
205460         GO TO P8299-EXIT.                                        20546000
205470     MOVE BCF-BANK-NO TO HOLD-BANK-NBR.                           20547000
205480     MOVE ACCOUNT-ID TO HOLD-ACCT-ID.                             20548000
205490     MOVE ACCOUNT-NUMBER TO HOLD-ACCT-NBR.                        20549000
205500     MOVE PROC-CURR-DATE TO HOLD-RELEASE-DATE OF FINQ-HOLD.       20550000
205510                                                                  20551000
205520     EXEC SQL                                                     20552000
205530         DECLARE C3 CURSOR FOR                                    20553000
205540         SELECT HOLD_BANK_NBR,                                    20554000
205550                HOLD_ACCT_ID,                                     20555000
205560                HOLD_ACCT_NBR,                                    20556000
205570                HOLD_AMOUNT,                                      20557000
205580                HOLD_TYPE,                                        20558000
205590                HOLD_SOURCE_USER,                                 20559000
205600                HOLD_PLACE_DATE,                                  20560000
205610                HOLD_RELEASE_DATE                                 20561000
205620         FROM FINQ.HOLD                                           20562000
205630         WHERE HOLD_BANK_NBR     = :HOLD-BANK-NBR AND             20563000
205640               HOLD_ACCT_ID      = :HOLD-ACCT-ID AND              20564000
205650               HOLD_ACCT_NBR     = :HOLD-ACCT-NBR AND             20565000
205660               HOLD_TYPE        IN (001, 002, 003) AND            20566000
205670               HOLD_RELEASE_DATE > :FINQ-HOLD.HOLD-RELEASE-DATE   20567000
205680     END-EXEC.                                                    20568000
205690                                                                  20569000
205700     EXEC SQL                                                     20570000
205710         OPEN C3                                                  20571000
205720     END-EXEC.                                                    20572000
205730                                                                  20573000
205740     EVALUATE SQLCODE                                             20574000
205750         WHEN ZEROS                                               20575000
205760             CONTINUE                                             20576000
205770         WHEN +100                                                20577000
205780             DISPLAY 'OPEN C3 DID NOT WORK' UPON CONSOLE          20578000
205790             CALL 'CDCUT90' USING SQLCA                           20579000
205800             CALL 'CDCDUMP' USING BY CONTENT '2095'               20580000
205810         WHEN OTHER                                               20581000
205820             DISPLAY 'OPEN C3 DID NOT WORK' UPON CONSOLE          20582000
205830             CALL 'CDCUT90' USING SQLCA                           20583000
205840             CALL 'CDCDUMP' USING BY CONTENT '2096'               20584000
205850     END-EVALUATE.                                                20585000
205860                                                                  20586000
205870 P8293-FETCH-C3.                                                  20587000
205880     EXEC SQL                                                     20588000
205890         FETCH C3                                                 20589000
205900         INTO :HOLD-BANK-NBR,                                     20590000
205910              :HOLD-ACCT-ID,                                      20591000
205920              :HOLD-ACCT-NBR,                                     20592000
205930              :HOLD-AMOUNT,                                       20593000
205940              :FINQ-HOLD.HOLD-TYPE,                               20594000
205950              :HOLD-SOURCE-USER,                                  20595000
205960              :HOLD-PLACE-DATE,                                   20596000
205970              :FINQ-HOLD.HOLD-RELEASE-DATE                        20597000
205980     END-EXEC.                                                    20598000
205990                                                                  20599000
206000     EVALUATE SQLCODE                                             20600000
206010         WHEN ZEROS                                               20601000
206020             GO TO P8296-PRINT-C3                                 20602000
206030         WHEN +100                                                20603000
206040             GO TO P8298-CLOSE-C3                                 20604000
206050         WHEN OTHER                                               20605000
206060             DISPLAY 'FETCH C3 DID NOT WORK' UPON CONSOLE         20606000
206070             CALL 'CDCUT90' USING SQLCA                           20607000
206080             CALL 'CDCDUMP' USING BY CONTENT '2097'               20608000
206090     END-EVALUATE.                                                20609000
206100                                                                  20610000
206110 P8296-PRINT-C3.                                                  20611000
206120     MOVE SPACES TO STOCK-WORK.                                   20612000
206130     MOVE 1 TO SUB2.                                              20613000
206140     MOVE HOLD-AMOUNT TO SPW-HOLD-AMT.                            20614000
206150     MOVE HOLD-TYPE OF FINQ-HOLD TO HOLD-TYPE-WORK.               20615000
206160     MOVE HOLD-TYPE-X TO SPW-HOLD-TYPE.                           20616000
206170     MOVE HOLD-SOURCE-USER TO AMSOPER-OPERATOR.                   20617000
206180                                                                  20618000
206190     EXEC SQL                                                     20619000
206200         SELECT                                                   20620000
206210             AMSOPER_SHORT_NAME                                   20621000
206220         INTO                                                     20622000
206230            :AMSOPER-SHORT-NAME                                   20623000
206240         FROM AMS.OPERATOR                                        20624000
206250         WHERE AMSOPER_OPERATOR = :AMSOPER-OPERATOR               20625000
206260     END-EXEC.                                                    20626000
206270                                                                  20627000
206280     EVALUATE SQLCODE                                             20628000
206290         WHEN ZEROS                                               20629000
206300             MOVE AMSOPER-SHORT-NAME TO SPW-HOLD-PERSON           20630000
206310         WHEN +100                                                20631000
206320             MOVE 'UNKNOWN'          TO SPW-HOLD-PERSON           20632000
206330         WHEN OTHER                                               20633000
206340             CALL 'CDCUT90' USING SQLCA                           20634000
206350             CALL 'CDCDUMP' USING BY CONTENT '2098'               20635000
206360     END-EVALUATE.                                                20636000
206370                                                                  20637000
206380     MOVE HOLD-PLACE-DATE TO SPW-HOLD-PLACED-DATE.                20638000
206390     MOVE HOLD-RELEASE-DATE OF FINQ-HOLD TO                       20639000
206400         SPW-HOLD-RELEASE-DATE.                                   20640000
206410     PERFORM P7060-BUILD-HOLD-REC THRU P7069-EXIT.                20641000
206420     MOVE SPACES TO SPW-HOLD-INFORMATION.                         20642000
206430     GO TO P8293-FETCH-C3.                                        20643000
206440                                                                  20644000
206450 P8298-CLOSE-C3.                                                  20645000
206460     EXEC SQL                                                     20646000
206470         CLOSE C3                                                 20647000
206480     END-EXEC.                                                    20648000
206490                                                                  20649000
206500     EVALUATE SQLCODE                                             20650000
206510         WHEN ZEROS                                               20651000
206520             CONTINUE                                             20652000
206530         WHEN +100                                                20653000
206540             DISPLAY 'CLOSE C3 DID NOT WORK' UPON CONSOLE         20654000
206550             CALL 'CDCUT90' USING SQLCA                           20655000
206560             CALL 'CDCDUMP' USING BY CONTENT '2099'               20656000
206570         WHEN OTHER                                               20657000
206580             DISPLAY 'CLOSE C3 DID NOT WORK' UPON CONSOLE         20658000
206590             CALL 'CDCUT90' USING SQLCA                           20659000
206600             CALL 'CDCDUMP' USING BY CONTENT '2100'               20660000
206610     END-EVALUATE.                                                20661000
206620                                                                  20662000
206630 P8299-EXIT.                                                      20663000
206640     EXIT.                                                        20664000
206650                                                                  20665000
206660******************************************************************20666000
206670* SUBROUTINE - C H E C K   A R    C U S T   C N T L   F I L E    *20667000
206680******************************************************************20668000
206690 P8310-CHECK-AR-CCF.                                              20669000
206700     IF PROC-DSS                                                  20670000
206710         GO TO P8319-EXIT.                                        20671000
206720     IF CLOSED                                                    20672000
206730         SET NO-ACCT-RECON TO TRUE                                20673000
206740         GO TO P8319-EXIT.                                        20674000
206750     MOVE DSDS-BANK-NO TO ARC-BANK.                               20675000
206760     MOVE DSDS-ACCOUNT-NO TO ARC-ACCT.                            20676000
206770                                                                  20677000
206780     EXEC SQL                                                     20678000
206790         SELECT                                                   20679000
206800             ARC_BANK,                                            20680000
206810             ARC_ACCT,                                            20681000
206820             ARC_DSDS_FLAG,                                       20682000
206830             ARC_SCHK_FLAG,                                       20683000
206840             ARC_PROC_FREQ,                                       20684000
206850             ARC_BEGIN_CHECK,                                     20685000
206860             ARC_DOLLAR_LIMIT                                     20686000
206870         INTO                                                     20687000
206880            :ARC-BANK,                                            20688000
206890            :ARC-ACCT,                                            20689000
206900            :ARC-DSDS-FLAG,                                       20690000
206910            :ARC-SCHK-FLAG,                                       20691000
206920            :ARC-PROC-FREQ,                                       20692000
206930            :ARC-BEGIN-CHECK,                                     20693000
206940            :ARC-DOLLAR-LIMIT                                     20694000
206950         FROM AR.CUSTOMER                                         20695000
206960         WHERE ARC_BANK = :ARC-BANK AND                           20696000
206970               ARC_ACCT = :ARC-ACCT                               20697000
206980     END-EXEC.                                                    20698000
206990                                                                  20699000
207000     EVALUATE SQLCODE                                             20700000
207010         WHEN ZEROS                                               20701000
207020             CONTINUE                                             20702000
207030         WHEN +100                                                20703000
207040             SET NO-ACCT-RECON TO TRUE                            20704000
207050             MOVE SPACE TO SURE-CHECK-IND                         20705000
207060             GO TO P8319-EXIT                                     20706000
207070         WHEN OTHER                                               20707000
207080             DISPLAY 'CDCERROR-AR CCF READ ERROR' UPON CONSOLE    20708000
207090             DISPLAY 'ACCOUNT = ' DSDS-ACCOUNT-NO UPON CONSOLE    20709000
207100             CALL 'CDCDUMP' USING BY CONTENT '2101'               20710000
207110     END-EVALUATE.                                                20711000
207120                                                                  20712000
207130     IF ARC-DSDS-FLAG = 'Y'                                       20713000
207140         SET DO-ACCT-RECON TO TRUE                                20714000
207150       ELSE                                                       20715000
207160         SET NO-ACCT-RECON TO TRUE.                               20716000
207170     IF ARC-SCHK-FLAG = 'Y'                                       20717000
207180         SET SURE-CHECK-ACCT TO TRUE                              20718000
207190       ELSE                                                       20719000
207200         MOVE SPACE TO SURE-CHECK-IND.                            20720000
207210                                                                  20721000
207220 P8319-EXIT.                                                      20722000
207230     EXIT.                                                        20723000
207240                                                                  20724000
207250******************************************************************20725000
207260* SUBROUTINE - C H E C K   F O R   E - S T A T E M E N T         *20726000
207270******************************************************************20727000
207280 P8320-CHECK-FOR-E-STMT.                                          20728000
207290     MOVE '  ' TO HOLD-E-STMT-IND.                                20729000
207300     IF PROC-DSS                                                  20730000
207310         GO TO P8329-EXIT.                                        20731000
207320     MOVE DSDS-BANK-NO    TO EDOC050-ACCT-BANK-NBR.               20732000
207330     MOVE DSDS-ACCOUNT-ID TO XKEY-DSDS-ACCT-ID.                   20733000
207340     MOVE DSDS-ACCOUNT-NO TO XKEY-DSDS-ACCT-NBR.                  20734000
207350     MOVE CIF-XREF-KEY    TO EDOC050-ACCT-KEY.                    20735000
207360                                                                  20736000
207370     CALL 'EDOC050' USING EDOC050-PARAMETERS.                     20737000
207380                                                                  20738000
207390     MOVE ZEROS TO SUB3.                                          20739000
207400     MOVE 'NN' TO HOLD-E-STMT-IND.                                20740000
207410                                                                  20741000
207420 P8325-LOOP.                                                      20742000
207430     ADD 1 TO SUB3.                                               20743000
207440     IF SUB3 GREATER THAN 10                                      20744000
207450        GO TO P8329-EXIT.                                         20745000
207460                                                                  20746000
207470** THE TABLE RETURNED BY EDOC050 WILL BE EMPTY IF THE ONLY        20747000
207480** DELIVERY RECORD THE ACCOUNT HAS IS WITH A METHOD OF 0          20748000
207490** (NO PRINT)                                                     20749000
207500     IF SUB3 EQUAL 1 AND                                          20750000
207510        EDOC050-DEL-METHOD (SUB3) EQUAL ZEROS                     20751000
207520         MOVE 'Y'   TO HOLD-ESI-ELECTRONIC                        20752000
207530     END-IF.                                                      20753000
207540                                                                  20754000
207550     IF EDOC050-DEL-METHOD (SUB3) = ZEROS                         20755000
207560        GO TO P8329-EXIT.                                         20756000
207570                                                                  20757000
207580     EVALUATE EDOC050-DEL-METHOD (SUB3)                           20758000
207590        WHEN 1                                                    20759000
207600           MOVE 'Y' TO HOLD-ESI-PAPER                             20760000
207610        WHEN 2                                                    20761000
207620        WHEN 3                                                    20762000
207630        WHEN 5                                                    20763000
207640           MOVE 'Y' TO HOLD-ESI-ELECTRONIC                        20764000
207650        WHEN OTHER                                                20765000
207660           GO TO P8325-LOOP                                       20766000
207670     END-EVALUATE.                                                20767000
207680                                                                  20768000
207690     GO TO P8325-LOOP.                                            20769000
207700                                                                  20770000
207710 P8329-EXIT.                                                      20771000
207720     EXIT.                                                        20772000
207730                                                                  20773000
207740******************************************************************20774000
207750* SUBROUTINE - R E A D   H O L D   T O T A L   F I L E           *20775000
207760******************************************************************20776000
207770 P8330-READ-HOLD-FILE.                                            20777000
207780     MOVE BCF-BANK-NO TO HOLD-KEY-BANK-NO.                        20778000
207790     MOVE ACCOUNT-ID TO HOLD-KEY-ACCT-ID.                         20779000
207800     MOVE ACCOUNT-NUMBER TO HOLD-KEY-ACCT-NO.                     20780000
207810     MOVE HOLD-TOT-KEY-WORK TO HOLD-TOT-KEY.                      20781000
207820     READ HOLD-TOT-FILE INTO HOLD-TOTAL-FILE-WORK.                20782000
207830     IF VSAM-RECORD-NOT-FOUND                                     20783000
207840         MOVE ZEROS TO HOLD-ACCUM                                 20784000
207850         MOVE 'N' TO HOLD-AFFILIATE-CHK-IND                       20785000
207860         GO TO P8339-EXIT.                                        20786000
207870     IF VSAM-SUCCESSFUL                                           20787000
207880         MOVE HOLD-TOT-AMT-WORK TO HOLD-ACCUM                     20788000
207890         GO TO P8339-EXIT.                                        20789000
207900     DISPLAY 'HOLD VSAM READ ERROR' UPON CONSOLE.                 20790000
207910     DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE.     20791000
207920     CALL 'CDCDUMP' USING BY CONTENT '2102'.                      20792000
207930                                                                  20793000
207940 P8339-EXIT.                                                      20794000
207950     EXIT.                                                        20795000
207960                                                                  20796000
207970******************************************************************20797000
207980* SUBROUTINE - D E C I D E S  S T A T E M E N T  T Y P E         *20798000
207990******************************************************************20799000
208000 P8340-CHECK-WHICH-STMT.                                          20800000
208010     IF NO-STMT                                                   20801000
208020         GO TO P8347-CK-NO-STMT.                                  20802000
208030     IF DDA-OSB-STMT OR REG-SAV-STMT                              20803000
208040         EVALUATE TRUE                                            20804000
208050             WHEN STMT-WITH-CHECKS                                20805000
208060                 ADD 1 TO NUM-STMTS-CHKS-PRI                      20806000
208070             WHEN STMT-TRUNCATED                                  20807000
208080                 ADD 1 TO NUM-STMTS-TRUNC-PRI                     20808000
208090             WHEN STMT-IMAGED                                     20809000
208100                 ADD 1 TO NUM-STMTS-IMAGE-PRI                     20810000
208110             WHEN OTHER                                           20811000
208120                 ADD 1 TO NUM-STMTS-CHKS-PRI                      20812000
208130         END-EVALUATE                                             20813000
208140                                                                  20814000
208150         EVALUATE STMT-DISP-CODE                                  20815000
208160             WHEN 'M'                                             20816000
208170                 ADD 1 TO NUM-MAIL-CODE-M                         20817000
208180             WHEN 'H'                                             20818000
208190                 ADD 1 TO NUM-MAIL-CODE-H                         20819000
208200             WHEN 'E'                                             20820000
208210                 ADD 1 TO NUM-MAIL-CODE-E                         20821000
208220             WHEN 'A'                                             20822000
208230                 ADD 1 TO NUM-MAIL-CODE-A                         20823000
208240             WHEN 'C'                                             20824000
208250                 ADD 1 TO NUM-MAIL-CODE-C                         20825000
208260             WHEN 'D'                                             20826000
208270                 ADD 1 TO NUM-MAIL-CODE-D                         20827000
208280             WHEN 'G'                                             20828000
208290                 ADD 1 TO NUM-MAIL-CODE-G                         20829000
208300             WHEN 'X'                                             20830000
208310                 ADD 1 TO NUM-MAIL-CODE-X                         20831000
208320             WHEN OTHER                                           20832000
208330                 ADD 1 TO NUM-MAIL-CODE-OTHER                     20833000
208340         END-EVALUATE                                             20834000
208350                                                                  20835000
208360       ELSE                                                       20836000
208370                                                                  20837000
208380         EVALUATE TRUE                                            20838000
208390             WHEN STMT-WITH-CHECKS                                20839000
208400                 ADD 1 TO NUM-STMTS-CHKS-SEC                      20840000
208410             WHEN STMT-TRUNCATED                                  20841000
208420                 ADD 1 TO NUM-STMTS-TRUNC-SEC                     20842000
208430             WHEN STMT-IMAGED                                     20843000
208440                 ADD 1 TO NUM-STMTS-IMAGE-SEC                     20844000
208450             WHEN OTHER                                           20845000
208460                 ADD 1 TO NUM-STMTS-CHKS-SEC                      20846000
208470         END-EVALUATE.                                            20847000
208480                                                                  20848000
208490     IF CYCLE-THIS-STMT = 1                                       20849000
208500         NEXT SENTENCE                                            20850000
208510       ELSE                                                       20851000
208520         GO TO P8344-CK-WHICH-STMT-REQUEST.                       20852000
208530     IF PROC-DSS                                                  20853000
208540         GO TO P8342-DSS-CYCLE.                                   20854000
208550     MOVE 011 TO HOLD-REPORT-CODE.                                20855000
208560     GO TO P8348-FOUND-STMT-TYPE.                                 20856000
208570                                                                  20857000
208580 P8342-DSS-CYCLE.                                                 20858000
208590     MOVE 081 TO HOLD-REPORT-CODE.                                20859000
208600     PERFORM P8610-BUILD-OSB-SAV-HEADER THRU P8619-EXIT.          20860000
208610     GO TO P8349-EXIT.                                            20861000
208620                                                                  20862000
208630 P8344-CK-WHICH-STMT-REQUEST.                                     20863000
208640     IF PROC-DSS                                                  20864000
208650         GO TO P8346-DSS-REQUEST.                                 20865000
208660     MOVE 012 TO HOLD-REPORT-CODE.                                20866000
208670     GO TO P8348-FOUND-STMT-TYPE.                                 20867000
208680                                                                  20868000
208690 P8346-DSS-REQUEST.                                               20869000
208700     MOVE 082 TO HOLD-REPORT-CODE.                                20870000
208710     PERFORM P8610-BUILD-OSB-SAV-HEADER THRU P8619-EXIT.          20871000
208720     GO TO P8349-EXIT.                                            20872000
208730                                                                  20873000
208740 P8347-CK-NO-STMT.                                                20874000
208750     IF ACCOUNT-ID NOT = 010                                      20875000
208760         GO TO P8349-EXIT.                                        20876000
208770     IF CYCLE-THIS-STMT = 1                                       20877000
208780         MOVE 091 TO HOLD-REPORT-CODE                             20878000
208790       ELSE                                                       20879000
208800         MOVE 092 TO HOLD-REPORT-CODE.                            20880000
208810                                                                  20881000
208820 P8348-FOUND-STMT-TYPE.                                           20882000
208830     PERFORM P8590-BUILD-PD-HEADER THRU P8599-BUILD-PDH-EXIT.     20883000
208840                                                                  20884000
208850 P8349-EXIT.                                                      20885000
208860     EXIT.                                                        20886000
208870                                                                  20887000
208880******************************************************************20888000
208890* SUBROUTINE - D E C I D E S  S.C. S T A T E M E N T  N E E D E D*20889000
208900******************************************************************20890000
208910 P8350-CHECK-SC-STMT.                                             20891000
208920     IF SERV-CHRG-STMT-IND = '0'                                  20892000
208930         GO TO P8359-EXIT.                                        20893000
208940     IF PROC-DSS                                                  20894000
208950         GO TO P8359-EXIT.                                        20895000
208960     IF CYCLE-THIS-SC-EARN = 1                                    20896000
208970         MOVE 041 TO HOLD-REPORT-CODE                             20897000
208980       ELSE                                                       20898000
208990         MOVE 042 TO HOLD-REPORT-CODE.                            20899000
209000     PERFORM P8580-BUILD-SC-STMT-HDR THRU P8589-BUILD-SCH-EXIT.   20900000
209010     IF SERV-CHRG-STMT-IND = '2' OR '3'                           20901000
209020         GO TO P8359-EXIT.                                        20902000
209030     IF HOLD-REPORT-CODE = 042                                    20903000
209040         GO TO P8359-EXIT.                                        20904000
209050     MOVE ZEROS TO SUB7.                                          20905000
209060                                                                  20906000
209070 P8352-CHECK-SC-STMT-FEE.                                         20907000
209080     ADD 1 TO SUB7.                                               20908000
209090     IF SUB7 = 21                                                 20909000
209100         MOVE ZEROS TO SUB7                                       20910000
209110         GO TO P8359-EXIT.                                        20911000
209120     IF EXT-SC-TX-CODE (SUB7) NOT NUMERIC                         20912000
209130         GO TO P8352-CHECK-SC-STMT-FEE.                           20913000
209140     IF EXT-SC-TX-CODE (SUB7) = 135                               20914000
209150         GO TO P8354-BUILD-SC-STMT-FEE.                           20915000
209160     GO TO P8352-CHECK-SC-STMT-FEE.                               20916000
209170                                                                  20917000
209180 P8354-BUILD-SC-STMT-FEE.                                         20918000
209190     MOVE 1 TO DSDSTXL-PENDING-SW.                                20919000
209200     ADD 1 TO NUM-BILL-TX.                                        20920000
209210     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     20921000
209220     MOVE EXT-SC-FEE (SUB7) TO DSDSTXL-AMOUNT.                    20922000
209230     MOVE 135 TO DSDSTXL-CODE.                                    20923000
209240     MOVE 135 TO HOLD-TX-CODE-IN                                  20924000
209250     MOVE 1 TO DSDSTXL-ITEM-COUNT.                                20925000
209260     PERFORM P1250-EXT-SERV-CHRG-TXS THRU P1295-EXIT.             20926000
209270     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 20927000
209280                                                                  20928000
209290 P8359-EXIT.                                                      20929000
209300     EXIT.                                                        20930000
209310                                                                  20931000
209320******************************************************************20932000
209330* LOOKUP - SERVICE CHARGE CODE IN BANK CONTROL                   *20933000
209340******************************************************************20934000
209350 P8360-LOOKUP-SC-IN-BKCTL.                                        20935000
209360     MOVE SC-ROUTINE   TO SUB5.                                   20936000
209370                                                                  20937000
209380     MOVE PROC-BK-NO   TO BCFSCR-BANK-NBR.                        20938000
209390     MOVE PROC-FILE-ID TO BCFSCR-DSDS-ID.                         20939000
209400     MOVE SC-ROUTINE   TO BCFSCR-SC-CODE.                         20940000
209410     EXEC SQL                                                     20941000
209420         SELECT                                                   20942000
209430             BCFSCR_EARN_RATE,                                    20943000
209440             BCFSCR_OD_RATE,                                      20944000
209450             BCFSCR_BALANCE_CODE,                                 20945000
209460             BCFSCR_DEBIT_CHG_1,                                  20946000
209470             BCFSCR_DEBIT_CHG_2,                                  20947000
209480             BCFSCR_DEBIT_CHG_3,                                  20948000
209490             BCFSCR_DEBIT_CHG_RDC,                                20949000
209500             BCFSCR_NO_FREE_WITHD,                                20950000
209510             BCFSCR_SC_ACCT_TYPE,                                 20951000
209520             BCFSCR_MIN_INT_AMT,                                  20952000
209530             BCFSCR_ACCT_ANAL_RTN_IND,                            20953000
209540             BCFSCR_OSB_SERV_CHRG_DESC_IND,                       20954000
209550             BCFSCR_OSB_SERV_CHRG_DESC,                           20955000
209560             BCFSCR_ACCT_ANAL_EARN_CREDIT                         20956000
209570         INTO                                                     20957000
209580            :BCFSCR-EARN-RATE,                                    20958000
209590            :BCFSCR-OD-RATE,                                      20959000
209600            :BCFSCR-BALANCE-CODE,                                 20960000
209610            :BCFSCR-DEBIT-CHG-1,                                  20961000
209620            :BCFSCR-DEBIT-CHG-2,                                  20962000
209630            :BCFSCR-DEBIT-CHG-3,                                  20963000
209640            :BCFSCR-DEBIT-CHG-RDC,                                20964000
209650            :BCFSCR-NO-FREE-WITHD,                                20965000
209660            :BCFSCR-SC-ACCT-TYPE,                                 20966000
209670            :BCFSCR-MIN-INT-AMT,                                  20967000
209680            :BCFSCR-ACCT-ANAL-RTN-IND,                            20968000
209690            :BCFSCR-OSB-SERV-CHRG-DESC-IND,                       20969000
209700            :BCFSCR-OSB-SERV-CHRG-DESC,                           20970000
209710            :BCFSCR-ACCT-ANAL-EARN-CREDIT                         20971000
209720         FROM DSDS.BCFSCR                                         20972000
209730         WHERE BCFSCR_BANK_NBR = :BCFSCR-BANK-NBR                 20973000
209740           AND BCFSCR_DSDS_ID  = :BCFSCR-DSDS-ID                  20974000
209750           AND BCFSCR_SC_CODE  = :BCFSCR-SC-CODE                  20975000
209760     END-EXEC.                                                    20976000
209770     EVALUATE SQLCODE                                             20977000
209780         WHEN ZEROS                                               20978000
209790             CONTINUE                                             20979000
209800         WHEN +100                                                20980000
209810             DISPLAY 'BANK NO. '      BCF-BANK-NO                 20981000
209820                     ' ACCOUNT I.D. ' ACCOUNT-ID                  20982000
209830                     ' S.C.ROUTINE '  SC-ROUTINE                  20983000
209840                     ' NOT FOUND IN BANK CTL.'                    20984000
209850             CALL 'CDCUT90' USING SQLCA                           20985000
209860             CALL 'CDCDUMP' USING BY CONTENT '2103'               20986000
209870         WHEN OTHER                                               20987000
209880             CALL 'CDCUT90' USING SQLCA                           20988000
209890             CALL 'CDCDUMP' USING BY CONTENT '2104'               20989000
209900     END-EVALUATE.                                                20990000
209910 P8369-EXIT.                                                      20991000
209920     EXIT.                                                        20992000
209930                                                                  20993000
209940******************************************************************20994000
209950* SUBROUTINE - D E C I D E S  H I S T O R Y  C A R D  N E E D E D*20995000
209960******************************************************************20996000
209970 P8370-CHECK-HIST-HDR.                                            20997000
209980     IF CYCLE-THIS-HC = 1                                         20998000
209990         MOVE 445 TO HOLD-REPORT-CODE                             20999000
210000       ELSE                                                       21000000
210010         MOVE 446 TO HOLD-REPORT-CODE.                            21001000
210020     PERFORM P8600-BUILD-HC-HEADER THRU P8609-BUILD-HCH-EXIT.     21002000
210030                                                                  21003000
210040 P8379-EXIT.                                                      21004000
210050     EXIT.                                                        21005000
210060                                                                  21006000
210070******************************************************************21007000
210080* SUBROUTINE - I N S U F F I C I E N T  N O T I C E  R P T.      *21008000
210090******************************************************************21009000
210100 P8380-BUILD-NSF-REC.                                             21010000
210110     IF BANK-CTL-ACCTS                                            21011000
210120         GO TO P8382-EXIT.                                        21012000
210130     MOVE 094 TO SUB1.                                            21013000
210140     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               21014000
210150     IF HOLD-FREQ-RPT = 0                                         21015000
210160         GO TO P8382-EXIT.                                        21016000
210170     MOVE SPACES TO SPECIAL-WORK.                                 21017000
210180     MOVE 094 TO IN-REPORT-CODE.                                  21018000
210190     MOVE PROC-FILE-ID TO IN-FILE-ID.                             21019000
210200     MOVE BCF-BANK-NO TO IN-BANK-NO.                              21020000
210210     MOVE ACCOUNT-ID TO IN-ACCT-ID.                               21021000
210220     MOVE ACCOUNT-NUMBER TO IN-ACCT-NO.                           21022000
210230     MOVE LOW-VALUES TO IN-CRF-REC-ID.                            21023000
210240     MOVE CURRENT-BALANCE TO IN-CURR-BAL.                         21024000
210250     IF HOLD-UI-REASON = 02                                       21025000
210260         MOVE 00 TO HOLD-UI-REASON                                21026000
210270         MOVE ZEROS TO IN-ITEM-CHARGE                             21027000
210280         MOVE 'H' TO IN-HOLD-IND                                  21028000
210290       ELSE                                                       21029000
210300         MOVE WORK-OD-FEE      TO IN-ITEM-CHARGE.                 21030000
210310     MOVE DSDSTXL-AMOUNT TO IN-TX-AMT.                            21031000
210320     IF SC-ITEM-CHG OR FEE-PER-DAY                                21032000
210330         MOVE ZEROS TO IN-ITEM-CHARGE.                            21033000
210340     IF INSF-CNT = 1                                              21034000
210350         MOVE 001 TO IN-CONTINUATION                              21035000
210360       ELSE                                                       21036000
210370         MOVE 002 TO IN-CONTINUATION.                             21037000
210380     IF DSDSTXL-CHK-NO = PROC-CURR-DATE                           21038000
210390         MOVE ZEROS TO IN-CHK-NO                                  21039000
210400       ELSE                                                       21040000
210410         MOVE DSDSTXL-CHK-NO TO IN-CHK-NO.                        21041000
210420                                                                  21042000
210430 P8382-EXIT.                                                      21043000
210440     EXIT.                                                        21044000
210450                                                                  21045000
210460 P8385-WRITE-NSF.                                                 21046000
210470     IF BANK-CTL-ACCTS                                            21047000
210480         GO TO P8389-BUILD-NSF-EXIT.                              21048000
210490     IF HOLD-FREQ-RPT = 0                                         21049000
210500         GO TO P8389-BUILD-NSF-EXIT.                              21050000
210510     MOVE 1 TO INSF-NOTICE-SW.                                    21051000
210520     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           21052000
210530                                                                  21053000
210540 P8389-BUILD-NSF-EXIT.                                            21054000
210550     EXIT.                                                        21055000
210560                                                                  21056000
210570******************************************************************21057000
210580* C H A N G E   O D   A C C E S S   L I M I T                    *21058000
210590******************************************************************21059000
210600 P8400-CHANGE-OD-ACCESS-LIMIT.                                    21060000
210610     IF OA-PENDING OR                                             21061000
210620        OA-REVIEW OR                                              21062000
210630        OA-ACTIVE-30-90 OR                                        21063000
210640        OA-ACTIVE                                                 21064000
210650         NEXT SENTENCE                                            21065000
210660       ELSE                                                       21066000
210670         GO TO P8409-EXIT.                                        21067000
210680     CALL 'DSDM105' USING DSDM105-PARAMETERS                      21068000
210690                          PROCESS-WORK                            21069000
210700                          DSDS-MASTER-RECORD                      21070000
210710                          DSDS-HISTORY-RECORD                     21071000
210720                          DSDS-BCF-RECORD.                        21072000
210730                                                                  21073000
210740 P8402-CHECK-CODE.                                                21074000
210750     IF DSDM105-OLD-CODE = DSDM105-NEW-CODE                       21075000
210760         GO TO P8404-CHECK-LIMIT.                                 21076000
210770     INITIALIZE CHANGE-LOG-WORK.                                  21077000
210780     MOVE DSDS-BANK-NO      TO CLW-BANK-NBR.                      21078000
210790     MOVE DSDS-ACCOUNT-ID   TO CLW-ACCT-ID.                       21079000
210800     MOVE DSDS-ACCOUNT-NO   TO CLW-ACCT-NBR.                      21080000
210810     MOVE 191               TO CLW-FIELD-CODE.                    21081000
210820     MOVE DSDM105-OLD-CODE  TO CLW-OLD-ACCESS-CODE                21082000
210830     MOVE DSDM105-NEW-CODE  TO CLW-NEW-ACCESS-CODE                21083000
210840                               OD-ACCESS-CODE.                    21084000
210850     MOVE DSDM105-NEW-CODE  TO HOLD-OLD-ACCESS-CODE               21085000
210860     MOVE PROC-CURR-DATE    TO DSDS-LAST-MAINT-DATE.              21086000
210870     MOVE 'Y'               TO CLW-EXTRACT-IND.                   21087000
210880     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     21088000
210890                                                                  21089000
210900 P8404-CHECK-LIMIT.                                               21090000
210910     IF DSDM105-OLD-LIMIT = DSDM105-NEW-LIMIT                     21091000
210920         GO TO P8409-EXIT.                                        21092000
210930     INITIALIZE CHANGE-LOG-WORK.                                  21093000
210940     MOVE DSDS-BANK-NO      TO CLW-BANK-NBR.                      21094000
210950     MOVE DSDS-ACCOUNT-ID   TO CLW-ACCT-ID.                       21095000
210960     MOVE DSDS-ACCOUNT-NO   TO CLW-ACCT-NBR.                      21096000
210970     MOVE 192               TO CLW-FIELD-CODE.                    21097000
210980     MOVE DSDM105-OLD-LIMIT TO CLW-OLD-ACCESS-LIMIT               21098000
210990     MOVE DSDM105-NEW-LIMIT TO CLW-NEW-ACCESS-LIMIT               21099000
211000                               OD-ACCESS-LIMIT.                   21100000
211010     MOVE DSDM105-NEW-LIMIT TO HOLD-NEW-ACCESS-LIMIT              21101000
211020     MOVE PROC-CURR-DATE    TO DSDS-LAST-MAINT-DATE.              21102000
211030     MOVE 'Y'               TO CLW-EXTRACT-IND.                   21103000
211040     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     21104000
211050                                                                  21105000
211060 P8409-EXIT.                                                      21106000
211070     EXIT.                                                        21107000
211080                                                                  21108000
211090******************************************************************21109000
211100*            B U I L D  I N T E R E S T  T R A N S A C T I O N   *21110000
211110******************************************************************21111000
211120 P8410-BUILD-INT-TX.                                              21112000
211130     IF HOLD-EARNINGS = ZERO                                      21113000
211140         GO TO P8419-EXIT.                                        21114000
211150     MOVE 1 TO DSDSTXL-PENDING-SW.                                21115000
211160     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     21116000
211170     MOVE 640 TO DSDSTXL-CODE.                                    21117000
211180     IF EARNINGS-CODE = +039 AND CASH-MANAGEMENT-SWEEP            21118000
211190         MOVE OSB-DESC-0082-A TO DSDSTXL-CO-DESC                  21119000
211200         MOVE OSB-DESC-0082-B TO DSDSTXL-DESC                     21120000
211210       ELSE                                                       21121000
211220         MOVE OSB-DESC-0053-A TO DSDSTXL-CO-DESC                  21122000
211230         MOVE OSB-DESC-0053-B TO DSDSTXL-DESC.                    21123000
211240     MOVE HOLD-EARNINGS TO DSDSTXL-AMOUNT.                        21124000
211250     ADD DSDSTXL-AMOUNT TO CURR-NET-COLL-BAL.                     21125000
211260     ADD DSDSTXL-AMOUNT TO GEN-CREDIT-AMT.                        21126000
211270     ADD 1 TO GEN-CREDIT-CNT.                                     21127000
211280     ADD 1 TO NUM-BILL-TX.                                        21128000
211290     IF IMM-ACCOUNT                                               21129000
211300         MOVE 'IMI' TO PJ-HOLD-CODE                               21130000
211310         GO TO P8412-CONT-INT-TX.                                 21131000
211320     IF CMM-ACCOUNT                                               21132000
211330         MOVE 'CMI' TO PJ-HOLD-CODE                               21133000
211340         GO TO P8412-CONT-INT-TX.                                 21134000
211350     MOVE 'INT' TO PJ-HOLD-CODE.                                  21135000
211360                                                                  21136000
211370 P8412-CONT-INT-TX.                                               21137000
211380     PERFORM P1325-NORM-CR-2.                                     21138000
211390     PERFORM P1800-CHK-WITHHOLD-STAT THRU P1809-EXIT.             21139000
211400     IF NOT-IN-WITHHOLD-STATUS                                    21140000
211410         GO TO P8414-END-INT-TX.                                  21141000
211420     MOVE ZEROS TO IRSPL-GROUP-ID.                                21142000
211430     PERFORM P1810-POST-CYCLE-EARN-WH THRU P1819-EXIT.            21143000
211440     IF HOLD-TAX-WITHHELD = ZERO                                  21144000
211450         GO TO P8414-END-INT-TX.                                  21145000
211460     MOVE HOLD-TAX-WITHHELD TO DSDSTXL-AMOUNT.                    21146000
211470     MOVE 801 TO DSDSTXL-CODE.                                    21147000
211480     MOVE OSB-DESC-0054-A TO DSDSTXL-CO-DESC.                     21148000
211490     MOVE OSB-DESC-0054-B TO DSDSTXL-DESC.                        21149000
211500     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                21150000
211510     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       21151000
211520     MOVE ZEROS TO DSDSTXL-ENCL-TYPE DSDSTXL-SC-TYPE.             21152000
211530     ADD DSDSTXL-AMOUNT TO GEN-DEBIT-AMT.                         21153000
211540     SUBTRACT DSDSTXL-AMOUNT FROM CURR-NET-COLL-BAL.              21154000
211550     ADD 1 TO GEN-DEBIT-CNT                                       21155000
211560              NUM-BILL-TX.                                        21156000
211570     PERFORM P1665-NORM-DEBIT.                                    21157000
211580                                                                  21158000
211590 P8414-END-INT-TX.                                                21159000
211600     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 21160000
211610                                                                  21161000
211620 P8419-EXIT.                                                      21162000
211630     EXIT.                                                        21163000
211640                                                                  21164000
211650******************************************************************21165000
211660*  E X T E R N A L   S E R V I C E   C H A R G E   T O T A L S   *21166000
211670******************************************************************21167000
211680 P8420-ADD-TO-XSC-TOTALS.                                         21168000
211690     MOVE ZEROS TO HOLD-NUM-HARD-CHRGS                            21169000
211700                   HOLD-AMT-HARD-CHRGS                            21170000
211710                   HOLD-NUM-EXT-CHRGS                             21171000
211720                   HOLD-AMT-EXT-CHRGS.                            21172000
211730     IF SUB15 LESS THAN 11                                        21173000
211740         MOVE SUB15 TO SUB6                                       21174000
211750         ADD NUM-HARD-CHRGS (SUB15) TO HARD-101-110-CNT (SUB6)    21175000
211760         ADD AMT-HARD-CHRGS (SUB15) TO HARD-101-110-AMT (SUB6)    21176000
211770         MOVE HARD-101-110-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21177000
211780         MOVE HARD-101-110-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21178000
211790         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-101-110-CNT (SUB6)     21179000
211800         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-101-110-AMT (SUB6)     21180000
211810         MOVE SOFT-101-110-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21181000
211820         MOVE SOFT-101-110-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21182000
211830         GO TO P8425-ADD.                                         21183000
211840     IF SUB15 LESS THAN 21                                        21184000
211850         SUBTRACT 10 FROM SUB15 GIVING SUB6                       21185000
211860         ADD NUM-HARD-CHRGS (SUB15) TO HARD-111-120-CNT (SUB6)    21186000
211870         ADD AMT-HARD-CHRGS (SUB15) TO HARD-111-120-AMT (SUB6)    21187000
211880         MOVE HARD-111-120-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21188000
211890         MOVE HARD-111-120-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21189000
211900         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-111-120-CNT (SUB6)     21190000
211910         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-111-120-AMT (SUB6)     21191000
211920         MOVE SOFT-111-120-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21192000
211930         MOVE SOFT-111-120-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21193000
211940         GO TO P8425-ADD.                                         21194000
211950     IF SUB15 LESS THAN 31                                        21195000
211960         SUBTRACT 20 FROM SUB15 GIVING SUB6                       21196000
211970         ADD NUM-HARD-CHRGS (SUB15) TO HARD-121-130-CNT (SUB6)    21197000
211980         ADD AMT-HARD-CHRGS (SUB15) TO HARD-121-130-AMT (SUB6)    21198000
211990         MOVE HARD-121-130-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21199000
212000         MOVE HARD-121-130-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21200000
212010         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-121-130-CNT (SUB6)     21201000
212020         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-121-130-AMT (SUB6)     21202000
212030         MOVE SOFT-121-130-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21203000
212040         MOVE SOFT-121-130-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21204000
212050         GO TO P8425-ADD.                                         21205000
212060     IF SUB15 LESS THAN 41                                        21206000
212070         SUBTRACT 30 FROM SUB15 GIVING SUB6                       21207000
212080         ADD NUM-HARD-CHRGS (SUB15) TO HARD-131-140-CNT (SUB6)    21208000
212090         ADD AMT-HARD-CHRGS (SUB15) TO HARD-131-140-AMT (SUB6)    21209000
212100         MOVE HARD-131-140-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21210000
212110         MOVE HARD-131-140-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21211000
212120         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-131-140-CNT (SUB6)     21212000
212130         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-131-140-AMT (SUB6)     21213000
212140         MOVE SOFT-131-140-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21214000
212150         MOVE SOFT-131-140-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21215000
212160         GO TO P8425-ADD.                                         21216000
212170     IF SUB15 LESS THAN 51                                        21217000
212180         SUBTRACT 40 FROM SUB15 GIVING SUB6                       21218000
212190         ADD NUM-HARD-CHRGS (SUB15) TO HARD-141-150-CNT (SUB6)    21219000
212200         ADD AMT-HARD-CHRGS (SUB15) TO HARD-141-150-AMT (SUB6)    21220000
212210         MOVE HARD-141-150-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21221000
212220         MOVE HARD-141-150-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21222000
212230         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-141-150-CNT (SUB6)     21223000
212240         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-141-150-AMT (SUB6)     21224000
212250         MOVE SOFT-141-150-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21225000
212260         MOVE SOFT-141-150-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21226000
212270         GO TO P8425-ADD.                                         21227000
212280     IF SUB15 LESS THAN 61                                        21228000
212290         SUBTRACT 50 FROM SUB15 GIVING SUB6                       21229000
212300         ADD NUM-HARD-CHRGS (SUB15) TO HARD-151-160-CNT (SUB6)    21230000
212310         ADD AMT-HARD-CHRGS (SUB15) TO HARD-151-160-AMT (SUB6)    21231000
212320         MOVE HARD-151-160-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21232000
212330         MOVE HARD-151-160-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21233000
212340         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-151-160-CNT (SUB6)     21234000
212350         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-151-160-AMT (SUB6)     21235000
212360         MOVE SOFT-151-160-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21236000
212370         MOVE SOFT-151-160-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21237000
212380         GO TO P8425-ADD.                                         21238000
212390     IF SUB15 LESS THAN 71                                        21239000
212400         SUBTRACT 60 FROM SUB15 GIVING SUB6                       21240000
212410         ADD NUM-HARD-CHRGS (SUB15) TO HARD-161-170-CNT (SUB6)    21241000
212420         ADD AMT-HARD-CHRGS (SUB15) TO HARD-161-170-AMT (SUB6)    21242000
212430         MOVE HARD-161-170-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21243000
212440         MOVE HARD-161-170-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21244000
212450         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-161-170-CNT (SUB6)     21245000
212460         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-161-170-AMT (SUB6)     21246000
212470         MOVE SOFT-161-170-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21247000
212480         MOVE SOFT-161-170-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21248000
212490         GO TO P8425-ADD.                                         21249000
212500     IF SUB15 LESS THAN 81                                        21250000
212510         SUBTRACT 70 FROM SUB15 GIVING SUB6                       21251000
212520         ADD NUM-HARD-CHRGS (SUB15) TO HARD-171-180-CNT (SUB6)    21252000
212530         ADD AMT-HARD-CHRGS (SUB15) TO HARD-171-180-AMT (SUB6)    21253000
212540         MOVE HARD-171-180-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21254000
212550         MOVE HARD-171-180-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21255000
212560         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-171-180-CNT (SUB6)     21256000
212570         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-171-180-AMT (SUB6)     21257000
212580         MOVE SOFT-171-180-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21258000
212590         MOVE SOFT-171-180-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21259000
212600         GO TO P8425-ADD.                                         21260000
212610     IF SUB15 LESS THAN 91                                        21261000
212620         SUBTRACT 80 FROM SUB15 GIVING SUB6                       21262000
212630         ADD NUM-HARD-CHRGS (SUB15) TO HARD-181-190-CNT (SUB6)    21263000
212640         ADD AMT-HARD-CHRGS (SUB15) TO HARD-181-190-AMT (SUB6)    21264000
212650         MOVE HARD-181-190-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21265000
212660         MOVE HARD-181-190-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21266000
212670         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-181-190-CNT (SUB6)     21267000
212680         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-181-190-AMT (SUB6)     21268000
212690         MOVE SOFT-181-190-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21269000
212700         MOVE SOFT-181-190-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21270000
212710         GO TO P8425-ADD.                                         21271000
212720     IF SUB15 LESS THAN 101                                       21272000
212730         SUBTRACT 90 FROM SUB15 GIVING SUB6                       21273000
212740         ADD NUM-HARD-CHRGS (SUB15) TO HARD-191-200-CNT (SUB6)    21274000
212750         ADD AMT-HARD-CHRGS (SUB15) TO HARD-191-200-AMT (SUB6)    21275000
212760         MOVE HARD-191-200-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21276000
212770         MOVE HARD-191-200-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21277000
212780         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-191-200-CNT (SUB6)     21278000
212790         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-191-200-AMT (SUB6)     21279000
212800         MOVE SOFT-191-200-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21280000
212810         MOVE SOFT-191-200-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21281000
212820         GO TO P8425-ADD.                                         21282000
212830     IF SUB15 LESS THAN 111                                       21283000
212840         SUBTRACT 100 FROM SUB15 GIVING SUB6                      21284000
212850         ADD NUM-HARD-CHRGS (SUB15) TO HARD-201-210-CNT (SUB6)    21285000
212860         ADD AMT-HARD-CHRGS (SUB15) TO HARD-201-210-AMT (SUB6)    21286000
212870         MOVE HARD-201-210-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21287000
212880         MOVE HARD-201-210-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21288000
212890         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-201-210-CNT (SUB6)     21289000
212900         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-201-210-AMT (SUB6)     21290000
212910         MOVE SOFT-201-210-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21291000
212920         MOVE SOFT-201-210-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21292000
212930         GO TO P8425-ADD.                                         21293000
212940     IF SUB15 LESS THAN 121                                       21294000
212950         SUBTRACT 110 FROM SUB15 GIVING SUB6                      21295000
212960         ADD NUM-HARD-CHRGS (SUB15) TO HARD-211-220-CNT (SUB6)    21296000
212970         ADD AMT-HARD-CHRGS (SUB15) TO HARD-211-220-AMT (SUB6)    21297000
212980         MOVE HARD-211-220-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21298000
212990         MOVE HARD-211-220-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21299000
213000         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-211-220-CNT (SUB6)     21300000
213010         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-211-220-AMT (SUB6)     21301000
213020         MOVE SOFT-211-220-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21302000
213030         MOVE SOFT-211-220-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21303000
213040         GO TO P8425-ADD.                                         21304000
213050     IF SUB15 LESS THAN 131                                       21305000
213060         SUBTRACT 120 FROM SUB15 GIVING SUB6                      21306000
213070         ADD NUM-HARD-CHRGS (SUB15) TO HARD-221-230-CNT (SUB6)    21307000
213080         ADD AMT-HARD-CHRGS (SUB15) TO HARD-221-230-AMT (SUB6)    21308000
213090         MOVE HARD-221-230-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21309000
213100         MOVE HARD-221-230-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21310000
213110         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-221-230-CNT (SUB6)     21311000
213120         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-221-230-AMT (SUB6)     21312000
213130         MOVE SOFT-221-230-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21313000
213140         MOVE SOFT-221-230-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21314000
213150         GO TO P8425-ADD.                                         21315000
213160     IF SUB15 LESS THAN 141                                       21316000
213170         SUBTRACT 130 FROM SUB15 GIVING SUB6                      21317000
213180         ADD NUM-HARD-CHRGS (SUB15) TO HARD-231-240-CNT (SUB6)    21318000
213190         ADD AMT-HARD-CHRGS (SUB15) TO HARD-231-240-AMT (SUB6)    21319000
213200         MOVE HARD-231-240-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21320000
213210         MOVE HARD-231-240-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21321000
213220         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-231-240-CNT (SUB6)     21322000
213230         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-231-240-AMT (SUB6)     21323000
213240         MOVE SOFT-231-240-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21324000
213250         MOVE SOFT-231-240-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21325000
213260         GO TO P8425-ADD.                                         21326000
213270     IF SUB15 LESS THAN 151                                       21327000
213280         SUBTRACT 140 FROM SUB15 GIVING SUB6                      21328000
213290         ADD NUM-HARD-CHRGS (SUB15) TO HARD-241-250-CNT (SUB6)    21329000
213300         ADD AMT-HARD-CHRGS (SUB15) TO HARD-241-250-AMT (SUB6)    21330000
213310         MOVE HARD-241-250-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21331000
213320         MOVE HARD-241-250-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21332000
213330         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-241-250-CNT (SUB6)     21333000
213340         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-241-250-AMT (SUB6)     21334000
213350         MOVE SOFT-241-250-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21335000
213360         MOVE SOFT-241-250-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21336000
213370         GO TO P8425-ADD.                                         21337000
213380     IF SUB15 LESS THAN 161                                       21338000
213390         SUBTRACT 150 FROM SUB15 GIVING SUB6                      21339000
213400         ADD NUM-HARD-CHRGS (SUB15) TO HARD-251-260-CNT (SUB6)    21340000
213410         ADD AMT-HARD-CHRGS (SUB15) TO HARD-251-260-AMT (SUB6)    21341000
213420         MOVE HARD-251-260-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21342000
213430         MOVE HARD-251-260-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21343000
213440         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-251-260-CNT (SUB6)     21344000
213450         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-251-260-AMT (SUB6)     21345000
213460         MOVE SOFT-251-260-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21346000
213470         MOVE SOFT-251-260-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21347000
213480         GO TO P8425-ADD.                                         21348000
213490     IF SUB15 LESS THAN 171                                       21349000
213500         SUBTRACT 160 FROM SUB15 GIVING SUB6                      21350000
213510         ADD NUM-HARD-CHRGS (SUB15) TO HARD-261-270-CNT (SUB6)    21351000
213520         ADD AMT-HARD-CHRGS (SUB15) TO HARD-261-270-AMT (SUB6)    21352000
213530         MOVE HARD-261-270-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21353000
213540         MOVE HARD-261-270-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21354000
213550         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-261-270-CNT (SUB6)     21355000
213560         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-261-270-AMT (SUB6)     21356000
213570         MOVE SOFT-261-270-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21357000
213580         MOVE SOFT-261-270-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21358000
213590         GO TO P8425-ADD.                                         21359000
213600     IF SUB15 LESS THAN 181                                       21360000
213610         SUBTRACT 170 FROM SUB15 GIVING SUB6                      21361000
213620         ADD NUM-HARD-CHRGS (SUB15) TO HARD-271-280-CNT (SUB6)    21362000
213630         ADD AMT-HARD-CHRGS (SUB15) TO HARD-271-280-AMT (SUB6)    21363000
213640         MOVE HARD-271-280-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21364000
213650         MOVE HARD-271-280-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21365000
213660         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-271-280-CNT (SUB6)     21366000
213670         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-271-280-AMT (SUB6)     21367000
213680         MOVE SOFT-271-280-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21368000
213690         MOVE SOFT-271-280-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21369000
213700         GO TO P8425-ADD.                                         21370000
213710     IF SUB15 LESS THAN 191                                       21371000
213720         SUBTRACT 180 FROM SUB15 GIVING SUB6                      21372000
213730         ADD NUM-HARD-CHRGS (SUB15) TO HARD-281-290-CNT (SUB6)    21373000
213740         ADD AMT-HARD-CHRGS (SUB15) TO HARD-281-290-AMT (SUB6)    21374000
213750         MOVE HARD-281-290-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21375000
213760         MOVE HARD-281-290-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21376000
213770         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-281-290-CNT (SUB6)     21377000
213780         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-281-290-AMT (SUB6)     21378000
213790         MOVE SOFT-281-290-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21379000
213800         MOVE SOFT-281-290-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21380000
213810         GO TO P8425-ADD.                                         21381000
213820     IF SUB15 LESS THAN 201                                       21382000
213830         SUBTRACT 190 FROM SUB15 GIVING SUB6                      21383000
213840         ADD NUM-HARD-CHRGS (SUB15) TO HARD-291-300-CNT (SUB6)    21384000
213850         ADD AMT-HARD-CHRGS (SUB15) TO HARD-291-300-AMT (SUB6)    21385000
213860         MOVE HARD-291-300-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21386000
213870         MOVE HARD-291-300-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21387000
213880         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-291-300-CNT (SUB6)     21388000
213890         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-291-300-AMT (SUB6)     21389000
213900         MOVE SOFT-291-300-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21390000
213910         MOVE SOFT-291-300-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21391000
213920         GO TO P8425-ADD.                                         21392000
213930     IF SUB15 LESS THAN 211                                       21393000
213940         SUBTRACT 200 FROM SUB15 GIVING SUB6                      21394000
213950         ADD NUM-HARD-CHRGS (SUB15) TO HARD-301-310-CNT (SUB6)    21395000
213960         ADD AMT-HARD-CHRGS (SUB15) TO HARD-301-310-AMT (SUB6)    21396000
213970         MOVE HARD-301-310-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21397000
213980         MOVE HARD-301-310-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21398000
213990         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-301-310-CNT (SUB6)     21399000
214000         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-301-310-AMT (SUB6)     21400000
214010         MOVE SOFT-301-310-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21401000
214020         MOVE SOFT-301-310-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21402000
214030         GO TO P8425-ADD.                                         21403000
214040     IF SUB15 LESS THAN 221                                       21404000
214050         SUBTRACT 210 FROM SUB15 GIVING SUB6                      21405000
214060         ADD NUM-HARD-CHRGS (SUB15) TO HARD-311-320-CNT (SUB6)    21406000
214070         ADD AMT-HARD-CHRGS (SUB15) TO HARD-311-320-AMT (SUB6)    21407000
214080         MOVE HARD-311-320-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21408000
214090         MOVE HARD-311-320-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21409000
214100         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-311-320-CNT (SUB6)     21410000
214110         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-311-320-AMT (SUB6)     21411000
214120         MOVE SOFT-311-320-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21412000
214130         MOVE SOFT-311-320-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21413000
214140         GO TO P8425-ADD.                                         21414000
214150     IF SUB15 LESS THAN 231                                       21415000
214160         SUBTRACT 220 FROM SUB15 GIVING SUB6                      21416000
214170         ADD NUM-HARD-CHRGS (SUB15) TO HARD-321-330-CNT (SUB6)    21417000
214180         ADD AMT-HARD-CHRGS (SUB15) TO HARD-321-330-AMT (SUB6)    21418000
214190         MOVE HARD-321-330-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21419000
214200         MOVE HARD-321-330-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21420000
214210         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-321-330-CNT (SUB6)     21421000
214220         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-321-330-AMT (SUB6)     21422000
214230         MOVE SOFT-321-330-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21423000
214240         MOVE SOFT-321-330-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21424000
214250         GO TO P8425-ADD.                                         21425000
214260     IF SUB15 LESS THAN 241                                       21426000
214270         SUBTRACT 230 FROM SUB15 GIVING SUB6                      21427000
214280         ADD NUM-HARD-CHRGS (SUB15) TO HARD-331-340-CNT (SUB6)    21428000
214290         ADD AMT-HARD-CHRGS (SUB15) TO HARD-331-340-AMT (SUB6)    21429000
214300         MOVE HARD-331-340-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21430000
214310         MOVE HARD-331-340-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21431000
214320         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-331-340-CNT (SUB6)     21432000
214330         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-331-340-AMT (SUB6)     21433000
214340         MOVE SOFT-331-340-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21434000
214350         MOVE SOFT-331-340-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21435000
214360         GO TO P8425-ADD.                                         21436000
214370     IF SUB15 LESS THAN 251                                       21437000
214380         SUBTRACT 240 FROM SUB15 GIVING SUB6                      21438000
214390         ADD NUM-HARD-CHRGS (SUB15) TO HARD-341-350-CNT (SUB6)    21439000
214400         ADD AMT-HARD-CHRGS (SUB15) TO HARD-341-350-AMT (SUB6)    21440000
214410         MOVE HARD-341-350-CNT (SUB6) TO HOLD-NUM-HARD-CHRGS      21441000
214420         MOVE HARD-341-350-AMT (SUB6) TO HOLD-AMT-HARD-CHRGS      21442000
214430         ADD NUM-EXT-CHRGS (SUB15) TO SOFT-341-350-CNT (SUB6)     21443000
214440         ADD AMT-EXT-CHRGS (SUB15) TO SOFT-341-350-AMT (SUB6)     21444000
214450         MOVE SOFT-341-350-CNT (SUB6) TO HOLD-NUM-EXT-CHRGS       21445000
214460         MOVE SOFT-341-350-AMT (SUB6) TO HOLD-AMT-EXT-CHRGS       21446000
214470         GO TO P8425-ADD.                                         21447000
214480                                                                  21448000
214490 P8425-ADD.                                                       21449000
214500     ADD HOLD-NUM-EXT-CHRGS TO TOT-NUM-EXT-CHRGS.                 21450000
214510     ADD HOLD-AMT-EXT-CHRGS TO TOT-AMT-EXT-CHRGS.                 21451000
214520     ADD HOLD-NUM-HARD-CHRGS TO TOT-NUM-HARD-CHRGS.               21452000
214530     ADD HOLD-AMT-HARD-CHRGS TO TOT-AMT-HARD-CHRGS.               21453000
214540                                                                  21454000
214550 P8429-EXIT.                                                      21455000
214560     EXIT.                                                        21456000
214570                                                                  21457000
214580******************************************************************21458000
214590* LOOKUP - EARNINGS INFO IN BANK CONTROL FILE                    *21459000
214600******************************************************************21460000
214610 P8430-LOOKUP-EARN-IN-BCF.                                        21461000
214620     MOVE EARNINGS-CODE TO SUB18.                                 21462000
214630     IF EARNINGS-CODE = EARN-RTN (SUB18)                          21463000
214640         GO TO P8439-EXIT.                                        21464000
214650     DISPLAY 'BANK NO. ' BCF-BANK-NO ' ACCOUNT I.D. ' ACCOUNT-ID  21465000
214660         ' EARN ROUTINE ' EARNINGS-CODE ' NOT FOUND IN BANK CTL.' 21466000
214670             UPON CONSOLE.                                        21467000
214680     CALL 'CDCDUMP' USING BY CONTENT '2105'.                      21468000
214690                                                                  21469000
214700 P8439-EXIT.                                                      21470000
214710     EXIT.                                                        21471000
214720                                                                  21472000
214730******************************************************************21473000
214740*                B U I L D   N S F   F I L E   1                 *21474000
214750******************************************************************21475000
214760 P8440-BUILD-NSF-FILE-1.                                          21476000
214770     IF PROC-DSS                                                  21477000
214780         GO TO P8449-EXIT.                                        21478000
214790     IF NO-NSF-ONLINE                                             21479000
214800         GO TO P8449-EXIT.                                        21480000
214810                                                                  21481000
214820     MOVE DSDSTXL-BANK-NO TO NIP1-BANK-NBR.                       21482000
214830     MOVE DSDSTXL-ACCT-ID TO NIP1-ACCT-ID.                        21483000
214840     MOVE DSDSTXL-ACCT-NO TO NIP1-ACCT-NBR                        21484000
214850                             NIP1-ORIG-ACCT.                      21485000
214860     IF DSDSTXL-REGE-SW = SPACES                                  21486000
214870         MOVE REG-E-ATM-POS-SW TO DSDSTXL-REGE-SW                 21487000
214880     END-IF.                                                      21488000
214890     ADD 1 TO NIP1-SEQ-NBR.                                       21489000
214900     MOVE DSDSTXL-CODE TO NIP1-TX-CODE.                           21490000
214910     MOVE DSDSTXL-AMOUNT TO NIP1-TX-AMT.                          21491000
214920     IF HOLD-UI-REASON = 07 OR 14 OR 15                           21492000
214930         MOVE SPACES TO NIP1-SHORT-NAME                           21493000
214940         MOVE ZEROS TO NIP1-CURR-BAL                              21494000
214950       ELSE                                                       21495000
214960         MOVE 1 TO NSF-FILE-1-SW                                  21496000
214970         MOVE SHORT-NAME TO NIP1-SHORT-NAME                       21497000
214980         MOVE CURRENT-BALANCE TO NIP1-CURR-BAL.                   21498000
214990     MOVE HOLD-UI-REASON TO NIP1-REASON-CODE.                     21499000
215000     IF HOLD-UI-REASON = 00                                       21500000
215010         MOVE SPACES TO NIP1-REASON                               21501000
215020       ELSE                                                       21502000
215030         MOVE HOLD-UI-REASON TO X3                                21503000
215040         MOVE REASON (X3) TO NIP1-REASON.                         21504000
215050     IF DSDSTXL-CHK-NO = PROC-CURR-DATE                           21505000
215060         MOVE ZERO TO NIP1-SERIAL-NBR                             21506000
215070       ELSE                                                       21507000
215080         MOVE DSDSTXL-CHK-NO TO NIP1-SERIAL-NBR.                  21508000
215090     IF POST-OD                                                   21509000
215100         MOVE 'Y' TO NIP1-PAY-IND                                 21510000
215110       ELSE                                                       21511000
215120         MOVE 'N' TO NIP1-PAY-IND.                                21512000
215130     IF HOLD-UI-REASON = 01                                       21513000
215140         MOVE 'Y' TO NIP1-CHRG-IND                                21514000
215150       ELSE                                                       21515000
215160         MOVE 'N' TO NIP1-CHRG-IND.                               21516000
215170     MOVE 'N' TO NIP1-MANUAL-IND.                                 21517000
215180                                                                  21518000
215190     IF DSDSTXL-CODE = 773 OR 775 OR 776 OR 777 OR 778 OR 779     21519000
215200          OR 780 OR 853 OR 920 OR 922 OR 924 OR 925 OR 926        21520002
215210         IF HOLD-UI-REASON = 01                                   21521000
215220             MOVE 'Y' TO NIP1-PAY-IND                             21522000
215230             MOVE 'Y' TO NIP1-CHRG-IND                            21523000
215240         END-IF                                                   21524000
215250         IF HOLD-UI-REASON = 02                                   21525000
215260             MOVE 'Y' TO NIP1-PAY-IND                             21526000
215270             MOVE 'Z' TO NIP1-CHRG-IND                            21527000
215280             GO TO P8442-CONTINUE                                 21528000
215290         END-IF                                                   21529000
215300     ELSE                                                         21530000
215310         GO TO P8442-CONTINUE                                     21531000
215320     END-IF.                                                      21532000
215330                                                                  21533000
215340     IF REGE-TX                                                   21534000
215350         CONTINUE                                                 21535000
215360     ELSE                                                         21536000
215370         GO TO P8442-CONTINUE                                     21537000
215380     END-IF.                                                      21538000
215390                                                                  21539000
215400     IF DSDSTXL-REGE-SW = 'I'                                     21540000
215410         CONTINUE                                                 21541000
215420     ELSE                                                         21542000
215430         MOVE 'Y' TO NIP1-PAY-IND                                 21543000
215440         MOVE 'X' TO NIP1-CHRG-IND                                21544000
215450     END-IF.                                                      21545000
215460 P8442-CONTINUE.                                                  21546000
215470     IF DSDSTXL-CODE = 585 OR 605 OR 614 OR 620                   21547000
215480         MOVE 'Y' TO NIP1-PAY-IND                                 21548000
215490         MOVE 'Z' TO NIP1-CHRG-IND                                21549000
215500     END-IF.                                                      21550000
215510     IF DSDSTXL-CODE = 775 OR 776 OR 777 OR 922 OR 926            21551000
215520         MOVE DSDSTXL-FOR-ATM-DESC TO NIP1-PAYEE                  21552000
215530       ELSE                                                       21553000
215540         MOVE SPACES TO NIP1-PAYEE.                               21554000
215550                                                                  21555000
215560     MOVE DSDSTXL-CO-DESC TO NIP1-DESC-16.                        21556000
215570     MOVE DSDSTXL-DESC TO NIP1-DESC-10.                           21557000
215580     MOVE DSDSTXL-DATE TO NIP1-TX-DATE.                           21558000
215590     MOVE SAVE-ENCL-SW-FOR-NIPS TO NIP1-ENCL-SW.                  21559000
215600     MOVE DSDSTXL-SC-TYPE TO NIP1-SC-ITEM.                        21560000
215610     MOVE DSDSTXL-FOR-ATM-DESC TO NIP1-FOR-ATM-DESC.              21561000
215620     MOVE DSDSTXL-POS-TX-DATE TO NIP1-POS-TX-DATE.                21562000
215630     MOVE DSDSTXL-POS-REF-NBR TO NIP1-POS-REF-NBR.                21563000
215640     MOVE DSDSTXL-ACH-PAR-NBR TO NIP1-ACH-PAR-NBR.                21564000
215650     MOVE DSDSTXL-ACH-STD-ENTRY-CLASS TO NIP1-ACH-STD-ENTRY-CLASS.21565000
215660     MOVE DSDSTXL-DESC-FORMAT TO NIP1-DESC-FORMAT.                21566000
215670     MOVE DSDSTXL-ACH-DISC-DATA TO NIP1-ACH-DISC-DATA.            21567000
215680     MOVE SPACES TO NIP1-ACH-RET-REASON.                          21568000
215690                                                                  21569000
215700     IF INSURED-CASH-SWEEP                                        21570000
215710         IF WIRE-TX-CODE                                          21571000
215720             MOVE 'Y' TO NIP1-PAY-IND                             21572000
215730             MOVE 'N' TO NIP1-CHRG-IND                            21573000
215740         END-IF                                                   21574000
215750     END-IF.                                                      21575000
215760                                                                  21576000
215770*** CANNOT CHARGE OD FEE FOR PREPAID CARD ACCOUNTS                21577000
215780     IF BCFSCR-PREPAID-CARD                                       21578000
215790         MOVE '3'     TO NIP1-CHRG-IND                            21579000
215800     END-IF.                                                      21580000
215810                                                                  21581000
215820     IF NIP1-CHRG-IND = 'Y'                                       21582000
215830         IF DSDSTXL-AMOUNT LESS THAN WORK-OD-MIN-TX-AMT           21583000
215840             MOVE '2' TO NIP1-CHRG-IND                            21584000
215850         END-IF                                                   21585000
215860     END-IF.                                                      21586000
215870     IF NIP1-CHRG-IND = 'Y'                                       21587000
215880         ADD 1 TO WORK-OD-COUNTER                                 21588000
215890     END-IF.                                                      21589000
215900                                                                  21590000
215910     IF WORK-OD-COUNTER GREATER THAN WORK-OD-LIMIT-PER-DAY        21591000
215920         MOVE '1' TO NIP1-CHRG-IND                                21592000
215930     END-IF.                                                      21593000
215940                                                                  21594000
215950     IF BCFSCR-PREPAID-CARD                                       21595000
215960         CONTINUE                                                 21596000
215970     ELSE                                                         21597000
215980         IF HOLD-UI-REASON = 02                                   21598000
215990             MOVE 'Z' TO NIP1-CHRG-IND                            21599000
216000         END-IF                                                   21600000
216010     END-IF.                                                      21601000
216020                                                                  21602000
216030     WRITE NSF-FILE-1 FROM NSF-FILE-1-WORK.                       21603000
216040                                                                  21604000
216050 P8449-EXIT.                                                      21605000
216060     EXIT.                                                        21606000
216070                                                                  21607000
216080******************************************************************21608000
216090*                B U I L D   N S F   F I L E   2                 *21609000
216100******************************************************************21610000
216110 P8450-BUILD-NSF-FILE-2.                                          21611000
216120     IF PROC-DSS                                                  21612000
216130         GO TO P8459-EXIT.                                        21613000
216140     IF NO-NSF-ONLINE                                             21614000
216150         GO TO P8459-EXIT.                                        21615000
216160     IF NSF-FILE-1-SW = 0 AND NSF-FILE-3-SW = 0                   21616000
216170                          AND NSF-FILE-4-SW = 0                   21617000
216180         GO TO P8459-EXIT.                                        21618000
216190     MOVE BCF-BANK-NO    TO NIP2-BANK-NBR.                        21619000
216200     MOVE ACCOUNT-ID     TO NIP2-ACCT-ID.                         21620000
216210     MOVE ACCOUNT-NUMBER TO NIP2-ACCT-NBR.                        21621000
216220     MOVE ACCOUNT-CLASS  TO NIP2-ACCT-CLASS.                      21622000
216230     MOVE ACCT-TYPE-CODE TO NIP2-TYPE-CODE.                       21623000
216240     MOVE SPACE          TO U021-RETURN-CODE.                     21624000
216250     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    21625000
216260     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   21626000
216270     MOVE CIF-XREF-KEY   TO U021-FILE-KEY.                        21627000
216280     MOVE 'N'            TO U021-DEMOGRAPHICS-IND.                21628000
216290     CALL 'CIFU021'   USING CIFU021-PARAMETERS.                   21629000
216300     IF U021-GOOD-RETURN                                          21630000
216310         MOVE U021-CUST-OFFICER TO NIP2-PRIM-OFF                  21631000
216320       ELSE                                                       21632000
216330         MOVE ZEROS TO NIP2-PRIM-OFF.                             21633000
216340     MOVE BCF-BANK-NO    TO OTHBS-BANK-NBR.                       21634000
216350     MOVE SPACES         TO CIF-XREF-KEY.                         21635000
216360     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    21636000
216370     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   21637000
216380     MOVE CIF-XREF-KEY   TO OTHBS-REC-KEY.                        21638000
216390     MOVE SPACE          TO OTHBS-RETURN-CODE.                    21639000
216400     CALL 'CIFOTHBS' USING OTHBS-BANK-NBR                         21640000
216410                           OTHBS-FILE-ID                          21641000
216420                           OTHBS-REC-KEY                          21642000
216430                           NIP2-OTHER-BUS                         21643000
216440                           OTHBS-RETURN-CODE.                     21644000
216450     IF OTHBS-RETURN-CODE = 'B'                                   21645000
216460         MOVE SPACES TO NIP2-OTHER-BUS.                           21646000
216470     MOVE DATE-OPENED TO NIP2-DATE-OPENED.                        21647000
216480     MOVE NUM-APPR-OD-MO TO NIP2-NO-APPR-OD-MTD.                  21648000
216490     MOVE UNCOLL-WITHD-MO TO NIP2-UNCOLL-MTD.                     21649000
216500     MOVE NUM-NSF-CHECKS-MO TO NIP2-NSF-MTD.                      21650000
216510     MOVE ZERO TO NIP2-NO-APPR-OD-YTD.                            21651000
216520     ADD NUM-APPR-OD (1)                                          21652000
216530         NUM-APPR-OD (5)                                          21653000
216540         NUM-APPR-OD (6)                                          21654000
216550         NUM-APPR-OD (7) TO NIP2-NO-APPR-OD-YTD.                  21655000
216560     MOVE ZERO TO NIP2-UNCOLL-YTD.                                21656000
216570     ADD UNCOLL-WITHD (1)                                         21657000
216580         UNCOLL-WITHD (5)                                         21658000
216590         UNCOLL-WITHD (6)                                         21659000
216600         UNCOLL-WITHD (7) TO NIP2-UNCOLL-YTD.                     21660000
216610     MOVE ZERO TO NIP2-NSF-YTD.                                   21661000
216620     ADD NUM-NSF-CHECKS (1)                                       21662000
216630         NUM-NSF-CHECKS (5)                                       21663000
216640         NUM-NSF-CHECKS (6)                                       21664000
216650         NUM-NSF-CHECKS (7) TO NIP2-NSF-YTD.                      21665000
216660     IF TDY-MO = 01 OR 04 OR 07 OR 10                             21666000
216670         ADD NUM-APPR-OD (8) TO NIP2-NO-APPR-OD-YTD               21667000
216680         ADD UNCOLL-WITHD (8) TO NIP2-UNCOLL-YTD                  21668000
216690         ADD NUM-NSF-CHECKS (8) TO NIP2-NSF-YTD                   21669000
216700       ELSE                                                       21670000
216710         IF TDY-MO = 02 OR 05 OR 08 OR 11                         21671000
216720             ADD NUM-APPR-OD (2) TO NIP2-NO-APPR-OD-YTD           21672000
216730             ADD UNCOLL-WITHD (2) TO NIP2-UNCOLL-YTD              21673000
216740             ADD NUM-NSF-CHECKS (2) TO NIP2-NSF-YTD               21674000
216750           ELSE                                                   21675000
216760             IF TDY-MO = 03 OR 06 OR 09 OR 12                     21676000
216770                 ADD NUM-APPR-OD (2)                              21677000
216780                     NUM-APPR-OD (3) TO NIP2-NO-APPR-OD-YTD       21678000
216790                 ADD UNCOLL-WITHD (2)                             21679000
216800                     UNCOLL-WITHD (3) TO NIP2-UNCOLL-YTD          21680000
216810                 ADD NUM-NSF-CHECKS (2)                           21681000
216820                     NUM-NSF-CHECKS (3) TO NIP2-NSF-YTD.          21682000
216830     MOVE AVG-COLL-BAL-MO (2) TO NIP2-AVG-COLL-MO.                21683000
216840     MOVE AVG-COLL-BAL-MO (5) TO NIP2-AVG-COLL-QTR.               21684000
216850     MOVE DATE-LAST-DEPOSIT TO NIP2-DATE-LAST-DEP.                21685000
216860     MOVE AMT-LAST-DEPOSIT TO NIP2-AMT-LAST-DEP.                  21686000
216870     ADD CURRENT-BALANCE                                          21687000
216880         NSF-ITEM-ACCT-TOT                                        21688000
216890             GIVING NIP2-BAL-IF-ITEM-PD.                          21689000
216900     MOVE CURRENT-BALANCE TO NIP2-CURR-BAL.                       21690000
216910     IF IMM-FEE-PER-DAY OR IMM-ITEM-CHG                           21691000
216920         ADD TEMP-I-CHG TO NIP2-CURR-BAL.                         21692000
216930     MOVE SC-ROUTINE TO NIP2-SC-ROUTINE.                          21693000
216940     MOVE ACCT-DISP-CODE TO NIP2-DISP-CODE.                       21694000
216950     PERFORM P8470-CHECK-CUST-DESC THRU P8479-EXIT.               21695000
216960     IF OA-FRESH-START                                            21696000
216970         MOVE 'F' TO NIP2-DISP-CODE.                              21697000
216980     MOVE SPACE TO NIP2-OA-ACCT-IND.                              21698000
216990     IF OD-ACCESS-INDICATOR = ZERO                                21699000
217000         NEXT SENTENCE                                            21700000
217010       ELSE                                                       21701000
217020         IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED       21702000
217030             MOVE 'Y' TO NIP2-OA-ACCT-IND.                        21703000
217040     MOVE SAC-IND     TO NIP2-SAC-IND.                            21704000
217050     MOVE REG-E-ATM-POS-SW  TO NIP2-REGE-SW.                      21705000
217060     WRITE NSF-FILE-2 FROM NSF-FILE-2-WORK.                       21706000
217070                                                                  21707000
217080 P8459-EXIT.                                                      21708000
217090     EXIT.                                                        21709000
217100                                                                  21710000
217110******************************************************************21711000
217120* B U I L D   N S F   F I L E   3  -  OVERDRAFT ACCESS ONLY      *21712000
217130******************************************************************21713000
217140 P8460-BUILD-NSF-FILE-3.                                          21714000
217150     IF PROC-DSS                                                  21715000
217160         GO TO P8464-EXIT.                                        21716000
217170     IF NO-NSF-ONLINE                                             21717000
217180         GO TO P8464-EXIT.                                        21718000
217190     MOVE DSDSTXL-BANK-NO TO NIP3-BANK-NBR.                       21719000
217200     MOVE DSDSTXL-ACCT-ID TO NIP3-ACCT-ID.                        21720000
217210     MOVE DSDSTXL-ACCT-NO TO NIP3-ACCT-NBR                        21721000
217220                             NIP3-ORIG-ACCT.                      21722000
217230     ADD 1 TO NIP3-SEQ-NBR.                                       21723000
217240     MOVE DSDSTXL-CODE TO NIP3-TX-CODE.                           21724000
217250     MOVE DSDSTXL-AMOUNT TO NIP3-TX-AMT.                          21725000
217260     MOVE 1 TO NSF-FILE-3-SW.                                     21726000
217270     MOVE SHORT-NAME TO NIP3-SHORT-NAME.                          21727000
217280     MOVE CURRENT-BALANCE TO NIP3-CURR-BAL.                       21728000
217290     MOVE HOLD-UI-REASON TO NIP3-REASON-CODE                      21729000
217300                            X3.                                   21730000
217310     MOVE REASON (X3) TO NIP3-REASON.                             21731000
217320     IF DSDSTXL-CHK-NO = PROC-CURR-DATE                           21732000
217330         MOVE ZERO TO NIP3-SERIAL-NBR                             21733000
217340       ELSE                                                       21734000
217350         MOVE DSDSTXL-CHK-NO TO NIP3-SERIAL-NBR.                  21735000
217360     MOVE 'Y' TO NIP3-PAY-IND.                                    21736000
217370     MOVE 'Y' TO NIP3-CHRG-IND.                                   21737000
217380     MOVE 'N' TO NIP3-MANUAL-IND.                                 21738000
217390     IF DSDSTXL-CODE = 775 OR 776 OR 777 OR 922 OR 926            21739000
217400         MOVE DSDSTXL-FOR-ATM-DESC TO NIP3-PAYEE                  21740000
217410       ELSE                                                       21741000
217420         MOVE SPACES TO NIP3-PAYEE.                               21742000
217430     MOVE DSDSTXL-CO-DESC TO NIP3-DESC-16.                        21743000
217440     MOVE DSDSTXL-DESC TO NIP3-DESC-10.                           21744000
217450     MOVE DSDSTXL-DATE TO NIP3-TX-DATE.                           21745000
217460     MOVE SAVE-ENCL-SW-FOR-NIPS TO NIP3-ENCL-SW.                  21746000
217470     MOVE DSDSTXL-SC-TYPE TO NIP3-SC-ITEM.                        21747000
217480     MOVE DSDSTXL-FOR-ATM-DESC TO NIP3-FOR-ATM-DESC.              21748000
217490     MOVE DSDSTXL-POS-TX-DATE TO NIP3-POS-TX-DATE.                21749000
217500     MOVE DSDSTXL-POS-REF-NBR TO NIP3-POS-REF-NBR.                21750000
217510     MOVE DSDSTXL-ACH-PAR-NBR TO NIP3-ACH-PAR-NBR.                21751000
217520     MOVE DSDSTXL-ACH-STD-ENTRY-CLASS TO NIP3-ACH-STD-ENTRY-CLASS.21752000
217530     MOVE DSDSTXL-DESC-FORMAT TO NIP3-DESC-FORMAT.                21753000
217540     MOVE DSDSTXL-ACH-DISC-DATA TO NIP3-ACH-DISC-DATA.            21754000
217550     MOVE SPACES TO NIP3-ACH-RET-REASON.                          21755000
217560                                                                  21756000
217570     IF INSURED-CASH-SWEEP                                        21757000
217580         IF WIRE-TX-CODE                                          21758000
217590             MOVE 'Y' TO NIP3-PAY-IND                             21759000
217600             MOVE 'N' TO NIP3-CHRG-IND                            21760000
217610         END-IF                                                   21761000
217620     END-IF.                                                      21762000
217630                                                                  21763000
217640*** CANNOT CHARGE OD FEE FOR PREPAID CARD ACCOUNTS                21764000
217650     IF BCFSCR-PREPAID-CARD                                       21765000
217660         MOVE '3'     TO NIP3-CHRG-IND                            21766000
217670         GO TO P8463-CONTINUE                                     21767000
217680     END-IF.                                                      21768000
217690                                                                  21769000
217700***** REGE-TX                                                     21770000
217710     IF REGE-TX                                                   21771000
217720         CONTINUE                                                 21772000
217730     ELSE                                                         21773000
217740         GO TO P8462-NOT-REGE                                     21774000
217750     END-IF.                                                      21775000
217760                                                                  21776000
217770******* REGE - OPT-IN                                             21777000
217780     IF DSDSTXL-REGE-SW = 'I'                                     21778000
217790         CONTINUE                                                 21779000
217800     ELSE                                                         21780000
217810******* REGE - OPT-OUT                                            21781000
217820         MOVE 'Y' TO NIP3-PAY-IND                                 21782000
217830         MOVE 'X' TO NIP3-CHRG-IND                                21783000
217840         GO TO P8463-CONTINUE                                     21784000
217850     END-IF.                                                      21785000
217860                                                                  21786000
217870     IF NIP3-CHRG-IND = 'Y'                                       21787000
217880         IF DSDSTXL-AMOUNT LESS THAN WORK-OD-MIN-TX-AMT           21788000
217890             MOVE '2' TO NIP3-CHRG-IND                            21789000
217900             GO TO P8463-CONTINUE                                 21790000
217910         END-IF                                                   21791000
217920     END-IF.                                                      21792000
217930                                                                  21793000
217940     IF NIP3-CHRG-IND = 'Y'                                       21794000
217950         ADD 1 TO WORK-OD-COUNTER                                 21795000
217960     ELSE                                                         21796000
217970         GO TO P8463-CONTINUE                                     21797000
217980     END-IF.                                                      21798000
217990                                                                  21799000
218000     IF WORK-OD-COUNTER GREATER THAN WORK-OD-LIMIT-PER-DAY        21800000
218010         MOVE '1' TO NIP3-CHRG-IND                                21801000
218020     ELSE                                                         21802000
218030         ADD 1 TO OA-NSF-CNT                                      21803000
218040     END-IF.                                                      21804000
218050     GO TO P8463-CONTINUE.                                        21805000
218060                                                                  21806000
218070 P8462-NOT-REGE.                                                  21807000
218080***** NOT REG-E TX                                                21808000
218090     IF NIP3-CHRG-IND = 'Y'                                       21809000
218100         IF DSDSTXL-AMOUNT LESS THAN WORK-OD-MIN-TX-AMT           21810000
218110             MOVE '2' TO NIP3-CHRG-IND                            21811000
218120             GO TO P8463-CONTINUE                                 21812000
218130         END-IF                                                   21813000
218140     END-IF.                                                      21814000
218150                                                                  21815000
218160     IF NIP3-CHRG-IND = 'Y'                                       21816000
218170         ADD 1 TO WORK-OD-COUNTER                                 21817000
218180     ELSE                                                         21818000
218190         GO TO P8463-CONTINUE                                     21819000
218200     END-IF.                                                      21820000
218210                                                                  21821000
218220     IF WORK-OD-COUNTER GREATER THAN WORK-OD-LIMIT-PER-DAY        21822000
218230         MOVE '1' TO NIP3-CHRG-IND                                21823000
218240     ELSE                                                         21824000
218250         ADD 1 TO OA-NSF-CNT                                      21825000
218260     END-IF.                                                      21826000
218270 P8463-CONTINUE.                                                  21827000
218280     WRITE NSF-FILE-3 FROM NSF-FILE-3-WORK.                       21828000
218290                                                                  21829000
218300 P8464-EXIT.                                                      21830000
218310     EXIT.                                                        21831000
218320                                                                  21832000
218330******************************************************************21833000
218340* B U I L D   N S F   F I L E   4  -  ELECTRONIC ITEMS ONLY      *21834000
218350******************************************************************21835000
218360 P8465-BUILD-NSF-FILE-4.                                          21836000
218370     IF PROC-DSS                                                  21837000
218380         GO TO P8469-EXIT.                                        21838000
218390     IF NO-NSF-ONLINE                                             21839000
218400         GO TO P8469-EXIT.                                        21840000
218410     MOVE DSDSTXL-BANK-NO TO NIP4-BANK-NBR.                       21841000
218420     MOVE DSDSTXL-ACCT-ID TO NIP4-ACCT-ID.                        21842000
218430     MOVE DSDSTXL-ACCT-NO TO NIP4-ACCT-NBR                        21843000
218440                             NIP4-ORIG-ACCT.                      21844000
218450     IF DSDSTXL-REGE-SW = SPACES                                  21845000
218460         MOVE REG-E-ATM-POS-SW TO DSDSTXL-REGE-SW                 21846000
218470     END-IF.                                                      21847000
218480     ADD 1 TO NIP4-SEQ-NBR.                                       21848000
218490     MOVE 1 TO NSF-FILE-4-SW                                      21849000
218500     MOVE DSDSTXL-CODE TO NIP4-TX-CODE.                           21850000
218510     MOVE DSDSTXL-AMOUNT TO NIP4-TX-AMT.                          21851000
218520     MOVE SHORT-NAME TO NIP4-SHORT-NAME.                          21852000
218530     MOVE CURRENT-BALANCE TO NIP4-CURR-BAL.                       21853000
218540     MOVE HOLD-UI-REASON TO NIP4-REASON-CODE                      21854000
218550                            X3.                                   21855000
218560     MOVE REASON (X3) TO NIP4-REASON.                             21856000
218570     IF DSDSTXL-CHK-NO = PROC-CURR-DATE                           21857000
218580         MOVE ZERO TO NIP4-SERIAL-NBR                             21858000
218590       ELSE                                                       21859000
218600         MOVE DSDSTXL-CHK-NO TO NIP4-SERIAL-NBR.                  21860000
218610     MOVE 'Y' TO NIP4-PAY-IND.                                    21861000
218620     MOVE 'Y' TO NIP4-CHRG-IND.                                   21862000
218630                                                                  21863000
218640     IF INSURED-CASH-SWEEP                                        21864000
218650         IF WIRE-TX-CODE                                          21865000
218660             MOVE 'Y' TO NIP4-PAY-IND                             21866000
218670             MOVE 'N' TO NIP4-CHRG-IND                            21867000
218680         END-IF                                                   21868000
218690     END-IF.                                                      21869000
218700                                                                  21870000
218710*** CANNOT CHARGE OD FEE FOR PREPAID CARD ACCOUNTS                21871000
218720     IF BCFSCR-PREPAID-CARD                                       21872000
218730         MOVE '3'     TO NIP4-CHRG-IND                            21873000
218740         GO TO P8467-CONTINUE                                     21874000
218750     END-IF.                                                      21875000
218760                                                                  21876000
218710*** CANNOT CHARGE OD FEE FOR ICSS AND TES DEBITS                  21876103
219250     IF DSDSTXL-CODE = 904 OR 905                                 21876203
219020         MOVE 'E'     TO NIP4-CHRG-IND                            21876303
218740         GO TO P8467-CONTINUE                                     21876403
           END-IF.                                                      21876503
218770* HOLD ITEMS                                                      21877000
218780     IF HOLD-UI-REASON = 02                                       21878000
218790         MOVE 'Y' TO NIP4-PAY-IND                                 21879000
218800         MOVE 'Z' TO NIP4-CHRG-IND                                21880000
218810     END-IF.                                                      21881000
218820                                                                  21882000
218830     IF REGE-TX                                                   21883000
218840         CONTINUE                                                 21884000
218850     ELSE                                                         21885000
218860         GO TO P8466-CONTINUE                                     21886000
218870     END-IF.                                                      21887000
218880                                                                  21888000
218890     IF DSDSTXL-REGE-SW = 'I'                                     21889000
218900* REGE-TX - OPT-IN                                                21890000
218910         CONTINUE                                                 21891000
218920     ELSE                                                         21892000
218930* REGE-TX - OPT-OUT                                               21893000
218940         MOVE 'Y' TO NIP4-PAY-IND                                 21894000
218950         MOVE 'X' TO NIP4-CHRG-IND                                21895000
218960         GO TO P8467-CONTINUE                                     21896000
218970     END-IF.                                                      21897000
218980                                                                  21898000
218990 P8466-CONTINUE.                                                  21899000
219000     IF NIP4-CHRG-IND = 'Y'                                       21900000
219010         IF DSDSTXL-AMOUNT LESS THAN WORK-OD-MIN-TX-AMT           21901000
219020             MOVE '2' TO NIP4-CHRG-IND                            21902000
219030             GO TO P8467-CONTINUE                                 21903000
219040         END-IF                                                   21904000
219050     END-IF.                                                      21905000
219060                                                                  21906000
219070     IF NIP4-CHRG-IND = 'Y'                                       21907000
219080         ADD 1 TO WORK-OD-COUNTER                                 21908000
219090     ELSE                                                         21909000
219100         GO TO P8467-CONTINUE                                     21910000
219110     END-IF.                                                      21911000
219120                                                                  21912000
219130     IF WORK-OD-COUNTER GREATER THAN WORK-OD-LIMIT-PER-DAY        21913000
219140         MOVE '1' TO NIP4-CHRG-IND                                21914000
219150     ELSE                                                         21915000
219160         ADD 1 TO E-ITEMS-NSF                                     21916000
219170     END-IF.                                                      21917000
219180                                                                  21918000
219190 P8467-CONTINUE.                                                  21919000
219200     IF HOLD-UI-REASON = 02                                       21920000
219210         MOVE 'Z' TO NIP4-CHRG-IND                                21921000
219220     END-IF.                                                      21922000
219230                                                                  21923000
219240     MOVE 'N' TO NIP4-MANUAL-IND.                                 21924000
219250     IF DSDSTXL-CODE = 775 OR 776 OR 777 OR 922 OR 926            21925000
219260         MOVE DSDSTXL-FOR-ATM-DESC TO NIP4-PAYEE                  21926000
219270       ELSE                                                       21927000
219280         MOVE SPACES TO NIP4-PAYEE.                               21928000
219290     MOVE DSDSTXL-CO-DESC TO NIP4-DESC-16.                        21929000
219300     MOVE DSDSTXL-DESC TO NIP4-DESC-10.                           21930000
219310     MOVE DSDSTXL-DATE TO NIP4-TX-DATE.                           21931000
219320     MOVE SAVE-ENCL-SW-FOR-NIPS TO NIP4-ENCL-SW.                  21932000
219330     MOVE DSDSTXL-SC-TYPE TO NIP4-SC-ITEM.                        21933000
219340     MOVE DSDSTXL-FOR-ATM-DESC TO NIP4-FOR-ATM-DESC.              21934000
219350     MOVE DSDSTXL-POS-TX-DATE TO NIP4-POS-TX-DATE.                21935000
219360     MOVE DSDSTXL-POS-REF-NBR TO NIP4-POS-REF-NBR.                21936000
219370     MOVE DSDSTXL-ACH-PAR-NBR TO NIP4-ACH-PAR-NBR.                21937000
219380     MOVE DSDSTXL-ACH-STD-ENTRY-CLASS TO NIP4-ACH-STD-ENTRY-CLASS.21938000
219390     MOVE DSDSTXL-DESC-FORMAT TO NIP4-DESC-FORMAT.                21939000
219400     MOVE DSDSTXL-ACH-DISC-DATA TO NIP4-ACH-DISC-DATA.            21940000
219410     MOVE SPACES TO NIP4-ACH-RET-REASON.                          21941000
219420                                                                  21942000
219430     WRITE NSF-FILE-4 FROM NSF-FILE-4-WORK.                       21943000
219440                                                                  21944000
219450 P8469-EXIT.                                                      21945000
219460     EXIT.                                                        21946000
219470                                                                  21947000
219480******************************************************************21948000
219490* DSDM104 - CHECKS FOR DIRECTORS OR EXECUTIVE OFFICERS           *21949000
219500******************************************************************21950000
219510 P8470-CHECK-CUST-DESC.                                           21951000
219520     MOVE BCF-BANK-NO    TO DSDM104-BANK-NBR.                     21952000
219530     MOVE 'DDA'          TO DSDM104-FILE-ID.                      21953000
219540     MOVE 001            TO DSDM104-ACCT-ID.                      21954000
219550     MOVE ACCOUNT-NUMBER TO DSDM104-ACCT-NBR.                     21955000
219560     CALL 'DSDM104'   USING DSDM104-PARAMETERS.                   21956000
219570     IF DSDM104-RETURN-CODE = 'Y'                                 21957000
219580         MOVE 'X' TO NIP2-DISP-CODE.                              21958000
219590                                                                  21959000
219600 P8479-EXIT.                                                      21960000
219610     EXIT.                                                        21961000
219620                                                                  21962000
219630******************************************************************21963000
219640* C H A N G E   I N   S T A T U S   C O D E  -  L O G            *21964000
219650******************************************************************21965000
219660 P8480-LOG-CHANGES.                                               21966000
219670     CONTINUE.                                                    21967000
219680                                                                  21968000
219690 P8481-STATUS-CODE-CHANGE.                                        21969000
219700     IF HOLD-OLD-STAT-2X = HOLD-NEW-STAT-2X                       21970000
219710         GO TO P8481-EXIT.                                        21971000
219720     INITIALIZE CHANGE-LOG-WORK.                                  21972000
219730     MOVE DSDS-BANK-NO     TO CLW-BANK-NBR.                       21973000
219740     MOVE DSDS-ACCOUNT-ID  TO CLW-ACCT-ID.                        21974000
219750     MOVE DSDS-ACCOUNT-NO  TO CLW-ACCT-NBR.                       21975000
219760     MOVE 005              TO CLW-FIELD-CODE.                     21976000
219770     MOVE HOLD-OLD-STAT-2X TO CLW-OLD-STAT-2X.                    21977000
219780     MOVE HOLD-NEW-STAT-2X TO CLW-NEW-STAT-2X.                    21978000
219790     MOVE PROC-CURR-DATE   TO DSDS-LAST-MAINT-DATE.               21979000
219800     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    21980000
219810     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     21981000
219820                                                                  21982000
219830     IF HOLD-NEW-STAT-2X = '09'                                   21983000
219840         IF RESUBMITIT-IND = 'Y'                                  21984000
219850             INITIALIZE CHANGE-LOG-WORK                           21985000
219860             MOVE DSDS-BANK-NO          TO CLW-BANK-NBR           21986000
219870             MOVE DSDS-ACCOUNT-ID       TO CLW-ACCT-ID            21987000
219880             MOVE DSDS-ACCOUNT-NO       TO CLW-ACCT-NBR           21988000
219890             MOVE 080                   TO CLW-FIELD-CODE         21989000
219900             MOVE RESUBMITIT-IND        TO CLW-OLD-STAT-2X        21990000
219910             MOVE 'N'                   TO CLW-NEW-STAT-2X        21991000
219920             MOVE PROC-CURR-DATE        TO DSDS-LAST-MAINT-DATE   21992000
219930             MOVE 'Y'                   TO CLW-EXTRACT-IND        21993000
219940             MOVE 'N'                   TO RESUBMITIT-IND         21994000
219950             WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK              21995000
219960         END-IF                                                   21996000
219970     END-IF.                                                      21997000
219980                                                                  21998000
219990     IF HOLD-OLD-STAT-2X = '03'                                   21999000
220000         IF HOLD-NEW-STAT-2X = '01'                               22000000
220010             INITIALIZE CHANGE-LOG-WORK                           22001000
220020             MOVE DSDS-BANK-NO          TO CLW-BANK-NBR           22002000
220030             MOVE DSDS-ACCOUNT-ID       TO CLW-ACCT-ID            22003000
220040             MOVE DSDS-ACCOUNT-NO       TO CLW-ACCT-NBR           22004000
220050             MOVE 059                   TO CLW-FIELD-CODE         22005000
220060             CALL 'CDCDT48'          USING HOLD-OLD-CUST-ACT-DATE 22006000
220070                                           CLW-OLD-CUST-ACT-DT    22007000
220080             CALL 'CDCDT48'          USING HOLD-NEW-CUST-ACT-DATE 22008000
220090                                           CLW-NEW-CUST-ACT-DT    22009000
220100             MOVE 'Y'                   TO CLW-EXTRACT-IND        22010000
220110             WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK              22011000
220120         END-IF                                                   22012000
220130     END-IF.                                                      22013000
220140                                                                  22014000
220150 P8481-EXIT.                                                      22015000
220160     EXIT.                                                        22016000
220170                                                                  22017000
220180 P8482-INV-STATUS-CODE-CHANGE.                                    22018000
220190     IF HOLD-OLD-INV-STAT = HOLD-NEW-INV-STAT                     22019000
220200         GO TO P8482-EXIT.                                        22020000
220210     INITIALIZE CHANGE-LOG-WORK.                                  22021000
220220     MOVE DSDS-BANK-NO      TO CLW-BANK-NBR.                      22022000
220230     MOVE DSDS-ACCOUNT-ID   TO CLW-ACCT-ID.                       22023000
220240     MOVE DSDS-ACCOUNT-NO   TO CLW-ACCT-NBR.                      22024000
220250     MOVE 228               TO CLW-FIELD-CODE.                    22025000
220260     MOVE HOLD-OLD-INV-STAT TO CLW-OLD-INV-STAT.                  22026000
220270     MOVE HOLD-NEW-INV-STAT TO CLW-NEW-INV-STAT.                  22027000
220280     MOVE HOLD-NEW-INV-STAT TO HOLD-OLD-INV-STAT.                 22028000
220290     MOVE PROC-CURR-DATE    TO DSDS-LAST-MAINT-DATE.              22029000
220300     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22030000
220310     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22031000
220320                                                                  22032000
220330 P8482-EXIT.                                                      22033000
220340     EXIT.                                                        22034000
220350                                                                  22035000
220360 P8483-ODB-STATUS-CODE-CHANGE.                                    22036000
220370     IF HOLD-OLD-ODB-STAT = HOLD-NEW-ODB-STAT                     22037000
220380         GO TO P8483-EXIT.                                        22038000
220390     INITIALIZE CHANGE-LOG-WORK.                                  22039000
220400     MOVE DSDS-BANK-NO      TO CLW-BANK-NBR.                      22040000
220410     MOVE DSDS-ACCOUNT-ID   TO CLW-ACCT-ID.                       22041000
220420     MOVE DSDS-ACCOUNT-NO   TO CLW-ACCT-NBR.                      22042000
220430     MOVE 116               TO CLW-FIELD-CODE.                    22043000
220440     MOVE HOLD-OLD-ODB-STAT TO CLW-OLD-ODB-STAT.                  22044000
220450     MOVE HOLD-NEW-ODB-STAT TO CLW-NEW-ODB-STAT.                  22045000
220460     MOVE HOLD-NEW-ODB-STAT TO HOLD-OLD-ODB-STAT.                 22046000
220470     MOVE PROC-CURR-DATE    TO DSDS-LAST-MAINT-DATE.              22047000
220480     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22048000
220490     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22049000
220500                                                                  22050000
220510 P8483-EXIT.                                                      22051000
220520     EXIT.                                                        22052000
220530                                                                  22053000
220540 P8484-ACCESS-CODE-CHANGE.                                        22054000
220550     IF HOLD-OLD-ACCESS-CODE = HOLD-NEW-ACCESS-CODE               22055000
220560         GO TO P8484-EXIT.                                        22056000
220570     INITIALIZE CHANGE-LOG-WORK.                                  22057000
220580     MOVE DSDS-BANK-NO         TO CLW-BANK-NBR.                   22058000
220590     MOVE DSDS-ACCOUNT-ID      TO CLW-ACCT-ID.                    22059000
220600     MOVE DSDS-ACCOUNT-NO      TO CLW-ACCT-NBR.                   22060000
220610     MOVE 191                  TO CLW-FIELD-CODE.                 22061000
220620     MOVE HOLD-OLD-ACCESS-CODE TO CLW-OLD-ACCESS-CODE.            22062000
220630     MOVE HOLD-NEW-ACCESS-CODE TO CLW-NEW-ACCESS-CODE.            22063000
220640     MOVE HOLD-NEW-ACCESS-CODE TO HOLD-OLD-ACCESS-CODE.           22064000
220650     MOVE PROC-CURR-DATE       TO DSDS-LAST-MAINT-DATE.           22065000
220660     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22066000
220670     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22067000
220680                                                                  22068000
220690 P8484-EXIT.                                                      22069000
220700     EXIT.                                                        22070000
220710                                                                  22071000
220720 P8485-ACCESS-LIMIT-CHANGE.                                       22072000
220730     IF HOLD-OLD-ACCESS-LIMIT = HOLD-NEW-ACCESS-LIMIT             22073000
220740         GO TO P8485-EXIT.                                        22074000
220750     INITIALIZE CHANGE-LOG-WORK.                                  22075000
220760     MOVE DSDS-BANK-NO          TO CLW-BANK-NBR.                  22076000
220770     MOVE DSDS-ACCOUNT-ID       TO CLW-ACCT-ID.                   22077000
220780     MOVE DSDS-ACCOUNT-NO       TO CLW-ACCT-NBR.                  22078000
220790     MOVE 192                   TO CLW-FIELD-CODE.                22079000
220800     MOVE HOLD-OLD-ACCESS-LIMIT TO CLW-OLD-ACCESS-LIMIT.          22080000
220810     MOVE HOLD-NEW-ACCESS-LIMIT TO CLW-NEW-ACCESS-LIMIT.          22081000
220820     MOVE HOLD-NEW-ACCESS-LIMIT TO HOLD-OLD-ACCESS-LIMIT.         22082000
220830     MOVE PROC-CURR-DATE        TO DSDS-LAST-MAINT-DATE.          22083000
220840     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22084000
220850     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22085000
220860                                                                  22086000
220870 P8485-EXIT.                                                      22087000
220880     EXIT.                                                        22088000
220890                                                                  22089000
220900 P8486-STMT-CYCLE-CODE-CHANGE.                                    22090000
220910     IF HOLD-OLD-STMT-CYCLE = HOLD-NEW-STMT-CYCLE                 22091000
220920         GO TO P8486-EXIT.                                        22092000
220930     INITIALIZE CHANGE-LOG-WORK.                                  22093000
220940     MOVE DSDS-BANK-NO        TO CLW-BANK-NBR.                    22094000
220950     MOVE DSDS-ACCOUNT-ID     TO CLW-ACCT-ID.                     22095000
220960     MOVE DSDS-ACCOUNT-NO     TO CLW-ACCT-NBR.                    22096000
220970     MOVE 012                 TO CLW-FIELD-CODE.                  22097000
220980     MOVE HOLD-OLD-STMT-CYCLE TO CLW-OLD-STMT-CYCLE.              22098000
220990     MOVE HOLD-NEW-STMT-CYCLE TO CLW-NEW-STMT-CYCLE.              22099000
221000     MOVE HOLD-NEW-STMT-CYCLE TO HOLD-OLD-STMT-CYCLE.             22100000
221010     MOVE PROC-CURR-DATE      TO DSDS-LAST-MAINT-DATE.            22101000
221020     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22102000
221030     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22103000
221040                                                                  22104000
221050 P8486-EXIT.                                                      22105000
221060     EXIT.                                                        22106000
221070                                                                  22107000
221080 P8487-SC-EARN-CYC-CODE-CHANGE.                                   22108000
221090     IF HOLD-OLD-SC-EARN-CYC = HOLD-NEW-SC-EARN-CYC               22109000
221100         GO TO P8487-EXIT.                                        22110000
221110     INITIALIZE CHANGE-LOG-WORK.                                  22111000
221120     MOVE DSDS-BANK-NO         TO CLW-BANK-NBR.                   22112000
221130     MOVE DSDS-ACCOUNT-ID      TO CLW-ACCT-ID.                    22113000
221140     MOVE DSDS-ACCOUNT-NO      TO CLW-ACCT-NBR.                   22114000
221150     MOVE 008                  TO CLW-FIELD-CODE.                 22115000
221160     MOVE HOLD-OLD-SC-EARN-CYC TO CLW-OLD-SC-EARN-CYC.            22116000
221170     MOVE HOLD-NEW-SC-EARN-CYC TO CLW-NEW-SC-EARN-CYC.            22117000
221180     MOVE HOLD-NEW-SC-EARN-CYC TO HOLD-OLD-SC-EARN-CYC.           22118000
221190     MOVE PROC-CURR-DATE       TO DSDS-LAST-MAINT-DATE.           22119000
221200     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22120000
221210     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22121000
221220                                                                  22122000
221230 P8487-EXIT.                                                      22123000
221240     EXIT.                                                        22124000
221250                                                                  22125000
221260 P8488-STMT-DISP-CODE-CHANGE.                                     22126000
221270     IF HOLD-OLD-STMT-DISP-CODE = HOLD-NEW-STMT-DISP-CODE         22127000
221280         GO TO P8488-EXIT.                                        22128000
221290     INITIALIZE CHANGE-LOG-WORK.                                  22129000
221300     MOVE DSDS-BANK-NO            TO CLW-BANK-NBR.                22130000
221310     MOVE DSDS-ACCOUNT-ID         TO CLW-ACCT-ID.                 22131000
221320     MOVE DSDS-ACCOUNT-NO         TO CLW-ACCT-NBR.                22132000
221330     MOVE 013                     TO CLW-FIELD-CODE.              22133000
221340     MOVE HOLD-OLD-STMT-DISP-CODE TO CLW-OLD-STMT-DISP-CODE.      22134000
221350     MOVE HOLD-NEW-STMT-DISP-CODE TO CLW-NEW-STMT-DISP-CODE.      22135000
221360     MOVE HOLD-NEW-STMT-DISP-CODE TO HOLD-OLD-STMT-DISP-CODE.     22136000
221370     MOVE PROC-CURR-DATE          TO DSDS-LAST-MAINT-DATE.        22137000
221380     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22138000
221390     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22139000
221400                                                                  22140000
221410 P8488-EXIT.                                                      22141000
221420     EXIT.                                                        22142000
221430                                                                  22143000
221440 P8489-INV-TERM-CHANGE.                                           22144000
221450     IF HOLD-OLD-INV-TERM = HOLD-NEW-INV-TERM                     22145000
221460         GO TO P8489-EXIT.                                        22146000
221470     INITIALIZE CHANGE-LOG-WORK.                                  22147000
221480     MOVE DSDS-BANK-NO      TO CLW-BANK-NBR.                      22148000
221490     MOVE DSDS-ACCOUNT-ID   TO CLW-ACCT-ID.                       22149000
221500     MOVE DSDS-ACCOUNT-NO   TO CLW-ACCT-NBR.                      22150000
221510     MOVE 238               TO CLW-FIELD-CODE.                    22151000
221520     MOVE HOLD-OLD-INV-TERM TO CLW-OLD-INV-TERM.                  22152000
221530     MOVE HOLD-NEW-INV-TERM TO CLW-NEW-INV-TERM.                  22153000
221540     MOVE HOLD-NEW-INV-TERM TO HOLD-OLD-INV-TERM.                 22154000
221550     MOVE PROC-CURR-DATE    TO DSDS-LAST-MAINT-DATE.              22155000
221560     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22156000
221570     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22157000
221580                                                                  22158000
221590 P8489-EXIT.                                                      22159000
221600     EXIT.                                                        22160000
221610                                                                  22161000
221620 P8490-INV-MAT-DATE-CHANGE.                                       22162000
221630     IF HOLD-OLD-INV-MAT-DATE = HOLD-NEW-INV-MAT-DATE             22163000
221640         GO TO P8490-EXIT.                                        22164000
221650     INITIALIZE CHANGE-LOG-WORK.                                  22165000
221660     MOVE DSDS-BANK-NO          TO CLW-BANK-NBR.                  22166000
221670     MOVE DSDS-ACCOUNT-ID       TO CLW-ACCT-ID.                   22167000
221680     MOVE DSDS-ACCOUNT-NO       TO CLW-ACCT-NBR.                  22168000
221690     MOVE 239                   TO CLW-FIELD-CODE.                22169000
221700     MOVE HOLD-OLD-INV-MAT-DATE TO CLW-OLD-INV-MAT-DATE.          22170000
221710     MOVE HOLD-NEW-INV-MAT-DATE TO CLW-NEW-INV-MAT-DATE.          22171000
221720     MOVE HOLD-NEW-INV-MAT-DATE TO HOLD-OLD-INV-MAT-DATE.         22172000
221730     MOVE PROC-CURR-DATE        TO DSDS-LAST-MAINT-DATE.          22173000
221740     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22174000
221750     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22175000
221760                                                                  22176000
221770 P8490-EXIT.                                                      22177000
221780     EXIT.                                                        22178000
221790                                                                  22179000
221800 P8491-INV-NEXT-TERM-CHANGE.                                      22180000
221810     IF HOLD-OLD-INV-NEXT-TERM = HOLD-NEW-INV-NEXT-TERM           22181000
221820         GO TO P8491-EXIT.                                        22182000
221830     INITIALIZE CHANGE-LOG-WORK.                                  22183000
221840     MOVE DSDS-BANK-NO           TO CLW-BANK-NBR.                 22184000
221850     MOVE DSDS-ACCOUNT-ID        TO CLW-ACCT-ID.                  22185000
221860     MOVE DSDS-ACCOUNT-NO        TO CLW-ACCT-NBR.                 22186000
221870     MOVE 207                    TO CLW-FIELD-CODE.               22187000
221880     MOVE HOLD-OLD-INV-NEXT-TERM TO CLW-OLD-INV-NEXT-TERM.        22188000
221890     MOVE HOLD-NEW-INV-NEXT-TERM TO CLW-NEW-INV-NEXT-TERM.        22189000
221900     MOVE HOLD-NEW-INV-NEXT-TERM TO HOLD-OLD-INV-NEXT-TERM.       22190000
221910     MOVE PROC-CURR-DATE         TO DSDS-LAST-MAINT-DATE.         22191000
221920     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22192000
221930     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22193000
221940                                                                  22194000
221950 P8491-EXIT.                                                      22195000
221960     EXIT.                                                        22196000
221970                                                                  22197000
221980 P8492-INV-NEXT-MAT-DATE-CHANGE.                                  22198000
221990     IF HOLD-OLD-INV-NEXT-MAT-DATE = HOLD-NEW-INV-NEXT-MAT-DATE   22199000
222000         GO TO P8492-EXIT.                                        22200000
222010     INITIALIZE CHANGE-LOG-WORK.                                  22201000
222020     MOVE DSDS-BANK-NO               TO CLW-BANK-NBR.             22202000
222030     MOVE DSDS-ACCOUNT-ID            TO CLW-ACCT-ID.              22203000
222040     MOVE DSDS-ACCOUNT-NO            TO CLW-ACCT-NBR.             22204000
222050     MOVE 220                        TO CLW-FIELD-CODE.           22205000
222060     MOVE HOLD-OLD-INV-NEXT-MAT-DATE TO CLW-OLD-INV-NEXT-MAT-DATE.22206000
222070     MOVE HOLD-NEW-INV-NEXT-MAT-DATE TO CLW-NEW-INV-NEXT-MAT-DATE.22207000
222080     MOVE HOLD-NEW-INV-NEXT-MAT-DATE TO                           22208000
222090                                       HOLD-OLD-INV-NEXT-MAT-DATE.22209000
222100     MOVE PROC-CURR-DATE             TO DSDS-LAST-MAINT-DATE.     22210000
222110     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22211000
222120     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22212000
222130                                                                  22213000
222140 P8492-EXIT.                                                      22214000
222150     EXIT.                                                        22215000
222160                                                                  22216000
222170 P8493-ACCT-TYPE-CHANGE.                                          22217000
222180     IF HOLD-OLD-ACCT-TYPE = HOLD-NEW-ACCT-TYPE                   22218000
222190         GO TO P8493-EXIT.                                        22219000
222200     INITIALIZE CHANGE-LOG-WORK.                                  22220000
222210     MOVE DSDS-BANK-NO       TO CLW-BANK-NBR.                     22221000
222220     MOVE DSDS-ACCOUNT-ID    TO CLW-ACCT-ID.                      22222000
222230     MOVE DSDS-ACCOUNT-NO    TO CLW-ACCT-NBR.                     22223000
222240     MOVE 003                TO CLW-FIELD-CODE.                   22224000
222250     MOVE HOLD-OLD-ACCT-TYPE TO CLW-OLD-ACCT-TYPE.                22225000
222260     MOVE HOLD-NEW-ACCT-TYPE TO CLW-NEW-ACCT-TYPE.                22226000
222270     MOVE HOLD-NEW-ACCT-TYPE TO HOLD-OLD-ACCT-TYPE.               22227000
222280     MOVE PROC-CURR-DATE     TO DSDS-LAST-MAINT-DATE.             22228000
222290     MOVE HOLD-EXTRACT-IND   TO CLW-EXTRACT-IND.                  22229000
222300     MOVE SPACES             TO HOLD-OLD-ACCT-TYPE                22230000
222310                                HOLD-NEW-ACCT-TYPE.               22231000
222320     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22232000
222330                                                                  22233000
222340 P8493-EXIT.                                                      22234000
222350     EXIT.                                                        22235000
222360                                                                  22236000
222370 P8494-SC-DISP-CODE-CHANGE.                                       22237000
222380     IF HOLD-OLD-SC-DISP = HOLD-NEW-SC-DISP                       22238000
222390         GO TO P8494-EXIT.                                        22239000
222400     INITIALIZE CHANGE-LOG-WORK.                                  22240000
222410     MOVE DSDS-BANK-NO     TO CLW-BANK-NBR.                       22241000
222420     MOVE DSDS-ACCOUNT-ID  TO CLW-ACCT-ID.                        22242000
222430     MOVE DSDS-ACCOUNT-NO  TO CLW-ACCT-NBR.                       22243000
222440     MOVE 006              TO CLW-FIELD-CODE.                     22244000
222450     MOVE HOLD-OLD-SC-DISP TO CLW-OLD-SC-DISP.                    22245000
222460     MOVE HOLD-NEW-SC-DISP TO CLW-NEW-SC-DISP.                    22246000
222470     MOVE HOLD-NEW-SC-DISP TO HOLD-OLD-SC-DISP.                   22247000
222480     MOVE PROC-CURR-DATE   TO DSDS-LAST-MAINT-DATE.               22248000
222490     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22249000
222500     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22250000
222510                                                                  22251000
222520 P8494-EXIT.                                                      22252000
222530     EXIT.                                                        22253000
222540                                                                  22254000
222550 P8495-EARN-DISP-CODE-CHANGE.                                     22255000
222560     IF HOLD-OLD-EARN-DISP = HOLD-NEW-EARN-DISP                   22256000
222570         GO TO P8495-EXIT.                                        22257000
222580     INITIALIZE CHANGE-LOG-WORK.                                  22258000
222590     MOVE DSDS-BANK-NO       TO CLW-BANK-NBR.                     22259000
222600     MOVE DSDS-ACCOUNT-ID    TO CLW-ACCT-ID.                      22260000
222610     MOVE DSDS-ACCOUNT-NO    TO CLW-ACCT-NBR.                     22261000
222620     MOVE 011                TO CLW-FIELD-CODE.                   22262000
222630     MOVE HOLD-OLD-EARN-DISP TO CLW-OLD-EARN-DISP.                22263000
222640     MOVE HOLD-NEW-EARN-DISP TO CLW-NEW-EARN-DISP.                22264000
222650     MOVE HOLD-NEW-EARN-DISP TO HOLD-OLD-EARN-DISP.               22265000
222660     MOVE PROC-CURR-DATE     TO DSDS-LAST-MAINT-DATE.             22266000
222670     MOVE HOLD-EXTRACT-IND   TO CLW-EXTRACT-IND.                  22267000
222680     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22268000
222690                                                                  22269000
222700 P8495-EXIT.                                                      22270000
222710     EXIT.                                                        22271000
222720                                                                  22272000
222730 P8496-BR-CLSN-TIED-CHANGE.                                       22273000
222740     IF HOLD-OLD-BR-CLSN-TIED = HOLD-NEW-BR-CLSN-TIED             22274000
222750         GO TO P8496-EXIT                                         22275000
222760     END-IF.                                                      22276000
222770     INITIALIZE CHANGE-LOG-WORK.                                  22277000
222780     MOVE DSDS-BANK-NO          TO CLW-BANK-NBR.                  22278000
222790     MOVE DSDS-ACCOUNT-ID       TO CLW-ACCT-ID.                   22279000
222800     MOVE DSDS-ACCOUNT-NO       TO CLW-ACCT-NBR.                  22280000
222810     MOVE 243                   TO CLW-FIELD-CODE.                22281000
222820     MOVE HOLD-OLD-BR-CLSN-TIED TO CLW-OLD-BR-CLSN-TIED.          22282000
222830     MOVE HOLD-NEW-BR-CLSN-TIED TO CLW-NEW-BR-CLSN-TIED.          22283000
222840     MOVE HOLD-NEW-BR-CLSN-TIED TO HOLD-OLD-BR-CLSN-TIED.         22284000
222850     MOVE PROC-CURR-DATE        TO DSDS-LAST-MAINT-DATE.          22285000
222860     MOVE HOLD-EXTRACT-IND TO CLW-EXTRACT-IND.                    22286000
222870     WRITE LOG-FILE-OUT FROM CHANGE-LOG-WORK.                     22287000
222880 P8496-EXIT.                                                      22288000
222890     EXIT.                                                        22289000
222900                                                                  22290000
222910                                                                  22291000
222920******************************************************************22292000
222930* C H E C K   A T M   T X S   F O R   U N C O L L .   F U N D S  *22293000
222940******************************************************************22294000
222950 P8500-CHK-FOR-UNCOLL-FUNDS.                                      22295000
222960     IF DSDSTXL-AMOUNT GREATER THAN CURRENT-BALANCE               22296000
222970         GO TO P8509-EXIT.                                        22297000
222980     COMPUTE TEMP-CURR-BAL =                                      22298000
222990         CURRENT-BALANCE -                                        22299000
223000         (ONE-DAY-FLOAT-AMT + TWO-DAY-FLOAT-AMT +                 22300000
223010         THREE-DAY-FLOAT-AMT + FOUR-DAY-FLOAT-AMT +               22301000
223020         FIVE-DAY-FLOAT-AMT).                                     22302000
223030     IF DSDSTXL-AMOUNT GREATER THAN TEMP-CURR-BAL                 22303000
223040         GO TO P8505-DRAWING-ON-UNCOLL-FUNDS.                     22304000
223050     GO TO P8509-EXIT.                                            22305000
223060                                                                  22306000
223070 P8505-DRAWING-ON-UNCOLL-FUNDS.                                   22307000
223080     MOVE 32 TO HOLD-REASON-CODE.                                 22308000
223090     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            22309000
223100                                                                  22310000
223110 P8509-EXIT.                                                      22311000
223120     EXIT.                                                        22312000
223130                                                                  22313000
223140******************************************************************22314000
223150*P E G G E D   B A L A N C E   A D J U S T M E N T   N O T I C E *22315000
223160******************************************************************22316000
223170 P8510-BUILD-PEG-ADJ-NTC.                                         22317000
223180     MOVE 087 TO SUB1.                                            22318000
223190     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               22319000
223200     IF HOLD-FREQ-RPT = 0                                         22320000
223210         GO TO P8519-EXIT.                                        22321000
223220     MOVE SPACES TO SPECIAL-WORK.                                 22322000
223230     MOVE 087 TO PN-REPORT-CODE.                                  22323000
223240*    MOVE PROC-FILE-ID TO PN-FILE-ID.                             22324000
223250     MOVE 'DDA'        TO PN-FILE-ID.                             22325000
223260     MOVE BCF-BANK-NO TO PN-BANK-NO.                              22326000
223270     MOVE ACCOUNT-ID TO PN-ACCT-ID.                               22327000
223280     MOVE ACCOUNT-NUMBER TO PN-ACCT-NO.                           22328000
223290     MOVE LOW-VALUES TO PN-CRF-REC-ID.                            22329000
223300     MOVE INV-PLAN TO PN-INV-PLAN.                                22330000
223310     MOVE INV-PEGGED-BAL TO PN-PEGGED-BAL.                        22331000
223320     MOVE INV-PREV-PEGGED-BAL TO PN-PREV-PEG-BAL.                 22332000
223330     MOVE PROC-NEXT-DATE TO PN-EFFECT-DATE.                       22333000
223340     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           22334000
223350                                                                  22335000
223360 P8519-EXIT.                                                      22336000
223370     EXIT.                                                        22337000
223380                                                                  22338000
223390******************************************************************22339000
223400*  A D D I T I O N A L   M A R G I N   N O T I C E    (SL ONLY)  *22340000
223410******************************************************************22341000
223420 P8520-BUILD-ADDTNL-MARGIN-NTC.                                   22342000
223430     IF AUTH-CREDIT-LIMIT = ZEROS                                 22343000
223440         GO TO P8529-EXIT.                                        22344000
223450     IF ODB-LOAN-BAL GREATER THAN AUTH-CREDIT-LIMIT               22345000
223460         NEXT SENTENCE                                            22346000
223470       ELSE                                                       22347000
223480         GO TO P8529-EXIT.                                        22348000
223490     MOVE 086 TO SUB1.                                            22349000
223500     PERFORM P8100-CHECK-FREQUENCY THRU P8109-EXIT.               22350000
223510     IF HOLD-FREQ-RPT = 0                                         22351000
223520         GO TO P8529-EXIT.                                        22352000
223530     MOVE SPACES TO SPECIAL-WORK.                                 22353000
223540     MOVE 086 TO AM-REPORT-CODE.                                  22354000
223550*    MOVE PROC-FILE-ID TO AM-FILE-ID.                             22355000
223560     MOVE 'DDA'        TO AM-FILE-ID.                             22356000
223570     MOVE BCF-BANK-NO TO AM-BANK-NO.                              22357000
223580     MOVE ACCOUNT-ID TO AM-ACCT-ID.                               22358000
223590     MOVE ACCOUNT-NUMBER TO AM-ACCT-NO.                           22359000
223600     MOVE LOW-VALUES TO AM-CRF-REC-ID.                            22360000
223610     MOVE ODB-PLAN TO AM-ODB-PLAN.                                22361000
223620     MOVE ODB-LOAN-BAL TO AM-LOAN-BAL.                            22362000
223630     MOVE AUTH-CREDIT-LIMIT TO AM-CREDIT-LIMIT.                   22363000
223640     MOVE PROC-CURR-DATE TO AM-CURR-DATE.                         22364000
223650     PERFORM P8030-WRITE-SPECIAL-FORMS THRU P8039-EXIT.           22365000
223660                                                                  22366000
223670 P8529-EXIT.                                                      22367000
223680     EXIT.                                                        22368000
223690                                                                  22369000
223700******************************************************************22370000
223710*  C H E C K   T A R G E T   B A L A N C E                       *22371000
223720******************************************************************22372000
223730 P8530-CHK-TARGET-BALANCE.                                        22373000
223740     ADD CURRENT-BALANCE  INV-BALANCE                             22374000
223750         GIVING HOLD-TARGET-BALANCE.                              22375000
223760     IF INV-TARGET-BAL-LOW = ZEROS                                22376000
223770         GO TO P8535-CHK-HIGH.                                    22377000
223780     IF HOLD-TARGET-BALANCE LESS THAN INV-TARGET-BAL-LOW          22378000
223790         MOVE 16 TO HOLD-REASON-CODE                              22379000
223800         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT             22380000
223810         GO TO P8539-EXIT.                                        22381000
223820                                                                  22382000
223830 P8535-CHK-HIGH.                                                  22383000
223840     IF INV-TARGET-BAL-HIGH = ZEROS                               22384000
223850         GO TO P8539-EXIT.                                        22385000
223860     IF HOLD-TARGET-BALANCE GREATER THAN INV-TARGET-BAL-HIGH      22386000
223870         MOVE 17 TO HOLD-REASON-CODE                              22387000
223880         PERFORM P7570-INV-EXCEPTIONS THRU P7579-EXIT.            22388000
223890                                                                  22389000
223900 P8539-EXIT.                                                      22390000
223910     EXIT.                                                        22391000
223920                                                                  22392000
223930******************************************************************22393000
223940*    C H E C K   F O R   R E G   ' E '   V I O L A T I O N S     *22394000
223950******************************************************************22395000
223960 P8550-CHK-REG-E-VIOLATION.                                       22396000
223970     IF SAV-ACCOUNT                                               22397000
223980         NEXT SENTENCE                                            22398000
223990       ELSE                                                       22399000
224000         GO TO P8559-EXIT.                                        22400000
224010     IF STMT-CYCLE-CODE = +046 OR +099                            22401000
224020         GO TO P8559-EXIT.                                        22402000
224030     IF STMT-CYCLE-CODE GREATER THAN +030                         22403000
224040         GO TO P8555-VIOLATION.                                   22404000
224050     GO TO P8559-EXIT.                                            22405000
224060                                                                  22406000
224070 P8555-VIOLATION.                                                 22407000
224080     MOVE 33 TO HOLD-REASON-CODE.                                 22408000
224090     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            22409000
224100                                                                  22410000
224110 P8559-EXIT.                                                      22411000
224120     EXIT.                                                        22412000
224130                                                                  22413000
224140******************************************************************22414000
224150*     G E T   D D A   L I N K E D   T O   S E C O N D A R Y      *22415000
224160******************************************************************22416000
224170 P8560-GET-DDA-LINKED-TO-SEC.                                     22417000
224180     MOVE PROC-BK-NO     TO DSXRF-OSB-BANK-NBR.                   22418000
224190     MOVE SPACES         TO CIF-XREF-KEY.                         22419000
224200     MOVE ACCOUNT-ID     TO HOLD-DDA-ACCT-ID-LINKED-TO-SEC        22420000
224210                            XKEY-DSDS-ACCT-ID.                    22421000
224220     MOVE ACCOUNT-NUMBER TO HOLD-DDA-ACCT-NO-LINKED-TO-SEC        22422000
224230                            XKEY-DSDS-ACCT-NBR.                   22423000
224240     MOVE 'DDA'          TO DSXRF-OSB-FILE-ID.                    22424000
224250     MOVE CIF-XREF-KEY   TO DSXRF-OSB-FILE-KEY.                   22425000
224260     EXEC SQL                                                     22426000
224270         SELECT                                                   22427000
224280             DSXRF_BANK_NBR,                                      22428000
224290             DSXRF_ACCT_ID,                                       22429000
224300             DSXRF_ACCT_NBR,                                      22430000
224310             DSXRF_OSB_BANK_NBR,                                  22431000
224320             DSXRF_OSB_FILE_ID,                                   22432000
224330             DSXRF_OSB_FILE_KEY                                   22433000
224340         INTO                                                     22434000
224350            :DSXRF-BANK-NBR,                                      22435000
224360            :DSXRF-ACCT-ID,                                       22436000
224370            :DSXRF-ACCT-NBR,                                      22437000
224380            :DSXRF-OSB-BANK-NBR,                                  22438000
224390            :DSXRF-OSB-FILE-ID,                                   22439000
224400            :DSXRF-OSB-FILE-KEY                                   22440000
224410         FROM DSDS.OSBXREF                                        22441000
224420         WHERE DSXRF_OSB_BANK_NBR = :DSXRF-OSB-BANK-NBR AND       22442000
224430               DSXRF_OSB_FILE_ID  = :DSXRF-OSB-FILE-ID  AND       22443000
224440               DSXRF_OSB_FILE_KEY = :DSXRF-OSB-FILE-KEY           22444000
224450     END-EXEC.                                                    22445000
224460                                                                  22446000
224470     EVALUATE SQLCODE                                             22447000
224480         WHEN ZEROS                                               22448000
224490             GO TO P8566-FOUND-SEC-LINK                           22449000
224500         WHEN +100                                                22450000
224510         WHEN -811                                                22451000
224520             GO TO P8569-EXIT                                     22452000
224530         WHEN OTHER                                               22453000
224540             CALL 'CDCUT90' USING SQLCA                           22454000
224550             CALL 'CDCDUMP' USING BY CONTENT '2106'               22455000
224560     END-EVALUATE.                                                22456000
224570                                                                  22457000
224580 P8566-FOUND-SEC-LINK.                                            22458000
224590     MOVE DSXRF-ACCT-NBR TO HOLD-DDA-ACCT-NO-LINKED-TO-SEC.       22459000
224600                                                                  22460000
224610 P8569-EXIT.                                                      22461000
224620     EXIT.                                                        22462000
224630                                                                  22463000
224640******************************************************************22464000
224650* SUBROUTINE - C R E A T E  P O S T E D  D E T A I L  R E C O R D*22465000
224660******************************************************************22466000
224670 P8570-BUILD-POSTED-DTL.                                          22467000
224680     MOVE DSDSTXL-BANK-NO TO PDTX-BANK-NO.                        22468000
224690     MOVE DSDSTXL-ACCT-ID TO PDTX-ACCT-ID.                        22469000
224700     MOVE DSDSTXL-ACCT-NO TO PDTX-ACCT-NO.                        22470000
224710     MOVE DSDSTXL-CODE TO PDTX-TX-CODE.                           22471000
224720     MOVE DSDSTXL-SORT-KEY TO PDTX-SORT-KEY.                      22472000
224730     MOVE DSDSTXL-CHK-NO TO PDTX-CHK-NO.                          22473000
224740     MOVE DSDSTXL-AMOUNT TO PDTX-TX-AMT.                          22474000
224750     IF DSDSTXL-EFFECT-DT = ZEROS                                 22475000
224760         MOVE PROC-CURR-DATE TO DSDSTXL-EFFECT-DT.                22476000
224770     IF DSDSTXL-EFFECT-DT = PROC-CURR-DATE                        22477000
224780         MOVE ZEROS TO PDTX-TX-BACKDATE-DAYS                      22478000
224790       ELSE                                                       22479000
224800         CALL 'CDCDT11' USING DSDSTXL-EFFECT-DT                   22480000
224810                              PROC-CURR-DATE                      22481000
224820                              DAYS-11                             22482000
224830         IF DAYS-11 GREATER THAN DAYS-IN-CYCLE                    22483000
224840             MOVE DAYS-IN-CYCLE TO PDTX-TX-BACKDATE-DAYS          22484000
224850           ELSE                                                   22485000
224860             MOVE DAYS-11 TO PDTX-TX-BACKDATE-DAYS.               22486000
224870     MOVE PROC-CURR-DATE TO PDTX-TX-POST-DT.                      22487000
224880     MOVE DSDSTXL-INV-CUSIP TO PDTX-INV-CUSIP.                    22488000
224890     IF DSDSTXL-CODE = 671                                        22489000
224900         MOVE HOLD-RP-SECURE-AMT TO PDTX-INV-PAR-VALUE            22490000
224910       ELSE                                                       22491000
224920         MOVE ZEROS TO PDTX-INV-PAR-VALUE.                        22492000
224930     MOVE SAVE-ENCL-SW TO PDTX-ENCL-SW.                           22493000
224940     MOVE DSDSTXL-ITEM-COUNT TO PDTX-ITEM-COUNT.                  22494000
224950     MOVE DSDSTXL-BAT-NO TO PDTX-BATCH-NO.                        22495000
224960     MOVE DSDSTXL-SEQ-NO TO PDTX-SEQ-NO.                          22496000
224970     MOVE DSDSTXL-DESC TO PDTX-DESC.                              22497000
224980     MOVE DSDSTXL-CO-DESC TO PDTX-CO-DESC.                        22498000
224990     MOVE DSDSTXL-POS-TX-DATE TO PDTX-POS-TX-DATE.                22499000
225000     MOVE DSDSTXL-POS-REF-NBR TO PDTX-POS-REF-NBR.                22500000
225010     MOVE DSDSTXL-ACH-PAR-NBR TO PDTX-ACH-PAR-NBR.                22501000
225020     MOVE DSDSTXL-ACH-STD-ENTRY-CLASS TO PDTX-ACH-STD-ENTRY-CLASS.22502000
225030     MOVE DSDSTXL-FOR-ATM-DESC TO PDTX-FOR-ATM-DESC.              22503000
225040     MOVE DSDSTXL-DESC-FORMAT TO PDTX-DESC-FORMAT.                22504000
225050     MOVE DSDSTXL-ACH-DISC-DATA TO PDTX-ACH-DISC-DATA.            22505000
225060     MOVE DSDSTXL-CODE TO TX-CODE-WK.                             22506000
225070     IF DEBIT-TX OR CREDIT-TX                                     22507000
225080         MOVE CURRENT-BALANCE TO PDTX-TX-BALANCE                  22508000
225090       ELSE                                                       22509000
225100         MOVE ZEROS TO PDTX-TX-BALANCE.                           22510000
225110                                                                  22511000
225120 P8571-EXIT.                                                      22512000
225130     EXIT.                                                        22513000
225140******************************************************************22514000
225150*            A C C U M  P O S T E D  D E T A I L                 *22515000
225160******************************************************************22516000
225170 P8572-ACCUM-POSTED-DTL.                                          22517000
225180     PERFORM P8630-ACCUM-POSTED-DTL THRU P8659-EXIT.              22518000
225190                                                                  22519000
225200******************************************************************22520000
225210*                W R I T E   P O S T E D   D E T A I L           *22521000
225220******************************************************************22522000
225230 P8574-WRITE-POSTED-DTL.                                          22523000
225240     IF PDTX-SORT-KEY = NON-SER-CHK-KEY OR SER-CHK-KEY            22524000
225250         ADD 1 TO NUM-CHECKS-ON-STMT                              22525000
225260         ADD PDTX-TX-AMT TO AMT-CHECKS-ON-STMT.                   22526000
225270     WRITE POSTED-DTL FROM PD-PDR.                                22527000
225280                                                                  22528000
225290 P8576-WRITE-PD-EXIT.                                             22529000
225300     IF PDTX-TX-CODE GREATER THAN 994                             22530000
225310         GO TO P8579-BUILD-PD-EXIT.                               22531000
225320     IF WATCHED OR WATCHED-ACH                                    22532000
225330         IF PDTX-TX-CODE = 535 OR 750 OR 515 OR 516               22533000
225340             NEXT SENTENCE                                        22534000
225350           ELSE                                                   22535000
225360             MOVE 'P' TO HOLD-WA-TX-DISP                          22536000
225370             PERFORM P7250-BUILD-WATCHED-ACCT THRU P7259-EXIT.    22537000
225380     IF PDTX-TX-CODE GREATER THAN 679                             22538000
225390         IF PDTX-TX-CODE LESS THAN 690                            22539000
225400             PERFORM P7120-BUILD-ODB-ACTIVITY THRU P7129-EXIT     22540000
225410             WRITE ODB-HIST-DTL FROM PD-PDR                       22541000
225420             GO TO P8579-BUILD-PD-EXIT.                           22542000
225430     IF PDTX-TX-CODE GREATER THAN 670                             22543000
225440         IF PDTX-TX-CODE LESS THAN 680                            22544000
225450             GO TO P8579-BUILD-PD-EXIT.                           22545000
225460     IF DSDSTXL-CODE = 500                                        22546000
225470         GO TO P8579-BUILD-PD-EXIT.                               22547000
225480     IF PDTX-TX-CODE LESS THAN 460                                22548000
225490         GO TO P8579-BUILD-PD-EXIT.                               22549000
225500     PERFORM P8660-POSTING-JRNL-DTL THRU P8679-EXIT.              22550000
225510     IF PDTX-TX-CODE = 460 OR                                     22551000
225520        PDTX-TX-CODE GREATER THAN 699                             22552000
225530         PERFORM P7620-DEBIT-LIST-IN-AMT-SEQ THRU P7629-EXIT.     22553000
225540                                                                  22554000
225550 P8579-BUILD-PD-EXIT.                                             22555000
225560     EXIT.                                                        22556000
225570                                                                  22557000
225580******************************************************************22558000
225590* SUBROUTINE - C R E A T E  S.C.  S T A T E M E N T  H E A D E R *22559000
225600******************************************************************22560000
225610 P8580-BUILD-SC-STMT-HDR.                                         22561000
225620     IF PROC-DSS                                                  22562000
225630         GO TO P8589-BUILD-SCH-EXIT.                              22563000
225640     MOVE 1 TO SC-HDR-SW.                                         22564000
225650     MOVE SPACES TO POSTED-WORK.                                  22565000
225660     MOVE BCF-BANK-NO TO SCH-BANK-NO.                             22566000
225670     MOVE ACCOUNT-ID TO SCH-ACCT-ID.                              22567000
225680     MOVE ACCOUNT-NUMBER TO SCH-ACCT-NO.                          22568000
225690     MOVE HOLD-REPORT-CODE TO SCH-REPORT-CODE.                    22569000
225700     MOVE RELATED-ACCT-CODE TO SCH-REL-ACCT-CODE.                 22570000
225710     MOVE PRIMARY-OFFICER TO SCH-OFF-CODE1.                       22571000
225720     MOVE SC-DISP TO SCH-SC-DISP.                                 22572000
225730     MOVE SC-ROUTINE TO SCH-SC-ROUTINE.                           22573000
225740     MOVE ACCOUNT-TYP TO SCH-ACCT-TYPE.                           22574000
225750     MOVE ACCOUNT-CLASS TO SCH-ACCT-CLASS.                        22575000
225760     MOVE SERV-CHRG-STMT-IND TO SCH-SC-ANL-STMT-IND.              22576000
225770     MOVE ACCT-ANAL-OFFICER TO SCH-SC-ANAL-OFFICER.               22577000
225780     IF INV-PLAN = SPACES OR 'IC'                                 22578000
225790         MOVE ZEROS TO SCH-INV-SWEEP-FEE                          22579000
225800       ELSE                                                       22580000
225810         MOVE INV-SWEEP-FEE TO SCH-INV-SWEEP-FEE                  22581000
225820         MOVE INV-ACCR-BASIS-IND TO SCH-INV-ACCR-BASIS-IND.       22582000
225830     MOVE ZEROS TO SCH-PC-DIALUP-INQ-FEE.                         22583000
225840     WRITE STMT-HDR FROM PD-SCH.                                  22584000
225850                                                                  22585000
225860 P8589-BUILD-SCH-EXIT.                                            22586000
225870     EXIT.                                                        22587000
225880                                                                  22588000
225890******************************************************************22589000
225900* SUBROUTINE - C R E A T E  P O S T E D  D E T A I L  H E A D E R*22590000
225910******************************************************************22591000
225920 P8590-BUILD-PD-HEADER.                                           22592000
225930     MOVE SPACES TO POSTED-WORK.                                  22593000
225940     MOVE BCF-BANK-NO TO PDH-BANK-NO.                             22594000
225950     MOVE ACCOUNT-ID TO PDH-ACCT-ID.                              22595000
225960     MOVE ACCOUNT-NUMBER TO PDH-ACCT-NO.                          22596000
225970     MOVE HOLD-REPORT-CODE TO PDH-REPORT-CODE.                    22597000
225980     MOVE DTE-LAST-CYCLE-STMT TO PDH-LAST-STMT-DT.                22598000
225990     MOVE AMT-LAST-CYCLE-STMT TO PDH-STMT-BAL.                    22599000
226000     IF CYCLE-THIS-STMT = 0                                       22600000
226010         IF DTE-LAST-SPEC-STMT NOT = ZERO                         22601000
226020             IF DTE-LAST-SPEC-STMT GREATER THAN                   22602000
226030                                             DTE-LAST-CYCLE-STMT  22603000
226040                 MOVE DTE-LAST-SPEC-STMT TO PDH-LAST-STMT-DT      22604000
226050                 MOVE AMT-LAST-SPEC-STMT TO PDH-STMT-BAL.         22605000
226060     MOVE CURRENT-BALANCE TO PDH-ENDING-BAL.                      22606000
226070     IF STMT-TRUNCATED OR                                         22607000
226080        REQ-STMT-NO-ENCL = 1                                      22608000
226090         MOVE ZEROS TO PDH-NO-ENCLOSURES                          22609000
226100       ELSE                                                       22610000
226110         ADD NUM-ENCLOSURES TO NUM-CYCLE-ENCL                     22611000
226120         MOVE NUM-ENCLOSURES TO PDH-NO-ENCLOSURES.                22612000
226130     IF DDA-SEC-STMT AND                                          22613000
226140        (STMT-WITH-CHECKS OR STMT-TRUNCATED)                      22614000
226150         MOVE ZEROS TO PDH-NO-ENCLOSURES.                         22615000
226160     IF CYCLE-THIS-STMT = 1                                       22616000
226170         PERFORM P8850-CREATE-OBS-ENCL-TX THRU P8854-EXIT.        22617000
226180     MOVE AMT-DEBITS TO PDH-DEBIT-AMOUNT.                         22618000
226190     MOVE AMT-CREDITS TO PDH-CREDIT-AMOUNT.                       22619000
226200     MOVE HDR-KEY TO PDH-SORT-KEY.                                22620000
226210     MOVE PROC-CURR-DATE TO PDH-CURR-PROC-DT.                     22621000
226220     MOVE ACCOUNT-CLASS TO PDH-ACCT-CLASS.                        22622000
226230     MOVE ZEROS TO PDH-INV-MAT-DATE.                              22623000
226240     MOVE SPACE TO PDH-INV-RENEW-CODE.                            22624000
226250     IF CYCLE-THIS-SC-EARN = 0                                    22625000
226260         MOVE DAYS-IN-CYCLE TO PDH-NO-DAYS-IN-CYC                 22626000
226270       ELSE                                                       22627000
226280         MOVE HOLD-DAYS-IN-CYCLE TO PDH-NO-DAYS-IN-CYC.           22628000
226290     IF DORMANT OR DORMANT-DECEASED                               22629000
226300         MOVE DAYS-SINCE-LAST-STMT TO PDH-NO-DAYS-IN-CYC          22630000
226310     END-IF.                                                      22631000
226320     IF DDA-SEC-STMT                                              22632000
226330         PERFORM P8560-GET-DDA-LINKED-TO-SEC THRU P8569-EXIT      22633000
226340         MOVE HOLD-DDA-ACCT-ID-LINKED-TO-SEC TO                   22634000
226350             PDH-ACCT-ID-LINKED-TO-SEC                            22635000
226360         MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC TO                   22636000
226370             PDH-ACCT-NO-LINKED-TO-SEC                            22637000
226380       ELSE                                                       22638000
226390         MOVE ACCOUNT-ID TO PDH-ACCT-ID-LINKED-TO-SEC             22639000
226400         MOVE ACCOUNT-NUMBER TO PDH-ACCT-NO-LINKED-TO-SEC.        22640000
226410     MOVE INV-PLAN TO PDH-INV-PLAN.                               22641000
226420     MOVE STMT-CYCLE-CODE TO PDH-STMT-CYCLE-CODE.                 22642000
226430     MOVE STMT-DISP-CODE TO PDH-STMT-DISP.                        22643000
226440     MOVE ZEROS TO PDH-DATE-CLOSED.                               22644000
226450     IF CLOSED                                                    22645000
226460         MOVE DATE-CLOSED TO PDH-DATE-CLOSED.                     22646000
226470     IF BCFSCR-PREPAID-CARD                                       22647000
226480         DISPLAY 'CDCINFO (DSDS100) PREPAID CARD '                22648000
226490         'BANK: ' BCF-BANK-NO ' ACCOUNT: ' ACCOUNT-NUMBER         22649000
226500         MOVE 'Y'                 TO PDH-PREPAID-CARD-SW          22650000
226510     END-IF.                                                      22651000
226520     WRITE STMT-HDR FROM PD-PDH.                                  22652000
226530                                                                  22653000
226540 P8599-BUILD-PDH-EXIT.                                            22654000
226550     EXIT.                                                        22655000
226560                                                                  22656000
226570******************************************************************22657000
226580* SUBROUTINE - C R E A T E  H I S T O R Y  C A R D  H E A D E R  *22658000
226590******************************************************************22659000
226600 P8600-BUILD-HC-HEADER.                                           22660000
226610     MOVE 1 TO HC-HDR-SW.                                         22661000
226620     MOVE SPACES TO POSTED-WORK.                                  22662000
226630     MOVE BCF-BANK-NO TO HCH-BANK-NO.                             22663000
226640     MOVE ACCOUNT-ID TO HCH-ACCT-ID.                              22664000
226650     MOVE ACCOUNT-NUMBER TO HCH-ACCT-NO.                          22665000
226660     MOVE HOLD-REPORT-CODE TO HCH-REPORT-CODE.                    22666000
226670     MOVE ODB-REVIEW-DATE TO HCH-REVIEW-DT.                       22667000
226680     MOVE YEARLY-BEGIN-BAL TO HCH-STMT-BAL.                       22668000
226690     MOVE HISTORY-CARD-IND TO HCH-REASON.                         22669000
226700     MOVE ODB-RATE-VARIANCE TO HCH-RATE-VARIANCE.                 22670000
226710     MOVE ODB-RATE-VARI-IND TO HCH-RATE-VARI-IND.                 22671000
226720     MOVE '0' TO HISTORY-CARD-IND.                                22672000
226730     WRITE STMT-HDR FROM PD-HCH.                                  22673000
226740                                                                  22674000
226750 P8609-BUILD-HCH-EXIT.                                            22675000
226760     EXIT.                                                        22676000
226770                                                                  22677000
226780******************************************************************22678000
226790* SUBROUTINE - C R E A T E  O.S.B.  S A V I N G S  H E A D E R   *22679000
226800******************************************************************22680000
226810 P8610-BUILD-OSB-SAV-HEADER.                                      22681000
226820     MOVE SPACES              TO POSTED-WORK.                     22682000
226830     MOVE BCF-BANK-NO         TO OSH-BANK-NO.                     22683000
226840     MOVE ACCOUNT-ID          TO OSH-ACCT-ID                      22684000
226850                                 OSH-DDA-ACCT-ID                  22685000
226860                                 HOLD-OSH-DDA-ACCT-ID.            22686000
226870     MOVE ACCOUNT-NUMBER      TO OSH-ACCT-NO                      22687000
226880                                 OSH-DDA-ACCT-NO                  22688000
226890                                 HOLD-OSH-DDA-ACCT-NO.            22689000
226900     MOVE HOLD-REPORT-CODE    TO OSH-REPORT-CODE.                 22690000
226910     MOVE AMT-LAST-CYCLE-STMT TO OSH-STMT-BAL.                    22691000
226920     MOVE DTE-LAST-CYCLE-STMT TO OSH-LAST-STMT-DT.                22692000
226930     IF CYCLE-THIS-STMT = 0                                       22693000
226940         IF DTE-LAST-SPEC-STMT NOT = ZERO                         22694000
226950             IF DTE-LAST-SPEC-STMT GREATER THAN                   22695000
226960                                             DTE-LAST-CYCLE-STMT  22696000
226970                 MOVE DTE-LAST-SPEC-STMT TO OSH-LAST-STMT-DT      22697000
226980                 MOVE AMT-LAST-SPEC-STMT TO OSH-STMT-BAL.         22698000
226990     MOVE INT-PAID-LAST-CYCLE      TO OSH-INT-PER1.               22699000
227000     IF TDY-MO = 01                                               22700000
227010         MOVE INT-PAID-PREV-YR     TO OSH-INT-PD-YTD              22701000
227020       ELSE                                                       22702000
227030         MOVE INT-PAID-YTD         TO OSH-INT-PD-YTD.             22703000
227040     MOVE STMT-DISP-CODE           TO OSH-STMT-DISP.              22704000
227050     MOVE STMT-CYCLE-CODE          TO OSH-STMT-CYCLE-CODE.        22705000
227060     MOVE SC-ROUTINE               TO OSH-SC-ROUTINE.             22706000
227070     MOVE ZEROS                    TO OSH-DATE-CLOSED.            22707000
227080     IF CLOSED                                                    22708000
227090         MOVE DATE-CLOSED          TO OSH-DATE-CLOSED.            22709000
227100     MOVE CURRENT-BALANCE          TO OSH-ENDING-BAL.             22710000
227110     MOVE AMT-DEBITS               TO OSH-DEBIT-AMOUNT.           22711000
227120     MOVE AMT-CREDITS              TO OSH-CREDIT-AMOUNT.          22712000
227130     IF CYCLE-THIS-SC-EARN = 0                                    22713000
227140         MOVE DAYS-IN-CYCLE        TO OSH-NO-DAYS-IN-CYC          22714000
227150       ELSE                                                       22715000
227160         MOVE HOLD-DAYS-IN-CYCLE   TO OSH-NO-DAYS-IN-CYC.         22716000
227170     IF REG-SAV-STMT                                              22717000
227180         GO TO P8618-WRITE-OSB-SAV-HDR.                           22718000
227190     MOVE PROC-BK-NO     TO DSXRF-OSB-BANK-NBR.                   22719000
227200     MOVE SPACES         TO CIF-XREF-KEY.                         22720000
227210     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    22721000
227220     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   22722000
227230     MOVE 'SAV'          TO DSXRF-OSB-FILE-ID.                    22723000
227240     MOVE CIF-XREF-KEY   TO DSXRF-OSB-FILE-KEY.                   22724000
227250     EXEC SQL                                                     22725000
227260         SELECT                                                   22726000
227270             DSXRF_BANK_NBR,                                      22727000
227280             DSXRF_ACCT_ID,                                       22728000
227290             DSXRF_ACCT_NBR,                                      22729000
227300             DSXRF_OSB_BANK_NBR,                                  22730000
227310             DSXRF_OSB_FILE_ID,                                   22731000
227320             DSXRF_OSB_FILE_KEY                                   22732000
227330         INTO                                                     22733000
227340            :DSXRF-BANK-NBR,                                      22734000
227350            :DSXRF-ACCT-ID,                                       22735000
227360            :DSXRF-ACCT-NBR,                                      22736000
227370            :DSXRF-OSB-BANK-NBR,                                  22737000
227380            :DSXRF-OSB-FILE-ID,                                   22738000
227390            :DSXRF-OSB-FILE-KEY                                   22739000
227400         FROM DSDS.OSBXREF                                        22740000
227410         WHERE DSXRF_OSB_BANK_NBR = :DSXRF-OSB-BANK-NBR AND       22741000
227420               DSXRF_OSB_FILE_ID  = :DSXRF-OSB-FILE-ID  AND       22742000
227430               DSXRF_OSB_FILE_KEY = :DSXRF-OSB-FILE-KEY           22743000
227440     END-EXEC.                                                    22744000
227450                                                                  22745000
227460     EVALUATE SQLCODE                                             22746000
227470         WHEN ZEROS                                               22747000
227480             GO TO P8616-OSH-FOUND-DDA-XREF                       22748000
227490         WHEN +100                                                22749000
227500         WHEN -811                                                22750000
227510             GO TO P8618-WRITE-OSB-SAV-HDR                        22751000
227520         WHEN OTHER                                               22752000
227530             CALL 'CDCUT90' USING SQLCA                           22753000
227540             CALL 'CDCDUMP' USING BY CONTENT '2107'               22754000
227550     END-EVALUATE.                                                22755000
227560                                                                  22756000
227570 P8616-OSH-FOUND-DDA-XREF.                                        22757000
227580     MOVE DSXRF-ACCT-NBR TO OSH-DDA-ACCT-NO                       22758000
227590                            HOLD-OSH-DDA-ACCT-NO.                 22759000
227600     MOVE 001 TO OSH-DDA-ACCT-ID                                  22760000
227610                 HOLD-OSH-DDA-ACCT-ID.                            22761000
227620                                                                  22762000
227630 P8618-WRITE-OSB-SAV-HDR.                                         22763000
227640     MOVE 1 TO OSB-SAV-HDR-SW.                                    22764000
227650     WRITE STMT-HDR FROM PD-OSH.                                  22765000
227660                                                                  22766000
227670 P8619-EXIT.                                                      22767000
227680     EXIT.                                                        22768000
227690                                                                  22769000
227700******************************************************************22770000
227710*    B U I L D  P O S T E D  D E T A I L  T R A I L E R  R E C.  *22771000
227720******************************************************************22772000
227730 P8620-BUILD-PD-TRAILER.                                          22773000
227740     IF NO-STMT                                                   22774000
227750         IF ACCOUNT-ID NOT = 010                                  22775000
227760             GO TO P8629-EXIT.                                    22776000
227770     MOVE SPACES TO POSTED-WORK.                                  22777000
227780     MOVE BCF-BANK-NO TO PDT-BANK-NO.                             22778000
227790     MOVE ACCOUNT-ID TO PDT-ACCT-ID.                              22779000
227800     MOVE ACCOUNT-NUMBER TO PDT-ACCT-NO.                          22780000
227810     IF DDA-OSB-STMT OR DDA-SEC-STMT                              22781000
227820         PERFORM P8960-BUILD-ODB-HDR THRU P8969-EXIT              22782000
227830         PERFORM P8980-BUILD-NOW-HDR THRU P8989-EXIT              22783000
227840         PERFORM P8970-BUILD-ODB-TRLR THRU P8979-EXIT             22784000
227850         IF INV-PLAN = SPACES OR 'IC'                             22785000
227860             NEXT SENTENCE                                        22786000
227870           ELSE                                                   22787000
227880             IF INV-CLOSED AND SPEC-REPORT-ID = ' '               22788000
227890                 NEXT SENTENCE                                    22789000
227900               ELSE                                               22790000
227910                 PERFORM P8990-BUILD-INV-TRLR THRU P8999-EXIT.    22791000
227920     IF OSB-SAV-HDR-SW = 1                                        22792000
227930         MOVE 0 TO OSB-SAV-HDR-SW                                 22793000
227940         MOVE 999 TO PDT-REPORT-CODE                              22794000
227950       ELSE                                                       22795000
227960         MOVE 998 TO PDT-REPORT-CODE.                             22796000
227970     MOVE TRLR-KEY TO PDT-SORT-KEY.                               22797000
227980     MOVE PROC-CURR-DATE TO PDT-CURR-PROC-DT.                     22798000
227990     MOVE CURR-BAL-ELG-WITH TO PDT-BAL-ELG.                       22799000
228000     MOVE HOLD-IMM-AVG-INV-BAL TO PDT-AVG-INV-BAL.                22800000
228010     MOVE HOLD-IMM-AVG-INT-RT TO PDT-AVG-INT-RATE.                22801000
228020     MOVE HOLD-APYE-INTEREST-RATE TO PDT-APYE-INT-RATE.           22802000
228030     MOVE EARN-BALANCE-CODE (SUB18) TO PDT-EARN-BAL-CODE.         22803000
228040     MOVE INT-PAID-LAST-CYCLE TO PDT-INT-PAID-CYC.                22804000
228050     MOVE ZEROS TO PDT-DDA-ACCT-ID                                22805000
228060                   PDT-DDA-ACCT-NO.                               22806000
228070     MOVE ACCRUED-INTEREST TO PDT-ACCRUED-INT.                    22807000
228080     IF INT-PAID-LAST-CYCLE EQUAL ZEROS                           22808000
228090         MOVE ZEROS TO PDT-APYE-INT-RATE                          22809000
228100     END-IF.                                                      22810000
228110                                                                  22811000
228120     IF PERSONAL                                                  22812000
228130         MOVE OD-FEES-CTD          TO PDT-OD-FEES-CTD             22813000
228140         MOVE OD-FEES-YTD          TO PDT-OD-FEES-YTD             22814000
228150         MOVE RET-CHK-FEES-CTD     TO PDT-RET-CK-FEES-CTD         22815000
228160         MOVE RET-CHK-FEES-YTD     TO PDT-RET-CK-FEES-YTD         22816000
228170         MOVE OD-FEES-REF-CTD      TO PDT-OD-FEES-REF-CTD         22817000
228180         MOVE OD-FEES-REF-YTD      TO PDT-OD-FEES-REF-YTD         22818000
228190         MOVE RET-CHK-FEES-REF-CTD TO PDT-RET-CK-FEES-REF-CTD     22819000
228200         MOVE RET-CHK-FEES-REF-YTD TO PDT-RET-CK-FEES-REF-YTD     22820000
228210       ELSE                                                       22821000
228220         MOVE ZEROS                TO PDT-OD-FEES-CTD             22822000
228230         MOVE ZEROS                TO PDT-OD-FEES-YTD             22823000
228240         MOVE ZEROS                TO PDT-RET-CK-FEES-CTD         22824000
228250         MOVE ZEROS                TO PDT-RET-CK-FEES-YTD         22825000
228260         MOVE ZEROS                TO PDT-OD-FEES-REF-CTD         22826000
228270         MOVE ZEROS                TO PDT-OD-FEES-REF-YTD         22827000
228280         MOVE ZEROS                TO PDT-RET-CK-FEES-REF-CTD     22828000
228290         MOVE ZEROS                TO PDT-RET-CK-FEES-REF-YTD     22829000
228300     END-IF.                                                      22830000
228310                                                                  22831000
228320 P8625-WRITE-PD-TRAILER.                                          22832000
228330     WRITE STMT-HDR FROM PD-PDT.                                  22833000
228340                                                                  22834000
228350 P8629-EXIT.                                                      22835000
228360     EXIT.                                                        22836000
228370                                                                  22837000
228380******************************************************************22838000
228390* SUBROUTINE - A C C U M U L A T E  P O S T E D  D E T A I L     *22839000
228400******************************************************************22840000
228410 P8630-ACCUM-POSTED-DTL.                                          22841000
228420     IF PDTX-TX-CODE = 990 OR 910 OR 913 OR 988                   22842000
228430         GO TO P8634-ACCUM-PD-REG-DEB.                            22843000
228440     IF PDTX-TX-CODE = 540  OR 543                                22844000
228450         GO TO P8652-ACCUM-PD-REG-CRE.                            22845000
228460     IF PDTX-TX-CODE LESS THAN 460                                22846000
228470         GO TO P8659-EXIT.                                        22847000
228480     IF PDTX-TX-CODE = 460                                        22848000
228490         GO TO P8634-ACCUM-PD-REG-DEB.                            22849000
228500     IF PDTX-TX-CODE LESS THAN 671                                22850000
228510         GO TO P8650-ACCUM-PD-CREDIT.                             22851000
228520     IF PDTX-TX-CODE LESS THAN 991                                22852000
228530         GO TO P8632-ACCUM-PD-DEBIT.                              22853000
228540     GO TO P8659-EXIT.                                            22854000
228550                                                                  22855000
228560 P8632-ACCUM-PD-DEBIT.                                            22856000
228570     IF DSDSTXL-CODE = 939                                        22857000
228580         ADD 1              TO NUM-CLSN-BR-DEBITS                 22858000
228590         ADD PDTX-TX-AMT    TO AMT-CLSN-BR-DEBITS                 22859000
228600     END-IF.                                                      22860000
228610     IF DSDSTXL-CO-DESC = 'ICS Sweep Debits'                      22861000
228620         ADD 1              TO NUM-ICS-DEBITS                     22862000
228630         ADD PDTX-TX-AMT    TO AMT-ICS-DEBITS                     22863000
228640         GO TO P8634-ACCUM-PD-REG-DEB                             22864000
228650     END-IF.                                                      22865000
228660     IF PDTX-TX-CODE = 780 OR 770 OR 778 OR 773                   22866000
228670         ADD PDTX-TX-AMT TO AMT-ATM-DEBITS                        22867000
228680         ADD 1 TO NUM-ATM-DEBITS                                  22868000
228690         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        22869000
228700         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22870000
228710     IF PDTX-TX-CODE = 779 OR 771                                 22871000
228720         ADD PDTX-TX-AMT TO AMT-ATM-DEBITS                        22872000
228730         ADD 1 TO NUM-ATM-DEBITS                                  22873000
228740         ADD 1 TO NUM-FOR-ATM-SC-DEBITS                           22874000
228750         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        22875000
228760         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22876000
228770     IF PDTX-TX-CODE = 775 OR 776 OR 777                          22877000
228780         ADD PDTX-TX-AMT TO AMT-ATM-DEBITS                        22878000
228790         ADD 1 TO NUM-ATM-DEBITS                                  22879000
228800         ADD 1 TO NUM-CHKPLUS-SC-DEBITS                           22880000
228810         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        22881000
228820         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22882000
228830     IF PDTX-TX-CODE = 785                                        22883000
228840         ADD 1 TO NUM-FT-ACH-DEBITS                               22884000
228850                  NUM-LIMIT-OF-6-DEBITS                           22885000
228860                  IMM-NTC-MM-CTR                                  22886000
228870         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22887000
228880         GO TO P8634-ACCUM-PD-REG-DEB.                            22888000
228890     IF PDTX-TX-CODE GREATER THAN 670 AND LESS THAN 676           22889000
228900         GO TO P8644-ACCUM-PD-INV-CREDIT.                         22890000
228910     IF PDTX-TX-CODE GREATER THAN 675 AND LESS THAN 680           22891000
228920         GO TO P8642-ACCUM-PD-INV-DEBIT.                          22892000
228930     IF PDTX-TX-CODE = 870 OR 874 OR 878                          22893000
228940         GO TO P8634-ACCUM-PD-REG-DEB.                            22894000
228950     IF PDTX-TX-CODE = 980                                        22895000
228960         ADD PDTX-TX-AMT TO AMT-ADS-DEBITS                        22896000
228970         ADD 1 TO NUM-ADS-DEBITS                                  22897000
228980                  NUM-FT-ACH-DEBITS                               22898000
228990                  NUM-LIMIT-OF-6-DEBITS                           22899000
229000                  IMM-NTC-MM-CTR                                  22900000
229010         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22901000
229020         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        22902000
229030         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22903000
229040     IF PDTX-TX-CODE = 972 OR 710 or 850                          22904000
229050         GO TO P8634-ACCUM-PD-REG-DEB.                            22905000
229060     IF PDTX-TX-CODE GREATER THAN 682 AND LESS THAN 689           22906000
229070         GO TO P8638-ACCUM-PD-ODB-DEBIT.                          22907000
229080     IF PDTX-TX-CODE GREATER THAN 679 AND LESS THAN 683           22908000
229090         GO TO P8640-ACCUM-PD-ODB-CREDIT.                         22909000
229100     IF PDTX-TX-CODE = 689                                        22910000
229110         GO TO P8640-ACCUM-PD-ODB-CREDIT.                         22911000
229120     IF PDTX-TX-CODE = 741                                        22912000
229130         ADD PDTX-TX-AMT TO AMT-FT-DEBITS                         22913000
229140         ADD 1 TO NUM-FT-DEBITS                                   22914000
229150                  NUM-FT-ACH-DEBITS                               22915000
229160                  NUM-LIMIT-OF-6-DEBITS                           22916000
229170                  IMM-NTC-MM-CTR                                  22917000
229180         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22918000
229190         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22919000
229200     IF PDTX-TX-CODE = 751                                        22920000
229210         ADD 1 TO NUM-ODB-DEBITS-DDA                              22921000
229220         ADD PDTX-TX-AMT TO AMT-ODB-DEBITS-DDA                    22922000
229230         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22923000
229240     IF PDTX-TX-CODE = 760                                        22924000
229250         ADD PDTX-TX-AMT TO AMT-FT-DEBITS                         22925000
229260         ADD 1 TO NUM-FT-DEBITS                                   22926000
229270                  NUM-FT-ACH-DEBITS                               22927000
229280                  NUM-LIMIT-OF-6-DEBITS                           22928000
229290                  IMM-NTC-MM-CTR                                  22929000
229300         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22930000
229310         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22931000
229320     IF PDTX-TX-CODE GREATER THAN 760 AND LESS THAN 764           22932000
229330         ADD PDTX-TX-AMT TO AMT-FT-DEBITS                         22933000
229340         ADD 1 TO NUM-FT-DEBITS                                   22934000
229350         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22935000
229360     IF PDTX-TX-CODE GREATER THAN 763 AND LESS THAN 770           22936000
229370         ADD PDTX-TX-AMT TO AMT-FT-DEBITS                         22937000
229380         ADD 1 TO NUM-FT-DEBITS                                   22938000
229390                  NUM-FT-ACH-DEBITS                               22939000
229400                  NUM-LIMIT-OF-6-DEBITS                           22940000
229410                  IMM-NTC-MM-CTR                                  22941000
229420         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22942000
229430         GO TO P8636-ACCUM-PD-DEB-BY-TYPE.                        22943000
229440     IF (PDTX-TX-CODE = 925 AND PDTX-BATCH-NO = 99919) OR         22944000
229450        (PDTX-TX-CODE = 924 AND PDTX-BATCH-NO = 99908)            22945000
229460         ADD 1 TO NUM-TELE-DEBITS                                 22946000
229470                  NUM-LIMIT-OF-6-DEBITS                           22947000
229480                  IMM-NTC-MM-CTR                                  22948000
229490         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22949000
229500         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        22950000
229510         GO TO P8634-ACCUM-PD-REG-DEB.                            22951000
229520     IF PDTX-TX-CODE = 920 OR 924 OR 925                          22952000
229530         ADD 1 TO NUM-TELE-DEBITS                                 22953000
229540                  NUM-LIMIT-OF-6-DEBITS                           22954000
229550                  IMM-NTC-MM-CTR                                  22955000
229560         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22956000
229570         GO TO P8634-ACCUM-PD-REG-DEB.                            22957000
229580     IF PDTX-TX-CODE = 869 OR 917 OR 942                          22958000
229590         ADD PDTX-TX-AMT TO AMT-ZBA-DEBITS                        22959000
229600         ADD 1 TO NUM-ZBA-DEBITS                                  22960000
229610         IF PDTX-TX-CODE = 869 OR 917                             22961000
229620             ADD 1 TO NUM-FT-ACH-DEBITS                           22962000
229630                      NUM-LIMIT-OF-6-DEBITS                       22963000
229640                      IMM-NTC-MM-CTR                              22964000
229650         END-IF                                                   22965000
229660         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22966000
229670         GO TO P8634-ACCUM-PD-REG-DEB.                            22967000
229680     IF PDTX-TX-CODE = 916                                        22968000
229690         ADD PDTX-TX-AMT TO AMT-ODP-DEBITS                        22969000
229700         ADD 1 TO NUM-ODP-DEBITS                                  22970000
229710                  NUM-FT-ACH-DEBITS                               22971000
229720                  NUM-LIMIT-OF-6-DEBITS                           22972000
229730                  IMM-NTC-MM-CTR                                  22973000
229740         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22974000
229750         GO TO P8634-ACCUM-PD-REG-DEB.                            22975000
229760     IF PDTX-TX-CODE = 919                                        22976000
229770         ADD 1 TO NUM-FT-ACH-DEBITS                               22977000
229780                  NUM-LIMIT-OF-6-DEBITS                           22978000
229790                  IMM-NTC-MM-CTR                                  22979000
229800         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22980000
229810         GO TO P8634-ACCUM-PD-REG-DEB.                            22981000
229820     IF PDTX-TX-CODE = 752 OR 774 OR 786 OR 853 OR 888 OR 889 OR  22982000
229830                       890 OR 891 OR 893 OR 894 OR                22983000
229840                       892 OR 902 OR 915 OR 922 OR 926 OR 933 OR  22984000
229850                       936 OR 938 OR 950 OR 973 OR 978            22985000
229860         ADD 1 TO NUM-FT-ACH-DEBITS                               22986000
229870                  NUM-LIMIT-OF-6-DEBITS                           22987000
229880                  IMM-NTC-MM-CTR                                  22988000
229890         PERFORM P8820-CHK-IMM-DEBITS THRU P8824-EXIT             22989000
229900         IF PDTX-TX-CODE = 774 OR 902                             22990000
229910             PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT    22991000
229920         END-IF                                                   22992000
229930         GO TO P8634-ACCUM-PD-REG-DEB.                            22993000
229940     IF PDTX-TX-CODE = 792 OR 793 OR 796 OR 896                   22994000
229950         ADD PDTX-TX-AMT TO RET-CHK-FEES-CTD                      22995000
229960                            RET-CHK-FEES-YTD                      22996000
229970         GO TO P8634-ACCUM-PD-REG-DEB.                            22997000
229980     IF PDTX-TX-CODE = 791 OR 797 OR 897                          22998000
229990         ADD PDTX-TX-AMT TO OD-FEES-CTD                           22999000
230000                            OD-FEES-YTD                           23000000
230010         GO TO P8634-ACCUM-PD-REG-DEB.                            23001000
230020     IF PDTX-TX-CODE = 787                                        23002000
230030         ADD PDTX-TX-AMT TO ODP-FEES                              23003000
230040         GO TO P8634-ACCUM-PD-REG-DEB.                            23004000
230050                                                                  23005000
230060 P8634-ACCUM-PD-REG-DEB.                                          23006000
230070     ADD PDTX-TX-AMT TO AMT-REG-DEBITS.                           23007000
230080     ADD 1 TO NUM-REG-DEBITS.                                     23008000
230090                                                                  23009000
230100 P8636-ACCUM-PD-DEB-BY-TYPE.                                      23010000
230110     MOVE ACCT-TYPE-CODE TO SUB9.                                 23011000
230120     ADD 1 TO NO-DEB-BY-TYPE (SUB9)                               23012000
230130              NO-DEB-BY-TYPE (100).                               23013000
230140     ADD PDTX-TX-AMT TO AMT-DEB-BY-TYPE (SUB9)                    23014000
230150                        AMT-DEB-BY-TYPE (100)                     23015000
230160                        DEBITS-BY-IDENT (SUB13).                  23016000
230170     ADD 1 TO PJ-DEB-NO.                                          23017000
230180     ADD PDTX-TX-AMT TO PJ-DEB-AMT.                               23018000
230190     IF BAI-ACCOUNT                                               23019000
230200         PERFORM P8730-BUILD-BAI-ACCT-DEBIT THRU P8739-EXIT.      23020000
230210     GO TO P8659-EXIT.                                            23021000
230220                                                                  23022000
230230 P8638-ACCUM-PD-ODB-DEBIT.                                        23023000
230240     IF PDTX-TX-CODE = 687                                        23024000
230250         ADD 1 TO NUM-FINANCE-CHARGE                              23025000
230260         ADD PDTX-TX-AMT TO AMT-FINANCE-CHARGE                    23026000
230270         GO TO P8659-EXIT.                                        23027000
230280     IF PDTX-TX-CODE = 686                                        23028000
230290         ADD 1 TO NUM-AUTO-ADVANCES                               23029000
230300         ADD PDTX-TX-AMT TO AMT-AUTO-ADVANCES                     23030000
230310                            ADVANCES-BY-PLAN-ODB (SUB10)          23031000
230320         MOVE PDTX-TX-AMT TO OBGL-ADVANCE-AMT                     23032000
230330         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23033000
230340         GO TO P8659-EXIT.                                        23034000
230350     IF PDTX-TX-CODE = 683                                        23035000
230360         ADD 1 TO NUM-MANUAL-ADVANCES                             23036000
230370         ADD PDTX-TX-AMT TO AMT-MANUAL-ADVANCES                   23037000
230380                            ADVANCES-BY-PLAN-ODB (SUB10)          23038000
230390         MOVE PDTX-TX-AMT TO OBGL-ADVANCE-AMT                     23039000
230400         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23040000
230410         GO TO P8659-EXIT.                                        23041000
230420     IF PDTX-TX-CODE = 684                                        23042000
230430         ADD 1 TO NUM-OVER-ADVANCES                               23043000
230440         ADD PDTX-TX-AMT TO AMT-OVER-ADVANCES                     23044000
230450                            ADVANCES-BY-PLAN-ODB (SUB10)          23045000
230460         MOVE PDTX-TX-AMT TO OBGL-ADVANCE-AMT                     23046000
230470         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23047000
230480         GO TO P8659-EXIT.                                        23048000
230490     IF PDTX-TX-CODE = 688                                        23049000
230500         ADD 1 TO NUM-CR-LIFE-CHARGE                              23050000
230510         ADD PDTX-TX-AMT TO AMT-CR-LIFE-CHARGE                    23051000
230520                            CRED-LIFE-COLL-BY-PLAN-ODB (SUB10)    23052000
230530         MOVE PDTX-TX-AMT TO OBGL-CREDIT-LIFE-AMT                 23053000
230540         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23054000
230550         GO TO P8659-EXIT.                                        23055000
230560     ADD 1 TO NUM-OTH-ODB-DEB.                                    23056000
230570     ADD PDTX-TX-AMT TO AMT-OTH-ODB-DEB                           23057000
230580                        ADVANCES-BY-PLAN-ODB (SUB10).             23058000
230590     MOVE PDTX-TX-AMT TO OBGL-ADVANCE-AMT.                        23059000
230600     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             23060000
230610     GO TO P8659-EXIT.                                            23061000
230620                                                                  23062000
230630 P8640-ACCUM-PD-ODB-CREDIT.                                       23063000
230640     IF PDTX-TX-CODE = 689                                        23064000
230650         ADD 1 TO NUM-AUTO-PAYMENTS                               23065000
230660         ADD PDTX-TX-AMT TO AMT-AUTO-PAYMENTS                     23066000
230670                            PAYMENTS-BY-PLAN-ODB (SUB10)          23067000
230680         MOVE PDTX-TX-AMT TO OBGL-PAYMENT-AMT                     23068000
230690         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23069000
230700         GO TO P8659-EXIT.                                        23070000
230710     IF PDTX-TX-CODE = 680                                        23071000
230720         ADD 1 TO NUM-MANUAL-PAYMENTS                             23072000
230730         ADD PDTX-TX-AMT TO AMT-MANUAL-PAYMENTS                   23073000
230740                            PAYMENTS-BY-PLAN-ODB (SUB10)          23074000
230750         MOVE PDTX-TX-AMT TO OBGL-PAYMENT-AMT                     23075000
230760         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23076000
230770         GO TO P8659-EXIT.                                        23077000
230780     IF PDTX-TX-CODE = 682                                        23078000
230790         ADD 1 TO NUM-PAYOFFS                                     23079000
230800         ADD PDTX-TX-AMT TO AMT-PAYOFFS                           23080000
230810                            PAYMENTS-BY-PLAN-ODB (SUB10)          23081000
230820         MOVE PDTX-TX-AMT TO OBGL-PAYMENT-AMT                     23082000
230830         PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT          23083000
230840         GO TO P8659-EXIT.                                        23084000
230850     ADD 1 TO NUM-OTH-ODB-CRE.                                    23085000
230860     ADD PDTX-TX-AMT TO AMT-OTH-ODB-CRE                           23086000
230870                        PAYMENTS-BY-PLAN-ODB (SUB10).             23087000
230880     MOVE PDTX-TX-AMT TO OBGL-PAYMENT-AMT.                        23088000
230890     PERFORM P9310-INSERT-ODB-TOTALS THRU P9319-EXIT.             23089000
230900     GO TO P8659-EXIT.                                            23090000
230910                                                                  23091000
230920 P8642-ACCUM-PD-INV-DEBIT.                                        23092000
230930     IF PDTX-TX-CODE = 676                                        23093000
230940         ADD 1 TO NUM-INV-MATURITIES                              23094000
230950         ADD PDTX-TX-AMT TO AMT-INV-MATURITIES                    23095000
230960                            MATURITIES-BY-PLAN-INV (SUB11)        23096000
230970         GO TO P8659-EXIT.                                        23097000
230980     GO TO P8659-EXIT.                                            23098000
230990                                                                  23099000
231000 P8644-ACCUM-PD-INV-CREDIT.                                       23100000
231010     IF PDTX-TX-CODE = 671                                        23101000
231020         ADD 1 TO NUM-INV-PURCHASES                               23102000
231030         ADD PDTX-TX-AMT TO AMT-INV-PURCHASES                     23103000
231040                            PURCHASES-BY-PLAN-INV (SUB11)         23104000
231050         GO TO P8659-EXIT.                                        23105000
231060     IF PDTX-TX-CODE = 675                                        23106000
231070         ADD 1 TO NUM-INV-INTEREST                                23107000
231080         ADD PDTX-TX-AMT TO AMT-INV-INTEREST                      23108000
231090         GO TO P8659-EXIT.                                        23109000
231100     GO TO P8659-EXIT.                                            23110000
231110                                                                  23111000
231120 P8650-ACCUM-PD-CREDIT.                                           23112000
231130     IF PDTX-TX-CODE = 590                                        23113000
231140         ADD 1 TO NUM-ADS-CREDITS                                 23114000
231150                  NUM-ACH-SC-CREDITS                              23115000
231160         ADD PDTX-TX-AMT TO AMT-ADS-CREDITS                       23116000
231170         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        23117000
231180         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23118000
231190     IF PDTX-TX-CODE = 555                                        23119000
231200         GO TO P8652-ACCUM-PD-REG-CRE.                            23120000
231210     IF PDTX-TX-CODE = 600 OR 601 OR 610 OR 626                   23121000
231220         ADD 1 TO NUM-ATM-CREDITS                                 23122000
231230         ADD PDTX-TX-AMT TO AMT-ATM-CREDITS                       23123000
231240         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        23124000
231250         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23125000
231260     IF PDTX-TX-CODE = 575                                        23126000
231270         ADD 1 TO NUM-ODB-CREDITS-DDA                             23127000
231280         ADD PDTX-TX-AMT TO AMT-ODB-CREDITS-DDA                   23128000
231290         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23129000
231300     IF PDTX-TX-CODE = 591                                        23130000
231310         ADD 1 TO NUM-HELOC-CREDITS                               23131000
231320         ADD PDTX-TX-AMT TO AMT-HELOC-CREDITS                     23132000
231330         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23133000
231340     IF PDTX-TX-CODE = 638                                        23134000
231350         ADD 1           TO NUM-CLSN-BR-CREDITS                   23135000
231360         ADD PDTX-TX-AMT TO AMT-CLSN-BR-CREDITS                   23136000
231370         GO TO P8654-ACCUM-PD-CR-BY-TYPE                          23137000
231380     END-IF.                                                      23138000
231390     IF DSDSTXL-CO-DESC = 'ICS Sweep Credit'                      23139000
231400         ADD 1           TO NUM-ICS-CREDITS                       23140000
231410         ADD PDTX-TX-AMT TO AMT-ICS-CREDITS                       23141000
231420         GO TO P8652-ACCUM-PD-REG-CRE                             23142000
231430     END-IF.                                                      23143000
231440     IF PDTX-TX-CODE = 577 OR 640                                 23144000
231450         GO TO P8652-ACCUM-PD-REG-CRE.                            23145000
231460     IF PDTX-TX-CODE = 500                                        23146000
231470         ADD 1 TO NUM-ACH-SC-CREDITS                              23147000
231480     END-IF.                                                      23148000
231490     IF PDTX-TX-CODE = 500 OR 521                                 23149000
231500         ADD 1 TO NUM-PAY-CREDITS                                 23150000
231510         ADD PDTX-TX-AMT TO AMT-PAY-CREDITS                       23151000
231520         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23152000
231530     IF PDTX-TX-CODE = 550                                        23153000
231540         ADD 1 TO NUM-FT-CREDITS                                  23154000
231550         ADD PDTX-TX-AMT TO AMT-FT-CREDITS                        23155000
231560         GO TO P8654-ACCUM-PD-CR-BY-TYPE.                         23156000
231570     IF PDTX-TX-CODE = 625 AND PDTX-BATCH-NO = 99919              23157000
231580         ADD 1 TO NUM-TELE-CREDIT                                 23158000
231590         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        23159000
231600         GO TO P8652-ACCUM-PD-REG-CRE.                            23160000
231610     IF PDTX-TX-CODE = 620 OR 625                                 23161000
231620         ADD 1 TO NUM-TELE-CREDIT                                 23162000
231630         GO TO P8652-ACCUM-PD-REG-CRE.                            23163000
231640     IF PDTX-TX-CODE = 538 OR 537 OR 642                          23164000
231650         ADD 1 TO NUM-ZBA-CREDITS                                 23165000
231660         ADD PDTX-TX-AMT TO AMT-ZBA-CREDITS                       23166000
231670         GO TO P8652-ACCUM-PD-REG-CRE.                            23167000
231680     IF PDTX-TX-CODE = 536                                        23168000
231690         ADD 1 TO NUM-ODP-CREDITS                                 23169000
231700         ADD PDTX-TX-AMT TO AMT-ODP-CREDITS                       23170000
231710         GO TO P8652-ACCUM-PD-REG-CRE.                            23171000
231720     IF PDTX-TX-CODE = 546                                        23172000
231730         ADD PDTX-TX-AMT TO RET-CHK-FEES-REF-CTD                  23173000
231740                            RET-CHK-FEES-REF-YTD                  23174000
231750         GO TO P8652-ACCUM-PD-REG-CRE.                            23175000
231760     IF PDTX-TX-CODE = 548                                        23176000
231770         ADD PDTX-TX-AMT TO OD-FEES-REF-CTD                       23177000
231780                            OD-FEES-REF-YTD                       23178000
231790                            REF-NSF-OD-FEE                        23179000
231800         GO TO P8652-ACCUM-PD-REG-CRE.                            23180000
231810                                                                  23181000
231820     IF PDTX-TX-CODE = 602                                        23182000
231830         PERFORM P8550-CHK-REG-E-VIOLATION THRU P8559-EXIT        23183000
231840         GO TO P8652-ACCUM-PD-REG-CRE.                            23184000
231850     IF PDTX-TX-CODE = 542                                        23185000
231860         ADD 1 TO NUM-MOBILE-RDC                                  23186000
231870         ADD PDTX-ITEM-COUNT TO NUM-MOBILE-RDC-ITEMS              23187000
231880         GO TO P8652-ACCUM-PD-REG-CRE.                            23188000
231890     IF PDTX-TX-CODE = 544                                        23189000
231900         ADD 1 TO NUM-E-DEPOSIT                                   23190000
231910         ADD PDTX-ITEM-COUNT TO NUM-E-DEPOSIT-ITEMS               23191000
231920         GO TO P8652-ACCUM-PD-REG-CRE.                            23192000
231930     IF PDTX-TX-CODE = 549                                        23193000
231940         ADD 1 TO NUM-DESKTOP-SCAN                                23194000
231950         ADD PDTX-ITEM-COUNT TO NUM-DESKTOP-SCAN-ITEMS            23195000
231960         GO TO P8652-ACCUM-PD-REG-CRE.                            23196000
231970                                                                  23197000
231980                                                                  23198000
231990 P8652-ACCUM-PD-REG-CRE.                                          23199000
232000     ADD 1 TO NUM-REG-CREDITS.                                    23200000
232010     ADD PDTX-TX-AMT TO AMT-REG-CREDITS.                          23201000
232020                                                                  23202000
232030 P8654-ACCUM-PD-CR-BY-TYPE.                                       23203000
232040     MOVE ACCT-TYPE-CODE TO SUB9.                                 23204000
232050     ADD 1 TO NO-CRE-BY-TYPE (SUB9)                               23205000
232060              NO-CRE-BY-TYPE (100).                               23206000
232070     ADD PDTX-TX-AMT TO AMT-CRE-BY-TYPE (SUB9)                    23207000
232080                        AMT-CRE-BY-TYPE (100)                     23208000
232090                        CREDITS-BY-IDENT (SUB13).                 23209000
232100     ADD 1 TO PJ-CRE-NO.                                          23210000
232110     ADD PDTX-TX-AMT TO PJ-CRE-AMT.                               23211000
232120     IF BAI-ACCOUNT                                               23212000
232130         PERFORM P8720-BUILD-BAI-ACCT-CREDIT THRU P8729-EXIT.     23213000
232140     GO TO P8659-EXIT.                                            23214000
232150                                                                  23215000
232160 P8659-EXIT.                                                      23216000
232170     EXIT.                                                        23217000
232180                                                                  23218000
232190******************************************************************23219000
232200* SUBROUTINE - CREATE POSTING JOURNAL PRINT LINE                 *23220000
232210******************************************************************23221000
232220 P8660-POSTING-JRNL-DTL.                                          23222000
232230     IF HOLD-PJ-ACCT = PDTX-ACCT-NO                               23223000
232240         GO TO P8666-PJ-SAME-ACCT.                                23224000
232250     IF HOLD-PJ-ACCT = ZERO                                       23225000
232260         GO TO P8664-PJ-NEW-ACCT.                                 23226000
232270     IF PJ-DEB-SW GREATER THAN 0                                  23227000
232280         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT              23228000
232290         GO TO P8662-SPACE-PJ.                                    23229000
232300     IF PJ-CRE-SW GREATER THAN 0                                  23230000
232310         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.             23231000
232320                                                                  23232000
232330 P8662-SPACE-PJ.                                                  23233000
232340     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 23234000
232350                                                                  23235000
232360 P8664-PJ-NEW-ACCT.                                               23236000
232370     MOVE 0 TO PJ-DEB-SW PJ-CRE-SW.                               23237000
232380     MOVE ACCOUNT-CLASS TO PJ-ACCT-ID.                            23238000
232390     MOVE PDTX-ACCT-NO TO HOLD-PJ-ACCT.                           23239000
232400     MOVE SPACES TO EDIT-ACCT-NO EDIT-RETURN.                     23240000
232410     CALL 'EDITACCT' USING   PROC-FILE-ID                         23241000
232420                             EDIT-CODE (SUB-ID)                   23242000
232430                             HOLD-PJ-ACCT                         23243000
232440                             EDIT-ACCT-NO                         23244000
232450                             EDIT-RETURN.                         23245000
232460     IF EDIT-RETURN = 'B'                                         23246000
232470         MOVE 'INVALID' TO EDIT-ACCT-NO.                          23247000
232480     MOVE EDIT-ACCT-NO   TO PJ-ACCT-NO.                           23248000
232490                                                                  23249000
232500 P8666-PJ-SAME-ACCT.                                              23250000
232510     CALL 'CDCDT17' USING DATE-LAST-CUST-ACT                      23251000
232520                          PJ-DT-LAST-ACT.                         23252000
232530     IF PDTX-TX-CODE = 460                                        23253000
232540         GO TO P8668-BUILD-PJ-DEB.                                23254000
232550     IF PDTX-TX-CODE LESS THAN 700                                23255000
232560         GO TO P8672-BUILD-PJ-CRE.                                23256000
232570                                                                  23257000
232580 P8668-BUILD-PJ-DEB.                                              23258000
232590     IF PJ-DEB-SW = 2                                             23259000
232600         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.             23260000
232610     IF PJ-DEB-SW = 1                                             23261000
232620         GO TO P8670-BUILD-PJ-DEB-2.                              23262000
232630     MOVE 1 TO PJ-DEB-SW.                                         23263000
232640     MOVE PDTX-BATCH-NO TO PJ-BATCH-NO1.                          23264000
232650     MOVE PDTX-SEQ-NO TO PJ-SEQ-NO1.                              23265000
232660     MOVE PDTX-TX-CODE TO PJ-TX1.                                 23266000
232670     MOVE PDTX-TX-AMT TO PJ-AMOUNT1.                              23267000
232680     MOVE PDTX-TX-BACKDATE-DAYS TO PJ-EFF-DAYS1.                  23268000
232690     MOVE PJ-HOLD-CODE TO PJ-CODE1.                               23269000
232700     MOVE SPACES TO PJ-HOLD-CODE.                                 23270000
232710     GO TO P8679-EXIT.                                            23271000
232720                                                                  23272000
232730 P8670-BUILD-PJ-DEB-2.                                            23273000
232740     MOVE 2 TO PJ-DEB-SW.                                         23274000
232750     MOVE PDTX-BATCH-NO TO PJ-BATCH-NO2.                          23275000
232760     MOVE PDTX-SEQ-NO TO PJ-SEQ-NO2.                              23276000
232770     MOVE PDTX-TX-CODE TO PJ-TX2.                                 23277000
232780     MOVE PDTX-TX-AMT TO PJ-AMOUNT2.                              23278000
232790     MOVE PDTX-TX-BACKDATE-DAYS TO PJ-EFF-DAYS2.                  23279000
232800     MOVE PJ-HOLD-CODE TO PJ-CODE2.                               23280000
232810     MOVE SPACES TO PJ-HOLD-CODE.                                 23281000
232820     PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.                 23282000
232830     GO TO P8679-EXIT.                                            23283000
232840                                                                  23284000
232850 P8672-BUILD-PJ-CRE.                                              23285000
232860     IF PJ-CRE-SW = 1                                             23286000
232870         PERFORM P6750-PRINT-JOURNAL THRU P6799-EXIT.             23287000
232880     MOVE 1 TO PJ-CRE-SW.                                         23288000
232890     MOVE PDTX-BATCH-NO TO PJ-BATCH-NO3.                          23289000
232900     MOVE PDTX-SEQ-NO TO PJ-SEQ-NO3.                              23290000
232910     MOVE PDTX-TX-CODE TO PJ-TX3.                                 23291000
232920     MOVE PDTX-TX-AMT TO PJ-AMOUNT3.                              23292000
232930     MOVE PJ-HOLD-CODE TO PJ-CODE3.                               23293000
232940     MOVE SPACES TO PJ-HOLD-CODE.                                 23294000
232950     MOVE PDTX-TX-BACKDATE-DAYS TO PJ-EFF-DAYS3.                  23295000
232960                                                                  23296000
232970 P8679-EXIT.                                                      23297000
232980     EXIT.                                                        23298000
232990                                                                  23299000
233000******************************************************************23300000
233010*              L I S T  P O S T  R O U T I N E S                 *23301000
233020******************************************************************23302000
233030 P8680-END-OF-LIST.                                               23303000
233040     IF WATCHED OR WATCHED-ACH                                    23304000
233050         MOVE 1 TO LIST-POST-WATCHED-SW.                          23305000
233060     IF LP-STORE = 0                                              23306000
233070         NEXT SENTENCE                                            23307000
233080       ELSE                                                       23308000
233090         GO TO P8682-EMPTY-LP-STORE.                              23309000
233100     MOVE 02 TO HOLD-REASON-CODE.                                 23310000
233110     PERFORM P8690-BUILD-LIST-POST THRU P8699-EXIT.               23311000
233120     ADD 1 TO NUM-ENCLOSURES.                                     23312000
233130     MOVE BCF-BANK-NO TO PDTX-BANK-NO.                            23313000
233140     MOVE ACCOUNT-ID TO PDTX-ACCT-ID.                             23314000
233150     MOVE ACCOUNT-NUMBER TO PDTX-ACCT-NO.                         23315000
233160     MOVE 989 TO PDTX-TX-CODE.                                    23316000
233170     MOVE LIST-POST-TOT TO PDTX-TX-AMT.                           23317000
233180     MOVE PROC-CURR-DATE TO PDTX-TX-POST-DT.                      23318000
233190     MOVE ZEROS TO PDTX-TX-BACKDATE-DAYS.                         23319000
233200     MOVE ZEROS TO PDTX-ITEM-COUNT.                               23320000
233210     MOVE LIST-POST-CNT TO PDTX-SEQ-NO.                           23321000
233220     MOVE OSB-DESC-0055-A TO PDTX-CO-DESC.                        23322000
233230     MOVE OSB-DESC-0055-B TO PDTX-DESC.                           23323000
233240     MOVE NON-SER-CHK-KEY TO PDTX-SORT-KEY.                       23324000
233250     MOVE PROC-CURR-DATE TO PDTX-CHK-NO.                          23325000
233260     MOVE ZEROS TO PDTX-BATCH-NO.                                 23326000
233270     PERFORM P8574-WRITE-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     23327000
233280     GO TO P8686-CLEAR-LP-CNTS.                                   23328000
233290                                                                  23329000
233300 P8682-EMPTY-LP-STORE.                                            23330000
233310     MOVE 0 TO PUT-CNT.                                           23331000
233320                                                                  23332000
233330 P8684-LOOP-LP-EMPTY.                                             23333000
233340     ADD 1 TO PUT-CNT.                                            23334000
233350     MOVE WP-DETAIL (PUT-CNT) TO WP-WORK.                         23335000
233360     MOVE BCF-BANK-NO TO PDTX-BANK-NO.                            23336000
233370     MOVE ACCOUNT-ID TO PDTX-ACCT-ID.                             23337000
233380     MOVE ACCOUNT-NUMBER TO PDTX-ACCT-NO.                         23338000
233390     MOVE WP-TX-CODE TO PDTX-TX-CODE.                             23339000
233400     MOVE WP-AMT TO PDTX-TX-AMT.                                  23340000
233410     MOVE PROC-CURR-DATE TO PDTX-TX-POST-DT.                      23341000
233420     MOVE WP-BAT TO PDTX-BATCH-NO.                                23342000
233430     MOVE WP-SEQ TO PDTX-SEQ-NO.                                  23343000
233440     MOVE ZEROS TO PDTX-ITEM-COUNT.                               23344000
233450     MOVE WP-DESC TO PDTX-DESC.                                   23345000
233460     MOVE WP-SORT-KEY TO PDTX-SORT-KEY.                           23346000
233470     MOVE WP-CHK-NO TO PDTX-CHK-NO.                               23347000
233480     MOVE WP-CO-DESC TO PDTX-CO-DESC.                             23348000
233490     MOVE WP-TX-BAL TO PDTX-TX-BALANCE.                           23349000
233500     MOVE ZEROS TO PDTX-TX-BACKDATE-DAYS.                         23350000
233510     MOVE '1' TO PDTX-ENCL-SW.                                    23351000
233520     PERFORM P8574-WRITE-POSTED-DTL THRU P8579-BUILD-PD-EXIT.     23352000
233530     ADD 1 TO NUM-ENCLOSURES.                                     23353000
233540     IF PUT-CNT = LP-STORE                                        23354000
233550         GO TO P8686-CLEAR-LP-CNTS.                               23355000
233560     GO TO P8684-LOOP-LP-EMPTY.                                   23356000
233570                                                                  23357000
233580 P8686-CLEAR-LP-CNTS.                                             23358000
233590     MOVE 0 TO LIST-POST-WATCHED-SW.                              23359000
233600     MOVE 0 TO LIST-POST-SW.                                      23360000
233610     MOVE 0 TO LP-STORE.                                          23361000
233620     MOVE ZEROS TO LIST-POST-CNT.                                 23362000
233630     MOVE ZEROS TO LIST-POST-TOT.                                 23363000
233640                                                                  23364000
233650 P8689-EXIT.                                                      23365000
233660     EXIT.                                                        23366000
233670                                                                  23367000
233680 P8690-BUILD-LIST-POST.                                           23368000
233690     MOVE 055 TO SUB1.                                            23369000
233700     MOVE SPACES TO STOCK-WORK.                                   23370000
233710     MOVE RDS-PARM-TAB (SUB1) TO RPT-PARM-TABLE-WK.               23371000
233720     MOVE SUB1 TO LP-REPORT-CODE.                                 23372000
233730     MOVE BCF-BANK-NO TO LP-BANK-NO.                              23373000
233740     MOVE SPACES TO HOLD-SORT-KEY.                                23374000
233750     MOVE ACCOUNT-ID TO LP-ACCT-ID                                23375000
233760                        SKF-ACCOUNT-ID.                           23376000
233770     MOVE ACCOUNT-NUMBER TO LP-ACCT-NO                            23377000
233780                            SKF-ACCOUNT-NO.                       23378000
233790     MOVE LOW-VALUES TO LP-CRF-REC-ID.                            23379000
233800     MOVE SHORT-NAME TO LP-SHORT-NM.                              23380000
233810     MOVE HOLD-REASON-CODE TO LP-CONTINUATION                     23381000
233820                              SKF-LP-CONT.                        23382000
233830     IF HOLD-REASON-CODE = 02                                     23383000
233840         MOVE LIST-POST-TOT TO LP-TX-AMT                          23384000
233850                               SKF-AMOUNT                         23385000
233860         MOVE LIST-POST-CNT TO LP-SEQ-NO                          23386000
233870         MOVE ZEROS TO LP-BATCH-NO                                23387000
233880                       LP-CHK-NO                                  23388000
233890       ELSE                                                       23389000
233900         MOVE WP-AMT TO LP-TX-AMT                                 23390000
233910                        SKF-AMOUNT                                23391000
233920         MOVE WP-ITEM-ID TO LP-ITEM-ID                            23392000
233930         IF PROC-CURR-DATE = WP-CHK-NO                            23393000
233940             MOVE ZEROS TO LP-CHK-NO                              23394000
233950           ELSE                                                   23395000
233960             MOVE WP-CHK-NO TO LP-CHK-NO.                         23396000
233970     MOVE HOLD-SORT-KEY TO LP-SORT-KEY.                           23397000
233980                                                                  23398000
233990 P8692-WRITE-LIST-POST.                                           23399000
234000     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   23400000
234010                                                                  23401000
234020 P8699-EXIT.                                                      23402000
234030     EXIT.                                                        23403000
234040                                                                  23404000
234050 P8700-BUILD-LIST-POST2.                                          23405000
234060     MOVE 055 TO SUB1.                                            23406000
234070     MOVE SPACES TO STOCK-WORK.                                   23407000
234080     MOVE RDS-PARM-TAB (SUB1) TO RPT-PARM-TABLE-WK.               23408000
234090     MOVE SUB1 TO LP-REPORT-CODE.                                 23409000
234100     MOVE BCF-BANK-NO TO LP-BANK-NO.                              23410000
234110     MOVE SPACES TO HOLD-SORT-KEY.                                23411000
234120     MOVE ACCOUNT-ID TO LP-ACCT-ID                                23412000
234130                        SKF-ACCOUNT-ID.                           23413000
234140     MOVE ACCOUNT-NUMBER TO LP-ACCT-NO                            23414000
234150                            SKF-ACCOUNT-NO.                       23415000
234160     MOVE LOW-VALUES TO LP-CRF-REC-ID.                            23416000
234170     MOVE SHORT-NAME TO LP-SHORT-NM.                              23417000
234180     MOVE HOLD-REASON-CODE TO LP-CONTINUATION                     23418000
234190                              SKF-LP-CONT.                        23419000
234200     MOVE DSDSTXL-AMOUNT TO LP-TX-AMT                             23420000
234210                            SKF-AMOUNT.                           23421000
234220     MOVE DSDSTXL-ITEM-ID TO LP-ITEM-ID.                          23422000
234230     IF PROC-CURR-DATE = DSDSTXL-CHK-NO                           23423000
234240         MOVE ZEROS TO LP-CHK-NO                                  23424000
234250       ELSE                                                       23425000
234260         MOVE DSDSTXL-CHK-NO TO LP-CHK-NO.                        23426000
234270     MOVE HOLD-SORT-KEY TO LP-SORT-KEY.                           23427000
234280     PERFORM P8692-WRITE-LIST-POST THRU P8699-EXIT.               23428000
234290                                                                  23429000
234300 P8709-BUILD-LP-2-EXIT.                                           23430000
234310     EXIT.                                                        23431000
234320                                                                  23432000
234330******************************************************************23433000
234340* B U I L D   B A I   A C C O U N T   S U M M A R Y              *23434000
234350******************************************************************23435000
234360 P8710-BUILD-BAI-ACCT-SUMMARY.                                    23436000
234370     MOVE PROC-BK-NO TO BAI-BANK-NO.                              23437000
234380     MOVE ACCOUNT-NUMBER TO BAI-ACCT-NBR.                         23438000
234390     MOVE 03 TO BAI-RECORD-CODE.                                  23439000
234400     MOVE 1 TO BAI-SEQ-NBR.                                       23440000
234410     MOVE SPACES TO BAI-INFO.                                     23441000
234420     MOVE HOLD-BAI-OPENING-LGR TO BAI-OPENING-LGR.                23442000
234430     MOVE HOLD-BAI-OPENING-AVL TO BAI-OPENING-AVL.                23443000
234440     MOVE CURRENT-BALANCE TO BAI-CLOSING-LGR.                     23444000
234450     MOVE CURR-NET-COLL-BAL TO BAI-CLOSING-AVL.                   23445000
234460     MOVE ONE-DAY-FLOAT-AMT TO BAI-1-DAY-FLOAT.                   23446000
234470     ADD TWO-DAY-FLOAT-AMT                                        23447000
234480         THREE-DAY-FLOAT-AMT                                      23448000
234490         FOUR-DAY-FLOAT-AMT                                       23449000
234500         FIVE-DAY-FLOAT-AMT                                       23450000
234510        GIVING BAI-OTHER-FLOAT.                                   23451000
234520     MOVE HOLD-BAI-NBR-CREDITS TO BAI-NBR-CREDITS.                23452000
234530     MOVE HOLD-BAI-TOT-CREDITS TO BAI-TOT-CREDITS.                23453000
234540     MOVE HOLD-BAI-NBR-DEBITS TO BAI-NBR-DEBITS.                  23454000
234550     MOVE HOLD-BAI-TOT-DEBITS TO BAI-TOT-DEBITS.                  23455000
234560     MOVE STAT-2X             TO BAI-03-STATUS.                   23456000
234570     MOVE ACCOUNT-ID          TO BAI-03-ACCT-ID.                  23457000
234580     WRITE DSDS-BAI-OUT FROM DSDS-BAI-TX-WORK.                    23458000
234590                                                                  23459000
234600 P8719-EXIT.                                                      23460000
234610     EXIT.                                                        23461000
234620                                                                  23462000
234630******************************************************************23463000
234640* B U I L D   B A I   A C C O U N T   C R E D I T                *23464000
234650******************************************************************23465000
234660 P8720-BUILD-BAI-ACCT-CREDIT.                                     23466000
234670     MOVE PROC-BK-NO TO BAI-BANK-NO.                              23467000
234680     MOVE ACCOUNT-NUMBER TO BAI-ACCT-NBR.                         23468000
234690     MOVE 16 TO BAI-RECORD-CODE.                                  23469000
234700     ADD 1 TO BAI-SEQ-NBR                                         23470000
234710              HOLD-BAI-NBR-CREDITS.                               23471000
234720     MOVE SPACES TO BAI-INFO.                                     23472000
234730     MOVE PDTX-TX-CODE TO BAI-DSDS-TX-CODE.                       23473000
234740     MOVE PDTX-TX-AMT TO BAI-TX-AMOUNT.                           23474000
234750     ADD PDTX-TX-AMT TO HOLD-BAI-TOT-CREDITS.                     23475000
234760     MOVE PDTX-CO-DESC TO BAI-DESC-16.                            23476000
234770     MOVE PDTX-DESC TO BAI-DESC-10.                               23477000
234780     IF BAI-TX-DESC = SPACES                                      23478000
234790       OR BAI-DESC-10 = 'BANKMATE  '                              23479000
234800         MOVE PDTX-FOR-ATM-DESC TO BAI-TX-DESC.                   23480000
234810     IF PDTX-CHK-NO = PROC-CURR-DATE                              23481000
234820         MOVE PDTX-ITEM-COUNT TO BAI-CHK-NO                       23482000
234830       ELSE                                                       23483000
234840         MOVE PDTX-CHK-NO TO BAI-CHK-NO.                          23484000
234850     MOVE ACCOUNT-ID          TO BAI-16-ACCT-ID.                  23485000
234860     WRITE DSDS-BAI-OUT FROM DSDS-BAI-TX-WORK.                    23486000
234870                                                                  23487000
234880 P8729-EXIT.                                                      23488000
234890     EXIT.                                                        23489000
234900                                                                  23490000
234910******************************************************************23491000
234920* B U I L D   B A I   A C C O U N T   D E B I T                  *23492000
234930******************************************************************23493000
234940 P8730-BUILD-BAI-ACCT-DEBIT.                                      23494000
234950     MOVE PROC-BK-NO TO BAI-BANK-NO.                              23495000
234960     MOVE ACCOUNT-NUMBER TO BAI-ACCT-NBR.                         23496000
234970     MOVE 16 TO BAI-RECORD-CODE.                                  23497000
234980     ADD 1 TO BAI-SEQ-NBR                                         23498000
234990              HOLD-BAI-NBR-DEBITS.                                23499000
235000     MOVE SPACES TO BAI-INFO.                                     23500000
235010     MOVE PDTX-TX-CODE TO BAI-DSDS-TX-CODE.                       23501000
235020     MOVE PDTX-TX-AMT TO BAI-TX-AMOUNT.                           23502000
235030     ADD PDTX-TX-AMT TO HOLD-BAI-TOT-DEBITS.                      23503000
235040     MOVE PDTX-CO-DESC TO BAI-DESC-16.                            23504000
235050     MOVE PDTX-DESC TO BAI-DESC-10.                               23505000
235060     IF BAI-TX-DESC = SPACES                                      23506000
235070       OR BAI-DESC-10 = 'BANKMATE  '                              23507000
235080         MOVE PDTX-FOR-ATM-DESC TO BAI-TX-DESC.                   23508000
235090     IF PDTX-CHK-NO = PROC-CURR-DATE                              23509000
235100         MOVE ZEROS TO BAI-CHK-NO                                 23510000
235110       ELSE                                                       23511000
235120         MOVE PDTX-CHK-NO TO BAI-CHK-NO.                          23512000
235130     MOVE ACCOUNT-ID          TO BAI-16-ACCT-ID.                  23513000
235140     WRITE DSDS-BAI-OUT FROM DSDS-BAI-TX-WORK.                    23514000
235150                                                                  23515000
235160 P8739-EXIT.                                                      23516000
235170     EXIT.                                                        23517000
235180                                                                  23518000
235190******************************************************************23519000
235200* W R I T E   S H A D O W   A C C O U N T   R E C O R D          *23520000
235210******************************************************************23521000
235220 P8740-WRITE-SHADOW-ACCT.                                         23522000
235230     IF BANK-UNPOST-ITEMS                                         23523000
235240        GO TO P8745-CONT.                                         23524000
235250     IF BANK-CTL-ACCTS OR                                         23525000
235260        CORRESP-BANK OR                                           23526000
235270        OTH-DEPOSITORY-INST                                       23527000
235280         GO TO P8749-EXIT.                                        23528000
235290                                                                  23529000
235300 P8745-CONT.                                                      23530000
235310     MOVE PROC-BK-NO      TO SAW-BANK-NBR.                        23531000
235320     MOVE ACCOUNT-ID      TO SAW-ACCT-ID.                         23532000
235330     MOVE ACCOUNT-NUMBER  TO SAW-ACCT-NBR.                        23533000
235340     MOVE ACCOUNT-CLASS   TO SAW-ACCT-CLASS.                      23534000
235350     IF CLOSED                                                    23535000
235360         MOVE 'C'         TO SAW-ACCT-STATUS                      23536000
235370       ELSE                                                       23537000
235380         MOVE 'O'         TO SAW-ACCT-STATUS.                     23538000
235390     IF PERSONAL                                                  23539000
235400         MOVE 'P'         TO SAW-OWNER-CODE                       23540000
235410       ELSE                                                       23541000
235420         IF PUBLIC-FUND                                           23542000
235430             MOVE 'F'     TO SAW-OWNER-CODE                       23543000
235440           ELSE                                                   23544000
235450             MOVE 'N'     TO SAW-OWNER-CODE.                      23545000
235460     IF BANK-UNPOST-ITEMS                                         23546000
235470         MOVE 'U' TO SAW-OWNER-CODE.                              23547000
235480     MOVE CURRENT-BALANCE TO SAW-CURR-BAL.                        23548000
235490     WRITE SHADOW-ACCTS-OUT FROM SHADOW-ACCT-WORK.                23549000
235500                                                                  23550000
235510 P8749-EXIT.                                                      23551000
235520     EXIT.                                                        23552000
235530                                                                  23553000
235540******************************************************************23554000
235550* DEPOSIT SCORE FILE FOR OVERDRAFT ACCESS                        *23555000
235560******************************************************************23556000
235570 P8760-BUILD-OD-ACCTS-FILE.                                       23557000
235580     IF OD-ACCESS-BANK                                            23558000
235590         NEXT SENTENCE                                            23559000
235600       ELSE                                                       23560000
235610         GO TO P8769-EXIT                                         23561000
235620     END-IF.                                                      23562000
235630     IF PERSONAL                                                  23563000
235640         IF BANK-EMPLOYEE                                         23564000
235650             GO TO P8769-EXIT                                     23565000
235660         END-IF                                                   23566000
235670     END-IF.                                                      23567000
235680     IF BANK-CTL-ACCTS                                            23568000
235690         GO TO P8769-EXIT                                         23569000
235700     END-IF.                                                      23570000
235710     IF BCFSCR-PREPAID-CARD                                       23571000
235720         GO TO P8769-EXIT                                         23572000
235730     END-IF.                                                      23573000
235740     IF OA-BANK-PROTECTED                                         23574000
235750         GO TO P8769-EXIT                                         23575000
235760     END-IF.                                                      23576000
235770     IF GOT-HISTORY = 0                                           23577000
235780         PERFORM P8106-GET-HISTORY THRU P8109-EXIT                23578000
235790     END-IF.                                                      23579000
235800     MOVE ACCOUNT-NUMBER        TO OAF3-ACCT-NBR.                 23580000
235810     MOVE PROC-BK-NO            TO OAF3-BANK-NBR.                 23581000
235820     MOVE PROC-BK-NO            TO OAF3-BR-BANK.                  23582000
235830     MOVE BRANCH-CODE           TO OAF3-BR-BRANCH.                23583000
235840     MOVE CURRENT-BALANCE       TO OAF3-CURR-BALANCE.             23584000
235850     IF CURRENT-BALANCE LESS THAN ZEROS                           23585000
235860         CALL 'CDCDT11'      USING DTE-FIRST-OVERDRAWN            23586000
235870                                   PROC-CURR-DATE                 23587000
235880                                   WORK-CURR-DAYS-OD              23588000
235890         MOVE WORK-CURR-DAYS-OD TO OAF3-CURR-DAYS-OD              23589000
235900       ELSE                                                       23590000
235910         MOVE ZEROS             TO OAF3-CURR-DAYS-OD              23591000
235920     END-IF.                                                      23592000
235930                                                                  23593000
235940     MOVE AMT-LAST-DEPOSIT2     TO OAF3-AMT-DEPOSITS.             23594000
235950     CALL 'CDCDT38'          USING DATE-LAST-DEPOSIT              23595000
235960                                   OAF3-DATE-LAST-DEP.            23596000
235970     CALL 'CDCDT38'          USING DATE-OPENED                    23597000
235980                                   OAF3-DATE-OPENED.              23598000
235990     MOVE OD-ACCESS-CODE        TO OAF3-OD-CODE.                  23599000
236000     IF PERSONAL                                                  23600000
236010         MOVE 'P'               TO OAF3-ACCT-TYPE-CODE            23601000
236020     ELSE                                                         23602000
236030         MOVE 'B'               TO OAF3-ACCT-TYPE-CODE            23603000
236040     END-IF.                                                      23604000
236050     MOVE PROC-BK-NO            TO OAF3-INSTITUTION-NBR.          23605000
236060     MOVE ACCOUNT-CLASS         TO OAF3-PRODUCT-CODE.             23606000
236070     IF BANK-EMPLOYEE                                             23607000
236080         MOVE 'Y'               TO OAF3-EMPLOYEE-FLAG             23608000
236090     ELSE                                                         23609000
236100         MOVE 'N'               TO OAF3-EMPLOYEE-FLAG             23610000
236110     END-IF.                                                      23611000
236120                                                                  23612000
236130     CALL 'CDCDT38'          USING PROC-CURR-DATE                 23613000
236140                                   OAF3-DATA-DATE.                23614000
236150     MOVE AVG-COL-BAL-TO-LOAD   TO OAF3-AVG-COLL-BAL.             23615000
236160     MOVE 'N'                   TO OAF3-DIRECT-DEPOSIT.           23616000
236170     IF NUM-ACH-SC-CREDITS GREATER THAN ZEROS                     23617000
236180         MOVE 'Y'               TO OAF3-DIRECT-DEPOSIT            23618000
236190     END-IF.                                                      23619000
236200     IF HIST-NUM-ACH-SC-CRED (1) GREATER THAN ZEROS               23620000
236210         MOVE 'Y'               TO OAF3-DIRECT-DEPOSIT            23621000
236220     END-IF.                                                      23622000
236230     IF HIST-NUM-ACH-SC-CRED (2) GREATER THAN ZEROS               23623000
236240         MOVE 'Y'               TO OAF3-DIRECT-DEPOSIT            23624000
236250     END-IF.                                                      23625000
236260     MOVE OD-ACCESS-LIMIT       TO OAF3-OD-LIMIT.                 23626000
236270     MOVE BCFSCR-OSB-SERV-CHRG-DESC TO OAF3-PRODUCT-DESC.         23627000
236280     MOVE DAILY-OD-FEE          TO OAF3-DAILY-OD-FEE.             23628000
236290     MOVE REF-NSF-OD-FEE        TO OAF3-REF-NSF-OD-FEE.           23629000
236300     MOVE ZEROS                 TO OAF3-REF-OD-FEE.               23630000
236310     MOVE RET-DEP-ITEM-AMT      TO OAF3-RET-DEP-ITEM-AMT.         23631000
236320     MOVE RET-DEP-ITEM-CNT      TO OAF3-RET-DEP-ITEM-CNT.         23632000
236330     MOVE STAT-2X               TO OAF3-ACCT-STATUS.              23633000
236340     WRITE DEPOSIT-SCORE-REC FROM OVERDRAWN-ACCOUNTS-FILE3.       23634000
236350 P8769-EXIT.                                                      23635000
236360     EXIT.                                                        23636000
236370                                                                  23637000
236380******************************************************************23638000
236390* CHECK NIPS HISTORY FOR SECOND PRESENTMENT OF CHECKS            *23639000
236400******************************************************************23640000
236410 P8770-CHK-NIPS-HIST.                                             23641000
236420     MOVE DSDSTXL-BANK-NO   TO NIPS-BANK-NBR.                     23642000
236430     MOVE DSDSTXL-ACCT-ID   TO NIPS-ACCT-ID.                      23643000
236440     MOVE DSDSTXL-ACCT-NO   TO NIPS-ACCT-NBR.                     23644000
236450     MOVE DSDSTXL-CHK-NO    TO NIPS-SERIAL-NBR.                   23645000
236460     MOVE DSDSTXL-AMOUNT    TO NIPS-TX-AMT.                       23646000
236470                                                                  23647000
236480     EXEC SQL                                                     23648000
236490         DECLARE DETAIL_CURSOR CURSOR FOR                         23649000
236500         SELECT                                                   23650000
236510             NIPS_PAY_IND                                         23651000
236520         FROM NIPS.DETAIL                                         23652000
236530         WHERE NIPS_BANK_NBR   = :NIPS-BANK-NBR                   23653000
236540         AND   NIPS_ACCT_ID    = :NIPS-ACCT-ID                    23654000
236550         AND   NIPS_ACCT_NBR   = :NIPS-ACCT-NBR                   23655000
236560         AND   NIPS_SERIAL_NBR = :NIPS-SERIAL-NBR                 23656000
236570         AND   NIPS_TX_AMT     = :NIPS-TX-AMT                     23657000
236580     END-EXEC.                                                    23658000
236590                                                                  23659000
236600     EXEC SQL                                                     23660000
236610         OPEN DETAIL_CURSOR                                       23661000
236620     END-EXEC.                                                    23662000
236630     EVALUATE SQLCODE                                             23663000
236640         WHEN ZEROS                                               23664000
236650             CONTINUE                                             23665000
236660         WHEN OTHER                                               23666000
236670             CALL 'CDCUT90' USING SQLCA                           23667000
236680             CALL 'CDCDUMP' USING BY CONTENT '2108'               23668000
236690     END-EVALUATE.                                                23669000
236700                                                                  23670000
236710 P8773-FETCH-HISTORY.                                             23671000
236720     EXEC SQL                                                     23672000
236730         FETCH DETAIL_CURSOR INTO                                 23673000
236740            :NIPS-PAY-IND                                         23674000
236750     END-EXEC.                                                    23675000
236760     EVALUATE SQLCODE                                             23676000
236770         WHEN ZEROS                                               23677000
236780             CONTINUE                                             23678000
236790         WHEN +100                                                23679000
236800             ADD WORK-OD-FEE      TO OA-NSF-FEE-AMT               23680000
236810             GO TO P8776-CLOSE-CURSOR                             23681000
236820         WHEN OTHER                                               23682000
236830             CALL 'CDCUT90' USING SQLCA                           23683000
236840             CALL 'CDCDUMP' USING BY CONTENT '2109'               23684000
236850     END-EVALUATE.                                                23685000
236860     IF NIPS-PAY-IND = 'Y'                                        23686000
236870         GO TO P8773-FETCH-HISTORY.                               23687000
236880     ADD OD-CHARGE-OR-FEE-2 TO OA-NSF-FEE-AMT.                    23688000
236890                                                                  23689000
236900 P8776-CLOSE-CURSOR.                                              23690000
236910     EXEC SQL                                                     23691000
236920         CLOSE DETAIL_CURSOR                                      23692000
236930     END-EXEC.                                                    23693000
236940     EVALUATE SQLCODE                                             23694000
236950         WHEN ZEROS                                               23695000
236960             CONTINUE                                             23696000
236970         WHEN OTHER                                               23697000
236980             CALL 'CDCUT90' USING SQLCA                           23698000
236990             CALL 'CDCDUMP' USING BY CONTENT '2110'               23699000
237000     END-EVALUATE.                                                23700000
237010                                                                  23701000
237020 P8779-EXIT.                                                      23702000
237030     EXIT.                                                        23703000
237040                                                                  23704000
237050******************************************************************23705000
237060* A C C T   A N A L   D A I L Y   B A L A N C E   T X S          *23706000
237070******************************************************************23707000
237080 P8780-BUILD-ACCT-ANAL-DYL-BAL.                                   23708000
237090     IF PROC-DSS                                                  23709000
237100         GO TO P8789-EXIT.                                        23710000
237110     IF NON-ACCT-ANAL-BANK                                        23711000
237120         GO TO P8789-EXIT.                                        23712000
237130     IF CLOSED                                                    23713000
237140         GO TO P8789-EXIT.                                        23714000
237150     IF ACCT-ANAL-ACCT-IND = 'Y'                                  23715000
237160         GO TO P8782-BUILD.                                       23716000
237170     GO TO P8789-EXIT.                                            23717000
237180                                                                  23718000
237190 P8782-BUILD.                                                     23719000
237200     MOVE SPACES            TO AA-FILEREC.                        23720000
237210     MOVE 01                TO AA-INSYSTEM.                       23721000
237220     MOVE PROC-BK-NO        TO AA-BKNBR.                          23722000
237230     MOVE 01                TO AA-APPL.                           23723000
237240     MOVE ACCOUNT-NUMBER    TO AA-ACCOUNT.                        23724000
237250     MOVE 04                TO AA-RECCODE.                        23725000
237260     INITIALIZE                AA-DAILYBAL.                       23726000
237270     MOVE ZEROS             TO AA-JULDT.                          23727000
237280     MOVE CURRENT-BALANCE   TO AA-BALCUR.                         23728000
237290     MOVE CURR-NET-COLL-BAL TO AA-CBALCOL                         23729000
237300                               AA-BBALCOL.                        23730000
237310                                                                  23731000
237320 P8784-CHECK-FOR-CYCLE.                                           23732000
237330     IF CYCLE-THIS-STMT = 0                                       23733000
237340         GO TO P8788-WRITE-DLY-BAL.                               23734000
237350     IF INV-PLAN = SPACES OR 'IC'                                 23735000
237360         GO TO P8788-WRITE-DLY-BAL.                               23736000
237370     IF INV-CLOSED                                                23737000
237380         GO TO P8788-WRITE-DLY-BAL.                               23738000
237390                                                                  23739000
237400 P8786-SEND-INV-INFO.                                             23740000
237410     IF INV-DAYS-IN-PREV-CYCLE = ZEROS                            23741000
237420         MOVE ZEROS TO AA-USERBAL1                                23742000
237430       ELSE                                                       23743000
237440         COMPUTE AA-USERBAL1 ROUNDED =                            23744000
237450             INV-GROSS-BAL-LAST-CYC / INV-DAYS-IN-PREV-CYCLE.     23745000
237460     IF INV-GROSS-BAL-LAST-CYC = ZEROS                            23746000
237470         MOVE ZEROS TO HOLD-AVG-RP-INTEREST-RATE                  23747000
237480       ELSE                                                       23748000
237490         IF INV-ACCR-BASIS-IND = '5'                              23749000
237500             COMPUTE HOLD-AVG-RP-INTEREST-RATE ROUNDED =          23750000
237510                 INV-INT-PAID-LAST-CYC /                          23751000
237520                 INV-GROSS-BAL-LAST-CYC *                         23752000
237530                 100000 *                                         23753000
237540                 HOLD-DAYS-IN-YEAR                                23754000
237550           ELSE                                                   23755000
237560             COMPUTE HOLD-AVG-RP-INTEREST-RATE ROUNDED =          23756000
237570                 INV-INT-PAID-LAST-CYC /                          23757000
237580                 INV-GROSS-BAL-LAST-CYC *                         23758000
237590                 100000 *                                         23759000
237600                 360.                                             23760000
237610     MOVE HOLD-AVG-RP-INTEREST-RATE TO AA-USERBAL2.               23761000
237620     MOVE INV-INT-PAID-LAST-CYC TO AA-USERBAL3.                   23762000
237630     MOVE INV-DAYS-IN-PREV-CYCLE TO AA-USERBAL4.                  23763000
237640                                                                  23764000
237650 P8788-WRITE-DLY-BAL.                                             23765000
237660     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      23766000
237670                                                                  23767000
237680 P8789-EXIT.                                                      23768000
237690     EXIT.                                                        23769000
237700                                                                  23770000
237710******************************************************************23771000
237720* A C C T   A N A L   D A I L Y   P O S T E D   T X S            *23772000
237730******************************************************************23773000
237740 P8790-BUILD-ACCT-ANAL-POST-TX.                                   23774000
237750     IF PROC-DSS                                                  23775000
237760         GO TO P8794-EXIT.                                        23776000
237770     IF NON-ACCT-ANAL-BANK                                        23777000
237780         GO TO P8794-EXIT.                                        23778000
237790     IF CLOSED                                                    23779000
237800         GO TO P8794-EXIT.                                        23780000
237810     IF ACCT-ANAL-ACCT-IND = 'Y'                                  23781000
237820         GO TO P8792-BUILD.                                       23782000
237830     GO TO P8794-EXIT.                                            23783000
237840                                                                  23784000
237850 P8792-BUILD.                                                     23785000
237860     IF CDC-DB2-DATE >= AA-IMPL-DATE                              23786000
237870         IF DSDSTXL-CODE = 118 OR 119                             23787000
237880             GO TO P8794-EXIT                                     23788000
237890         END-IF                                                   23789000
237900     END-IF.                                                      23790000
237910                                                                  23791000
237920     MOVE SPACES              TO AA-FILEREC.                      23792000
237930     MOVE 01                  TO AA-INSYSTEM.                     23793000
237940     MOVE PROC-BK-NO          TO AA-BKNBR.                        23794000
237950     MOVE 01                  TO AA-APPL.                         23795000
237960     MOVE DSDSTXL-ACCT-NO     TO AA-ACCOUNT.                      23796000
237970     MOVE 01                  TO AA-RECCODE.                      23797000
237980     INITIALIZE                  AA-TRANSACTION.                  23798000
237990     MOVE DSDSTXL-CODE        TO AA-TREXTC                        23799000
238000                                 AA-TRITC.                        23800000
238010     MOVE DSDSTXL-DATE        TO AA-TRPROCDT.                     23801000
238020     MOVE DSDSTXL-EFFECT-DT   TO AA-TREFFDT.                      23802000
238030     EVALUATE HOLD-XSC-AMT-NUM-FOR-AA                             23803000
238040         WHEN 'N'                                                 23804000
238050             MOVE DSDSTXL-ITEM-COUNT TO AA-TRITEMCT               23805000
238060         WHEN 'A'                                                 23806000
238070             MOVE DSDSTXL-AMOUNT TO AA-TRAMT                      23807000
238080         WHEN OTHER                                               23808000
238090             MOVE DSDSTXL-AMOUNT TO AA-TRAMT                      23809000
238100     END-EVALUATE.                                                23810000
238110     EVALUATE HOLD-XSC-IND-FOR-AA                                 23811000
238120         WHEN 'H'                                                 23812000
238130                 MOVE 'B'     TO AA-TRCHRGCD                      23813000
238140         WHEN 'S'                                                 23814000
238150         WHEN 'A'                                                 23815000
238160                 MOVE ' '     TO AA-TRCHRGCD                      23816000
238170         WHEN 'W'                                                 23817000
238180                 MOVE 'N'     TO AA-TRCHRGCD                      23818000
238190         WHEN 'E'                                                 23819000
238200                 MOVE 'E'     TO AA-TRCHRGCD                      23820000
238210     END-EVALUATE.                                                23821000
238220     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      23822000
238230                                                                  23823000
238240 P8794-EXIT.                                                      23824000
238250     EXIT.                                                        23825000
238260                                                                  23826000
238270******************************************************************23827000
238280* C L O S E   A C C T   A N A L   A C C O U N T                  *23828000
238290******************************************************************23829000
238300 P8795-CLOSE-ACCT-ANAL.                                           23830000
238310     IF PROC-DSS                                                  23831000
238320         GO TO P8799-EXIT.                                        23832000
238330     IF NON-ACCT-ANAL-BANK                                        23833000
238340         GO TO P8799-EXIT.                                        23834000
238350     IF ACCT-ANAL-ACCT-IND = 'Y'                                  23835000
238360         GO TO P8797-CLOSE.                                       23836000
238370     GO TO P8799-EXIT.                                            23837000
238380                                                                  23838000
238390 P8797-CLOSE.                                                     23839000
238400     MOVE SPACES              TO AA-FILEREC.                      23840000
238410     MOVE 01                  TO AA-INSYSTEM.                     23841000
238420     MOVE PROC-BK-NO          TO AA-BKNBR.                        23842000
238430     MOVE 01                  TO AA-APPL.                         23843000
238440     MOVE ACCOUNT-NUMBER      TO AA-ACCOUNT.                      23844000
238450     MOVE 06                  TO AA-RECCODE.                      23845000
238460     IF CDC-DB2-DATE >= AA-IMPL-DATE                              23846000
238470         MOVE '~'             TO AA-USERCODE1                     23847000
238480         IF INV-PLAN = 'RP'                                       23848000
238490             MOVE SPACES      TO AA-USERCODE1                     23849000
238500         END-IF                                                   23850000
238510     END-IF.                                                      23851000
238520     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      23852000
238530                                                                  23853000
238540 P8799-EXIT.                                                      23854000
238550     EXIT.                                                        23855000
238560                                                                  23856000
238570******************************************************************23857000
238580* A C C T   A N A L   D A I L Y   C O U N T   T X S              *23858000
238590******************************************************************23859000
238600 P8800-BUILD-ACCT-ANAL-CNT-TX.                                    23860000
238610     IF PROC-DSS                                                  23861000
238620         GO TO P8809-EXIT.                                        23862000
238630     IF NON-ACCT-ANAL-BANK                                        23863000
238640         GO TO P8809-EXIT.                                        23864000
238650     IF CLOSED                                                    23865000
238660         GO TO P8809-EXIT.                                        23866000
238670     IF ACCT-ANAL-ACCT-IND = 'Y'                                  23867000
238680         GO TO P8801-BUILD.                                       23868000
238690     GO TO P8809-EXIT.                                            23869000
238700                                                                  23870000
238710 P8801-BUILD.                                                     23871000
238720     MOVE SPACES              TO AA-FILEREC.                      23872000
238730     MOVE 01                  TO AA-INSYSTEM.                     23873000
238740     MOVE PROC-BK-NO          TO AA-BKNBR.                        23874000
238750     MOVE 01                  TO AA-APPL.                         23875000
238760     MOVE ACCOUNT-NUMBER      TO AA-ACCOUNT.                      23876000
238770     MOVE 01                  TO AA-RECCODE.                      23877000
238780     INITIALIZE                  AA-TRANSACTION.                  23878000
238790     MOVE PROC-CURR-DATE      TO AA-TRPROCDT                      23879000
238800                                 AA-TREFFDT.                      23880000
238810                                                                  23881000
238820 P8802-DR-CR-ITM-CNT.                                             23882000
238830     IF HOLD-DEBITS-FOR-AA = ZEROS                                23883000
238840         NEXT SENTENCE                                            23884000
238850       ELSE                                                       23885000
238860         IF CDC-DB2-DATE >= AA-IMPL-DATE                          23886000
238870             MOVE 223             TO AA-TREXTC                    23887000
238880                                     AA-TRITC                     23888000
238890         ELSE                                                     23889000
238900             MOVE 3               TO AA-TREXTC                    23890000
238910                                     AA-TRITC                     23891000
238920         END-IF                                                   23892000
238930         MOVE HOLD-DEBITS-FOR-AA  TO AA-TRITEMCT                  23893000
238940         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   23894000
238950     END-IF.                                                      23895000
238960                                                                  23896000
238970     IF HOLD-CREDITS-FOR-AA = ZEROS                               23897000
238980         NEXT SENTENCE                                            23898000
238990       ELSE                                                       23899000
239000         MOVE 289                 TO AA-TREXTC                    23900000
239010                                     AA-TRITC                     23901000
239020         MOVE HOLD-CREDITS-FOR-AA TO AA-TRITEMCT                  23902000
239030         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   23903000
239040     END-IF.                                                      23904000
239050                                                                  23905000
239060     IF HOLD-ITEMS-FOR-AA = ZEROS                                 23906000
239070         NEXT SENTENCE                                            23907000
239080       ELSE                                                       23908000
239090         MOVE 290                 TO AA-TREXTC                    23909000
239100                                     AA-TRITC                     23910000
239110         MOVE HOLD-ITEMS-FOR-AA                                   23911000
239120                                  TO AA-TRITEMCT                  23912000
239130         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   23913000
239140     END-IF.                                                      23914000
239150                                                                  23915000
239160     COMPUTE HOLD-CREDITS-FOR-AA EQUAL HOLD-CREDITS-FOR-AA -      23916000
239170                                       HOLD-MBL-RDC-FOR-AA -      23917000
239180                                       HOLD-E-DEP-FOR-AA   -      23918000
239190                                       HOLD-ITM-DEP-FOR-AA.       23919000
239200     IF HOLD-CREDITS-FOR-AA = ZEROS                               23920000
239210         NEXT SENTENCE                                            23921000
239220       ELSE                                                       23922000
239230         IF CDC-DB2-DATE >= AA-IMPL-DATE                          23923000
239240             MOVE 224             TO AA-TREXTC                    23924000
239250                                     AA-TRITC                     23925000
239260         ELSE                                                     23926000
239270             MOVE 4               TO AA-TREXTC                    23927000
239280                                     AA-TRITC                     23928000
239290         END-IF                                                   23929000
239300         MOVE HOLD-CREDITS-FOR-AA TO AA-TRITEMCT                  23930000
239310         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   23931000
239320     END-IF.                                                      23932000
239330                                                                  23933000
239340     COMPUTE HOLD-ITEMS-FOR-AA EQUAL HOLD-ITEMS-FOR-AA -          23934000
239350                                     HOLD-E-DEP-ITM-FOR-AA -      23935000
239360                                     HOLD-MBL-RDC-ITM-FOR-AA -    23936000
239370                                     HOLD-ITM-DEP-ITM-FOR-AA.     23937000
239380     IF HOLD-ITEMS-FOR-AA = ZEROS                                 23938000
239390         NEXT SENTENCE                                            23939000
239400       ELSE                                                       23940000
239410         IF CDC-DB2-DATE >= AA-IMPL-DATE                          23941000
239420             MOVE 226             TO AA-TREXTC                    23942000
239430                                     AA-TRITC                     23943000
239440         ELSE                                                     23944000
239450             MOVE 6               TO AA-TREXTC                    23945000
239460                                     AA-TRITC                     23946000
239470         END-IF                                                   23947000
239480         MOVE HOLD-ITEMS-FOR-AA   TO AA-TRITEMCT                  23948000
239490         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   23949000
239500     END-IF.                                                      23950000
239510                                                                  23951000
239520     IF HOLD-DR-CR-ITM-FOR-AA = ZEROS                             23952000
239530         NEXT SENTENCE                                            23953000
239540       ELSE                                                       23954000
239550         MOVE 298                 TO AA-TREXTC                    23955000
239560                                     AA-TRITC                     23956000
239570         MOVE HOLD-DR-CR-ITM-FOR-AA                               23957000
239580                                  TO AA-TRITEMCT                  23958000
239590         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  23959000
239600                                                                  23960000
239610     IF HOLD-REG-TELE-CR-ITM-FOR-AA = ZEROS                       23961000
239620         NEXT SENTENCE                                            23962000
239630       ELSE                                                       23963000
239640         MOVE 296                 TO AA-TREXTC                    23964000
239650                                     AA-TRITC                     23965000
239660         MOVE HOLD-REG-TELE-CR-ITM-FOR-AA                         23966000
239670                                  TO AA-TRITEMCT                  23967000
239680         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  23968000
239690                                                                  23969000
239700     IF HOLD-ACH-DEB-FOR-AA = ZEROS                               23970000
239710         NEXT SENTENCE                                            23971000
239720       ELSE                                                       23972000
239730         MOVE 293                 TO AA-TREXTC                    23973000
239740                                     AA-TRITC                     23974000
239750         MOVE HOLD-ACH-DEB-FOR-AA                                 23975000
239760                                  TO AA-TRITEMCT                  23976000
239770         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  23977000
239780                                                                  23978000
239790     IF HOLD-ACH-CR-FOR-AA = ZEROS                                23979000
239800         NEXT SENTENCE                                            23980000
239810       ELSE                                                       23981000
239820         MOVE 294                 TO AA-TREXTC                    23982000
239830                                     AA-TRITC                     23983000
239840         MOVE HOLD-ACH-CR-FOR-AA                                  23984000
239850                                  TO AA-TRITEMCT                  23985000
239860         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  23986000
239870                                                                  23987000
239880     IF HOLD-CR-ITM-FOR-AA = ZEROS                                23988000
239890         NEXT SENTENCE                                            23989000
239900       ELSE                                                       23990000
239910         MOVE 295                 TO AA-TREXTC                    23991000
239920                                     AA-TRITC                     23992000
239930         MOVE HOLD-CR-ITM-FOR-AA                                  23993000
239940                                  TO AA-TRITEMCT                  23994000
239950         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  23995000
239960                                                                  23996000
239970     IF HOLD-REG-CR-FOR-AA = ZEROS                                23997000
239980         NEXT SENTENCE                                            23998000
239990       ELSE                                                       23999000
240000         MOVE 292                 TO AA-TREXTC                    24000000
240010                                     AA-TRITC                     24001000
240020         MOVE HOLD-REG-CR-FOR-AA                                  24002000
240030                                  TO AA-TRITEMCT                  24003000
240040         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  24004000
240050                                                                  24005000
240060     IF HOLD-ALL-DR-FOR-AA = ZEROS                                24006000
240070         NEXT SENTENCE                                            24007000
240080       ELSE                                                       24008000
240090         MOVE 291                 TO AA-TREXTC                    24009000
240100                                     AA-TRITC                     24010000
240110         MOVE HOLD-ALL-DR-FOR-AA                                  24011000
240120                                  TO AA-TRITEMCT                  24012000
240130         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  24013000
240140                                                                  24014000
240150     IF HOLD-E-DEP-FOR-AA = ZEROS                                 24015000
240160         NEXT SENTENCE                                            24016000
240170       ELSE                                                       24017000
240180         MOVE 244                 TO AA-TREXTC                    24018000
240190                                     AA-TRITC                     24019000
240200         MOVE HOLD-E-DEP-FOR-AA                                   24020000
240210                                  TO AA-TRITEMCT                  24021000
240220         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24022000
240230     END-IF.                                                      24023000
240240                                                                  24024000
240250     IF HOLD-E-DEP-ITM-FOR-AA = ZEROS                             24025000
240260         NEXT SENTENCE                                            24026000
240270       ELSE                                                       24027000
240280         MOVE 245                 TO AA-TREXTC                    24028000
240290                                     AA-TRITC                     24029000
240300         MOVE HOLD-E-DEP-ITM-FOR-AA                               24030000
240310                                  TO AA-TRITEMCT                  24031000
240320         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24032000
240330     END-IF.                                                      24033000
240340                                                                  24034000
240350     IF HOLD-MBL-RDC-FOR-AA = ZEROS                               24035000
240360         NEXT SENTENCE                                            24036000
240370       ELSE                                                       24037000
240380         MOVE 242                 TO AA-TREXTC                    24038000
240390                                     AA-TRITC                     24039000
240400         MOVE HOLD-MBL-RDC-FOR-AA                                 24040000
240410                                  TO AA-TRITEMCT                  24041000
240420         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24042000
240430     END-IF.                                                      24043000
240440                                                                  24044000
240450     IF HOLD-MBL-RDC-ITM-FOR-AA = ZEROS                           24045000
240460         NEXT SENTENCE                                            24046000
240470       ELSE                                                       24047000
240480         MOVE 243                 TO AA-TREXTC                    24048000
240490                                     AA-TRITC                     24049000
240500         MOVE HOLD-MBL-RDC-ITM-FOR-AA                             24050000
240510                                  TO AA-TRITEMCT                  24051000
240520         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24052000
240530     END-IF.                                                      24053000
240540                                                                  24054000
240550     IF HOLD-ITM-DEP-FOR-AA = ZEROS                               24055000
240560         NEXT SENTENCE                                            24056000
240570       ELSE                                                       24057000
240580         MOVE 249                 TO AA-TREXTC                    24058000
240590                                     AA-TRITC                     24059000
240600         MOVE HOLD-ITM-DEP-FOR-AA                                 24060000
240610                                  TO AA-TRITEMCT                  24061000
240620         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24062000
240630     END-IF.                                                      24063000
240640                                                                  24064000
240650     IF HOLD-ITM-DEP-ITM-FOR-AA = ZEROS                           24065000
240660         NEXT SENTENCE                                            24066000
240670       ELSE                                                       24067000
240680         MOVE 250                 TO AA-TREXTC                    24068000
240690                                     AA-TRITC                     24069000
240700         MOVE HOLD-ITM-DEP-ITM-FOR-AA                             24070000
240710                                  TO AA-TRITEMCT                  24071000
240720         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24072000
240730     END-IF.                                                      24073000
240740                                                                  24074000
240750 P8803-LOC-ITEM-CNT.                                              24075000
240760     IF HOLD-LOC-ITEMS-FOR-AA = ZEROS                             24076000
240770         NEXT SENTENCE                                            24077000
240780       ELSE                                                       24078000
240790         IF CDC-DB2-DATE >= AA-IMPL-DATE                          24079000
240800             MOVE 229             TO AA-TREXTC                    24080000
240810                                     AA-TRITC                     24081000
240820         ELSE                                                     24082000
240830             MOVE 9               TO AA-TREXTC                    24083000
240840                                     AA-TRITC                     24084000
240850         END-IF                                                   24085000
240860         MOVE HOLD-LOC-ITEMS-FOR-AA                               24086000
240870                                  TO AA-TRITEMCT                  24087000
240880         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   24088000
240890     END-IF.                                                      24089000
240900                                                                  24090000
240910 P8804-CHK-FOR-CYCLE.                                             24091000
240920     IF CYCLE-THIS-STMT = 0 AND SC-EARN-CYCLE-CODE > 0            24092000
240930         GO TO P8809-EXIT                                         24093000
240940     END-IF.                                                      24094000
240950                                                                  24095000
240960     IF CYCLE-THIS-STMT = 0 AND SC-EARN-CYCLE-CODE = 0            24096000
240970         GO TO P8807-INT-PAID                                     24097000
240980     END-IF.                                                      24098000
240990                                                                  24099000
241000 P8805-FIXED-SC.                                                  24100000
241010     IF FIXED-SERV-CHRG-AMT = ZEROS                               24101000
241020         NEXT SENTENCE                                            24102000
241030       ELSE                                                       24103000
241040         MOVE 297                 TO AA-TREXTC                    24104000
241050                                     AA-TRITC                     24105000
241060         MOVE FIXED-SERV-CHRG-AMT TO AA-TRAMT                     24106000
241070         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  24107000
241080                                                                  24108000
241090 P8806-XCESS-3P-L6.                                               24109000
241100     IF HOLD-XCESS-3P-L6-FOR-AA = ZEROS                           24110000
241110         NEXT SENTENCE                                            24111000
241120       ELSE                                                       24112000
241130         MOVE 299                 TO AA-TREXTC                    24113000
241140                                     AA-TRITC                     24114000
241150         MOVE HOLD-XCESS-3P-L6-FOR-AA                             24115000
241160                                  TO AA-TRITEMCT                  24116000
241170         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  24117000
241180                                                                  24118000
241190 P8807-INT-PAID.                                                  24119000
241200     IF DDA-ACCOUNT                                               24120000
241210         GO TO P8808-SWEEP-FEE.                                   24121000
241220                                                                  24122000
241230     IF INT-PAID-LAST-CYCLE > 0                                   24123000
241240        AND BCFSCR-ACCT-ANAL-EARN-CREDIT = 'Y'                    24124000
241250        MOVE 300                 TO AA-TREXTC                     24125000
241260                                    AA-TRITC                      24126000
241270        MOVE INT-PAID-LAST-CYCLE TO AA-TRAMT                      24127000
241280        WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                    24128000
241290     END-IF.                                                      24129000
241300                                                                  24130000
241310 P8808-SWEEP-FEE.                                                 24131000
241320     IF INV-PLAN = SPACES OR 'IC'                                 24132000
241330         GO TO P8809-EXIT.                                        24133000
241340     IF INV-STATUS-CODE = '01'                                    24134000
241350         NEXT SENTENCE                                            24135000
241360       ELSE                                                       24136000
241370         GO TO P8809-EXIT.                                        24137000
241380     IF INV-SWEEP-FEE = ZEROS                                     24138000
241390         NEXT SENTENCE                                            24139000
241400       ELSE                                                       24140000
241410         MOVE 301                 TO AA-TREXTC                    24141000
241420                                     AA-TRITC                     24142000
241430         MOVE INV-SWEEP-FEE       TO AA-TRAMT                     24143000
241440         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                  24144000
241450                                                                  24145000
241460 P8809-EXIT.                                                      24146000
241470     EXIT.                                                        24147000
241480                                                                  24148000
241490******************************************************************24149000
241500* A C C T   A N A L   B A L A N C E   A D J U S T M E N T   T X  *24150000
241510******************************************************************24151000
241520 P8810-BUILD-ACCT-ANAL-ADJ-TX.                                    24152000
241530     IF PROC-DSS                                                  24153000
241540         GO TO P8819-EXIT.                                        24154000
241550     IF NON-ACCT-ANAL-BANK                                        24155000
241560         GO TO P8819-EXIT.                                        24156000
241570     IF CLOSED                                                    24157000
241580         GO TO P8819-EXIT.                                        24158000
241590     IF ACCT-ANAL-ACCT-IND = 'Y'                                  24159000
241600         GO TO P8812-CHECK-BAL-ADJ.                               24160000
241610     GO TO P8819-EXIT.                                            24161000
241620                                                                  24162000
241630 P8812-CHECK-BAL-ADJ.                                             24163000
241640     IF HOLD-CURR-BAL-ADJ = ZEROS AND                             24164000
241650        HOLD-COLL-BAL-ADJ = ZEROS                                 24165000
241660         GO TO P8819-EXIT.                                        24166000
241670                                                                  24167000
241680 P8814-BUILD.                                                     24168000
241690     MOVE SPACES              TO AA-FILEREC.                      24169000
241700     MOVE 01                  TO AA-INSYSTEM.                     24170000
241710     MOVE PROC-BK-NO          TO AA-BKNBR.                        24171000
241720     MOVE 01                  TO AA-APPL.                         24172000
241730     MOVE ACCOUNT-NUMBER      TO AA-ACCOUNT.                      24173000
241740     MOVE 07                  TO AA-RECCODE.                      24174000
241750     INITIALIZE                  AA-BALADJUST.                    24175000
241760     MOVE 'Y'                 TO AA-ADJFILE.                      24176000
241770     MOVE PROC-LAST-DATE      TO AA-EFFDT.                        24177000
241780     SUBTRACT PROC-PRE-DAYS FROM BACKOUT-DAYS                     24178000
241790                          GIVING AA-LDAYS.                        24179000
241800     MOVE HOLD-CURR-BAL-ADJ   TO AA-LBAL.                         24180000
241810     MOVE 00001               TO AA-LDESCRNBR.                    24181000
241820     MOVE 'N'                 TO AA-LSTMTPRT.                     24182000
241830     MOVE AA-LDAYS            TO AA-CDAYS.                        24183000
241840     MOVE HOLD-COLL-BAL-ADJ   TO AA-CBAL.                         24184000
241850     MOVE 00002               TO AA-CDESCNBR.                     24185000
241860     MOVE 'N'                 TO AA-CSTMTPRT.                     24186000
241870     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      24187000
241880     IF PROC-PRE-DAYS = ZERO                                      24188000
241890         GO TO P8819-EXIT.                                        24189000
241900     MOVE AA-LDAYS            TO DAYS-15.                         24190000
241910     CALL 'CDCDT15'        USING PROC-LAST-DATE                   24191000
241920                                 DAYS-15                          24192000
241930                                 END-DATE-15.                     24193000
241940     MOVE END-DATE-15         TO AA-EFFDT.                        24194000
241950     MOVE PROC-PRE-DAYS       TO AA-LDAYS                         24195000
241960                                 AA-CDAYS.                        24196000
241970     WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC.                      24197000
241980                                                                  24198000
241990 P8819-EXIT.                                                      24199000
242000     EXIT.                                                        24200000
242010                                                                  24201000
242020******************************************************************24202000
242030*                C H E C K   I M M   D E B I T S                 *24203000
242040******************************************************************24204000
242050 P8820-CHK-IMM-DEBITS.                                            24205000
242060     IF IMM-ACCOUNT                                               24206000
242070         NEXT SENTENCE                                            24207000
242080       ELSE                                                       24208000
242090         GO TO P8821-CHK-SAV-DEBITS.                              24209000
242100     IF DSDSTXL-CODE = 990 OR 910 OR 460 OR 710 OR 700 OR 860 OR  24210000
242110                       930 OR 931 OR 932 OR 972 OR 913 OR 988 OR  24211000
242120                       775 OR 776 OR 777 OR 778                   24212000
242130         IF NUM-3RD-PARTY-DEBITS GREATER THAN 6                   24213000
242140             MOVE 21 TO HOLD-REASON-CODE                          24214000
242150             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.    24215000
242160     GO TO P8823-CONT.                                            24216000
242170                                                                  24217000
242180 P8821-CHK-SAV-DEBITS.                                            24218000
242190     IF SAV-ACCOUNT                                               24219000
242200         NEXT SENTENCE                                            24220000
242210       ELSE                                                       24221000
242220         GO TO P8824-EXIT.                                        24222000
242230     IF DSDSTXL-CODE = 700 OR 860 OR 930 OR 931 OR 932 OR 972     24223000
242240         IF NUM-3RD-PARTY-DEBITS GREATER THAN 6                   24224000
242250             MOVE 21 TO HOLD-REASON-CODE                          24225000
242260             PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.    24226000
242270                                                                  24227000
242280 P8823-CONT.                                                      24228000
242290     ADD NUM-FT-ACH-DEBITS  NUM-3RD-PARTY-DEBITS  NUM-TELE-DEBITS 24229000
242300         GIVING TEMP-IMM-DEBITS.                                  24230000
242310     IF TEMP-IMM-DEBITS LESS THAN 7                               24231000
242320         GO TO P8824-EXIT.                                        24232000
242330     MOVE 22 TO HOLD-REASON-CODE.                                 24233000
242340     PERFORM P7200-MSTR-TX-EXCEPTIONS THRU P7209-EXIT.            24234000
242350                                                                  24235000
242360 P8824-EXIT.                                                      24236000
242370     EXIT.                                                        24237000
242380                                                                  24238000
242390******************************************************************24239000
242400* SUBROUTINE - D E C I D E  I F  S.C.  D E B I T                 *24240000
242410******************************************************************24241000
242420 P8825-CK-DB-SC-ITEM.                                             24242000
242430     MOVE ZEROS TO HOLD-SC-FEE.                                   24243000
242440     IF DSDSTXL-CODE = 990 OR 910 OR 870 OR 874 OR 878            24244000
242450                           OR 913 OR 988                          24245000
242460         GO TO P8826-DB-SC-ITM.                                   24246000
242470     IF DSDSTXL-NOT-SC                                            24247000
242480         GO TO P8828-EXIT.                                        24248000
242490                                                                  24249000
242500 P8826-DB-SC-ITM.                                                 24250000
242510     IF BCFSCR-CHARGE-A-TIME                                      24251000
242520         NEXT SENTENCE                                            24252000
242530       ELSE                                                       24253000
242540         GO TO P8828-EXIT.                                        24254000
242550     IF NUM-SERV-CHG-DEBITS LESS THAN BCFSCR-NO-FREE-WITHD        24255000
242560         GO TO P8828-EXIT.                                        24256000
242570     IF DSDSTXL-REG-SC                                            24257000
242580         MOVE BCFSCR-DEBIT-CHG-1 TO HOLD-SC-FEE                   24258000
242590         GO TO P8828-EXIT.                                        24259000
242600     IF DSDSTXL-ATM-SC OR DSDSTXL-FT-SC                           24260000
242610         MOVE BCFSCR-DEBIT-CHG-2 TO HOLD-SC-FEE                   24261000
242620         GO TO P8828-EXIT.                                        24262000
242630     IF DSDSTXL-ACH-SC                                            24263000
242640         MOVE BCFSCR-DEBIT-CHG-3 TO HOLD-SC-FEE.                  24264000
242650                                                                  24265000
242660 P8828-EXIT.                                                      24266000
242670     EXIT.                                                        24267000
242680                                                                  24268000
242690******************************************************************24269000
242700*   S E R V I C E   C H A R G E   S T M T .   T R A I L E R      *24270000
242710******************************************************************24271000
242720 P8830-BUILD-SC-TRAILER.                                          24272000
242730     IF PROC-DSS                                                  24273000
242740         GO TO P8839-EXIT.                                        24274000
242750     MOVE SPACES TO POSTED-WORK.                                  24275000
242760     MOVE BCF-BANK-NO TO SCT-BANK-NO.                             24276000
242770     MOVE ACCOUNT-ID TO SCT-ACCT-ID.                              24277000
242780     MOVE ACCOUNT-NUMBER TO SCT-ACCT-NO.                          24278000
242790     MOVE 996 TO SCT-REPORT-CODE.                                 24279000
242800     MOVE NUM-SC-DEBITS (1)    TO SCT-SERV-CHG-DEBITS.            24280000
242810     MOVE NUM-SC-CREDITS (1)   TO SCT-SERV-CHG-CREDIT.            24281000
242820     MOVE NUM-SC-ITEMS (1)     TO SCT-NO-DEP-ITEMS.               24282000
242830     MOVE AVG-CURR-BAL-CYC (1) TO SCT-AVG-CURR-BAL.               24283000
242840     MOVE AVG-COLL-BAL-CYC (1) TO SCT-AVG-COLL-BAL.               24284000
242850     MOVE ZEROS TO SCT-ENCL-CNT-SC-FEE.                           24285000
242860     MOVE INT-PAID-LAST-CYCLE TO SCT-INT-PAID.                    24286000
242870     MOVE HOLD-DISP TO SCT-SERV-CHG-DISP.                         24287000
242880     MOVE BCFSCR-EARN-RATE TO SCT-EARN-RATE.                      24288000
242890     MOVE BCFSCR-OD-RATE   TO SCT-OD-RATE.                        24289000
242900     MOVE SERV-CHG-AMT (1) TO SCT-SERV-CHG-AMT.                   24290000
242910     MOVE NUM-LOCAL-ITEMS  TO SCT-NO-LOC-ITEMS.                   24291000
242920     MOVE LOCAL-ITEMS-IND  TO SCT-LOC-ITEMS-IND.                  24292000
242930     IF INV-PLAN = SPACES OR 'IC'                                 24293000
242940       MOVE ZEROS TO SCT-INV-INT-PD-LST-CYC                       24294000
242950                     SCT-INV-GR-BAL-LST-CYC                       24295000
242960       MOVE HOLD-DAYS-IN-CYCLE TO SCT-INV-DAYS-IN-PREV-CYC        24296000
242970      ELSE                                                        24297000
242980       IF INV-CLOSED                                              24298000
242990         MOVE ZEROS TO SCT-INV-INT-PD-LST-CYC                     24299000
243000                       SCT-INV-GR-BAL-LST-CYC                     24300000
243010         MOVE HOLD-DAYS-IN-CYCLE TO SCT-INV-DAYS-IN-PREV-CYC      24301000
243020        ELSE                                                      24302000
243030         MOVE INV-INT-PAID-LAST-CYC TO SCT-INV-INT-PD-LST-CYC     24303000
243040         MOVE INV-GROSS-BAL-LAST-CYC TO SCT-INV-GR-BAL-LST-CYC    24304000
243050         MOVE INV-DAYS-IN-PREV-CYCLE TO SCT-INV-DAYS-IN-PREV-CYC. 24305000
243060     MOVE ZERO TO SC-HDR-SW.                                      24306000
243070     WRITE STMT-HDR FROM PD-SCT.                                  24307000
243080                                                                  24308000
243090 P8839-EXIT.                                                      24309000
243100     EXIT.                                                        24310000
243110                                                                  24311000
243120******************************************************************24312000
243130*    S E T   S T M T   S O R T   K E Y   F O R   C H E C K S     *24313000
243140******************************************************************24314000
243150 P8840-SET-KEY-FOR-CHKS.                                          24315000
243160     IF DSDSTXL-CHK-NO = ZERO                                     24316000
243170         MOVE NON-SER-CHK-KEY TO SAVE-DR-SORT-KEY                 24317000
243180       ELSE                                                       24318000
243190         MOVE SER-CHK-KEY TO SAVE-DR-SORT-KEY.                    24319000
243200                                                                  24320000
243210 P8841-EXIT.                                                      24321000
243220     EXIT.                                                        24322000
243230                                                                  24323000
243240******************************************************************24324000
243250*    C R E A T E   O B S   E N C L O S U R E   T R A N S         *24325000
243260******************************************************************24326000
243270 P8850-CREATE-OBS-ENCL-TX.                                        24327000
243280     MOVE ACCOUNT-NUMBER      TO OBS-ENCL-ACCT-NO.                24328000
243290     MOVE NUM-ENCLOSURES      TO OBS-ENCL-ACT-VOL.                24329000
243300     MOVE ITEM-HANDLING-CODE  TO OBS-ENCL-ITEM-HANDLE.            24330000
243310     MOVE STMT-DISP-CODE      TO OBS-ENCL-STMT-DISP.              24331000
243320     MOVE STMT-CYCLE-CODE     TO OBS-ENCL-CYCLE-CODE.             24332000
243330     MOVE STATEMENT-IMAGE-IND TO OBS-ENCL-STMT-IMAGE-IND.         24333000
243340     MOVE STMT-LOCATION-CODE  TO OBS-ENCL-LOC-CODE.               24334000
243350     WRITE OBS-TX FROM ONLINE-BULK-SORT-ENCLOSURES.               24335000
243360                                                                  24336000
243370 P8854-EXIT.                                                      24337000
243380     EXIT.                                                        24338000
243390                                                                  24339000
243400******************************************************************24340000
243410*    C R E A T E   O B S   E X C E P T I O N   T X   (UNPOSTED)  *24341000
243420******************************************************************24342000
243430 P8855-CREATE-OBS-EXCPT-UNPOST.                                   24343000
243460     IF DSDSTXL-CODE LESS THAN 460                                24346000
243470         GO TO P8859-EXIT.                                        24347000
243480     IF DSDSTXL-CODE GREATER THAN 460 AND                         24348000
243490        DSDSTXL-CODE LESS THAN 700                                24349000
243500         MOVE ZEROS TO DSDSTXL-CHK-NO.                            24350000
243510     MOVE DSDSTXL-ACCT-NO TO OBS-EXCPT-ACCT-NO.                   24351000
243520     MOVE DSDSTXL-ACCT-ID TO OBS-EXCPT-ACCT-ID.                   24352000
243530     MOVE DSDSTXL-AMOUNT TO OBS-FIELD1-AMT-WK.                    24353000
243540     MOVE OBS-FIELD1-WK TO OBS-EXCPT-FIELD2.                      24354000
243550     MOVE 1 TO OBS-EXCPT-CNT.                                     24355000
243560     MOVE DSDSTXL-BAT-NO TO OBS-BAT-NO.                           24356000
243570     MOVE DSDSTXL-SEQ-NO TO OBS-SEQ-NO.                           24357000
243580     MOVE OBS-BAT-SEQ-WK TO OBS-EXCPT-DOC-NO.                     24358000
243590     MOVE HOLD-UI-REASON TO OBS-EXCPT-REASON-CODE.                24359000
243600     MOVE DSDSTXL-ACH-PAR-NBR TO OBS-EXCPT-PAR-NBR.               24360000
243610     MOVE DSDSTXL-CODE TO OBS-EXCPT-TX-CODE.                      24361000
243620     MOVE DSDSTXL-POS-REF-NBR TO OBS-EXCPT-POS-REF-NBR.           24362000
243630     MOVE NIP1-SEQ-NBR TO OBS-EXCPT-NIPS-SEQ-NBR.                 24363000
243640     IF DSDSTXL-CHK-NO = ZERO                                     24364000
243650         MOVE 11 TO OBS-EXCPT-TYPE                                24365000
243660         MOVE DSDSTXL-AMOUNT TO OBS-FIELD1-AMT-WK                 24366000
243670         MOVE OBS-FIELD1-WK TO OBS-EXCPT-FIELD1                   24367000
243680       ELSE                                                       24368000
243690         MOVE 10 TO OBS-EXCPT-TYPE                                24369000
243700         MOVE DSDSTXL-CHK-NO TO OBS-EXCPT-FIELD1.                 24370000
243710     WRITE OBS-TX FROM ONLINE-BULK-SORT-EXCEPTIONS.               24371000
243720                                                                  24372000
243730 P8859-EXIT.                                                      24373000
243740     EXIT.                                                        24374000
243750                                                                  24375000
243760******************************************************************24376000
243770*    C R E A T E   O B S   E X C E P T I O N   T X   (STOP PAYS) *24377000
243780******************************************************************24378000
243790 P8860-CREATE-OBS-EXCPT-STOPPAY.                                  24379000
243800     MOVE DSDSTXL-ACCT-NO TO OBS-EXCPT-ACCT-NO.                   24380000
243810     MOVE DSDSTXL-ACCT-ID TO OBS-EXCPT-ACCT-ID.                   24381000
243820     MOVE DSDSTXL-AMOUNT TO OBS-FIELD1-AMT-WK.                    24382000
243830     MOVE OBS-FIELD1-WK TO OBS-EXCPT-FIELD2.                      24383000
243840     MOVE 1 TO OBS-EXCPT-CNT.                                     24384000
243850     MOVE DSDSTXL-BAT-NO TO OBS-BAT-NO.                           24385000
243860     MOVE DSDSTXL-SEQ-NO TO OBS-SEQ-NO.                           24386000
243870     MOVE OBS-BAT-SEQ-WK TO OBS-EXCPT-DOC-NO.                     24387000
243880     MOVE ZEROS TO OBS-EXCPT-REASON-CODE.                         24388000
243890     MOVE DSDSTXL-ACH-PAR-NBR TO OBS-EXCPT-PAR-NBR.               24389000
243900     MOVE DSDSTXL-CODE TO OBS-EXCPT-TX-CODE.                      24390000
243910     MOVE DSDSTXL-POS-REF-NBR TO OBS-EXCPT-POS-REF-NBR.           24391000
243920     IF DSDSTXL-CHK-NO = ZERO                                     24392000
243930         MOVE 21 TO OBS-EXCPT-TYPE                                24393000
243940         MOVE DSDSTXL-AMOUNT TO OBS-FIELD1-AMT-WK                 24394000
243950         MOVE OBS-FIELD1-WK TO OBS-EXCPT-FIELD1                   24395000
243960       ELSE                                                       24396000
243970         MOVE 20 TO OBS-EXCPT-TYPE                                24397000
243980         MOVE DSDSTXL-CHK-NO TO OBS-EXCPT-FIELD1.                 24398000
243990     WRITE OBS-TX FROM ONLINE-BULK-SORT-EXCEPTIONS.               24399000
244000                                                                  24400000
244010 P8864-EXIT.                                                      24401000
244020     EXIT.                                                        24402000
244030                                                                  24403000
244040******************************************************************24404000
244050*    C R E A T E   O B S   E X C E P T I O N   T X   (POSTED)    *24405000
244060******************************************************************24406000
244070 P8865-CREATE-OBS-EXCPT-POSTED.                                   24407000
244080     MOVE 30 TO OBS-EXCPT-TYPE.                                   24408000
244090     MOVE DSDSTXL-BAT-NO TO OBS-BAT-NO.                           24409000
244100     MOVE DSDSTXL-SEQ-NO TO OBS-SEQ-NO.                           24410000
244110     MOVE OBS-BAT-SEQ-WK TO OBS-EXCPT-DOC-NO.                     24411000
244120     MOVE DSDSTXL-ACCT-NO TO OBS-EXCPT-ACCT-NO.                   24412000
244130     MOVE DSDSTXL-ACCT-ID TO OBS-EXCPT-ACCT-ID.                   24413000
244140     MOVE HOLD-REASON-CODE TO OBS-EXCPT-REASON-CODE.              24414000
244150     IF WATCHED                                                   24415000
244160         MOVE '50' TO OBS-EXCPT-REASON-CODE.                      24416000
244170     IF WATCHED-ACH                                               24417000
244180         MOVE '34' TO OBS-EXCPT-REASON-CODE.                      24418000
244190     MOVE DSDSTXL-ACH-PAR-NBR TO OBS-EXCPT-PAR-NBR.               24419000
244200     MOVE DSDSTXL-CODE TO OBS-EXCPT-TX-CODE.                      24420000
244210     MOVE DSDSTXL-POS-REF-NBR TO OBS-EXCPT-POS-REF-NBR.           24421000
244220     MOVE ZEROS TO OBS-EXCPT-FIELD1.                              24422000
244230     MOVE DSDSTXL-AMOUNT TO OBS-FIELD1-AMT-WK.                    24423000
244240     MOVE OBS-FIELD1-WK TO OBS-EXCPT-FIELD2.                      24424000
244250     MOVE 1 TO OBS-EXCPT-CNT.                                     24425000
244260     WRITE OBS-TX FROM ONLINE-BULK-SORT-EXCEPTIONS.               24426000
244270                                                                  24427000
244280 P8869-EXIT.                                                      24428000
244290     EXIT.                                                        24429000
244300                                                                  24430000
244310******************************************************************24431000
244320* SET UP FOR DEPOSIT RECON REPORT                                *24432000
244330******************************************************************24433000
244340 P8890-SETUP-DEP-RECON-RPT.                                       24434000
244350*    MOVE DSDSTXL-CHK-NO TO DSDSTXL-ITEM-COUNT.                   24435000
244360     IF DSDSTXL-CO-DESC = SPACES AND                              24436000
244370        DSDSTXL-DESC = SPACES AND                                 24437000
244380        DSDSTXL-CHK-NO NOT = ZEROS                                24438000
244390         MOVE DSDSTXL-CHK-NO TO DESC-WORK-ST-LOC                  24439000
244400         MOVE OSB-DESC-0087-A TO DSDSTXL-CO-DESC                  24440000
244410         MOVE DESCRIPTION-WORK-2 TO DSDSTXL-DESC.                 24441000
244420                                                                  24442000
244430     IF DSDSTXL-CODE = 544                                        24443000
244440         MOVE DSDSTXL-CHK-NO TO DESC-WORK-ST-LOC                  24444000
244450         MOVE OSB-DESC-0092-A TO DSDSTXL-CO-DESC                  24445000
244460         MOVE DESCRIPTION-WORK-2 TO DSDSTXL-DESC.                 24446000
244470                                                                  24447000
244480     IF DSDSTXL-CODE = 510 OR 970                                 24448000
244490         MOVE ZEROS              TO DSDSTXL-ITEM-COUNT            24449000
244500         MOVE DSDSTXL-CHK-NO     TO DESC-WORK-ST-LOC              24450000
244510         MOVE OSB-DESC-0095-A    TO DSDSTXL-CO-DESC               24451000
244520         MOVE DESCRIPTION-WORK-2 TO DSDSTXL-DESC.                 24452000
244530                                                                  24453000
244540 P8899-EXIT.                                                      24454000
244550     EXIT.                                                        24455000
244560                                                                  24456000
244570******************************************************************24457000
244580*        B U I L D   O D B   H E A D E R   R E C O R D S         *24458000
244590******************************************************************24459000
244600 P8960-BUILD-ODB-HDR.                                             24460000
244610     IF ODB-PLAN = SPACES                                         24461000
244620         GO TO P8969-EXIT.                                        24462000
244630     IF ODB-CLOSED-DELETE                                         24463000
244640         NEXT SENTENCE                                            24464000
244650       ELSE                                                       24465000
244660         GO TO P8962-CONT-ODB-HDR.                                24466000
244670     IF LAST-ADV-DATE     GREATER THAN DTE-LAST-CYCLE-STMT OR     24467000
244680        LAST-PMNT-DATE    GREATER THAN DTE-LAST-CYCLE-STMT OR     24468000
244690        LAST-INT-DATE     GREATER THAN DTE-LAST-CYCLE-STMT OR     24469000
244700        AUTH-CREDIT-LIMIT GREATER THAN ZERO                       24470000
244710         GO TO P8962-CONT-ODB-HDR.                                24471000
244720     GO TO P8969-EXIT.                                            24472000
244730                                                                  24473000
244740 P8962-CONT-ODB-HDR.                                              24474000
244750     IF ODB-LOAN-BAL = ZEROS AND                                  24475000
244760        NO-ODB-ACT-THIS-PERIOD AND                                24476000
244770        ODB-FEE-YTD = ZEROS                                       24477000
244780         GO TO P8969-EXIT.                                        24478000
244790     MOVE SPACES                  TO POSTED-WORK.                 24479000
244800     MOVE BCF-BANK-NO             TO PDH-BANK-NO.                 24480000
244810     MOVE ACCOUNT-ID              TO PDH-ACCT-ID.                 24481000
244820     MOVE ACCOUNT-NUMBER          TO PDH-ACCT-NO.                 24482000
244830     MOVE 013                     TO PDH-REPORT-CODE.             24483000
244840     MOVE DTE-LAST-CYCLE-STMT     TO PDH-LAST-STMT-DT.            24484000
244850     MOVE ODB-LOAN-BAL            TO PDH-ENDING-BAL.              24485000
244860     MOVE ZEROS                   TO PDH-NO-ENCLOSURES.           24486000
244870     MOVE AMT-ODB-ADV-ON-STMT     TO PDH-DEBIT-AMOUNT.            24487000
244880     MOVE AMT-ODB-PAY-ON-STMT     TO PDH-CREDIT-AMOUNT.           24488000
244890     MOVE ODB-HDR-KEY             TO PDH-SORT-KEY.                24489000
244900     MOVE PROC-CURR-DATE          TO PDH-CURR-PROC-DT.            24490000
244910     IF CYCLE-THIS-STMT = 1 AND CYCLE-THIS-SC-EARN = 1            24491000
244920         MOVE HOLD-PREV-ODB-STMT-BAL TO PDH-STMT-BAL              24492000
244930       ELSE                                                       24493000
244940         MOVE PREV-STMT-BAL       TO PDH-STMT-BAL.                24494000
244950     MOVE ACCOUNT-CLASS           TO PDH-ACCT-CLASS.              24495000
244960     IF DDA-SEC-STMT                                              24496000
244970         MOVE HOLD-DDA-ACCT-ID-LINKED-TO-SEC                      24497000
244980                                  TO PDH-ACCT-ID-LINKED-TO-SEC    24498000
244990         MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC                      24499000
245000                                  TO PDH-ACCT-NO-LINKED-TO-SEC    24500000
245010       ELSE                                                       24501000
245020         MOVE ACCOUNT-ID          TO PDH-ACCT-ID-LINKED-TO-SEC    24502000
245030         MOVE ACCOUNT-NUMBER      TO PDH-ACCT-NO-LINKED-TO-SEC.   24503000
245040     IF CYCLE-THIS-SC-EARN = 0                                    24504000
245050         MOVE DAYS-IN-CYCLE       TO PDH-NO-DAYS-IN-CYC           24505000
245060       ELSE                                                       24506000
245070         MOVE HOLD-DAYS-IN-CYCLE  TO PDH-NO-DAYS-IN-CYC.          24507000
245080     MOVE INV-PLAN                TO PDH-INV-PLAN.                24508000
245090     MOVE STMT-CYCLE-CODE         TO PDH-STMT-CYCLE-CODE.         24509000
245100     MOVE STMT-DISP-CODE          TO PDH-STMT-DISP.               24510000
245110     MOVE ZEROS TO PDH-INV-MAT-DATE                               24511000
245120                   PDH-DATE-CLOSED.                               24512000
245130     MOVE SPACE TO PDH-INV-RENEW-CODE.                            24513000
245140****  BYPASS PREPAID CARD ACCOUNTS                                24514000
245150     WRITE STMT-HDR FROM PD-PDH.                                  24515000
245160                                                                  24516000
245170     MOVE SPACES                  TO POSTED-WORK.                 24517000
245180     MOVE BCF-BANK-NO             TO ODH-BANK-NO.                 24518000
245190     MOVE ACCOUNT-ID              TO ODH-ACCT-ID.                 24519000
245200     MOVE ACCOUNT-NUMBER          TO ODH-ACCT-NO.                 24520000
245210     MOVE 013                     TO ODH-REPORT-CODE.             24521000
245220     MOVE ODB-LOAN-BAL            TO ODH-ODB-LOAN-BAL.            24522000
245230     MOVE AMT-PAST-DUE            TO ODH-AMT-PAST-DUE.            24523000
245240     MOVE ODB-HDR-2-KEY           TO ODH-SORT-KEY.                24524000
245250     MOVE PROC-CURR-DATE          TO ODH-CURR-PROC-DT.            24525000
245260     IF ODB-CLOSED-DELETE                                         24526000
245270         MOVE ZEROS               TO ODH-AUTH-CR-LIMIT            24527000
245280       ELSE                                                       24528000
245290         MOVE AUTH-CREDIT-LIMIT   TO ODH-AUTH-CR-LIMIT.           24529000
245300     MOVE YTD-ODB-INT             TO ODH-YTD-ODB-INT.             24530000
245310     MOVE ODB-INT-PAID-PREV-YR    TO ODH-ODB-INT-PR-YR.           24531000
245320     MOVE ODB-PLAN                TO ODH-ODB-PLAN.                24532000
245330     MOVE ODB-YTD-INT-SECURED     TO ODH-YTD-ODB-INT-SECURED.     24533000
245340     MOVE ODB-PREV-YR-INT-SECURED TO ODH-ODB-INT-PR-YR-SECURED.   24534000
245350     MOVE CR-LIFE-PAID-MTD        TO ODH-FEES-CHARGED.            24535000
245360     MOVE ODB-FEE-MTD             TO ODH-MONTHLY-FEE              24536000
245370     MOVE ODB-ACCUM-INT-CHARGED   TO ODH-INT-CHARGED.             24537000
245380                                                                  24538000
245390     COMPUTE ODH-YTD-FEES-CHARGED = CR-LIFE-PAID-YTD +            24539000
245400                                    CR-LIFE-PAID-MTD +            24540000
245410                                    ODB-FEE-YTD +                 24541000
245420                                    ODB-FEE-MTD.                  24542000
245430                                                                  24543000
245440     MOVE CR-LIFE-PAID-PREV-YR    TO ODH-FEES-CHARGED-PR-YR.      24544000
245450     MOVE STMT-CYCLE-CODE         TO SUB-CYCLE.                   24545000
245460     IF STMT-CYCLE-CODE EQUAL 99                                  24546000
245470         PERFORM P9090-SELECT-SPECSTMT THRU P9099-EXIT            24547000
245480         MOVE WORK-JUL-NXT-PROCESS TO ODH-NEXT-STMT-CYCLE         24548000
245490     ELSE                                                         24549000
245500         MOVE DSDM020P-NEXT-CYC-DATE (SUB-CYCLE)                  24550000
245510                                  TO ODH-NEXT-STMT-CYCLE          24551000
245520     END-IF.                                                      24552000
245530                                                                  24553000
245540     IF DDA-SEC-STMT                                              24554000
245550         MOVE HOLD-DDA-ACCT-ID-LINKED-TO-SEC                      24555000
245560                                  TO ODH-ACCT-ID-LINKED-TO-SEC    24556000
245570         MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC                      24557000
245580                                  TO ODH-ACCT-NO-LINKED-TO-SEC    24558000
245590       ELSE                                                       24559000
245600         MOVE ACCOUNT-ID          TO ODH-ACCT-ID-LINKED-TO-SEC    24560000
245610         MOVE ACCOUNT-NUMBER      TO ODH-ACCT-NO-LINKED-TO-SEC.   24561000
245620     WRITE STMT-HDR FROM PD-ODH.                                  24562000
245630                                                                  24563000
245640 P8969-EXIT.                                                      24564000
245650     EXIT.                                                        24565000
245660                                                                  24566000
245670******************************************************************24567000
245680*        B U I L D   O D B   T R A I L E R   R E C O R D         *24568000
245690******************************************************************24569000
245700 P8970-BUILD-ODB-TRLR.                                            24570000
245710     IF ODB-PLAN = SPACES                                         24571000
245720         GO TO P8979-EXIT.                                        24572000
245730     IF ODB-CLOSED-DELETE                                         24573000
245740         NEXT SENTENCE                                            24574000
245750       ELSE                                                       24575000
245760         GO TO P8972-CONT-ODB-TRLR.                               24576000
245770     IF LAST-ADV-DATE     GREATER THAN DTE-LAST-CYCLE-STMT OR     24577000
245780        LAST-PMNT-DATE    GREATER THAN DTE-LAST-CYCLE-STMT OR     24578000
245790        LAST-INT-DATE     GREATER THAN DTE-LAST-CYCLE-STMT OR     24579000
245800        AUTH-CREDIT-LIMIT GREATER THAN ZERO                       24580000
245810         GO TO P8972-CONT-ODB-TRLR.                               24581000
245820     GO TO P8979-EXIT.                                            24582000
245830                                                                  24583000
245840 P8972-CONT-ODB-TRLR.                                             24584000
245850     IF ODB-LOAN-BAL = ZEROS AND                                  24585000
245860        NO-ODB-ACT-THIS-PERIOD AND                                24586000
245870        ODB-FEE-YTD = ZEROS                                       24587000
245880         GO TO P8979-EXIT.                                        24588000
245890     MOVE SPACES TO POSTED-WORK.                                  24589000
245900     MOVE BCF-BANK-NO                TO ODT-BANK-NO.              24590000
245910     MOVE ACCOUNT-ID                 TO ODT-ACCT-ID.              24591000
245920     MOVE ACCOUNT-NUMBER             TO ODT-ACCT-NO.              24592000
245930     MOVE 995                        TO ODT-REPORT-CODE.          24593000
245940     MOVE ODB-STATUS-CODE            TO ODT-ODB-STATUS.           24594000
245950     MOVE HOLD-GROSS-LOAN-BAL        TO ODT-GR-LOAN-BAL.          24595000
245960     MOVE HOLD-2ND-GROSS-LOAN-BAL    TO ODT-GR-LOAN-BAL2.         24596000
245970     MOVE ODB-TRLR-KEY               TO ODT-SORT-KEY.             24597000
245980     MOVE PROC-CURR-DATE             TO ODT-CURR-PROC-DT.         24598000
245990     MOVE AVG-BAL-TO-COMPUTE         TO ODT-AVG-BAL-TO-COMP.      24599000
246000     MOVE HOLD-2ND-AVG-BAL           TO ODT-AVG-BAL-TO-COMP2.     24600000
246010     MOVE ODB-2ND-RATE-IND           TO ODT-2ND-RATE-IND.         24601000
246020     IF CYCLE-THIS-SC-EARN = 1                                    24602000
246030         MOVE HOLD-PREV-XX-ODB-RATE1 TO ODT-INT-RATE-1            24603000
246040         MOVE HOLD-PREV-XX-ODB-AMT1  TO ODT-INT-AMT-1             24604000
246050         MOVE HOLD-PREV-XX-ODB-RATE2 TO ODT-INT-RATE-2            24605000
246060         MOVE ODB-2ND-RATE-IND       TO ODB-PREV-2ND-RATE-IND     24606000
246070         MOVE '0'                    TO ODB-2ND-RATE-IND          24607000
246080       ELSE                                                       24608000
246090         MOVE FIRST-INT-RATE         TO ODT-INT-RATE-1            24609000
246100         MOVE FIRST-INT-AMT          TO ODT-INT-AMT-1             24610000
246110         MOVE SECOND-INT-RATE        TO ODT-INT-RATE-2            24611000
246120     END-IF.                                                      24612000
246130     MOVE ZEROS TO ODB-RATE-WK2                                   24613000
246140     IF ODB-NO-VARIANCE OR ODB-FIXED-RATE                         24614000
246150         MOVE FIRST-INT-RATE TO ODB-RATE-WK2                      24615000
246160     ELSE                                                         24616000
246170         IF ODB-PLUS-VARIANCE                                     24617000
246180             ADD FIRST-INT-RATE  ODB-RATE-VARIANCE                24618000
246190                 GIVING ODB-RATE-WK2                              24619000
246200           ELSE                                                   24620000
246210             SUBTRACT ODB-RATE-VARIANCE FROM FIRST-INT-RATE       24621000
246220                 GIVING ODB-RATE-WK2                              24622000
246230         END-IF                                                   24623000
246240     END-IF                                                       24624000
246250     COMPUTE WORK-INT-CHG-1  =                                    24625000
246260             (AVG-BAL-TO-COMPUTE *                                24626000
246270             ((ODB-RATE-WK2 * HOLD-DAYS-IN-CYCLE) / 365))         24627000
246280     MOVE WORK-INT-CHG-1 TO ODT-INT-CHG-1                         24628000
246290     SUBTRACT ODT-INT-CHG-1 FROM HOLD-MONTHLY-ACCUM-INT GIVING    24629000
246300                                        ODT-INT-CHG-2.            24630000
246310     IF ODB-NO-VARIANCE OR ODB-FIXED-RATE                         24631000
246320         GO TO P8974-CONT.                                        24632000
246330     IF ODB-PLUS-VARIANCE                                         24633000
246340         ADD ODB-RATE-VARIANCE       TO ODT-INT-RATE-1            24634000
246350       ELSE                                                       24635000
246360         SUBTRACT ODB-RATE-VARIANCE FROM ODT-INT-RATE-1.          24636000
246370 P8974-CONT.                                                      24637000
246380     MOVE ODB-ACCT-TO-BE-CHRG TO ODT-ACCT-TO-CHRG.                24638000
246390     IF ODT-ACCT-TO-CHRG = ZEROS                                  24639000
246400         MOVE ZEROS TO ODT-AMT-TO-CHRG                            24640000
246410       ELSE                                                       24641000
246420         MOVE HOLD-ODB-AMT-TO-CHRG TO ODT-AMT-TO-CHRG.            24642000
246430     MOVE ZEROS TO HOLD-ODB-AMT-TO-CHRG.                          24643000
246440     IF CYCLE-THIS-SC-EARN = 0                                    24644000
246450         MOVE ZEROS TO ODT-NEW-INT-RATE                           24645000
246460         GO TO P8978-WRITE-ODB-TRLR.                              24646000
246470     MOVE FIRST-INT-RATE TO ODT-NEW-INT-RATE.                     24647000
246480     IF ODB-NO-VARIANCE OR ODB-FIXED-RATE                         24648000
246490         GO TO P8978-WRITE-ODB-TRLR.                              24649000
246500     IF ODB-PLUS-VARIANCE                                         24650000
246510         ADD ODB-RATE-VARIANCE TO ODT-NEW-INT-RATE                24651000
246520       ELSE                                                       24652000
246530         SUBTRACT ODB-RATE-VARIANCE FROM ODT-NEW-INT-RATE.        24653000
246540                                                                  24654000
246550 P8978-WRITE-ODB-TRLR.                                            24655000
246560     WRITE STMT-HDR FROM PD-ODT.                                  24656000
246570                                                                  24657000
246580 P8979-EXIT.                                                      24658000
246590     EXIT.                                                        24659000
246600                                                                  24660000
246610******************************************************************24661000
246620* B U I L D   N O W   A C C O U N T   H E A D E R   R E C O R D  *24662000
246630******************************************************************24663000
246640 P8980-BUILD-NOW-HDR.                                             24664000
246650     MOVE SPACES TO POSTED-WORK.                                  24665000
246660     MOVE BCF-BANK-NO TO NAH-BANK-NO.                             24666000
246670     MOVE ACCOUNT-ID TO NAH-ACCT-ID.                              24667000
246680     MOVE ACCOUNT-NUMBER TO NAH-ACCT-NO.                          24668000
246690     MOVE 014 TO NAH-REPORT-CODE.                                 24669000
246700     MOVE ZEROS TO NAH-EARN-BALANCE.                              24670000
246710     MOVE BCFSCR-BALANCE-CODE TO NAH-BALANCE-CODE.                24671000
246720     EVALUATE TRUE                                                24672000
246730         WHEN NAH-AVG-CUR-CYC                                     24673000
246740             MOVE AVG-CURR-BAL-CYC (1) TO NAH-EARN-BALANCE        24674000
246750         WHEN NAH-AVG-COL-CYC                                     24675000
246760             MOVE AVG-COLL-BAL-CYC (1) TO NAH-EARN-BALANCE        24676000
246770         WHEN NAH-LOW-BAL-CYC                                     24677000
246780             MOVE LOW-BAL-CYCLE (1) TO NAH-EARN-BALANCE           24678000
246790         WHEN NAH-AVG-COL-LESS-RESRV                              24679000
246800             MOVE AVG-COLL-BAL-CYC (1) TO NAH-EARN-BALANCE        24680000
246810         WHEN OTHER                                               24681000
246820             MOVE AVG-CURR-BAL-CYC (1) TO NAH-EARN-BALANCE        24682000
246830     END-EVALUATE.                                                24683000
246840     MOVE INT-PAID-YTD TO NAH-INT-PAID-YTD.                       24684000
246850     MOVE NOW-HDR-KEY TO NAH-SORT-KEY.                            24685000
246860     MOVE STMT-LOCATION-CODE TO NAH-STMT-LOC-CODE.                24686000
246870     MOVE PROC-CURR-DATE TO NAH-CURR-PROC-DT.                     24687000
246880     MOVE INT-PAID-PREV-YR TO NAH-INT-PAID-PR-YR.                 24688000
246890     MOVE LOW-BAL-CYCLE (1)    TO NAH-LOW-BALANCE.                24689000
246900     MOVE AVG-CURR-BAL-CYC (1) TO NAH-AVG-CUR-BALANCE.            24690000
246910     MOVE AVG-COLL-BAL-CYC (1) TO NAH-AVG-COL-BALANCE.            24691000
246920     MOVE NUM-CHECKS-ON-STMT   TO NAH-NUM-CHECKS.                 24692000
246930     MOVE AMT-CHECKS-ON-STMT   TO NAH-AMT-CHECKS.                 24693000
246940     MOVE ODB-PLAN TO NAH-ODB-PLAN.                               24694000
246950     IF ODB-CLOSED-DELETE                                         24695000
246960         MOVE SPACES TO NAH-ODB-PLAN.                             24696000
246970     MOVE SC-ROUTINE          TO NAH-SC-ROUTINE.                  24697000
246980     MOVE STATEMENT-IMAGE-IND TO NAH-STMT-IMAGE-IND.              24698000
246990     MOVE DEPOSITS-IMAGE-IND  TO NAH-DEP-IMAGE-IND.               24699000
247000     MOVE CUSTOM-IMAGE-TYPE   TO NAH-CUST-IMAGE-TYPE.             24700000
247010     MOVE IMAGES-PER-PAGE     TO NAH-IMAGES-PER-PAGE.             24701000
247020*    IF PRINT-12-PER-PAGE                                         24702000
247030*        MOVE 12 TO NAH-IMAGES-PER-PAGE.                          24703000
247040     EVALUATE CASH-MANAGEMENT-IND                                 24704000
247050         WHEN 'CMA'                                               24705000
247060             MOVE 'G' TO NAH-CMA-IND                              24706000
247070         WHEN 'IMM'                                               24707000
247080             MOVE 'I' TO NAH-CMA-IND                              24708000
247090         WHEN 'CCA'                                               24709000
247100             MOVE 'C' TO NAH-CMA-IND                              24710000
247110         WHEN 'CCM'                                               24711000
247120             MOVE 'M' TO NAH-CMA-IND                              24712000
247130         WHEN OTHER                                               24713000
247140             CONTINUE                                             24714000
247150     END-EVALUATE.                                                24715000
247160     MOVE ZEROS TO NAH-OA-LIMIT.                                  24716000
247170     IF OD-ACCESS-INDICATOR = ZERO                                24717000
247180         NEXT SENTENCE                                            24718000
247190       ELSE                                                       24719000
247200         IF OA-ACTIVE OR OA-ACTIVE-30-90 OR OA-ACTIVE-FIXED       24720000
247210             SET NAH-OD-ACCESS-ACCT TO TRUE                       24721000
247220             MOVE OD-ACCESS-LIMIT   TO NAH-OA-LIMIT               24722000
247230             IF STMT-CYCLE-CODE = 99                              24723000
247240                 MOVE ZEROS         TO NAH-NEXT-STMT-DATE         24724000
247250             ELSE                                                 24725000
247260                 MOVE STMT-CYCLE-CODE   TO SUB-CYCLE              24726000
247270                 MOVE DSDM020P-NEXT-CYC-DATE (SUB-CYCLE)          24727000
247280                                        TO NAH-NEXT-STMT-DATE     24728000
247290             END-IF                                               24729000
247300         END-IF                                                   24730000
247310     END-IF.                                                      24731000
247320     MOVE SAC-IND             TO NAH-SAC-IND.                     24732000
247330     MOVE HIST-NUM-POS-SC-DEB  (1) TO NAH-NUM-POS-SC-DEBITS.      24733000
247340     MOVE HIST-NUM-ACH-SC-CRED (1) TO NAH-NUM-ACH-SC-CREDITS.     24734000
247350     IF OSB-EMAIL-FAX                                             24735000
247360         MOVE 'Y'             TO NAH-ESTATEMENT                   24736000
247370     ELSE                                                         24737000
247380         MOVE 'N'             TO NAH-ESTATEMENT.                  24738000
247390     IF BCFSCR-FREE-INTEREST-CHECKING                             24739000
247400         MOVE 'Y'             TO NAH-FREE-INT-SW                  24740000
247410     ELSE                                                         24741000
247420         MOVE 'N'             TO NAH-FREE-INT-SW.                 24742000
247430     WRITE STMT-HDR FROM PD-NAH.                                  24743000
247440                                                                  24744000
247450 P8989-EXIT.                                                      24745000
247460     EXIT.                                                        24746000
247470                                                                  24747000
247480******************************************************************24748000
247490* B U I L D   I N V E S T M E N T   T R A I L E R   R E C O R D  *24749000
247500******************************************************************24750000
247510 P8990-BUILD-INV-TRLR.                                            24751000
247520     MOVE SPACES TO POSTED-WORK.                                  24752000
247530     MOVE BCF-BANK-NO TO IAT-BANK-NO.                             24753000
247540     MOVE ACCOUNT-ID TO IAT-ACCT-ID.                              24754000
247550     MOVE ACCOUNT-NUMBER TO IAT-ACCT-NO.                          24755000
247560     MOVE 994 TO IAT-REPORT-CODE.                                 24756000
247570     MOVE INV-GROSS-BAL-LAST-CYC TO IAT-GR-INV-BAL.               24757000
247580     MOVE HOLD-DAYS-IN-YEAR TO IAT-DAYS-IN-YEAR.                  24758000
247590     MOVE INV-ACCR-BASIS-IND TO IAT-ACCR-BASIS-IND.               24759000
247600     MOVE INV-TRLR-KEY TO IAT-SORT-KEY.                           24760000
247610     MOVE PROC-CURR-DATE TO IAT-CURR-PROC-DT.                     24761000
247620     MOVE INV-DAYS-INVEST-LAST-CYC TO IAT-DAYS-INVESTED.          24762000
247630     MOVE INV-INT-PAID-LAST-CYC TO IAT-INT-PAID-CYC.              24763000
247640     MOVE INV-INT-PAID-YTD TO IAT-INT-PAID-YTD.                   24764000
247650     MOVE INV-PEGGED-BAL TO IAT-PEGGED-BAL.                       24765000
247660     MOVE INV-BALANCE TO IAT-INV-BAL.                             24766000
247670     WRITE STMT-HDR FROM PD-IAT.                                  24767000
247680                                                                  24768000
247690 P8999-EXIT.                                                      24769000
247700     EXIT.                                                        24770000
247710                                                                  24771000
247720******************************************************************24772000
247730*  B U I L D   I N V E S T M E N T   H E A D E R   R E C O R D   *24773000
247740******************************************************************24774000
247750 P9000-BUILD-INV-HDR.                                             24775000
247760     MOVE SPACES TO POSTED-WORK.                                  24776000
247770     MOVE BCF-BANK-NO TO PDH-BANK-NO.                             24777000
247780     MOVE ACCOUNT-ID TO PDH-ACCT-ID.                              24778000
247790     MOVE ACCOUNT-NUMBER TO PDH-ACCT-NO.                          24779000
247800     MOVE HOLD-REPORT-CODE TO PDH-REPORT-CODE.                    24780000
247810     MOVE DTE-LAST-CYCLE-STMT TO PDH-LAST-STMT-DT.                24781000
247820     MOVE INV-BALANCE TO PDH-ENDING-BAL.                          24782000
247830     MOVE ZEROS TO PDH-NO-ENCLOSURES.                             24783000
247840     MOVE AMT-INV-MAT-ON-STMT TO PDH-DEBIT-AMOUNT.                24784000
247850     MOVE AMT-INV-PUR-ON-STMT TO PDH-CREDIT-AMOUNT.               24785000
247860     MOVE INV-HDR-KEY TO PDH-SORT-KEY.                            24786000
247870     MOVE PROC-CURR-DATE TO PDH-CURR-PROC-DT.                     24787000
247880     IF CYCLE-THIS-STMT = 1                                       24788000
247890         MOVE HOLD-PREV-INV-STMT-BAL TO PDH-STMT-BAL              24789000
247900       ELSE                                                       24790000
247910         MOVE INV-LAST-STMT-BAL TO PDH-STMT-BAL.                  24791000
247920     MOVE ACCOUNT-CLASS TO PDH-ACCT-CLASS.                        24792000
247930     MOVE INV-PLAN TO PDH-INV-PLAN.                               24793000
247940     MOVE INV-MATURE-DATE TO PDH-INV-MAT-DATE.                    24794000
247950     MOVE INV-RENEWAL-CODE TO PDH-INV-RENEW-CODE.                 24795000
247960     IF DDA-SEC-STMT                                              24796000
247970         MOVE HOLD-DDA-ACCT-ID-LINKED-TO-SEC TO                   24797000
247980             PDH-ACCT-ID-LINKED-TO-SEC                            24798000
247990         MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC TO                   24799000
248000             PDH-ACCT-NO-LINKED-TO-SEC                            24800000
248010       ELSE                                                       24801000
248020         MOVE ACCOUNT-ID TO PDH-ACCT-ID-LINKED-TO-SEC             24802000
248030         MOVE ACCOUNT-NUMBER TO PDH-ACCT-NO-LINKED-TO-SEC.        24803000
248040     MOVE STMT-CYCLE-CODE TO PDH-STMT-CYCLE-CODE.                 24804000
248050     MOVE STMT-DISP-CODE TO PDH-STMT-DISP.                        24805000
248060     MOVE ZEROS TO PDH-DATE-CLOSED.                               24806000
248070     WRITE STMT-HDR FROM PD-PDH.                                  24807000
248080     IF NOT PROC-MONTH-END                                        24808000
248090         GO TO P9009-EXIT.                                        24809000
248100     MOVE BCF-BANK-NO TO INV-STMT-BAL-BANK-NO.                    24810000
248110     MOVE ACCOUNT-NUMBER TO INV-STMT-BAL-ACCT-NO.                 24811000
248120     MOVE INV-BALANCE TO INV-STMT-BAL-INV-BAL.                    24812000
248130     MOVE PDH-STMT-BAL TO INV-STMT-BAL-STMT-BAL.                  24813000
248140     MOVE AMT-INV-PUR-ON-STMT TO INV-STMT-BAL-PUR.                24814000
248150     MOVE AMT-INV-MAT-ON-STMT TO INV-STMT-BAL-MAT.                24815000
248160     WRITE INV-STMT-BAL-REC.                                      24816000
248170     IF NOT VSAM-SUCCESSFUL                                       24817000
248180         DISPLAY 'WRITE ERROR - INV STMT BAL FILE' UPON CONSOLE   24818000
248190         CALL 'CDCDUMP' USING BY CONTENT '2111'.                  24819000
248200                                                                  24820000
248210 P9009-EXIT.                                                      24821000
248220     EXIT.                                                        24822000
248230                                                                  24823000
248240******************************************************************24824000
248250*B U I L D   A C C O U N T   R E C O N C I L I A T I O N   R E C *24825000
248260******************************************************************24826000
248270 P9010-BUILD-ACCT-RECON.                                          24827000
248280     MOVE DSDSTXL-BANK-NO TO AR-BANK-NO.                          24828000
248290     MOVE DSDSTXL-ACCT-NO TO AR-ACCT-NO.                          24829000
248300     MOVE DSDSTXL-CHK-NO TO AR-SERIAL-NO.                         24830000
248310     MOVE PROC-CURR-DATE TO AR-DATE-PD.                           24831000
248320     MOVE DSDSTXL-AMOUNT TO AR-CHK-AMT.                           24832000
248330     MOVE DSDSTXL-BAT-NO TO AR-BAT-NO.                            24833000
248340     MOVE DSDSTXL-SEQ-NO TO AR-SEQ-NO.                            24834000
248350     MOVE SPACE          TO AR-DISPOSITION.                       24835000
248360     MOVE SPACE          TO AR-ACH-CLASS.                         24836000
248370     IF DSDSTXL-CODE = 980                                        24837000
248380         IF DSDSTXL-ACH-STD-ENTRY-CLASS = 'RCK' OR 'POP' OR       24838000
248390                                          'ARC' OR 'BOC'          24839000
248400             MOVE DSDSTXL-ACH-STD-ENTRY-CLASS TO AR-ACH-CLASS     24840000
248410           ELSE                                                   24841000
248420             MOVE SPACES                      TO AR-ACH-CLASS.    24842000
248430     WRITE ACCT-RECONX FROM ACCT-RECON-WORK.                      24843000
248440                                                                  24844000
248450 P9014-EXIT.                                                      24845000
248460     EXIT.                                                        24846000
248470                                                                  24847000
248480 P9015-BUILD-AR-CYCLE.                                            24848000
248490     EVALUATE ARC-PROC-FREQ                                       24849000
248500         WHEN 'M'                                                 24850000
248510             IF STMT-CYCLE-CODE <= ZEROS                          24851000
248520                 DISPLAY 'CDCERROR - P9015 UNABLE TO UPDATE '     24852000
248530                         'MONTHLY AR CYCLE CONTROL FOR '          24853000
248540                         PROC-BK-NO ' ' ACCOUNT-NUMBER            24854000
248550                 GO TO P9019-EXIT                                 24855000
248560             END-IF                                               24856000
248570             IF 397-SW EQUAL 1 OR 2                               24857000
248580                 GO TO P9016-CONTINUE                             24858000
248590             END-IF                                               24859000
248600             IF STMT-CYCLE-CODE = +099                            24860000
248610                 GO TO P9019-EXIT                                 24861000
248620             END-IF                                               24862000
248630             IF PROC-CYCLE-CODE (STMT-CYCLE-CODE) = 'Y'           24863000
248640                 GO TO P9016-CONTINUE                             24864000
248650             END-IF                                               24865000
248660         WHEN 'W'                                                 24866000
248670             IF 397-SW EQUAL 1 OR 2                               24867000
248680                 GO TO P9016-CONTINUE                             24868000
248690             END-IF                                               24869000
248700             IF STMT-CYCLE-CODE = +099                            24870000
248710                 GO TO P9019-EXIT                                 24871000
248720             END-IF                                               24872000
248730             IF PROC-CYCLE-CODE (STMT-CYCLE-CODE) = 'Y'           24873000
248740                 GO TO P9016-CONTINUE                             24874000
248750             END-IF                                               24875000
248760         WHEN OTHER                                               24876000
248770             DISPLAY 'CDCERROR - INVALID AR PROC FREQUENCY '      24877000
248780             PROC-BK-NO ' ' ACCOUNT-NUMBER                        24878000
248790             GO TO P9019-EXIT                                     24879000
248800     END-EVALUATE                                                 24880000
248810     GO TO P9019-EXIT.                                            24881000
248820                                                                  24882000
248830 P9016-CONTINUE.                                                  24883000
248840     MOVE PROC-BK-NO     TO AR-BANK-NO.                           24884000
248850     MOVE ACCOUNT-NUMBER TO AR-ACCT-NO.                           24885000
248860     MOVE 999999999      TO AR-SERIAL-NO.                         24886000
248870     MOVE PROC-CURR-DATE TO AR-DATE-PD.                           24887000
248880     MOVE ZEROS          TO AR-CHK-AMT                            24888000
248890                            AR-BAT-NO                             24889000
248900                            AR-SEQ-NO.                            24890000
248910     MOVE SPACE          TO AR-DISPOSITION.                       24891000
248920     WRITE ACCT-RECONX FROM ACCT-RECON-WORK.                      24892000
248930     DISPLAY 'CDCINFO - WROTE ARCYCC UPDATE RECORD FOR '          24893000
248940             PROC-BK-NO ' ' ACCOUNT-NUMBER.                       24894000
248950                                                                  24895000
248960 P9019-EXIT.                                                      24896000
248970     EXIT.                                                        24897000
248980                                                                  24898000
248990                                                                  24899000
249000******************************************************************24900000
249010*B U I L D   O S B   S U M M A R Y   F I L E                     *24901000
249020******************************************************************24902000
249030 P9020-BUILD-OSB-SUMMARY.                                         24903000
249040     INITIALIZE OSB-SUMMARY-WORK.                                 24904000
249050     MOVE PROC-BK-NO TO SSR-BANK-NO.                              24905000
249060     MOVE ACCOUNT-ID TO SSR-ACCT-ID.                              24906000
249070     MOVE ACCOUNT-NUMBER TO SSR-OSB-NO                            24907000
249080                            SSR-ACCOUNT-NO.                       24908000
249090     MOVE STMT-CYCLE-CODE TO SSR-CYCLE-CODE.                      24909000
249100     IF ACCOUNT-ID = 001                                          24910000
249110         GO TO P9022-DDA-SUMMARY.                                 24911000
249120     IF ACCOUNT-ID = 004                                          24912000
249130         GO TO P9028-SAV-SUMMARY.                                 24913000
249140     GO TO P9029-EXIT.                                            24914000
249150                                                                  24915000
249160 P9022-DDA-SUMMARY.                                               24916000
249170     IF DDA-SEC-STMT                                              24917000
249180         MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC TO SSR-OSB-NO.       24918000
249190     MOVE '010' TO SSR-ACCT-TYPE.                                 24919000
249200     EVALUATE TRUE                                                24920000
249210         WHEN DDA-ACCOUNT                                         24921000
249220             MOVE '005' TO SSR-ACCT-CLASS                         24922000
249230         WHEN NOW-ACCOUNT                                         24923000
249240             MOVE '010' TO SSR-ACCT-CLASS                         24924000
249250         WHEN CMM-ACCOUNT                                         24925000
249260             MOVE '015' TO SSR-ACCT-CLASS                         24926000
249270         WHEN IMA-ACCOUNT                                         24927000
249280             MOVE '020' TO SSR-ACCT-CLASS                         24928000
249290         WHEN IMP-ACCOUNT                                         24929000
249300             MOVE '030' TO SSR-ACCT-CLASS                         24930000
249310         WHEN IMT-ACCOUNT                                         24931000
249320             MOVE '035' TO SSR-ACCT-CLASS                         24932000
249330         WHEN IML-ACCOUNT                                         24933000
249340             MOVE '040' TO SSR-ACCT-CLASS                         24934000
249350         WHEN IMM-ACCOUNT                                         24935000
249360             MOVE '025' TO SSR-ACCT-CLASS                         24936000
249370         WHEN OTHER                                               24937000
249380             MOVE '005' TO SSR-ACCT-CLASS                         24938000
249390     END-EVALUATE.                                                24939000
249400     EVALUATE CASH-MANAGEMENT-IND                                 24940000
249410         WHEN 'CMA'                                               24941000
249420             MOVE '045' TO SSR-ACCT-CLASS                         24942000
249430         WHEN 'IMM'                                               24943000
249440             MOVE '046' TO SSR-ACCT-CLASS                         24944000
249450         WHEN 'CCA'                                               24945000
249460             MOVE '047' TO SSR-ACCT-CLASS                         24946000
249470         WHEN 'CCM'                                               24947000
249480             MOVE '048' TO SSR-ACCT-CLASS                         24948000
249490         WHEN OTHER                                               24949000
249500             CONTINUE                                             24950000
249510     END-EVALUATE.                                                24951000
249520     IF CESA-ACCT OR HSA-ACCT                                     24952000
249530         PERFORM P9130-GET-SAC-SSN   THRU P9139-EXIT              24953000
249540         PERFORM P9200-GET-CUST-NAME THRU P9299-EXIT              24954000
249550         MOVE U021-CUST-TAX-ID TO SSR-SSN                         24955000
249560         PERFORM P8560-GET-DDA-LINKED-TO-SEC THRU P8569-EXIT      24956000
249570         IF DDA-OSB-STMT OR (DDA-SEC-STMT AND                     24957000
249580                HOLD-DDA-ACCT-NO-LINKED-TO-SEC = DSDS-ACCOUNT-NO) 24958000
249590             MOVE '010' TO SSR-ACCT-TYPE                          24959000
249600             IF HSA-ACCT                                          24960000
249610                 MOVE '049' TO SSR-ACCT-CLASS                     24961000
249620             END-IF                                               24962000
249630             IF CESA-ACCT                                         24963000
249640                 MOVE '050' TO SSR-ACCT-CLASS                     24964000
249650             END-IF                                               24965000
249660             MOVE 'I' TO SSR-STATEMENT-TYPE                       24966000
249670             IF CYCLE-THIS-STMT = 0                               24967000
249680                 MOVE 'D' TO SSR-STATEMENT-TYPE                   24968000
249690             ELSE                                                 24969000
249700                 IF STMT-WITH-CHECKS                              24970000
249710                     MOVE 'C' TO SSR-STATEMENT-TYPE               24971000
249720                     IF DROP-FILE-STMT                            24972000
249730                         MOVE 'D' TO SSR-STATEMENT-TYPE           24973000
249740                     END-IF                                       24974000
249750                 END-IF                                           24975000
249760             END-IF                                               24976000
249770             WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK              24977000
249780         END-IF                                                   24978000
249790                                                                  24979000
249800         IF HSA-ACCT                                              24980000
249810             MOVE '049' TO SSR-ACCT-CLASS                         24981000
249820             MOVE '052' TO SSR-ACCT-TYPE                          24982000
249830             MOVE 009   TO SSR-CONTRACT-TYPE                      24983000
249840         END-IF                                                   24984000
249850         IF CESA-ACCT                                             24985000
249860             MOVE '050' TO SSR-ACCT-CLASS                         24986000
249870             MOVE '054' TO SSR-ACCT-TYPE                          24987000
249880             MOVE 010   TO SSR-CONTRACT-TYPE                      24988000
249890         END-IF                                                   24989000
249900         PERFORM P9190-IRA-OSB-STMT-SUMMARY THRU P9199-EXIT       24990000
249910     END-IF.                                                      24991000
249920                                                                  24992000
249930     IF BCFSCR-PREPAID-CARD                                       24993000
249940         MOVE '070'     TO SSR-ACCT-CLASS                         24994000
249950     END-IF.                                                      24995000
249960                                                                  24996000
249970     MOVE CURRENT-BALANCE TO SSR-BALANCE.                         24997000
249980     MOVE 'I' TO SSR-STATEMENT-TYPE.                              24998000
249990     IF CYCLE-THIS-STMT = 0                                       24999000
250000         MOVE 'D' TO SSR-STATEMENT-TYPE                           25000000
250010       ELSE                                                       25001000
250020         IF STMT-WITH-CHECKS                                      25002000
250030             MOVE 'C' TO SSR-STATEMENT-TYPE                       25003000
250040             IF DROP-FILE-STMT                                    25004000
250050                 MOVE 'D' TO SSR-STATEMENT-TYPE.                  25005000
250060     WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK.                     25006000
250070                                                                  25007000
250080 P9024-RP-SUMMARY.                                                25008000
250090     IF INV-PLAN = SPACES OR 'IC'                                 25009000
250100         GO TO P9026-ODB-SUMMARY.                                 25010000
250110     IF INV-CLOSED                                                25011000
250120         GO TO P9026-ODB-SUMMARY.                                 25012000
250130     MOVE '070' TO SSR-ACCT-TYPE.                                 25013000
250140     EVALUATE TRUE                                                25014000
250150         WHEN REPURCHASE                                          25015000
250160             MOVE '200' TO SSR-ACCT-CLASS                         25016000
250170         WHEN TAX-EXEMPT-FUND                                     25017000
250180             MOVE '210' TO SSR-ACCT-CLASS                         25018000
250190         WHEN TREASURY-FUND                                       25019000
250200             MOVE '220' TO SSR-ACCT-CLASS                         25020000
250210         WHEN FED-FUNDS                                           25021000
250220             MOVE '230' TO SSR-ACCT-CLASS                         25022000
250230         WHEN TERM-REPO                                           25023000
250240             MOVE '240' TO SSR-ACCT-CLASS                         25024000
250250         WHEN CASH-MGMT-TRUST-FUND                                25025000
250260             MOVE '250' TO SSR-ACCT-CLASS                         25026000
250270         WHEN OTHER                                               25027000
250280             MOVE '200' TO SSR-ACCT-CLASS                         25028000
250290     END-EVALUATE.                                                25029000
250300     MOVE INV-BALANCE TO SSR-BALANCE.                             25030000
250310     WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK.                     25031000
250320                                                                  25032000
250330 P9026-ODB-SUMMARY.                                               25033000
250340     IF ODB-PLAN = SPACES                                         25034000
250350         GO TO P9027-IAP-SUMMARY.                                 25035000
250360     IF ODB-CLOSED-DELETE                                         25036000
250370         GO TO P9027-IAP-SUMMARY.                                 25037000
250380     MOVE '120' TO SSR-ACCT-TYPE.                                 25038000
250390     MOVE SPACES TO SSR-ACCT-CLASS.                               25039000
250400     MOVE ODB-LOAN-BAL TO SSR-BALANCE.                            25040000
250410     MOVE AUTH-CREDIT-LIMIT TO SSR-ODB-CREDIT-LIMIT.              25041000
250420     WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK.                     25042000
250430                                                                  25043000
250440 P9027-IAP-SUMMARY.                                               25044000
250450     IF MASTER-PAC-ACCOUNT                                        25045000
250460         NEXT SENTENCE                                            25046000
250470     ELSE                                                         25047000
250480         GO TO P9029-EXIT.                                        25048000
250490     MOVE '010' TO SSR-ACCT-TYPE.                                 25049000
250500     MOVE '060' TO SSR-ACCT-CLASS.                                25050000
250510     MOVE CASH-MANAGEMENT-BAL-IN-IMMA TO SSR-BALANCE.             25051000
250520     WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK.                     25052000
250530     GO TO P9029-EXIT.                                            25053000
250540                                                                  25054000
250550 P9028-SAV-SUMMARY.                                               25055000
250560     MOVE HOLD-OSH-DDA-ACCT-ID TO SSR-ACCT-ID.                    25056000
250570     MOVE HOLD-OSH-DDA-ACCT-NO TO SSR-OSB-NO.                     25057000
250580     MOVE '020' TO SSR-ACCT-TYPE.                                 25058000
250590     MOVE SPACES TO SSR-ACCT-CLASS.                               25059000
250600     MOVE CURRENT-BALANCE TO SSR-BALANCE.                         25060000
250610     WRITE OSB-SUMMARY FROM OSB-SUMMARY-WORK.                     25061000
250620                                                                  25062000
250630 P9029-EXIT.                                                      25063000
250640     EXIT.                                                        25064000
250650                                                                  25065000
250660 P9030-CHK-CMA.                                                   25066000
250670* THIS CHECK IS FOR CASH MANAGEMENT ACCOUNTS                      25067000
250680     MOVE SPACE TO CASH-MANAGEMENT-IND.                           25068000
250690     EVALUATE TRUE                                                25069000
250700         WHEN SC-ROUTINE = 39                                     25070000
250710             MOVE 'CMA' TO CASH-MANAGEMENT-IND                    25071000
250720             GO TO P9039-EXIT                                     25072000
250730         WHEN SC-ROUTINE = 40                                     25073000
250740             IF PERSONAL                                          25074000
250750                 MOVE 'IMM' TO CASH-MANAGEMENT-IND                25075000
250760               ELSE                                               25076000
250770                 MOVE 'CCM' TO CASH-MANAGEMENT-IND                25077000
250780             END-IF                                               25078000
250790             GO TO P9039-EXIT                                     25079000
250800         WHEN OTHER                                               25080000
250810             CONTINUE                                             25081000
250820     END-EVALUATE.                                                25082000
250830     IF CASH-MANAGEMENT-SWEEP                                     25083000
250840         MOVE 'CCA' TO CASH-MANAGEMENT-IND.                       25084000
250850                                                                  25085000
250860 P9039-EXIT.                                                      25086000
250870     EXIT.                                                        25087000
250880                                                                  25088000
250890 P9040-UPDATE-ARCUST.                                             25089000
250900     IF NO-ACCT-RECON                                             25090000
250910         GO TO P9049-EXIT                                         25091000
250920     END-IF.                                                      25092000
250930                                                                  25093000
250940     MOVE DSDS-BANK-NO            TO ARC-BANK.                    25094000
250950     MOVE DSDS-ACCOUNT-NO         TO ARC-ACCT.                    25095000
250960     MOVE NUM-CHECKS-ON-STMT      TO ARC-STMT-NUM-CHK.            25096000
250970     MOVE AMT-CHECKS-ON-STMT      TO ARC-STMT-AMT-CHK.            25097000
250980     CALL 'CDCDT48' USING PROC-CURR-DATE                          25098000
250990                          ARC-STMT-DATE.                          25099000
251000     EXEC SQL                                                     25100000
251010         UPDATE AR.CUSTOMER SET                                   25101000
251020     ARC_STMT_NUM_CHK  = :ARC-STMT-NUM-CHK,                       25102000
251030     ARC_STMT_AMT_CHK  = :ARC-STMT-AMT-CHK,                       25103000
251040     ARC_STMT_DATE     = :ARC-STMT-DATE                           25104000
251050         WHERE ARC_BANK          = :ARC-BANK                      25105000
251060           AND ARC_ACCT          = :ARC-ACCT                      25106000
251070     END-EXEC.                                                    25107000
251080     EVALUATE SQLCODE                                             25108000
251090         WHEN ZEROS                                               25109000
251100             CONTINUE                                             25110000
251110         WHEN OTHER                                               25111000
251120             CALL 'CDCUT90' USING SQLCA                           25112000
251130             CALL 'CDCDUMP' USING BY CONTENT '2112'               25113000
251140     END-EVALUATE.                                                25114000
251150 P9049-EXIT.                                                      25115000
251160     EXIT.                                                        25116000
251170                                                                  25117000
251180 P9050-DELETE-DSD-FINQHOLD.                                       25118000
251190     EXEC SQL                                                     25119000
251200         DECLARE HOLD_CURSOR CURSOR WITH HOLD FOR                 25120000
251210         SELECT                                                   25121000
251220             HOLD_BANK_NBR,                                       25122000
251230             HOLD_ACCT_ID,                                        25123000
251240             HOLD_ACCT_NBR,                                       25124000
251250             HOLD_TYPE,                                           25125000
251260             HOLD_SOURCE_USER,                                    25126000
251270             HOLD_SOURCE_PROG,                                    25127000
251280             HOLD_PLACE_DATE,                                     25128000
251290             HOLD_RELEASE_DATE,                                   25129000
251300             HOLD_AMOUNT,                                         25130000
251310             HOLD_CHECK_NBR,                                      25131000
251320             HOLD_LAST_UPDATE,                                    25132000
251330             HOLD_TX_DESC,                                        25133000
251340             HOLD_LST_4_DIGITS                                    25134000
251350         FROM FINQ.HOLD                                           25135000
251360         WHERE HOLD_BANK_NBR    = :HOLD-BANK-NBR AND              25136000
251370               HOLD_ACCT_ID     = 001 AND                         25137000
251380               HOLD_PLACE_DATE  = :HOLD-PLACE-DATE AND            25138000
251390               HOLD_SOURCE_PROG = 'DSDS100'                       25139000
251400     END-EXEC.                                                    25140000
251410                                                                  25141000
251420     EXEC SQL                                                     25142000
251430         OPEN HOLD_CURSOR                                         25143000
251440     END-EXEC.                                                    25144000
251450     EVALUATE SQLCODE                                             25145000
251460         WHEN ZEROS                                               25146000
251470             CONTINUE                                             25147000
251480         WHEN OTHER                                               25148000
251490             CALL 'CDCUT90' USING SQLCA                           25149000
251500             CALL 'CDCDUMP' USING BY CONTENT '2113'               25150000
251510     END-EVALUATE.                                                25151000
251520                                                                  25152000
251530 P9051-FETCH-DSD-FINQHOLD.                                        25153000
251540     EXEC SQL                                                     25154000
251550         FETCH HOLD_CURSOR INTO                                   25155000
251560            :HOLD-BANK-NBR,                                       25156000
251570            :HOLD-ACCT-ID,                                        25157000
251580            :HOLD-ACCT-NBR,                                       25158000
251590            :HOLD-TYPE,                                           25159000
251600            :HOLD-SOURCE-USER,                                    25160000
251610            :HOLD-SOURCE-PROG,                                    25161000
251620            :HOLD-PLACE-DATE,                                     25162000
251630            :HOLD-RELEASE-DATE,                                   25163000
251640            :HOLD-AMOUNT,                                         25164000
251650            :HOLD-CHECK-NBR,                                      25165000
251660            :HOLD-LAST-UPDATE,                                    25166000
251670            :HOLD-TX-DESC,                                        25167000
251680            :HOLD-LST-4-DIGITS                                    25168000
251690     END-EXEC.                                                    25169000
251700     EVALUATE SQLCODE                                             25170000
251710         WHEN ZEROS                                               25171000
251720             CONTINUE                                             25172000
251730         WHEN +100                                                25173000
251740             GO TO P9059-CLOSE-DSD-FINQHOLD                       25174000
251750         WHEN OTHER                                               25175000
251760             CALL 'CDCUT90' USING SQLCA                           25176000
251770             CALL 'CDCDUMP' USING BY CONTENT '2114'               25177000
251780     END-EVALUATE.                                                25178000
251790                                                                  25179000
251800     EXEC SQL                                                     25180000
251810         DELETE FROM FINQ.HOLD                                    25181000
251820         WHERE CURRENT OF HOLD_CURSOR                             25182000
251830     END-EXEC.                                                    25183000
251840     EVALUATE SQLCODE                                             25184000
251850         WHEN ZEROS                                               25185000
251860             CONTINUE                                             25186000
251870         WHEN OTHER                                               25187000
251880             CALL 'CDCUT90' USING SQLCA                           25188000
251890             CALL 'CDCDUMP' USING BY CONTENT '2115'               25189000
251900     END-EVALUATE.                                                25190000
251910                                                                  25191000
251920     CALL 'CDCUT06'.                                              25192000
251930                                                                  25193000
251940     ADD 1 TO DELETE-COUNT.                                       25194000
251950                                                                  25195000
251960     GO TO P9051-FETCH-DSD-FINQHOLD.                              25196000
251970                                                                  25197000
251980 P9059-CLOSE-DSD-FINQHOLD.                                        25198000
251990     EXEC SQL                                                     25199000
252000         COMMIT WORK                                              25200000
252010     END-EXEC.                                                    25201000
252020     IF SQLCODE NOT EQUAL ZERO                                    25202000
252030         CALL 'CDCUT90' USING SQLCA                               25203000
252040         CALL 'CDCDUMP' USING BY CONTENT '2116'.                  25204000
252050                                                                  25205000
252060     EXEC SQL                                                     25206000
252070         CLOSE HOLD_CURSOR                                        25207000
252080     END-EXEC.                                                    25208000
252090     EVALUATE SQLCODE                                             25209000
252100         WHEN ZEROS                                               25210000
252110             CONTINUE                                             25211000
252120         WHEN OTHER                                               25212000
252130             CALL 'CDCUT90' USING SQLCA                           25213000
252140             CALL 'CDCDUMP' USING BY CONTENT '2117'               25214000
252150     END-EVALUATE.                                                25215000
252160 P9059-EXIT.                                                      25216000
252170     EXIT.                                                        25217000
252180                                                                  25218000
252190 P9060-DELETE-DSS-FINQHOLD.                                       25219000
252200     EXEC SQL                                                     25220000
252210         DECLARE HOLD_CURSOR2 CURSOR WITH HOLD FOR                25221000
252220         SELECT                                                   25222000
252230             HOLD_BANK_NBR,                                       25223000
252240             HOLD_ACCT_ID,                                        25224000
252250             HOLD_ACCT_NBR,                                       25225000
252260             HOLD_TYPE,                                           25226000
252270             HOLD_SOURCE_USER,                                    25227000
252280             HOLD_SOURCE_PROG,                                    25228000
252290             HOLD_PLACE_DATE,                                     25229000
252300             HOLD_RELEASE_DATE,                                   25230000
252310             HOLD_AMOUNT,                                         25231000
252320             HOLD_CHECK_NBR,                                      25232000
252330             HOLD_LAST_UPDATE,                                    25233000
252340             HOLD_TX_DESC,                                        25234000
252350             HOLD_LST_4_DIGITS                                    25235000
252360         FROM FINQ.HOLD                                           25236000
252370         WHERE HOLD_BANK_NBR    = :HOLD-BANK-NBR AND              25237000
252380               HOLD_ACCT_ID     > 001 AND                         25238000
252390               HOLD_PLACE_DATE  = :HOLD-PLACE-DATE AND            25239000
252400               HOLD_SOURCE_PROG = 'DSDS100'                       25240000
252410     END-EXEC.                                                    25241000
252420                                                                  25242000
252430     EXEC SQL                                                     25243000
252440         OPEN HOLD_CURSOR2                                        25244000
252450     END-EXEC.                                                    25245000
252460     EVALUATE SQLCODE                                             25246000
252470         WHEN ZEROS                                               25247000
252480             CONTINUE                                             25248000
252490         WHEN OTHER                                               25249000
252500             CALL 'CDCUT90' USING SQLCA                           25250000
252510             CALL 'CDCDUMP' USING BY CONTENT '2118'               25251000
252520     END-EVALUATE.                                                25252000
252530                                                                  25253000
252540 P9061-FETCH-DSS-FINQHOLD.                                        25254000
252550     EXEC SQL                                                     25255000
252560         FETCH HOLD_CURSOR2 INTO                                  25256000
252570            :HOLD-BANK-NBR,                                       25257000
252580            :HOLD-ACCT-ID,                                        25258000
252590            :HOLD-ACCT-NBR,                                       25259000
252600            :HOLD-TYPE,                                           25260000
252610            :HOLD-SOURCE-USER,                                    25261000
252620            :HOLD-SOURCE-PROG,                                    25262000
252630            :HOLD-PLACE-DATE,                                     25263000
252640            :HOLD-RELEASE-DATE,                                   25264000
252650            :HOLD-AMOUNT,                                         25265000
252660            :HOLD-CHECK-NBR,                                      25266000
252670            :HOLD-LAST-UPDATE,                                    25267000
252680            :HOLD-TX-DESC,                                        25268000
252690            :HOLD-LST-4-DIGITS                                    25269000
252700     END-EXEC.                                                    25270000
252710     EVALUATE SQLCODE                                             25271000
252720         WHEN ZEROS                                               25272000
252730             CONTINUE                                             25273000
252740         WHEN +100                                                25274000
252750             GO TO P9069-CLOSE-DSS-FINQHOLD                       25275000
252760         WHEN OTHER                                               25276000
252770             CALL 'CDCUT90' USING SQLCA                           25277000
252780             CALL 'CDCDUMP' USING BY CONTENT '2119'               25278000
252790     END-EVALUATE.                                                25279000
252800                                                                  25280000
252810     EXEC SQL                                                     25281000
252820         DELETE FROM FINQ.HOLD                                    25282000
252830         WHERE CURRENT OF HOLD_CURSOR2                            25283000
252840     END-EXEC.                                                    25284000
252850     EVALUATE SQLCODE                                             25285000
252860         WHEN ZEROS                                               25286000
252870             CONTINUE                                             25287000
252880         WHEN OTHER                                               25288000
252890             CALL 'CDCUT90' USING SQLCA                           25289000
252900             CALL 'CDCDUMP' USING BY CONTENT '2120'               25290000
252910     END-EVALUATE.                                                25291000
252920                                                                  25292000
252930     CALL 'CDCUT06'.                                              25293000
252940                                                                  25294000
252950     ADD 1 TO DELETE-COUNT.                                       25295000
252960                                                                  25296000
252970     GO TO P9061-FETCH-DSS-FINQHOLD.                              25297000
252980                                                                  25298000
252990 P9069-CLOSE-DSS-FINQHOLD.                                        25299000
253000     EXEC SQL                                                     25300000
253010         COMMIT WORK                                              25301000
253020     END-EXEC.                                                    25302000
253030     IF SQLCODE NOT EQUAL ZERO                                    25303000
253040         CALL 'CDCUT90' USING SQLCA                               25304000
253050         CALL 'CDCDUMP' USING BY CONTENT '2121'.                  25305000
253060                                                                  25306000
253070     EXEC SQL                                                     25307000
253080         CLOSE HOLD_CURSOR2                                       25308000
253090     END-EXEC.                                                    25309000
253100     EVALUATE SQLCODE                                             25310000
253110         WHEN ZEROS                                               25311000
253120             CONTINUE                                             25312000
253130         WHEN OTHER                                               25313000
253140             CALL 'CDCUT90' USING SQLCA                           25314000
253150             CALL 'CDCDUMP' USING BY CONTENT '2122'               25315000
253160     END-EVALUATE.                                                25316000
253170 P9069-EXIT.                                                      25317000
253180     EXIT.                                                        25318000
253190                                                                  25319000
253200 P9070-DELETE-DSS-FINQDEP.                                        25320000
253210     MOVE PROC-BK-NO     TO DEP-BANK-NBR.                         25321000
253220     MOVE PROC-CURR-DATE TO DEP-PLACE-DATE.                       25322000
253230     EXEC SQL                                                     25323000
253240         DELETE FROM FINQ.DEPOSIT                                 25324000
253250         WHERE DEP_BANK_NBR     = :DEP-BANK-NBR AND               25325000
253260               DEP_PLACE_DATE   = :DEP-PLACE-DATE AND             25326000
253270               DEP_SOURCE_PROG = 'DSDS100C'                       25327000
253280     END-EXEC.                                                    25328000
253290     EVALUATE SQLCODE                                             25329000
253300         WHEN ZEROS                                               25330000
253310             CONTINUE                                             25331000
253320         WHEN +100                                                25332000
253330             DISPLAY 'NO FINQ.DEPOSIT RECORDS TO DELETE'          25333000
253340                                                  UPON CONSOLE    25334000
253350         WHEN OTHER                                               25335000
253360             CALL 'CDCUT90' USING SQLCA                           25336000
253370             CALL 'CDCDUMP' USING BY CONTENT '2123'               25337000
253380     END-EVALUATE.                                                25338000
253390                                                                  25339000
253400     EXEC SQL                                                     25340000
253410         COMMIT WORK                                              25341000
253420     END-EXEC.                                                    25342000
253430     IF SQLCODE NOT EQUAL ZERO                                    25343000
253440         CALL 'CDCUT90' USING SQLCA                               25344000
253450         CALL 'CDCDUMP' USING BY CONTENT '2124'.                  25345000
253460 P9079-EXIT.                                                      25346000
253470     EXIT.                                                        25347000
253480                                                                  25348000
253490 P9080-DELETE-DSS-DSDSPEND.                                       25349000
253500     MOVE PROC-BK-NO TO PEND-BANK-NBR.                            25350000
253510     MOVE PROC-NEXT-DATE TO PEND-EFFECT-DATE.                     25351000
253520     EXEC SQL                                                     25352000
253530         DELETE FROM DSDS.PEND                                    25353000
253540         WHERE PEND_BANK_NBR = :PEND-BANK-NBR                     25354000
253550           AND PEND_EFFECT_DATE = :PEND-EFFECT-DATE               25355000
253560           AND PEND_SOURCE_PROG = 'DSDS100C'                      25356000
253570     END-EXEC.                                                    25357000
253580     EVALUATE SQLCODE                                             25358000
253590         WHEN ZEROS                                               25359000
253600             CONTINUE                                             25360000
253610         WHEN +100                                                25361000
253620             DISPLAY 'NO PENDING TXS TO DELETE' UPON CONSOLE      25362000
253630         WHEN OTHER                                               25363000
253640             DISPLAY 'PEND DELETE DID NOT WORK' UPON CONSOLE      25364000
253650             CALL 'CDCUT90' USING SQLCA                           25365000
253660             CALL 'CDCDUMP' USING BY CONTENT '2125'               25366000
253670     END-EVALUATE.                                                25367000
253680 P9089-EXIT.                                                      25368000
253690     EXIT.                                                        25369000
253700                                                                  25370000
253710 P9090-SELECT-SPECSTMT.                                           25371000
253720     MOVE DSDS-BANK-NO       TO STMT-BANK-NBR.                    25372000
253730     MOVE DSDS-ACCOUNT-NO    TO STMT-ACCT-NBR.                    25373000
253740     CALL 'CDCDT48' USING PROC-CURR-DATE                          25374000
253750                          WORK-DB2-DATE.                          25375000
253760     EXEC SQL                                                     25376000
253770         SELECT                                                   25377000
253780             STMT_NEXT_PROCESS                                    25378000
253790         INTO                                                     25379000
253800            :STMT-NEXT-PROCESS                                    25380000
253810         FROM DSDS.SPECSTMT                                       25381000
253820         WHERE STMT_BANK_NBR     = :STMT-BANK-NBR                 25382000
253830           AND STMT_ACCT_NBR     = :STMT-ACCT-NBR                 25383000
253840           AND STMT_NEXT_PROCESS > :WORK-DB2-DATE                 25384000
253850         ORDER BY STMT_NEXT_PROCESS                               25385000
253860         FETCH FIRST 1 ROW ONLY                                   25386000
253870     END-EXEC.                                                    25387000
253880     EVALUATE SQLCODE                                             25388000
253890         WHEN ZEROS                                               25389000
253900             CALL 'CDCDT46' USING STMT-NEXT-PROCESS               25390000
253910                                  WORK-JUL-NXT-PROCESS            25391000
253920             CONTINUE                                             25392000
253930         WHEN +100                                                25393000
253940**** ADVANCE CURRENT DATE 30 DAYS AND DISPLAY CDCERROR            25394000
253950             MOVE 30           TO NUM-DAYS                        25395000
253960             CALL 'CDCDT15' USING PROC-CURR-DATE                  25396000
253970                                  NUM-DAYS                        25397000
253980                                  WORK-JUL-NXT-PROCESS            25398000
253990             DISPLAY 'CDCERROR (DSDS100) CYCLE CODE 99 - ACCOUNT '25399000
254000                    'NOT ON DSDS.SPECSTMT '                       25400000
254010                    DSDS-BANK-NO ' * ' DSDS-ACCOUNT-NO ' * '      25401000
254020                    WORK-JUL-NXT-PROCESS                          25402000
254030         WHEN OTHER                                               25403000
254040             CALL 'CDCUT90' USING SQLCA                           25404000
254050             CALL 'CDCDUMP' USING BY CONTENT '2126'               25405000
254060     END-EVALUATE.                                                25406000
254070 P9099-EXIT.                                                      25407000
254080     EXIT.                                                        25408000
254090                                                                  25409000
254100 P9100-ESCHEAT-SUSPECTS.                                          25410000
254110     IF PROC-MONTH-END                                            25411000
254120       AND TDY-MO = MONTH-ESCHEAT-SUSPECT                         25412000
254130         CONTINUE                                                 25413000
254140       ELSE                                                       25414000
254150         GO TO P9109-EXIT.                                        25415000
254160                                                                  25416000
254170     IF DORMANT OR DORMANT-DECEASED                               25417000
254180         CONTINUE                                                 25418000
254190       ELSE                                                       25419000
254200         GO TO P9109-EXIT.                                        25420000
254210                                                                  25421000
254220     IF STMT-CYCLE-CODE = 46                                      25422000
254230         GO TO P9109-EXIT.                                        25423000
254240                                                                  25424000
254250     MOVE ZEROS TO NUM-OF-YEARS                                   25425000
254260     COMPUTE BEGINNING-ESCHEAT-DATE = PROC-MONTH-END-DATE -       25426000
254270                                     (NO-YEARS-ESCHEAT * 1000).   25427000
254280     IF LOST-CONTACT-DATE GREATER THAN DATE-LAST-CUST-ACT         25428000
254290         MOVE LOST-CONTACT-DATE TO ESCHEAT-WORK-DATE              25429000
254300       ELSE                                                       25430000
254310         MOVE DATE-LAST-CUST-ACT TO ESCHEAT-WORK-DATE             25431000
254320     END-IF                                                       25432000
254330                                                                  25433000
254340     IF ESCHEAT-WORK-DATE GREATER THAN BEGINNING-ESCHEAT-DATE     25434000
254350         GO TO P9109-EXIT.                                        25435000
254360                                                                  25436000
254370     MOVE STAT-2X TO HOLD-OLD-STAT-2X.                            25437000
254380     MOVE 081     TO STATUS-CODE.                                 25438000
254390     MOVE '08'    TO HOLD-NEW-STAT-2X.                            25439000
254400                                                                  25440000
254410     MOVE SC-DISP TO HOLD-OLD-SC-DISP.                            25441000
254420     MOVE 0       TO SC-DISP.                                     25442000
254430     MOVE 0       TO HOLD-NEW-SC-DISP.                            25443000
254440                                                                  25444000
254450     MOVE 'Y'     TO HOLD-EXTRACT-IND.                            25445000
254460                                                                  25446000
254470     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE.                 25447000
254480     PERFORM P8481-STATUS-CODE-CHANGE  THRU P8481-EXIT.           25448000
254490     PERFORM P8494-SC-DISP-CODE-CHANGE THRU P8494-EXIT.           25449000
254500     PERFORM P7960-BUILD-ESCHEAT THRU P7969-EXIT                  25450000
254510     PERFORM P7110-BUILD-DORM-INACTIVE THRU P7119-EXIT.           25451000
254520 P9109-EXIT.                                                      25452000
254530     EXIT.                                                        25453000
254540                                                                  25454000
254550 P9110-ESCHEAT-PROCESSING.                                        25455000
254560     IF CURRENT-BALANCE NOT GREATER THAN ZERO                     25456000
254570         GO TO P9119-EXIT.                                        25457000
254580     MOVE STAT-2X TO HOLD-OLD-STAT-2X.                            25458000
254590     MOVE 091 TO STATUS-CODE.                                     25459000
254600     MOVE '09'    TO HOLD-NEW-STAT-2X.                            25460000
254610     MOVE STMT-DISP-CODE TO HOLD-OLD-STMT-DISP-CODE.              25461000
254620     IF PROC-DSD                                                  25462000
254630         MOVE 'C' TO SPEC-REPORT-ID                               25463000
254640       ELSE                                                       25464000
254650         IF SAV-ACCOUNT                                           25465000
254660             MOVE 'S' TO SPEC-REPORT-ID.                          25466000
254670     MOVE 'A'            TO STMT-DISP-CODE                        25467000
254680                            HOLD-NEW-STMT-DISP-CODE.              25468000
254690     MOVE PROC-CURR-DATE TO DSDS-LAST-MAINT-DATE                  25469000
254700                            DATE-CLOSED.                          25470000
254710     MOVE 1 TO DSDSTXL-PENDING-SW.                                25471000
254720     PERFORM P8200-TX-INIT-1 THRU P8209-EXIT.                     25472000
254730     MOVE 874 TO DSDSTXL-CODE.                                    25473000
254740     MOVE OSB-DESC-0091-A TO DSDSTXL-CO-DESC.                     25474000
254750     MOVE OSB-DESC-0091-B TO DSDSTXL-DESC.                        25475000
254760     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                25476000
254770     MOVE PROC-CURR-DATE TO DSDSTXL-CHK-NO.                       25477000
254780     MOVE 'ESC' TO PJ-HOLD-CODE.                                  25478000
254790     MOVE CURRENT-BALANCE TO DSDSTXL-AMOUNT.                      25479000
254800     ADD CURRENT-BALANCE TO ESCHEAT-BALANCE                       25480000
254810                            GEN-DEBIT-AMT.                        25481000
254820     ADD 1 TO GEN-DEBIT-CNT.                                      25482000
254830     ADD 1 TO NUM-BILL-TX.                                        25483000
254840     PERFORM P7960-BUILD-ESCHEAT THRU P7969-EXIT.                 25484000
254850     PERFORM P1665-NORM-DEBIT.                                    25485000
254860     PERFORM P0400-READ-TOTAL-TX THRU P0439-EXIT.                 25486000
254870     MOVE 'N' TO HOLD-EXTRACT-IND.                                25487000
254880     PERFORM P8488-STMT-DISP-CODE-CHANGE THRU P8488-EXIT.         25488000
254890     PERFORM P8481-STATUS-CODE-CHANGE THRU P8481-EXIT.            25489000
254900 P9119-EXIT.                                                      25490000
254910     EXIT.                                                        25491000
254920                                                                  25492000
254930 P9120-CHECK-SAC-ACCT.                                            25493000
254940     IF STAT-2X = '09'                                            25494000
254950         GO TO P9129-EXIT                                         25495000
254960     END-IF.                                                      25496000
254970                                                                  25497000
254980     MOVE DSDS-BANK-NO    TO DSSAC-BANK-NBR.                      25498000
254990     MOVE DSDS-ACCOUNT-ID TO DSSAC-ACCT-ID.                       25499000
255000     MOVE DSDS-ACCOUNT-NO TO DSSAC-ACCT-NBR.                      25500000
255010     EXEC SQL                                                     25501000
255020         SELECT                                                   25502000
255030             DSSAC_BANK_NBR,                                      25503000
255040             DSSAC_ACCT_ID,                                       25504000
255050             DSSAC_ACCT_NBR,                                      25505000
255060             DSSAC_FA_BANK_NBR,                                   25506000
255070             DSSAC_FA_FILE_ID,                                    25507000
255080             DSSAC_FA_FILE_KEY,                                   25508000
255090             DSSAC_FA_BALANCE,                                    25509000
255100             DSSAC_LAST_UPDATE                                    25510000
255110         INTO                                                     25511000
255120            :DSSAC-BANK-NBR,                                      25512000
255130            :DSSAC-ACCT-ID,                                       25513000
255140            :DSSAC-ACCT-NBR,                                      25514000
255150            :DSSAC-FA-BANK-NBR,                                   25515000
255160            :DSSAC-FA-FILE-ID,                                    25516000
255170            :DSSAC-FA-FILE-KEY,                                   25517000
255180            :DSSAC-FA-BALANCE,                                    25518000
255190            :DSSAC-LAST-UPDATE                                    25519000
255200         FROM DSDS.SACXREF                                        25520000
255210         WHERE DSSAC_BANK_NBR = :DSSAC-BANK-NBR                   25521000
255220           AND DSSAC_ACCT_ID  = :DSSAC-ACCT-ID                    25522000
255230           AND DSSAC_ACCT_NBR = :DSSAC-ACCT-NBR                   25523000
255240     END-EXEC.                                                    25524000
255250     EVALUATE SQLCODE                                             25525000
255260         WHEN ZEROS                                               25526000
255270             MOVE DSSAC-FA-BALANCE TO HOLD-SAC-BALANCE            25527000
255280             MOVE 'Y' TO SAC-HIT-SW                               25528000
255290         WHEN +100                                                25529000
255300             MOVE 'N' TO SAC-HIT-SW                               25530000
255310             MOVE ZEROS            TO HOLD-SAC-BALANCE            25531000
255320             MOVE 853                TO RPT859-RPT-NBR            25532000
255330                                        SORT859-RPT-NBR           25533000
255340             MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT          25534000
255350                                        RPT859-DDA-ACCT-NBR       25535000
255360             MOVE 40                 TO RPT859-EXCEPT-CODE        25536000
255370             MOVE ZEROS              TO SORT859-TX-CODE           25537000
255380             MOVE ZEROS              TO RPT859-TX-AMOUNT          25538000
255390             CALL 'CDCDT48' USING PROC-CURR-DATE                  25539000
255400                                  RPT859-TX-DATE                  25540000
255410             PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT     25541000
255420         WHEN OTHER                                               25542000
255430             CALL 'CDCUT90' USING SQLCA                           25543000
255440             CALL 'CDCDUMP' USING BY CONTENT '2127'               25544000
255450     END-EVALUATE.                                                25545000
255460 P9129-EXIT.                                                      25546000
255470     EXIT.                                                        25547000
255480                                                                  25548000
255490 P9130-GET-SAC-SSN.                                               25549000
255500     MOVE SPACE          TO HOLD-WH-STATUS.                       25550000
255510     MOVE SPACE          TO U021-RETURN-CODE.                     25551000
255520     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    25552000
255530     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   25553000
255540     MOVE CIF-XREF-KEY   TO U021-FILE-KEY.                        25554000
255550     MOVE 'N'            TO U021-DEMOGRAPHICS-IND.                25555000
255560     CALL 'CIFU021'   USING CIFU021-PARAMETERS.                   25556000
255570     IF U021-GOOD-RETURN                                          25557000
255580         NEXT SENTENCE                                            25558000
255590       ELSE                                                       25559000
255600         MOVE ZEROS TO U021-CUST-TAX-ID.                          25560000
255610 P9139-EXIT.                                                      25561000
255620     EXIT.                                                        25562000
255630                                                                  25563000
255640 P9140-WRITE-SAC-REPT-REC.                                        25564000
255650     MOVE DSDS-BANK-NO      TO RPT859-BANK-NBR                    25565000
255660                               SORT859-BANK-NBR                   25566000
255670     MOVE SHORT-NAME        TO RPT859-SHORT-NAME                  25567000
255680     CALL 'CDCDT48' USING DATE-OPENED                             25568000
255690                          RPT859-DT-OPENED.                       25569000
255700     CALL 'CDCDT48' USING DATE-LAST-CUST-ACT                      25570000
255710                          RPT859-DT-LAST-ACT.                     25571000
255720     MOVE DSDSTXL-CODE      TO RPT859-TX-CODE                     25572000
255730                               SORT859-TX-CODE                    25573000
255740     MOVE DSDSTXL-AMOUNT    TO RPT859-TX-AMOUNT.                  25574000
255750     MOVE DSDSTXL-BAT-NO    TO RPT859-BATCH-NBR.                  25575000
255760     WRITE DSDS-859-RECORD FROM DSDS859-REPORT-RECORD.            25576000
255770 P9149-EXIT.                                                      25577000
255780     EXIT.                                                        25578000
255790                                                                  25579000
255800 P9150-SAC-DEBIT-PROCESSING.                                      25580000
255810     INITIALIZE CD-PEND.                                          25581000
255820     IF POSTING-SAC-OFFSET = 'Y'                                  25582000
255830         MOVE 'N' TO POSTING-SAC-OFFSET                           25583000
255840         GO TO P9159-EXIT.                                        25584000
255850     IF CD-NO-OFFSET                                              25585000
255860         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25586000
255870                                    RPT859-DDA-ACCT-NBR           25587000
255880         MOVE 853                TO RPT859-RPT-NBR                25588000
255890                                    SORT859-RPT-NBR               25589000
255900         MOVE 41                 TO RPT859-EXCEPT-CODE            25590000
255910         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT         25591000
255920         GO TO P9159-EXIT.                                        25592000
255930     IF SAC-HIT-SW = 'N'                                          25593000
255940         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25594000
255950                                    RPT859-DDA-ACCT-NBR           25595000
255960         MOVE 853                TO RPT859-RPT-NBR                25596000
255970                                    SORT859-RPT-NBR               25597000
255980         MOVE 47                 TO RPT859-EXCEPT-CODE            25598000
255990         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT         25599000
256000         GO TO P9159-EXIT.                                        25600000
256010                                                                  25601000
256020     IF HOLD-SAC-BALANCE LESS THAN DSDSTXL-AMOUNT                 25602000
256030         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25603000
256040                                    RPT859-DDA-ACCT-NBR           25604000
256050         MOVE 853                TO RPT859-RPT-NBR                25605000
256060                                    SORT859-RPT-NBR               25606000
256070         IF DSDSTXL-BAT-NO = 99921                                25607000
256080             MOVE 46                 TO RPT859-EXCEPT-CODE        25608000
256090           ELSE                                                   25609000
256100             MOVE 48                 TO RPT859-EXCEPT-CODE        25610000
256110         END-IF                                                   25611000
256120         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT         25612000
256130         GO TO P9159-EXIT.                                        25613000
256140                                                                  25614000
256150     MOVE 'N'               TO POSTING-SAC-OFFSET.                25615000
256160     SUBTRACT DSDSTXL-AMOUNT  FROM HOLD-SAC-BALANCE.              25616000
256170     MOVE DSSAC-FA-FILE-KEY TO CIF-XREF-KEY.                      25617000
256180* CD TRANSACTIONS                                                 25618000
256190     MOVE DSDSTXL-AMOUNT   TO CDP-TX-AMOUNT.                      25619000
256200     MOVE 313              TO CDP-TX-CODE.                        25620000
256210     MOVE ZEROS            TO CDP-DEP-WTD-CODE                    25621000
256220     MOVE SPACES           TO CDP-TX-DESC.                        25622000
256230     IF DSDSTXL-CODE = 980                                        25623000
256240         MOVE ZEROS TO TALLY-CNT                                  25624000
256250         INSPECT DSDSTXL-ACH-DESC TALLYING TALLY-CNT              25625000
256260                             FOR ALL 'REVERSAL'                   25626000
256270         IF TALLY-CNT GREATER THAN ZEROS                          25627000
256280             MOVE 89       TO CDP-DEP-WTD-CODE                    25628000
256290             GO TO P9155-CONTINUE                                 25629000
256300         END-IF                                                   25630000
256310     END-IF.                                                      25631000
256320     IF DSDSTXL-CODE = 980                                        25632000
256330         IF DSDSTXL-ACH-COMPANY-ID EQUAL '9753182674'             25633000
256340             MOVE 383      TO CDP-TX-CODE                         25634000
256350             MOVE 99       TO CDP-DEP-WTD-CODE                    25635000
256360             MOVE 'HSA INVESTMENT WITHDRAWAL'                     25636000
256370                           TO CDP-TX-DESC                         25637000
256380             GO TO P9155-CONTINUE                                 25638000
256390         END-IF                                                   25639000
256400         IF DSDSTXL-ACH-COMPANY-ID EQUAL '1952834236'             25640000
256410             IF HSA-ACCT                                          25641000
256420                 MOVE 383      TO CDP-TX-CODE                     25642000
256430                 MOVE 99       TO CDP-DEP-WTD-CODE                25643000
256440                 MOVE 'INVESTMENT WITHDRAWAL    '                 25644000
256450                               TO CDP-TX-DESC                     25645000
256460                 GO TO P9155-CONTINUE                             25646000
256470             END-IF                                               25647000
256480         END-IF                                                   25648000
256490     END-IF.                                                      25649000
256500     IF CD-313-29-TX                                              25650000
256510         MOVE 29           TO CDP-DEP-WTD-CODE.                   25651000
256520     IF CD-313-89-TX                                              25652000
256530         MOVE 89           TO CDP-DEP-WTD-CODE.                   25653000
256540     IF CD-313-91-TX                                              25654000
256550         MOVE 91           TO CDP-DEP-WTD-CODE.                   25655000
256560 P9155-CONTINUE.                                                  25656000
256570     IF CDP-DEP-WTD-CODE = ZEROS                                  25657000
256580        DISPLAY 'CDCERROR (DSDS100) '                             25658000
256590        'ERROR TX NOT SET UP IN CD-313-29 CD-313-89 OR 91 '       25659000
256600            DSDSTXL-CODE                                          25660000
256610        GO TO P9159-EXIT                                          25661000
256620     END-IF.                                                      25662000
256630     ADD DSDSTXL-AMOUNT    TO CD-SAC-DEBITS.                      25663000
256640     PERFORM P9170-INSERT-CDPEND THRU P9179-EXIT.                 25664000
256650* REPORT                                                          25665000
256660     MOVE 855               TO RPT859-RPT-NBR                     25666000
256670                               SORT859-RPT-NBR                    25667000
256680     MOVE XKEY-CD-ACCT-NBR  TO SORT859-DDA-ACCT                   25668000
256690     MOVE DSDS-ACCOUNT-NO   TO RPT859-DDA-ACCT-NBR                25669000
256700     MOVE XKEY-CD-ACCT-NBR  TO RPT859-CD-NBR                      25670000
256710     CALL 'CDCDT48' USING PROC-CURR-DATE                          25671000
256720                          RPT859-TX-DATE                          25672000
256730     MOVE CDP-TX-CODE       TO RPT859-CD-TX-CODE                  25673000
256740     MOVE CDP-DEP-WTD-CODE  TO RPT859-CD-DEP-WTD                  25674000
256750     CALL 'CDCDT48' USING PROC-CURR-DATE                          25675000
256760                          RPT859-TX-DATE                          25676000
256770     CALL 'CDCDT48' USING PROC-CURR-DATE                          25677000
256780                          RPT859-CD-DT-POST                       25678000
256790     CALL 'CDCDT48' USING PROC-CURR-DATE                          25679000
256800                          RPT859-CD-DT-EFF                        25680000
256810     MOVE DSDSTXL-AMOUNT    TO RPT859-GL-DEB-AMT                  25681000
256820     MOVE ZEROS             TO RPT859-GL-CRD-AMT                  25682000
256830     MOVE ZEROS             TO RPT859-EXCEPT-CODE.                25683000
256840     PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.            25684000
256850                                                                  25685000
256860     IF DSDSTXL-CODE = 905                                        25686000
256870         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25687000
256880                                    RPT859-DDA-ACCT-NBR           25688000
256890         MOVE 853                TO RPT859-RPT-NBR                25689000
256900                                    SORT859-RPT-NBR               25690000
256910         MOVE 50                 TO RPT859-EXCEPT-CODE            25691000
256920         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.        25692000
256930                                                                  25693000
256940* DSDS OFFSET TRANSACTION                                         25694000
256950     PERFORM P8205-TX-INIT-2 THRU P8209-EXIT.                     25695000
256960     MOVE 592               TO DSDSTXL-CODE.                      25696000
256970     MOVE PROC-CURR-DATE    TO DSDSTXL-CHK-NO.                    25697000
256980     MOVE 'TRNSFR FROM CD ' TO DSDSTXL-CO-DESC.                   25698000
256990     MOVE XKEY-CD-ACCT-NBR  TO DSDSTXL-DESC.                      25699000
257000     ADD DSDSTXL-AMOUNT     TO GEN-CREDIT-AMT.                    25700000
257010     ADD 1                  TO GEN-CREDIT-CNT.                    25701000
257020     MOVE 'Y'               TO POSTING-SAC-OFFSET.                25702000
257030     PERFORM P1325-NORM-CR-2.                                     25703000
257040     MOVE 'N'               TO POSTING-SAC-OFFSET.                25704000
257050 P9159-EXIT.                                                      25705000
257060     EXIT.                                                        25706000
257070                                                                  25707000
257080 P9160-SAC-CREDIT-PROCESSING.                                     25708000
257090     INITIALIZE CD-PEND.                                          25709000
257100     IF POSTING-SAC-OFFSET = 'Y'                                  25710000
257110         MOVE 'N' TO POSTING-SAC-OFFSET                           25711000
257120         GO TO P9169-EXIT.                                        25712000
257130     IF CD-NO-OFFSET                                              25713000
257140         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25714000
257150                                    RPT859-DDA-ACCT-NBR           25715000
257160         MOVE 853                TO RPT859-RPT-NBR                25716000
257170                                    SORT859-RPT-NBR               25717000
257180         MOVE 42                 TO RPT859-EXCEPT-CODE            25718000
257190         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT         25719000
257200         GO TO P9169-EXIT.                                        25720000
257210     IF SAC-HIT-SW = 'N'                                          25721000
257220         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25722000
257230                                    RPT859-DDA-ACCT-NBR           25723000
257240         MOVE 853                TO RPT859-RPT-NBR                25724000
257250                                    SORT859-RPT-NBR               25725000
257260         MOVE 47                 TO RPT859-EXCEPT-CODE            25726000
257270         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT         25727000
257280         GO TO P9169-EXIT.                                        25728000
257290     MOVE 'N'               TO POSTING-SAC-OFFSET.                25729000
257300     ADD DSDSTXL-AMOUNT     TO HOLD-SAC-BALANCE.                  25730000
257310     MOVE DSSAC-FA-FILE-KEY TO CIF-XREF-KEY.                      25731000
257320* CD TRANSACTIONS                                                 25732000
257330     MOVE DSDSTXL-AMOUNT   TO CDP-TX-AMOUNT.                      25733000
257340     MOVE 335              TO CDP-TX-CODE.                        25734000
257350     MOVE ZEROS            TO CDP-DEP-WTD-CODE                    25735000
257360     MOVE SPACES           TO CDP-TX-DESC.                        25736000
257370     IF DSDSTXL-CODE = 590                                        25737000
257380         MOVE ZEROS TO TALLY-CNT                                  25738000
257390         INSPECT DSDSTXL-ACH-DESC TALLYING TALLY-CNT              25739000
257400                             FOR ALL 'REVERSAL'                   25740000
257410         IF TALLY-CNT GREATER THAN ZEROS                          25741000
257420             MOVE 89       TO CDP-DEP-WTD-CODE                    25742000
257430             GO TO P9165-CONTINUE                                 25743000
257440         END-IF                                                   25744000
257450     END-IF.                                                      25745000
257460     IF DSDSTXL-CODE = 590                                        25746000
257470         IF DSDSTXL-ACH-COMPANY-ID EQUAL '9753182674'             25747000
257480             MOVE 370      TO CDP-TX-CODE                         25748000
257490             MOVE 39       TO CDP-DEP-WTD-CODE                    25749000
257500             MOVE 'HSA INVESTMENT DEPOSIT'                        25750000
257510                           TO CDP-TX-DESC                         25751000
257520             GO TO P9165-CONTINUE                                 25752000
257530         END-IF                                                   25753000
257540         IF DSDSTXL-ACH-COMPANY-ID EQUAL '1952834236'             25754000
257550             IF HSA-ACCT                                          25755000
257560                 MOVE 370      TO CDP-TX-CODE                     25756000
257570                 MOVE 39       TO CDP-DEP-WTD-CODE                25757000
257580                 MOVE 'INVESTMENT DEPOSIT    '                    25758000
257590                               TO CDP-TX-DESC                     25759000
257600                 GO TO P9165-CONTINUE                             25760000
257610             END-IF                                               25761000
257620         END-IF                                                   25762000
257630     END-IF.                                                      25763000
257640     IF CD-335-10-TX                                              25764000
257650         MOVE 10           TO CDP-DEP-WTD-CODE.                   25765000
257660     IF CD-335-89-TX                                              25766000
257670         MOVE 89           TO CDP-DEP-WTD-CODE.                   25767000
257680     IF CD-335-91-TX                                              25768000
257690         MOVE 91           TO CDP-DEP-WTD-CODE.                   25769000
257700 P9165-CONTINUE.                                                  25770000
257710     IF CDP-DEP-WTD-CODE = ZEROS                                  25771000
257720        DISPLAY 'CDCERROR (DSDS100) '                             25772000
257730        'ERROR TX NOT SET UP IN CD-335-29 CD-335-89 OR 91 '       25773000
257740            DSDSTXL-CODE                                          25774000
257750        GO TO P9169-EXIT                                          25775000
257760     END-IF.                                                      25776000
257770     ADD DSDSTXL-AMOUNT    TO CD-SAC-CREDITS.                     25777000
257780     PERFORM P9170-INSERT-CDPEND THRU P9179-EXIT.                 25778000
257790                                                                  25779000
257800* REPORT                                                          25780000
257810     MOVE 855               TO RPT859-RPT-NBR                     25781000
257820                               SORT859-RPT-NBR                    25782000
257830     MOVE XKEY-CD-ACCT-NBR  TO SORT859-DDA-ACCT                   25783000
257840     MOVE DSDS-ACCOUNT-NO   TO RPT859-DDA-ACCT-NBR                25784000
257850     MOVE XKEY-CD-ACCT-NBR  TO RPT859-CD-NBR                      25785000
257860     CALL 'CDCDT48' USING PROC-CURR-DATE                          25786000
257870                          RPT859-TX-DATE                          25787000
257880     MOVE CDP-TX-CODE       TO RPT859-CD-TX-CODE                  25788000
257890     MOVE CDP-DEP-WTD-CODE  TO RPT859-CD-DEP-WTD                  25789000
257900     CALL 'CDCDT48' USING PROC-CURR-DATE                          25790000
257910                          RPT859-CD-DT-POST                       25791000
257920     CALL 'CDCDT48' USING PROC-CURR-DATE                          25792000
257930                          RPT859-CD-DT-EFF                        25793000
257940     MOVE ZEROS             TO RPT859-GL-DEB-AMT                  25794000
257950     MOVE DSDSTXL-AMOUNT    TO RPT859-GL-CRD-AMT                  25795000
257960     MOVE ZEROS             TO RPT859-EXCEPT-CODE.                25796000
257970     PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.            25797000
257980     IF DSDSTXL-CODE = 605                                        25798000
257990         MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT              25799000
258000                                    RPT859-DDA-ACCT-NBR           25800000
258010         MOVE 853                TO RPT859-RPT-NBR                25801000
258020                                    SORT859-RPT-NBR               25802000
258030         MOVE 50                 TO RPT859-EXCEPT-CODE            25803000
258040         PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT.        25804000
258050* DSDS OFFSET TRANSACTION                                         25805000
258060     PERFORM P8205-TX-INIT-2 THRU P8209-EXIT.                     25806000
258070     MOVE 742               TO DSDSTXL-CODE.                      25807000
258080     MOVE DSSAC-FA-FILE-KEY TO CIF-XREF-KEY.                      25808000
258090     MOVE 'TRNSFR TO CD '    TO DSDSTXL-CO-DESC.                  25809000
258100     MOVE XKEY-CD-ACCT-NBR  TO DSDSTXL-DESC.                      25810000
258110     MOVE NON-SER-NON-CHK-KEY TO SAVE-DR-SORT-KEY.                25811000
258120     MOVE PROC-CURR-DATE    TO DSDSTXL-CHK-NO.                    25812000
258130     MOVE ZEROS             TO DSDSTXL-ENCL-TYPE                  25813000
258140     ADD DSDSTXL-AMOUNT     TO GEN-DEBIT-AMT.                     25814000
258150     ADD 1                  TO GEN-DEBIT-CNT.                     25815000
258160     ADD 1                  TO NUM-BILL-TX.                       25816000
258170     MOVE 'Y'               TO POSTING-SAC-OFFSET.                25817000
258180     PERFORM P1665-NORM-DEBIT.                                    25818000
258190     MOVE 'N'               TO POSTING-SAC-OFFSET.                25819000
258200 P9169-EXIT.                                                      25820000
258210     EXIT.                                                        25821000
258220                                                                  25822000
258230 P9170-INSERT-CDPEND.                                             25823000
258240     MOVE DSDS-BANK-NO      TO CDP-BANK-NBR.                      25824000
258250     MOVE XKEY-CD-ACCT-NBR  TO CDP-ACCT-NBR.                      25825000
258260     CALL 'CDCDT48' USING PROC-CURR-DATE                          25826000
258270                          CDP-EFFECT-DATE.                        25827000
258280     MOVE SPACES            TO CDP-REVERSAL-CODE.                 25828000
258290     MOVE SPACES            TO CDP-WITHHOLD-CODE.                 25829000
258300     MOVE SPACES            TO CDP-STOCK-NBR.                     25830000
258310     MOVE ZEROS             TO CDP-TAX-WITHHELD.                  25831000
258320     MOVE 'DSDS100'         TO CDP-SOURCE-PROG.                   25832000
258330     CALL 'CDCDT48' USING PROC-CURR-DATE                          25833000
258340                          CDP-ENTRY-DATE.                         25834000
258350     EXEC SQL                                                     25835000
258360         INSERT INTO CD.PEND                                      25836000
258370             (CDP_BANK_NBR,                                       25837000
258380              CDP_ACCT_NBR,                                       25838000
258390              CDP_TX_CODE,                                        25839000
258400              CDP_TX_AMOUNT,                                      25840000
258410              CDP_EFFECT_DATE,                                    25841000
258420              CDP_DEP_WTD_CODE,                                   25842000
258430              CDP_REVERSAL_CODE,                                  25843000
258440              CDP_WITHHOLD_CODE,                                  25844000
258450              CDP_STOCK_NBR,                                      25845000
258460              CDP_TAX_WITHHELD,                                   25846000
258470              CDP_SOURCE_PROG,                                    25847000
258480              CDP_ENTRY_DATE,                                     25848000
258490              CDP_TX_DESC)                                        25849000
258500         VALUES                                                   25850000
258510             (:CDP-BANK-NBR,                                      25851000
258520              :CDP-ACCT-NBR,                                      25852000
258530              :CDP-TX-CODE,                                       25853000
258540              :CDP-TX-AMOUNT,                                     25854000
258550              :CDP-EFFECT-DATE,                                   25855000
258560              :CDP-DEP-WTD-CODE,                                  25856000
258570              :CDP-REVERSAL-CODE,                                 25857000
258580              :CDP-WITHHOLD-CODE,                                 25858000
258590              :CDP-STOCK-NBR,                                     25859000
258600              :CDP-TAX-WITHHELD,                                  25860000
258610              :CDP-SOURCE-PROG,                                   25861000
258620              :CDP-ENTRY-DATE,                                    25862000
258630              :CDP-TX-DESC)                                       25863000
258640     END-EXEC.                                                    25864000
258650     EVALUATE SQLCODE                                             25865000
258660         WHEN ZEROS                                               25866000
258670             CONTINUE                                             25867000
258680         WHEN OTHER                                               25868000
258690             CALL 'CDCUT90' USING SQLCA                           25869000
258700             CALL 'CDCDUMP' USING BY CONTENT '2128'               25870000
258710     END-EVALUATE.                                                25871000
258720                                                                  25872000
258730 P9179-EXIT.                                                      25873000
258740     EXIT.                                                        25874000
258750                                                                  25875000
258760 P9180-DELETE-CDPEND.                                             25876000
258770     MOVE PROC-BK-NO  TO CDP-BANK-NBR                             25877000
258780     CALL 'CDCDT48' USING PROC-CURR-DATE                          25878000
258790                          WORK-ENTRY-DATE.                        25879000
258800     EXEC SQL                                                     25880000
258810         DELETE FROM CD.PEND                                      25881000
258820         WHERE CDP_BANK_NBR    = :CDP-BANK-NBR                    25882000
258830           AND CDP_SOURCE_PROG = 'DSDS100'                        25883000
258840           AND CDP_ENTRY_DATE  = :WORK-ENTRY-DATE                 25884000
258850     END-EXEC.                                                    25885000
258860     EVALUATE SQLCODE                                             25886000
258870         WHEN ZEROS                                               25887000
258880         WHEN +100                                                25888000
258890             CONTINUE                                             25889000
258900         WHEN OTHER                                               25890000
258910             CALL 'CDCUT90' USING SQLCA                           25891000
258920             CALL 'CDCDUMP' USING BY CONTENT '2129'               25892000
258930     END-EVALUATE.                                                25893000
258940 P9189-EXIT.                                                      25894000
258950     EXIT.                                                        25895000
258960                                                                  25896000
258970 P9190-IRA-OSB-STMT-SUMMARY.                                      25897000
258980     INITIALIZE IRA-OSB-STMT-SUMMARY.                             25898000
258990     MOVE DSDS-BANK-NO   TO IRADDA-BANK-NBR.                      25899000
259000     MOVE ACCOUNT-NUMBER TO IRADDA-ACCT-NBR.                      25900000
259010     EXEC SQL                                                     25901000
259020         SELECT                                                   25902000
259030             IRADDA_BANK_NBR,                                     25903000
259040             IRADDA_CUST_NBR,                                     25904000
259050             IRADDA_SEQ_NBR,                                      25905000
259060             IRADDA_ACCT_NBR,                                     25906000
259070             IRADDA_LAST_UPDATE                                   25907000
259080         INTO                                                     25908000
259090            :IRADDA-BANK-NBR,                                     25909000
259100            :IRADDA-CUST-NBR,                                     25910000
259110            :IRADDA-SEQ-NBR,                                      25911000
259120            :IRADDA-ACCT-NBR,                                     25912000
259130            :IRADDA-LAST-UPDATE                                   25913000
259140         FROM IRA.DDA                                             25914000
259150         WHERE IRADDA_BANK_NBR = :IRADDA-BANK-NBR                 25915000
259160           AND IRADDA_ACCT_NBR = :IRADDA-ACCT-NBR                 25916000
259170     END-EXEC.                                                    25917000
259180     EVALUATE SQLCODE                                             25918000
259190         WHEN ZEROS                                               25919000
259200             CONTINUE                                             25920000
259210         WHEN +100                                                25921000
259220             MOVE DSDS-ACCOUNT-NO    TO SORT859-DDA-ACCT          25922000
259230                                        RPT859-DDA-ACCT-NBR       25923000
259240             MOVE 853                TO RPT859-RPT-NBR            25924000
259250                                        SORT859-RPT-NBR           25925000
259260             MOVE 49                 TO RPT859-EXCEPT-CODE        25926000
259270             PERFORM P9140-WRITE-SAC-REPT-REC THRU P9149-EXIT     25927000
259280             GO TO P9199-EXIT                                     25928000
259290         WHEN OTHER                                               25929000
259300             CALL 'CDCUT90' USING SQLCA                           25930000
259310             CALL 'CDCDUMP' USING BY CONTENT '2130'               25931000
259320     END-EVALUATE.                                                25932000
259330                                                                  25933000
259340     MOVE DSDS-BANK-NO         TO IOS-BANK-NBR.                   25934000
259350     MOVE ACCOUNT-ID           TO IOS-ACCT-ID.                    25935000
259360     MOVE HOLD-DDA-ACCT-NO-LINKED-TO-SEC TO IOS-OSB-NBR.          25936000
259370     EVALUATE SAC-IND                                             25937000
259380         WHEN 'H'                                                 25938000
259390           MOVE 030            TO IOS-SUMM-TYPE                   25939000
259400           MOVE 010            TO IOS-CNTR-TYPE                   25940000
259410         WHEN 'C'                                                 25941000
259420           MOVE 050            TO IOS-SUMM-TYPE                   25942000
259430           MOVE 009            TO IOS-CNTR-TYPE                   25943000
259440     END-EVALUATE.                                                25944000
259450     MOVE U021-CUST-TAX-ID     TO IOS-SSN.                        25945000
259460     MOVE IRADDA-CUST-NBR      TO IOS-IRA-CUST-NBR.               25946000
259470     MOVE 010                  TO IOS-RECORD-TYPE.                25947000
259480     MOVE 005                  TO IOS-ACCT-TYPE.                  25948000
259490     INITIALIZE WORK-IRA-CNTR-NBR.                                25949000
259500     MOVE IRADDA-CUST-NBR      TO WORK-IRA-CUST-NBR.              25950000
259510     MOVE '-'                  TO WORK-IRA-FILLER.                25951000
259520     MOVE IRADDA-SEQ-NBR       TO WORK-IRA-SEQ-NBR.               25952000
259530     MOVE WORK-IRA-CNTR-NBR    TO IOS-CNTR-NBR.                   25953000
259540     MOVE STMT-CYCLE-CODE      TO IOS-CYCLE-CODE.                 25954000
259550     MOVE ZEROS                TO IOS-BNF-NBR.                    25955000
259560     MOVE SHORT-NAME           TO IOS-CUST-NAME.                  25956000
259570     MOVE ACCOUNT-NUMBER       TO IOS-ACCT-NBR.                   25957000
259580     MOVE CURRENT-BALANCE      TO IOS-ACCT-MKT-VALUE.             25958000
259590     MOVE ZEROS                TO IOS-CNTR-MKT-VALUE.             25959000
259600     MOVE SPACES               TO IOS-BNF-NAME.                   25960000
259610     MOVE ZEROS                TO IOS-BNF-PERCENT.                25961000
259620     MOVE ZEROS                TO IOS-CNTRIB-TYPE.                25962000
259630     MOVE ZEROS                TO IOS-CNTRIB-YEAR.                25963000
259640     MOVE ZEROS                TO IOS-CNTRIB-YTD.                 25964000
259650     MOVE 1                    TO IOS-OWNER-SW.                   25965000
259660     WRITE OSB-IRA-RECORD FROM IRA-OSB-STMT-SUMMARY.              25966000
259670 P9199-EXIT.                                                      25967000
259680     EXIT.                                                        25968000
259690                                                                  25969000
259700 P9200-GET-CUST-NAME.                                             25970000
259710     MOVE PROC-BK-NO     TO U010-BANK-NBR.                        25971000
259720     MOVE 'A'            TO U010-PROCESS-IND.                     25972000
259730     MOVE ACCOUNT-ID     TO XKEY-DSDS-ACCT-ID.                    25973000
259740     MOVE ACCOUNT-NUMBER TO XKEY-DSDS-ACCT-NBR.                   25974000
259750     MOVE SPACES         TO U010-RETURN-CODE.                     25975000
259760     MOVE 'DDA '         TO U010-FILE-ID.                         25976000
259770     MOVE CIF-XREF-KEY   TO U010-FILE-KEY.                        25977000
259780     MOVE 006            TO U010-NUM-OF-LINES-REQUESTED.          25978000
259790                                                                  25979000
259800     CALL 'CIFU010' USING CIFU010-PARAMETERS.                     25980000
259810     IF U010-BAD-RETURN                                           25981000
259820         MOVE '*** NAME AND ADDRESS NOT FOUND ***'                25982000
259830             TO U010-CUSTOMER-NAME                                25983000
259840         DISPLAY 'NO ADDRESS FOUND  '                             25984000
259850         DISPLAY 'U010-BANK-NBR ' U010-BANK-NBR                   25985000
259860         DISPLAY 'U010-FILEID ' U010-FILE-ID                      25986000
259870         DISPLAY 'U010-FILE-KEY ' U010-FILE-KEY.                  25987000
259880     MOVE U010-CUSTOMER-NAME   TO SSR-ACCOUNT-NAME.               25988000
259890                                                                  25989000
259900 P9299-EXIT.                                                      25990000
259910     EXIT.                                                        25991000
259920 P9300-DELETE-ODBGLTXN.                                           25992000
259930     MOVE PROC-BK-NO TO OBGL-BANK-NBR.                            25993000
259940     EXEC SQL                                                     25994000
259950         DELETE FROM DSDS.ODB_GL_BATCH_TXN                        25995000
259960         WHERE OBGL_BANK_NBR = :OBGL-BANK-NBR                     25996000
259970     END-EXEC.                                                    25997000
259980     EVALUATE SQLCODE                                             25998000
259990         WHEN ZEROS                                               25999000
260000         WHEN +100                                                26000000
260010             CONTINUE                                             26001000
260020         WHEN OTHER                                               26002000
260030             CALL 'CDCUT90' USING SQLCA                           26003000
260040             CALL 'CDCDUMP' USING BY CONTENT '2131'               26004000
260050     END-EVALUATE.                                                26005000
260060 P9309-EXIT.                                                      26006000
260070     EXIT.                                                        26007000
260080                                                                  26008000
260090 P9310-INSERT-ODB-TOTALS.                                         26009000
260100     MOVE PROC-BK-NO           TO OBGL-BANK-NBR.                  26010000
260110     MOVE ODB-PLAN             TO OBGL-PLAN.                      26011000
260120     MOVE LOAN-OFFICER-CODE    TO OBGL-LOAN-OFF-CODE.             26012000
260130     IF OBGL-ADVANCE-AMT NOT NUMERIC                              26013000
260140         MOVE ZEROS TO OBGL-ADVANCE-AMT                           26014000
260150     END-IF.                                                      26015000
260160     IF OBGL-PAYMENT-AMT NOT NUMERIC                              26016000
260170         MOVE ZEROS TO OBGL-PAYMENT-AMT                           26017000
260180     END-IF.                                                      26018000
260190     IF OBGL-ACCR-INT-AMT NOT NUMERIC                             26019000
260200         MOVE ZEROS TO OBGL-ACCR-INT-AMT                          26020000
260210     END-IF.                                                      26021000
260220     IF OBGL-COLL-INT-AMT NOT NUMERIC                             26022000
260230         MOVE ZEROS TO OBGL-COLL-INT-AMT                          26023000
260240     END-IF.                                                      26024000
260250     IF OBGL-DROP-INT-AMT NOT NUMERIC                             26025000
260260         MOVE ZEROS TO OBGL-DROP-INT-AMT                          26026000
260270     END-IF.                                                      26027000
260280     IF OBGL-CREDIT-LIFE-AMT NOT NUMERIC                          26028000
260290         MOVE ZEROS TO OBGL-CREDIT-LIFE-AMT                       26029000
260300     END-IF.                                                      26030000
260310     IF OBGL-MO-FEE-AMT NOT NUMERIC                               26031000
260320         MOVE ZEROS TO OBGL-MO-FEE-AMT                            26032000
260330     END-IF.                                                      26033000
260340     IF    OBGL-ADVANCE-AMT     = ZEROS                           26034000
260350       AND OBGL-PAYMENT-AMT     = ZEROS                           26035000
260360       AND OBGL-ACCR-INT-AMT    = ZEROS                           26036000
260370       AND OBGL-COLL-INT-AMT    = ZEROS                           26037000
260380       AND OBGL-DROP-INT-AMT    = ZEROS                           26038000
260390       AND OBGL-CREDIT-LIFE-AMT = ZEROS                           26039000
260400       AND OBGL-MO-FEE-AMT      = ZEROS                           26040000
260410         GO TO P9319-EXIT                                         26041000
260420     END-IF.                                                      26042000
260430                                                                  26043000
260440     EXEC SQL                                                     26044000
260450         INSERT INTO DSDS.ODB_GL_BATCH_TXN                        26045000
260460             (OBGL_BANK_NBR,                                      26046000
260470              OBGL_PLAN,                                          26047000
260480              OBGL_LOAN_OFF_CODE,                                 26048000
260490              OBGL_ADVANCE_AMT,                                   26049000
260500              OBGL_PAYMENT_AMT,                                   26050000
260510              OBGL_ACCR_INT_AMT,                                  26051000
260520              OBGL_COLL_INT_AMT,                                  26052000
260530              OBGL_DROP_INT_AMT,                                  26053000
260540              OBGL_CREDIT_LIFE_AMT,                               26054000
260550              OBGL_MO_FEE_AMT,                                    26055000
260560              OBGL_CREATE_TS,                                     26056000
260570              OBGL_UPDATE_TS)                                     26057000
260580         VALUES                                                   26058000
260590             (:OBGL-BANK-NBR,                                     26059000
260600              :OBGL-PLAN,                                         26060000
260610              :OBGL-LOAN-OFF-CODE,                                26061000
260620              :OBGL-ADVANCE-AMT,                                  26062000
260630              :OBGL-PAYMENT-AMT,                                  26063000
260640              :OBGL-ACCR-INT-AMT,                                 26064000
260650              :OBGL-COLL-INT-AMT,                                 26065000
260660              :OBGL-DROP-INT-AMT,                                 26066000
260670              :OBGL-CREDIT-LIFE-AMT,                              26067000
260680              :OBGL-MO-FEE-AMT,                                   26068000
260690              CURRENT TIMESTAMP,                                  26069000
260700              CURRENT TIMESTAMP)                                  26070000
260710     END-EXEC.                                                    26071000
260720     EVALUATE SQLCODE                                             26072000
260730         WHEN ZEROS                                               26073000
260740             CONTINUE                                             26074000
260750         WHEN OTHER                                               26075000
260760             CALL 'CDCUT90' USING SQLCA                           26076000
260770             CALL 'CDCDUMP' USING BY CONTENT '2132'               26077000
260780     END-EVALUATE.                                                26078000
260790                                                                  26079000
260800     MOVE ZEROS TO OBGL-ADVANCE-AMT                               26080000
260810                   OBGL-PAYMENT-AMT                               26081000
260820                   OBGL-ACCR-INT-AMT                              26082000
260830                   OBGL-COLL-INT-AMT                              26083000
260840                   OBGL-DROP-INT-AMT                              26084000
260850                   OBGL-CREDIT-LIFE-AMT                           26085000
260860                   OBGL-MO-FEE-AMT.                               26086000
260870 P9319-EXIT.                                                      26087000
260880     EXIT.                                                        26088000
260890                                                                  26089000
260900 P9320-AA-ESTATEMENT-TX.                                          26090000
260910** IF ESTATEMENT SEND TRANSACTION TO AA                           26091000
260920**    THIS ONLY IS EXECUTED IF IT IS MONTH-END AND AA IND = Y     26092000
260930     IF HOLD-ESI-ELECTRONIC = 'Y'                                 26093000
260940         MOVE SPACES              TO AA-FILEREC                   26094000
260950         MOVE 01                  TO AA-INSYSTEM                  26095000
260960         MOVE PROC-BK-NO          TO AA-BKNBR                     26096000
260970         MOVE 01                  TO AA-APPL                      26097000
260980         MOVE ACCOUNT-NUMBER      TO AA-ACCOUNT                   26098000
260990         MOVE 01                  TO AA-RECCODE                   26099000
261000         INITIALIZE                  AA-TRANSACTION               26100000
261010         MOVE PROC-CURR-DATE      TO AA-TRPROCDT                  26101000
261020                                     AA-TREFFDT                   26102000
261030         MOVE 480                 TO AA-TREXTC                    26103000
261040                                     AA-TRITC                     26104000
261050         MOVE 1                   TO AA-TRITEMCT                  26105000
261060         WRITE ACCT-ANAL-TX-OUT FROM AA-FILEREC                   26106000
261070     END-IF.                                                      26107000
261080 P9329-EXIT.                                                      26108000
261090     EXIT.                                                        26109000
261100                                                                  26110000
261110******************************************************************26111000
261120*    E N D   O F   R U N                                         *26112000
261130******************************************************************26113000
261140 P9999-END.                                                       26114000
261150     SET CLOSE-INPUT    TO TRUE.                                  26115000
261160     CALL 'DSDSTXL1' USING IO-PARAMETERS                          26116000
261170                           DSDS-TRANSACTION-LONG.                 26117000
261180     IF NOT IO-SUCCESSFUL                                         26118000
261190         DISPLAY 'CDCERROR-TX CLOSE ERROR' UPON CONSOLE           26119000
261200         DISPLAY 'IO FILE STATUS = ' IO-FILE-STATUS UPON CONSOLE  26120000
261210         CALL 'CDCDUMP' USING BY CONTENT '2133'.                  26121000
261220                                                                  26122000
261230     CLOSE PROCESS-CONTROL                                        26123000
261240           POSTED-DETAIL                                          26124000
261250           SPECIAL-FORMS-WORK                                     26125000
261260           OBS-TRANS-FILE                                         26126000
261270           BCF-FILE                                               26127000
261280           HOLD-TOT-FILE                                          26128000
261290           ACCOUNT-RECON                                          26129000
261300           ACCT-ANAL-FILE                                         26130000
261310           NSF-ITEM-FILE-1                                        26131000
261320           NSF-ITEM-FILE-2                                        26132000
261330           NSF-ITEM-FILE-3                                        26133000
261340           NSF-ITEM-FILE-4                                        26134000
261350           STMT-HEADER-FILE                                       26135000
261360           ODB-HISTORY-DTL-FILE                                   26136000
261370           CASH-MGMT-COLLAT-FILE                                  26137000
261380           OSB-SUMMARY-FILE                                       26138000
261390           MCF-HEADER-FILE                                        26139000
261400           MCF-HEADER-FILE-EOM                                    26140000
261410           DSDS-BAI-TRANS-FILE                                    26141000
261420           ACCT-ANAL-TX-FILE                                      26142000
261430           CHANGE-LOG-FILE                                        26143000
261440           DSDS-859-FILE                                          26144000
261450           OSB-IRA-SUMMARY-FILE                                   26145000
261460           DEPOSIT-SCORE-FILE                                     26146000
261470           COLLAT-EXCEPT-FILE                                     26147000
261480           ML-HELOC-ADV-FILE                                      26148000
261490           ACRS-TRAN-FILE                                         26149000
261500           CLSN-BR-TX-FILE                                        26150000
261510           ICS-FA-TRAN-FILE.                                      26151000
261520     MOVE 'C' TO DSDM102-ACTION-CODE.                             26152000
261530     PERFORM P7000-WRITE-STOCK THRU P7009-EXIT.                   26153000
261540     MOVE 'C' TO DSDM103-ACTION-CODE.                             26154000
261550     PERFORM P6900-GL-TRANS THRU P6909-EXIT.                      26155000
261560     MOVE 'C' TO RBB-ACTION-CODE.                                 26156000
261570     CALL 'DSDM065' USING RBB-ACTION-CODE                         26157000
261580                          RBB-ACTION-DATE                         26158000
261590                          RELATIONSHIP-BANKING-BALANCES           26159000
261600                          RBB-RETURN-CODE.                        26160000
261610     IF COL-OPEN-SW = 1                                           26161000
261620         CLOSE DSDS-COLLATERAL-FILE.                              26162000
261630     IF PROC-MONTH-END                                            26163000
261640         CLOSE INV-STATEMENT-BALANCES.                            26164000
261650     IF AFFCHK-OPEN-SW = 1                                        26165000
261660         CLOSE AFFCHK-HOLD-FILE.                                  26166000
261670     IF SHADOW-OPEN-SW = 1                                        26167000
261680         CLOSE SHADOW-ACCOUNTS.                                   26168000
261690     CLOSE DSDS-MAST.                                             26169000
261700     IF VSAM-SUCCESSFUL                                           26170000
261710         NEXT SENTENCE                                            26171000
261720       ELSE                                                       26172000
261730         DISPLAY 'CDCERROR-MASTER CLOSE ERROR' UPON CONSOLE       26173000
261740         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  26174000
261750         CALL 'CDCDUMP' USING BY CONTENT '2134'.                  26175000
261760                                                                  26176000
261770     CLOSE DSDS-HIST.                                             26177000
261780     IF VSAM-SUCCESSFUL                                           26178000
261790         NEXT SENTENCE                                            26179000
261800       ELSE                                                       26180000
261810         DISPLAY 'CDCERROR-HISTORY CLOSE ERROR' UPON CONSOLE      26181000
261820         DISPLAY 'FILE STATUS IS ' VSAM-FILE-STATUS UPON CONSOLE  26182000
261830         CALL 'CDCDUMP' USING BY CONTENT '2135'.                  26183000
261840                                                                  26184000
261850     MOVE ZEROS     TO RETURN-CODE.                               26185000
261860     STOP RUN.                                                    26186000
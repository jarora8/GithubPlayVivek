       IDENTIFICATION DIVISION.

       PROGRAM-ID. VPAFIXST.

      *TITLE.      ANNUAL STATEMENT FOR FIXED FUND CONTRACTS.

       AUTHOR.     ELLIOTT.

       DATE-WRITTEN.  APRIL 2002.
       DATE-COMPILED. DATE.

      *REMARKS.
      *****************************************************************
      *****************************************************************
      *                          PROGRAM NARRATIVE                    *
      *                                                               *
      *       THIS PROGRAM CREATES STATEMENT EXTRACT                  *
      *       FOR FIXED FUND CONTRACTS                                *
      *                                                               *
      *                                                               *
      *****************************************************************
      *
      *    CHANGES:
      *
      ******************************************************************
      *                                                                *
      *   DATE      PROGRAMMER MOD ID  DESCRIPTION                     *
      *   ----      ---------- ------  -----------------------------   *
      *   09/27/02  ELLIOTT            NEW PROGRAM                     *
      *                                                                *
      * 08/10/02  KEITH ELLIOTT        WR3171  ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           VSAM TO DB2 UPGRADE                                  *
      *                                                                *
      *                                                                *
      * 09/18/06  mark hussin          WR6317  ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           product wizard - remove tables open/close            *
      *                                                                *
      * 04/25/07  KEITH ELLIOTT        $WR8004 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           MODIFY CUST SERVICE PHONE NUMBER CIRITERIA           *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 10/01/08  KEITH ELLIOTT        $WR7339 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           GET AGENT AND AGENCY INFO FROM VPDPS ONLY            *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/03/09  KEITH ELLIOTT        $WR10612('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           suppress statements for explorer fixed prod          *
      *           until spec are determined                            *
      *   ----    ----------           ------                          *
      * 09/23/09  KEITH ELLIOTT        $WR11491('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           explorer changes.  add new product codes             *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 10/13/09  KRIS CUMMINGS        $W10612D('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD EXPLORER STATEMENTS                              *
      *                                                                *
      *   ----    ----------           ------                          *
      * 01/23/10  KEITH ELLIOTT        $AI0817 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ISSUE WITH INTEREST VALUES NOT CORRECT IN FUND       *
      *           DETAIL                                               *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/31/10  KRIS CUMMINGS        $W10612D('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD BAD ADDRESS INDICATOR FOR OWNER.                 *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/31/10  KRIS CUMMINGS        $W12397 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT PLA PHONE NUMBER.                            *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 06/23/10  KEITH ELLIOTT        $W12422 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           suppress statements for frontiers II   prod          *
      *           until spec are determined                            *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 07/13/10  KRIS CUMMINGS        $W6165C ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CHECK FOR BAD ADDRESSES.                             *
      *                                                                *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 11/13/10  Keith Elliott        $W13298 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PCL CONTRACTS NOW GET SAME PHONE NUMBERS AS          *
      *           OTHER CONTRACTS.                                     *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 11/22/10  KRIS CUMMINGS        $W13412 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           FIX PROBLEM WHEN FIRST PAYMENT IS SMALL.             *
      *                                                                *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/13/11  Keith Elliott        $T11902 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD FRONTIERS II STATEMENTS                          *
      *           renamed some fields and routines to organize program *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 04/06/11  Keith Elliott        $T????? ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           correct issues with tot purchase payment = 0         *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 04/12/11  KRIS CUMMINGS        $T45382 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT TOTAL PURCHASE PAYMENT FIELD FOR EXPLORER/   *
      *           EXPLORER II CONTRACTS IN SUBSEQUENT YEARS.           *
      *                                                                *
      * 05/12/11  KL                   TR46474                         *
      *           ADD CUSTODIAN OWNER FIXED ANNUITY STMT SUPPRESSION   *
      *           CLONE OF CODE FROM VPASTMX. IF WE ADD A NEW          *
      *           B/D SUPPRESSION HERE, ASK IF WE NEED TO ADD IT TO THE*
      *           VARIABLE PROGRAM AS WELL.                            *
      *                                                                *
      ******************************************************************
      * Note:  Any changes to Custodian Suppression should be sync'd   *
      *        with VPASTMX (variable STMT program).                   *
      *                                                                *
      * 07/12/11  KEITH ELLIOTT        $T49002 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           FIX PROBLEM WHERE PAC PROVIDER STATEMENTS WERE NOT   *
      *           BEING PRODUCED                                       *
      *                                                                *
      *                                                                *
      * 07/18/11  KEITH ELLIOTT        $T49197 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           get out if eof to prevent abend                      *
      *                                                                *
      * 08/18/11  J WALTERS            $T50473 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *         some contracts are pcl even though the 15th character  *
      *         is not a 'v'.  Listing all plan codes to fix abend     *
      *         problem.                                               *
      *                                                                *
      * 09/02/11  YVONNE GAINES        $T53281 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           Adjustments to Finalist call                         *
      *                                                                *
      * 02/02/12  KEITH ELLIOTT        $T58633 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD BAD ADDRESS SWITCH TO PASS TO STATEMENT REPORT   *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 06/19/12  KRIS CUMMINGS        $P71533 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           FIX EXPLORER CONTRACTS WHEN THERE ARE MULTIPLE       *
      *           SEGMENTS FOR FUND 111.                               *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 08/01/12  KRIS CUMMINGS        $T59669 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD NEW RECORD TYPES FOR INCOME CHOICE/NOMVA (FIA)   *
      *           AND HANDLE THE EXPANSION OF THE NUMBER OF PRODUCTS.  *
      *           - ADDITIONAL CHARGES ADDED BY MARK HUSSIN            *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 12/04/12  KRIS CUMMINGS        $T83836 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT FRONTIERS II STATEMENTS AFTER FIRST YEAR.    *
      *           DON'T INCLUDE PREMIUMS.                              *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 12/18/12  KRIS CUMMINGS        $T84581 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT GMSV WITHDRAWAL AMOUNT TO BE NET OF PENALTY. *
      *           (RECORD 38)                                          *
      *           CORRECT INDEX GROWTH PERCENT FOR TYPE T INDEX FUNDS  *
      *           FOR FIA. (RECORD 53)                                 *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/03/13  KRIS CUMMINGS        $T85733 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT BAND START DATE BY USING DEPOSIT DATE.       *
      *           (RECORD 53)                                          *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/09/13  KRIS CUMMINGS        $T86289 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT BAND START DATE BY USING DEPOSIT DATE.       *
      *           (RECORD 53)                                          *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/11/13  KRIS CUMMINGS        $T86566 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT % INTEREST CREDITED ON PRO-RATED BANDS.      *
      *           (RECORD 53)                                          *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/18/13  KRIS CUMMINGS        $T87078 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           DON'T INCLUDE BANDS THAT ARE CREATED BY THE OEZ.     *
      *           (RECORD 52)                                          *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/18/13  KRIS CUMMINGS        $T87159 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PRINT INDEX FUNDS FOR ONE LAST ANNIVERSARY AFTER     *
      *           AN OEM.                                              *
      *           (RECORDS 52/53)                                      *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/04/13  KRIS CUMMINGS        $T88983 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD RIDER NAME TO 30 RECORD.                         *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/20/13  KRIS CUMMINGS        $T92005 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADJUST THE STATEMENT END DATE FOR FIA CONTRACTS.     *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/29/13  KRIS CUMMINGS        $T70714 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD NEW RECORD TYPES FOR EXPEDITION.                 *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 06/13/13  KRIS CUMMINGS        $T97014 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD NAIC VALUES RECORD('31') TO ALL FIXED BUSINESS.  *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 10/11/13  KRIS CUMMINGS        $T97872 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT EXPEDITION STATEMENT RENEWALS.               *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/10/14  KRIS CUMMINGS        $114384 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT FIA STATEMENT RENEWALS.                      *
      *              - INTEREST EARNED CALCULATION                     *
      *              - MATCHING BEGINNING CONTRACT VALUE TO PRIOR      *
      *                YEARS ENDING VALUE                              *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/15/14  KRIS CUMMINGS        $110757 ('$' IN COL 73,         *
      *                                $111436  MOD ID IN 74-79)       *
      *                                $113471                         *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD MARINER STATEMENTS. (TR-110757)                  *
      *           ADD B/D SPECIFIC PHONE #. (TR-111436)                *
      *           ADD BENEFICIARY RECORD TO ALL PRODUCTS. (TR-113471)  *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/12/14  KRIS CUMMINGS        $117078 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           CORRECT FIA STATEMENT FOR 1ST YEAR WITH ADD ON       *
      *           PREMIUMS.                                            *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 04/28/14  KRIS CUMMINGS        $114947 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD NEW FIELDS FOR INDEX CHOICE.                     *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 05/26/14  KRIS CUMMINGS       $T124058 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           WELLS FARGO FIA (TREAT AS REGULAR FOR NOW)           *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 07/31/14  KRIS CUMMINGS        $127438 ('$' IN COL 73,         *
      *                                $132418  MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           SUPPORT FOR PACIFIC INCOME ADVANTAGE. - $127438      *
      *           CORRECT BAD ADDRESS LOGIC TO STILL    - $132418      *
      *           CREATE ELECTRONIC STATEMENTS.                        *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 12/05/14  KRIS CUMMINGS        $141012 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PIA POLICIES CAN CHANGE RIDER TYPE ON ANNIVERSARY    *
      *           WHICH IS A PROBLEM WHEN LOOKING BACK TO SEE WHAT     *
      *           THE RIDER WAS. LOGIC ADDED TO DETERMINE THE RIDER    *
      *           TYPE (SINGLE OR JOINT) AT THE STATEMENT END DATE.    *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 12/30/14  KRIS CUMMINGS        $142884 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PREVENT DUMP-INS (MA) FROM BEING COUNTED TWICE.      *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/02/15  KRIS CUMMINGS        $144461 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           MAKE SURE 47 RECORDS ARE GENERATED FOR FRONTIERS II  *
      *           AND THAT THE MONEY FUND INFO IS FOR THE CORRECT      *
      *           PERIOD.                                              *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/09/15  KRIS CUMMINGS        $148244 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           MAKE SURE WE ONLY INCLUDE RIDER FEES FOR THE CURRENT *
      *           PERIOD.                                              *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 04/23/15  KRIS CUMMINGS        $148200 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ONLY SHOW THE NEW FUND WHEN AN OEA OCCURS.           *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 07/16/15  DERRICK STEPHENS     $T151266('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *                                                                *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PACIFIC SECURE INCOME                                *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 08/01/15  DERRICK STEPHENS     $T151996('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *                                                                *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PACIFIC INDEX SELECT                                 *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 09/23/15  KRIS CUMMINGS        $164539 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           INITIALIZE THE RECORD 47 SWITCH FOR PIA.             *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/15/15  RIZWAN LATEEF        $T141131('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD CODE TO SKIP FIA - PRODUCER ALLIANCE STATEMENTS. *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 09/21/15  CSC                 $T164045 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           DIMENSIONS IN PA AND NJ                              *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/04/16  DERRICK STEPHENS    $T166969 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           BYPASS EDB RIDER                                     *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 03/15/16  CHRIS TURNER        $T157090 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           INDEX DIMENSIONS                                     *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 06/13/16  CSC                 $T180946 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           SKIPPING THE STATEMENT PROCESSING FOR INDEX EDGE.    *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 07/12/16  CHRIS TURNER        $T182477 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           FRONTIERS - FIX TO 40 AND 50 RECORDS TO PREVENT      *
      *                       AN 'OE' ON ANNIVERSARY FROM SHOWING      *
      *                       ON THE PRIOR YEAR STATEMENT.             *
      *                                                                *
      *                     - ADDED LOGIC FOR TERM RENEWAL.            *
      *                                                                *
      *                     - ADDED LOGIC TO CORRECTLY GENERATE        *
      *                       BACKDATED STATEMENTS.                    *
      *                                                                *
      *                     - ADDED ERROR HANDLING FOR TRANSACTIONS    *
      *                       OCCURRING ON DUPLICATE FUNDS.            *
      *                                                                *
      *                     - ADDED ERROR HANDLING FOR TERMS WHICH     *
      *                       BEGAN DUE TO VALUE ADJUSTMENT 'VA' TRX.  *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 08/15/16  CHRIS TURNER        $T187223 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           PCL & PROVIDER - FIX TO CUSTODIAN-OWNED CONTRACTS    *
      *                            WHICH WERE NOT GENERATING ONLINE    *
      *                            STATEMENTS.                         *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 08/15/16  CHRIS TURNER        $T164136 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           INDEX PRODUCTS - FIX TO 52,53,54 RECORDS TO CORRECT  *
      *                            TERM DATES.                         *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 09/16/16  CHRIS TURNER        $T189473 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           FIX TO 10 RECORD - REMOVED HARD CODED AGENT/AGENCY   *
      *                            - THAT WAS PROMOTED IN ERROR DURING *
      *                              DEV TESTING.                      *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 11/21/16  CHRIS TURNER        $T192586 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           REMOVE DEATH BENEFIT FIELDS FROM INDEX PRODUCTS      *
      *           WHEN CONTRACT IS IN STATUS '2' (POST DEATH BENE      *
      *           CONTINUATION)                                        *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 11/21/16  CHRIS TURNER        $T188012 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD MESSAGES FOR PSD HELD CONTRACTS                  *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 01/07/17  keith elliott        $T193533 '$' IN COL 73,         *
      *                                         MOD ID IN 74-79        *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           ADD email address for owner, ann, and rep            *
      *                                                                *
      * 01/07/17  keith elliott        $T198599 '$' IN COL 73,         *
      *                                         MOD ID IN 74-79        *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           NEW PHONE NUMBER FOR ORPHAN   ACCOUNTS               *
      *                                                                *
      * 03/07/17  keith elliott        $T201007 '$' IN COL 73,         *
      *                                         MOD ID IN 74-79        *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *          add edb rider info                                    *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 02/06/17  DIVYA PANNEER       $T197370 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           SKIPPING THE STATEMENT PROCESSING FOR INDEX ADVISORY *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 05/05/17  SWETA SONI          $T200566 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           SKIPPING THE STATEMENT PROCESSING FOR INDEX          *
      *           FOUNDATION.                                          *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 08/01/17  CHRIS TURNER        $T201018 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           INDEX EDGE STATEMENT                                 *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 06/20/17  REBECCA HUNT        $T212578 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           NEW PAD (DEATH DISTRIBUTION) TRANSACTION             *
      *                                                                *
      *   DATE    PROGRAMMER           MOD ID                          *
      *   ----    ----------           ------                          *
      * 04/19/18  CHRIS TURNER        $T228585 ('$' IN COL 73,         *
      *                                         MOD ID IN 74-79)       *
      *           DESCRIPTION                                          *
      *           -----------                                          *
      *           INDEX STMT FIX - WX TRANSACTIONS SHOWING FROM PRIOR  *
      *                            PRIOR CONTRACT YEAR.                *
      *                                                                *
      ******************************************************************

              EJECT
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
         SOURCE-COMPUTER.   IBM-370.
         OBJECT-COMPUTER.   IBM-370.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
            SELECT ANNL-STMNT-FILE   ASSIGN TO PRNTFILE.
            SELECT EXTRACT-FILE      ASSIGN TO EXTRACT.
            SELECT  CONTROL-FILE     ASSIGN TO DATECARD.
      ***** $W6165C START *****
            SELECT BAD-ADDR-RPT      ASSIGN TO VPBADRPT.
      ***** $W6165C  END  *****
       DATA DIVISION.
       FILE SECTION.

       FD  ANNL-STMNT-FILE
           RECORDING MODE IS F
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS.
       01  ANNL-STMNT.
           05  ANNUAL-LINE          PIC X(1100).

       FD  CONTROL-FILE
           LABEL RECORDS ARE STANDARD
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS.

       01  CONTROL-RECORD                          PIC X(80).
           EJECT

       FD  EXTRACT-FILE
           RECORDING MODE IS V
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS.
       01  EXTRACT-REC.
      ***** $W10612D START *****
      *    05  FILLER                       PIC X(17).
           05  FILLER                       PIC X(14).
           05  EXTRACT-COMPANY              PIC X(03).
      ***** $W10612D  END  *****
           05  EXTRACT-PRODUCT              PIC X(02).
           05  FILLER                       PIC X(15).
           05  EXTRACT-POLICY               PIC X(15).
           05  FILLER                       PIC X(38).
           05  TRANSACTION-DATA.
               10  EXTRACT-TRANS-TYPE       PIC 9(5).
               10  EXTRACT-DATA             PIC X(20380).
      ***** $W6165C START *****
       FD  BAD-ADDR-RPT
           RECORDING MODE IS F
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS.

       01  BAD-ADDR-REC.
           05  BAD-ADDR-CC          PIC X(01).
           05  BAD-ADDR-DATA        PIC X(140).
      ***** $W6165C  END  *****
           EJECT
       WORKING-STORAGE SECTION.

          01 FILLER                         PIC X(50)
                VALUE '*** MODULE VPAFIXST *****'.

       01  W-DYNAMIC-VALUATION         PIC X(08)       VALUE 'LVPADVAL'.
       01  W-SPACES                    PIC X(08)       VALUE SPACES.
       01  W-VALUATION-PROG            PIC X(08)       VALUE 'IUAFIC1 '.

       01  W-LITERALS.
           05  SELIB-LITERAL-35                  PIC X(35)
           VALUE 'Enhanced Lifetime Income - Single  '.
           05  JELIB-LITERAL-35                  PIC X(35)
           VALUE 'Enhanced Lifetime Income - Joint   '.
           05  SIEIB-LITERAL-35                  PIC X(35)
           VALUE 'Interest Enhanced Income - Single  '.
           05  JIEIB-LITERAL-35                  PIC X(35)
           VALUE 'Interest Enhanced Income - Joint   '.
           05  MAX-BANDS                         PIC S9(4) COMP
                                                 VALUE +10.
           05  NINETY-NINE-CENTS                 PIC S9(9)V99 COMP-3
                                                 VALUE 0.99.

       01 PCL-CONVERT-MISC.
             05  WS-PCL-CONTRACT-NO.
                 10  FILLER                      PIC X(14).
                 10  WS-PCL-INDICATOR            PIC X(01).
             05  WS-TEST-DATE.
                 10  WS-TEST-YYYY                PIC 9(04).
                 10  WS-TEST-MM                  PIC 9(02).
                 10  WS-TEST-DD                  PIC 9(02).
       01 AGENT-COPY-FIELDS.
             05  SW-WHERE-LAST-LINE             PIC X(02).
             05  W-AGENT-NAME                   PIC X(53).
             05  W-LAST-LINE                    PIC X(46).
             05  W-AGT-CITY                     PIC X(30).
             05  W-AGT-STATE                    PIC X(03).
             05  W-AGT-ZIP.
                 10  W-AGT-ZIP-PREFIX           PIC X(05).
                 10  W-AGT-ZIP-HYPHEN           PIC X(01).
                 10  W-AGT-ZIP-SUFFIX           PIC X(04).
       01 HOLD-FIELDS.
             05  HOLD-POLICY-STATUS                       PIC X.
             05  HOLD-ORIG-DEP-FILE-CODE
                                                PIC S9(05)  COMP-3.
             05  HOLD-ORIG-DEPOSIT-FILE-CODE    PIC S9(5)   COMP-3.
             05  HOLD-CUST-SERV-PHONE           PIC X(14).
             05  HOLD-REP-CUST-SERV-PHONE       PIC X(14).
             05  HOLD-TERM-PERIOD               PIC 9(3).
             05  HOLD-TERM                       PIC X(24).
             05  HOLD-COMPANY-CODE              PIC X(3).
             05  HOLD-CONTRACT-NO               PIC X(15).
             05  HOLD-AGENT-ID                  PIC X(10).
             05  HOLD-PROD-MNEMONIC             PIC X(10).
             05  HOLD-BROKER-NO                 PIC X(06).
             05  HOLD-FUND-NO                   PIC X(3).
             05  WORK-FUND-NUMBER               PIC 999.
             05  HOLD-TERM-FUND-NUMBER COMP-3 PIC S9(3)V99  VALUE +0.
             05  HOLD-FUND-NUMBER    COMP-3   PIC S9(3)V99  VALUE +0.
                 88  EXPLORER-RENEWAL-FUND                  VALUE +111.
             05  HOLD-PLAN                      PIC X(3).
             05  HOLD-PLAN-TYPE                 PIC X(20).
             05  HOLD-PRODUCT                   PIC X(3).
             05  HOLD-ANNUITANT-COPY            PIC X(3).
             05  HOLD-PERIOD                    PIC 99.
             05  CURRENT-ANNIV-DATE.
                 10  CURRENT-ANNIV-YY         PIC 9(4).
                 10  CURRENT-ANNIV-MM           PIC 9(2).
                 10  CURRENT-ANNIV-DD           PIC 9(2).
             05  HOLD-BEGIN-DATE.
                 10  BEGIN-DATE-CCYY            PIC 9(4).
                 10  BEGIN-DATE-MM              PIC 9(2).
                 10  BEGIN-DATE-DD              PIC 9(2).
             05  HOLD-CDSC-EFF-DATE.
                 10  HOLD-CDSC-EFF-YY          PIC 9(4).
                 10  HOLD-CDSC-EFF-MM          PIC 9(2).
                 10  HOLD-CDSC-EFF-DD          PIC 9(2).
             05  HOLD-END-DATE.
                 10  END-DATE-YEAR.
                     15  END-DATE-CC            PIC 9(2).
                     15  END-DATE-YY            PIC 9(2).
                 10  END-DATE-MM                PIC 9(2).
                 10  END-DATE-DD                PIC 9(2).
             05  HOLD-ISSUE-DATE.
                 10  ISSUE-DATE-YEAR.
                     15  ISSUE-DATE-CC          PIC 9(2).
                     15  ISSUE-DATE-YY          PIC 9(2).
                 10  ISSUE-DATE-MM              PIC X(2).
                 10  ISSUE-DATE-DD              PIC X(2).
             05  HOLD-VAL-BEGIN-DATE.
                 10  VAL-BEGIN-DATE-CCYY            PIC 9(4).
                 10  VAL-BEGIN-DATE-MM              PIC 9(2).
                 10  VAL-BEGIN-DATE-DD              PIC 9(2).
             05  HOLD-VAL-END-DATE.
                 10  VAL-END-DATE-CCYY              PIC 9(4).
                 10  VAL-END-DATE-MM                PIC 9(2).
                 10  VAL-END-DATE-DD                PIC 9(2).
             05  TRX-BEGIN-DATE.
                 10  TRX-BEGIN-DATE-CCYY          PIC 9(4).
                 10  TRX-BEGIN-DATE-MM              PIC 9(2).
                 10  TRX-BEGIN-DATE-DD              PIC 9(2).
             05  TRX-END-DATE.
                 10  TRX-END-DATE-CCYY              PIC 9(4).
                 10  TRX-END-DATE-MM                PIC 9(2).
                 10  TRX-END-DATE-DD                PIC 9(2).
             05  TRX-PRIOR-YEAR.
                 10  TRX-PRIOR-YR-CCYY              PIC 9(4).
                 10  TRX-PRIOR-YR-MM                PIC 9(2).
                 10  TRX-PRIOR-YR-DD                PIC 9(2).
             05  WORK-LAST-RENEW-DATE.
                 10  WORK-LAST-RENEW-YYYY     PIC 9(4).
                 10  WORK-LAST-RENEW-MM       PIC 9(2).
                 10  WORK-LAST-RENEW-DD       PIC 9(2).
             05  WORK-NEXT-RENEW-DATE.
                 10  WORK-NEXT-RENEW-YYYY     PIC 9(4).
                 10  WORK-NEXT-RENEW-MM       PIC 9(2).
                 10  WORK-NEXT-RENEW-DD       PIC 9(2).
             05  HOLD-LAST-RENEW-DATE.
                 10  HOLD-LAST-RENEW-YYYY     PIC 9(4).
                 10  HOLD-LAST-RENEW-MM       PIC 9(2).
                 10  HOLD-LAST-RENEW-DD       PIC 9(2).
             05  HOLD-NEXT-RENEW-DATE.
                 10  HOLD-NEXT-RENEW-YYYY     PIC 9(4).
                 10  HOLD-NEXT-RENEW-MM       PIC 9(2).
                 10  HOLD-NEXT-RENEW-DD       PIC 9(2).
             05  ORIG-EFFECTIVE-DATE            PIC 9(8).
             05  ORIG-EFFECTIVE-DAYS-1900       PIC S9(5) COMP-3.
             05  END-DATE-YR                    PIC 9(4).
             05  ISSUE-DATE-YR                  PIC 9(4).
             05  HOLD-PERCENT-YEAR              PIC 9(2).
             05  HOLD-STATUS                    PIC X(03).
             05  HOLD-PROD-NAME                 PIC X(40).
             05  HOLD-MA-DUMPIN                 PIC  9(12)V99.
             05  HOLD-INITIAL-PAYMENT           PIC  9(12)V99.
             05  HOLD-ADD-PAYMENT               PIC  9(12)V99.
             05  HOLD-1STYR-ADD-PAYMENT         PIC  9(12)V99.
             05  HOLD-1STYR-FRNTRII-ADD-PAYMENT PIC  9(12)V99.
             05  HOLD-FRNTRII-ADD-PAYMENT       PIC  9(12)V99.
             05  HOLD-CREDIT-ENHANCEMENT        PIC  9(12)V99.
             05  HOLD-BEG-ACCOUNT-VALUE         PIC S9(09)V99.
             05  HOLD-END-ACCOUNT-VALUE         PIC S9(09)V99.
             05  HOLD-SURR-PROC-DATE            PIC X(08).
             05  HOLD-SURR-EFF-DATE             PIC X(08).
             05  HOLD-VALUATION-DATE            PIC X(08).
             05  HOLD-FIXED-FUND                PIC 9(03).
             05  SUB-TOTAL-VALUE                PIC S9(09)V99.
             05  HOLD-INTEREST-EARNED           PIC S9(09)V99.
             05  ONE-DAY-INT                    PIC S9(09)V99.
             05  HOLD-FIA-INTEREST              PIC S9(12)V99 VALUE +0.
             05  HOLD-FIA-WITHDRAW              PIC S9(12)V99 VALUE +0.
             05  HOLD-FIA-WDCHARGE              PIC S9(12)V99 VALUE +0.
             05  TOTAL-POL-WD-CHARGE   PIC S9(09)V99 VALUE ZERO.
             05  TOTAL-GROSS-WITHDRAWALS        PIC S9(09)V99.
             05  FINAL-WITHDRAWALS              PIC S9(09)V99.
             05  HOLD-TOTAL-CASH-VALUE          PIC S9(09)V99.
             05  HOLD-SURRENDER-PENALTY-AMT     PIC S9(11)V99.
             05  SAVE-SURRENDER-PENALTY-AMT     PIC S9(11)V99.
             05  SAVE-TEFRA-WITHHOLDING-AMT     PIC S9(09)V99.
             05  SAVE-STATE-WITHHOLDING-AMT     PIC S9(09)V99.
             05  SAVE-FULL-SURR-CHECK-AMT       PIC S9(11)V99.
             05  SAVE-MIN-SURRENDER-BENEFIT     PIC S9(11)V99.
             05  SAVE-ACCOUNT-VALUE             PIC S9(11)V99.
             05  HOLD-TOTAL-MVA-AMOUNT          PIC S9(12)V99.
             05  HOLD-MVA-AMOUNT                PIC S9(12)V99.
             05  CURRENT-SURRENDER-PERCENT      PIC S9(12)V99.
             05  HOLD-STMT-BEG-BAL              PIC S9(12)V99.
             05  EXPLORER-CONTRACT-SW          PIC X     VALUE SPACE.
                 88 EXPLORER-CONTRACT                     VALUE 'Y'.
             05  PROVIDER-CONTRACT-SW          PIC X     VALUE SPACE.
                 88 PROVIDER-CONTRACT                     VALUE 'Y'.
             05  FRONTIERS-II-CONTRACT-SW     PIC X     VALUE SPACE.
                 88 FRONTIERS-II-CONTRACT                VALUE 'Y'.
             05  WK-TERMINATED-SW             PIC X     VALUE SPACE.
                 88 WK-TERMINATED                        VALUE 'Y'.
             05  POLICY-ACTIVE-SW              PIC X     VALUE SPACE.
                 88 POLICY-ACTIVE                         VALUE 'Y'.
                 88 POLICY-NOT-ACTIVE                     VALUE 'N'.
             05  MFUND-SEGMENT-FOUND-FLAG PIC X     VALUE SPACE.
                 88 MFUND-SEGMENT-NOT-FOUND         VALUE 'N'.
             05  FUND-CHANGED-SW          PIC X     VALUE SPACE.
                 88 FUND-CHANGED                     VALUE 'Y'.
             05  TERM-FUND-MATCHED-SW          PIC X     VALUE SPACE.
                 88 TERM-FUND-MATCHED                     VALUE 'Y'.
             05  PCL-CONTRACT-SW        PIC X     VALUE SPACE.
                 88 PCL-CONTRACT                VALUE 'Y'.
             05  FRONTIERS-CONTRACT-SW       PIC X     VALUE SPACE.
                 88 FRONTIERS-CONTRACT               VALUE 'Y'.
             05  FIA-CONTRACT-SW             PIC X     VALUE SPACE.
                 88 FIA-CONTRACT                     VALUE 'Y'.
             05  FIA-PA-CONTRACT-SW          PIC X     VALUE SPACE.
                 88 FIA-PA-CONTRACT                  VALUE 'Y'.
             05  FIA-INDEX-EDGE-SW           PIC X     VALUE SPACE.
                 88 FIA-INDEX-EDGE-CONTRACT          VALUE 'Y'.
             05  FIA-INDEX-ADVISORY-SW       PIC X     VALUE SPACE.
                 88 FIA-INDEX-ADVISORY-CONTRACT      VALUE 'Y'.
             05  INDEX-FOUNDATION-SW         PIC X     VALUE SPACE.
                 88 INDEX-FOUNDATION-CONTRACT        VALUE 'Y'.
             05  EXPEDITION-CONTRACT-SW      PIC X     VALUE SPACE.
                 88 EXPEDITION-CONTRACT              VALUE 'Y'.
             05  MARINER-CONTRACT-SW         PIC X     VALUE SPACE.
                 88 MARINER-CONTRACT                 VALUE 'Y'.
             05  PIA-CONTRACT-SW             PIC X     VALUE SPACE.
                 88 PIA-CONTRACT                     VALUE 'Y'.
             05  ACTIVE-MONEY-FUND-SW          PIC X     VALUE SPACE.
                 88 ACTIVE-MONEY-FUND                     VALUE 'Y'.
             05  WS-MATCH-FOUND-SW             PIC X     VALUE SPACE.
                 88 WS-MATCH-FOUND                        VALUE 'Y'.
             05  VALUATION-DATE-SWITCH          PIC X     VALUE SPACE.
                 88 BEGIN-DATE                            VALUE 'B'.
                 88 END-DATE                              VALUE 'E'.
             05  FIRST-ANI-SWITCH               PIC X     VALUE 'Y'.
                 88 FIRST-ANI                             VALUE 'Y'.
                 88 NOT-FIRST-ANI                         VALUE 'N'.
             05  FULL-SURRENDER-SWITCH          PIC X     VALUE 'N'.
                 88 FULL-SURRENDER-FOUND                  VALUE 'Y'.
             05  GET-THIS-SWITCH               PIC X     VALUE 'Y'.
                 88 GET-THIS-POLICY                       VALUE 'Y'.
                 88 DONT-GET-THIS-POLICY                  VALUE 'N'.
             05  PRINT-SWITCH                   PIC X     VALUE 'Y'.
                 88 YES-PRINT                             VALUE 'Y'.
                 88 NO-PRINT                              VALUE 'N'.
             05  GET-VALUES-SW                  PIC X     VALUE ' '.
                 88 GET-VALUES                            VALUE 'Y'.
             05  GET-FUND-VALUES-SW             PIC X     VALUE ' '.
                 88 GET-FUND-VALUES                       VALUE 'Y'.
             05  MOST-RECENT-TRX-SW             PIC X     VALUE ' '.
                 88 MOST-RECENT-TRX                       VALUE 'Y'.
             05  SW-RIDERS-ON-POLICY-SW         PIC X(01) VALUE SPACE.
                 88  SW-RIDERS-ON-POLICY                  VALUE 'Y'.
             05  SW-END-OF-RIDERS-SW            PIC X(01) VALUE SPACE.
                 88  SW-END-OF-RIDERS                     VALUE 'Y'.
             05  SW-ACTIVE-RIDERS-SW            PIC X(01) VALUE SPACE.
                 88  SW-ACTIVE-RIDER-FOUND                VALUE 'Y'.
             05  SW-DATE-SEARCH-COMPLETE-SW     PIC X(01) VALUE SPACE.
                 88  SW-DATE-SEARCH-COMPLETE              VALUE 'Y'.
             05  SW-END-OF-TRX-FUNDS-SW         PIC X(01) VALUE SPACE.
                 88  SW-END-OF-TRX-FUNDS                  VALUE 'Y'.
             05  SW-USE-GTE-100K-BAND-SW        PIC X(01) VALUE SPACE.
                 88  SW-USE-GTE-100K-BAND                 VALUE 'Y'.
             05  SW-END-OF-TRXHIST-SW           PIC X(01) VALUE SPACE.
                 88  SW-END-OF-TRXHIST                    VALUE 'Y'.
             05  SW-CONT-THIS-ANNIV-YR-SW       PIC X(01) VALUE SPACE.
                 88  SW-CONT-THIS-ANNIV-DUR               VALUE 'D'.
                 88  SW-CONT-THIS-ANNIV-AFT               VALUE 'A'.
             05  SW-CONTRACT-DEATH-STATUS-SW    PIC X(01) VALUE SPACE.
                 88  SW-CONTRACT-DEATH-STATUS             VALUE 'Y'.
             05  SW-ONLY-2YR-MONEY-SW           PIC X(01) VALUE SPACE.
                 88  SW-ONLY-2YR-MONEY                    VALUE 'Y'.
             05  SW-NO-OTHER-FUNDS-AVAIL-SW     PIC X(01) VALUE SPACE.
                 88  SW-NO-OTHER-FUNDS-AVAIL              VALUE 'Y'.
             05  SW-FUND-IN-USE-SW              PIC X(01) VALUE SPACE.
                 88  SW-FUND-IN-USE                       VALUE 'Y'.
             05  SW-END-OF-BENEFICIARIES-SW     PIC X(01) VALUE SPACE.
                 88  SW-END-OF-BENEFICIARIES              VALUE 'Y'.
             05  SW-PRODUCE-FII-REC-47-SW       PIC X(01) VALUE SPACE.
                 88  SW-PRODUCE-FII-REC-47                VALUE 'Y'.
             05  SW-MONEY-FUND-FOUND-SW         PIC X(01) VALUE SPACE.
                 88  SW-MONEY-FUND-FOUND                  VALUE 'Y'.
             05  SW-END-OF-MONYFND-SW           PIC X(01) VALUE SPACE.
                 88  SW-END-OF-MONYFND                    VALUE 'Y'.
             05  ERROR-CODE-HOLD.
                 10  SYSTEM-ERROR-FIELD        PIC X      VALUE SPACE.
                     88 SYSTEM-ERROR                      VALUE 'S'.
                 10  ERROR-FIELD               PIC X(3)   VALUE SPACE.
             05 HOLD-CUR-INTEREST-RATE         PIC SV9(5).
             05 HOLD-PRIOR-INTEREST-RATE         PIC SV9(5).
             05  HOLD-TERM-BEGIN-DATE.
                 10  BEGIN-DATE-YYYY            PIC X(4).
                 10  BEGIN-DATE-MM              PIC X(2).
                 10  BEGIN-DATE-DD              PIC X(2).
             05  SURTBL-SUB         PIC 9(3)      VALUE 0.
             05  WS-AV-SUB          PIC 9(3)      VALUE 0.
             05  WS-FUND-SUB        PIC 9(3)      VALUE 0.
             05  WS-SUB             PIC 9(3)      VALUE 0.
             05  BEG-SUB            PIC 9(3)      VALUE 0.
             05  END-SUB            PIC 9(3)      VALUE 0.
             05  SUBB               PIC S9(4) COMP.
             05  SUBC               PIC S9(4) COMP.
             05  SUBE               PIC S9(4) COMP.
             05  SUBF               PIC S9(4) COMP.
             05  SUBH               PIC S9(4) COMP.
             05  SUBN               PIC S9(4) COMP.
             05  SUBS               PIC S9(4) COMP.
             05  SUBT               PIC S9(4) COMP.
             05  SUBW               PIC S9(4) COMP.
             05  SUBX               PIC S9(4) COMP.
             05  SUBY               PIC S9(4) COMP.
             05  SUBV               PIC S9(4) COMP.
             05  SUB2                         PIC S9(4) COMP.
             05  WS-POL-FUND-SUB        PIC 9(3)      VALUE 0.
             05  TERM-SUB             PIC 9(3)      VALUE 0.
             05  NEXT-TERM-SUB        PIC 9(3)      VALUE 0.
             05  PREV-TERM-SUB        PIC 9(3)      VALUE 0.
             05  FUND-TOTAL-SUB      PIC 9(3)      VALUE 0.
             05  WS-MAIL-BARCODE         PIC X(14).
             05  RPT-LINE-COUNT               PIC S9(7) COMP-3.
             05  SW-EXPLORER-SKIP-SW          PIC X(01).
                 88  SW-EXPLORER-SKIP                   VALUE 'Y'.
             05  WK-HOLD-RIDER-KEY            PIC X(87).
             05  WK-GROSS-CHECK-AMOUNT        PIC S9(12)V99.
             05  WK-FIXED-GTE-100K            PIC S9(03)V9(02) COMP-3.
             05  WK-HOLD-BEG-WD-VALUE         PIC S9(12)V99.
             05  WK-HOLD-END-WD-VALUE         PIC S9(12)V99.
             05  WK-NET-NON-GMSV-AMOUNT       PIC S9(12)V99.
             05  WK-ANNIVERSARY-VALUE         PIC S9(12)V99.
             05  WK-TOTAL-WITHDRAWALS         PIC S9(12)V99.
             05  WK-GMWB-PAYBASE              PIC S9(12)V99.
             05  WK-DATE-SEARCH-TYPE          PIC X(01).
             05  WK-FUND-NUMBER-WORK          PIC 9(03).
             05  WK-FUND-TYPE-IND-WORK        PIC X(01).
             05  WK-FUND-NAME-SHORT           PIC X(16).
             05  WK-FUND-NAME-LONG            PIC X(30).
             05  WK-ENDING-PRICE              PIC S9(07)V99.
             05  WK-INDEX-GROWTH              PIC S9(03)V99.
             05  WK-INDEX-CREDITED-RATE       PIC S9(03)V99.
             05  WK-INDEX-PCT                 PIC S9V9(9) COMP-3.
             05  WK-STMT-MVA-AMT              PIC S9(9)V99 COMP-3.
             05  WK-BEG-DAYS-1900             PIC S9(05) COMP-3.
             05  WK-END-DAYS-1900             PIC S9(05) COMP-3.
             05  WK-YEAR-IN-DAYS              PIC S9(3)V9(6)  COMP-3.
             05  WK-BAND-AMOUNT               PIC S9(9)V99 COMP-3.
             05  WK-TOTAL-PREMIUM             PIC S9(9)V99 COMP-3.
             05  WK-BAND-PREMIUM              PIC S9(9)V99 COMP-3.
             05  WK-EXPEDITION-PERIOD         PIC S9(5) COMP-3.
             05  WK-CURR-DECL-RATE            PIC S9(2)V9(03) COMP-3.
             05  WK-NEW-GUAR-RATE             PIC S9(2)V9(03) COMP-3.
             05  WK-WITHD-WITHDRWL-CHRGS      PIC S9(9)V99 COMP-3.
             05  WK-WITHD-MVA                 PIC S9(9)V99 COMP-3.
             05  WK-WITHD-MIN-SURRENDER       PIC S9(9)V99 COMP-3.
             05  WK-HOLD-FORCED-RATE          PIC S9(2)V9(3) COMP-3.
             05  WK-HOLD-NEW-RATE             PIC S9(2)V9(3) COMP-3.
             05  WK-FUND-TERM                 PIC 9(3).
             05  WK-BEG-DATE.
                 10  WK-BEG-DATE-YYYY         PIC 9(04).
                 10  WK-BEG-DATE-MM           PIC 9(02).
                 10  WK-BEG-DATE-DD           PIC 9(02).
             05  WK-END-DATE.
                 10  WK-END-DATE-YYYY         PIC 9(04).
                 10  WK-END-DATE-MM           PIC 9(02).
                 10  WK-END-DATE-DD           PIC 9(02).
             05  WK-HOLD-90-DAYS-DATE.
                 10  WK-HOLD-90-DAYS-YYYY     PIC 9(04).
                 10  WK-HOLD-90-DAYS-MM       PIC 9(02).
                 10  WK-HOLD-90-DAYS-DD       PIC 9(02).
             05  WK-HOLD-RENEWAL-DATE.
                 10  WK-HOLD-RENEWAL-YYYY     PIC 9(04).
                 10  WK-HOLD-RENEWAL-MM       PIC 9(02).
                 10  WK-HOLD-RENEWAL-DD       PIC 9(02).
             05  WK-HOLD-RA-ACT-DATE-1.
                 10  WK-HOLD-RA-1-YYYY        PIC 9(04).
                 10  WK-HOLD-RA-1-MM          PIC 9(02).
                 10  WK-HOLD-RA-1-DD          PIC 9(02).
             05  WK-HOLD-NEXT-ANNIV-DATE.
                 10  WK-HOLD-NEXT-ANNIV-YYYY  PIC 9(04).
                 10  WK-HOLD-NEXT-ANNIV-MM    PIC 9(02).
                 10  WK-HOLD-NEXT-ANNIV-DD    PIC 9(02).
             05  WK-HOLD-GUAR-END-DATE.
                 10  WK-HOLD-GUAR-END-YYYY    PIC 9(04).
                 10  WK-HOLD-GUAR-END-MM      PIC 9(02).
                 10  WK-HOLD-GUAR-END-DD      PIC 9(02).
             05  WK-HOLD-RA-ACTIVATION-DATE.
                 10  WK-HOLD-RA-ACTIVATION-YYYY PIC 9(04).
                 10  WK-HOLD-RA-ACTIVATION-MM   PIC 9(02).
                 10  WK-HOLD-RA-ACTIVATION-DD   PIC 9(02).
             05  WK-CAP-RATE                  PIC S9V9(9)     COMP-3.
             05  WK-TRX-CODE                  PIC X(04).
             05  WK-RIDER-NAME                PIC X(35).
             05  WK-RENEWAL-DATE              PIC X(08).
             05  WK-RATE-TYPE                 PIC X(01).
             05  WK-RETURN-CODE               PIC X(04).
             05  WK-RNWL-SUB                  PIC 9(04) VALUE ZERO.
             05  WK-DUPL-TRANSFER-AMT         PIC S9(12)V99.
             05  HOLD-ROLE-EMAIL-SEQ         PIC 9(04).
             05  HOLD-ROLE-EMAIL             PIC X(60).

       01  FIA-OEM-TRNSFER-FOUND              PIC X.

       01  FIA-FUND-ARRAY.
           05  FIA-FUND-ENTRY OCCURS 30 TIMES.
      *    05  FIA-FUND-ENTRY OCCURS 10 TIMES.                  $T157090
               10  FIA-FUND-NUMBER            PIC S9(03).
               10  FIA-FUND-TYPE              PIC  X(01).
               10  FIA-FUND-BEGIN-VALUE       PIC S9(12)V99.
               10  FIA-FUND-PREMIUM           PIC S9(12)V99.
               10  FIA-FUND-ADDON             PIC S9(12)V99.
               10  FIA-FUND-EXTRA-CREDIT      PIC S9(12)V99.
               10  FIA-FUND-WITHDRAWALS       PIC S9(12)V99.
               10  FIA-FUND-RIDER-FEES        PIC S9(12)V99.
               10  FIA-FUND-INTEREST          PIC S9(12)V99.
               10  FIA-FUND-TRANSFER-IN-OUT   PIC S9(12)V99.
               10  FIA-FUND-ENDING-VALUE      PIC S9(12)V99.
               10  FIA-FUND-STARTING-PRICE    PIC S9(07)V99.
               10  FIA-FUND-ENDING-PRICE      PIC S9(07)V99.
               10  FIA-FUND-INDEX-CHANGE      PIC S9(03)V99.
               10  FIA-FUND-GUAR-RATE         PIC S9(03)V99.
               10  FIA-FUND-RATE-CREDITED     PIC S9(03)V99.
               10  FIA-FUND-MVA               PIC S9(03)V99.

       01  RATE-ADVANTAGE-WORK-AREA.
           05  RATE-ADVANTAGE-TRANSACTIONS OCCURS 50 TIMES.
               10  RA-EFFECTIVE-DATE.
                   15  RA-EFFECTIVE-YYYY      PIC 9(04).
                   15  RA-EFFECTIVE-MM        PIC 9(02).
                   15  RA-EFFECTIVE-DD        PIC 9(02).
               10  RA-PAYMENT-AMOUNT          PIC S9(9)V99 COMP-3.
               10  RA-PAYMENT-TYPE            PIC X(04).
               10  RA-RATE-PCT                PIC S9(03)V99 COMP-3.
               10  RA-ENHANCE-DATE.
                   15  RA-ENHANCE-YYYY        PIC 9(04).
                   15  RA-ENHANCE-MM          PIC 9(02).
                   15  RA-ENHANCE-DD          PIC 9(02).
               10  RA-RATE-PCT-AFTER          PIC S9(03)V99 COMP-3.

       01  SAVE-KEYS.
           05 SAVE-BENE-KEY.
              10  SAVE-KEY-AREA.
                  15  SAVE-COMPANY-CDE          PIC X(03).
                  15  SAVE-MASTER-ID            PIC X(15).
                  15  SAVE-PARM-SEG-ID-AND-SEQ.
                      20  SAVE-PARM-SEG-ID      PIC S9(04) COMP.
                      20  SAVE-PARM-SEG-SEQ-NUM PIC S9(07) COMP-3.
              10  HEADER-AREA                   PIC X(63).

       01  WK-BENEFICIARIES.
           05  SW-ELEMENT-INSERTED-SW         PIC X(01).
               88  SW-ELEMENT-INSERTED                  VALUE 'Y'.
           05  WK-BENE-COUNT                  PIC S9(4) COMP.
           05  WK-BENEFICIARY-DATA OCCURS 50 TIMES.
               10  WK-BENE-TYPE               PIC X(01).
               10  WK-BENE-PCT                PIC S9(3)V99 COMP-3.
               10  WK-BENE-NAME               PIC X(80).

       01 DATE-CCYYMMDD.
             05 DATE-CENTURY-YEAR.
                10 DATE-CC                     PIC 9(2).
                10 DATE-YY                     PIC 9(2).
             05 DATE-CCYY
                REDEFINES DATE-CENTURY-YEAR    PIC 9(4).
             05 DATE-MM                        PIC 9(2).
             05 DATE-DD                        PIC 9(2).

       01 EARNINGS-AVAILABLE                 PIC S9(12)V99.

       01 SWITCHES.
             05 EOF-SWITCH                      PIC X       VALUE 'N'.
                88 EOF                                      VALUE 'Y'.

       01 FILLER                             PIC X.
             88 W-GET-FIRST-MONYFND                         VALUE 'F'.
             88 W-GET-NEXT-MONYFND                          VALUE 'N'.
       01 FILLER                             PIC X.
             88 W-GET-FIRST-TRXHIST                         VALUE 'F'.
             88 W-GET-NEXT-TRXHIST                          VALUE 'N'.
       01 FILLER.
             05 7RECORD-CODES                   PIC 9(5).
                88 POLICY-SPECS-REC              VALUE 10000.
                88 OWNER-MAIL-REC                VALUE 10001.
                88 PAYOR-MAIL-REC                VALUE 10002.
                88 POLICY-VALUES-RECS            VALUE 20000.
                88 LOAN-INFORMATION-REC          VALUE 30000.
                88 INTEREST-RATES-RECS           VALUE 40100 THRU 42000.
                88 RB-INFO-RECS                  VALUE 51000 THRU 55000.
                88 FIN-ACTVY-RECS                VALUE 60100 THRU 62390.
                88 GRAND-SUMMARY-RECS            VALUE 69999.
             05 CURRENT-PERCENT                PIC 9(2)V9   VALUE 34.
             05 SUB1                           PIC 9(4)     VALUE 0.
             05 SUBA                           PIC 9(4)     VALUE 1.
             05 SUBR                           PIC 9(4)     VALUE 1.
             05 W-SUB                          PIC 9(4)     VALUE 1.
             05 PD-SUB                         PIC 9(4)     VALUE 0.
             05 TRANS-DATE.
                10  TRANS-DATE-CC              PIC 9(2).
                10  TRANS-DATE-YY              PIC 9(2).
                10  TRANS-DATE-MM              PIC 9(2).
                10  TRANS-DATE-DD              PIC 9(2).


                                                                   EJECT
                                                                 SKIP3
       01  ACCUMULATION-FIELDS.
              05  WK-POLICY-VALUE     COMP-3   PIC S9(12)V99 VALUE +0.
              05  TOTAL-PREMIUMS      COMP-3   PIC S9(12)V99 VALUE +0.
              05  HOLD-CLAIM-AMT      COMP-3   PIC S9(12)V99 VALUE +0.
              05  TOTAL-CLAIMS        COMP-3   PIC S9(12)V99 VALUE +0.
              05  FIA-TOTAL-CLAIMS    COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-TAX        COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-FEES       COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-WD-CHARGES       COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-MVA        COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-INTEREST   COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-WITHDRAW    COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-RECORDS    COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-TOTAL-STATEMENTS COMP-3   PIC S9(12)V99 VALUE +0.
              05  HOLD-FUND-CLAIM-AMT COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-TOTAL-TAX   COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-PENALTY     COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-WD-CHARGES  COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-CLAIMS      COMP-3   PIC S9(12)V99 VALUE +0.
              05  HOLD-TRANSFER-AMT   COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-FUND-TOTAL-MVA   COMP-3   PIC S9(12)V99 VALUE +0.
              05  WK-HOLD-POLICY-WITHDRAW      PIC S9(12)V99 COMP-3.

       01  RETURNED-REMOVED-AMOUNT  PIC S9(12)V99      COMP-3
                                                              VALUE +0.

      *01  WS-FUND-TOT-TABLE.
      *    03 WS-FUND-TOT-ENTRIES   OCCURS 20 TIMES.


       01  WS-FILE-ADDRESS.
           05  WS-FILE-ADDRESS-LINES.
               10  WS-FILE-ADDRESS-LINE PIC X(35)      OCCURS 6
                                         INDEXED WS-FAL-DX.
          01 FINALIST-OUTPUT.
             05 OUT-FINL-CITY                  PIC X(13).
             05 OUT-FINL-STATE                 PIC X(02).
             05 OUT-FINL-CR-RTE                PIC X(05).
             05 OUT-FINL-BARCODE.
                10  OUT-BARCODE-START          PIC X.
                10  OUT-ZIPCODE-BARCODE.
                    15  OUT-BARCODE-ZIP        PIC X(05).
                    15  OUT-BARCODE-ZIP4       PIC X(04).
                    15  OUT-BARCODE-WSEQ       PIC X(02).
                    15  OUT-BARCODE-CHKD       PIC X(01).
                10  OUT-BARCODE-END            PIC X.
             05 OUT-FINL-ADDRESSES.
                10 OUT-FINL-ADDR1              PIC X(40).
                10 OUT-FINL-ADDR2              PIC X(40).
                10 OUT-FINL-ADDR3              PIC X(40).
             05 OUT-FINL-REASON-CD             PIC X(8).
             05 OUT-FINL-RETCD1                PIC X.

       01 NAME-AREA.
             05 NAME-LAST                      PIC X(35).
             05 NAME-FIRST                     PIC X(45).
             05 NAME-OUT                       PIC X(80).

        01 ADDRESS-AREA.
           05 CITY                             PIC X(30).
           05 STATE                            PIC X(03).
           05 ZIP9.
              10  ZIP5                         PIC X(5).
              10  ZIP4                         PIC X(4).
           05 ADDRESS-OUT                      PIC X(46).

        01 ZIP.
           05 ZIP-OUT5                         PIC X(5).
           05 ZIP-HYPHEN                       PIC X.
           05 ZIP-OUT4                         PIC X(4).

        01 INDEPENDENT-FIELDS.
           05  DUMMY-REC                       PIC X(15).
           05  DUMMY-PARM                      PIC X.
           05  FILE-CLOSE-ERROR                PIC S9(7) COMP
                                                 VALUE +007.
           05  FILE-OPEN-ERROR                 PIC S9(7) COMP
                                                 VALUE +008.
           05  W-MAX-REPORT-LINES              PIC  S9(8) COMP
                                                 VALUE +0.
           05  WS-BLANK                        PIC X(2) VALUE SPACE.

        01 ERROR-CODES.
           05  POLICY-NOT-FOUND                PIC X(4) VALUE 'A424'.
           05  NAME-ADDR-NOT-FOUND             PIC X(4) VALUE 'D051'.
           05  RATE-SEGMENT-NOT-FOUND          PIC X(04) VALUE 'FIA1'.
           05  NAME-ADDR-READ-ERR              PIC X(4) VALUE 'S051'.
           05  CONTRACT-READ-ERR               PIC X(4) VALUE 'S024'.

              EJECT


011700 01  W-CURRENT-DATE.
011800     05  W-YY                            PIC X(02).
011900     05  W-MM                            PIC X(02).
012000     05  W-DD                            PIC X(02).
012100 01  WORK-TOTALS.
012200     05  AV-TOTAL                        PIC 9(11)V99.
012300     05  COUNT-TOTAL                     PIC 9(6).
012300     05  WORK-YEAR                       PIC 9(4).
013300
013800 01  WORK-CONTROL-RECORD.
           05  FILLER                          PIC X(3).
013900     05  WK-CONTROL-DATE.
014100         10  WK-CONTROL-MM               PIC 99.
014200         10  WK-CONTROL-DD               PIC 99.
014000         10  WK-CONTROL-YY               PIC 9(04).
015240
014400 01  WK-VALUATION-DATE.
014500     05  WK-VALUATION-YY                 PIC 9(04).
014600     05  WK-VALUATION-MM                 PIC 99.
014700     05  WK-VALUATION-DD                 PIC 99.

015300 01  DUMMY-AREA-1                        PIC X(01).
015400 01  DUMMY-AREA-2                        PIC X(01).
015500 01  DUMMY-AREA-3                        PIC X(01).
015700 01  LOGICAL-KEY                         PIC X(200) VALUE SPACES.
015800 01  LOGICAL-RECORD                     PIC X(8000) VALUE SPACES.
      ***** $W6165C START *****
       01  BAD-ADDR-LINE.
           05  BAD-ADDR-POLICY-NUMBER         PIC X(15).
           05  FILLER                         PIC X(01) VALUE SPACE.
           05  BAD-ADDR-SSN                   PIC X(15).
           05  FILLER                         PIC X(01) VALUE SPACE.
           05  BAD-ADDR-NAME                  PIC X(60).
           05  FILLER                         PIC X(01) VALUE SPACE.
           05  BAD-ADDR-MESSAGE               PIC X(57).
      ***** $W6165C  END  *****
015900
016000 01  SCHEDULE-SEG-KEY-QUALIFIER.
016100     05  FILLER                          PIC X(05).
016200     05  SCHEDULE-SEG-CONTRACT           PIC X(10).
016300
016400 01  POLICY-SEG-SUPERIOR-NO              PIC X(15).
016500
016600 01  FULL-SCHED-SEG-KEY                  PIC X(87).
016700
016800 01  FULL-POLICY-SEG-KEY                 PIC X(87).
016900
       01  FUND-SEG-KEY                PIC X(87).
017600 01  SWITCHES.
           05 END-OF-EXTRACT-SWITCH            PIC X  VALUE 'N'.
               88 END-OF-EXTRACT                      VALUE 'Y'.
017700     05  SCHEDULE-SWITCH                 PIC X.
017800         88  FIRST-SCHEDULE                     VALUE 'Y'.
017900         88  END-OF-SCHEDULE                    VALUE 'E'.
018000     05  COMPANY-SWITCH                  PIC X.
018100         88  FIRST-COMPANY                      VALUE 'Y'.
018200         88  END-OF-COMPANIES                   VALUE 'E'.
018300     05  EOF-CARD-SWITCH                 PIC X.
018400         88  EOF-CARD-FILE                      VALUE 'Y'.
018300     05  END-OF-FUNDS-SW                 PIC X.
018400         88  END-OF-FUNDS                       VALUE 'Y'.
018300     05  END-OF-BEG-FUNDS-SW             PIC X.
018400         88  END-OF-BEG-FUNDS                   VALUE 'Y'.
018300     05  END-OF-END-FUNDS-SW             PIC X.
018400         88  END-OF-END-FUNDS                   VALUE 'Y'.
018500     05  DROP-POLICY-SWITCH              PIC X.
018600         88  DROP-POLICY                        VALUE 'Y'.
018700         88  NOT-DROP-POLICY                    VALUE ' '.
018800     05  ERROR-SW                        PIC X.
018900         88  ERROR-FOUND                        VALUE 'Y'.
018800     05  FUND-SW                         PIC X.
018900         88  FUND-FOUND                         VALUE 'Y'.
018800     05  PLAN-SW                         PIC X.
018900         88  PLAN-FOUND                         VALUE 'Y'.
019000     05  TRX-PROCESSING-COMPLETE-SW      PIC X  VALUE ' '.
019100         88 TRX-PROCESSING-COMPLETE             VALUE 'Y'.
019200     05  DSS-PROCESSING-COMPLETE-SW      PIC X  VALUE ' '.
019300         88 DSS-PROCESSING-COMPLETE             VALUE 'Y'.
           05  FIRST-TIME-MONEY-FUND-FLAG      PIC X.
               88  FIRST-TIME-MONEY-FUND              VALUE 'Y'.
               88  NOT-FIRST-TIME-MONEY-FUND          VALUE 'N'.
           05  GENERATE-REC-45-SW              PIC X.
               88  GENERATE-REC-45                   VALUE 'Y'.
           05  GENERATE-REC-46-SW              PIC X.
               88  GENERATE-REC-46                   VALUE 'Y'.
           05  GENERATE-REC-47-SW              PIC X.
               88  GENERATE-REC-47                   VALUE 'Y'.
           05  END-OF-TRXHIST-SW               PIC X.
               88  END-OF-TRXHIST                    VALUE 'Y'.
           05  END-OF-DAY-TRXS-SW             PIC X.
               88  END-OF-DAY-TRXS                   VALUE 'Y'.
019400
020400 01  NOT-FOUND-SW                        PIC X.
020500
020600 01  HOW-TO-READ-SCHEDULE-FILE           PIC X(04).
020700     88  READ-AS-GET-NEXT                       VALUE 'GN  '.
020800     88  READ-AS-GET-FIRST                      VALUE 'GF  '.
020900
021000 01  HOW-TO-READ-ANNZ-SEGMENT            PIC X(04).
021100     88  READ-AS-GET-FIRST                      VALUE 'GF  '.
021200     88  READ-AS-GET-NEXT                       VALUE 'GN  '.
021300
021400 01  DUMMY-RECORD                        PIC X(100) VALUE ZERO.
021500

021700
021800 01  MISCELLANEOUS-AREA.
021900     05  COMPANY-READ-INSTRUCTION        PIC X(04).
021900     05  HOLD-SSN                        PIC 9(09).
021900     05  HOLD-OWNER-SSN                  PIC 9(09).
022000     05  SUB                             PIC S999   COMP-3.
022100     05  SUB1                            PIC S999   COMP-3.
022200     05  LAST-ADDRESS-LINE               PIC X(30).
022300     05  LAST-ADDRESS-LINE-X       REDEFINES
022400         LAST-ADDRESS-LINE               PIC X  OCCURS 30.
022800     05  WK-COMM-INFO-LINE.
022900         10  FILLER                      PIC X(2).
023000         10  WK-COMM-OPTION-X            PIC X.
023100         10  FILLER                      PIC X(22).
           05  VALUE-CONSTANTS.
               10 SPREAD-NON-APPL              PIC S9(03)V99
                                               VALUE +999.99.
           05  W-LEAP-YEAR-366                 PIC S9(03) COMP-3
                                                          VALUE 366.
021900     05  HD-OWNER-SSN                    PIC 9(09).
               88 CUSTODIAN-ACCT-SUPPRESSION   value 132638166,
                                                     132741729,
                                                     133180817,
                                                     232211143,
                                                     232384840,
                                                     262333067,
                                                     264310844,
                                                     391939036,
                                                     396037917,
                                                     411416330,
                                                     430345811,
                                                     510116113,
                                                     561354525,
                                                     591237041,
                                                     610734935,
                                                     640474907,
                                                     841474151,
                                                     911374280 .

023200

       01  WS-HOLD-FUND-VALUES.
           05  WS-FUND-VALUE-TABLE.
               10  WS-FUND-VALUE-ENTRIES   OCCURS 99 TIMES.
                   15  WK-FUND-NUMBER     PIC 9(9)V99.
                   15  WK-VALUE-BEGIN     PIC 9(9)V99.
                   15  WK-VALUE-END       PIC 9(9)V99.
                   15  WK-BEG-INTEREST    PIC 9(9)V99.
                   15  WK-END-INTEREST    PIC 9(9)V99.

           05  WS-INT-RATE-TABLE.
               10  WS-TERM-INFO          OCCURS 99 TIMES.
                   15  HOLD-TERM-FUND      PIC S9(03)  COMP-3.
                   15  HOLD-TERM-INT-RATE  PIC 9(3)V99.
                   15  HOLD-TERM-EARNINGS  PIC S9(12)V99.
                   15  HOLD-TERM-DEPOSIT-CODE PIC S9(5) COMP-3.
                   15  HOLD-FUND-BEGIN-DECL-VALUE   PIC S9(9)V99.
                   15  HOLD-FUND-END-DECL-VALUE     PIC S9(9)V99.
                   15  HOLD-FUND-END-DECL-VALUE-CUR PIC S9(9)V99.
                   15  HOLD-TERM-INTEREST-RATE     PIC S9(3)V99.
                   15  HOLD-TERM-CRD-ENH-AMT       PIC S9(9)V99.
                   15  HOLD-TERM-DIFF-RATE         PIC S9(3)V99.
                   15  HOLD-TERM-ORIG-TRX-CODE     PIC  X(04)
                                                        VALUE SPACE.

           05  WS-POL-TABLE.
               10  WS-POL-INFO          OCCURS 99 TIMES.
                   15 HOLD-POL-AS-OF-DATE          PIC 9(8).
                   15 HOLD-POL-TERM                PIC X(24).
                   15 HOLD-POL-BEGIN-VALUE         PIC S9(12)V99.
                   15 HOLD-POL-INTEREST            PIC S9(12)V99.
                   15 HOLD-POL-TRANSFER-AMT        PIC S9(12)V99.
                   15 HOLD-POL-WD-CHARGE           PIC S9(12)V99.
                   15 HOLD-POL-END-VALUE           PIC S9(12)V99.
                   15 HOLD-POL-END-VALUE-CURRENT   PIC S9(12)V99.
                   15 HOLD-POL-INT-RATE            PIC S9(3)V99.
                   15 HOLD-POL-CRED-ENHANCEMENT    PIC S9(12)V99.

035260 01  WORK-FIELDS.
           05 TOTAL-EARNINGS               PIC 9(9)V99.
           05 HOLD-STMT-INTEREST           PIC 9(9)V99.
           05 EARNINGS-ERROR-AMT           PIC S9(9)V99.
           05 WITHDRAWAL-ERROR   PIC S9(9)V99 VALUE ZERO.
035261     05 TERM-COUNT                   PIC 999.
035261     05 VT-FUND-SUB                  PIC 999.
035261     05 VT-PLAN-SUB                  PIC 999.
035261     05 FUND-SUB                     PIC 999.
035261     05 PROD-SUB                     PIC 99.
           05 FLAGS.
               10 DCA-FLAG                 PIC X.
           05 NO-GC-FLAG                   PIC X VALUE ' '.
035270     05 TOT-AMOUNT                   PIC S9(14)V99 COMP-3.
035271     05 INIT-PMT-TOTAL               PIC 9(7)V99.
036230     05 PAYMENT-COUNT                PIC 999V99.
036240     05 POLICY-COUNT                 PIC 999V99.
036240     05 SKIP-COUNT                   PIC 999999V99.
036240     05 PROCESS-COUNT                PIC 999999V99.
           05  WK-OEA-FROM-FUND               PIC S9(3) COMP-3.
           05  WK-OEA-DATE.
               10  WK-OEA-DATE-YYYY           PIC 9(04).
               10  WK-OEA-DATE-MM             PIC 9(02).
               10  WK-OEA-DATE-DD             PIC 9(02).
036314
       01  SORT-REC.
      *    05  SORT-PLAN-CODE              PIC X(06).
           05  SORT-PRODUCT                PIC X(38).
           05  SORT-FUND-NUMBER            PIC 9(03).
           05  SORT-KEY.
               10  SORT-POLICY-NUMBER      PIC X(15).
               10  SORT-INTEREST-RATE      PIC 9V99999.
               10  SORT-RENEWAL-DATE.
                   15  SORT-RENEWAL-YY     PIC X(04).
                   15  SORT-RENEWAL-MTH    PIC X(02).
                   15  SORT-RENEWAL-DAY    PIC X(02).
           05  SORT-ISSUE-DATE.
               10  SORT-ISSUE-YY           PIC X(04).
               10  SORT-ISSUE-MTH          PIC X(02).
               10  SORT-ISSUE-DAY          PIC X(02).
           05  SORT-FUND-MONEY             PIC 9(09)V99.
           05  SORT-RENEWAL-MONEY          PIC 9(09)V99.

      *
      *****************************
      *ALL COPY BOOKS
      *****************************
       01  WS-VPPADDRB          PIC X(08)       VALUE 'VPPADDRB'.

       01  W-VPAWEML-PARAMETER.        COPY VPAWEMLC.

       01  WS-ADDRESS-VERIF-REC.        COPY VPPADDRC.

       01  SAVED-POLICY-KEY                    PIC X(87) VALUE SPACE.

       01 WORKING-MAIL-BARCODE.
             05 FILER                          PIC X.
             05 MAIL-BARCODE.
                10 MAIL-BARCODE5-ZIP5          PIC X(5)  VALUE SPACE.
                10 MAIL-BARCODE5-CKDIGIT       PIC X     VALUE SPACE.
                10 MAIL-BARCODE5-BLANKS        PIC X(6)  VALUE SPACE.
             05 FILLER                         PIC X.

       01 FINALIST-LITERALS.
             05 ADDRSCAN                   PIC X(08)  VALUE 'ADDRSCAN'.
             05 LPFN000                    PIC X(08)  VALUE 'LPFN000'.
             05 LPFNIORP                   PIC X(08)  VALUE 'LPFNIORP'.

023300 01  VCS-ABEND-CODE                      PIC S9(07) COMP
023400                                                    VALUE ZERO.
023500
023600 01  VCSABEND-ERRORS.
023700     05  DB-OPEN-ERROR              PIC S9(7) COMP VALUE +0017.
023800     05  AGENT-OPEN-ERROR           PIC S9(7) COMP VALUE +0199.
023900     05  AHIST-OPEN-ERROR           PIC S9(7) COMP VALUE +0017.
024000     05  DB-CLOSE-ERROR             PIC S9(7) COMP VALUE +0018.
024100     05  AHIST-CLOSE-ERROR          PIC S9(7) COMP VALUE +0018.
024200     05  BAD-AGENT-READ             PIC S9(7) COMP VALUE +0057.
024300     05  COMPANY-POSITION-ERROR     PIC S9(7) COMP VALUE +0016.
024400     05  SCHEDULE-POSITION-ERROR    PIC S9(7) COMP VALUE +0015.
024500     05  COMPANY-READ-ERROR         PIC S9(7) COMP VALUE +0011.
024600     05  POLICY-READ-ERROR          PIC S9(7) COMP VALUE +0012.
024700     05  CONTRACT-READ-ERROR        PIC S9(7) COMP VALUE +0013.
024800     05  FUND-READ-ERROR            PIC S9(7) COMP VALUE +0024.
024900     05  PROD-READ-ERROR            PIC S9(7) COMP VALUE +0034.
025000     05  SCHEDULE-READ-ERROR        PIC S9(7) COMP VALUE +0014.
           05  INT-RATE-READ-ERROR        PIC S9(7) COMP VALUE +0044.
025100     05  ANNZ-READ-ERROR            PIC S9(7) COMP VALUE +0821.
025200     05  SURR-READ-ERROR            PIC S9(7) COMP VALUE +0822.
025300     05  NAME-ADDR-READ-ERROR       PIC S9(7) COMP VALUE +0823.
025400     05  DSS-HIST-READ-ERROR        PIC S9(7) COMP VALUE +0777.
025500     05  TRX-HIST-READ-ERROR        PIC S9(7) COMP VALUE +0877.
025600     05  DATE-ERROR                 PIC S9(7) COMP VALUE +0009.
025700     05  VALUATION-CALL-ERROR       PIC S9(7) COMP VALUE +2424.
           05  PLAN-TABLE-ACCESS-ERROR    PIC S9(7) COMP VALUE +4545.
           05  PRODUCER-READ-ERROR        PIC S9(7) COMP VALUE +0019.
025800
025900 01  UV-RETURN-STATUS-CODE          PIC X(04).
026000         88  UV-IO-SUCCESSFUL          VALUE SPACES.
026100 01  TB-RETURN-STATUS-CODE          PIC X(04).
026200         88  TB-IO-SUCCESSFUL          VALUE SPACES.
026300     EJECT

       01 DSSAGCM-STATUS                  PIC X(02).
       01 DSSAGTM-STATUS                  PIC X(02).

       01  FUND-CONSTANTS.                COPY CIUAXMCD SUPPRESS.
033700
       01  W-VPPTAB1                      PIC X(08) VALUE 'VPPTAB1 '.
       01  W-CONTROL-PARM.
                  COPY VPPTABC.
       01  W-ALL-PROD-FUND-PARM.
                  COPY VPPTABA1.
       01  W-ALL-PLAN-LOB-PARM.
                  COPY VPPTABA2.

       01  STMTEX-LINE.
                 COPY FIXSTEX.
      *     EJECT
       01  HOLD-STMTEX-LINE.
           05  HOLD-FIA-30-REC           PIC X(1100).
      *     EJECT
000900 01  PDS-AGENT-REC.                      COPY VPDPDSP.
000900
047620 01  RESERVE-RECORD.               COPY CISRF014 SUPPRESS.
047630
047631
047640 01  RESERVE-TABLES.               COPY CISRFTB4 SUPPRESS.
047650
047651
047660 01  RSVE-SPEC-INT-TABLE-AREA.     COPY CISRFSP4 SUPPRESS.
047670
       01  POLICY-SEGMENT.         COPY CIUAXA01.
      *     EJECT

       01  BENEFICIARY-SEGMENT.    COPY CMUAFBD1.
      *     EJECT

       01  PAYOUT-SEGMENT.         COPY CIUAFM15.
      *     EJECT

       01  DATE-ARITHMETIC-AREA.   COPY CIUAXDT1.
      *     EJECT

       01  TRX-COMM-AREA.          COPY CIUAX101 SUPPRESS.
      *     EJECT

       01  DATE-EDIT-FIELDS.       COPY CIODX011 SUPPRESS.
      *     EJECT

       01  DB-SEGMENT-MNEMONICS.   COPY CIVIXSM1 SUPPRESS.
      *     EJECT

       01 POLICY-SPEC-RECORD.      COPY CIAAF015 SUPPRESS.
      *     EJECT

       01 OWNER-MAIL-RECORD.       COPY CIAAF015 SUPPRESS.
      *     EJECT

       01 POLICY-VALUES-RECORD.    COPY CIAAF025 SUPPRESS.
      *     EJECT

       01 LOAN-INFO-RECORD.        COPY CIAAF035 SUPPRESS.
      *     EJECT

       01 INTEREST-RATES-RECORD.   COPY CIAAF045 SUPPRESS.
      *     EJECT

       01 RB-INFO-RECORD.          COPY CIAAF055 SUPPRESS.
      *     EJECT

       01 MONTHLY-ACTIVITY-RECORD. COPY CIAAF065 SUPPRESS.
      *     EJECT

       01 GRAND-SUMMARY-RECORD.    COPY CIAAF075 SUPPRESS.
      *     EJECT

       01 ELEMENT-VALUES.          COPY CIUAFEV1 SUPPRESS.

      *****************************
      *DATABASE COPY BOOKS  VANTAGE
      *****************************

       01  SEGMENT-AREA.                       COPY CIUXXMLD.

       01 DUMMY-AREA                        PIC X.
        01 DB-OPERATIONS.          COPY CIVIXOP1 SUPPRESS.
      *     EJECT

       01  INQ-CONT-AREA.          COPY CIUAFIC1 SUPPRESS.

       01 DB-MNEMONICS.            COPY CIVIXSM1 SUPPRESS.
      *     EJECT

       01 DB-PARM-AREA.            COPY CIVIXPA1 SUPPRESS.
      *     EJECT

       01 DB-COMM-AREA.            COPY CIVIXCA1 SUPPRESS.
      *     EJECT

       01 TRXHIST-COMM-AREA.       COPY CIVIXCA1 SUPPRESS.
      *     EJECT

       01 FUND-COMM-AREA.          COPY CIVIXCA1 SUPPRESS.
      *     EJECT

       01 FUND-SEGMENT.            COPY CIUAFD11 SUPPRESS.
      *     EJECT

       01 MONEY-FUND-SEGMENT.      COPY CIUAFMF8 SUPPRESS.
      *     EJECT

       01 MONEY-FUND-KEY-WORK.     COPY CIUAFMK8 SUPPRESS.
      *     EJECT
       01  HOLD-MONYFND-KEY.               COPY CIUAFMK8 SUPPRESS.

       01  HOLD-MONYFND-SEG.               COPY CIUAFMF8 SUPPRESS.

       01  RATE-SEGMENT-KEY.               COPY CMUAFXK1 SUPPRESS.
       01  RATE-SEGMENT.                   COPY CMUAFXR1 SUPPRESS.
       01  PREV-RATE-SEGMENT.              COPY CMUAFXR1 SUPPRESS.

       01  FIXED-RATE-PARMS.               COPY CMUAFIQ1 SUPPRESS.
       01  FIXED-RATE-SEG-KEY.             COPY CMUAFFK1 SUPPRESS.
       01  FIXED-RATE-SEG.                 COPY CMUAFFR1 SUPPRESS.

       01  INDEX-FUND-SEG-KEY.             COPY CIUAFIKE SUPPRESS.
       01  INDEX-FUND-SEG.                 COPY CIUAFIFE SUPPRESS.

       01  RIDER-SEGMENT.                  COPY CMUAFRS1 SUPPRESS.

       01  IAR-COMM-AREA.                  COPY CMUAFIAC SUPPRESS.

017000 01  SAVE-KEY-AREA.
017100     05  SAVE-COMPANY-SEGMENT-KEY        PIC X(87).
017200     05  SAVE-POLICY-SEG-KEY             PIC X(87).
017300     05  SAVE-FUND-KEY                   PIC X(87).
           05  SAVE-TRXHIST-KEY                PIC X(87).
017400     05  SAVE-COMPANY-CODE               PIC XXX.
       01  SAVE-MONYFUND-KEY.       COPY CIUAFMK8 SUPPRESS.
017500
       01 SCHEDULE-SEGMENT.        COPY CIUAXJ01 SUPPRESS.
      *     EJECT

       01 SURR-SEGMENT.            COPY CIUAFSW1 SUPPRESS.
      *     EJECT

       01 NAME-ADDRESS-SEGMENT.    COPY CIUAXK11 SUPPRESS.
      *     EJECT

       01 POLICY-SEG.              COPY CIUAFA11 SUPPRESS.
      *     EJECT
       01 PRODUCER-SEGMENT.        COPY CIUAXM01 SUPPRESS.


       01 STAND-ALONE-COMM-AREA.   COPY CIRCB002 SUPPRESS.
      *     EJECT

      *01  MONYFND-SURR-TABLE.     COPY CMUAFST1.

       01 GEN-TRX-REC.             COPY CIUAF001 SUPPRESS.
      *   EJECT
       01 ANI-TRX-REC REDEFINES GEN-TRX-REC.
                                   COPY CIUAFAN1 SUPPRESS.
      *     EJECT
       01 IRT-TRX-REC REDEFINES GEN-TRX-REC.
                                   COPY CIUAFIR8 SUPPRESS.
      *     EJECT
       01 NA-TRX-REC  REDEFINES GEN-TRX-REC.
                                   COPY CIUAFNA1 SUPPRESS.
      *     EJECT
       01 TA-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFTA1 SUPPRESS.
      *     EJECT

       01 PA-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFPA1 SUPPRESS.
      *     EJECT

       01 TB-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFTB1 SUPPRESS.
      *     EJECT
       01 TY-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFTY5 SUPPRESS.
      *     EJECT
       01 TZ-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFTZ5 SUPPRESS.
      *     EJECT
       01 OE-TRX-REC  REDEFINES GEN-TRX-REC.
                                    COPY CIUAFOE8 SUPPRESS.
      *
       01  XC-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CMUAFXC1 SUPPRESS.

       01  WX-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CMUAFWX1 SUPPRESS.

       01  WXD-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CMUAFWXD SUPPRESS.

       01  IAT-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CIUAFIAE SUPPRESS.

       01  IDT-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CIUAFIDE SUPPRESS.

       01  PAD-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CMUAFPAD SUPPRESS.

       01  RAA-TRX-REC REDEFINES GEN-TRX-REC.
                                    COPY CMUAFRAA SUPPRESS.
      *     EJECT
      **************************************
      *POLICY VALUE AND INTEREST COPY BOOKS*
      **************************************
       01 UV-COMM-AREA.             COPY CIUAXAD1 SUPPRESS.
      *     EJECT

       01 INQUIRY-CONTROLLER-AREA.  COPY CIUAFIC1 SUPPRESS.
      *     EJECT

       01 POLICY-VALUES.            COPY CIUAFPV1 SUPPRESS.
      *     EJECT

       01 BEGIN-POLICY-VALUES.      COPY CIUAFPV1 SUPPRESS.

       01 TRX-WORK-AREA.            COPY CIUAX001 SUPPRESS.
       01 TA-WORK-AREA REDEFINES TRX-WORK-AREA.
                                    COPY CIUAFTA1 SUPPRESS.
      *     EJECT

       01 TABLE-ACCESS.             COPY CITAXA11 SUPPRESS.
      *     EJECT

       01 INTEREST-SPEC-TABLE.      COPY CITAFZ11 SUPPRESS.
      *     EJECT

       01 SURR-CALC-TABLE.          COPY CITAFZ51 SUPPRESS.
      *     EJECT

       01  FUND-INFO-RECORD.        COPY CITAX091 SUPPRESS.

       01 MONEY-FUND-SURTBL.     COPY CMUAFST1 SUPPRESS.
      *     EJECT

       01  INDEX-PRICE-AREA.               COPY CMUAXIP1 SUPPRESS.

       01  INDEX-TABLE-REC.                COPY CITAXC8E SUPPRESS.

       01 HOLD-MONEY-FUND-SURTBL.     COPY CMUAFST1 SUPPRESS.
      *     EJECT

       01  INTEREST-SPEC-RECORD.    COPY CITAF241 SUPPRESS.

       01  DECL-INT-RATE-REC.       COPY CITAF251 SUPPRESS.

       01  PASS-PARM-AREA.          COPY CMUAFID1 SUPPRESS.

       01  EARNINGS-PARMS.          COPY CMUAFE12.

       01  W-FUND-COMM-AREA.        COPY CIUAFFC1.


      *****************************
      *VSAM COPY BOOKS
      *****************************
       01 VSAM-COMM-AREA.          COPY CIUAXVS1 SUPPRESS.
      *     EJECT
       01 VSAM-COMMANDS.           COPY CIUAX011 SUPPRESS.
      *     EJECT
      *****************************
000100*****************************************************************
000200***                                                           ***
000300***                                                           ***
000400***               DSS  DB  CALL COPYBOOKS                     ***
000500***                                                           ***
000600***                                                           ***
000700*****************************************************************
000800                                                           SKIP3
000900*    ************************
001000*                          **
001100*    DSS COMM AREA :       **
001200*         CIOMKCAA         **
001300*                          **
001400*    ************************
001500                                                           SKIP3
001600 01  DSS-COMM-AREA.
001700 COPY CIOMKCAA       REPLACING LOGICAL-VIEW      BY COMM-SEGMENT
001800                               LOGICAL-OPERATION BY COMM-FUNCTION
001900                               END-OF-FILE       BY COMM-EOF.
002000                                                           SKIP3
002100*    ************************
002200*                          **
002300* DSS DB OPERATION CODES:  **
002400*         CIOMKOPA         **
002500*                          **
002600*    ************************
002700*                                                          SKIP3
002800 01 DSS-DB-OP-CODES.
002900    COPY CIOMKOPA    REPLACING GET-NEXT-REC BY GET-NEXT-RECORD.
003000                                                           EJECT
003100*                                                          SKIP3
003200*    ************************
003300*                          **
003400*                          **
003500* DSS DB SEGMENT NAMES  :  **
003600*         CIOMOAV1         **
003700*                          **
003800*                          **
003900*    ************************
004000*                                                          SKIP3
004100 01 DSS-SEGMENT-NAMES.
004200    COPY CIOMOAV1.
004300                                                           EJECT
004400*                                                          SKIP3
004500*    ************************
004600*                          **
004700*                          **
004800* DSS AGENT PERSONAL REC:  **
004900*         CIUAOAP1         **
005000*                          **
005100*                          **
005200*    ************************
005300*                                                          SKIP3
005400 01 DSS-AGENT-PERSONAL-REC.
005500    COPY CIUAOAP1    REPLACING COMPANY-CODE  BY AGT-COMPANY-CD
005700                               LAST-NAME      BY AGT-LAST-NAME
005800                               FIRST-NAME     BY AGT-FIRST-NAME
005900                               NAME-PREFIX    BY AGT-NAME-PREFIX
006000                               NAME-SUFFIX    BY AGT-NAME-SUFFIX
006100                               AGENT-ID       BY AGT-AGENT-ID.
006200                                                           EJECT
006300*                                                          SKIP3
006400*    ************************
006500*                          **
006600*                          **
006700* DSS AGENCY MASTER RECORD **
006800*         CIUAOAM1         **
006900*                          **
007000*                          **
007100*    ************************
007200*                                                          SKIP3
007300 01 DSS-AGENCY-MASTER-REC.
007400    COPY CIUAOAM1    REPLACING COMPANY-CODE  BY AGC-COMPANY-CD
007500                               AGENCY-NUMBER BY AGC-AGENCY-NUMBER
007600                               AGENCY-KEY    BY AGC-AGENCY-KEY
007700                               AGENCY-NAME   BY AGC-AGENCY-NAME.
      *----------------------------------------------------------------
      *01  BEG-VPAMFTB-PARM.
      *    COPY VPAMFTBP.
      *
      *01  END-VPAMFTB-PARM.
      *    COPY VPAMFTBP.

       01  MUAFTH9-PARMS.
           05  COMPANY-CODE                    PIC XXX.
           05  MASTER-ID                       PIC X(15).
           05  BEGIN-DATE                      PIC 9(8).
           05  END-DATE                        PIC 9(8).
           05  ACCUM-CONTRIBS                  PIC S9(12)V99 COMP-3.
           05  ACCUM-WITHDRAWS                 PIC S9(12)V99 COMP-3.
       01  MUAFFD1-PARMS.
           05  COMPANY-CODE                    PIC XXX.
           05  MASTER-ID                       PIC X(15).
           05  EFFECTIVE-DATE                  PIC 9(8).
       01  DB2-FUNCTIONS.                      COPY CVI2XCAA.
      *----------------------------------------------------------------
      *
      *
       PROCEDURE DIVISION.
           PERFORM 10000-INITIALIZE  THRU 10000-EXIT.

           PERFORM 15000-READ-DATE-CARD THRU 15000-EXIT.

           PERFORM 300000-MAINLINE THRU 300000-EXIT
                                 UNTIL EOF.

           PERFORM 20000-FINAL THRU 20000-EXIT.

           COPY PVI2XCLA.
           GOBACK.

      *----------------------------------------------------------------
       10000-INITIALIZE.
      *----------------------------------------------------------------
      *    DISPLAY '10000-INITIALIZE'.

           COPY PVI2XOPA.
           OPEN INPUT  EXTRACT-FILE
                       CONTROL-FILE
                OUTPUT ANNL-STMNT-FILE.
      ***** $W6165C START *****
           OPEN OUTPUT BAD-ADDR-RPT.
      ***** $W6165C  END  *****


      **********************
      *OPEN VANTAGE DATABASE
      **********************
           MOVE SPACES                    TO DB-PARM-AREA.
           MOVE 'OPEN'                    TO OPERATION OF DB-PARM-AREA.

           CALL 'IVEXAI1'                 USING DB-PARM-AREA
                                                DUMMY-REC
                                                DB-COMM-AREA.

           IF NOT SUCCESSFUL-CALL OF DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR OPENING VANTAGE DATABASE           ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' STATUS-CODE OF DB-COMM-AREA
              MOVE '99'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.


      ******************************
      *OPEN UNIT VALUE  HISTORY FILE
      ******************************
           MOVE SPACE                      TO UV-COMM-AREA.
           MOVE 'OPEN'                     TO UV-COMM-FUNCTION
                                              IN UV-COMM-AREA.
           MOVE 'BUFR'                     TO UV-COMM-RETURN
                                              IN UV-COMM-AREA.
           CALL  'IUAXAD1'                 USING UV-COMM-AREA.

           IF NOT SUCCESSFUL OF UV-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR OPENING UNIT VALUE HISTORY         ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' UV-COMM-RETURN OF UV-COMM-AREA
              MOVE '90'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

      *********************
      *OPEN TABLE INTERFACE
      *********************
           MOVE SPACE                     TO TABLE-ACCESS.
           MOVE 'OPEN'                    TO REQUEST-TYPE
                                          IN TABLE-ACCESS.
      *    CALL 'ITAX011'                 USING TABLE-ACCESS
      *                                         DUMMY-AREA.

           IF NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR OPENING TABLE-ACCESS               ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' RETURN-STATUS OF TABLE-ACCESS
              MOVE '92'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

      **************************************************************
      ***   -  SETUP THE OPEN CALL PARAMETERS FOR DSS DB CALL       ***
      ***   -  CALLS THE IOMOIO11 PROGRAM TO OPEN THE DSS DATABASES ***
      ***   -  IF NOT SUCCESSFUL CALL, SETS ON THE TERMINATE-SW     ***
      *****************************************************************
      *
           MOVE SPACES                     TO DSS-COMM-AREA
                                              AGENT-KEY
           MOVE OPEN-FILE                  TO COMM-FUNCTION
           MOVE AGENT-PERSONAL-DATA        TO COMM-SEGMENT

           CALL 'IOMOIO1'               USING DSS-COMM-AREA
                                              AGENT-KEY
                                              DSS-AGENT-PERSONAL-REC.
      *          DISPLAY 'AFTER FIRST  CALL'

           IF  SUCCESSFUL-CALL             IN DSS-COMM-AREA
               MOVE SPACES                 TO DSS-COMM-AREA
                                              AGC-AGENCY-KEY
               MOVE OPEN-FILE              TO COMM-FUNCTION
               MOVE AGENCY-MASTER-DATA   TO COMM-SEGMENT
               CALL 'IOMOIO1'           USING DSS-COMM-AREA
                                              AGC-AGENCY-KEY
                                              DSS-AGENCY-MASTER-REC
      *          DISPLAY 'AFTER SECOND CALL'
               IF  SUCCESSFUL-CALL         IN DSS-COMM-AREA
                   CONTINUE
               ELSE
                   DISPLAY '*** ERROR ENCOUNTERED OPENNING DSS AGT'
                           ' DB,  PROGRAM ABORTED ***'
                   PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
               END-IF
           ELSE
               DISPLAY '*** ERROR ENCOUNTERED OPENNING DSS PHR'
                       ' DB,  PROGRAM ABORTED ***'
                   PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
           END-IF.

      ***** $W6165C START *****
           PERFORM 500000-BAD-ADDR-HEADER THRU 500000-EXIT.
      ***** $W6165C  END  *****
           EJECT

       10000-EXIT.
           EXIT.
           EJECT
098601
049200 15000-READ-DATE-CARD.
049300
049400     READ CONTROL-FILE
049500         AT END  MOVE 'Y'  TO  EOF-CARD-SWITCH
049600         GO TO 15000-EXIT.
049700
049800     MOVE  CONTROL-RECORD  TO  WORK-CONTROL-RECORD.
049900
050000     IF WK-CONTROL-DATE NOT NUMERIC
               DISPLAY 'NOT NUMERIC'
050100         MOVE  DATE-ERROR
050200           TO  VCS-ABEND-CODE
050300         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
050000     IF WK-CONTROL-DATE NOT NUMERIC
               DISPLAY 'NOT NUMERIC'
050100         MOVE  DATE-ERROR
050200           TO  VCS-ABEND-CODE
050300         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
050400
052900 15000-EXIT.
053000     EXIT.
053100     EJECT
      *----------------------------------------------------------------
       20000-FINAL.
      *----------------------------------------------------------------
      *    DISPLAY '20000-FINAL'.

           CLOSE EXTRACT-FILE
      ***** $W6165C START *****
                 BAD-ADDR-RPT
      ***** $W6165C  END  *****
                 ANNL-STMNT-FILE.

      ***********************
      *CLOSE VANTAGE DATABASE
      ***********************

           MOVE SPACES                    TO DB-PARM-AREA.
           MOVE 'CLSE'                    TO OPERATION OF DB-PARM-AREA.

           CALL 'IVEXAI1'                 USING DB-PARM-AREA
                                                DUMMY-REC
                                                DB-COMM-AREA.


           IF NOT SUCCESSFUL-CALL OF DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR CLOSING VANTAGE DATABASE           ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' STATUS-CODE OF DB-COMM-AREA
              MOVE '98'                   TO RETURN-CODE
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

      ********************************
      *CLOSE UNIT VALUE HISTORY FILES*
      ********************************
           MOVE SPACE                      TO UV-COMM-AREA.
           MOVE 'CLSE'                     TO UV-COMM-FUNCTION
                                              IN UV-COMM-AREA.
           CALL  'IUAXAD1'                 USING UV-COMM-AREA.

           IF NOT SUCCESSFUL OF UV-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR CLOSING UNIT VALUE HISTORY         ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' UV-COMM-RETURN OF UV-COMM-AREA
              MOVE '91'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

      **********************
      *CLOSE TABLE INTERFACE
      **********************
           MOVE SPACE                     TO TABLE-ACCESS.
           MOVE 'CLSE'                    TO REQUEST-TYPE
                                          IN TABLE-ACCESS.
      *    CALL 'ITAX011'                 USING TABLE-ACCESS
      *                                         DUMMY-AREA.

           IF NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR CLOSING TABLE-ACCESS               ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' RETURN-STATUS OF TABLE-ACCESS
              MOVE '92'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

       20000-EXIT.
           EXIT.
           EJECT

      *----------------------------------------------------------------
       300000-MAINLINE .
      *----------------------------------------------------------------
      *    DISPLAY '300000-MAINLINE'.

           PERFORM 930000-READ-INPUT THRU 930000-EXIT.

           IF EOF
               GO TO 300000-EXIT.

      * MOVE THESE SWITCHES HERE TO PREVENT THEM FROM BEING LEFT ON
      * AFTER THE LAST FIXED POLICY IS PROCESSED.
      *
           IF EXTRACT-PRODUCT NOT = 'A1'
              MOVE 'N' TO EXPLORER-CONTRACT-SW
              MOVE 'N' TO FRONTIERS-CONTRACT-SW
              MOVE 'N' TO FRONTIERS-II-CONTRACT-SW
              MOVE 'N' TO PROVIDER-CONTRACT-SW
              MOVE 'N' TO PCL-CONTRACT-SW
              MOVE 'N' TO FIA-CONTRACT-SW
              MOVE 'N' TO FIA-PA-CONTRACT-SW
              MOVE 'N' TO FIA-INDEX-EDGE-SW
              MOVE 'N' TO FIA-INDEX-ADVISORY-SW
              MOVE 'N' TO INDEX-FOUNDATION-SW
              MOVE 'N' TO EXPEDITION-CONTRACT-SW
              MOVE 'N' TO MARINER-CONTRACT-SW
              MOVE 'N' TO PIA-CONTRACT-SW
           END-IF.

           IF EXTRACT-PRODUCT = 'A1'
              MOVE EXTRACT-TRANS-TYPE     TO 7RECORD-CODES
              MOVE TRANSACTION-DATA       TO POLICY-SPEC-RECORD

              IF  POLICY-SPECS-REC
                  MOVE 'N' TO EXPLORER-CONTRACT-SW
                  MOVE 'N' TO FRONTIERS-CONTRACT-SW
                  MOVE 'N' TO FRONTIERS-II-CONTRACT-SW
                  MOVE 'N' TO PROVIDER-CONTRACT-SW
                  MOVE 'N' TO PCL-CONTRACT-SW
                  MOVE 'N' TO FIA-CONTRACT-SW
                  MOVE 'N' TO FIA-PA-CONTRACT-SW
                  MOVE 'N' TO FIA-INDEX-EDGE-SW
                  MOVE 'N' TO FIA-INDEX-ADVISORY-SW
                  MOVE 'N' TO INDEX-FOUNDATION-SW
                  MOVE 'N' TO EXPEDITION-CONTRACT-SW
                  MOVE 'N' TO MARINER-CONTRACT-SW
                  MOVE 'N' TO PIA-CONTRACT-SW

                  IF PLAN-CODE IN POLICY-SPEC-RECORD   = '006500'
                                                   OR 'N06500'
                                                   OR '006510'
                                                   OR 'N06510'
                                                   OR '00651R'
                                                   OR 'N0651R'
                     SET EXPLORER-CONTRACT TO TRUE
                  ELSE
                     MOVE 'N'
                       TO EXPLORER-CONTRACT-SW
                  END-IF

                  IF PLAN-CODE IN POLICY-SPEC-RECORD   = '007000'
                                                   OR 'N07000'
                                                   OR '007100'
                     SET FRONTIERS-II-CONTRACT TO TRUE
                  ELSE
                     MOVE 'N'
                       TO FRONTIERS-II-CONTRACT-SW
                  END-IF

                  IF PLAN-CODE IN POLICY-SPEC-RECORD   = '006000'
                     MOVE 'Y' TO FRONTIERS-CONTRACT-SW
                  ELSE
                     MOVE 'N' TO FRONTIERS-CONTRACT-SW
                  END-IF

                  IF PLAN-CODE IN POLICY-SPEC-RECORD   = '005100'
                                                  OR   = '005000'
                     MOVE 'Y' TO PROVIDER-CONTRACT-SW
                  ELSE
                     MOVE 'N' TO PROVIDER-CONTRACT-SW
                  END-IF

                  MOVE  EXTRACT-POLICY
                    TO  WS-PCL-CONTRACT-NO

                  IF  WS-PCL-INDICATOR  = 'V'
                     MOVE 'Y'
                       TO PCL-CONTRACT-SW
                     MOVE 'N' TO FRONTIERS-CONTRACT-SW
                                 FRONTIERS-II-CONTRACT-SW
                                 EXPLORER-CONTRACT-SW
                  ELSE
                      MOVE 'N'
                        TO PCL-CONTRACT-SW
                  END-IF

                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '016A06')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016A08')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016A10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016B06')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016B08')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016B10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016C06')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016C08')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016D06')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016D08')
                     MOVE 'Y' TO FIA-CONTRACT-SW
                  ELSE
                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '016E10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016F10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016G10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016E07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016F07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016G07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016H07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016I07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016H10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016I10')
                     MOVE 'Y' TO FIA-PA-CONTRACT-SW
                  ELSE
                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '016J07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016J10')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016K07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016K10')
                     MOVE 'Y' TO FIA-INDEX-EDGE-SW
                  ELSE
                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '016L05')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016L07')
                     MOVE 'Y' TO FIA-INDEX-ADVISORY-SW
                  ELSE
                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '016M05')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016M07')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '016M10')
                     MOVE 'Y' TO INDEX-FOUNDATION-SW
                  END-IF
                  END-IF
                  END-IF
                  END-IF
                  END-IF

                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '006705')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '006707')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '006715')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '006717')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06705')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06707')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06715')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06717')
                     MOVE 'Y' TO EXPEDITION-CONTRACT-SW
                  END-IF

                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '006605')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = '006607')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06605')
                  OR  (PLAN-CODE IN POLICY-SPEC-RECORD = 'N06607')
                     MOVE 'Y' TO MARINER-CONTRACT-SW
                  END-IF

                  IF  (PLAN-CODE IN POLICY-SPEC-RECORD = '006800')
                     MOVE 'Y' TO PIA-CONTRACT-SW
                  END-IF

              END-IF
           END-IF.

           IF PLAN-CODE IN POLICY-SPEC-RECORD   = 'FCCD  '
                                           OR   = 'FCCF  '
                                           OR   = 'G7PLUS'
                                           OR   = 'SEL1  '
                                           OR   = 'SEL3  '
                                           OR   = 'SEL5  '
                                           OR   = 'SEL7  '
                                           OR   = 'SPD6  '
                                           OR   = 'TEMPO '
                                           OR   = 'VIP   '
                     MOVE 'Y'
                       TO PCL-CONTRACT-SW.

           IF    EXPLORER-CONTRACT-SW      = 'N'
             AND FRONTIERS-II-CONTRACT-SW  = 'N'
             AND FRONTIERS-CONTRACT-SW     = 'N'
             AND PROVIDER-CONTRACT-SW      = 'N'
             AND PCL-CONTRACT-SW           = 'N'
             AND FIA-CONTRACT-SW           = 'N'
             AND FIA-PA-CONTRACT-SW        = 'N'
             AND FIA-INDEX-EDGE-SW         = 'N'
             AND FIA-INDEX-ADVISORY-SW     = 'N'
             AND INDEX-FOUNDATION-SW       = 'N'
             AND EXPEDITION-CONTRACT-SW    = 'N'
             AND MARINER-CONTRACT-SW       = 'N'
             AND PIA-CONTRACT-SW           = 'N'
      ***** $T59669 START *****
      *        DISPLAY 'INVALID FIXED PLAN CODE FOUND  '
      *                              EXTRACT-POLICY
      *        PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
      *            GO TO 300000-EXIT.
              IF  POLICY-SPECS-REC
                 DISPLAY 'INVALID FIXED PLAN CODE FOUND - '
                         EXTRACT-POLICY
              END-IF
              GO TO 300000-EXIT
           END-IF.
      ***** $T59669  END  *****


      ***** $WR10612D START *****
      *    IF EXPLORER-CONTRACT
      *        GO TO 300000-EXIT
      *    END-IF.
      ***** $WR10612D  END  *****

      *    IF FRONTIERS-II-CONTRACT
      *        GO TO 300000-EXIT
      *    END-IF.
      ***** $T157090 START *****
      *    $T141131 - SKIP THE FIA-PA STATEMENTS.
      *    $T141131   IF FIA-PA-CONTRACT
      *    $T141131     GO TO 300000-EXIT
      *    $T141131   END-IF.
      *    $T141131 - SKIP THE FIA-PA STATEMENTS.
      ***** $T157090  END  *****

      *    $T180946 - SKIP THE INDEX-EDGE STATEMENTS.
      *    IF FIA-INDEX-EDGE-CONTRACT                          $T180946
      *       GO TO 300000-EXIT                                $T180946
      *    END-IF.                                             $T180946
      *    $T180946 - SKIP THE INDEX-EDGE STATEMENTS.
      *    $T197370 - SKIP THE INDEX-ADVISORY STATEMENTS.
           IF FIA-INDEX-ADVISORY-CONTRACT
              GO TO 300000-EXIT
           END-IF.
      *    $T197370 - SKIP THE INDEX-ADVISORY STATEMENTS.
      *    $T200566 - SKIP THE INDEX-FOUNDATION STATEMENTS.
           IF INDEX-FOUNDATION-CONTRACT
              GO TO 300000-EXIT
           END-IF.
      *    $T200566 - SKIP THE INDEX-FOUNDATION STATEMENTS.

           MOVE EXTRACT-TRANS-TYPE           TO 7RECORD-CODES.



           DISPLAY 'extract policy '
                 EXTRACT-POLICY
           IF  EXTRACT-POLICY = '     FX15412730'
               DISPLAY 'GOT IT'
               GO TO 300000-MAINLINE.

           IF  EXTRACT-POLICY = '     FXQE356312'
               DISPLAY 'GOT IT'.

           IF PCL-CONTRACT
           OR PROVIDER-CONTRACT
      *        PERFORM AAAAAA-PCL-STATEMENT
               PERFORM AAAAAA-ONEPAGE-STATEMENT
           END-IF.

           IF FRONTIERS-CONTRACT
               PERFORM BBBBBB-FRONTIERS-STATEMENT
           END-IF.

           IF FRONTIERS-II-CONTRACT
               PERFORM CCCCCC-FRONTIERS-II-STATEMENT
           END-IF.

           IF EXPLORER-CONTRACT
               PERFORM DDDDDD-EXPLORER-STATEMENT
           END-IF.

           IF FIA-CONTRACT
           OR FIA-PA-CONTRACT
           OR FIA-INDEX-EDGE-CONTRACT
              PERFORM EEEEEE-FIA-STATEMENT
           END-IF.

           IF EXPEDITION-CONTRACT
           OR MARINER-CONTRACT
              PERFORM FFFFFF-EXPEDITION-STATMENT
           END-IF.

           IF  PIA-CONTRACT
              PERFORM GGGGGG-PIA-STATEMENT
           END-IF.

       300000-EXIT.
           EXIT.
           EJECT
       AAAAAA-ONEPAGE-STATEMENT.


           MOVE '1-800-722-4448'
             TO  HOLD-CUST-SERV-PHONE
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE

           IF POLICY-SPECS-REC
               MOVE 'Y'
                 TO GET-THIS-SWITCH
               PERFORM 940000-GET-SEGMENTS
                                        THRU 940000-EXIT
000900         PERFORM 980000-GET-PD-FROM-VPDPDS
000900                                  THRU 980000-EXIT
               PERFORM 320000-CHECK-SURRENDER
                                        THRU 320000-EXIT
               IF GET-THIS-POLICY
                   PERFORM 410000-GET-REC-10
                                 THRU 410000-EXIT

                   PERFORM 420000-GET-REC-20
                                 THRU 420000-EXIT
           END-IF.


           IF POLICY-VALUES-RECS
           AND GET-THIS-POLICY

               PERFORM 430000-GET-REC-30
                             THRU 430000-EXIT
               PERFORM 490000-GET-REC-65 THRU 490000-EXIT
           END-IF.

       AAAAAA-EXIT.
           EXIT.
           EJECT

       BBBBBB-FRONTIERS-STATEMENT.

           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE

           IF POLICY-SPECS-REC
               MOVE 'Y'
                 TO GET-THIS-SWITCH
               PERFORM 940000-GET-SEGMENTS
                                        THRU 940000-EXIT
000900         PERFORM 980000-GET-PD-FROM-VPDPDS
000900                                  THRU 980000-EXIT
               PERFORM 320000-CHECK-SURRENDER
                                        THRU 320000-EXIT

               IF GET-THIS-POLICY
                   PERFORM 410000-GET-REC-10
                                 THRU 410000-EXIT

                   PERFORM 415000-REC-15
                                 THRU  415000-EXIT

                   PERFORM 420000-GET-REC-20
                                 THRU 420000-EXIT
               END-IF
           END-IF.


           IF POLICY-VALUES-RECS
           AND GET-THIS-POLICY

               PERFORM 430000-GET-REC-30
                             THRU 430000-EXIT

               PERFORM 458000-GET-REC-31       THRU 458000-EXIT

               MOVE ZEROS
                 TO KEY-DEFINITION

               MOVE SPACES
                 TO DATA-DEFINITION-AREA

               PERFORM 440000-GET-REC-40 THRU 440000-EXIT

               PERFORM 450000-GET-REC-50       THRU 450000-EXIT
      *
      *  TRX HISTORY WILL HAVE TO BE READ TO GET FINANCIAL TRANSACTIONS
      *  IT IS PERFORMED HERE TO ENSURE THIS IS DONE FOR ALL CONTRACTS
      *
               PERFORM 460000-GET-REC-60
                                      THRU 460000-EXIT
               PERFORM 490000-GET-REC-65 THRU 490000-EXIT
           END-IF.


       BBBBBB-EXIT.
           EXIT.
           EJECT

       CCCCCC-FRONTIERS-II-STATEMENT.


           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC.


           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE

           IF  EXTRACT-COMPANY IN EXTRACT-REC = '111'
              MOVE '1-800-748-6907'
                TO HOLD-CUST-SERV-PHONE
                   HOLD-REP-CUST-SERV-PHONE
           END-IF.

           IF POLICY-SPECS-REC
               MOVE 'Y'
                 TO GET-THIS-SWITCH
               PERFORM 940000-GET-SEGMENTS
                                        THRU 940000-EXIT
               MOVE HOLD-PROD-MNEMONIC
                 TO KEY-PROD-MNEMONIC

000900         PERFORM 980000-GET-PD-FROM-VPDPDS
000900                                  THRU 980000-EXIT
               PERFORM 320000-CHECK-SURRENDER
                                        THRU 320000-EXIT

               IF GET-THIS-POLICY
                   PERFORM 410000-GET-REC-10
                                 THRU 410000-EXIT

                   PERFORM 415000-REC-15
                                 THRU  415000-EXIT

                   PERFORM 420000-GET-REC-20
                                 THRU 420000-EXIT
               END-IF
           END-IF.


           IF POLICY-VALUES-RECS
           AND GET-THIS-POLICY

               PERFORM 430000-GET-REC-30
                             THRU 430000-EXIT

               PERFORM 458000-GET-REC-31       THRU 458000-EXIT

      *
      *    DO NOT PRODUCE REC-37 IF CONTRACT HAS ALREADY TERMINATED
      *
               IF WK-TERMINATED
                   CONTINUE
               ELSE
                   PERFORM 470000-GET-REC-37
                                 THRU 470000-EXIT
               END-IF

               MOVE ZEROS
                 TO KEY-DEFINITION

               MOVE SPACES
                 TO DATA-DEFINITION-AREA

               PERFORM 445060-GET-FIRST-TRXHIST THRU 445060-EXIT

      ***** $144461 START *****
      *        PERFORM 440000-GET-REC-40 THRU 440000-EXIT

               PERFORM 447000-FRONTIERS-II-REC-40 THRU 447000-EXIT

               IF  SW-PRODUCE-FII-REC-47
                  PERFORM 480000-FRONTIERS-II-REC-47 THRU 480000-EXIT
               END-IF
      ***** $144461  END  *****
      *
      * FIRST RENEWAL WILL NOT OCCUR FOR AT LEAST 4 YEARS SINCE MIN
      * TERM IS 5 YEARS.  WILL BE PROGRAMMING IN 2/2011
      * WE CAN TEST AT THAT TIME
      *
      * WE CAN JUST POPULATE THE FIELDS WITH DUMMY DATA TO TEST PRINTING
      *
      *        PERFORM 480000-FRONTIERS-II-REC-47
      *                      THRU 480000-EXIT
      *

      *
      *  TRX HISTORY WILL HAVE TO BE READ TO GET FINANCIAL TRANSACTIONS
      *  IT IS PERFORMED HERE TO ENSURE THIS IS DONE FOR ALL CONTRACTS
      *
               PERFORM 460000-GET-REC-60
                                      THRU 460000-EXIT
               PERFORM 490000-GET-REC-65 THRU 490000-EXIT
           END-IF.

       CCCCCC-EXIT.
           EXIT.
           EJECT

       DDDDDD-EXPLORER-STATEMENT.

           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE

           IF  EXTRACT-COMPANY IN EXTRACT-REC = '111'
              MOVE '1-800-748-6907'
                TO HOLD-CUST-SERV-PHONE
                   HOLD-REP-CUST-SERV-PHONE
           END-IF.

           IF POLICY-SPECS-REC
               MOVE 'Y'
                 TO GET-THIS-SWITCH
               PERFORM 940000-GET-SEGMENTS
                                        THRU 940000-EXIT
000900         PERFORM 980000-GET-PD-FROM-VPDPDS
000900                                  THRU 980000-EXIT
               PERFORM 320000-CHECK-SURRENDER
                                        THRU 320000-EXIT

               IF GET-THIS-POLICY
                   PERFORM 410000-GET-REC-10
                                 THRU 410000-EXIT

                   PERFORM 415000-REC-15
                                 THRU  415000-EXIT

                   PERFORM 420000-GET-REC-20
                                 THRU 420000-EXIT
               END-IF
           END-IF.


           IF POLICY-VALUES-RECS
           AND GET-THIS-POLICY

               PERFORM 431000-GET-TOTALS       THRU 431000-EXIT

               PERFORM 458000-GET-REC-31       THRU 458000-EXIT

               PERFORM 430000-GET-REC-30
                             THRU 430000-EXIT

               MOVE ZEROS
                 TO KEY-DEFINITION

               MOVE SPACES
                 TO DATA-DEFINITION-AREA

               PERFORM 445060-GET-FIRST-TRXHIST THRU 445060-EXIT

               PERFORM 440000-GET-REC-40 THRU 440000-EXIT


      *
      *  TRX HISTORY WILL HAVE TO BE READ TO GET FINANCIAL TRANSACTIONS
      *  IT IS PERFORMED HERE TO ENSURE THIS IS DONE FOR ALL CONTRACTS
      *
      ***** $113471 START *****
      *        PERFORM 460000-GET-REC-60
      *                               THRU 460000-EXIT.
               PERFORM 460000-GET-REC-60 THRU 460000-EXIT
               PERFORM 490000-GET-REC-65 THRU 490000-EXIT
           END-IF.
      ***** $113471  END  *****

       DDDDDD-EXIT.
           EXIT.
           EJECT
       EEEEEE-FIA-STATEMENT.

      *
      * FIA STATEMENTS RUN FROM ANNIVERSARY TO ANNIVERSARY
      *
           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE.
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE.

           IF  EXTRACT-COMPANY IN EXTRACT-REC = '111'
              MOVE '1-800-748-6907'
                TO HOLD-CUST-SERV-PHONE
                   HOLD-REP-CUST-SERV-PHONE
           END-IF.

           IF  POLICY-SPECS-REC
              MOVE 'Y'
                TO GET-THIS-SWITCH
              PERFORM 940000-GET-SEGMENTS       THRU 940000-EXIT
              PERFORM 980000-GET-PD-FROM-VPDPDS THRU 980000-EXIT
              PERFORM 320000-CHECK-SURRENDER    THRU 320000-EXIT

              MOVE SPACE TO SW-CONTRACT-DEATH-STATUS-SW
              IF  ((POLICY-STATUS  IN POLICY-SEG = '2')
              OR   ((POLICY-STATUS IN POLICY-SEG = 'A')
              AND   (SPOUSAL-CONTINUATION-INDICATOR IN POLICY-SEG =
                     'C')))
                 SET SW-CONTRACT-DEATH-STATUS TO TRUE
                 IF  SW-CONT-THIS-ANNIV-AFT
                    MOVE SPACE TO SW-CONTRACT-DEATH-STATUS-SW
                 END-IF
              END-IF

              IF GET-THIS-POLICY
                 PERFORM 410000-GET-REC-10      THRU 410000-EXIT
                 PERFORM 415000-REC-15          THRU 415000-EXIT
                 PERFORM 420000-GET-REC-20      THRU 420000-EXIT
              END-IF
           END-IF.

           IF  POLICY-VALUES-RECS
           AND GET-THIS-POLICY
              PERFORM 400000-CHK-FOR-RIDERS    THRU 400000-EXIT
              PERFORM 402000-GET-RATE-SEGS     THRU 402000-EXIT
              PERFORM 430000-GET-REC-30        THRU 430000-EXIT
              PERFORM 458000-GET-REC-31        THRU 458000-EXIT
              PERFORM 437000-GET-REC-38        THRU 437000-EXIT
              IF  SW-RIDERS-ON-POLICY
                 PERFORM 438000-GET-REC-39     THRU 438000-EXIT
              END-IF
              PERFORM 457000-DETERMINE-BAND    THRU 457000-EXIT
              PERFORM 453000-GET-REC-51        THRU 453000-EXIT
              PERFORM 454000-GET-REC-52        THRU 454000-EXIT
      ***** $T87159 START *****
      *       IF  (POLICY-STATUS  IN POLICY-SEG = '2') OR
      *          ((POLICY-STATUS  IN POLICY-SEG = 'A') AND
      *           (SPOUSAL-CONTINUATION-INDICATOR
      *                           IN POLICY-SEG = 'C'))
              IF  SW-CONTRACT-DEATH-STATUS
      ***** $T87159  END  *****
                 PERFORM 456000-GET-REC-54     THRU 456000-EXIT
                 PERFORM 460000-GET-REC-60     THRU 460000-EXIT
                 PERFORM 490000-GET-REC-65     THRU 490000-EXIT
      *          PERFORM 465000-WRITE-30-REC   THRU 465000-EXIT
              ELSE
                 PERFORM 455000-GET-REC-53     THRU 455000-EXIT
                 PERFORM 456000-GET-REC-54     THRU 456000-EXIT
                 PERFORM 460000-GET-REC-60     THRU 460000-EXIT
                 PERFORM 490000-GET-REC-65     THRU 490000-EXIT
      *          PERFORM 465000-WRITE-30-REC   THRU 465000-EXIT
              END-IF
           END-IF.

       EEEEEE-EXIT.
           EXIT.
           EJECT
       FFFFFF-EXPEDITION-STATMENT.

           IF  (PLAN-CODE IN POLICY-SEG = '006705')
           OR  (PLAN-CODE IN POLICY-SEG = '006715')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06705')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06715')
      *
      *  THE FOLLOWING ARE MARINER PLAN CODES
      *
           OR  (PLAN-CODE IN POLICY-SEG = '006605')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06605')
              MOVE +5
                TO WK-EXPEDITION-PERIOD
           END-IF.
           IF  (PLAN-CODE IN POLICY-SEG = '006707')
           OR  (PLAN-CODE IN POLICY-SEG = '006717')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06707')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06717')
      *
      *  THE FOLLOWING ARE MARINER PLAN CODES
      *
           OR  (PLAN-CODE IN POLICY-SEG = '006607')
           OR  (PLAN-CODE IN POLICY-SEG = 'N06607')
              MOVE +7
                TO WK-EXPEDITION-PERIOD
           END-IF.

           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE.
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE.

           IF  EXTRACT-COMPANY IN EXTRACT-REC = '111'
              MOVE '1-800-748-6907'
                TO HOLD-CUST-SERV-PHONE
                   HOLD-REP-CUST-SERV-PHONE
           END-IF.

           IF  POLICY-SPECS-REC
              MOVE 'Y'
                TO GET-THIS-SWITCH
              MOVE '00000000'
                TO WK-HOLD-RA-ACTIVATION-DATE
              PERFORM 940000-GET-SEGMENTS       THRU 940000-EXIT
              PERFORM 980000-GET-PD-FROM-VPDPDS THRU 980000-EXIT
              PERFORM 320000-CHECK-SURRENDER    THRU 320000-EXIT

              IF GET-THIS-POLICY
                 PERFORM 410000-GET-REC-10      THRU 410000-EXIT
                 PERFORM 415000-REC-15          THRU 415000-EXIT
                 PERFORM 420000-GET-REC-20      THRU 420000-EXIT
              END-IF
           END-IF.

           IF  POLICY-VALUES-RECS
           AND GET-THIS-POLICY
              PERFORM 402000-GET-RATE-SEGS     THRU 402000-EXIT
              PERFORM 430000-GET-REC-30        THRU 430000-EXIT
              PERFORM 458000-GET-REC-31        THRU 458000-EXIT
              PERFORM 457000-DETERMINE-BAND    THRU 457000-EXIT
              PERFORM 458510-GET-PAYMENTS      THRU 458510-EXIT
              PERFORM 458500-GET-REC-55        THRU 458500-EXIT
              PERFORM 459000-GET-REC-56        THRU 459000-EXIT
      ***** $110757 START *****
      *       PERFORM 459500-GET-REC-57        THRU 459500-EXIT
              IF  EXPEDITION-CONTRACT
                 PERFORM 459500-GET-REC-57     THRU 459500-EXIT
              END-IF
      ***** $110757  END  *****
              PERFORM 460000-GET-REC-60        THRU 460000-EXIT
              PERFORM 490000-GET-REC-65        THRU 490000-EXIT
           END-IF.

       FFFFFF-EXIT.
           EXIT.
           EJECT

       GGGGGG-PIA-STATEMENT.

           MOVE +7 TO WK-EXPEDITION-PERIOD.
           MOVE SPACE TO GENERATE-REC-47-SW.

           MOVE '1-800-722-4448'
             TO HOLD-CUST-SERV-PHONE.
           MOVE '1-800-722-2333'
             TO HOLD-REP-CUST-SERV-PHONE.

           IF  EXTRACT-COMPANY IN EXTRACT-REC = '111'
              MOVE '1-800-748-6907'
                TO HOLD-CUST-SERV-PHONE
                   HOLD-REP-CUST-SERV-PHONE
           END-IF.

           IF  POLICY-SPECS-REC
              MOVE 'Y'
                TO GET-THIS-SWITCH
              MOVE '00000000'
                TO WK-HOLD-RA-ACTIVATION-DATE
              PERFORM 940000-GET-SEGMENTS       THRU 940000-EXIT
              PERFORM 980000-GET-PD-FROM-VPDPDS THRU 980000-EXIT
              PERFORM 320000-CHECK-SURRENDER    THRU 320000-EXIT

              IF GET-THIS-POLICY
                 PERFORM 410000-GET-REC-10      THRU 410000-EXIT
                 PERFORM 415000-REC-15          THRU 415000-EXIT
                 PERFORM 420000-GET-REC-20      THRU 420000-EXIT
              END-IF
           END-IF.

           IF  POLICY-VALUES-RECS
           AND GET-THIS-POLICY
              PERFORM 400000-CHK-FOR-RIDERS    THRU 400000-EXIT
              PERFORM 430000-GET-REC-30        THRU 430000-EXIT
              PERFORM 458000-GET-REC-31        THRU 458000-EXIT
              PERFORM 437000-GET-REC-38        THRU 437000-EXIT
              IF  NOT FULL-SURRENDER-FOUND
                 PERFORM 438000-GET-REC-39     THRU 438000-EXIT
              END-IF
              IF  GENERATE-REC-47
                 PERFORM 445200-EXPLORER-REC-47 THRU 445200-EXIT
              ELSE
                 PERFORM 440000-GET-REC-40     THRU 440000-EXIT
              END-IF
              PERFORM 460000-GET-REC-60        THRU 460000-EXIT
              PERFORM 490000-GET-REC-65        THRU 490000-EXIT
           END-IF.

       GGGGGG-EXIT.
           EXIT.
           EJECT

       320000-CHECK-SURRENDER.

           MOVE SPACE
             TO SW-CONT-THIS-ANNIV-YR-SW.

           MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
             TO  STMT-START
                 TRX-BEGIN-DATE.

           MOVE  STATEMENT-END-DATE IN POLICY-SPEC-RECORD
             TO  STMT-END
                 TRX-END-DATE.

           IF POLICY-ISSUE-DATE          OF POLICY-SPEC-RECORD
                           =
                     STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD

               MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                 TO  HOLD-VAL-BEGIN-DATE
           ELSE

               MOVE  STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                 TO  BASE-DATE
               MOVE  0                    TO  CHANGE-DATE-YYY
               MOVE  0                    TO  CHANGE-DATE-MMM
               MOVE  -1                   TO  CHANGE-DATE-DDD
               CALL  'IUAXF85'         USING  DATE-ARITHMETIC-AREA
               MOVE  RETURN-DATE-MM       TO  VAL-BEGIN-DATE-MM
               MOVE  RETURN-DATE-DD       TO  VAL-BEGIN-DATE-DD
               MOVE  RETURN-DATE-YYYY     TO  VAL-BEGIN-DATE-CCYY
           END-IF.

      *kpl-date
           IF FIA-CONTRACT
           OR FIA-PA-CONTRACT
           OR FIA-INDEX-EDGE-CONTRACT
      ***** $114384 START *****
              IF  POLICY-ISSUE-DATE IN POLICY-SPEC-RECORD NOT =
                  STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                 MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                   TO HOLD-VAL-BEGIN-DATE
              END-IF
      ***** $114384  END  *****
      *       MOVE STMT-START
              MOVE STMT-END
                TO BASE-DATE             IN DATE-ARITHMETIC-AREA
                   RETURN-DATE           IN DATE-ARITHMETIC-AREA
      ***** $T92005 START *****
      *       MOVE +1
      *         TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
      *       MOVE ZERO
      *         TO CHANGE-DATE-MMM       IN DATE-ARITHMETIC-AREA
      *            CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
              MOVE ZERO
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
                   CHANGE-DATE-MMM       IN DATE-ARITHMETIC-AREA
              MOVE +1
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
      ***** $T92005  END  *****

              CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA

              MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                TO STMT-END
                   TRX-END-DATE
           END-IF.

           MOVE  STATEMENT-END-DATE IN POLICY-SPEC-RECORD
             TO  HOLD-VAL-END-DATE.

           MOVE POLICY-ISSUE-DATE          OF POLICY-SPEC-RECORD
             TO HOLD-ISSUE-DATE.

           MOVE ZEROS TO HOLD-INITIAL-PAYMENT.
           MOVE ZEROS TO HOLD-ADD-PAYMENT
                         HOLD-1STYR-ADD-PAYMENT
                         HOLD-FRNTRII-ADD-PAYMENT
                         HOLD-1STYR-FRNTRII-ADD-PAYMENT
                         HOLD-CREDIT-ENHANCEMENT
                         STMT-ADD-PAYMENTS
                         HOLD-MA-DUMPIN.

           MOVE ZERO TO WK-WITHD-WITHDRWL-CHRGS
                        WK-WITHD-MVA
                        WK-HOLD-FORCED-RATE
                        WK-HOLD-NEW-RATE
                        WK-HOLD-POLICY-WITHDRAW
                        WK-WITHD-MIN-SURRENDER.

           MOVE 'Y' TO GET-VALUES-SW
           MOVE 'N' TO GET-FUND-VALUES-SW

           MOVE ZEROS TO TOTAL-CLAIMS
           MOVE ZEROS TO WK-TOTAL-TAX
           MOVE ZEROS TO WK-TOTAL-FEES
           MOVE ZEROS TO WK-TOTAL-MVA
           MOVE ZEROS TO WK-WD-CHARGES

           MOVE ZEROS TO HOLD-CLAIM-AMT

           MOVE +999 TO WK-OEA-FROM-FUND.
           MOVE '99999999' TO WK-OEA-DATE.

           PERFORM 321000-LOOP-TRX-HIST    THRU 321000-EXIT.


       320000-EXIT.
           EXIT.
           EJECT

       321000-LOOP-TRX-HIST.
090165     MOVE 'N' TO TRX-PROCESSING-COMPLETE-SW.
090170
           MOVE 'N'
             TO MOST-RECENT-TRX-SW
090170
           MOVE 'Y'
             TO FIRST-ANI-SWITCH

           MOVE 'N'
             TO FULL-SURRENDER-SWITCH

           MOVE ZEROS TO TOTAL-CLAIMS.
           MOVE ZEROS TO HOLD-CLAIM-AMT.
           MOVE ZEROS TO FIA-TOTAL-CLAIMS.
      *
      *   GET FIRST TRX
      *
091200     MOVE SPACES                     TO DB-PARM-AREA.
091300     MOVE SPACES                     TO DB-COMM-AREA.
091400     MOVE GET-LAST                   IN DB-OPERATIONS
091500       TO OPERATION                  IN DB-PARM-AREA.

091600     MOVE TRANSACTION-HISTORY        IN DB-SEGMENT-MNEMONICS
091700       TO ACCESS-SEGMENT             IN DB-PARM-AREA.
091800     MOVE HOLD-COMPANY-CODE
091900       TO COMPANY-CODE               IN DB-PARM-AREA.
092000     MOVE HOLD-CONTRACT-NO
092100       TO KEY-QUALIFIER              IN DB-PARM-AREA.
092200
098000     CALL 'IVEXAI1' USING DB-PARM-AREA
098100                          GEN-TRX-REC
098200                          DB-COMM-AREA.
098300
092500     IF  NOT SUCCESSFUL-CALL         IN DB-COMM-AREA
092600         MOVE TRX-HIST-READ-ERROR
092700           TO  VCS-ABEND-CODE
092800         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
092810
090210     PERFORM 321100-GET-TRX-INFO
                   UNTIL TRX-PROCESSING-COMPLETE.

       321000-EXIT.
           EXIT.
           EJECT

093300
093400 321100-GET-TRX-INFO.
093400*        DISPLAY '321100-GET-TRX-INFO'.
093500


           MOVE ZEROS TO HOLD-CLAIM-AMT.
      *
      *  IF POLICY HAD FULL SURRENDER ON SAME DATE AS ANI LAST YEAR
      *  WE DON'T WANT TO PRINT ANOTHER STATMENT THIS YEAR
      *
      *
           IF FIRST-ANI
               IF  TRX-CODE       IN ANI-TRX-REC = 'ANI'
                   MOVE 'N' TO FIRST-ANI-SWITCH
               END-IF
           ELSE
               IF  TRX-CODE       IN ANI-TRX-REC = 'ANI'
               AND REVERSAL-CODE  IN GEN-TRX-REC
                   EQUAL  SPACES
                   IF FULL-SURRENDER-FOUND
                       IF  (PROCESS-DATE IN ANI-TRX-REC >
                                   HOLD-SURR-PROC-DATE)
                       AND (EFFECTIVE-DATE IN ANI-TRX-REC >
                                   HOLD-SURR-EFF-DATE)
                           MOVE 'N' TO GET-THIS-SWITCH
                       END-IF
                   END-IF
               END-IF
           END-IF


           IF  TRX-CODE           IN NA-TRX-REC = 'NA'
           OR  TRX-CODE           IN NA-TRX-REC = 'MA'
               IF  REVERSAL-CODE  IN NA-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN NA-TRX-REC
                        = HOLD-ISSUE-DATE

                       COMPUTE HOLD-INITIAL-PAYMENT =
                               HOLD-INITIAL-PAYMENT  +
                               PAYMENT-AMOUNT IN NA-TRX-REC
                   ELSE
      *                CONTINUE
                      IF EXPLORER-CONTRACT
                         IF (EFFECTIVE-DATE IN NA-TRX-REC >=
                             TRX-BEGIN-DATE) AND
                            (EFFECTIVE-DATE IN NA-TRX-REC <=
                             TRX-END-DATE)
                            ADD PAYMENT-AMOUNT IN NA-TRX-REC
                             TO HOLD-1STYR-ADD-PAYMENT
                         ELSE
                            ADD PAYMENT-AMOUNT IN NA-TRX-REC
                             TO HOLD-ADD-PAYMENT
                         END-IF
                      END-IF
                      IF FRONTIERS-II-CONTRACT
                         IF (EFFECTIVE-DATE IN NA-TRX-REC >=
                             TRX-BEGIN-DATE) AND
                            (EFFECTIVE-DATE IN NA-TRX-REC <=
                             TRX-END-DATE)
                            ADD PAYMENT-AMOUNT IN NA-TRX-REC
                             TO HOLD-1STYR-FRNTRII-ADD-PAYMENT
                         ELSE
                            ADD PAYMENT-AMOUNT IN NA-TRX-REC
                             TO HOLD-FRNTRII-ADD-PAYMENT
                         END-IF
                      END-IF
                      IF  FIA-CONTRACT
                      OR  FIA-PA-CONTRACT
                      OR  FIA-INDEX-EDGE-CONTRACT
                      OR  EXPEDITION-CONTRACT
                      OR  MARINER-CONTRACT
                      OR  PIA-CONTRACT
                         ADD PAYMENT-AMOUNT IN NA-TRX-REC
                          TO HOLD-ADD-PAYMENT
                      END-IF
                   END-IF
               END-IF
           END-IF.
      *
           IF  TRX-CODE           IN NA-TRX-REC = 'MA'
               IF  REVERSAL-CODE  IN NA-TRX-REC
                   EQUAL  SPACES
               AND EFFECTIVE-DATE IN NA-TRX-REC NOT = HOLD-ISSUE-DATE
      *                COMPUTE HOLD-INITIAL-PAYMENT =
      *                        HOLD-INITIAL-PAYMENT  +
      *                        PAYMENT-AMOUNT IN NA-TRX-REC
                   COMPUTE HOLD-MA-DUMPIN =
                           HOLD-MA-DUMPIN   +
                               PAYMENT-AMOUNT IN NA-TRX-REC
               ELSE
                   CONTINUE
               END-IF
           END-IF.

      * 'XC' TRANSACTION
           IF EXTRA-CREDIT-TRX IN GEN-TRX-REC
              IF REVERSAL-CODE IN XC-TRX-REC = SPACE
                 IF (EFFECTIVE-DATE IN XC-TRX-REC >= TRX-BEGIN-DATE) AND
                    (EFFECTIVE-DATE IN XC-TRX-REC <= TRX-END-DATE)
                    ADD TOTAL-TRX-AMOUNT IN XC-TRX-REC
                     TO HOLD-CREDIT-ENHANCEMENT
                 END-IF
              END-IF
           END-IF.

           IF  TRX-CODE           IN TA-TRX-REC = 'TA'
               IF  REVERSAL-CODE  IN TA-TRX-REC
                   EQUAL  SPACES
                   MOVE 'Y' TO FULL-SURRENDER-SWITCH
                   MOVE EFFECTIVE-DATE IN TA-TRX-REC
                     TO HOLD-SURR-EFF-DATE
                   MOVE PROCESS-DATE IN TA-TRX-REC
                     TO HOLD-SURR-PROC-DATE

                   IF  EFFECTIVE-DATE IN TA-TRX-REC
                       >= TRX-BEGIN-DATE
                   AND  EFFECTIVE-DATE IN TA-TRX-REC
                       <= TRX-END-DATE

                       MOVE SURRENDER-AMT IN TA-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TA-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TA-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TA-TRX-REC  +
                         FED-TAX-PENALTY        IN TA-TRX-REC

                        COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                        SURRENDER-PENALTY      IN TA-TRX-REC
                        COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                            TOTAL-MVA-AMT  IN TA-TRX-REC
                        COMPUTE WK-TOTAL-FEES = WK-TOTAL-FEES +
                            IAR-FEE        IN TA-TRX-REC
                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES  =
                               WK-FUND-WD-CHARGES   +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  (TRX-CODE      IN GEN-TRX-REC = 'TA  ')
           AND (REVERSAL-CODE IN GEN-TRX-REC = SPACE)
              IF  FIA-CONTRACT
              OR  FIA-PA-CONTRACT
              OR  FIA-INDEX-EDGE-CONTRACT
                 IF  EFFECTIVE-DATE IN GEN-TRX-REC NOT > TRX-END-DATE
                    ADD SURRENDER-AMT IN TA-TRX-REC
                     TO WK-HOLD-POLICY-WITHDRAW
                 END-IF
              END-IF
           END-IF.

           IF  TRX-CODE           IN TZ-TRX-REC = 'TZ'
               IF  REVERSAL-CODE  IN TZ-TRX-REC
                   EQUAL  SPACES
                   MOVE 'Y' TO FULL-SURRENDER-SWITCH
                   MOVE EFFECTIVE-DATE IN TA-TRX-REC
                     TO HOLD-SURR-EFF-DATE
                   MOVE PROCESS-DATE IN TA-TRX-REC
                     TO HOLD-SURR-PROC-DATE

                   IF  EFFECTIVE-DATE IN TZ-TRX-REC
                       >= TRX-BEGIN-DATE
                   AND  EFFECTIVE-DATE IN TZ-TRX-REC
                       <= TRX-END-DATE

                       MOVE ANNUITIZATION-AMOUNT  IN TZ-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TZ-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TZ-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TZ-TRX-REC  +
                         FED-TAX-PENALTY        IN TZ-TRX-REC

                        COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                        SURRENDER-PENALTY      IN TZ-TRX-REC

                        COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                            TOTAL-MVA      IN TZ-TRX-REC

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                               WK-FUND-WD-CHARGES +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TB'
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN TB-TRX-REC NOT = TRX-BEGIN-DATE)))
               IF  REVERSAL-CODE  IN TB-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN TB-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN TB-TRX-REC
                        <= TRX-END-DATE

                       MOVE SURRENDER-AMT IN TB-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TB-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TB-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC  +
                         FED-TAX-PENALTY        IN TB-TRX-REC

                        COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                        SURRENDER-PENALTY      IN TB-TRX-REC

                        COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                                 TOTAL-MVA IN TB-TRX-REC

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                               WK-FUND-WD-CHARGES +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TKM'
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN TB-TRX-REC NOT = TRX-BEGIN-DATE)))
               IF  REVERSAL-CODE  IN TB-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN TB-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN TB-TRX-REC
                        <= TRX-END-DATE

                       MOVE SURRENDER-AMT IN TB-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TB-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TB-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC  +
                         FED-TAX-PENALTY        IN TB-TRX-REC

                         COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                              SURRENDER-PENALTY   IN TB-TRX-REC
                         COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                              TOTAL-MVA IN TB-TRX-REC
                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                               WK-FUND-WD-CHARGES +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TK'
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN TB-TRX-REC NOT = TRX-BEGIN-DATE)))
               IF  REVERSAL-CODE  IN TB-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN TB-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN TB-TRX-REC
                        <= TRX-END-DATE

                       MOVE SURRENDER-AMT IN TB-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TB-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TB-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC  +
                         FED-TAX-PENALTY        IN TB-TRX-REC

                         COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                            SURRENDER-PENALTY      IN TB-TRX-REC
                         COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                            TOTAL-MVA IN TB-TRX-REC
                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                               WK-FUND-WD-CHARGES +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TKS'
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN TB-TRX-REC NOT = TRX-BEGIN-DATE)))
               IF  REVERSAL-CODE  IN TB-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN TB-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN TB-TRX-REC
                        <= TRX-END-DATE

                       MOVE SURRENDER-AMT IN TB-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN TB-TRX-REC  +
                         AMT-WITHHELD-STATE     IN TB-TRX-REC  +
                         AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC  +
                         FED-TAX-PENALTY        IN TB-TRX-REC

                       COMPUTE WK-WD-CHARGES = WK-WD-CHARGES +
                          SURRENDER-PENALTY      IN TB-TRX-REC
                       COMPUTE WK-TOTAL-MVA = WK-TOTAL-MVA +
                          TOTAL-MVA IN TB-TRX-REC

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                               WK-FUND-WD-CHARGES +
                               HOLD-FUND-CLAIM-AMT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE            IN PAD-TRX-REC = 'PAD ' AND
               NON-TERMINATING-PAD IN PAD-TRX-REC          AND
               ((NOT FIA-CONTRACT AND NOT FIA-PA-CONTRACT
                 AND NOT FIA-INDEX-EDGE-CONTRACT) OR
               ((FIA-CONTRACT OR FIA-PA-CONTRACT OR
                 FIA-INDEX-EDGE-CONTRACT ) AND
               (EFFECTIVE-DATE IN PAD-TRX-REC NOT = TRX-BEGIN-DATE)))

               IF  REVERSAL-CODE  IN PAD-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN PAD-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN PAD-TRX-REC
                        <= TRX-END-DATE

                       MOVE TOTAL-PROCEEDS IN PAD-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN PAD-TRX-REC +
                         AMT-WITHHELD-STATE     IN PAD-TRX-REC +
                         AMT-WITHHELD-LOCAL     IN PAD-TRX-REC
                       END-COMPUTE

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES =
                                WK-FUND-WD-CHARGES +
                                HOLD-FUND-CLAIM-AMT
                        END-COMPUTE

                        COMPUTE WK-FUND-CLAIMS  =
                                WK-FUND-CLAIMS  +
                                HOLD-FUND-CLAIM-AMT
                        END-COMPUTE

                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE           IN PAD-TRX-REC = 'PAD ' AND
               TERMINATING-PAD    IN PAD-TRX-REC
               IF  REVERSAL-CODE  IN PAD-TRX-REC
                   EQUAL  SPACES
                   MOVE 'Y' TO FULL-SURRENDER-SWITCH
                   MOVE EFFECTIVE-DATE IN PAD-TRX-REC
                     TO HOLD-SURR-EFF-DATE
                   MOVE PROCESS-DATE IN PAD-TRX-REC
                     TO HOLD-SURR-PROC-DATE

                   IF  EFFECTIVE-DATE IN PAD-TRX-REC
                       >= TRX-BEGIN-DATE
                   AND  EFFECTIVE-DATE IN PAD-TRX-REC
                       <= TRX-END-DATE

                       MOVE TOTAL-PROCEEDS IN PAD-TRX-REC
                       TO   HOLD-CLAIM-AMT

                       COMPUTE WK-TOTAL-TAX = WK-TOTAL-TAX     +
                         AMT-WITHHELD-FED       IN PAD-TRX-REC +
                         AMT-WITHHELD-STATE     IN PAD-TRX-REC +
                         AMT-WITHHELD-LOCAL     IN PAD-TRX-REC
                       END-COMPUTE

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-WD-CHARGES  =
                                WK-FUND-WD-CHARGES  +
                                HOLD-FUND-CLAIM-AMT
                        END-COMPUTE

                        COMPUTE WK-FUND-CLAIMS  =
                                WK-FUND-CLAIMS  +
                                HOLD-FUND-CLAIM-AMT
                        END-COMPUTE

                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE        IN GEN-TRX-REC = 'PAD ' AND
               REVERSAL-CODE   IN GEN-TRX-REC = SPACE
              IF  FIA-CONTRACT
              OR  FIA-PA-CONTRACT
              OR  FIA-INDEX-EDGE-CONTRACT
                 IF  EFFECTIVE-DATE IN GEN-TRX-REC NOT > TRX-END-DATE
                    ADD TOTAL-PROCEEDS IN PAD-TRX-REC
                     TO WK-HOLD-POLICY-WITHDRAW
                 END-IF
              END-IF
           END-IF.

           IF  ((TRX-CODE      IN GEN-TRX-REC = 'TB  ')
           OR   (TRX-CODE      IN GEN-TRX-REC = 'TK  ')
           OR   (TRX-CODE      IN GEN-TRX-REC = 'TKM ')
           OR   (TRX-CODE      IN GEN-TRX-REC = 'TKS '))
           AND (REVERSAL-CODE  IN GEN-TRX-REC = SPACE)
              IF  FIA-CONTRACT
              OR  FIA-PA-CONTRACT
              OR  FIA-INDEX-EDGE-CONTRACT
                 IF  EFFECTIVE-DATE IN GEN-TRX-REC NOT > TRX-END-DATE
                    ADD SURRENDER-AMT IN TB-TRX-REC
                     TO WK-HOLD-POLICY-WITHDRAW
                 END-IF
              END-IF
           END-IF.

           IF  TRX-CODE     IN OE-TRX-REC = 'OE'
               IF  REVERSAL-CODE  IN OE-TRX-REC
                   EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN OE-TRX-REC
                        >= TRX-BEGIN-DATE
                   AND EFFECTIVE-DATE IN OE-TRX-REC
                        <= TRX-END-DATE

                        IF GET-FUND-VALUES
                            PERFORM 321200-GET-FUND-WD-CHARGES
                                            THRU 321200-EXIT
                        COMPUTE WK-FUND-CLAIMS  =
                               WK-FUND-CLAIMS   +
                               HOLD-FUND-CLAIM-AMT
                        END-IF

                   ELSE
                       CONTINUE
                   END-IF
               END-IF
           END-IF.

           IF  TRX-CODE IN OE-TRX-REC = 'OEM'
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN OE-TRX-REC NOT = TRX-BEGIN-DATE)))
              IF  REVERSAL-CODE IN OE-TRX-REC = SPACE
                 IF  ((EFFECTIVE-DATE IN OE-TRX-REC >= TRX-BEGIN-DATE)
                 AND  (EFFECTIVE-DATE IN OE-TRX-REC <= TRX-END-DATE))
                    SET SW-CONT-THIS-ANNIV-DUR TO TRUE
                 ELSE
                    IF  EFFECTIVE-DATE IN OE-TRX-REC > TRX-END-DATE
                       SET SW-CONT-THIS-ANNIV-AFT TO TRUE
                    END-IF
                 END-IF
              END-IF
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'RAI '
              IF  REVERSAL-CODE IN GEN-TRX-REC = SPACE
                 MOVE EFFECTIVE-DATE     IN GEN-TRX-REC
                   TO WK-HOLD-RA-ACTIVATION-DATE
              END-IF
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'RAA '
              MOVE NEW-RATE-IF-ELECTED   IN RAA-TRX-REC
                TO WK-HOLD-NEW-RATE
           END-IF.

           IF  (TRX-CODE IN GEN-TRX-REC = 'WX  ' OR
                TRX-CODE IN GEN-TRX-REC = 'WXI ')
           AND ((NOT FIA-CONTRACT AND
                 NOT FIA-INDEX-EDGE-CONTRACT AND
                 NOT FIA-PA-CONTRACT)
           OR   ((FIA-CONTRACT OR
                  FIA-INDEX-EDGE-CONTRACT OR
                  FIA-PA-CONTRACT)
           AND   (EFFECTIVE-DATE IN WX-TRX-REC NOT = TRX-BEGIN-DATE)))
              IF  (RIDER-FEE IN WX-TRX-REC NUMERIC)
              AND (RIDER-FEE IN WX-TRX-REC > ZERO)
              AND (REVERSAL-CODE IN GEN-TRX-REC = SPACE)
              AND ((EFFECTIVE-DATE IN WX-TRX-REC NOT < TRX-BEGIN-DATE)
              AND  (EFFECTIVE-DATE IN WX-TRX-REC NOT > TRX-END-DATE))
      ***** $114947 START *****
      *          MOVE RIDER-FEE          IN WX-TRX-REC
      *            TO HOLD-CLAIM-AMT
                 IF  EFFECTIVE-DATE IN WX-TRX-REC NOT > TRX-END-DATE
                    MOVE RIDER-FEE       IN WX-TRX-REC
                      TO HOLD-CLAIM-AMT
                 END-IF
      ***** $114947  END  *****
              END-IF
           END-IF.

           IF  (TRX-CODE IN GEN-TRX-REC = 'WXD ')
              IF  (RIDER-FEE IN WXD-TRX-REC NUMERIC)
              AND (RIDER-FEE IN WXD-TRX-REC > ZERO)
              AND (REVERSAL-CODE IN GEN-TRX-REC = SPACE)
              AND ((EFFECTIVE-DATE IN WXD-TRX-REC NOT < TRX-BEGIN-DATE)
              AND  (EFFECTIVE-DATE IN WXD-TRX-REC NOT > TRX-END-DATE))
                MOVE RIDER-FEE     IN WXD-TRX-REC
                 TO HOLD-CLAIM-AMT
              END-IF
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEA '
              IF  EFFECTIVE-DATE IN GEN-TRX-REC = TRX-BEGIN-DATE
                 MOVE EFFECTIVE-DATE     IN OE-TRX-REC
                   TO WK-OEA-DATE
                 PERFORM VARYING SUB2 FROM +1 BY +1
                   UNTIL (SUB2 > POLICY-MAX-FUNDS)
                      OR (FUND-NUMBER IN OE-TRX-REC (SUB2) =
                          FUND-NUMBER-DEFAULT)
                      OR (WK-OEA-FROM-FUND NOT = +999)

                    IF  FROM-FUND IN OE-TRX-REC (SUB2)
                       MOVE FUND-NUMBER  IN OE-TRX-REC (SUB2)
                         TO WK-OEA-FROM-FUND
                    END-IF

                 END-PERFORM
              END-IF
           END-IF.

           COMPUTE TOTAL-CLAIMS =
                TOTAL-CLAIMS + HOLD-CLAIM-AMT.
095220
           COMPUTE FIA-TOTAL-CLAIMS =
                FIA-TOTAL-CLAIMS + HOLD-CLAIM-AMT.
095220

095300     MOVE GET-PRIOR                  IN DB-OPERATIONS
095400       TO OPERATION                  IN DB-PARM-AREA.
095500
095600     MOVE SEGMENT-KEY                IN DB-COMM-AREA
095700       TO SEGMENT-KEY                IN DB-PARM-AREA.
095800
098000     CALL 'IVEXAI1' USING DB-PARM-AREA
098100                          GEN-TRX-REC
098200                          DB-COMM-AREA.
098300
096100     IF  SUCCESSFUL-CALL             IN DB-COMM-AREA
096200*        GO TO 321100-EXIT.
096300         CONTINUE
           ELSE
096400         MOVE 'Y' TO TRX-PROCESSING-COMPLETE-SW
096500
096600         IF  END-KEY                     IN DB-COMM-AREA
096700         OR  END-OF-FILE                 IN DB-COMM-AREA
096800         OR  RECORD-NOT-FOUND            IN DB-COMM-AREA
096900             CONTINUE
097000         ELSE
097100             MOVE TRX-HIST-READ-ERROR
097200               TO  VCS-ABEND-CODE
097300             PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
               END-IF
097400     END-IF.

097500 321100-EXIT.
097600     EXIT.
097700
097710
       321200-GET-FUND-WD-CHARGES.
      *     display ' 321200-GET-FUND-WD-CHARGES'.
093300

           IF  TRX-CODE     IN OE-TRX-REC = 'OE'
               PERFORM VARYING WS-POL-FUND-SUB FROM 1 BY 1
                  UNTIL WS-POL-FUND-SUB > 99
                  OR FUND-NUMBER IN OE-TRX-REC  (WS-POL-FUND-SUB)
                                        = 999

                   IF FUND-NUMBER IN OE-TRX-REC  (WS-POL-FUND-SUB)
                          =
                      HOLD-TERM-FUND (TERM-SUB)

                       IF FROM-FUND   IN OE-TRX-REC
                                                (WS-POL-FUND-SUB)
                           COMPUTE HOLD-TRANSFER-AMT =
                                   HOLD-TRANSFER-AMT -
                                   PARTICIPATION-AMOUNT IN OE-TRX-REC
                                                (WS-POL-FUND-SUB)
                       ELSE
                           IF TO-FUND   IN OE-TRX-REC
                                                (WS-POL-FUND-SUB)
                           AND
                              FILE-CODE   IN OE-TRX-REC
                                    =
                              HOLD-TERM-DEPOSIT-CODE (TERM-SUB)

                               COMPUTE
                                HOLD-TRANSFER-AMT =
                                HOLD-TRANSFER-AMT +
                                   PARTICIPATION-AMOUNT IN OE-TRX-REC
                                                (WS-POL-FUND-SUB)
                           END-IF
                       END-IF


                       COMPUTE WK-FUND-TOTAL-MVA =
                               WK-FUND-TOTAL-MVA +
                            FUND-MVA-AMT  IN OE-TRX-REC
                                                (WS-POL-FUND-SUB)
                   END-IF
               END-PERFORM
           END-IF.

           IF  TRX-CODE     IN TA-TRX-REC = 'TA'
               PERFORM VARYING WS-POL-FUND-SUB FROM 1 BY 1
                  UNTIL WS-POL-FUND-SUB > 99
                  OR FUND-NUMBER IN TA-TRX-REC  (WS-POL-FUND-SUB)
                                        = 999

                   IF FUND-NUMBER IN TA-TRX-REC  (WS-POL-FUND-SUB)
                          =
                      HOLD-TERM-FUND (TERM-SUB)

                       MOVE FUND-AMT-SURRENDERED   IN TA-TRX-REC
                                                (WS-POL-FUND-SUB)
                       TO   HOLD-FUND-CLAIM-AMT

                       COMPUTE WK-FUND-TOTAL-TAX =
                         WK-FUND-TOTAL-TAX       +
                         FUND-FED-TAX-PENALTY   IN TA-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-STATE-TAX         IN TA-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-AREA-TAX          IN TA-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-PENALTY =
                                WK-FUND-PENALTY +
                        FUND-SURRENDER-PENALTY  IN TA-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-TOTAL-MVA =
                                WK-FUND-TOTAL-MVA +
                            FUND-MVA-AMT  IN TA-TRX-REC
                                                (WS-POL-FUND-SUB)
                    END-IF
                END-PERFORM
            END-IF.
           IF  TRX-CODE     IN TZ-TRX-REC = 'TZ'
               PERFORM VARYING WS-POL-FUND-SUB FROM 1 BY 1
                  UNTIL WS-POL-FUND-SUB > 99
                  OR FUND-NUMBER IN TZ-TRX-REC  (WS-POL-FUND-SUB)
                                        = 999

                   IF FUND-NUMBER IN TZ-TRX-REC  (WS-POL-FUND-SUB)
                          =
                      HOLD-TERM-FUND (TERM-SUB)

                       MOVE FUND-AMT-ANNUITIZED   IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB)
                       TO   HOLD-FUND-CLAIM-AMT

                       COMPUTE WK-FUND-TOTAL-TAX =
                         WK-FUND-TOTAL-TAX +
                         FUND-FED-TAX-PENALTY   IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-PREMIUM-TAX       IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-AREA-TAX          IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-PENALTY =
                                WK-FUND-PENALTY +
                        FUND-SURRENDER-PENALTY  IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-TOTAL-MVA =
                                WK-FUND-TOTAL-MVA +
                            FUND-MVA-AMT  IN TZ-TRX-REC
                                                (WS-POL-FUND-SUB)
                    END-IF
                END-PERFORM
            END-IF.
           IF  TRX-CODE           IN TB-TRX-REC = 'TB'
           OR  TRX-CODE           IN TB-TRX-REC = 'TKM'
           OR  TRX-CODE           IN TB-TRX-REC = 'TK'
           OR  TRX-CODE           IN TB-TRX-REC = 'TKS'
               PERFORM VARYING WS-POL-FUND-SUB FROM 1 BY 1
                  UNTIL WS-POL-FUND-SUB > 99
                  OR FUND-NUMBER IN TB-TRX-REC  (WS-POL-FUND-SUB)
                                        = 999

                   IF FUND-NUMBER IN TB-TRX-REC  (WS-POL-FUND-SUB)
                          =
                      HOLD-TERM-FUND (TERM-SUB)
                       MOVE FUND-AMT-SURRENDERED   IN TB-TRX-REC
                                                (WS-POL-FUND-SUB)
                       TO   HOLD-FUND-CLAIM-AMT

                       COMPUTE WK-FUND-TOTAL-TAX =
                               WK-FUND-TOTAL-TAX +
                         FUND-FED-TAX-PENALTY   IN TB-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-STATE-TAX         IN TB-TRX-REC
                                                (WS-POL-FUND-SUB) +
                         FUND-AREA-TAX          IN TB-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-PENALTY =
                                WK-FUND-PENALTY +
                        FUND-SURRENDER-PENALTY  IN TB-TRX-REC
                                                (WS-POL-FUND-SUB)

                        COMPUTE WK-FUND-TOTAL-MVA =
                                WK-FUND-TOTAL-MVA +
                                FUND-MVA-AMT  IN TB-TRX-REC
                                                (WS-POL-FUND-SUB)
                    END-IF
                END-PERFORM
            END-IF.

           IF TRX-CODE           IN PAD-TRX-REC = 'PAD '
               PERFORM VARYING WS-POL-FUND-SUB FROM 1 BY 1
                  UNTIL WS-POL-FUND-SUB > 99
                  OR FUND-NUMBER IN PAD-TRX-REC (WS-POL-FUND-SUB)
                                        = 999

                   IF FUND-NUMBER IN PAD-TRX-REC (WS-POL-FUND-SUB)
                      = HOLD-TERM-FUND (TERM-SUB)
                       MOVE FUND-AMT-SURRENDERED   IN PAD-TRX-REC
                                                (WS-POL-FUND-SUB)
                       TO   HOLD-FUND-CLAIM-AMT
                   END-IF
                END-PERFORM
            END-IF.

097500 321200-EXIT.
097600     EXIT.
097700     EJECT
       400000-CHK-FOR-RIDERS.

           MOVE SPACE TO SW-RIDERS-ON-POLICY-SW
                         SW-ACTIVE-RIDERS-SW
                         SW-END-OF-RIDERS-SW.

           MOVE ZEROS TO WK-GMWB-PAYBASE
                         HOLD-FIA-INTEREST
                         HOLD-FIA-WITHDRAW
                         HOLD-FIA-WDCHARGE
                         FIA-CV-WITHDRAWAL-CHRGS
                         STMT-GMWB-PAY-BASE
                         STMT-TOTAL-WITHDRAW.

           PERFORM 600000-GET-FIRST-RIDER THRU 600000-EXIT.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              GO TO 400000-EXIT
           END-IF.

           IF  PIA-CONTRACT
              IF  (RIDER-START-DATE IN RIDER-SEGMENT NOT >
                   TRX-BEGIN-DATE)
              AND ((RIDER-END-DATE  IN RIDER-SEGMENT NOT >
                    TRX-END-DATE)
              OR   (RIDER-END-DATE  IN RIDER-SEGMENT = '99999999'))
                 IF RIDER-SUB-TYPE IN RIDER-SEGMENT (1:1) = 'S'
                    MOVE 'SINGLE' TO WK-RIDER-NAME
                 ELSE
                    MOVE 'JOINT ' TO WK-RIDER-NAME
                 END-IF
              END-IF
           END-IF.

           IF  RIDER-TYPE   IN RIDER-SEGMENT = 'EDB'
               CONTINUE
           ELSE
           IF  RIDER-ACTIVE IN RIDER-SEGMENT
           AND (RIDER-START-DATE IN RIDER-SEGMENT < TRX-END-DATE)
              SET SW-RIDERS-ON-POLICY TO TRUE
              GO TO 400000-EXIT
           END-IF.

           PERFORM 401000-NEXT-RIDER THRU 401000-EXIT
             UNTIL SW-END-OF-RIDERS.

       400000-EXIT.
           EXIT.
           EJECT
       401000-NEXT-RIDER.

           PERFORM 610000-GET-NEXT-RIDER THRU 610000-EXIT.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-RIDERS TO TRUE
              GO TO 401000-EXIT
           END-IF.

           IF  PIA-CONTRACT
              IF  (RIDER-START-DATE IN RIDER-SEGMENT NOT >
                   TRX-BEGIN-DATE)
              AND ((RIDER-END-DATE  IN RIDER-SEGMENT NOT >
                    TRX-END-DATE)
              OR   (RIDER-END-DATE  IN RIDER-SEGMENT = '99999999'))
                 IF RIDER-SUB-TYPE IN RIDER-SEGMENT (1:1) = 'S'
                    MOVE 'SINGLE' TO WK-RIDER-NAME
                 ELSE
                    MOVE 'JOINT ' TO WK-RIDER-NAME
                 END-IF
              END-IF
           END-IF.

           IF  RIDER-TYPE   IN RIDER-SEGMENT = 'EDB'
               CONTINUE
           ELSE
           IF  RIDER-ACTIVE IN RIDER-SEGMENT
              SET SW-RIDERS-ON-POLICY TO TRUE
              SET SW-END-OF-RIDERS    TO TRUE
              GO TO 401000-EXIT
           END-IF.

       401000-EXIT.
           EXIT.
           EJECT
       402000-GET-RATE-SEGS.

           IF  EXPEDITION-CONTRACT
           OR  MARINER-CONTRACT
              PERFORM 402100-FIXED-RATES  THRU 402100-EXIT
              GO TO 402000-EXIT
           END-IF.

           MOVE SPACES TO DB-PARM-AREA.
           INITIALIZE RATE-SEGMENT-KEY.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN RATE-SEGMENT-KEY.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN RATE-SEGMENT-KEY.
           MOVE GET-LAST                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE INDEX-RATES              IN DB-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.
           MOVE TRX-END-DATE TO WK-RENEWAL-DATE.
           MOVE WK-RENEWAL-DATE
             TO NEXT-RENEWAL-DATE        IN RATE-SEGMENT-KEY
                NEXT-RENEWAL-DATE        IN RATE-SEGMENT.
           MOVE 'R' TO WK-RATE-TYPE.

      ***** $T157090 START *****
      *    MOVE RATE-SEGMENT-KEY
      *      TO SECONDARY-KEY            IN DB-PARM-AREA.
      *
      *    CALL 'IVEXAI1' USING DB-PARM-AREA
      *                         RATE-SEGMENT
      *                         DB-COMM-AREA.
      *    IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
      *       MOVE RATE-SEGMENT-NOT-FOUND TO VCS-ABEND-CODE
      *       PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
      *       GO TO 402000-EXIT
      *    END-IF.
      *
      *    MOVE SEGMENT-KEY              IN DB-COMM-AREA
      *      TO RATE-SEGMENT-KEY.
           CALL 'MUAFRW1' USING POLICY-SEG
                                RATE-SEGMENT-KEY
                                RATE-SEGMENT
                                WK-RATE-TYPE
                                WK-RETURN-CODE.

           GO TO 402000-EXIT.

      *    MOVE HOLD-COMPANY-CODE
      *      TO COMPANY-CODE             IN DB-PARM-AREA.
      *    MOVE HOLD-CONTRACT-NO
      *      TO KEY-QUALIFIER            IN DB-PARM-AREA.
      *    MOVE GET-PRIOR                IN DB-OPERATIONS
      *      TO OPERATION                IN DB-PARM-AREA.
      *    MOVE INDEX-RATES              IN DB-MNEMONICS
      *      TO ACCESS-SEGMENT           IN DB-PARM-AREA.
      *
      *    MOVE RATE-SEGMENT-KEY
      *      TO SECONDARY-KEY            IN DB-PARM-AREA.
      *
      *    CALL 'IVEXAI1' USING DB-PARM-AREA
      *                         PREV-RATE-SEGMENT
      *                         DB-COMM-AREA.
      *    IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
      *       MOVE RATE-SEGMENT TO PREV-RATE-SEGMENT
      *    END-IF.
      *
      ***** $T157090  END  *****

       402000-EXIT.
           EXIT.
           EJECT
       402100-FIXED-RATES.

           MOVE SPACES TO DB-PARM-AREA.
           INITIALIZE RATE-SEGMENT-KEY.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN FIXED-RATE-SEG-KEY.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN FIXED-RATE-SEG-KEY.
           MOVE GET-LAST                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE FIXED-RATES              IN DB-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           MOVE FIXED-RATE-SEG-KEY
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                FIXED-RATE-SEG
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE RATE-SEGMENT-NOT-FOUND TO VCS-ABEND-CODE
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
              GO TO 402100-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO FIXED-RATE-SEG-KEY.

           PERFORM 402110-PRIOR-RATES THRU 402110-EXIT
             UNTIL EFFECTIVE-DATE IN FIXED-RATE-SEG NOT >
                   TRX-BEGIN-DATE.

       402100-EXIT.
           EXIT.
           EJECT
       402110-PRIOR-RATES.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE GET-PRIOR                IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE FIXED-RATES              IN DB-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           MOVE FIXED-RATE-SEG-KEY
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                FIXED-RATE-SEG
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              GO TO 402110-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO FIXED-RATE-SEG-KEY.

       402110-EXIT.
           EXIT.
           EJECT

       410000-GET-REC-10.

           MOVE ZEROS
             TO KEY-DEFINITION.

           MOVE SPACES
             TO DATA-DEFINITION-AREA.

           MOVE STATUTORY-COMPANY-CODE IN           POLICY-SPEC-RECORD
             TO HOLD-COMPANY-CODE.

      * $T189473 - REMOVED HARDCODED AGENT ID THAT WAS PROMOTED IN ERROR

      *    MOVE SERVICING-AGENT        IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENT
             TO REP-NO                 IN           KEY-DEFINITION
                HOLD-AGENT-ID.

      *    MOVE SERVICING-AGENCY-CODE IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENCY
             TO BROKER-NO             IN           KEY-DEFINITION
                HOLD-BROKER-NO.

           MOVE POLICY-NUMBER    IN     POLICY-SPEC-RECORD (6:10)
             TO  OWN-POLICY-NUMBER
                 POLICY-NUMBER        IN           KEY-DEFINITION.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.

           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC.


           MOVE POLICY-NUMBER    IN     POLICY-SPEC-RECORD
             TO  HOLD-CONTRACT-NO.

           MOVE  WK-CONTROL-YY
             TO  STMT-CYCLE-CCYY.
           MOVE  WK-CONTROL-MM
             TO  STMT-CYCLE-MM.
           MOVE  WK-CONTROL-DD
             TO  STMT-CYCLE-DD.
      *
      *  LEAVE BLANK FOR NOW, SUPPORTING REQUESTED STATEMENTS IN
      *  THE FUTURE
      *
           MOVE  ' '
             TO  STMT-REQUEST-IND.


           MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
             TO  STMT-START
                 TRX-BEGIN-DATE.

           MOVE  STATEMENT-END-DATE IN POLICY-SPEC-RECORD
             TO  STMT-END
                 TRX-END-DATE.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
      *       MOVE STMT-START
              MOVE STMT-END
                TO BASE-DATE             IN DATE-ARITHMETIC-AREA
                   RETURN-DATE           IN DATE-ARITHMETIC-AREA
      ***** $T92005 START *****
      *       MOVE +1
      *         TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
      *       MOVE ZERO
      *         TO CHANGE-DATE-MMM       IN DATE-ARITHMETIC-AREA
      *            CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
              MOVE ZERO
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
                   CHANGE-DATE-MMM       IN DATE-ARITHMETIC-AREA
              MOVE +1
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
      ***** $T92005  END  *****

              CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA

              MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                TO STMT-END
                   TRX-END-DATE
           END-IF.

           IF POLICY-ISSUE-DATE          OF POLICY-SPEC-RECORD
                           =
                     STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD

               MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                 TO  HOLD-VAL-BEGIN-DATE
           ELSE

               MOVE  STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                 TO  BASE-DATE
               MOVE  0                    TO  CHANGE-DATE-YYY
               MOVE  0                    TO  CHANGE-DATE-MMM
               MOVE  -1                   TO  CHANGE-DATE-DDD
               CALL  'IUAXF85'         USING  DATE-ARITHMETIC-AREA
               MOVE  RETURN-DATE-MM       TO  VAL-BEGIN-DATE-MM
               MOVE  RETURN-DATE-DD       TO  VAL-BEGIN-DATE-DD
               MOVE  RETURN-DATE-YYYY     TO  VAL-BEGIN-DATE-CCYY
      ***** $114384 START *****
               IF  FIA-CONTRACT
               OR  FIA-PA-CONTRACT
               OR  FIA-INDEX-EDGE-CONTRACT
                  MOVE STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD
                    TO HOLD-VAL-BEGIN-DATE
               END-IF
      ***** $114384  END  *****
           END-IF.

           MOVE  STATEMENT-END-DATE IN POLICY-SPEC-RECORD
             TO  HOLD-VAL-END-DATE.


      *
      *   GET OWN NAME AND ADDRESS
      *
           MOVE SPACE                        TO DB-PARM-AREA.
           MOVE SPACE                        TO DB-COMM-AREA.
           MOVE SPACE                     TO NAME-ADDRESS-SEGMENT.
           MOVE GET-FIRST                    OF DB-OPERATIONS
                TO OPERATION                 OF DB-PARM-AREA.
           MOVE V1-OWNER                     OF DB-MNEMONICS
                TO ACCESS-SEGMENT            OF DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE              OF DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
                TO KEY-QUALIFIER             OF DB-PARM-AREA.

           PERFORM 941000-GET-NAME-ADDRESS    THRU 941000-EXIT.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
               MOVE 'NONE'
                 TO OWN-NAME
           ELSE
               MOVE FIRST-NAME               OF NAME-ADDRESS-SEGMENT
                 TO OWN-FIRST-NAME
               MOVE LAST-NAME                OF NAME-ADDRESS-SEGMENT
                 TO OWN-LAST-NAME
               MOVE NAME-PREFIX              OF NAME-ADDRESS-SEGMENT
                 TO OWN-PREFIX
               MOVE NAME-SUFFIX              OF NAME-ADDRESS-SEGMENT
                 TO OWN-SUFFIX
           END-IF.

           MOVE COMPANY-INDIVIDUAL-CODE  OF NAME-ADDRESS-SEGMENT
             TO OWN-COMP-IND.

           MOVE ADDRESS-LINE-1        OF NAME-ADDRESS-SEGMENT
             TO OWN-ADR-LINE-1.

           MOVE ADDRESS-LINE-2        OF NAME-ADDRESS-SEGMENT
             TO OWN-ADR-LINE-2.

           MOVE ADDRESS-LINE-3        OF NAME-ADDRESS-SEGMENT
             TO OWN-ADR-LINE-3.

           MOVE ADDRESS-LINE-4        OF NAME-ADDRESS-SEGMENT
             TO OWN-ADR-LINE-4.

           MOVE ADDRESS-LINE-5        OF NAME-ADDRESS-SEGMENT
             TO OWN-ADR-LINE-5.

           MOVE CITY                  OF NAME-ADDRESS-SEGMENT
             TO OWN-CITY.

           MOVE STATE                 OF NAME-ADDRESS-SEGMENT
             TO OWN-STATE.

           MOVE ZIP-POSTAL-CODE       OF NAME-ADDRESS-SEGMENT
             TO OWN-ZIP.

           MOVE SOC-SEC-NUMBER        OF NAME-ADDRESS-SEGMENT(1:9)
             TO HD-OWNER-SSN.

           MOVE SPACES                 TO WS-FILE-ADDRESS.

           MOVE SPACES                 TO AV-ADDR-IN
                                          AV-ADDR-OUT
                                          AV-BARCODE.

           MOVE ADDRESS-LINE-1        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(1)
           MOVE ADDRESS-LINE-2        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(2)
           MOVE ADDRESS-LINE-3        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(3)
           MOVE ADDRESS-LINE-4        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(4)
           MOVE CITY                  OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-CITY
           MOVE STATE                 OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-STATE

           MOVE ZIP-POSTAL-CODE   OF NAME-ADDRESS-SEGMENT (1:5)
                                           TO AV-ADDR-IN-ZIP-PREFIX
           IF  ZIP-POSTAL-CODE    OF NAME-ADDRESS-SEGMENT (6:4)
                                      NOT EQUAL SPACES
               MOVE '-'                    TO AV-ADDR-IN-ZIP-HYPHEN
               MOVE ZIP-POSTAL-CODE OF NAME-ADDRESS-SEGMENT(6:4)
                                           TO AV-ADDR-IN-ZIP-SUFFIX
           ELSE
              MOVE '-'                   TO AV-ADDR-IN-ZIP-HYPHEN
              MOVE '0000'                TO AV-ADDR-IN-ZIP-SUFFIX


           END-IF.

           PERFORM 941500-CALL-FINALIST THRU 941500-EXIT.

           MOVE AV-BARCODE
             TO BAR-CODE.

           MOVE SOC-SEC-NUMBER     IN      POLICY-SPEC-RECORD (1:9)
             TO SSN-NO
                HOLD-SSN
                KEY-SSN.

           MOVE COMPANY-INDIV-CODE  IN      POLICY-SPEC-RECORD
             TO SSN-FMT-CD.


      *
      *
      *  4 POSSIBLE VALUES FOR PRINT CODE AS FOLLOWS
      *  ADD LOGIC IN FUTURE FOR ELECTRONIC STATEMENTS
      *
      *     0 = NO STATEMENT.
      *     1 = PRINTED STATEMENT ONLY.
      *     2 = ELECTRONIC STATEMENT ONLY
      *     3 = PRINTED AND ELECTRONIC STATMENT
      *
      *
      *  As part of Frontiers II all files will be combined.
      *  Change print code to 'Y' or 'N' for all
      *
      *


           MOVE SPACE
             TO SUPPRESS-REASON-SW    IN OWN-RECORD

           IF DEATH-STATUS IN POLICY-SEG
               MOVE '0'       TO PRINT-CD
               MOVE 'D' TO SUPPRESS-REASON-SW IN OWN-RECORD
           ELSE
               MOVE  '3'
                 TO  PRINT-CD
           END-IF
           IF  ADDR-STATUS IN NAME-ADDRESS-SEGMENT = 'B'
      *          MOVE '0' TO PRINT-CD
                 MOVE '2' TO PRINT-CD
                 MOVE 'E' TO MAIL-SW
                 MOVE 'B' TO SUPPRESS-REASON-SW IN OWN-RECORD
                 PERFORM 510000-BAD-ADDR THRU 510000-EXIT
           END-IF.
           IF  EXPLORER-CONTRACT
              IF  PRINT-CD = '0'
                 MOVE 'N' TO PRINT-CD
              ELSE
                 MOVE 'Y' TO PRINT-CD
              END-IF
              IF  ADDR-STATUS IN NAME-ADDRESS-SEGMENT = 'B'
                 MOVE 'N' TO PRINT-CD
                 MOVE 'E' TO MAIL-SW
                 MOVE 'B' TO SUPPRESS-REASON-SW IN OWN-RECORD
      ***** $W6165C START *****
                 PERFORM 510000-BAD-ADDR THRU 510000-EXIT
      ***** $W6165C  END  *****
              END-IF
      ***** $W6165C START *****
           ELSE
              IF  ADDR-STATUS IN NAME-ADDRESS-SEGMENT = 'B'
      *          MOVE '0' TO PRINT-CD
                 MOVE '2' TO PRINT-CD
                 MOVE 'B' TO SUPPRESS-REASON-SW IN OWN-RECORD
                 PERFORM 510000-BAD-ADDR THRU 510000-EXIT
              END-IF
      ***** $W6165C  END  *****
           END-IF.

      *************************************************************
      **** B/D'S THAT DO NOT WANT OWNER COPIES:
      ****   MERRILL LYNCH     (TAX ID 133180817)
      ****   PERSHING          (TAX ID 132741729)
      ****   WACHOVIA (ARVEST) (TAX ID 232384840)
      ****   HILLIARD LYONS    (TAX ID 262333067)
      ****   BNY               (TAX ID 391939036)
      ****   MORGAN STANLEY    (TAX ID 510116113)
      ****   WACHOVIA          (TAX ID 561354525)
      ****   HILLIARD LYONS    (TAX ID 610734935)
      ****   MORGAN KEEGAN     (TAX ID 640474907)
      ****   WELLS FARGO       (TAX ID 911374280)
      ****   UBS               (TAX ID 132638166)
      ****   RAYMOND JAMES     (TAX ID 591237041)
      ****   JANNEY MONTGOMERY (TAX ID 232211143)
      ****   RW BAIRD          (TAX ID 396037917)
      ****   RBC               (TAX ID 411416330)
      ****   PERSHING/STC      (TAX ID 841474151)
      ****   MORGAN STANLEY    (TAX ID 264310844)
      ****   EDWARD JONES      (TAX ID 430345811)
      *********************************************************
      ******************************************************************
      * Note:  Any changes to Custodian Suppression should be sync'd   *
      *        with VPASTMX (variable STMT program).                   *
      *        o print code will suppress the online stmt and will     *
      *        not print a hard copy.  Use an N to only suppress       *
      *        the hard copy and let you see the the online version.   *
      ******************************************************************
           IF  CUSTODIAN-ACCT-SUPPRESSION
                IF  EXPLORER-CONTRACT
      *             DISPLAY 'EXPLORER PRINT CD B4 =' PRINT-CD
      *             DISPLAY 'OWNER SSN =' HD-OWNER-SSN
                    MOVE '0'       TO PRINT-CD
                    MOVE 'C' TO SUPPRESS-REASON-SW IN OWN-RECORD
                ELSE
                  IF PCL-CONTRACT
                  OR PROVIDER-CONTRACT
                    MOVE 'N'       TO PRINT-CD
                  ELSE
      *             DISPLAY 'PRINT CD B4 =' PRINT-CD
      *             DISPLAY 'OWNER SSN =' HD-OWNER-SSN
                    MOVE '0'       TO PRINT-CD
                    MOVE 'C' TO SUPPRESS-REASON-SW IN OWN-RECORD
                  END-IF
                END-IF
           END-IF.

           IF EXTRACT-COMPANY IN EXTRACT-REC    = '101'
              AND PGO-SERVICING-AGENCY          = ' 15000'
              AND PGO-SERVICING-AGENT(6:5)      = '15001'
                  MOVE '1-866-722-9306'
                    TO STMT-CUST-SERV-PHONE
           ELSE
               MOVE HOLD-CUST-SERV-PHONE
                 TO STMT-CUST-SERV-PHONE
           END-IF.

      *    MOVE 'M101INVI23' TO MSG-NO-1
      *    MOVE 'M101INVI24' TO MSG-NO-2
      *    MOVE 'M101INVI25' TO MSG-NO-3

           IF EXPLORER-CONTRACT
              MOVE SPACES TO INVESTOR-MESSAGE
              IF (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C02') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C06') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CP6')
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPL01' DELIMITED BY SIZE
                   INTO MSG-NO-1
              END-IF
           END-IF.

      *
      * FIA HAS TWO MESSAGES, MXXXPICA01 IF YOU ARE NOT A CONTINUED
      * CONTRACT AND MXXXPICA02 IF YOUR CONTRACT IS CONTINUED. XXX =
      * COMPANY CODE, CURRENTLY EITHER 101 OR 111.
      *
           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              MOVE SPACES TO MSG-NO-1
                             MSG-NO-2
                             MSG-NO-3
      ***** $T87159 START *****
      *       IF  (POLICY-STATUS IN POLICY-SEG = '2')
      *       OR  ((POLICY-STATUS IN POLICY-SEG = 'A')
      *       AND  (SPOUSAL-CONTINUATION-INDICATOR IN POLICY-SEG = 'C'))
              IF  SW-CONTRACT-DEATH-STATUS
      ***** $T87159  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA02' DELIMITED BY SIZE
                   INTO MSG-NO-1
              ELSE
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA01' DELIMITED BY SIZE
                   INTO MSG-NO-1
              END-IF
           END-IF.

      *
      * EXPEDITION HAS TWO MESSAGES, ALL CONTRACTS GET MXXXEXPD01. IF
      * THE CONTRACT HAS RATE ADVANTAGE, THAT CONTRACT WILL ALSO GET
      * MXXXEXPE02.
      *
           IF  EXPEDITION-CONTRACT
              MOVE SPACES TO MSG-NO-1
                             MSG-NO-2
                             MSG-NO-3
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'EXPD01' DELIMITED BY SIZE
                INTO MSG-NO-1
      ***** $T97872 START *****
      *       IF  (PLAN-CODE IN POLICY-SEG = '006715')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06715')
      *       OR  (PLAN-CODE IN POLICY-SEG = '006717')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06717')
              IF  ((PLAN-CODE IN POLICY-SEG = '006715')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06715')
              OR   (PLAN-CODE IN POLICY-SEG = '006717')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06717'))
              AND ((RATE-CHANGE-XFER-DATE-R IN POLICY-SEG NOT =
                    99999999)
              OR   (WK-HOLD-RA-ACTIVATION-DATE > TRX-END-DATE))
      ***** $T97872  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPD02' DELIMITED BY SIZE
                   INTO MSG-NO-2
              END-IF
           END-IF.

      *
      * MARINER HAS JUST ONE MESSAGE AND ALL CONTRACTS GET IT.
      *
           IF  MARINER-CONTRACT
              MOVE SPACES TO MSG-NO-1
                             MSG-NO-2
                             MSG-NO-3
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'MARN01' DELIMITED BY SIZE
                INTO MSG-NO-1
           END-IF.

           IF  PIA-CONTRACT
              MOVE SPACES TO MSG-NO-1
                             MSG-NO-2
                             MSG-NO-3
           END-IF.

           IF PGO-SERVICING-AGENCY = ' PSD00'
              MOVE 'M000PSD001'
                TO MSG-NO-3
           ELSE
              IF PGO-SERVICING-AGENCY = ' 15000'
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'ORP002' DELIMITED BY SIZE
                   INTO MSG-NO-3
              END-IF
           END-IF

      *
      *   WRITE OUT RECORD TYPE 10
      *    DISPLAY 'WRITE OUT RECORD TYPE 10'
      *
           MOVE   '10'
             TO   RECORD-TYPE

           IF      ORIG-STMT-OF-ACCT-E-MAIL
                                       IN POLICY-SEG
           AND NOT CUSTODIAN-ACCT-SUPPRESSION
               MOVE STATUTORY-COMPANY-CODE IN POLICY-SEG
                 TO  VP-IN-COMPANY-CODE    IN W-VPAWEML-PARAMETER
               MOVE SOC-SEC-NUMBER         IN NAME-ADDRESS-SEGMENT(1:9)
                 TO  VP-IN-TAX-ID-SSN      IN W-VPAWEML-PARAMETER
                     HOLD-OWNER-SSN
               PERFORM 970000-GET-EMAIL-DETAILS THRU 970000-EXIT
               MOVE HOLD-ROLE-EMAIL-SEQ
                 TO OWN-EMAIL-ADDRESS-SEQ
               MOVE HOLD-ROLE-EMAIL
                 TO OWN-EMAIL-ADDRESS
           END-IF.

           WRITE ANNL-STMNT    FROM    STMTEX-LINE.


       410000-EXIT.
           EXIT.


       415000-REC-15.

           MOVE ZEROS
             TO KEY-DEFINITION.

           MOVE SPACES
             TO DATA-DEFINITION-AREA.

           MOVE STATUTORY-COMPANY-CODE IN           POLICY-SPEC-RECORD
             TO HOLD-COMPANY-CODE.

      *    MOVE SERVICING-AGENT        IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENT
             TO REP-NO                 IN           KEY-DEFINITION
                HOLD-AGENT-ID.

      *    MOVE SERVICING-AGENCY-CODE IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENCY
             TO BROKER-NO             IN           KEY-DEFINITION
                HOLD-BROKER-NO.

           MOVE POLICY-NUMBER    IN     POLICY-SPEC-RECORD (6:10)
             TO  OWN-POLICY-NUMBER
                 POLICY-NUMBER        IN           KEY-DEFINITION.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.

           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC


      *
      *   GET ANNUITANT NAME AND ADDRESS
      *
           MOVE SPACE                        TO DB-PARM-AREA.
           MOVE SPACE                        TO DB-COMM-AREA.
           MOVE SPACE                     TO NAME-ADDRESS-SEGMENT.
           MOVE GET-FIRST                    OF DB-OPERATIONS
                TO OPERATION                 OF DB-PARM-AREA.
           MOVE PARTICIPANT-NAME-ADDRESS     OF DB-MNEMONICS
                TO ACCESS-SEGMENT            OF DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE              OF DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
                TO KEY-QUALIFIER             OF DB-PARM-AREA.

           PERFORM 941000-GET-NAME-ADDRESS THRU 941000-EXIT.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
               MOVE 'NONE'
                 TO ANN-NAME   IN  ANN-RECORD
           ELSE
               MOVE FIRST-NAME               OF NAME-ADDRESS-SEGMENT
                 TO ANN-FIRST-NAME IN  ANN-RECORD
               MOVE LAST-NAME                OF NAME-ADDRESS-SEGMENT
                 TO ANN-LAST-NAME  IN  ANN-RECORD
               MOVE NAME-PREFIX              OF NAME-ADDRESS-SEGMENT
                 TO ANN-PREFIX     IN  ANN-RECORD
               MOVE NAME-SUFFIX              OF NAME-ADDRESS-SEGMENT
                 TO ANN-SUFFIX     IN  ANN-RECORD
           END-IF.

           MOVE COMPANY-INDIVIDUAL-CODE  OF NAME-ADDRESS-SEGMENT
             TO ANN-COMP-IND IN  ANN-RECORD.

           MOVE ADDRESS-LINE-1        OF NAME-ADDRESS-SEGMENT
             TO ANN-ADR-LINE-1.

           MOVE ADDRESS-LINE-2        OF NAME-ADDRESS-SEGMENT
             TO ANN-ADR-LINE-2.

           MOVE ADDRESS-LINE-3        OF NAME-ADDRESS-SEGMENT
             TO ANN-ADR-LINE-3.

           MOVE ADDRESS-LINE-4        OF NAME-ADDRESS-SEGMENT
             TO ANN-ADR-LINE-4.

           MOVE ADDRESS-LINE-5        OF NAME-ADDRESS-SEGMENT
             TO ANN-ADR-LINE-5.

           MOVE CITY                  OF NAME-ADDRESS-SEGMENT
             TO ANN-CITY.

           MOVE STATE                 OF NAME-ADDRESS-SEGMENT
             TO ANN-STATE.

           MOVE ZIP-POSTAL-CODE       OF NAME-ADDRESS-SEGMENT
             TO ANN-ZIP.


           MOVE SPACES                 TO WS-FILE-ADDRESS.

           MOVE SPACES                 TO AV-ADDR-IN
                                          AV-ADDR-OUT
                                          AV-BARCODE.

           MOVE ADDRESS-LINE-1        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(1)
           MOVE ADDRESS-LINE-2        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(2)
           MOVE ADDRESS-LINE-3        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(3)
           MOVE ADDRESS-LINE-4        OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-LINE(4)
           MOVE CITY                  OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-CITY
           MOVE STATE                 OF NAME-ADDRESS-SEGMENT
             TO AV-ADDR-IN-STATE

           MOVE ZIP-POSTAL-CODE  OF NAME-ADDRESS-SEGMENT (1:5)
                                           TO AV-ADDR-IN-ZIP-PREFIX
           IF   ZIP-POSTAL-CODE  OF NAME-ADDRESS-SEGMENT (6:4)
                                      NOT EQUAL SPACES
               MOVE '-'                    TO AV-ADDR-IN-ZIP-HYPHEN
               MOVE ZIP-POSTAL-CODE OF NAME-ADDRESS-SEGMENT(6:4)
                                           TO AV-ADDR-IN-ZIP-SUFFIX
           ELSE
              MOVE '-'                   TO AV-ADDR-IN-ZIP-HYPHEN
              MOVE '0000'                TO AV-ADDR-IN-ZIP-SUFFIX

           END-IF.

           PERFORM 941500-CALL-FINALIST THRU 941500-EXIT.

           MOVE AV-BARCODE
             TO ANN-BAR-CODE.

           MOVE SOC-SEC-NUMBER     IN   POLICY-SPEC-RECORD (1:9)
             TO ANN-SSN-NO.


           MOVE COMPANY-INDIV-CODE  IN      POLICY-SPEC-RECORD
             TO ANN-SSN-FMT-CD.


      *
      *
      *  4 POSSIBLE VALUES FOR PRINT CODE AS FOLLOWS
      *  ADD LOGIC IN FUTURE FOR ELECTRONIC STATEMENTS
      *
      *     0 = NO STATEMENT.
      *     1 = PRINTED STATEMENT ONLY.
      *     2 = ELECTRONIC STATEMENT ONLY
      *     3 = PRINTED AND ELECTRONIC STATMENT
      *
      *
           MOVE SPACE
             TO SUPPRESS-REASON-SW    IN ANN-RECORD

           IF DEATH-STATUS IN POLICY-SEG
               MOVE '0'       TO ANN-PRINT-CD
               MOVE 'D' TO SUPPRESS-REASON-SW IN ANN-RECORD
           ELSE
               IF HOLD-ANNUITANT-COPY = 'A'
               OR OWNERSHIP-CODE  IN POLICY-SEG = 'T'
                   MOVE '3'       TO ANN-PRINT-CD
               ELSE
                   MOVE '0'       TO ANN-PRINT-CD
                   MOVE 'C' TO SUPPRESS-REASON-SW IN ANN-RECORD
               END-IF
           END-IF
           IF EXPLORER-CONTRACT
              IF ANN-PRINT-CD = '0'
                 MOVE 'N' TO ANN-PRINT-CD
              ELSE
                 MOVE 'Y' TO ANN-PRINT-CD
              END-IF
      ***** $W6165C START *****
              IF  ADDR-STATUS IN NAME-ADDRESS-SEGMENT = 'B'
      *          MOVE 'N' TO PRINT-CD
                 MOVE 'N' TO ANN-PRINT-CD
                 MOVE 'B' TO SUPPRESS-REASON-SW IN ANN-RECORD
                 PERFORM 510000-BAD-ADDR THRU 510000-EXIT
              END-IF
           ELSE
              IF  ADDR-STATUS IN NAME-ADDRESS-SEGMENT = 'B'
      *          MOVE '0' TO PRINT-CD
                 MOVE '0' TO ANN-PRINT-CD
                 MOVE 'B' TO SUPPRESS-REASON-SW IN ANN-RECORD
                 PERFORM 510000-BAD-ADDR THRU 510000-EXIT
              END-IF
      ***** $W6165C  END  *****
           END-IF.

           MOVE   '15'
             TO   RECORD-TYPE

           IF EXPLORER-CONTRACT
              MOVE SPACES TO ANN-INVESTOR-MESSAGE
              IF (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C02') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C06') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CP6')
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPL01' DELIMITED BY SIZE
                   INTO ANN-MSG-NO-1
              END-IF
           END-IF.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              MOVE SPACES TO ANN-INVESTOR-MESSAGE
      ***** $T87159 START *****
      *       IF  (POLICY-STATUS IN POLICY-SEG = '2')
      *       OR  ((POLICY-STATUS IN POLICY-SEG = 'A')
      *       AND  (SPOUSAL-CONTINUATION-INDICATOR IN POLICY-SEG = 'C'))
              IF  SW-CONTRACT-DEATH-STATUS
      ***** $T87159  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA02' DELIMITED BY SIZE
                   INTO ANN-MSG-NO-1
              ELSE
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA01' DELIMITED BY SIZE
                   INTO ANN-MSG-NO-1
              END-IF
           END-IF.

      *
      * EXPEDITION HAS TWO MESSAGES, ALL CONTRACTS GET MXXXEXPD01. IF
      * THE CONTRACT HAS RATE ADVANTAGE, THAT CONTRACT WILL ALSO GET
      * MXXXEXPE02.
      *
           IF  EXPEDITION-CONTRACT
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'EXPD01' DELIMITED BY SIZE
                INTO ANN-MSG-NO-1
      ***** $T97872 START *****
      *       IF  (PLAN-CODE IN POLICY-SEG = '006715')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06715')
      *       OR  (PLAN-CODE IN POLICY-SEG = '006717')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06717')
              IF  ((PLAN-CODE IN POLICY-SEG = '006715')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06715')
              OR   (PLAN-CODE IN POLICY-SEG = '006717')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06717'))
              AND ((RATE-CHANGE-XFER-DATE-R IN POLICY-SEG NOT =
                    99999999)
              OR   (WK-HOLD-RA-ACTIVATION-DATE > TRX-END-DATE))
      ***** $T97872  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPD02' DELIMITED BY SIZE
                   INTO ANN-MSG-NO-2
              END-IF
           END-IF.

      *
      * MARINER HAS JUST ONE MESSAGE AND ALL CONTRACTS GET IT.
      *
           IF  MARINER-CONTRACT
              MOVE SPACES TO ANN-MSG-NO-1
                             ANN-MSG-NO-2
                             ANN-MSG-NO-3
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'MARN01' DELIMITED BY SIZE
                INTO ANN-MSG-NO-1
           END-IF.

           IF  PIA-CONTRACT
              MOVE SPACES TO ANN-MSG-NO-1
                             ANN-MSG-NO-2
                             ANN-MSG-NO-3
           END-IF.

           IF PGO-SERVICING-AGENCY = ' PSD00'
              MOVE 'M000PSD001'
                TO ANN-MSG-NO-3
           ELSE
              IF PGO-SERVICING-AGENCY = ' 15000'
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'ORP002' DELIMITED BY SIZE
                   INTO ANN-MSG-NO-3
              END-IF
           END-IF

           IF      ORIG-STMT-OF-ACCT-E-MAIL
                                       IN POLICY-SEG
           AND PRINT-COPY IN ANN-RECORD
               MOVE STATUTORY-COMPANY-CODE IN POLICY-SEG
                 TO  VP-IN-COMPANY-CODE    IN W-VPAWEML-PARAMETER
               MOVE SOC-SEC-NUMBER         IN NAME-ADDRESS-SEGMENT(1:9)
                 TO  VP-IN-TAX-ID-SSN      IN W-VPAWEML-PARAMETER
               PERFORM 970000-GET-EMAIL-DETAILS THRU 970000-EXIT
               MOVE HOLD-ROLE-EMAIL-SEQ
                 TO ANN-EMAIL-ADDRESS-SEQ
               MOVE HOLD-ROLE-EMAIL
                 TO ANN-EMAIL-ADDRESS
           END-IF.

           WRITE ANNL-STMNT    FROM    STMTEX-LINE.

       415000-EXIT.
           EXIT.

       420000-GET-REC-20.

           MOVE ZEROS
             TO KEY-DEFINITION

            MOVE SPACES
              TO DATA-DEFINITION-AREA

           PERFORM 421000-ACCESS-DSS-DATA THRU 421000-EXIT.


           IF  RECORD-NOT-FOUND          IN DSS-COMM-AREA
               DISPLAY 'RECORD NOT FOUND'
               MOVE SPACES  TO  W-AGENT-NAME
                                AGC-AGENCY-NAME
               GO TO 420000-EXIT.

           IF  NOT SUCCESSFUL-CALL       IN DSS-COMM-AREA
               DISPLAY 'NOT FINDING DSS INFO FOR POLICY '
                                    HOLD-CONTRACT-NO
               PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
               GO TO 420000-EXIT.

           INITIALIZE AGENT-COPY-FIELDS.
           MOVE  SPACES                  TO
                                            W-AGENT-NAME.

           MOVE  HOLD-CONTRACT-NO (6:10)
             TO  POLICY-NUMBER        IN           KEY-DEFINITION.

           MOVE HOLD-AGENT-ID
             TO REP-NO             IN           KEY-DEFINITION
                REP-ID.

           IF SEX-CODE OF DSS-AGENT-PERSONAL-REC = 'E'
               MOVE CORPORATE-NAME
                 TO REP-NAME
               MOVE 'C' TO REP-COMP-IND
           ELSE
               MOVE       AGT-NAME-PREFIX
                 TO       REP-PREFIX
               MOVE       AGT-FIRST-NAME
                 TO       REP-FIRST-NAME
               MOVE       AGT-LAST-NAME
                 TO       REP-LAST-NAME
               MOVE       AGT-NAME-SUFFIX
                 TO       REP-SUFFIX
               MOVE       'I'
                 TO REP-COMP-IND
           END-IF.

           MOVE ADDRESS-LINE-1           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-ADR-LINE-1.

           MOVE ADDRESS-LINE-2           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-ADR-LINE-2.

           MOVE ADDRESS-LINE-3           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-ADR-LINE-3.

           MOVE ADDRESS-LINE-4           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-ADR-LINE-4.

           MOVE CITY-CODE                OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-CITY.

           MOVE STATE-CODE               OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-STATE.

           MOVE ZIP-PREFIX               OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO REP-ZIP (1:5).

           MOVE ZIP-SUFFIX           OF AGENT-ADDRESS
             TO REP-ZIP (6:4).


           MOVE SPACES                 TO WS-FILE-ADDRESS.
           MOVE SPACES                 TO AV-ADDR-IN.

           MOVE ADDRESS-LINE-1           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO AV-ADDR-IN-LINE(1)
           MOVE ADDRESS-LINE-2           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO AV-ADDR-IN-LINE(2)
           MOVE ADDRESS-LINE-3           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO AV-ADDR-IN-LINE(3)
           MOVE ADDRESS-LINE-5           OF AGENT-ADDRESS
                                         IN DSS-AGENT-PERSONAL-REC
             TO AV-ADDR-IN-LINE(4)

               MOVE REP-ZIP (1:5)
                                       TO AV-ADDR-IN-ZIP-PREFIX
               IF REP-ZIP (6:4)
                                       NOT EQUAL SPACES
                   MOVE '-'            TO AV-ADDR-IN-ZIP-HYPHEN
                   MOVE REP-ZIP (6:4)
                                       TO AV-ADDR-IN-ZIP-SUFFIX
               ELSE
                   MOVE '-'            TO AV-ADDR-IN-ZIP-HYPHEN
                   MOVE '0000'         TO AV-ADDR-IN-ZIP-SUFFIX
               END-IF


           PERFORM 941500-CALL-FINALIST THRU 941500-EXIT.

           MOVE AV-BARCODE
             TO REP-BAR-CODE.


           MOVE '('
             TO REP-PHN-NO(1:1).
           MOVE     AREA-CODE               IN TELEPHONE-NUMBER
                                            IN  DSS-AGENT-PERSONAL-REC
             TO REP-PHN-NO(2:3).
           MOVE ')'
             TO REP-PHN-NO(5:1).
           MOVE     TELEPHONE-NUMBER-3      IN TELEPHONE-NUMBER
                                            IN DSS-AGENT-PERSONAL-REC
             TO REP-PHN-NO(6:3).
           MOVE     '-'
             TO REP-PHN-NO(9:1).
           MOVE     TELEPHONE-NUMBER-4      IN TELEPHONE-NUMBER
                                            IN DSS-AGENT-PERSONAL-REC
             TO REP-PHN-NO(10:4).

           MOVE 'R' TO REP-MAIL-CODE.
           MOVE SPACES                   TO DSS-COMM-AREA
           MOVE ALL '9'                  TO AGC-AGENCY-KEY
           MOVE HOLD-COMPANY-CODE
                                         TO AGC-COMPANY-CD
                                         IN AGC-AGENCY-KEY
           MOVE AGENCY-NUMBER            IN DSS-AGENT-PERSONAL-REC
                                         TO AGC-AGENCY-NUMBER
           MOVE GET-UNIQUE-REC           TO COMM-FUNCTION
           MOVE AGENCY-MASTER-DATA       TO COMM-SEGMENT

           CALL 'IOMOIO1'             USING DSS-COMM-AREA
                                            AGC-AGENCY-KEY
                                            DSS-AGENCY-MASTER-REC.

           IF  RECORD-NOT-FOUND          IN DSS-COMM-AREA
               DISPLAY 'RECORD NOT FOUND'
               MOVE SPACES  TO  AGC-AGENCY-NAME
           ELSE
               IF  NOT SUCCESSFUL-CALL       IN DSS-COMM-AREA
                   DISPLAY 'NOT FINDING AGCY INFO FOR POL  '
                                     HOLD-CONTRACT-NO
                   PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
                   GO TO 421000-EXIT.

           MOVE   AGENCY-NUMBER       IN DSS-AGENT-PERSONAL-REC
             TO   REP-BROKER-ID
                  BROKER-NO             IN           KEY-DEFINITION.
           MOVE   AGC-AGENCY-NAME
             TO   REP-BROKER-NAME.


      *  IF AGENT IS NOT ACTIVE AGENCY NAME AND ADDRESS
      *  WILL BE USED
      *  INACTIVE AGENT NAME GOES IN FIRST LINE
      *  AGENCY NAME AND ADDRESS IN SUBSEQUENT LINES
      *
           IF ACTIVE-STATUS  OF DSS-AGENT-PERSONAL-REC
               CONTINUE
           ELSE
               MOVE SPACES
                 TO REP-NAME
                    REP-ADDRESS-INFO
               IF SEX-CODE OF DSS-AGENT-PERSONAL-REC = 'E'
                   MOVE CORPORATE-NAME
                     TO REP-NAME
                   MOVE 'C' TO REP-COMP-IND
               ELSE
                   MOVE       AGT-NAME-PREFIX
                     TO       REP-PREFIX
                   MOVE       AGT-FIRST-NAME
                     TO       REP-FIRST-NAME
                   MOVE       AGT-LAST-NAME
                     TO       REP-LAST-NAME
                   MOVE       AGT-NAME-SUFFIX
                     TO       REP-SUFFIX
                   MOVE       'I'
                     TO REP-COMP-IND
               END-IF

      *         MOVE REP-BROKER-NAME
      *           TO REP-ADR-LINE-1
               MOVE ADDRESS-LINE-1           OF AGENCY-ADDRESS
                                           IN DSS-AGENCY-MASTER-REC
                 TO REP-ADR-LINE-1

               MOVE ADDRESS-LINE-2           OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO REP-ADR-LINE-2

               MOVE ADDRESS-LINE-3           OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO REP-ADR-LINE-3

               MOVE ADDRESS-LINE-4           OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO REP-ADR-LINE-4

              MOVE CITY-CODE                 OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                TO REP-CITY

              MOVE STATE-CODE               OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                TO REP-STATE

              MOVE ZIP-PREFIX               OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                TO REP-ZIP (1:5)

              MOVE ZIP-SUFFIX           OF AGENCY-ADDRESS
                                     IN DSS-AGENCY-MASTER-REC
                TO REP-ZIP (6:4)

               MOVE SPACES                 TO WS-FILE-ADDRESS
               MOVE SPACES                 TO AV-ADDR-IN

               MOVE ADDRESS-LINE-1              OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO AV-ADDR-IN-LINE(1)
               MOVE ADDRESS-LINE-2              OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO AV-ADDR-IN-LINE(2)
               MOVE ADDRESS-LINE-3              OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO AV-ADDR-IN-LINE(3)
               MOVE ADDRESS-LINE-5              OF AGENCY-ADDRESS
                                         IN DSS-AGENCY-MASTER-REC
                 TO AV-ADDR-IN-LINE(4)

               MOVE REP-ZIP (1:5)
                                       TO AV-ADDR-IN-ZIP-PREFIX
               IF REP-ZIP (6:4)
                                       NOT EQUAL SPACES
                   MOVE '-'            TO AV-ADDR-IN-ZIP-HYPHEN
                   MOVE REP-ZIP (6:4)
                                       TO AV-ADDR-IN-ZIP-SUFFIX
               ELSE
                   MOVE '-'            TO AV-ADDR-IN-ZIP-HYPHEN
                   MOVE '0000'         TO AV-ADDR-IN-ZIP-SUFFIX
               END-IF

               PERFORM 941500-CALL-FINALIST THRU 941500-EXIT

               MOVE AV-BARCODE
                 TO REP-BAR-CODE

           END-IF.
      *
      *
      *  4 POSSIBLE VALUES FOR PRINT CODE AS FOLLOWS
      *  ADD LOGIC IN FUTURE FOR ELECTRONIC STATEMENTS
      *
      *     0 = NO STATEMENT.
      *     1 = PRINTED STATEMENT ONLY.
      *     2 = ELECTRONIC STATEMENT ONLY
      *     3 = PRINTED AND ELECTRONIC STATMENT
      *
      *
      *
      *  SUPPRESS AGENT COPY FOR PACIFIC SELECT DISTRIBUTORS (PSD)
      *

           MOVE SPACE
             TO SUPPRESS-REASON-SW IN REP-RECORD.

           IF      REP-BROKER-ID(2:5)   = '15000'
                      OR                  '15001'
                      OR                  '15002'
               MOVE  '0'
                 TO  REP-PRINT-CD
               MOVE 'C' TO SUPPRESS-REASON-SW IN REP-RECORD
           ELSE
               MOVE  '3'
                 TO  REP-PRINT-CD

           END-IF.

           IF DEATH-STATUS IN POLICY-SEG
               MOVE '0'       TO REP-PRINT-CD
               MOVE 'D' TO SUPPRESS-REASON-SW IN REP-RECORD
           END-IF
           IF EXPLORER-CONTRACT
              IF REP-PRINT-CD = '0'
                 MOVE 'N' TO REP-PRINT-CD
              ELSE
                 MOVE 'Y' TO REP-PRINT-CD
              END-IF
              IF (DELIVER-CLIENT-STMT IN DSS-AGENT-PERSONAL-REC =
                  'S') OR
                 (DELIVER-CLIENT-STMT IN DSS-AGENCY-MASTER-REC =
                  'S')
                 MOVE 'N' TO REP-PRINT-CD
                 MOVE 'C' TO SUPPRESS-REASON-SW IN REP-RECORD
              END-IF
      ***** $W6165C START *****
           ELSE
              IF  (DELIVER-CLIENT-STMT IN DSS-AGENT-PERSONAL-REC =
                   'S')
              OR  (DELIVER-CLIENT-STMT IN DSS-AGENCY-MASTER-REC =
                   'S')
                 MOVE '0' TO REP-PRINT-CD
                 MOVE 'C' TO SUPPRESS-REASON-SW IN REP-RECORD
              END-IF
      ***** $W6165C  END  *****
           END-IF.

           MOVE HOLD-REP-CUST-SERV-PHONE
             TO REP-CUST-SERV-PHONE
      *
      * JP MORGAN SPECIAL PHONE #
      *
           IF  (PGO-SERVICING-AGENCY = ' N7838')
           OR  (PGO-SERVICING-AGENCY = ' G9304')
           OR  (PGO-SERVICING-AGENCY = ' GG386')
              MOVE '1-877-992-5632'
                TO REP-CUST-SERV-PHONE
           END-IF.
      *
      * EDWARD JONES SPECIAL PHONE #
      *
           IF  PGO-SERVICING-AGENCY = ' 68706'
              MOVE '1-877-441-2357'
                TO REP-CUST-SERV-PHONE
           END-IF.
      *
      * CHARLES SCHWAB SPECIAL PHONE #
      *
           IF  PGO-SERVICING-AGENCY = ' FM523'
              MOVE '1-800-610-4823'
                TO REP-CUST-SERV-PHONE
           END-IF.
      *
      *   WRITE OUT RECORD TYPE 20
      *    DISPLAY 'WRITE OUT RECORD TYPE 20'
      *
           MOVE   '20'
             TO   RECORD-TYPE

           MOVE HOLD-SSN
             TO KEY-SSN

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.

           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC

           IF EXPLORER-CONTRACT
              MOVE SPACES TO REP-INVESTOR-MESSAGE
              IF (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C02') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'C06') OR
                 (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CP6')
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPL01' DELIMITED BY SIZE
                   INTO REP-MSG-NO-1
              END-IF
           END-IF.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              MOVE SPACES TO REP-INVESTOR-MESSAGE
      ***** $T87159 START *****
      *       IF  (POLICY-STATUS IN POLICY-SEG = '2')
      *       OR  ((POLICY-STATUS IN POLICY-SEG = 'A')
      *       AND  (SPOUSAL-CONTINUATION-INDICATOR IN POLICY-SEG = 'C'))
              IF  SW-CONTRACT-DEATH-STATUS
      ***** $T87159  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA02' DELIMITED BY SIZE
                   INTO REP-MSG-NO-1
              ELSE
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'PICA01' DELIMITED BY SIZE
                   INTO REP-MSG-NO-1
              END-IF
           END-IF.

      *
      * EXPEDITION HAS TWO MESSAGES, ALL CONTRACTS GET MXXXEXPD01. IF
      * THE CONTRACT HAS RATE ADVANTAGE, THAT CONTRACT WILL ALSO GET
      * MXXXEXPE02.
      *
           IF  EXPEDITION-CONTRACT
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'EXPD01' DELIMITED BY SIZE
                INTO REP-MSG-NO-1
      ***** $T97872 START *****
      *       IF  (PLAN-CODE IN POLICY-SEG = '006715')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06715')
      *       OR  (PLAN-CODE IN POLICY-SEG = '006717')
      *       OR  (PLAN-CODE IN POLICY-SEG = 'N06717')
              IF  ((PLAN-CODE IN POLICY-SEG = '006715')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06715')
              OR   (PLAN-CODE IN POLICY-SEG = '006717')
              OR   (PLAN-CODE IN POLICY-SEG = 'N06717'))
              AND ((RATE-CHANGE-XFER-DATE-R IN POLICY-SEG NOT =
                    99999999)
              OR   (WK-HOLD-RA-ACTIVATION-DATE > TRX-END-DATE))
      ***** $T97872  END  *****
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'EXPD02' DELIMITED BY SIZE
                   INTO REP-MSG-NO-2
              END-IF
           END-IF.

      *
      * MARINER HAS JUST ONE MESSAGE AND ALL CONTRACTS GET IT.
      *
           IF  MARINER-CONTRACT
              MOVE SPACES TO REP-MSG-NO-1
                             REP-MSG-NO-2
                             REP-MSG-NO-3
              STRING 'M' DELIMITED BY SIZE
                     HOLD-COMPANY-CODE DELIMITED BY SIZE
                     'MARN01' DELIMITED BY SIZE
                INTO REP-MSG-NO-1
           END-IF.

           IF  PIA-CONTRACT
              MOVE SPACES TO REP-MSG-NO-1
                             REP-MSG-NO-2
                             REP-MSG-NO-3
           END-IF.

           IF PGO-SERVICING-AGENCY = ' PSD00'
              MOVE 'M000PSD001'
                TO REP-MSG-NO-3
           ELSE
              IF PGO-SERVICING-AGENCY = ' 15000'
                 STRING 'M' DELIMITED BY SIZE
                        HOLD-COMPANY-CODE DELIMITED BY SIZE
                        'ORP002' DELIMITED BY SIZE
                   INTO REP-MSG-NO-3
              END-IF
           END-IF

           IF      ORIG-STMT-OF-ACCT-E-MAIL
                                       IN POLICY-SEG
           AND NOT CUSTODIAN-ACCT-SUPPRESSION
               MOVE STATUTORY-COMPANY-CODE IN POLICY-SEG
                 TO  VP-IN-COMPANY-CODE    IN W-VPAWEML-PARAMETER
               MOVE HOLD-OWNER-SSN
                 TO  VP-IN-TAX-ID-SSN      IN W-VPAWEML-PARAMETER
               PERFORM 970000-GET-EMAIL-DETAILS THRU 970000-EXIT
               MOVE HOLD-ROLE-EMAIL-SEQ
                 TO REP-EMAIL-ADDRESS-SEQ
               MOVE HOLD-ROLE-EMAIL
                 TO REP-EMAIL-ADDRESS
           END-IF.

           WRITE ANNL-STMNT    FROM    STMTEX-LINE.


       420000-EXIT.
           EXIT.

       421000-ACCESS-DSS-DATA.
      *     DISPLAY '421000-ACCESS-DSS-DATA'.

           MOVE SPACES                   TO DSS-COMM-AREA
                                            AGENT-KEY
           MOVE HOLD-COMPANY-CODE
                                         TO AGT-COMPANY-CD
           MOVE HOLD-AGENT-ID
                                         TO AGT-AGENT-ID
           MOVE GET-UNIQUE-REC           TO COMM-FUNCTION
           MOVE AGENT-PERSONAL-DATA      TO COMM-SEGMENT

           CALL 'IOMOIO1'             USING DSS-COMM-AREA
                                            AGENT-KEY
                                            DSS-AGENT-PERSONAL-REC.

       421000-EXIT.
           EXIT.

       430000-GET-REC-30.

           MOVE ZEROS
             TO KEY-DEFINITION.

           MOVE SPACES
             TO DATA-DEFINITION-AREA.

           MOVE HOLD-CONTRACT-NO (6:10)
             TO  STMT-CONTRACT-NO
                 POLICY-NUMBER   IN    KEY-DEFINITION.

           MOVE HOLD-ISSUE-DATE
             TO STMT-ISSUE-DATE.


      *
      *   GET JNT-OWN NAME
      *
           MOVE SPACE                        TO DB-PARM-AREA.
           MOVE SPACE                        TO DB-COMM-AREA.
           MOVE SPACE                     TO NAME-ADDRESS-SEGMENT.
           MOVE GET-FIRST                    OF DB-OPERATIONS
                TO OPERATION                 OF DB-PARM-AREA.
           MOVE CO-OWNER                     OF DB-MNEMONICS
                TO ACCESS-SEGMENT            OF DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE              OF DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
                TO KEY-QUALIFIER             OF DB-PARM-AREA.

           PERFORM 941000-GET-NAME-ADDRESS THRU 941000-EXIT.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
               MOVE 'NONE'
                 TO JNT-OWN-NAME
           ELSE
               MOVE FIRST-NAME               OF NAME-ADDRESS-SEGMENT
                 TO JNT-OWN-FIRST-NAME
               MOVE LAST-NAME                OF NAME-ADDRESS-SEGMENT
                 TO JNT-OWN-LAST-NAME
               MOVE NAME-PREFIX              OF NAME-ADDRESS-SEGMENT
                 TO JNT-OWN-PREFIX
               MOVE NAME-SUFFIX              OF NAME-ADDRESS-SEGMENT
                 TO JNT-OWN-SUFFIX
               MOVE COMPANY-INDIVIDUAL-CODE  OF NAME-ADDRESS-SEGMENT
                 TO JNT-OWN-COMP-IND  IN STMT-RECORD
           END-IF.
      *
      *   GET ANNUIT NAME
      *
           MOVE SPACE                        TO DB-PARM-AREA.
           MOVE SPACE                        TO DB-COMM-AREA.
           MOVE SPACE                     TO NAME-ADDRESS-SEGMENT.
           MOVE GET-FIRST                    OF DB-OPERATIONS
                TO OPERATION                 OF DB-PARM-AREA.
           MOVE PARTICIPANT-NAME-ADDRESS     OF DB-MNEMONICS
                TO ACCESS-SEGMENT            OF DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE              OF DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
                TO KEY-QUALIFIER             OF DB-PARM-AREA.

           PERFORM 941000-GET-NAME-ADDRESS THRU 941000-EXIT.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
               MOVE 'NONE'
                 TO ANN-NAME IN STMT-RECORD
           ELSE
               MOVE FIRST-NAME               OF NAME-ADDRESS-SEGMENT
                 TO ANN-FIRST-NAME IN STMT-RECORD
               MOVE LAST-NAME                OF NAME-ADDRESS-SEGMENT
                 TO ANN-LAST-NAME IN STMT-RECORD
               MOVE NAME-PREFIX              OF NAME-ADDRESS-SEGMENT
                 TO ANN-PREFIX    IN STMT-RECORD
               MOVE NAME-SUFFIX              OF NAME-ADDRESS-SEGMENT
                 TO ANN-SUFFIX    IN STMT-RECORD
               MOVE COMPANY-INDIVIDUAL-CODE  OF NAME-ADDRESS-SEGMENT
                 TO ANN-COMP-IND  IN STMT-RECORD
           END-IF.


      *
      *   GET CO-ANNUIT NAME
      *
           MOVE SPACE                        TO DB-PARM-AREA.
           MOVE SPACE                        TO DB-COMM-AREA.
           MOVE SPACE                     TO NAME-ADDRESS-SEGMENT
           MOVE GET-FIRST                    OF DB-OPERATIONS
                TO OPERATION                 OF DB-PARM-AREA.
           MOVE CO-ANNUITANT                 OF DB-MNEMONICS
                TO ACCESS-SEGMENT            OF DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE              OF DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
                TO KEY-QUALIFIER             OF DB-PARM-AREA.

           PERFORM 941000-GET-NAME-ADDRESS THRU 941000-EXIT.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
               MOVE 'NONE'
                 TO JNT-ANN-NAME
           ELSE
               MOVE FIRST-NAME               OF NAME-ADDRESS-SEGMENT
                 TO JNT-ANN-FIRST-NAME
               MOVE LAST-NAME                OF NAME-ADDRESS-SEGMENT
                 TO JNT-ANN-LAST-NAME
               MOVE NAME-PREFIX              OF NAME-ADDRESS-SEGMENT
                 TO JNT-ANN-PREFIX
               MOVE NAME-SUFFIX              OF NAME-ADDRESS-SEGMENT
                 TO JNT-ANN-SUFFIX
               MOVE COMPANY-INDIVIDUAL-CODE  OF NAME-ADDRESS-SEGMENT
                 TO JNT-ANN-COMP-IND
           END-IF.

      *    IF TRX-BEGIN-DATE NOT = POLICY-EFF-DATE IN POLICY-SEG
      *        MOVE ZERO
      *          TO HOLD-INITIAL-PAYMENT
      *             STMT-INITIAL-PREM
      *    ELSE
               MOVE HOLD-INITIAL-PAYMENT
                 TO STMT-INITIAL-PREM.
      *    END-IF.

      *
      *  MAKE ACCUMULATED WITHDRAWALS AND TAXES
      *  AND CHARGES NEGATIVE FOR STATEMENT
      *
      *
           MOVE TOTAL-CLAIMS
             TO STMT-WITHDRAW.

           MOVE WK-TOTAL-TAX
             TO STMT-TAX.

           MOVE WK-WD-CHARGES
             TO STMT-WDCHARGE.

           MOVE  WK-TOTAL-MVA
             TO STMT-MVA.

           COMPUTE STMT-MVA =
                   STMT-MVA * -1.


           MOVE HOLD-PLAN-TYPE
             TO STMT-PLAN-TYPE.

           IF PAYOUT-OPTION-ACTIVE
               MOVE 'YES' TO STMT-SCHED-WD

           ELSE
               MOVE 'NO' TO STMT-SCHED-WD

           END-IF

           IF   PHONE-AUTH IN POLICY-SEG
                          = 'O'
               MOVE 'OWNER'
                 TO STMT-PHONE-AUTH
           ELSE
               MOVE 'ALL'
                 TO STMT-PHONE-AUTH
           END-IF.

           MOVE HOLD-ISSUE-DATE
             TO STMT-ISSUE-DATE.

           MOVE TRANSACTION-DATA   TO POLICY-VALUES-RECORD.

           PERFORM 431000-GET-TOTALS THRU 431000-EXIT.

           IF FRONTIERS-II-CONTRACT
             IF HOLD-1STYR-FRNTRII-ADD-PAYMENT > ZEROS
               MOVE HOLD-1STYR-FRNTRII-ADD-PAYMENT
                 TO STMT-ADD-PAYMENTS
             ELSE
               MOVE HOLD-FRNTRII-ADD-PAYMENT
                 TO STMT-ADD-PAYMENTS
             END-IF
             COMPUTE STMT-TOTAL-PAYMENTS =
                       STMT-INITIAL-PREM +
                       STMT-ADD-PAYMENTS
             IF  TRX-BEGIN-DATE > POLICY-EFF-DATE IN POLICY-SEG
                MOVE ZERO TO STMT-INITIAL-PREM
                             STMT-ADD-PAYMENTS
             END-IF
           ELSE
             MOVE ZEROS
               TO STMT-ADD-PAYMENTS
                  STMT-TOTAL-PAYMENTS
             COMPUTE STMT-INITIAL-PREM   =
                     STMT-INITIAL-PREM +
                     HOLD-MA-DUMPIN
           END-IF

           COMPUTE STMT-INTEREST   =
                     STMT-END-BAL   -
                  HOLD-STMT-BEG-BAL -
                  STMT-ADD-PAYMENTS +
      *              STMT-BEG-BAL   +
                     STMT-WITHDRAW

           MOVE    STMT-INTEREST
             TO    HOLD-STMT-INTEREST.

           COMPUTE STMT-WITHDRAW =
                   STMT-WITHDRAW * -1.

           COMPUTE STMT-TAX  =
                   STMT-TAX  * -1.

           COMPUTE STMT-WDCHARGE =
                   STMT-WDCHARGE * -1.


            MOVE  HOLD-CONTRACT-NO (6:10)
              TO  POLICY-NUMBER IN KEY-DEFINITION

            MOVE  HOLD-BROKER-NO
              TO  BROKER-NO

            MOVE  HOLD-AGENT-ID
              TO  REP-NO

            MOVE HOLD-SSN
              TO KEY-SSN

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.

            MOVE HOLD-PROD-MNEMONIC
              TO KEY-PROD-MNEMONIC
                 STMT-PROD-MNEMONIC

            MOVE   '30'
              TO   RECORD-TYPE

           IF FRONTIERS-CONTRACT
           OR EXPLORER-CONTRACT
               MOVE ZEROS
                 TO STMT-INT-RATE

               MOVE ZEROS
                 TO STMT-GUAR-DATE
           ELSE
               IF  WS-PCL-INDICATOR  = 'V'
                   PERFORM 432100-ACCESS-TABLES THRU 432100-EXIT
               ELSE
                   PERFORM 432200-GET-INTEREST-RATE THRU 432200-EXIT
               END-IF
           END-IF.

           IF EXPLORER-CONTRACT
              PERFORM 435000-EXPLORER-REC-35 THRU 435000-EXIT
           END-IF.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              PERFORM 436000-FIA-REC-30      THRU 436000-EXIT
           END-IF.

           IF  EXPEDITION-CONTRACT
           OR  MARINER-CONTRACT
           OR  PIA-CONTRACT
              PERFORM 436500-EXPED-REC-30    THRU 436500-EXIT
           END-IF.

           IF  PIA-CONTRACT
              MOVE 'Y'
                TO STMT-RIDER-SW
      *       IF RIDER-SUB-TYPE IN RIDER-SEGMENT (1:1) = 'S'
      *          MOVE 'SINGLE' TO STMT-RIDER-NAME
      *       ELSE
      *          MOVE 'JOINT ' TO STMT-RIDER-NAME
      *       END-IF
              MOVE WK-RIDER-NAME TO STMT-RIDER-NAME
              COMPUTE STMT-SUMM-TOTAL-PAYMENTS
                    = HOLD-INITIAL-PAYMENT
                    + HOLD-ADD-PAYMENT
              END-COMPUTE
              MOVE WK-HOLD-POLICY-WITHDRAW
                TO STMT-TOTAL-WITHDRAW
              IF  RIDER-TYPE   IN RIDER-SEGMENT = 'EDB'
                  CONTINUE
              ELSE
              IF  RIDER-ACTIVE IN RIDER-SEGMENT
              AND NOT FULL-SURRENDER-FOUND
                 PERFORM 436100-GET-GMWB-PAY-BASE THRU 436100-EXIT
                 MOVE WK-GMWB-PAYBASE
                   TO STMT-GMWB-PAY-BASE
              ELSE
                 MOVE ZERO
                   TO STMT-GMWB-PAY-BASE
                 MOVE 'N/A'
                   TO STMT-RIDER-NAME
              END-IF
           END-IF.

      ******************************************************
      *   WRITE OUT RECORD TYPE 30
      *
           WRITE ANNL-STMNT    FROM    STMTEX-LINE.
      *
      *******************************************************
      *    IF  FIA-CONTRACT
      *        MOVE STMTEX-LINE    TO      HOLD-FIA-30-REC
      *    ELSE
      *        WRITE ANNL-STMNT    FROM    STMTEX-LINE.

       430000-EXIT.
           EXIT.

       431000-GET-TOTALS.
      *     DISPLAY '431000-'.
099000
099200     MOVE    SPACES
099300       TO    POLICY-VALUES.
099200     MOVE    SPACES
099300       TO    TA-TRX-REC.
099200     MOVE    SPACES
099300       TO    TRX-COMM-AREA.

           MOVE    VAL-BEGIN-DATE-CCYY  TO WK-VALUATION-YY
           MOVE    VAL-BEGIN-DATE-MM    TO WK-VALUATION-MM
           MOVE    VAL-BEGIN-DATE-DD    TO WK-VALUATION-DD

           MOVE SPACES                 TO POLICY-VALUES
                                          INQ-CONT-AREA.

           MOVE POLICY-STATUS IN POLICY-SEG
             TO HOLD-POLICY-STATUS

           IF DEATH-STATUS IN POLICY-SEG
           OR MATURED-STATUS IN POLICY-SEG
           OR SURRENDERED-STATUS IN POLICY-SEG

               MOVE 'N' TO POLICY-ACTIVE-SW

               MOVE 'Y'
                 TO TERMINATED-STATUS-REQUEST-SW IN POLICY-VALUES
           ELSE
               MOVE 'Y' TO POLICY-ACTIVE-SW
           END-IF.

070610     PERFORM 960000-CURRENT-AV THRU 960000-EXIT

           MOVE POLICY-VALUES TO BEGIN-POLICY-VALUES.

           IF  EXPEDITION-CONTRACT
           OR  MARINER-CONTRACT
           OR  FRONTIERS-CONTRACT
           OR  FRONTIERS-II-CONTRACT
           OR  EXPLORER-CONTRACT
           OR  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
           OR  PIA-CONTRACT
              COMPUTE WK-HOLD-BEG-WD-VALUE
                    = CIC-AMT-UNDISTRIBUTED     IN POLICY-VALUES
                    + ACCUMULATED-CASH-VALUE    IN POLICY-VALUES
                    + TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                    + MIN-SURRENDER-BENEFIT     IN INQ-CONT-AREA
                    - SURRENDER-PENALTY-AMT     IN INQ-CONT-AREA
                    - FLAT-FEE-AMT              IN INQ-CONT-AREA
                    - TOTAL-MVA-AMT             IN TA-WORK-AREA
                    - GMDBR-FEE                 IN TA-WORK-AREA
                    - GIAR-FEE                  IN TA-WORK-AREA
                    - EEGR-FEE                  IN TA-WORK-AREA
                    - GPAR-FEE                  IN TA-WORK-AREA
                    - IAR-FEE                   IN TA-WORK-AREA
                    - SALES-CHARGE-ADJ          IN TA-WORK-AREA
                    - TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                    - ARREARS-EARNED-INTEREST   IN POLICY-VALUES
                    + ADVANCE-UNEARNED-INTEREST IN POLICY-VALUES
              END-COMPUTE
           END-IF.

           MOVE HOLD-POLICY-STATUS
             TO POLICY-STATUS IN POLICY-SEG


           MOVE  DECL-POLICY-VALUE IN POLICY-VALUES
             TO  STMT-BEG-BAL
                 HOLD-STMT-BEG-BAL

           PERFORM VARYING WS-FUND-SUB FROM 1 BY 1
              UNTIL WS-FUND-SUB > 99
                 OR FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                                        = 999
               MOVE  FUND-DECL-VALUE         IN POLICY-VALUES
                                                 (WS-FUND-SUB)
                 TO  WK-VALUE-BEGIN (WS-FUND-SUB)

               MOVE  FUND-INTEREST           IN POLICY-VALUES
                                                 (WS-FUND-SUB)
                 TO  WK-BEG-INTEREST (WS-FUND-SUB)

           END-PERFORM.

           IF EXPLORER-CONTRACT
           OR FRONTIERS-II-CONTRACT
              IF TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
                 MOVE ZEROES TO STMT-BEG-BAL
                 PERFORM VARYING WS-FUND-SUB FROM 1 BY 1
                   UNTIL (WS-FUND-SUB > 99) OR
                         (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) =
                          999)
                    MOVE ZEROES
                      TO WK-VALUE-BEGIN (WS-FUND-SUB)
                         WK-BEG-INTEREST (WS-FUND-SUB)
                 END-PERFORM
              END-IF
           END-IF.

099200     MOVE    SPACES
099300       TO    POLICY-VALUES.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
               MOVE    TRX-END-DATE-CCYY  TO WK-VALUATION-YY
               MOVE    TRX-END-DATE-MM    TO WK-VALUATION-MM
               MOVE    TRX-END-DATE-DD    TO WK-VALUATION-DD
           ELSE
               MOVE    VAL-END-DATE-CCYY  TO WK-VALUATION-YY
               MOVE    VAL-END-DATE-MM    TO WK-VALUATION-MM
               MOVE    VAL-END-DATE-DD    TO WK-VALUATION-DD
           END-IF

           MOVE SPACES                 TO POLICY-VALUES
                                          INQ-CONT-AREA

      *
      *  IF SURRENDERED DURING STATEMENT PERIOD WE WILL MOVE
      *  'N' TO TERMINATED-STATUS-REQUEST-SW, TO GET A ZERO END VALUE
      *  IF NOT SURRENDERED DURING STATEMENT PERIOD, WE ARE DOING
      *  A STATEMENT FROM A PREVIOUS YEAR SO WE WANT TO GET A VALUE
      *  FOR STATEMENT END
      *
           MOVE SPACES TO WK-TERMINATED-SW.

           IF POLICY-NOT-ACTIVE
               IF  HOLD-SURR-EFF-DATE
                   >= TRX-BEGIN-DATE
               AND  HOLD-SURR-EFF-DATE
                   <= TRX-END-DATE

                   MOVE 'N'
                     TO TERMINATED-STATUS-REQUEST-SW IN POLICY-VALUES
                   MOVE 'Y'
                     TO WK-TERMINATED-SW
               ELSE
                   MOVE 'Y'
                     TO TERMINATED-STATUS-REQUEST-SW IN POLICY-VALUES

               END-IF
           END-IF.

070610     PERFORM 960000-CURRENT-AV THRU 960000-EXIT

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              MOVE SPACE TO SW-NO-OTHER-FUNDS-AVAIL-SW
              SET SW-ONLY-2YR-MONEY TO TRUE
           END-IF.

           MOVE  DECL-POLICY-VALUE IN POLICY-VALUES
             TO  STMT-END-BAL

           MOVE ZEROS TO WK-TOTAL-INTEREST

           PERFORM VARYING WS-FUND-SUB FROM 1 BY 1
              UNTIL WS-FUND-SUB > 99
                 OR FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                                        = 999

               MOVE  FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                 TO  WK-FUND-NUMBER (WS-FUND-SUB)

               MOVE  FUND-DECL-VALUE         IN POLICY-VALUES
                                                 (WS-FUND-SUB)
                 TO  WK-VALUE-END (WS-FUND-SUB)

               MOVE  FUND-INTEREST           IN POLICY-VALUES
                                                 (WS-FUND-SUB)
                 TO  WK-END-INTEREST (WS-FUND-SUB)

               COMPUTE WK-TOTAL-INTEREST =
                     WK-TOTAL-INTEREST  +
                     (WK-END-INTEREST (WS-FUND-SUB) -
                      WK-BEG-INTEREST (WS-FUND-SUB))

               MOVE LOW-VALUES TO MONEY-FUND-KEY-WORK
               MOVE FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                 TO FUND-NUMBER OF MONEY-FUND-KEY-WORK
               MOVE 'Y' TO  FIRST-TIME-MONEY-FUND-FLAG

               IF  FIA-CONTRACT
               OR  FIA-PA-CONTRACT
               OR  FIA-INDEX-EDGE-CONTRACT
                  PERFORM 431100-CHECK-FUNDS THRU 431100-EXIT
              END-IF

           END-PERFORM.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
           OR  PIA-CONTRACT
              COMPUTE WK-GROSS-CHECK-AMOUNT
                    = CIC-AMT-UNDISTRIBUTED     IN POLICY-VALUES
                    + ACCUMULATED-CASH-VALUE    IN POLICY-VALUES
                    + TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                    + MIN-SURRENDER-BENEFIT     IN INQ-CONT-AREA
                    - SURRENDER-PENALTY-AMT     IN INQ-CONT-AREA
                    - FLAT-FEE-AMT              IN INQ-CONT-AREA
                    - TOTAL-MVA-AMT             IN TA-WORK-AREA
                    - GMDBR-FEE                 IN TA-WORK-AREA
                    - GIAR-FEE                  IN TA-WORK-AREA
                    - EEGR-FEE                  IN TA-WORK-AREA
                    - GPAR-FEE                  IN TA-WORK-AREA
                    - IAR-FEE                   IN TA-WORK-AREA
                    - SALES-CHARGE-ADJ          IN TA-WORK-AREA
                    - TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                    - ARREARS-EARNED-INTEREST   IN POLICY-VALUES
                    + ADVANCE-UNEARNED-INTEREST IN POLICY-VALUES
              END-COMPUTE
              COMPUTE WK-NET-NON-GMSV-AMOUNT
                    = WK-GROSS-CHECK-AMOUNT
                    - MIN-SURRENDER-BENEFIT     IN INQ-CONT-AREA
              END-COMPUTE
              MOVE SURRENDER-PENALTY-AMT      IN INQ-CONT-AREA
                TO WK-WITHD-WITHDRWL-CHRGS
              MOVE TOTAL-MVA-AMT              IN TA-WORK-AREA
                TO WK-WITHD-MVA
              COMPUTE WK-WITHD-MIN-SURRENDER
                    = GMSV-AMOUNT  IN TA-WORK-AREA
                    - GMSV-PENALTY IN TA-WORK-AREA
              END-COMPUTE
           END-IF.

098400 431000-EXIT.
098500     EXIT.
098600     EJECT
       431100-CHECK-FUNDS.

           IF FIA-CONTRACT
            IF (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 702)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 705)
              IF  FUND-DECL-VALUE IN POLICY-VALUES (WS-FUND-SUB) > ZERO
                 MOVE SPACE TO SW-ONLY-2YR-MONEY-SW
              END-IF
            END-IF
           END-IF

           IF FIA-INDEX-EDGE-CONTRACT
            IF (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 746)
             IF FUND-DECL-VALUE IN POLICY-VALUES (WS-FUND-SUB) > ZERO
                MOVE SPACE TO SW-ONLY-2YR-MONEY-SW
             END-IF
            END-IF
           END-IF

           IF FIA-PA-CONTRACT
            IF (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 722)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 724)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 726)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 728)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 730)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 732)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 734)
           AND (FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB) NOT = 736)
              IF  FUND-DECL-VALUE IN POLICY-VALUES (WS-FUND-SUB) > ZERO
                 MOVE SPACE TO SW-ONLY-2YR-MONEY-SW
              END-IF
            END-IF
           END-IF.

       431100-EXIT.
           EXIT.
           EJECT
098601
       432200-GET-INTEREST-RATE.
      *----------------------------------------------------------------
      *    DISPLAY '432200-GET-INTEREST-RATE'.


           MOVE ZEROS
             TO STMT-INT-RATE.

           MOVE ZEROS
             TO STMT-GUAR-DATE.


           MOVE SPACES                TO DB-PARM-AREA
                                         DB-COMM-AREA
                                         MONEY-FUND-KEY-WORK

      *    MOVE GET-FIRST              IN DB-OPERATIONS
           MOVE 'GFI '
             TO OPERATION              IN DB-PARM-AREA

           MOVE MONEY-FUND             IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT         IN DB-PARM-AREA

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE            IN DB-PARM-AREA
                COMPANY-CODE            IN MONEY-FUND-KEY-WORK

           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER           IN DB-PARM-AREA
                MASTER-ID               IN MONEY-FUND-KEY-WORK

           MOVE HOLD-FUND-NUMBER
             TO FUND-NUMBER             IN MONEY-FUND-KEY-WORK

           MOVE LOW-VALUES
             TO ELEMENT-KEY             IN MONEY-FUND-KEY-WORK

           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY           IN DB-PARM-AREA

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.

           IF      NOT SUCCESSFUL-CALL  IN DB-COMM-AREA
           AND     NOT RECORD-NOT-FOUND IN DB-COMM-AREA
           AND     NOT END-OF-FILE      IN DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR READING MONEY-FUND-SEGMENT         ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.


           IF RECORD-NOT-FOUND         IN DB-COMM-AREA
           OR END-OF-FILE              IN DB-COMM-AREA
             DISPLAY ' RECORD NOT FOUND'
             GO TO 432200-EXIT
           END-IF.


           COMPUTE  STMT-INT-RATE =
                INTEREST-RATE          IN MONEY-FUND-SEGMENT
                               (CURR-OCCURS IN MONEY-FUND-SEGMENT)
                           * 100.

           MOVE NEXT-RENEWAL-DATE      IN MONEY-FUND-SEGMENT
             TO STMT-GUAR-DATE.


       432200-EXIT.
      *    DISPLAY '432200-EXIT'.
           EXIT.
           EJECT

071500 432100-ACCESS-TABLES.
071500*     DISPLAY '432100-ACCESS-TABLES'.
071600
071700     MOVE SPACES                TO TABLE-ACCESS
071800                                   INTEREST-SPEC-RECORD.
071900     MOVE 'A24'                 TO TABLE-ID IN TABLE-ACCESS.
072000     MOVE HOLD-COMPANY-CODE
072200      TO  COMPANY-CODE          IN TABLE-ACCESS.
072300     MOVE PROCESSING-SYSTEM-ID  IN POLICY-SEG
072400      TO  PRODUCT-CODE          IN TABLE-ACCESS.
072500     MOVE PLAN-CODE             IN POLICY-SEG
072600      TO  PLAN-CODE             IN TABLE-ACCESS.
           MOVE POLICY-EFF-DATE IN POLICY-SEG
072800      TO  EFFECTIVE-DATE        IN TABLE-ACCESS
072900          EFFECTIVE-DATE        IN INTEREST-SPEC-RECORD.
073000     MOVE HOLD-FUND-NUMBER
073100      TO  FUND-NUMBER           IN INTEREST-SPEC-RECORD.
073400     CALL  'ITAX011'  USING  TABLE-ACCESS
073500                             INTEREST-SPEC-RECORD.
073600     IF NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS

               MOVE ZEROS
                 TO STMT-INT-RATE

               MOVE ZEROS
                 TO STMT-GUAR-DATE

               DISPLAY 'TABLE A24 ERROR = '
                    RETURN-STATUS IN TABLE-ACCESS
               DISPLAY 'POL NUMBER = '
                 HOLD-CONTRACT-NO (6:10)
               GO TO 432100-EXIT.

074800     MOVE SPACES                TO TABLE-ACCESS.
074900     MOVE SPACES                TO DECL-INT-RATE-REC.
075000     MOVE 'A25'                 TO TABLE-ID IN TABLE-ACCESS.
075100     MOVE HOLD-COMPANY-CODE
075200      TO  COMPANY-CODE          IN TABLE-ACCESS.
075300     MOVE PROCESSING-SYSTEM-ID  IN POLICY-SEG
075400      TO  PRODUCT-CODE          IN TABLE-ACCESS.
075500     MOVE PLAN-CODE             IN POLICY-SEG
075600      TO  PLAN-CODE             IN TABLE-ACCESS.
           MOVE HOLD-VAL-END-DATE
             TO WS-TEST-DATE.
075700     MOVE WS-TEST-DATE
075800      TO  EFFECTIVE-DATE        IN TABLE-ACCESS
075900         INTEREST-RATE-EFFECTIVE-DATE IN DECL-INT-RATE-REC
076000         RECEIPT-PERIOD-START-DATE IN DECL-INT-RATE-REC.
           IF ANNIVERSARY-IND IN   INTEREST-SPEC-RECORD = 'P'
               PERFORM 432150-ADJUST-DATE.
           MOVE POLICY-EFF-DATE IN POLICY-SEG
            TO  EFFECTIVE-DATE        IN TABLE-ACCESS
                RECEIPT-PERIOD-START-DATE IN DECL-INT-RATE-REC.
076100     MOVE DECLARED-INT-RATE-TBL
076200                                IN INTEREST-SPEC-RECORD
076300      TO  TABLE-ENTRY-NUMBER    IN TABLE-ACCESS.
076400     MOVE POLICY-ISSUE-STATE    IN POLICY-SEG
076500      TO  ISSUE-STATE           IN DECL-INT-RATE-REC.
076600     CALL  'ITAX011'  USING  TABLE-ACCESS
076700                             DECL-INT-RATE-REC.

           IF NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS

               MOVE ZEROS
                 TO STMT-INT-RATE

               MOVE ZEROS
                 TO STMT-GUAR-DATE

              DISPLAY 'TABLE A25 ERROR = '
                   RETURN-STATUS IN TABLE-ACCESS
              DISPLAY 'POL NUMBER = '
                HOLD-CONTRACT-NO (6:10)
              GO TO 432100-EXIT.


               MOVE ZEROS
                 TO STMT-INT-RATE

               MOVE ZEROS
                 TO STMT-GUAR-DATE

           MOVE INTEREST-RATE     IN DECL-INT-RATE-REC
                                  TO STMT-INT-RATE.

           IF  ANNIVERSARY-IND IN   INTEREST-SPEC-RECORD = 'P'
               MOVE POLICY-ANNIV-DATE     IN POLICY-SEG
                                          TO TRANS-DATE
           ELSE
               IF  ANNIVERSARY-IND IN   INTEREST-SPEC-RECORD = 'C'
                   MOVE CALENDAR-ANNIV-DATE  IN POLICY-SEG
                                          TO TRANS-DATE
               ELSE
                   MOVE SPACES            TO TRANS-DATE.

           MOVE TRANS-DATE                TO STMT-GUAR-DATE.

077300 432100-EXIT.
077400     EXIT.
077500     EJECT
      ******************************************************************
      * THIS CODE IS TO USE POLICY ANNIVERSARY DATE WHEN LOOKING FOR   *
      * THE RATE ON THE TABLE A25                                      *
      ******************************************************************
       432150-ADJUST-DATE.
      *       DISPLAY '432150-ADJUST-DATE'.
           MOVE POLICY-EFF-DATE IN POLICY-SEG
             TO INTEREST-RATE-EFFECTIVE-DATE  IN DECL-INT-RATE-REC.
           IF  (WS-TEST-MM < POLICY-EFF-MM) OR
               (WS-TEST-MM = POLICY-EFF-MM AND
                  WS-TEST-DD < POLICY-EFF-DD)
               COMPUTE INTEREST-RATE-EFFECTIVE-YYYY
                                             IN DECL-INT-RATE-REC =
               WS-TEST-YYYY - 1
           ELSE
               COMPUTE INTEREST-RATE-EFFECTIVE-YYYY
                                             IN DECL-INT-RATE-REC =
               WS-TEST-YYYY.

       432150-EXIT.
           EXIT.
           EJECT
       435000-EXPLORER-REC-35.

      * THIS CODE DETERMINES THE END DATE FOR THE INITIAL MONEY FUND
      * GUARANTEED PERIOD. THE HOLD-FUND-NUMBER HAS BEEN ESTABLISHED
      * AT THIS POINT SO WHEN WE CALL 947000-GET-MONYFND-SEG WE WILL
      * EITHER GET A MONEY FUND SEGMENT OF 101, 103, 106 OR 111. IF
      * IT IS 111, WE HAVE ALREADY GONE THROUGH THE ANNIVERSARY SO
      * THE LAST RENEWAL DATE IS THE END OF THE PRIOR PERIOD. IF WE
      * DON'T HAVE 111, THE WE HAVEN'T HAD OUR FIRST RENEWAL YET SO
      * NEXT RENEWAL DATE WILL WORK. THIS IS TRUE EVEN IF THE SEGMENT
      * IS TERMINATED AS FOR EXPLORER I AND II ALL PREMIUMS WILL HAVE
      * THE SAME END DATE EVEN IF THE START DATES ARE DIFFERENT.
      *
           MOVE 'Y' TO FIRST-TIME-MONEY-FUND-FLAG.
           PERFORM 947000-GET-MONYFND-SEG THRU 947000-EXIT.

           IF  FUND-NUMBER IN MONEY-FUND-KEY-WORK = +111
              MOVE LAST-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
                TO BASE-DATE          IN DATE-ARITHMETIC-AREA
                   RETURN-DATE        IN DATE-ARITHMETIC-AREA
           ELSE
              MOVE NEXT-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
                TO BASE-DATE          IN DATE-ARITHMETIC-AREA
                   RETURN-DATE        IN DATE-ARITHMETIC-AREA
           END-IF.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO E-STMT-GUAR-DATE         IN STMTEX-LINE.

           MOVE '35'
             TO RECORD-TYPE              IN STMTEX-LINE.

           IF TRX-BEGIN-DATE NOT = POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO
      ***** $T45382 START *****
      *         TO HOLD-INITIAL-PAYMENT
      *            E-STMT-INITIAL-PREM
                TO E-STMT-INITIAL-PREM
                   E-STMT-ADD-PAYMENTS
           ELSE
              MOVE HOLD-INITIAL-PAYMENT
                TO E-STMT-INITIAL-PREM
      ***** $T45382  END  *****
           END-IF.

           IF HOLD-1STYR-ADD-PAYMENT > ZERO
               MOVE HOLD-1STYR-ADD-PAYMENT
                 TO E-STMT-ADD-PAYMENTS
      ***** $T45382 START *****
      *    ELSE
      *        MOVE HOLD-ADD-PAYMENT
      *          TO E-STMT-ADD-PAYMENTS
      ***** $T45382  END  *****
           END-IF.

           MOVE HOLD-CREDIT-ENHANCEMENT
             TO E-STMT-CREDIT-ENHANCEMENT.
           COMPUTE E-STMT-TOTAL-PAYMENTS
                 = HOLD-INITIAL-PAYMENT
                 + HOLD-1STYR-ADD-PAYMENT
                 + HOLD-ADD-PAYMENT
           END-COMPUTE.

      ***** $T45382 START *****
      *    COMPUTE E-STMT-INTEREST
      *          = E-STMT-END-BAL
      *          - E-STMT-CREDIT-ENHANCEMENT
      *          - E-STMT-TOTAL-PAYMENTS
      *          - E-STMT-BEG-BAL
      *          - E-STMT-WITHDRAW
      *    END-COMPUTE.
           IF  TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
              COMPUTE E-STMT-INTEREST
                    = E-STMT-END-BAL
                    - E-STMT-WITHDRAW
                    - E-STMT-CREDIT-ENHANCEMENT
                    - E-STMT-TOTAL-PAYMENTS
              END-COMPUTE
           ELSE
              COMPUTE E-STMT-INTEREST
                    = E-STMT-END-BAL
                    - E-STMT-WITHDRAW
                    - E-STMT-BEG-BAL
              END-COMPUTE
           END-IF.
      ***** $T45382  END  *****

       435000-EXIT.
           EXIT.
           EJECT
       436000-FIA-REC-30.

           PERFORM 850000-BUILD-FUND-TABLE THRU 850000-EXIT.

           IF  SW-RIDERS-ON-POLICY
              MOVE 'Y'
                TO STMT-RIDER-SW
              IF  RIDER-SUB-TYPE IN RIDER-SEGMENT = 'SELIB   '
                 MOVE SELIB-LITERAL-35
                   TO STMT-RIDER-NAME
              ELSE
                 MOVE JELIB-LITERAL-35
                   TO STMT-RIDER-NAME
              END-IF
              IF FIA-INDEX-EDGE-CONTRACT
                 IF RIDER-SUB-TYPE IN RIDER-SEGMENT = 'JIEIB  '
                    MOVE JIEIB-LITERAL-35
                      TO STMT-RIDER-NAME
                 ELSE
                    MOVE SIEIB-LITERAL-35
                      TO STMT-RIDER-NAME
                 END-IF
              END-IF
           ELSE
              MOVE 'N'
                TO STMT-RIDER-SW
              MOVE SPACES
                TO STMT-RIDER-NAME
           END-IF.

           IF  TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO
                TO STMT-BEG-BAL
           END-IF.

           MOVE TOTAL-CLAIMS
             TO STMT-WITHDRAW.
           MOVE WK-TOTAL-TAX
             TO STMT-TAX.
           MOVE WK-WD-CHARGES
             TO STMT-WDCHARGE.

           COMPUTE STMT-MVA
                 = WK-STMT-MVA-AMT
                 * -1
           END-COMPUTE.

           MOVE HOLD-INITIAL-PAYMENT
             TO STMT-INITIAL-PREM.
      ***** $114947 START *****
      *    COMPUTE STMT-TOTAL-PAYMENTS
           COMPUTE STMT-SUMM-TOTAL-PAYMENTS
      ***** $114947  END  *****
                 = HOLD-INITIAL-PAYMENT
                 + HOLD-ADD-PAYMENT
           END-COMPUTE.

           MOVE HOLD-CREDIT-ENHANCEMENT
             TO STMT-CREDIT-ENHANCEMENT.
           MOVE HOLD-ADD-PAYMENT
             TO STMT-ADD-PAYMENTS.
      *kpl 30 REC
      *    MOVE ZEROS
      *      TO STMT-INTEREST.
      *    MOVE ZEROS
      *      TO STMT-WITHDRAW.
      *    MOVE ZEROS
      *      TO STMT-TAX.
      *    MOVE ZEROS
      *      TO STMT-WDCHARGE.
      *    MOVE ZEROS
      *      TO STMT-MVA.

           MOVE WK-GROSS-CHECK-AMOUNT
             TO STMT-WITHD-VALUE.
      ***** $114384 START *****
      *    IF  GUAR-POLICY-VALUE > DECL-POLICY-VALUE
      *       MOVE GUAR-POLICY-VALUE
      *         TO STMT-DEATH-BENEFIT
      *    ELSE
      *       MOVE DECL-POLICY-VALUE
      *         TO STMT-DEATH-BENEFIT
      *    END-IF.
           IF  POLICY-STATUS  IN POLICY-SEG = '2'
               MOVE 'N' TO STMT-POLICY-STATUS
              CONTINUE
           ELSE
               MOVE 'A' TO STMT-POLICY-STATUS
           IF  GUAR-POLICY-VALUE IN POLICY-VALUES >
               DECL-POLICY-VALUE IN POLICY-VALUES
              MOVE GUAR-POLICY-VALUE     IN POLICY-VALUES
                TO STMT-DEATH-BENEFIT
           ELSE
              MOVE DECL-POLICY-VALUE     IN POLICY-VALUES
                TO STMT-DEATH-BENEFIT
           END-IF.
      ***** $114384  END  *****

           IF  SW-RIDERS-ON-POLICY
              PERFORM 436100-GET-GMWB-PAY-BASE THRU 436100-EXIT
              MOVE WK-GMWB-PAYBASE
                TO STMT-GMWB-PAY-BASE
           ELSE
              MOVE ZERO
                TO STMT-GMWB-PAY-BASE
           END-IF.

      ***** $114947 START *****
      *    MOVE TOTAL-CLAIMS
      *      TO STMT-TOTAL-WITHDRAW.
      ***** $114947  END  *****

      *---------------------------------------------------*
      *  ADDED BACK HERE FROM 465000-                     *
      *---------------------------------------------------*
           MOVE HOLD-FIA-INTEREST
             TO STMT-INTEREST.
           IF  FIA-TOTAL-CLAIMS > ZEROS
               MOVE FIA-TOTAL-CLAIMS    TO STMT-WITHDRAW
           ELSE
               MOVE HOLD-FIA-WITHDRAW   TO STMT-WITHDRAW
           END-IF.

           MOVE STMT-SUMM-TOTAL-PAYMENTS
             TO STMT-TOTAL-PAYMENTS.

           IF  TRX-BEGIN-DATE > POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO
                TO STMT-SUMM-TOTAL-PAYMENTS
                   STMT-CREDIT-ENHANCEMENT
                   STMT-ADD-PAYMENTS
           END-IF.

           MOVE WK-HOLD-POLICY-WITHDRAW
             TO STMT-TOTAL-WITHDRAW.

       436000-EXIT.
           EXIT.
           EJECT
       436100-GET-GMWB-PAY-BASE.

           MOVE SPACE TO SW-END-OF-RIDERS-SW
                         SW-ACTIVE-RIDERS-SW.

           PERFORM 600000-GET-FIRST-RIDER   THRU 600000-EXIT.

           PERFORM UNTIL SW-END-OF-RIDERS
                      OR SW-ACTIVE-RIDER-FOUND
                      OR NOT SUCCESSFUL-CALL IN DB-COMM-AREA

              IF  RIDER-ACTIVE
                  PERFORM 438100-VALUE-RIDER    THRU 438100-EXIT
                  ADD  IAR-INCOME-BASE IN IAR-COMM-AREA
                    TO WK-GMWB-PAYBASE
                  SET SW-ACTIVE-RIDER-FOUND
                    TO TRUE
                  GO TO 436100-EXIT
              END-IF

              PERFORM 610000-GET-NEXT-RIDER THRU 610000-EXIT

           END-PERFORM.

       436100-EXIT.
           EXIT.
           EJECT
       436500-EXPED-REC-30.

           IF  TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO
                TO STMT-BEG-BAL
           END-IF.

           MOVE ZEROES
             TO STMT-WITHDRAW
                STMT-TAX
                STMT-WDCHARGE
                STMT-MVA
                STMT-INT-RATE
                STMT-WITHD-VALUE
                STMT-DEATH-BENEFIT
                STMT-GMWB-PAY-BASE.

      ***** $T97872 START *****
      *    IF  (PLAN-CODE IN POLICY-SEG = '006715')
      *    OR  (PLAN-CODE IN POLICY-SEG = '006717')
      *    OR  (PLAN-CODE IN POLICY-SEG = 'N06715')
      *    OR  (PLAN-CODE IN POLICY-SEG = 'N06717')
           IF  ((PLAN-CODE IN POLICY-SEG = '006715')
           OR   (PLAN-CODE IN POLICY-SEG = 'N06715')
           OR   (PLAN-CODE IN POLICY-SEG = '006717')
           OR   (PLAN-CODE IN POLICY-SEG = 'N06717'))
           AND ((RATE-CHANGE-XFER-DATE-R IN POLICY-SEG NOT = 99999999)
           OR   (WK-HOLD-RA-ACTIVATION-DATE > TRX-END-DATE))
      ***** $T97872  END  *****
              MOVE 'YES'
                TO STMT-RATE-ADVANTAGE
           ELSE
      *       MOVE 'NO '
              MOVE SPACES
                TO STMT-RATE-ADVANTAGE
           END-IF.

           MOVE HOLD-INITIAL-PAYMENT
             TO STMT-INITIAL-PREM.

           MOVE HOLD-ADD-PAYMENT
             TO STMT-ADD-PAYMENTS.

           MOVE HOLD-CREDIT-ENHANCEMENT
             TO STMT-CREDIT-ENHANCEMENT.

           IF  PIA-CONTRACT
              COMPUTE STMT-TAX
                    = WK-TOTAL-TAX
                    * -1
              END-COMPUTE
              COMPUTE STMT-WDCHARGE
                    = WK-WD-CHARGES
                    * -1
              END-COMPUTE
              COMPUTE STMT-MVA
                    = WK-TOTAL-MVA
                    * -1
              END-COMPUTE
           END-IF.

           COMPUTE STMT-TOTAL-PAYMENTS
                 = STMT-INITIAL-PREM
                 + STMT-ADD-PAYMENTS
           END-COMPUTE.

           COMPUTE STMT-WITHDRAW
                 = TOTAL-CLAIMS
                 * -1
           END-COMPUTE.

           IF  TRX-BEGIN-DATE NOT = POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO TO STMT-INITIAL-PREM
                           STMT-ADD-PAYMENTS
                           STMT-CREDIT-ENHANCEMENT
           END-IF.

           COMPUTE STMT-INTEREST
                 = STMT-END-BAL
                 - STMT-INITIAL-PREM
                 - STMT-ADD-PAYMENTS
                 - STMT-CREDIT-ENHANCEMENT
                 - STMT-WITHDRAW
                 - STMT-BEG-BAL
           END-COMPUTE.

       436500-EXIT.
           EXIT.
           EJECT
       437000-GET-REC-38.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '38'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

      *    MOVE SURRENDER-PENALTY-AMT    IN INQ-CONT-AREA
           MOVE WK-WITHD-WITHDRWL-CHRGS
             TO FULL-WITHD-WITHDRWL-CHRGS.

      *    MOVE TOTAL-MVA-AMOUNT         IN POLICY-VALUES
      *    MOVE TOTAL-MVA-AMT            IN TA-WORK-AREA
      *    MOVE WK-WITHD-MVA
      *      TO FULL-WITHD-MVA.
           COMPUTE FULL-WITHD-MVA
                 = WK-WITHD-MVA
                 * -1
           END-COMPUTE.
      *    MOVE CASH-SURRENDER-VALUE     IN INQ-CONT-AREA
           MOVE WK-NET-NON-GMSV-AMOUNT
             TO FULL-WITHD-VALUE-AFTER-CHRGS.
      ***** $T84581 START *****
      *    MOVE GMSV-AMOUNT              IN TA-WORK-AREA
      *      TO FULL-WITHD-MIN-SURRENDER.
      ***** $T97872 START *****
      *    COMPUTE FULL-WITHD-MIN-SURRENDER
      *          = GMSV-AMOUNT  IN TA-WORK-AREA
      *          - GMSV-PENALTY IN TA-WORK-AREA
      *    END-COMPUTE.
           MOVE WK-WITHD-MIN-SURRENDER
             TO FULL-WITHD-MIN-SURRENDER.
      ***** $T97872  END  *****
      ***** $T84581  END  *****
           MOVE WK-GROSS-CHECK-AMOUNT
             TO FULL-WITHD-VALUE.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       437000-EXIT.
           EXIT.
           EJECT
       438000-GET-REC-39.

           MOVE SPACE TO SW-END-OF-RIDERS-SW
                         SW-ACTIVE-RIDERS-SW.

           PERFORM 600000-GET-FIRST-RIDER   THRU 600000-EXIT.

           PERFORM UNTIL SW-END-OF-RIDERS
                      OR SW-ACTIVE-RIDER-FOUND
                      OR NOT SUCCESSFUL-CALL IN DB-COMM-AREA

              IF  RIDER-ACTIVE
                  PERFORM 438100-VALUE-RIDER    THRU 438100-EXIT
                  PERFORM 438200-CREATE-39-REC  THRU 438200-EXIT
                  SET SW-ACTIVE-RIDER-FOUND
                    TO TRUE
                  GO TO 438000-EXIT
              ELSE
                  PERFORM 610000-GET-NEXT-RIDER THRU 610000-EXIT
              END-IF

           END-PERFORM.

       438000-EXIT.
           EXIT.
           EJECT
       438100-VALUE-RIDER.

           INITIALIZE IAR-COMM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN IAR-COMM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO MASTER-ID                IN IAR-COMM-AREA.
           MOVE WK-VALUATION-MM
             TO IAR-CALC-EFF-MM          IN IAR-COMM-AREA.
           MOVE WK-VALUATION-DD
             TO IAR-CALC-EFF-DD          IN IAR-COMM-AREA.
           MOVE WK-VALUATION-YY
             TO IAR-CALC-EFF-YY          IN IAR-COMM-AREA.
           MOVE WK-HOLD-RIDER-KEY
             TO IAR-SEGMENT-KEY          IN IAR-COMM-AREA.

           CALL 'MUAFI11' USING TRX-COMM-AREA
                                TRX-WORK-AREA
                                FUND-SEG-KEY
                                IAR-COMM-AREA
                                POLICY-SEG
                                SCHEDULE-SEGMENT.
           IF  NOT IAR-ERROR-FREE
              MOVE IAR-ERROR-CODE TO VCS-ABEND-CODE
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
              GO TO 438100-EXIT
           END-IF.

       438100-EXIT.
           EXIT.
           EJECT
       438200-CREATE-39-REC.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '39'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           MOVE RIDER-SUB-TYPE           IN RIDER-SEGMENT (1:5)
             TO RIDER-TYPE               IN RIDER-RECORD.
           STRING RIDER-TYPE IN RIDER-SEGMENT DELIMITED BY SIZE
                  RIDER-SUB-TYPE IN RIDER-SEGMENT DELIMITED BY SIZE
             INTO VANTAGE-RIDER-TYPE.
           IF  RIDER-SUB-TYPE IN RIDER-SEGMENT = 'SELIB   '
              STRING 'Enhanced Lifetime Income ' DELIMITED BY SIZE
                     'Benefit Rider - Single Life' DELIMITED BY SIZE
                INTO RIDER-NAME
           ELSE
              STRING 'Enhanced Lifetime Income ' DELIMITED BY SIZE
                     'Benefit Rider - Joint Life' DELIMITED BY SIZE
                INTO RIDER-NAME
           END-IF.

           IF  FIA-INDEX-EDGE-CONTRACT
              IF  RIDER-SUB-TYPE IN RIDER-SEGMENT = 'JIEIB   '
                 STRING 'Interest Enhanced Income ' DELIMITED BY SIZE
                        'Benefit Rider - Joint Life'  DELIMITED BY SIZE
                   INTO RIDER-NAME
              ELSE
                 STRING 'Interest Enhanced Income ' DELIMITED BY SIZE
                        'Benefit Rider - Single Life' DELIMITED BY SIZE
                   INTO RIDER-NAME
              END-IF
           END-IF

           IF  PIA-CONTRACT
              IF  RIDER-SUB-TYPE IN RIDER-SEGMENT (1:1) = 'S'
                 MOVE 'Single Life' TO RIDER-NAME
              ELSE
                 MOVE 'Joint Life' TO RIDER-NAME
              END-IF
           END-IF.

           MOVE RIDER-START-DATE         IN RIDER-SEGMENT
             TO RIDER-START-DATE         IN RIDER-RECORD.
           IF  ACTIVE-STATUS IN POLICY-SEG
              MOVE IAR-INCOME-ALLOW      IN IAR-COMM-AREA
                TO RIDER-PROTECTED-AMT
              MOVE IAR-INCOME-BASE       IN IAR-COMM-AREA
                TO RIDER-PAYMENT-BASE
           ELSE
              MOVE ZERO
                TO RIDER-PROTECTED-AMT
                   RIDER-PAYMENT-BASE
           END-IF.
           MOVE STEP-UP-DATE             IN RIDER-SEGMENT
             TO RIDER-RESET-DATE.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       438200-EXIT.
           EXIT.
           EJECT

       440000-GET-REC-40.

           MOVE ZERO  TO  TERM-SUB

           PERFORM VARYING WS-FUND-SUB FROM 1 BY 1
              UNTIL WS-FUND-SUB > 99
                 OR FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                                        = 999

      *      IF   WK-VALUE-BEGIN (WS-FUND-SUB) <= 0
      *      AND  WK-VALUE-END (WS-FUND-SUB)   <= 0

               MOVE  FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                 TO  WK-FUND-NUMBER (WS-FUND-SUB)
                         HOLD-FUND-NUMBER

               MOVE LOW-VALUES TO MONEY-FUND-KEY-WORK
               MOVE FUND-NUMBER IN POLICY-VALUES (WS-FUND-SUB)
                 TO FUND-NUMBER OF MONEY-FUND-KEY-WORK

               MOVE 'Y' TO  FIRST-TIME-MONEY-FUND-FLAG
               PERFORM 947000-GET-MONYFND-SEG THRU 947000-EXIT


             IF (ORIG-DEPOSIT-EFF-DATE   IN MONEY-FUND-SEGMENT
                    >= TRX-END-DATE)
             OR  MFUND-SEGMENT-NOT-FOUND

                 CONTINUE
             ELSE

               MOVE SPACES TO FUND-CHANGED-SW
               MOVE SPACE TO SW-EXPLORER-SKIP-SW


               PERFORM
                 UNTIL NOT SUCCESSFUL-CALL IN DB-COMM-AREA
                 OR FUND-CHANGED
                 OR SW-EXPLORER-SKIP

                 PERFORM 441000-GET-40-RECORD THRU 441000-EXIT

               END-PERFORM
             END-IF
           END-PERFORM.

           IF EXPLORER-CONTRACT AND
              GENERATE-REC-47
              PERFORM 445200-EXPLORER-REC-47 THRU 445200-EXIT
           END-IF.

           MOVE ZERO
            TO EARNINGS-ERROR-AMT
               TOTAL-EARNINGS
               HOLD-STMT-INTEREST.


       440000-EXIT.
           EXIT.

       441000-GET-40-RECORD.

      *
      *  BUILD CURRENT ANNIVERSARY DATE USING ANNIVERSARY MM AND DD
      *  AND CCYY FROM VAL END DATE
      *
      *
           MOVE POLICY-ANNIV-MM   IN POLICY-SEG
             TO CURRENT-ANNIV-MM

           MOVE POLICY-ANNIV-DD   IN POLICY-SEG
             TO CURRENT-ANNIV-DD

           MOVE VAL-END-DATE-CCYY
             TO CURRENT-ANNIV-YY

           IF ACTIVE-SEGMENT IN MONEY-FUND-SEGMENT
           OR  (TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT
                   AND   NEXT-RENEWAL-DATE IN MONEY-FUND-SEGMENT
      *            EQUAL CURRENT-ANNIV-DATE)
                   EQUAL CURRENT-ANNIV-DATE
                   AND NOT EXPLORER-CONTRACT)
           OR  (TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT
                   AND   NEXT-RENEWAL-DATE IN MONEY-FUND-SEGMENT
                         > CURRENT-ANNIV-DATE
                   AND     FRONTIERS-CONTRACT
                   AND   ORIG-DEPOSIT-TRX-CODE IN MONEY-FUND-SEGMENT
                         NOT EQUAL 'VA')
           OR  (TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT
      ***** $13412 START *****
      *            AND   LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT =
      *                  CURRENT-ANNIV-DATE
                   AND ((LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT =
                         CURRENT-ANNIV-DATE)
                   OR   ((LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT NOT <
                         TRX-BEGIN-DATE)
                   AND   (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT NOT >
                         TRX-END-DATE)))
      ***** $13412  END  *****
                   AND   EXPLORER-CONTRACT)

      * FRONTIERS EDIT TO BYPASS A NEW MONEYFUND SEGMENT WHEN
      * WHEN THERE EXISTS MULTIPLE BUCKETS IN SAME FUND.

                  IF FRONTIERS-CONTRACT
                     IF (ORIG-DEPOSIT-EFF-DATE   IN MONEY-FUND-SEGMENT
                         >= TRX-END-DATE)
                        GO TO 441000-CONTINUE
                     END-IF
                  END-IF

               MOVE   '40'
                TO   RECORD-TYPE

               MOVE  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                 TO  KEY-FUND-NUMBER
               MOVE  HOLD-CONTRACT-NO (6:10)
                 TO  POLICY-NUMBER  IN  KEY-DEFINITION


               MOVE HOLD-COMPANY-CODE
                 TO COMPANY-CODE         IN KEY-DEFINITION

               MOVE HOLD-PROD-MNEMONIC
                 TO KEY-PROD-MNEMONIC


               EVALUATE TRUE
                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 011
                       MOVE '1 YEAR '
                         TO TERM-PERIOD
                       MOVE 1
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 012
                       MOVE '2 YEAR '
                         TO TERM-PERIOD
                       MOVE 2
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 013
                       MOVE '3 YEAR '
                         TO TERM-PERIOD
                       MOVE 3
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 014
                       MOVE '4 YEAR '
                         TO TERM-PERIOD
                       MOVE 4
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 015
                       MOVE '5 YEAR '
                         TO TERM-PERIOD
                       MOVE 5
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 016
                       MOVE '6 YEAR '
                         TO TERM-PERIOD
                       MOVE 6
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 017
                       MOVE '7 YEAR '
                         TO TERM-PERIOD
                       MOVE 7
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 018
                       MOVE '8 YEAR '
                         TO TERM-PERIOD
                       MOVE 8
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 019
                       MOVE '9 YEAR '
                         TO TERM-PERIOD
                       MOVE 9
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 020
                       MOVE '10 YEAR'
                         TO TERM-PERIOD
                       MOVE 10
                         TO HOLD-TERM-PERIOD
               END-EVALUATE

      *
      *  frontriers II fund numbers
      *
               EVALUATE TRUE
                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 041
                       MOVE '1 YEAR '
                         TO TERM-PERIOD
                       MOVE 1
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 042
                       MOVE '2 YEAR '
                         TO TERM-PERIOD
                       MOVE 2
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 043
                       MOVE '3 YEAR '
                         TO TERM-PERIOD
                       MOVE 3
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 044
                       MOVE '4 YEAR '
                         TO TERM-PERIOD
                       MOVE 4
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 045
                       MOVE '5 YEAR '
                         TO TERM-PERIOD
                       MOVE 5
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 046
                       MOVE '6 YEAR '
                         TO TERM-PERIOD
                       MOVE 6
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 047
                       MOVE '7 YEAR '
                         TO TERM-PERIOD
                       MOVE 7
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 048
                       MOVE '8 YEAR '
                         TO TERM-PERIOD
                       MOVE 8
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 049
                       MOVE '9 YEAR '
                         TO TERM-PERIOD
                       MOVE 9
                         TO HOLD-TERM-PERIOD

                   WHEN  FUND-NUMBER OF MONEY-FUND-KEY-WORK
                                     = 050
                       MOVE '10 YEAR'
                         TO TERM-PERIOD
                       MOVE 10
                         TO HOLD-TERM-PERIOD
               END-EVALUATE

      *
      * PACIFIC INCOME ADVANTAGE (PIA) FUNDS
      *
               EVALUATE TRUE
                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 071
                        MOVE '1 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 072
                        MOVE '2 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 073
                        MOVE '3 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 074
                        MOVE '4 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 075
                        MOVE '5 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 076
                        MOVE '6 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 077
                        MOVE '7 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 078
                        MOVE '8 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 079
                        MOVE '9 YEAR  '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

                   WHEN FUND-NUMBER IN MONEY-FUND-KEY-WORK = 080
                        MOVE '10 YEAR '
                          TO TERM-PERIOD
                        MOVE 10
                          TO HOLD-TERM-PERIOD

               END-EVALUATE

               MOVE HOLD-VAL-END-DATE
                 TO TERM-AS-OF-DATE

               COMPUTE TERM-INT-RATE =
                   INTEREST-RATE IN MONEY-FUND-SEGMENT
                           (CURR-OCCURS IN MONEY-FUND-SEGMENT)
                              * 100

               MOVE NEXT-RENEWAL-DATE IN MONEY-FUND-SEGMENT
                 TO  BASE-DATE
                     TERM-END

               MOVE LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT
                 TO TERM-BEGINNING

      **** FRONTIERS RENEWAL EDIT TO ENSURE THE CORRECT TERM ****
      **** DATES/RATES DISPLAY ONCE A RENEWAL HAS OCCURRED   ****


               IF FRONTIERS-CONTRACT
                  IF (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT
                      > TRX-END-DATE)
                  AND
                     (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT NOT EQUAL
                      ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT)
                      PERFORM 441005-FRONTIERS-RNWL-40 THRU 441005-EXIT
                  END-IF
               END-IF

               MOVE  HOLD-CONTRACT-NO (6:10)
                 TO  POLICY-NUMBER IN KEY-DEFINITION

      *        MOVE  SERVICING-AGENCY-CODE IN  POLICY-SEG
               MOVE  PGO-SERVICING-AGENCY
                 TO  BROKER-NO

      *        MOVE  SERVICING-AGENT IN  POLICY-SEG
               MOVE  PGO-SERVICING-AGENT
                 TO  REP-NO

               MOVE HOLD-SSN
                 TO KEY-SSN

              IF EXPLORER-CONTRACT
                 PERFORM 444000-EXPLORER-RECS THRU 444000-EXIT
              ELSE
      *
      *   WRITE OUT RECORD TYPE 40
      *    DISPLAY 'WRITE OUT RECORD TYPE 40'
      *
               WRITE ANNL-STMNT    FROM    STMTEX-LINE
              END-IF

               MOVE ZEROS
                 TO KEY-DEFINITION

               MOVE SPACES
                 TO DATA-DEFINITION-AREA


               ADD 1 TO  TERM-SUB

      *
      * WHEN THERE ARE MULTIPLE BUCKETS OF SAME FUND WE ONLY WANT
      * FIRST INTEREST RATE.  TEMPORARY FIX
      *
               IF HOLD-TERM-INT-RATE (TERM-SUB)
                     > 0
                   CONTINUE
               ELSE
                   MOVE TERM-INT-RATE
                     TO HOLD-TERM-INT-RATE (TERM-SUB)
               END-IF


           ELSE

               COMPUTE TERM-INT-RATE =
                   INTEREST-RATE IN MONEY-FUND-SEGMENT
                           (CURR-OCCURS IN MONEY-FUND-SEGMENT)
                              * 100

               ADD 1 TO  TERM-SUB

               MOVE TERM-INT-RATE
                 TO HOLD-TERM-INT-RATE (TERM-SUB)

           END-IF.

           IF EXPLORER-CONTRACT
      ***** $P71533 START *****
      *       GO TO 441000-CONTINUE
              IF  FUND-NUMBER IN MONEY-FUND-KEY-WORK = 111
                 SET SW-EXPLORER-SKIP TO TRUE
                 GO TO 441000-EXIT
              ELSE
                 GO TO 441000-CONTINUE
              END-IF
      ***** $P71533  END  *****
           END-IF.
      *
      * Get earnings here while going thru money fund segs
      * stored in table for use in record type 50
      *

           PERFORM 441100-GET-EARNINGS   THRU 441100-EXIT.

           MOVE  TERM-SUB
             TO  TERM-COUNT

           MOVE  FUND-NUMBER OF MONEY-FUND-KEY-WORK
             TO  HOLD-TERM-FUND (TERM-SUB)
           MOVE  ORIG-DEPOSIT-FILE-CODE IN MONEY-FUND-SEGMENT
             TO  HOLD-TERM-DEPOSIT-CODE (TERM-SUB)
      *
           COMPUTE HOLD-TERM-INTEREST-RATE (TERM-SUB) =
                INTEREST-RATE           IN MONEY-FUND-SEGMENT
                           (CURR-OCCURS IN MONEY-FUND-SEGMENT)
                            * 100

      * FRONTIERS EDIT - IF RENEWAL HAS OCCURED, PRIOR TERM'S RATE   *
      * IS USED.                                                     *

           IF FRONTIERS-CONTRACT
              MOVE ORIG-DEPOSIT-TRX-CODE IN MONEY-FUND-SEGMENT
                TO HOLD-TERM-ORIG-TRX-CODE (TERM-SUB)

                IF (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT
                    > TRX-END-DATE)
                AND
                   (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT NOT EQUAL
                    ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT)

                   COMPUTE HOLD-TERM-INTEREST-RATE (TERM-SUB) = 100 *
                      INTEREST-RATE IN MONEY-FUND-SEGMENT (WK-RNWL-SUB)
                   END-COMPUTE

                END-IF
           END-IF

           MOVE TWELVE-MONTHS-PERIOD-EARNINGS
             TO HOLD-TERM-EARNINGS (TERM-SUB)

           IF HOLD-VAL-BEGIN-DATE  =
                   HOLD-ISSUE-DATE
               MOVE FUND-BEGIN-DECL-CURRENT-VALUE
                 TO HOLD-FUND-BEGIN-DECL-VALUE (TERM-SUB)
           ELSE
               MOVE FUND-BEGIN-DECL-PRIOR-VALUE
                 TO HOLD-FUND-BEGIN-DECL-VALUE (TERM-SUB)
           END-IF.

           MOVE FUND-END-DECL-VALUE
             TO HOLD-FUND-END-DECL-VALUE (TERM-SUB).

           MOVE FUND-END-DECL-VALUE-CURRENT
             TO HOLD-FUND-END-DECL-VALUE-CUR (TERM-SUB).

       441000-CONTINUE.

           PERFORM 947000-GET-MONYFND-SEG THRU 947000-EXIT.

       441000-EXIT.
           EXIT.

       441005-FRONTIERS-RNWL-40.
      *------------------------

      * CALCULATE THE CORRECT TERM DATES AND FIND THE CORRECT     *
      * RATE OCCURANCE (WK-RNWL-SUB) FOR THE STATEMENT CURRENTLY  *
      * PROCESSING. THIS HANDLES BACKDATED STATEMENT REQUESTS.    *

           MOVE ZERO  TO WK-RNWL-SUB

           MOVE NEXT-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
             TO WORK-NEXT-RENEW-DATE
           MOVE LAST-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
             TO WORK-LAST-RENEW-DATE
           MOVE CURR-OCCURS              IN MONEY-FUND-SEGMENT
             TO WK-RNWL-SUB

           PERFORM 441010-ROLLBACK-FRONTIERS THRU 441010-EXIT
             UNTIL  (WORK-LAST-RENEW-DATE =
                     ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT)
                OR ((WORK-LAST-RENEW-DATE NOT > TRX-BEGIN-DATE)
               AND  (WORK-NEXT-RENEW-DATE > TRX-END-DATE))

           MOVE WORK-LAST-RENEW-DATE
             TO TERM-BEGINNING

           MOVE WORK-NEXT-RENEW-DATE
             TO TERM-END

           COMPUTE TERM-INT-RATE = 100 *
                   INTEREST-RATE IN MONEY-FUND-SEGMENT (WK-RNWL-SUB)
           END-COMPUTE

           MOVE ZERO TO WORK-LAST-RENEW-DATE
           MOVE ZERO TO WORK-NEXT-RENEW-DATE.

       441005-EXIT.
      *-----------
           EXIT.

       441010-ROLLBACK-FRONTIERS.
      *-------------------------

           MOVE WORK-NEXT-RENEW-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA
           MOVE 0
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA

           COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
                 = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
                 * -1
           END-COMPUTE

           CALL 'IUAXF85' USING  DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WORK-NEXT-RENEW-DATE

           MOVE WORK-LAST-RENEW-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA
           MOVE 0
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA

           COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
                 = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
                 * -1
           END-COMPUTE

           CALL 'IUAXF85' USING  DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WORK-LAST-RENEW-DATE

           IF  WK-RNWL-SUB > +1
              SUBTRACT +1 FROM WK-RNWL-SUB
           END-IF.

       441010-EXIT.
      *-----------
           EXIT.

090162
       441100-GET-EARNINGS.
      *---------------------------------
      *       DISPLAY ' 441100-'.

           IF POLICY-NOT-ACTIVE
           AND HOLD-SURR-EFF-DATE
                   >= TRX-BEGIN-DATE
           AND HOLD-SURR-EFF-DATE
                   <= TRX-END-DATE

               MOVE HOLD-SURR-EFF-DATE
                 TO VALUATION-DATE IN EARNINGS-PARMS

           ELSE
               MOVE HOLD-VAL-END-DATE
                 TO VALUATION-DATE IN EARNINGS-PARMS

           END-IF.

           MOVE HOLD-VAL-BEGIN-DATE
             TO LAST-MODAL-DATE IN EARNINGS-PARMS.

      *
      * DUE TO CHANGES IN MUAFE12, A SWITCH WAS ADDED TO CALC
      * EARNINGS USING DIFFERENT DATES FOR STATEMENT PURPOSES
      *
           MOVE 'S'
             TO EARNING-CALC-TYPE  IN EARNINGS-PARMS.
049400
           CALL 'MUAFE12' USING TRX-COMM-AREA
                                TRX-WORK-AREA
                                FUND-SEGMENT
                                MONEY-FUND-SEGMENT
                                SAVE-MONYFUND-KEY
                                POLICY-SEG
                                FUND-SEG-KEY
                                RESERVE-RECORD
                                RESERVE-TABLES
                                RSVE-SPEC-INT-TABLE-AREA
                                RETURNED-REMOVED-AMOUNT
                                EARNINGS-PARMS.
      *
       441100-EXIT.
           EXIT.
           EJECT
       444000-EXPLORER-RECS.

           PERFORM 445050-GET-INT-SPEC-TBL THRU 445050-EXIT.

           IF TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT OR
              (ACTIVE-SEGMENT IN MONEY-FUND-SEGMENT AND
              (FUND-NUMBER IN MONEY-FUND-KEY-WORK NOT = 111))
              SET GENERATE-REC-45 TO TRUE
           ELSE
              IF NOT GENERATE-REC-45
                 SET GENERATE-REC-46 TO TRUE
              END-IF
           END-IF.

           IF GENERATE-REC-45
              PERFORM 445000-EXPLORER-REC-45 THRU 445000-EXIT
           ELSE
              IF GENERATE-REC-46
                 PERFORM 445100-EXPLORER-REC-46 THRU 445100-EXIT
              END-IF
           END-IF.

       444000-EXIT.
           EXIT.
           EJECT
       445000-EXPLORER-REC-45.

           MOVE SPACE TO END-OF-DAY-TRXS-SW.
           PERFORM 445010-PROCESS-HISTORY THRU 445010-EXIT
             UNTIL END-OF-TRXHIST OR END-OF-DAY-TRXS.

       445000-EXIT.
           EXIT.
           EJECT
       445010-PROCESS-HISTORY.

           IF REGULAR-PAYMENT-TYPE-TRX IN GEN-TRX-REC OR
              EXTRA-CREDIT-TRX IN GEN-TRX-REC
              IF EFFECTIVE-DATE IN GEN-TRX-REC =
                 ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT
                 PERFORM 445020-TRX-DETAIL THRU 445020-EXIT
              ELSE
      ***** $13412 START *****
      *          SET END-OF-DAY-TRXS TO TRUE
      *          GO TO 445010-EXIT
                 IF  EFFECTIVE-DATE IN GEN-TRX-REC >
                     ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT
                    SET END-OF-DAY-TRXS TO TRUE
                    GO TO 445010-EXIT
                 END-IF
      ***** $13412  END  *****
              END-IF
           END-IF.

           MOVE SPACES TO DB-PARM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE SAVE-TRXHIST-KEY
             TO SEGMENT-KEY              IN DB-PARM-AREA.
           MOVE GET-NEXT                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE TRANSACTION-HISTORY      IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.
           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.

           PERFORM 4613000-GET-SEGMENT THRU 4613000-EXIT.
           IF SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE SEGMENT-KEY           IN DB-COMM-AREA
                TO SAVE-TRXHIST-KEY
              GO TO 445010-EXIT
           END-IF.

           SET END-OF-TRXHIST TO TRUE.

       445010-EXIT.
           EXIT.
           EJECT
       445020-TRX-DETAIL.

           IF REGULAR-PAYMENT-TYPE-TRX IN GEN-TRX-REC
              MOVE PAYMENT-AMOUNT        IN NA-TRX-REC
                TO E-TERM-PAYMENT-AMT
              MOVE 'Purchase Payment         '
                TO E-TERM-PAYMENT-DESC
              PERFORM 445030-WRITE-TRX-LINE THRU 445030-EXIT
           END-IF.

           IF EXTRA-CREDIT-TRX IN GEN-TRX-REC
              MOVE TOTAL-TRX-AMOUNT      IN XC-TRX-REC
                TO E-TERM-PAYMENT-AMT
              MOVE 'Credit Enhancement       '
                TO E-TERM-PAYMENT-DESC
              PERFORM 445030-WRITE-TRX-LINE THRU 445030-EXIT
           END-IF.

       445020-EXIT.
           EXIT.
           EJECT
       445030-WRITE-TRX-LINE.

           MOVE '45'
             TO RECORD-TYPE              IN STMTEX-LINE.

           MOVE KEY-FUND-NUMBER
             TO E-TERM-FUND-NUMBER.

           MOVE EFFECTIVE-DATE           IN GEN-TRX-REC
             TO E-TERM-PAYMENT-DATE.

           MOVE ZEROES
             TO E-TERM-INT-ENH-RATE
                E-TERM-INT-ENH-DATE.

           MOVE CURR-OCCURS              IN MONEY-FUND-SEGMENT
             TO SUBF.
           IF TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT
              IF SUBF > +1
                 SUBTRACT 1 FROM SUBF
              END-IF
           END-IF.

           IF REGULAR-PAYMENT-TYPE-TRX IN GEN-TRX-REC
              IF FORCED-INTEREST-RATE IN MONEY-FUND-SEGMENT > ZERO
                 MULTIPLY FORCED-INTEREST-RATE IN MONEY-FUND-SEGMENT
                       BY 100.00
                   GIVING E-TERM-INT-RATE
              ELSE
      *          MULTIPLY INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBF)
                 MULTIPLY INTEREST-RATE IN MONEY-FUND-SEGMENT (1)
                       BY 100.00
                   GIVING E-TERM-INT-RATE
              END-IF
           ELSE
      *       MOVE CREDIT-PERCENT        IN XC-TRX-REC
              MOVE ZEROES
                TO E-TERM-INT-RATE
              WRITE ANNL-STMNT FROM STMTEX-LINE
              GO TO 445030-EXIT
           END-IF.

           IF (SUBF = +1) OR
              (FUND-NUMBER IN MONEY-FUND-KEY-WORK = 111)
              WRITE ANNL-STMNT FROM STMTEX-LINE
              GO TO 445030-EXIT
           END-IF.

           PERFORM VARYING SUBH FROM +1 BY +1
             UNTIL SUBH NOT < SUBF

              COMPUTE E-TERM-INT-ENH-RATE
                    = (INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBH + 1)
                    -  INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBH))
                    * 100.00
              END-COMPUTE

              PERFORM 445040-DETERMINE-DATE THRU 445040-EXIT
              MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                TO E-TERM-INT-ENH-DATE

              WRITE ANNL-STMNT FROM STMTEX-LINE

              MOVE ZEROES
                TO E-TERM-PAYMENT-DATE
                   E-TERM-PAYMENT-AMT
                   E-TERM-INT-RATE
              MOVE SPACES
                TO E-TERM-PAYMENT-DESC

           END-PERFORM.

       445030-EXIT.
           EXIT.
           EJECT
       445040-DETERMINE-DATE.

           MOVE ORIG-DEPOSIT-EFF-DATE    IN MONEY-FUND-SEGMENT
             TO ORIG-EFFECTIVE-DATE.

           CALL 'IUAEVC1' USING LEAP-YEAR-DAYS IN INTEREST-SPEC-RECORD
                                ORIG-EFFECTIVE-DATE
                                ORIG-EFFECTIVE-DAYS-1900.

           MOVE ORIG-DEPOSIT-EFF-DATE    IN MONEY-FUND-SEGMENT
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.

           MOVE ZEROES
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           SUBTRACT ORIG-EFFECTIVE-DAYS-1900
               FROM END-DAYS-1900 IN MONEY-FUND-SEGMENT (SUBH)
             GIVING CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

       445040-EXIT.
           EXIT.
           EJECT
       445050-GET-INT-SPEC-TBL.

           MOVE SPACES TO TABLE-ACCESS
                          INTEREST-SPEC-RECORD.

           MOVE 'A24'
             TO TABLE-ID                 IN TABLE-ACCESS.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN TABLE-ACCESS.
           MOVE PROCESSING-SYSTEM-ID     IN POLICY-SEG
             TO PRODUCT-CODE             IN TABLE-ACCESS.
           MOVE PLAN-CODE                IN POLICY-SEG
             TO PLAN-CODE                IN TABLE-ACCESS.
           MOVE POLICY-EFF-DATE          IN POLICY-SEG
             TO EFFECTIVE-DATE           IN TABLE-ACCESS
                EFFECTIVE-DATE           IN INTEREST-SPEC-RECORD.
           MOVE KEY-FUND-NUMBER
             TO FUND-NUMBER              IN INTEREST-SPEC-RECORD.

           CALL 'ITAX011' USING TABLE-ACCESS
                                INTEREST-SPEC-RECORD.
           IF NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS
              MOVE +365
                TO LEAP-YEAR-DAYS        IN INTEREST-SPEC-RECORD
              DISPLAY 'TABLE A24 ERROR = ' RETURN-STATUS IN TABLE-ACCESS
              DISPLAY 'POL NUMBER = ' HOLD-CONTRACT-NO (6:10)
           END-IF.

       445050-EXIT.
           EXIT.
           EJECT
       445060-GET-FIRST-TRXHIST.

           MOVE SPACES TO DB-PARM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE GET-FIRST                IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE TRANSACTION-HISTORY      IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.
           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.

           PERFORM 4613000-GET-SEGMENT THRU 4613000-EXIT.
           IF SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE SEGMENT-KEY           IN DB-COMM-AREA
                TO SAVE-TRXHIST-KEY
              MOVE SPACE TO END-OF-TRXHIST-SW
              GO TO 445060-EXIT
           END-IF.

           MOVE TRX-HIST-READ-ERROR TO VCS-ABEND-CODE.
           PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

       445060-EXIT.
           EXIT.
           EJECT
       445100-EXPLORER-REC-46.

           MOVE '46'
             TO RECORD-TYPE              IN STMTEX-LINE.

           MOVE HOLD-VAL-END-DATE
             TO E-TERM-2-AS-OF-DATE.

           MOVE '1 YEAR '
             TO E-TERM-2-PERIOD.

           MOVE TRX-BEGIN-DATE
             TO E-TERM-2-BEGINNING.

           IF CURR-OCCURS IN MONEY-FUND-SEGMENT > +1
               SUBTRACT 1
                   FROM CURR-OCCURS IN MONEY-FUND-SEGMENT
                 GIVING SUBH
           END-IF.

           MULTIPLY INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBH)
                 BY 100.00
             GIVING E-TERM-2-INT-RATE.

           MOVE TRX-END-DATE
             TO E-TERM-2-END.

           MOVE KEY-FUND-NUMBER
             TO E-TERM-2-FUND-NUMBER.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       445100-EXIT.
           EXIT.
           EJECT
       445200-EXPLORER-REC-47.

           MOVE PGO-SERVICING-AGENCY
             TO BROKER-NO.
           MOVE PGO-SERVICING-AGENT
             TO REP-NO.
           MOVE HOLD-SSN
             TO KEY-SSN.
           MOVE HOLD-FUND-NUMBER
             TO KEY-FUND-NUMBER.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC.
           MOVE '47'
             TO RECORD-TYPE              IN STMTEX-LINE.

           MOVE HOLD-VAL-END-DATE
             TO E-RENEW-AS-OF-DATE.

           MOVE '1 YEAR '
             TO E-RENEW-PERIOD.

           MOVE TRX-BEGIN-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.

           MOVE +1
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
           MOVE ZEROES
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO E-RENEW-BEGINNING.

           PERFORM 445300-EXPLORER-FUND-111 THRU 445300-EXIT.

           MOVE CURR-OCCURS              IN MONEY-FUND-SEGMENT
             TO SUBH.

           MULTIPLY INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBH)
                 BY 100.00
             GIVING E-RENEW-INT-RATE.

           MOVE E-RENEW-BEGINNING
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.

           MOVE +1
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
           MOVE ZEROES
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO E-RENEW-END.

           MOVE KEY-FUND-NUMBER
             TO E-RENEW-FUND-NUMBER.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

           MOVE ZEROS
             TO KEY-DEFINITION.
           MOVE SPACES
             TO DATA-DEFINITION-AREA.

       445200-EXIT.
           EXIT.
           EJECT
       445300-EXPLORER-FUND-111.

           MOVE SPACES TO DB-PARM-AREA
                          MONEY-FUND-KEY-WORK.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN MONEY-FUND-KEY-WORK.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN MONEY-FUND-KEY-WORK.
           MOVE HOLD-FUND-NUMBER
             TO FUND-NUMBER              IN MONEY-FUND-KEY-WORK.
           MOVE LOW-VALUES
             TO ELEMENT-KEY              IN MONEY-FUND-KEY-WORK.
           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY            IN DB-PARM-AREA.
           MOVE 'GFI '
             TO OPERATION                IN DB-PARM-AREA.
           MOVE MONEY-FUND               IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.
           IF NOT SUCCESSFUL-CALL  IN DB-COMM-AREA
              DISPLAY ' RECORD NOT FOUND IN 445300 - '
                      HOLD-CONTRACT-NO (6:10)
           END-IF.

       445300-EXIT.
           EXIT.
           EJECT
       447000-FRONTIERS-II-REC-40.

           MOVE SPACE TO SW-PRODUCE-FII-REC-47-SW.

           PERFORM VARYING SUBF FROM +1 BY +1
             UNTIL (SUBF > POLICY-MAX-FUNDS)
                OR (FUND-NUMBER IN POLICY-VALUES (SUBF) =
                    FUND-NUMBER-DEFAULT)

              MOVE FUND-NUMBER           IN POLICY-VALUES (SUBF)
                TO HOLD-FUND-NUMBER

              PERFORM 447180-GET-1ST-MONYFND  THRU 447180-EXIT
              MOVE LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
                TO HOLD-LAST-RENEW-DATE
              MOVE NEXT-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
                TO HOLD-NEXT-RENEW-DATE
              MOVE CURR-OCCURS           IN MONEY-FUND-SEGMENT
                TO SUBC

              MOVE SPACE TO SW-MONEY-FUND-FOUND-SW
                            SW-END-OF-MONYFND-SW
              PERFORM 447100-ADJUST-MF-DATES  THRU 447100-EXIT
                UNTIL SW-MONEY-FUND-FOUND
                   OR SW-END-OF-MONYFND

           END-PERFORM.

       447000-EXIT.
           EXIT.
           EJECT
       447100-ADJUST-MF-DATES.

           MOVE NEXT-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
             TO WORK-NEXT-RENEW-DATE.
           MOVE LAST-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
             TO WORK-LAST-RENEW-DATE.
           MOVE CURR-OCCURS              IN MONEY-FUND-SEGMENT
             TO SUBW.

           IF  LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT > TRX-END-DATE
              PERFORM 447110-ROLLBACK-MF-DATES THRU 447110-EXIT
                UNTIL (WORK-LAST-RENEW-DATE =
                       ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT)
                   OR ((WORK-LAST-RENEW-DATE NOT > TRX-BEGIN-DATE)
                   AND (WORK-NEXT-RENEW-DATE > TRX-END-DATE))
           END-IF.

           PERFORM 447120-REC-47-CHECK        THRU 447120-EXIT.

           IF  (TRX-BEGIN-DATE NOT < WORK-LAST-RENEW-DATE)
           AND (TRX-END-DATE       < WORK-NEXT-RENEW-DATE)
              PERFORM 447130-WRITE-FII-40-REC THRU 447130-EXIT
              SET SW-MONEY-FUND-FOUND TO TRUE
              GO TO 447100-EXIT
           END-IF.

           PERFORM 447190-GET-NXT-MONYFND     THRU 447190-EXIT.

       447100-EXIT.
           EXIT.
           EJECT
       447110-ROLLBACK-MF-DATES.

           MOVE WORK-NEXT-RENEW-DATE TO HOLD-NEXT-RENEW-DATE.
           MOVE WORK-LAST-RENEW-DATE TO HOLD-LAST-RENEW-DATE.
           MOVE SUBW                 TO SUBC.

           MOVE WORK-NEXT-RENEW-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE 0
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
                 = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
                 * -1
           END-COMPUTE.

           CALL 'IUAXF85' USING  DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WORK-NEXT-RENEW-DATE.

           MOVE WORK-LAST-RENEW-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE 0
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
                 = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
                 * -1
           END-COMPUTE.

           CALL 'IUAXF85' USING  DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WORK-LAST-RENEW-DATE.

           IF  SUBW > +1
              SUBTRACT +1 FROM SUBW
           END-IF.

       447110-EXIT.
           EXIT.
           EJECT
       447120-REC-47-CHECK.

           MOVE TRX-END-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE +1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           IF  RETURN-DATE IN DATE-ARITHMETIC-AREA =
               HOLD-LAST-RENEW-DATE
              SET SW-PRODUCE-FII-REC-47 TO TRUE
              MOVE MONEY-FUND-KEY-WORK TO HOLD-MONYFND-KEY
              MOVE MONEY-FUND-SEGMENT  TO HOLD-MONYFND-SEG
           END-IF.

       447120-EXIT.
           EXIT.
           EJECT
       447130-WRITE-FII-40-REC.

           IF  (FUND-NUMBER IN MONEY-FUND-KEY-WORK = WK-OEA-FROM-FUND)
           AND (WORK-LAST-RENEW-DATE = WK-OEA-DATE)
              GO TO 447130-EXIT
           END-IF.

           MOVE PGO-SERVICING-AGENCY
             TO BROKER-NO.
           MOVE PGO-SERVICING-AGENT
             TO REP-NO.
           MOVE HOLD-SSN
             TO KEY-SSN.
           MOVE FUND-NUMBER              IN MONEY-FUND-KEY-WORK
             TO KEY-FUND-NUMBER.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '40'
             TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC.

           MOVE HOLD-VAL-END-DATE
             TO TERM-AS-OF-DATE.
           COMPUTE WK-FUND-TERM
                 = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
                 / 12
           END-COMPUTE.

           EVALUATE TRUE

              WHEN WK-FUND-TERM = 1
                 MOVE '1 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 2
                 MOVE '2 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 3
                 MOVE '3 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 4
                 MOVE '4 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 5
                 MOVE '5 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 6
                 MOVE '6 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 7
                 MOVE '7 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 8
                 MOVE '8 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 9
                 MOVE '9 YEAR '
                   TO TERM-PERIOD

              WHEN WK-FUND-TERM = 10
                 MOVE '10 YEAR'
                   TO TERM-PERIOD

           END-EVALUATE.

           MOVE WORK-LAST-RENEW-DATE
             TO TERM-BEGINNING.
           COMPUTE TERM-INT-RATE
                 = INTEREST-RATE IN MONEY-FUND-SEGMENT (SUBW)
                 * 100
           END-COMPUTE.
           MOVE WORK-NEXT-RENEW-DATE
             TO TERM-END.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

       447130-EXIT.
           EXIT.
           EJECT
       447180-GET-1ST-MONYFND.

           MOVE SPACES TO DB-PARM-AREA
                          DB-COMM-AREA.
           MOVE LOW-VALUES TO MONEY-FUND-KEY-WORK.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN MONEY-FUND-KEY-WORK.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN MONEY-FUND-KEY-WORK.
           MOVE HOLD-FUND-NUMBER
             TO FUND-NUMBER              IN MONEY-FUND-KEY-WORK.
           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY            IN DB-PARM-AREA.
           MOVE 'GFI '
             TO OPERATION                IN DB-PARM-AREA.
           MOVE MONEY-FUND               IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-MONYFND TO TRUE
              GO TO 447180-EXIT
           END-IF.

           MOVE SEGMENT-KEY             IN DB-COMM-AREA
             TO MONEY-FUND-KEY-WORK.

       447180-EXIT.
           EXIT.
           EJECT
       447190-GET-NXT-MONYFND.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY            IN DB-PARM-AREA.
           MOVE 'GNI '
             TO OPERATION                IN DB-PARM-AREA.
           MOVE MONEY-FUND               IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-MONYFND TO TRUE
              GO TO 447190-EXIT
           END-IF.

           MOVE SEGMENT-KEY             IN DB-COMM-AREA
             TO MONEY-FUND-KEY-WORK.

           IF  FUND-NUMBER IN MONEY-FUND-KEY-WORK NOT = HOLD-FUND-NUMBER
              SET SW-END-OF-MONYFND TO TRUE
              GO TO 447190-EXIT
           END-IF.

       447190-EXIT.
           EXIT.
           EJECT


       450000-GET-REC-50.
      *     DISPLAY '450000-'.

           PERFORM 451000-STORE-ALL-RECS
                          THRU 451000-EXIT.

           PERFORM 452000-WRITE-ALL-RECS
                          THRU 452000-EXIT.


       450000-EXIT.
           EXIT.
           EJECT

       451000-STORE-ALL-RECS.
      *     DISPLAY '451000-'.

           PERFORM VARYING TERM-SUB FROM 1 BY 1
             UNTIL  TERM-SUB > TERM-COUNT


               MOVE HOLD-VAL-END-DATE
                 TO HOLD-POL-AS-OF-DATE (TERM-SUB)

               PERFORM 451100-GET-TERM-NAME THRU 451100-EXIT

               MOVE HOLD-TERM TO HOLD-POL-TERM (TERM-SUB)

               PERFORM 451200-GET-TRANSFERS-WDS THRU 451200-EXIT
               MOVE HOLD-TRANSFER-AMT
                 TO HOLD-POL-TRANSFER-AMT (TERM-SUB)

               MOVE  HOLD-TERM-EARNINGS(TERM-SUB)
                 TO  EARNINGS-AVAILABLE
                     HOLD-POL-INTEREST (TERM-SUB)

               MOVE  HOLD-FUND-BEGIN-DECL-VALUE(TERM-SUB)
                 TO  HOLD-POL-BEGIN-VALUE (TERM-SUB)


               IF   POLICY-NOT-ACTIVE
               AND  HOLD-SURR-EFF-DATE
                            >= TRX-BEGIN-DATE
               AND  HOLD-SURR-EFF-DATE
                            <= TRX-END-DATE
                   MOVE  ZEROS
                     TO  HOLD-POL-END-VALUE (TERM-SUB)
                         HOLD-POL-END-VALUE-CURRENT (TERM-SUB)
               ELSE
                   MOVE  HOLD-FUND-END-DECL-VALUE(TERM-SUB)
                     TO  HOLD-POL-END-VALUE (TERM-SUB)
                   MOVE  HOLD-FUND-END-DECL-VALUE-CUR(TERM-SUB)
                     TO  HOLD-POL-END-VALUE-CURRENT (TERM-SUB)
               END-IF

      **** CHECK FOR DUPLICATE TERMS HERE - IF A TRANSER OCCURED ****
      **** OUT OF THE FUND, A FIX IS INTRODUCED TO ONLY APPLY    ****
      **** THE TRANSFER AMOUNT TO THE CORRECT TERM.              ****

               PERFORM 451250-FRONTIERS-DUPL-TERMS THRU 451250-EXIT


               MOVE  HOLD-TERM-INTEREST-RATE(TERM-SUB)
                 TO  HOLD-POL-INT-RATE (TERM-SUB)

               COMPUTE  HOLD-POL-WD-CHARGE    (TERM-SUB)  =
                        HOLD-POL-END-VALUE    (TERM-SUB)  -
                        HOLD-POL-BEGIN-VALUE  (TERM-SUB)  -
                        HOLD-POL-INTEREST     (TERM-SUB)  -
                        HOLD-POL-TRANSFER-AMT (TERM-SUB)

               COMPUTE NEXT-TERM-SUB =
                               TERM-SUB + 1

               COMPUTE   TOTAL-POL-WD-CHARGE  =
                         TOTAL-POL-WD-CHARGE  +
                               HOLD-POL-WD-CHARGE (TERM-SUB)

               IF TERM-SUB = TERM-COUNT
               OR HOLD-TERM-FUND (TERM-SUB)
                     NOT EQUAL  HOLD-TERM-FUND (NEXT-TERM-SUB)

                   PERFORM 451300-CHECK-WITHDRAWAL-AMT
                                       THRU 451300-EXIT
               ELSE
                   CONTINUE
               END-IF

           END-PERFORM.


       451000-EXIT.
           EXIT.
           EJECT


       451100-GET-TERM-NAME.
      *---------------------------------

      *       DISPLAY ' 451100-'.
           EVALUATE TRUE
               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 011
                   MOVE '1 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 012
                   MOVE '2 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 013
                   MOVE '3 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 014
                   MOVE '4 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 015
                   MOVE '5 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 016
                   MOVE '6 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 017
                   MOVE '7 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 018
                   MOVE '8 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 019
                   MOVE '9 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB)
                                 = 020
                   MOVE '10 YEAR'
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB) = 101
                   MOVE '1 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB) = 103
                   MOVE '3 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB) = 106
                   MOVE '6 YEAR '
                     TO HOLD-TERM

               WHEN  HOLD-TERM-FUND (TERM-SUB) = 111
                   MOVE '1 YEAR '
                     TO HOLD-TERM
           END-EVALUATE.


       451100-EXIT.
           EXIT.
           EJECT

       451200-GET-TRANSFERS-WDS.
      *---------------------------------

      *       DISPLAY ' 451200-'.

           MOVE ZEROS TO WK-FUND-WD-CHARGES
           MOVE ZEROS TO WK-FUND-CLAIMS

           MOVE 'Y' TO GET-VALUES-SW
           MOVE 'Y' TO GET-FUND-VALUES-SW
           MOVE 'N' TO TRX-PROCESSING-COMPLETE-SW.

           MOVE ZEROS TO  HOLD-FUND-CLAIM-AMT
                       WK-FUND-TOTAL-TAX
                       WK-FUND-PENALTY
                       HOLD-TRANSFER-AMT

091200     MOVE SPACES                     TO DB-PARM-AREA.
091300     MOVE SPACES                     TO DB-COMM-AREA.
091400     MOVE GET-LAST                   IN DB-OPERATIONS
091500       TO OPERATION                  IN DB-PARM-AREA.
091600     MOVE TRANSACTION-HISTORY        IN DB-SEGMENT-MNEMONICS
091700       TO ACCESS-SEGMENT             IN DB-PARM-AREA.
091800     MOVE HOLD-COMPANY-CODE
091900       TO COMPANY-CODE               IN DB-PARM-AREA.
092000     MOVE HOLD-CONTRACT-NO
092100       TO KEY-QUALIFIER              IN DB-PARM-AREA.
092200
098000     CALL 'IVEXAI1' USING DB-PARM-AREA
098100                          GEN-TRX-REC
098200                          DB-COMM-AREA.
098300
092500     IF  NOT SUCCESSFUL-CALL         IN DB-COMM-AREA
092600         MOVE TRX-HIST-READ-ERROR
092700           TO  VCS-ABEND-CODE
092800         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
092810
090210     PERFORM 321100-GET-TRX-INFO
                   UNTIL TRX-PROCESSING-COMPLETE.

       451200-EXIT.
           EXIT.
           EJECT

       451250-FRONTIERS-DUPL-TERMS.
      *---------------------------

           IF NOT FRONTIERS-CONTRACT
              GO TO 451250-EXIT
           END-IF

           IF HOLD-TERM-ORIG-TRX-CODE (TERM-SUB) = 'VA'
              GO TO 451250-EXIT
           END-IF

           IF TERM-COUNT = 1
              GO TO 451250-EXIT
           END-IF

      ***  FIND IF A DUPLICATE TERM EXISTS BY COMPARING PREVIOUS  ***
      ***  AND FOLLOWING FUND NUMBERS IN THE EXISTING TABLE FROM  ***
      ***  40 RECORD.                                             ***

           MOVE ZERO TO NEXT-TERM-SUB
                        PREV-TERM-SUB

           COMPUTE NEXT-TERM-SUB = TERM-SUB + 1
           END-COMPUTE

           IF NEXT-TERM-SUB > TERM-COUNT
              MOVE TERM-SUB TO NEXT-TERM-SUB
           END-IF

           IF TERM-SUB = 1
              MOVE TERM-SUB TO PREV-TERM-SUB
           ELSE
              IF TERM-SUB > 1
                 COMPUTE PREV-TERM-SUB = TERM-SUB - 1
                 END-COMPUTE
              END-IF
           END-IF

           IF HOLD-TERM-FUND (TERM-SUB) NOT EQUAL
              HOLD-TERM-FUND (PREV-TERM-SUB)
              MOVE HOLD-POL-TRANSFER-AMT (TERM-SUB)
                TO WK-DUPL-TRANSFER-AMT
           END-IF

           IF HOLD-TERM-FUND (TERM-SUB) EQUAL
              HOLD-TERM-FUND (NEXT-TERM-SUB)
           OR
             (HOLD-TERM-FUND (TERM-SUB) EQUAL
              HOLD-TERM-FUND (PREV-TERM-SUB)
           AND
              TERM-SUB > 1 )

      ***  CHECK IF A TRANSFER OUT OF THE DUPLICATE TERM OCCURED  ***
      ***  AND IF SO TEST: IF END-VALUE - INTEREST IS GREATER     ***
      ***  THAN BEGIN-VALUE MULTIPLIED BY THRESHOLD.              ***

      ***  THRESHOLD CHOSEN AS 1% FOR $T182477, THUS WE MULTIPLY  ***
      ***  BEGIN-VALUE BY .991 TO EVALUATE IF A TRADE OCCURED.    ***

              IF HOLD-POL-TRANSFER-AMT (TERM-SUB) < 0
                 IF HOLD-POL-END-VALUE (TERM-SUB) > 0
                    IF ((HOLD-POL-END-VALUE (TERM-SUB) -
                         HOLD-POL-INTEREST (TERM-SUB)) >=
                        (HOLD-POL-BEGIN-VALUE (TERM-SUB) * .991))
                    OR   HOLD-POL-BEGIN-VALUE (TERM-SUB) = 0
                    AND (HOLD-POL-END-VALUE (TERM-SUB) NOT EQUAL
                         HOLD-POL-INTEREST (TERM-SUB) +
                         HOLD-POL-TRANSFER-AMT (TERM-SUB))
                        COMPUTE HOLD-POL-TRANSFER-AMT (TERM-SUB) =
                                HOLD-POL-TRANSFER-AMT (TERM-SUB) +
                                WK-DUPL-TRANSFER-AMT * -1
                        END-COMPUTE
                    END-IF
                 END-IF
              END-IF

              MOVE ZERO TO NEXT-TERM-SUB
                           PREV-TERM-SUB.

       451250-EXIT.
      *-----------
           EXIT.

       451300-CHECK-WITHDRAWAL-AMT.
      *     DISPLAY '413000-'.

           COMPUTE WITHDRAWAL-ERROR =
                         TOTAL-POL-WD-CHARGE +
                                WK-FUND-WD-CHARGES

           IF WITHDRAWAL-ERROR  = 0

               CONTINUE

           ELSE

             IF WITHDRAWAL-ERROR  < 0.25

               COMPUTE HOLD-POL-INTEREST (TERM-SUB) =
                       HOLD-POL-INTEREST (TERM-SUB)   +
                             WITHDRAWAL-ERROR

               COMPUTE  HOLD-POL-WD-CHARGE(TERM-SUB)        =
                          HOLD-POL-END-VALUE  (TERM-SUB)     -
                          HOLD-POL-BEGIN-VALUE (TERM-SUB)    -
                          HOLD-POL-INTEREST (TERM-SUB)       -
                          HOLD-POL-TRANSFER-AMT (TERM-SUB)
             ELSE
               COMPUTE  HOLD-POL-WD-CHARGE(TERM-SUB)        =
                        HOLD-POL-END-VALUE-CURRENT  (TERM-SUB) -
                        HOLD-POL-BEGIN-VALUE (TERM-SUB)    -
                        HOLD-POL-INTEREST (TERM-SUB)       -
                        HOLD-POL-TRANSFER-AMT (TERM-SUB)
               MOVE   HOLD-POL-END-VALUE-CURRENT  (TERM-SUB)
                 TO   HOLD-POL-END-VALUE  (TERM-SUB)
      *
      * check error again to make values match
      *
               COMPUTE WITHDRAWAL-ERROR =
                         HOLD-POL-WD-CHARGE(TERM-SUB) +
                                WK-FUND-WD-CHARGES

               IF WITHDRAWAL-ERROR  = 0
                 CONTINUE
               ELSE

                 COMPUTE HOLD-POL-INTEREST (TERM-SUB) =
                       HOLD-POL-INTEREST (TERM-SUB)   +
                             WITHDRAWAL-ERROR

                 COMPUTE  HOLD-POL-WD-CHARGE(TERM-SUB)        =
                        HOLD-POL-END-VALUE-CURRENT  (TERM-SUB) -
                        HOLD-POL-BEGIN-VALUE (TERM-SUB)    -
                        HOLD-POL-INTEREST (TERM-SUB)       -
                        HOLD-POL-TRANSFER-AMT (TERM-SUB)
               END-IF
             END-IF
           END-IF.

      * FIX FOR FRONTIERS CONTRACTS THAT HAD VALUE ADJUSTMENT 'VA' *
      * TRX ANYTIME DURING CONTRACT HISTORY WHICH CREATED NEW TERM *
      * AND ARE NOW BEING TRANSACTED UPON.                         *

           IF FRONTIERS-CONTRACT
              IF HOLD-TERM-ORIG-TRX-CODE (TERM-SUB) = 'VA'
                 IF   (HOLD-POL-INTEREST (TERM-SUB) >
                       HOLD-POL-BEGIN-VALUE (TERM-SUB))
                    AND
                       ((HOLD-POL-TRANSFER-AMT (TERM-SUB) < 0)
                    OR
                        (HOLD-POL-WD-CHARGE (TERM-SUB)    < 0))
                    PERFORM 451400-FRONTIERS-VA-TRX THRU 451400-EXIT
                 END-IF
              END-IF
           END-IF

           MOVE ZEROS
             TO TOTAL-POL-WD-CHARGE
                WITHDRAWAL-ERROR.


       451300-EXIT.
           EXIT.
           EJECT

       451400-FRONTIERS-VA-TRX.
      *-----------------------

           COMPUTE PREV-TERM-SUB = TERM-SUB - 1
           END-COMPUTE

           IF HOLD-POL-WD-CHARGE (TERM-SUB) < 0
              COMPUTE HOLD-POL-WD-CHARGE (TERM-SUB) =
                      HOLD-POL-WD-CHARGE (TERM-SUB) +
                      HOLD-POL-WD-CHARGE (PREV-TERM-SUB) * -1
              END-COMPUTE
           END-IF

           IF HOLD-POL-WD-CHARGE (PREV-TERM-SUB) > 0
              COMPUTE HOLD-POL-TRANSFER-AMT (PREV-TERM-SUB) =
                      HOLD-POL-TRANSFER-AMT (PREV-TERM-SUB) +
                      HOLD-POL-WD-CHARGE (PREV-TERM-SUB)
              END-COMPUTE
              MOVE 0 TO HOLD-POL-WD-CHARGE (PREV-TERM-SUB)
           END-IF

           IF HOLD-POL-TRANSFER-AMT (TERM-SUB) < 0
              COMPUTE HOLD-POL-TRANSFER-AMT (TERM-SUB) =
                      HOLD-POL-TRANSFER-AMT (TERM-SUB) +
                      HOLD-POL-TRANSFER-AMT (PREV-TERM-SUB) * -1
              END-COMPUTE
           END-IF

           COMPUTE HOLD-POL-INTEREST     (TERM-SUB)  =
                   HOLD-POL-END-VALUE    (TERM-SUB)  -
                   HOLD-POL-BEGIN-VALUE  (TERM-SUB)  -
                   HOLD-POL-WD-CHARGE    (TERM-SUB)  -
                   HOLD-POL-TRANSFER-AMT (TERM-SUB)
           END-COMPUTE

           IF HOLD-POL-TRANSFER-AMT (TERM-SUB) < 0
              COMPUTE HOLD-POL-TRANSFER-AMT (TERM-SUB)  =
                     (HOLD-POL-BEGIN-VALUE  (TERM-SUB)  +
                      HOLD-POL-WD-CHARGE    (TERM-SUB)  +
                      HOLD-POL-INTEREST     (TERM-SUB)) * -1
              END-COMPUTE
           END-IF.

       451400-EXIT.
      *-----------
           EXIT.

       452000-WRITE-ALL-RECS.
      *     DISPLAY '452000-'.

           PERFORM VARYING TERM-SUB FROM 1 BY 1
             UNTIL  TERM-SUB > TERM-COUNT



               MOVE   '50'
                TO   RECORD-TYPE

               MOVE  HOLD-TERM-FUND (TERM-SUB)
                 TO  KEY-FUND-NUMBER

               MOVE  HOLD-CONTRACT-NO (6:10)
                 TO  POLICY-NUMBER IN KEY-DEFINITION

               MOVE HOLD-COMPANY-CODE
                 TO COMPANY-CODE         IN KEY-DEFINITION

               MOVE  HOLD-PROD-MNEMONIC
                 TO  KEY-PROD-MNEMONIC

      *        MOVE  SERVICING-AGENCY-CODE IN  POLICY-SEG
               MOVE  PGO-SERVICING-AGENCY
                 TO  BROKER-NO

               MOVE  SERVICING-AGENT IN  POLICY-SEG
      *        MOVE  PGO-SERVICING-AGENT
                 TO  REP-NO

               MOVE HOLD-SSN
                 TO KEY-SSN

               MOVE HOLD-POL-AS-OF-DATE (TERM-SUB)
                 TO POL-AS-OF-DATE


               MOVE HOLD-POL-TERM (TERM-SUB)
                 TO POL-TERM

               MOVE HOLD-POL-TRANSFER-AMT (TERM-SUB)
                 TO POL-TRANSFER-AMT

               MOVE  HOLD-POL-INTEREST (TERM-SUB)
                 TO  POL-INTEREST

               MOVE  HOLD-POL-BEGIN-VALUE (TERM-SUB)
                 TO  POL-BEGIN-VALUE

               MOVE  HOLD-POL-END-VALUE (TERM-SUB)
                 TO  POL-END-VALUE

               MOVE  HOLD-POL-INT-RATE (TERM-SUB)
                 TO  POL-INT-RATE

               MOVE  HOLD-POL-WD-CHARGE    (TERM-SUB)
                 TO  POL-WD-CHARGE


      * DEATH STATUS CONTRACTS REQUIRE ALL RECORD TYPES BUT
      * THE DATA IS NOT VALID AND HAS A '0' PRINT CODE TO SUPPRESS
      * PRINT
      *
      *


               IF  POL-INTEREST > 0
               OR  DEATH-STATUS IN POLICY-SEG

                   WRITE ANNL-STMNT    FROM    STMTEX-LINE
               END-IF

           END-PERFORM.

           MOVE ZEROS
             TO KEY-DEFINITION

           MOVE SPACES
             TO DATA-DEFINITION-AREA.

       452000-EXIT.
           EXIT.
           EJECT
       453000-GET-REC-51.

      * COMMENTED OUT BY HUSSIN - HUSBUS
      *    INITIALIZE FIA-FUND-ARRAY.
      *
      *    PERFORM 850000-BUILD-FUND-TABLE THRU 850000-EXIT.

           MOVE ZEROS TO KEY-DEFINITION.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '51'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           PERFORM VARYING SUBF FROM +1 BY +1
      *      UNTIL (SUBF > +10)                                 $T157090
             UNTIL (FIA-CONTRACT AND SUBF > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBF > +10)
                OR (FIA-PA-CONTRACT AND SUBF > +30)
                OR (FUND-NUMBER IN RATE-SEGMENT (SUBF) = +999)

              MOVE SPACES TO DATA-DEFINITION-AREA

      *       IF  STATEMENT-BEGIN-DATE IN POLICY-SPEC-RECORD =
              IF  TRX-BEGIN-DATE =
                  POLICY-ISSUE-DATE    IN POLICY-SEG
                 MOVE '1'
                   TO FIA-CV-TITLE-SW
              ELSE
                 MOVE '2'
                   TO FIA-CV-TITLE-SW
              END-IF
              MOVE FUND-NUMBER           IN RATE-SEGMENT (SUBF)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE             IN RATE-SEGMENT (SUBF)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              IF  FIA-FUND-WITHDRAWALS (SUBF) NOT NUMERIC
                  MOVE ZEROS TO FIA-FUND-WITHDRAWALS (SUBF)
              END-IF
              IF  FIA-FUND-RIDER-FEES (SUBF) NOT NUMERIC
                  MOVE ZEROS TO FIA-FUND-RIDER-FEES (SUBF)
              END-IF
              MOVE WK-FUND-NAME-SHORT
                TO FIA-CV-INTEREST-OPTION
              MOVE FIA-FUND-PREMIUM (SUBF)
                TO FIA-CV-TOT-PURCHASE-PAY
              MOVE FIA-FUND-EXTRA-CREDIT (SUBF)
                TO FIA-CV-CREDIT-ENHANCEMENT
              MOVE FIA-FUND-TRANSFER-IN-OUT (SUBF)
                TO FIA-CV-TRANSFER-IN-OUT
              MOVE FIA-FUND-ENDING-VALUE (SUBF)
                TO FIA-CV-ENDING-VALUE
              COMPUTE FIA-CV-WITHDRAWAL-CHRGS
                =  FIA-FUND-WITHDRAWALS (SUBF)
                +  FIA-FUND-RIDER-FEES (SUBF)
              END-COMPUTE
              MOVE FIA-FUND-BEGIN-VALUE (SUBF)
                TO FIA-CV-BEGIN-VALUE
      *       IF  FIA-CV-WITHDRAWAL-CHRGS NOT NUMERIC
      *           MOVE ZEROS TO FIA-CV-WITHDRAWAL-CHRGS
      *       END-IF
      *       IF  FIA-FUND-TYPE(SUBF) = 'M'
      *           COMPUTE   FIA-FUND-INTEREST        (SUBF)   =
      *                    (FIA-FUND-ENDING-VALUE    (SUBF)   +
      *                     FIA-FUND-RIDER-FEES      (SUBF)   +
      *                     FIA-FUND-WITHDRAWALS     (SUBF) ) -
      *                    (FIA-FUND-PREMIUM         (SUBF)   +
      *                     FIA-FUND-TRANSFER-IN-OUT (SUBF)   +
      *                     FIA-FUND-EXTRA-CREDIT    (SUBF) )
      *           END-COMPUTE
      ** this will not work when the ending balance is 0 and no interest
      ** accrued with irt transactions - edge case.
      *********kpl
      **           COMPUTE FIA-FUND-INTEREST (SUBF)
      **              = FIA-FUND-INTEREST (SUBF)
      **              + FIA-FUND-RIDER-FEES (SUBF)
      **              + FIA-FUND-WITHDRAWALS (SUBF)
      **           END-COMPUTE
      *       END-IF

              MOVE FIA-FUND-INTEREST (SUBF)
                TO FIA-CV-INTEREST-EARNED

      *KPL BUILD 30 OUTPUT
      *       COMPUTE  HOLD-FIA-INTEREST
      *         =      HOLD-FIA-INTEREST
      *         +      FIA-CV-INTEREST-EARNED
      *       END-COMPUTE
      *       COMPUTE  HOLD-FIA-WITHDRAW
      *         =      HOLD-FIA-WITHDRAW
      *         +      FIA-FUND-RIDER-FEES (SUBF)
      *       END-COMPUTE
      *       COMPUTE  HOLD-FIA-WDCHARGE
      *         =      HOLD-FIA-WDCHARGE
      *         +      FIA-FUND-WITHDRAWALS (SUBF)
      *       END-COMPUTE

              IF  (FIA-CV-TOT-PURCHASE-PAY    NOT = ZERO)
              OR  (FIA-CV-CREDIT-ENHANCEMENT  NOT = ZERO)
              OR  (FIA-CV-WITHDRAWAL-CHRGS    NOT = ZERO)
              OR  (FIA-CV-INTEREST-EARNED     NOT = ZERO)
              OR  (FIA-CV-TRANSFER-IN-OUT     NOT = ZERO)
              OR  (FIA-CV-ENDING-VALUE        NOT = ZERO)
              OR  (FIA-CV-BEGIN-VALUE         NOT = ZERO)
                 WRITE ANNL-STMNT FROM STMTEX-LINE
              END-IF

           END-PERFORM.

       453000-EXIT.
           EXIT.
           EJECT
       454000-GET-REC-52.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '52'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           PERFORM VARYING SUBF FROM +1 BY +1
      **** $T157090 START ****
      *      UNTIL (SUBF > +10)
             UNTIL (FIA-CONTRACT    AND SUBF > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBF > +10)
                OR (FIA-PA-CONTRACT AND SUBF > +30)
                OR (FUND-NUMBER IN RATE-SEGMENT (SUBF) = +999)
      *
              MOVE FUND-NUMBER           IN RATE-SEGMENT (SUBF)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE             IN RATE-SEGMENT (SUBF)
                TO WK-FUND-TYPE-IND-WORK
      **** $T157090 END   ****
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO FIA-AG-BEG-INTEREST-OPTION
              MOVE SPACE TO WK-DATE-SEARCH-TYPE
              PERFORM 800000-GET-SEG-DATES  THRU 800000-EXIT
              IF  WK-BEG-DATE NOT = '00000000'
                 MOVE WK-BEG-DATE
                   TO FIA-AG-END-BEG-DATE
                 MOVE WK-END-DATE
                   TO FIA-AG-END-END-DATE
                      FIA-AG-END-GUARANTEED-DATE
               IF FIA-CONTRACT
                 IF  CDSC-EXPIRATION-DATE > WK-END-DATE
                     MOVE NEXT-RENEWAL-DATE IN RATE-SEGMENT
                       TO FIA-AG-END-GUARANTEED-DATE
                 END-IF
                 IF  FUND-TYPE IN RATE-SEGMENT (SUBF) NOT = 'I'
                    MOVE DECL-FIXED IN RATE-SEGMENT (SUBF)
                      TO FIA-AG-END-RATE
                 ELSE
                    IF  SW-USE-GTE-100K-BAND
                       MOVE DECL-GTE-100K-CAP  IN RATE-SEGMENT (SUBF)
                         TO FIA-AG-END-RATE
                    ELSE
                       MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                         TO FIA-AG-END-RATE
                    END-IF
                 END-IF
               END-IF

               IF FIA-PA-CONTRACT
               OR FIA-INDEX-EDGE-CONTRACT
                 IF  FUND-TYPE IN RATE-SEGMENT (SUBF) NOT = 'I'
                     MOVE SPREAD-NON-APPL TO FIA-AG-END-SPREAD-RATE
                   IF SW-USE-GTE-100K-BAND
                      MOVE PART-GTE-100K-RATE   IN RATE-SEGMENT (SUBF)
                        TO WK-FIXED-GTE-100K
                           COMPUTE WK-FIXED-GTE-100K =
                                   WK-FIXED-GTE-100K / 10
                           END-COMPUTE
                      MOVE WK-FIXED-GTE-100K
                        TO FIA-AG-END-RATE
                   ELSE
                      MOVE DECL-FIXED IN RATE-SEGMENT (SUBF)
                        TO FIA-AG-END-RATE
                   END-IF
                 ELSE
                  IF INDEX-TYPE IN RATE-SEGMENT (SUBF) NOT = 'E'
                     MOVE SPREAD-NON-APPL TO FIA-AG-END-SPREAD-RATE
                     IF SW-USE-GTE-100K-BAND
                         MOVE DECL-GTE-100K-CAP
                           IN RATE-SEGMENT (SUBF)
                           TO FIA-AG-END-RATE
                     ELSE
                      MOVE DECL-LES-100K-CAP
                        IN RATE-SEGMENT (SUBF)
                          TO FIA-AG-END-RATE
                     END-IF
                  ELSE
                     IF SW-USE-GTE-100K-BAND
                         MOVE PART-GTE-100K-RATE
                           IN RATE-SEGMENT (SUBF)
                           TO FIA-AG-END-RATE

                         MOVE DECL-GTE-100K-CAP
                           IN RATE-SEGMENT (SUBF)
                           TO FIA-AG-END-SPREAD-RATE
                     ELSE
                         MOVE PART-LES-100K-RATE
                           IN RATE-SEGMENT (SUBF)
                           TO FIA-AG-END-RATE
                         MOVE DECL-LES-100K-CAP
                           IN RATE-SEGMENT (SUBF)
                           TO FIA-AG-END-SPREAD-RATE
                     END-IF
                  END-IF
                 END-IF
               END-IF

      *$T157090  MOVE NEXT-RENEWAL-DATE     IN PREV-RATE-SEGMENT
      *$T157090    TO FIA-AG-END-GUARANTEED-DATE

      ***** $T87159 START *****
      *          IF  (POLICY-STATUS  IN POLICY-SEG = '2') OR
      *             ((POLICY-STATUS  IN POLICY-SEG = 'A') AND
      *              (SPOUSAL-CONTINUATION-INDICATOR
      *                              IN POLICY-SEG = 'C'))
      *             IF FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
      *                WRITE ANNL-STMNT FROM STMTEX-LINE
      *             END-IF
      *          ELSE
      *             WRITE ANNL-STMNT FROM STMTEX-LINE
      *          END-IF
                 WRITE ANNL-STMNT FROM STMTEX-LINE
      ***** $T87159  END  *****

              END-IF

           END-PERFORM.

       454000-EXIT.
           EXIT.
           EJECT
       455000-GET-REC-53.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '53'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           PERFORM VARYING SUBF FROM +1 BY +1
      **** $T157090 START ****
      *      UNTIL (SUBF > +10)
             UNTIL (FIA-CONTRACT    AND SUBF > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBF > +10)
                OR (FIA-PA-CONTRACT AND SUBF > +30)
                OR (FUND-NUMBER IN RATE-SEGMENT (SUBF) = +999)
      **** $T157090 END   ****

              MOVE SPACES TO DATA-DEFINITION-AREA

              IF  FUND-TYPE IN RATE-SEGMENT (SUBF) = 'I'
                 MOVE FUND-NUMBER           IN RATE-SEGMENT (SUBF)
                   TO WK-FUND-NUMBER-WORK
                 MOVE FUND-TYPE          IN RATE-SEGMENT (SUBF)
                   TO WK-FUND-TYPE-IND-WORK
                 PERFORM 900000-GET-INDEX-TABLE-REC THRU 900000-EXIT
                 PERFORM 910000-GET-ENDING-PRICE    THRU 910000-EXIT
                 CALL 'IUAEVC1' USING LEAP-YEAR-DAYS IN INDEX-TABLE-REC
                                     TRX-END-DATE
                                     WK-END-DAYS-1900
                 PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
                 MOVE WK-FUND-NAME-SHORT
                   TO FIA-IL-INTEREST-OPTION
                 MOVE SPACE TO SW-DATE-SEARCH-COMPLETE-SW
                 PERFORM 812000-GET-FIRST-IF      THRU 812000-EXIT
                 PERFORM UNTIL SW-DATE-SEARCH-COMPLETE

                    PERFORM 455100-PROCESS-IF-SEG THRU 455100-EXIT

                    PERFORM 822000-GET-NEXT-IF    THRU 822000-EXIT

                 END-PERFORM
              END-IF

           END-PERFORM.

       455000-EXIT.
           EXIT.
           EJECT
       455100-PROCESS-IF-SEG.

           IF  ACTIVE-SEGMENT IN INDEX-FUND-SEG
              GO TO 455100-EXIT
           END-IF.

           IF   TERMINATED-SEGMENT    IN INDEX-FUND-SEG
           AND (ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG  =
                EI-TERMINATION-DATE   IN INDEX-FUND-SEG)
              GO TO 455100-EXIT
           END-IF.

      ***** $T87159 START *****
      *    IF  EI-RENEWAL-DATE IN INDEX-FUND-SEG NOT = TRX-END-DATE
      ***** $114947 START *****
      *    IF  (EI-RENEWAL-DATE IN INDEX-FUND-SEG > TRX-END-DATE)
      *    AND SW-CONT-THIS-ANNIV-AFT
      ***** $T87159  END  *****
      *       GO TO 455100-EXIT
           IF  EI-RENEWAL-DATE IN INDEX-FUND-SEG > TRX-END-DATE
              IF  (SW-CONT-THIS-ANNIV-YR-SW = SPACE)
              OR  (SW-CONT-THIS-ANNIV-YR-SW = 'A')
                 GO TO 455100-EXIT
      ***** $114947  END  *****
           END-IF.

           IF  EI-RENEWAL-DATE IN INDEX-FUND-SEG NOT > TRX-BEGIN-DATE
              GO TO 455100-EXIT
           END-IF.

           COMPUTE WK-YEAR-IN-DAYS
                 = (EI-PERIOD IN INDEX-FUND-SEG
                 /  12.000000)
                 * LEAP-YEAR-DAYS IN INDEX-TABLE-REC
           END-COMPUTE.

      *    MOVE LAST-RENEWAL-MO          IN INDEX-FUND-SEG
           MOVE ORIG-EI-DEPOSIT-MO       IN INDEX-FUND-SEG
             TO FIA-IL-START-MM.
      *    MOVE LAST-RENEWAL-DY          IN INDEX-FUND-SEG
           MOVE ORIG-EI-DEPOSIT-DY       IN INDEX-FUND-SEG
             TO FIA-IL-START-DD.
      *    MOVE LAST-RENEWAL-YR          IN INDEX-FUND-SEG
           MOVE ORIG-EI-DEPOSIT-YR       IN INDEX-FUND-SEG
             TO FIA-IL-START-YYYY.
      ***** $T86289 START *****
      *    MOVE INIT-EI-DEPOSIT-VALUE    IN INDEX-FUND-SEG
      *      TO FIA-IL-NET-AMOUNT.
           COMPUTE FIA-IL-NET-AMOUNT
                 = LAST-ANNIV-ACV IN INDEX-FUND-SEG
                 - LAST-ANNIV-ILI IN INDEX-FUND-SEG
           END-COMPUTE.
      ***** $T86289  END  *****
           MOVE INIT-INDEX-RATE          IN INDEX-FUND-SEG
             TO FIA-IL-STARTING-PRICE.
           MOVE WK-ENDING-PRICE
             TO FIA-IL-ENDING-PRICE.

           IF FIA-CONTRACT
            IF  SW-USE-GTE-100K-BAND
              MOVE DECL-GTE-100K-CAP     IN RATE-SEGMENT (SUBF)
                TO FIA-IL-GUAR-RATE
            ELSE
              MOVE DECL-LES-100K-CAP     IN RATE-SEGMENT (SUBF)
                TO FIA-IL-GUAR-RATE
            END-IF
           END-IF.

           IF FIA-PA-CONTRACT
           OR FIA-INDEX-EDGE-CONTRACT
              IF INDEX-TYPE IN RATE-SEGMENT (SUBF) NOT = 'E'
                 MOVE SPREAD-NON-APPL TO FIA-IL-SPREAD-RATE

                 IF SW-USE-GTE-100K-BAND
                    MOVE DECL-GTE-100K-CAP  IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-GUAR-RATE
                 ELSE
                    MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-GUAR-RATE
                 END-IF
              ELSE
                 IF SW-USE-GTE-100K-BAND
                    MOVE PART-GTE-100K-RATE IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-GUAR-RATE
                    MOVE DECL-GTE-100K-CAP  IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-SPREAD-RATE
                 ELSE
                    MOVE PART-LES-100K-RATE IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-GUAR-RATE
                    MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                      TO FIA-IL-SPREAD-RATE
                 END-IF
              END-IF
           END-IF.

           COMPUTE WK-CAP-RATE
                 = FIA-IL-GUAR-RATE
                 / 100.000000000
           END-COMPUTE.

           PERFORM 920000-CALC-ILI-INFO THRU 920000-EXIT.

           MOVE WK-INDEX-GROWTH
             TO FIA-IL-INDEX-CHANGE.
      ***** $T86566 START *****
      *    IF  SW-USE-GTE-100K-BAND
      *       MOVE DECL-GTE-100K-CAP     IN RATE-SEGMENT (SUBF)
      *         TO FIA-IL-GUAR-RATE
      *    ELSE
      *       MOVE DECL-LES-100K-CAP     IN RATE-SEGMENT (SUBF)
      *         TO FIA-IL-GUAR-RATE
      *    END-IF.
      ***** $T86566  END  *****
           MOVE WK-INDEX-CREDITED-RATE
             TO FIA-IL-INTEREST-CREDITED.
      ***** $T86566 START *****
      *    IF  FIA-IL-GUAR-RATE < FIA-IL-INTEREST-CREDITED
      *       MOVE FIA-IL-GUAR-RATE TO FIA-IL-INTEREST-CREDITED
      *    END-IF.
      ***** $T86566  END  *****
           MOVE LAST-ANNIV-ILI           IN INDEX-FUND-SEG
             TO FIA-IL-INTEREST-EARNED.

           IF  EI-RENEWAL-DATE IN INDEX-FUND-SEG NOT = TRX-END-DATE
              PERFORM 455110-HANDLE-2YR-FUNDS THRU 455110-EXIT
           END-IF.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       455100-EXIT.
           EXIT.
           EJECT
       455110-HANDLE-2YR-FUNDS.

           MOVE TRX-END-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.

           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           INITIALIZE W-FUND-COMM-AREA.
           INITIALIZE ELEMENT-VALUES.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN W-FUND-COMM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO MASTER-ID                IN W-FUND-COMM-AREA.
           MOVE FUND-SEG-KEY
             TO FUND-ACCUM-SEGMENT-KEY   IN W-FUND-COMM-AREA.
           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO VALUATION-DATE           IN W-FUND-COMM-AREA.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              IN W-FUND-COMM-AREA.
           MOVE WK-FUND-TYPE-IND-WORK
             TO FUND-TYPE-INDICATOR      IN W-FUND-COMM-AREA.

           CALL 'MUAFBV1' USING W-FUND-COMM-AREA
                                POLICY-SEG
                                INDEX-FUND-SEG
                                INDEX-FUND-SEG-KEY
                                ELEMENT-VALUES.

           MOVE FUND-BEGIN-DAY-ACV       IN ELEMENT-VALUES
             TO FIA-IL-NET-AMOUNT.
           IF  WK-INDEX-PCT > ZERO
              COMPUTE FIA-IL-INTEREST-EARNED ROUNDED
                    = FUND-BEGIN-DAY-ACV IN ELEMENT-VALUES
                    * WK-INDEX-PCT
              END-COMPUTE
           ELSE
              MOVE ZERO TO FIA-IL-INTEREST-EARNED
           END-IF.

       455110-EXIT.
           EXIT.
           EJECT
       456000-GET-REC-54.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '54'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           INITIALIZE RATE-SEGMENT-KEY.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN RATE-SEGMENT-KEY.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN RATE-SEGMENT-KEY.
           MOVE TRX-END-DATE TO WK-RENEWAL-DATE.
           MOVE WK-RENEWAL-DATE
             TO NEXT-RENEWAL-DATE        IN RATE-SEGMENT-KEY
                NEXT-RENEWAL-DATE        IN RATE-SEGMENT.
           MOVE 'B' TO WK-RATE-TYPE.

           CALL 'MUAFRW1' USING POLICY-SEG
                                RATE-SEGMENT-KEY
                                RATE-SEGMENT
                                WK-RATE-TYPE
                                WK-RETURN-CODE.

           PERFORM VARYING SUBF FROM +1 BY +1
      *      UNTIL (SUBF > +10)                                 $T157090
             UNTIL (FIA-CONTRACT    AND SUBF > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBF > +10)
                OR (FIA-PA-CONTRACT AND SUBF > +30)
                OR (FUND-NUMBER IN RATE-SEGMENT (SUBF) = +999)

              MOVE FUND-NUMBER           IN RATE-SEGMENT (SUBF)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE             IN RATE-SEGMENT (SUBF)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO FIA-AG-BEG-INTEREST-OPTION
              MOVE 'N' TO WK-DATE-SEARCH-TYPE
              PERFORM 800000-GET-SEG-DATES  THRU 800000-EXIT
              MOVE WK-BEG-DATE
                TO FIA-AG-BEG-BEG-DATE
              MOVE WK-END-DATE
                TO FIA-AG-BEG-END-DATE
                   FIA-AG-BEG-GUARANTEED-DATE

             IF WK-BEG-DATE = '00000000'
                PERFORM 830000-GET-NEW-DATES THRU 830000-EXIT
                MOVE WK-END-DATE
                  TO FIA-AG-BEG-GUARANTEED-DATE
             END-IF

             IF FIA-CONTRACT
              IF  CDSC-EXPIRATION-DATE > WK-END-DATE
                  MOVE NEXT-RENEWAL-DATE     IN RATE-SEGMENT
                    TO FIA-AG-BEG-GUARANTEED-DATE
              END-IF
              IF  FUND-TYPE IN RATE-SEGMENT (SUBF) NOT = 'I'
                 MOVE DECL-FIXED IN RATE-SEGMENT (SUBF)
                   TO FIA-AG-BEG-RATE
      ***** $114947 START *****
                      FIA-AG-BEG-CAP
      *          MOVE ZERO
      *            TO FIA-AG-BEG-CAP
      ***** $114947  END  *****
              ELSE
                 MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                   TO FIA-AG-BEG-RATE
                 MOVE DECL-GTE-100K-CAP  IN RATE-SEGMENT (SUBF)
                   TO FIA-AG-BEG-CAP
              END-IF
             END-IF
             IF FIA-PA-CONTRACT
             OR FIA-INDEX-EDGE-CONTRACT
              IF  FUND-TYPE IN RATE-SEGMENT (SUBF) NOT = 'I'
                 MOVE DECL-FIXED           IN RATE-SEGMENT (SUBF)
                   TO FIA-AG-BEG-RATE
                 MOVE PART-GTE-100K-RATE   IN RATE-SEGMENT (SUBF)
                   TO WK-FIXED-GTE-100K
                      COMPUTE WK-FIXED-GTE-100K =
                              WK-FIXED-GTE-100K / 10
                      END-COMPUTE
                 MOVE WK-FIXED-GTE-100K
                   TO FIA-AG-BEG-CAP
                 MOVE SPREAD-NON-APPL      TO FIA-AG-BEG-SPREAD-RATE
              ELSE
                IF INDEX-TYPE IN RATE-SEGMENT (SUBF) NOT = 'E'
                   MOVE SPREAD-NON-APPL    TO FIA-AG-BEG-SPREAD-RATE
                   MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                     TO FIA-AG-BEG-RATE
                   MOVE DECL-GTE-100K-CAP  IN RATE-SEGMENT (SUBF)
                     TO FIA-AG-BEG-CAP
                ELSE
                   MOVE DECL-LES-100K-CAP  IN RATE-SEGMENT (SUBF)
                     TO FIA-AG-BEG-SPREAD-RATE
                   MOVE PART-LES-100K-RATE IN RATE-SEGMENT (SUBF)
                     TO FIA-AG-BEG-RATE
                   MOVE PART-GTE-100K-RATE IN RATE-SEGMENT (SUBF)
                     TO FIA-AG-BEG-CAP
                END-IF
              END-IF
             END-IF
      ***** $T157090 START *****
      *       MOVE NEXT-RENEWAL-DATE     IN RATE-SEGMENT
      *         TO FIA-AG-BEG-GUARANTEED-DATE
      *
      ***** $T157090 END   *****
      ***** $T87159 START *****
      *       IF  (POLICY-STATUS IN POLICY-SEG = '2')   OR
      *          ((POLICY-STATUS IN POLICY-SEG = 'A')  AND
      *           (SPOUSAL-CONTINUATION-INDICATOR
      *                          IN POLICY-SEG = 'C'))
              IF  SW-CONTRACT-DEATH-STATUS
      ***** $T87159  END  *****
                 IF FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
                    WRITE ANNL-STMNT FROM STMTEX-LINE
                 END-IF
              ELSE
                 WRITE ANNL-STMNT FROM STMTEX-LINE
              END-IF

           END-PERFORM.

       456000-EXIT.
           EXIT.
           EJECT
       457000-DETERMINE-BAND.

           IF  EXPEDITION-CONTRACT
           OR  MARINER-CONTRACT
              PERFORM 457200-EXPEDITION-BANDS THRU 457200-EXIT
              GO TO 457000-EXIT
           END-IF.

           MOVE SPACE TO SW-USE-GTE-100K-BAND-SW.

      ***** $87159 START *****
      *    IF  TRX-BEGIN-DATE = HOLD-ISSUE-DATE
      *       PERFORM 457100-GET-SURR-SEG THRU 457100-EXIT
      *       COMPUTE WK-ANNIVERSARY-VALUE
      *             = CUM-NET-PREMIUM IN FUND-SEGMENT
      *             - WK-TOTAL-WITHDRAWALS
      *       END-COMPUTE
      *       IF  WK-ANNIVERSARY-VALUE > +99999.99
      *          SET SW-USE-GTE-100K-BAND TO TRUE
      *       END-IF
      *    END-IF.

           INITIALIZE W-FUND-COMM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN W-FUND-COMM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO MASTER-ID                IN W-FUND-COMM-AREA.
           MOVE FUND-SEG-KEY
             TO FUND-ACCUM-SEGMENT-KEY   IN W-FUND-COMM-AREA.
           MOVE WK-VALUATION-DATE
             TO VALUATION-DATE           IN W-FUND-COMM-AREA.
           MOVE ZERO
             TO ILI-BAND-AMOUNT          IN W-FUND-COMM-AREA.

           CALL 'MUAFRA1' USING W-FUND-COMM-AREA
                                POLICY-SEG
                                RATE-SEGMENT
                                TRX-WORK-AREA.

           IF  ILI-BAND-AMOUNT in W-FUND-COMM-AREA > 99999.99
              SET SW-USE-GTE-100K-BAND TO TRUE
           END-IF.
      ***** $87159  END  *****

       457000-EXIT.
           EXIT.
           EJECT
       457100-GET-SURR-SEG.

           MOVE POLICY-EFF-DATE          IN POLICY-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE +90
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-HOLD-90-DAYS-DATE.

           MOVE ZERO TO WK-TOTAL-WITHDRAWALS.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE GET-FIRST                IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE SURRENDER-WITHDRAWAL     IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                SURR-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              GO TO 457100-EXIT
           END-IF.

           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > NUM-SURRS IN SURR-SEGMENT)
                OR (EFFECTIVE-DATE IN SURR-SEGMENT (SUBS) >
                    WK-HOLD-90-DAYS-DATE)

              ADD GROSS-AMOUNT IN SURR-SEGMENT (SUBS)
               TO WK-TOTAL-WITHDRAWALS

           END-PERFORM.

       457100-EXIT.
           EXIT.
           EJECT
       457200-EXPEDITION-BANDS.

           PERFORM 457100-GET-SURR-SEG THRU 457100-EXIT.

           COMPUTE WK-TOTAL-PREMIUM
                 = TOTAL-REGULAR-PREM  IN POLICY-SEG
                 + TOTAL-DUMP-IN-PREM  IN POLICY-SEG
                 + TOTAL-ROLLOVER-PREM IN POLICY-SEG
                 - WK-TOTAL-WITHDRAWALS
           END-COMPUTE.

           MOVE ZERO TO SUBB.
           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > MAX-BANDS)
                OR (SUBB > ZERO)
                OR (BAND-AMOUNT IN FIXED-RATE-SEG (SUBS) = ZERO)

              COMPUTE WK-BAND-AMOUNT
                    = BAND-AMOUNT IN FIXED-RATE-SEG (SUBS)
                    + NINETY-NINE-CENTS
              END-COMPUTE
              IF  WK-TOTAL-PREMIUM NOT > WK-BAND-AMOUNT
                 MOVE SUBS TO SUBB
              END-IF

           END-PERFORM.

       457200-EXIT.
           EXIT.
           EJECT
       458000-GET-REC-31.

           MOVE ZEROS TO KEY-DEFINITION.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '31'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           MOVE SPACES TO DATA-DEFINITION-AREA.

           IF  TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
              MOVE ZERO
                TO NAIC-BEGIN-WITH-VALUE
              MOVE '99999999'
                TO NAIC-BEGIN-WITH-DATE
           ELSE
              MOVE WK-HOLD-BEG-WD-VALUE
                TO NAIC-BEGIN-WITH-VALUE
              MOVE TRX-BEGIN-DATE
                TO NAIC-BEGIN-WITH-DATE
           END-IF.

           PERFORM 458100-GET-END-ANNIV-VALUE THRU 458100-EXIT.

           MOVE WK-HOLD-END-WD-VALUE
             TO NAIC-FULL-WITH-VALUE.
           MOVE WK-VALUATION-DATE
             TO NAIC-FULL-WITH-DATE.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       458000-EXIT.
           EXIT.
           EJECT
       458100-GET-END-ANNIV-VALUE.

           MOVE SPACES TO POLICY-VALUES.

      ***** $T97014 START *****
      *    IF  FIA-CONTRACT
      *       MOVE TRX-END-DATE
      *         TO BASE-DATE             IN DATE-ARITHMETIC-AREA
      *            RETURN-DATE           IN DATE-ARITHMETIC-AREA
      *       MOVE ZERO
      *         TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
      *            CHANGE-DATE-MMM       IN DATE-ARITHMETIC-AREA
      *       MOVE -1
      *         TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
      *
      *       CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA
      *
      *       MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
      *         TO WK-VALUATION-DATE
      *    ELSE
      *       MOVE TRX-END-DATE       TO WK-VALUATION-DATE
      *    END-IF.
           MOVE TRX-END-DATE TO WK-VALUATION-DATE.
      ***** $T97014  END  *****

           MOVE SPACES TO POLICY-VALUES
                          INQ-CONT-AREA.

           IF  POLICY-NOT-ACTIVE
              IF  (HOLD-SURR-EFF-DATE >= TRX-BEGIN-DATE)
              AND (HOLD-SURR-EFF-DATE <= TRX-END-DATE)
                 MOVE 'N'
                   TO TERMINATED-STATUS-REQUEST-SW IN POLICY-VALUES
              ELSE
                 MOVE 'Y'
                   TO TERMINATED-STATUS-REQUEST-SW IN POLICY-VALUES
              END-IF
           END-IF.

           PERFORM 960000-CURRENT-AV THRU 960000-EXIT

           COMPUTE WK-HOLD-END-WD-VALUE
                 = CIC-AMT-UNDISTRIBUTED     IN POLICY-VALUES
                 + ACCUMULATED-CASH-VALUE    IN POLICY-VALUES
                 + TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                 + MIN-SURRENDER-BENEFIT     IN INQ-CONT-AREA
                 - SURRENDER-PENALTY-AMT     IN INQ-CONT-AREA
                 - FLAT-FEE-AMT              IN INQ-CONT-AREA
                 - TOTAL-MVA-AMT             IN TA-WORK-AREA
                 - GMDBR-FEE                 IN TA-WORK-AREA
                 - GIAR-FEE                  IN TA-WORK-AREA
                 - EEGR-FEE                  IN TA-WORK-AREA
                 - GPAR-FEE                  IN TA-WORK-AREA
                 - IAR-FEE                   IN TA-WORK-AREA
                 - SALES-CHARGE-ADJ          IN TA-WORK-AREA
                 - TOTAL-LOAN-PRINCIPAL-DUE  IN POLICY-VALUES
                 - ARREARS-EARNED-INTEREST   IN POLICY-VALUES
                 + ADVANCE-UNEARNED-INTEREST IN POLICY-VALUES
           END-COMPUTE.

       458100-EXIT.
           EXIT.
           EJECT
       458500-GET-REC-55.

           IF  TRX-BEGIN-DATE NOT = POLICY-EFF-DATE IN POLICY-SEG
              GO TO 458500-EXIT
           END-IF.

           MOVE ZEROS TO KEY-DEFINITION.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '55'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

      *    PERFORM 458510-GET-PAYMENTS THRU 458510-EXIT.

           MOVE EFFECTIVE-DATE           IN FIXED-RATE-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           IF  EFFECTIVE-DATE  IN FIXED-RATE-SEG NOT =
               POLICY-EFF-DATE IN POLICY-SEG
              MOVE +1
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
           ELSE
              MOVE WK-EXPEDITION-PERIOD
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
           END-IF.
           MOVE ZERO
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
      ***** $T97872 START *****
      *    MOVE -1
      *      TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           IF  (EFFECTIVE-MM IN FIXED-RATE-SEG = 02)
           AND (EFFECTIVE-DD IN FIXED-RATE-SEG = 29)
              MOVE ZERO
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
           ELSE
              MOVE -1
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
           END-IF.
      ***** $T97872  END  *****

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-HOLD-RENEWAL-DATE.

           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > SUBT)

              MOVE SPACES TO DATA-DEFINITION-AREA

              IF  SUBS = +1
                 IF  WK-EXPEDITION-PERIOD = +5
                    MOVE '5 Year Initial'
                      TO CRATE-GUARANTEED-TERM
                 END-IF
                 IF  WK-EXPEDITION-PERIOD = +7
                    MOVE '7 Year Initial'
                      TO CRATE-GUARANTEED-TERM
                 END-IF
              END-IF

              MOVE EFFECTIVE-DATE        IN FIXED-RATE-SEG
                TO CRATE-START-DATE
              MOVE WK-HOLD-RENEWAL-DATE
                TO CRATE-END-DATE
              MOVE RA-EFFECTIVE-DATE (SUBS)
                TO CRATE-PAYMENT-DATE
              MOVE RA-PAYMENT-AMOUNT (SUBS)
                TO CRATE-PAYMENT-AMOUNT
              IF  RA-PAYMENT-TYPE (SUBS) = 'NA  '
                 MOVE 'Purchase Payment'
                   TO CRATE-PAYMENT-TYPE
              END-IF
              IF  RA-PAYMENT-TYPE (SUBS) = 'XC  '
                 MOVE 'Credit Enhancement'
                   TO CRATE-PAYMENT-TYPE
              END-IF
              MOVE RA-RATE-PCT (SUBS)
                TO CRATE-RATE-PERCENT
              MOVE RA-ENHANCE-DATE (SUBS)
                TO CRATE-INT-ENH-DATE
              MOVE RA-RATE-PCT-AFTER (SUBS)
                TO CRATE-RATE-PERCENT-AFTER

              WRITE ANNL-STMNT FROM STMTEX-LINE

           END-PERFORM.

       458500-EXIT.
           EXIT.
           EJECT
       458510-GET-PAYMENTS.

           MOVE SPACES TO RATE-ADVANTAGE-WORK-AREA.

           PERFORM 445060-GET-FIRST-TRXHIST THRU 445060-EXIT.

           MOVE ZERO TO SUBE
                        SUBT
                        WK-BAND-PREMIUM.
           MOVE SPACE TO SW-END-OF-TRXHIST-SW.
           PERFORM 458520-REST-OF-PAYMENTS  THRU 458520-EXIT
             UNTIL SW-END-OF-TRXHIST.

       458510-EXIT.
           EXIT.
           EJECT
       458520-REST-OF-PAYMENTS.

           IF  (TRX-CODE IN GEN-TRX-REC = 'MA  ')
           OR  (TRX-CODE IN GEN-TRX-REC = 'NA  ')
              IF  PAYMENT-AMOUNT IN NA-TRX-REC = ZERO
                 GO TO 458520-CONTINUE
              END-IF
              MOVE 'NA  ' TO WK-TRX-CODE
              PERFORM 458530-GET-RA-SLOT THRU 458530-EXIT
              IF  RA-EFFECTIVE-DATE (SUBE) = SPACES
                 MOVE EFFECTIVE-DATE     IN GEN-TRX-REC
                   TO RA-EFFECTIVE-DATE (SUBE)
                 MOVE PAYMENT-AMOUNT     IN NA-TRX-REC
                   TO RA-PAYMENT-AMOUNT (SUBE)
                 ADD PAYMENT-AMOUNT IN NA-TRX-REC
                  TO WK-BAND-PREMIUM
                 PERFORM 458525-FIND-PAYMENT-PCT THRU 458525-EXIT
                 MOVE 'NA  '
                   TO RA-PAYMENT-TYPE (SUBE)
                 MOVE '99999999'
                   TO RA-ENHANCE-DATE (SUBE)
                 MOVE ZERO
                   TO RA-RATE-PCT-AFTER (SUBE)
              ELSE
                 ADD PAYMENT-AMOUNT IN NA-TRX-REC
                  TO RA-PAYMENT-AMOUNT (SUBE)
                     WK-BAND-PREMIUM
                 PERFORM 458525-FIND-PAYMENT-PCT THRU 458525-EXIT
              END-IF
              GO TO 458520-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'XC  '
              IF  TOTAL-TRX-AMOUNT IN XC-TRX-REC = ZERO
                 GO TO 458520-CONTINUE
              END-IF
              MOVE 'XC  ' TO WK-TRX-CODE
              PERFORM 458530-GET-RA-SLOT THRU 458530-EXIT
              MOVE EFFECTIVE-DATE        IN GEN-TRX-REC
                TO RA-EFFECTIVE-DATE (SUBE)
              MOVE TOTAL-TRX-AMOUNT      IN XC-TRX-REC
                TO RA-PAYMENT-AMOUNT (SUBE)
              MOVE 'XC  '
                TO RA-PAYMENT-TYPE (SUBE)
              MOVE ZERO
                TO RA-RATE-PCT (SUBE)
              MOVE '99999999'
                TO RA-ENHANCE-DATE (SUBE)
              MOVE ZERO
                TO RA-RATE-PCT-AFTER (SUBE)
              GO TO 458520-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEU '
              PERFORM 458526-ADJUST-PAYMENTS THRU 458526-EXIT
           END-IF.

       458520-CONTINUE.

           MOVE GET-NEXT                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO SEGMENT-KEY              IN DB-PARM-AREA.
           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.

           PERFORM 4613000-GET-SEGMENT THRU 4613000-EXIT.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-TRXHIST TO TRUE
              GO TO 458520-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'LCI1'
              GO TO 458520-EXIT
           END-IF.

           IF  EFFECTIVE-DATE IN GEN-TRX-REC > WK-HOLD-90-DAYS-DATE
              SET SW-END-OF-TRXHIST TO TRUE
           END-IF.

       458520-EXIT.
           EXIT.
           EJECT
       458525-FIND-PAYMENT-PCT.

           MOVE ZERO
             TO RA-RATE-PCT (SUBE).

           PERFORM 458527-CHECK-FOR-FORCED THRU 458527-EXIT.
           IF  RA-RATE-PCT (SUBE) > ZERO
              GO TO 458525-EXIT
           END-IF.

           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > MAX-BANDS)
                OR (RA-RATE-PCT (SUBE) > ZERO)
                OR (BAND-AMOUNT IN FIXED-RATE-SEG (SUBS) = ZERO)

              COMPUTE WK-BAND-AMOUNT
                    = BAND-AMOUNT IN FIXED-RATE-SEG (SUBS)
                    + NINETY-NINE-CENTS
              END-COMPUTE
      ***** $110757 START *****
      *       IF  WK-BAND-PREMIUM NOT > WK-BAND-AMOUNT
      *          MOVE DECLARED-RATE      IN FIXED-RATE-SEG (SUBS)
      *            TO RA-RATE-PCT (SUBE)
      *       END-IF
              IF  MARINER-CONTRACT
                 IF  LOI-AMOUNT IN POLICY-SEG NOT > WK-BAND-AMOUNT
                    MOVE DECLARED-RATE      IN FIXED-RATE-SEG (SUBS)
                      TO RA-RATE-PCT (SUBE)
                 END-IF
              ELSE
                 IF  WK-BAND-PREMIUM NOT > WK-BAND-AMOUNT
                    MOVE DECLARED-RATE      IN FIXED-RATE-SEG (SUBS)
                      TO RA-RATE-PCT (SUBE)
                 END-IF
              END-IF
      ***** $110757  END  *****

           END-PERFORM.

       458525-EXIT.
           EXIT.
           EJECT
       458526-ADJUST-PAYMENTS.

           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > SUBT)

              IF  RA-PAYMENT-TYPE (SUBS) = 'NA  '
                 IF  DECLARED-RATE IN FIXED-RATE-SEG (SUBB) NOT =
                     RA-RATE-PCT (SUBS)
                    MOVE DECLARED-RATE   IN FIXED-RATE-SEG (SUBB)
                      TO RA-RATE-PCT-AFTER (SUBS)
                    MOVE EFFECTIVE-DATE  IN GEN-TRX-REC
                      TO RA-ENHANCE-DATE (SUBS)
                 END-IF
              END-IF

           END-PERFORM.

       458526-EXIT.
           EXIT.
           EJECT
       458527-CHECK-FOR-FORCED.

           IF  FORCED-INT-RATE OF ALLOC-FORM-OVRRIDE-TEXT
                               IN NA-TRX-REC (1) NUMERIC
              IF  FORCED-INT-RATE OF ALLOC-FORM-OVRRIDE-TEXT
                                  IN NA-TRX-REC (1) = ZERO
                 GO TO 458527-EXIT
              END-IF
           ELSE
              GO TO 458527-EXIT
           END-IF.

           COMPUTE WK-HOLD-FORCED-RATE
                 = FORCED-INT-RATE       OF ALLOC-FORM-OVRRIDE-TEXT
                                         IN NA-TRX-REC (1)
                 * 100.00
           END-COMPUTE.
           MOVE WK-HOLD-FORCED-RATE
             TO RA-RATE-PCT (SUBE).

       458527-EXIT.
           EXIT.
           EJECT
       458530-GET-RA-SLOT.

           IF  SUBT = ZERO
              MOVE +1 TO SUBE
                         SUBT
              GO TO 458530-EXIT
           END-IF.

           MOVE ZERO TO SUBE.
           PERFORM VARYING SUBS FROM +1 BY +1
             UNTIL (SUBS > SUBT)
                OR (SUBE > ZERO)

              IF  (RA-EFFECTIVE-DATE (SUBS) =
                   EFFECTIVE-DATE IN GEN-TRX-REC)
              AND (RA-PAYMENT-TYPE (SUBS) = WK-TRX-CODE)
                 MOVE SUBS TO SUBE
              END-IF

           END-PERFORM.

           IF  SUBE > ZERO
              GO TO 458530-EXIT
           END-IF.

           ADD +1 TO SUBT.
           MOVE SUBT TO SUBE.

       458530-EXIT.
           EXIT.
           EJECT
       459000-GET-REC-56.

           IF  TRX-BEGIN-DATE = POLICY-EFF-DATE IN POLICY-SEG
              GO TO 459000-EXIT
           END-IF.

           MOVE ZEROS TO KEY-DEFINITION.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '56'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE EFFECTIVE-DATE           IN FIXED-RATE-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           IF  EFFECTIVE-DATE  IN FIXED-RATE-SEG =
               POLICY-EFF-DATE IN POLICY-SEG
              MOVE 'C'
                TO NRATE-TITLE-SW
              IF  WK-EXPEDITION-PERIOD = +5
                 MOVE '5 Year'
                   TO NRATE-GUARANTEED-TERM
              END-IF
              IF  WK-EXPEDITION-PERIOD = +7
                 MOVE '7 Year'
                   TO NRATE-GUARANTEED-TERM
              END-IF
              MOVE WK-EXPEDITION-PERIOD
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
           ELSE
              MOVE 'R'
                TO NRATE-TITLE-SW
              MOVE '1 Year'
                TO NRATE-GUARANTEED-TERM
              MOVE +1
                TO CHANGE-DATE-YYY       IN DATE-ARITHMETIC-AREA
           END-IF.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           IF  (NRATE-TITLE-SW = 'C')
           AND (WK-HOLD-RA-ACTIVATION-DATE NOT = '00000000')
              PERFORM 459100-USE-RATE-ADVANTAGE THRU 459100-EXIT
              GO TO 459000-EXIT
           END-IF.

           MOVE EFFECTIVE-DATE           IN FIXED-RATE-SEG
             TO NRATE-BEGIN-DATE.
           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO NRATE-END-DATE.
      *    MOVE DECLARED-RATE            IN FIXED-RATE-SEG (SUBB)
      *      TO NRATE-GUARANTEED-RATE.
           IF  (EFFECTIVE-DATE IN FIXED-RATE-SEG >
                POLICY-EFF-DATE IN POLICY-SEG)
           OR  (WK-HOLD-FORCED-RATE = ZERO)
              MOVE DECLARED-RATE         IN FIXED-RATE-SEG (SUBB)
                TO NRATE-GUARANTEED-RATE
           ELSE
              MOVE WK-HOLD-FORCED-RATE
                TO NRATE-GUARANTEED-RATE
           END-IF.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       459000-EXIT.
           EXIT.
           EJECT
       459100-USE-RATE-ADVANTAGE.

           MOVE EFFECTIVE-DATE           IN FIXED-RATE-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE WK-EXPEDITION-PERIOD
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-HOLD-RENEWAL-DATE.

           MOVE WK-HOLD-RA-ACTIVATION-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE -1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-HOLD-RA-ACT-DATE-1.

           MOVE EFFECTIVE-DATE           IN FIXED-RATE-SEG
             TO NRATE-BEGIN-DATE.
           MOVE WK-HOLD-RA-ACT-DATE-1
             TO NRATE-END-DATE.
           MOVE DECLARED-RATE            IN FIXED-RATE-SEG (SUBB)
             TO NRATE-GUARANTEED-RATE.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

           MOVE WK-HOLD-RA-ACTIVATION-DATE
             TO NRATE-BEGIN-DATE.
           MOVE WK-HOLD-RENEWAL-DATE
             TO NRATE-END-DATE.

           MOVE WK-HOLD-NEW-RATE
             TO NRATE-GUARANTEED-RATE.
      *    PERFORM VARYING SUBS FROM +1 BY +1
      *      UNTIL (SUBS > SUBT)
      *
      *       IF  RA-RATE-PCT-AFTER (SUBS) > ZERO
      *          MOVE RA-RATE-PCT-AFTER (SUBS)
      *            TO NRATE-GUARANTEED-RATE
      *       END-IF
      *
      *    END-PERFORM.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       459100-EXIT.
           EXIT.
           EJECT
       459500-GET-REC-57.

           IF  (EFFECTIVE-DATE IN FIXED-RATE-SEG NOT =
                POLICY-EFF-DATE IN POLICY-SEG)
           OR  ((RATE-CHANGE-XFER-DATE-R IN POLICY-SEG = 99999999)
           AND  (WK-HOLD-RA-ACTIVATION-DATE < TRX-END-DATE))
              GO TO 459500-EXIT
           END-IF.

           MOVE ZEROS TO KEY-DEFINITION.

           MOVE HOLD-BROKER-NO     TO BROKER-NO.
           MOVE HOLD-AGENT-ID      TO REP-NO.
           MOVE HOLD-SSN           TO KEY-SSN.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '57'               TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC TO KEY-PROD-MNEMONIC.

           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE TRX-END-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
           MOVE +1
             TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE TO WK-HOLD-NEXT-ANNIV-DATE.

           PERFORM 459510-GET-OTHER-VALUES THRU 459510-EXIT.

      *    MOVE DECLARED-RATE            IN FIXED-RATE-SEG (SUBB)
      *      TO RADV-GUARANTEED-RATE.
           IF  (EFFECTIVE-DATE IN FIXED-RATE-SEG >
                POLICY-EFF-DATE IN POLICY-SEG)
           OR  (WK-HOLD-FORCED-RATE = ZERO)
              MOVE DECLARED-RATE         IN FIXED-RATE-SEG (SUBB)
                TO RADV-GUARANTEED-RATE
           ELSE
              MOVE WK-HOLD-FORCED-RATE
                TO RADV-GUARANTEED-RATE
           END-IF.
           MOVE WK-HOLD-NEXT-ANNIV-DATE
             TO RADV-DECLARED-DATE.
           MOVE WK-CURR-DECL-RATE
             TO RADV-DECLARED-RATE.
           MOVE WK-HOLD-NEXT-ANNIV-DATE
             TO RADV-MAXIMUM-DATE.
           MOVE FEATURE-RATE             IN FIXED-RATE-SEG (SUBB SUBF)
             TO RADV-MAXIMUM-RATE.
           MOVE WK-HOLD-GUAR-END-DATE
             TO RADV-NEW-GUARANTEED-DATE.
           IF WK-NEW-GUAR-RATE > DECLARED-RATE IN FIXED-RATE-SEG (SUBB)
              MOVE WK-NEW-GUAR-RATE
                TO RADV-NEW-GUARANTEED-RATE
           ELSE
              MOVE ZERO
                TO RADV-NEW-GUARANTEED-RATE
           END-IF.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       459500-EXIT.
           EXIT.
           EJECT
       459510-GET-OTHER-VALUES.

           COMPUTE SUBF
                 = TRX-END-DATE-CCYY
                 - POLICY-EFF-YY IN POLICY-SEG
           END-COMPUTE.

           MOVE POLICY-EFF-DATE          IN POLICY-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.

           MOVE WK-EXPEDITION-PERIOD
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
      ***** $T97872 START *****
      *    MOVE -1
      *      TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           IF  (EFFECTIVE-MM IN FIXED-RATE-SEG = 02)
           AND (EFFECTIVE-DD IN FIXED-RATE-SEG = 29)
              MOVE ZERO
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
           ELSE
              MOVE -1
                TO CHANGE-DATE-DDD       IN DATE-ARITHMETIC-AREA
           END-IF.
      ***** $T97872  END  *****

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-HOLD-GUAR-END-DATE.

           PERFORM 459520-GET-CURR-RATE THRU 459520-EXIT.

           IF  FEATURE-RATE IN FIXED-RATE-SEG (SUBB SUBF) <
               WK-CURR-DECL-RATE
              MOVE FEATURE-RATE          IN FIXED-RATE-SEG (SUBB SUBF)
                TO WK-NEW-GUAR-RATE
           ELSE
              MOVE WK-CURR-DECL-RATE
                TO WK-NEW-GUAR-RATE
           END-IF.

       459510-EXIT.
           EXIT.
           EJECT
       459520-GET-CURR-RATE.

           MOVE ZERO TO WK-CURR-DECL-RATE.

           INITIALIZE FIXED-RATE-PARMS.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN FIXED-RATE-PARMS.
           MOVE PLAN-CODE                IN POLICY-SEG
             TO PLAN-CODE                IN FIXED-RATE-PARMS.
           MOVE PROCESSING-SYSTEM-ID     IN POLICY-SEG
             TO PRODUCT-CODE             IN FIXED-RATE-PARMS.
           MOVE SPACES
             TO MEMO-CODE                IN FIXED-RATE-PARMS.
           MOVE STATUTORY-COMPANY-CODE   IN POLICY-SEG
             TO STATUTORY-COMPANY-CODE   IN FIXED-RATE-PARMS.
           MOVE LINE-OF-BUSINESS-CODE    IN POLICY-SEG
             TO LINE-OF-BUSINESS         IN FIXED-RATE-PARMS.
           MOVE POLICY-ISSUE-STATE       IN POLICY-SEG
             TO ISSUE-STATE              IN FIXED-RATE-PARMS.
           MOVE SPACE
             TO COMPARE-INDICATOR        IN FIXED-RATE-PARMS.
           MOVE WK-HOLD-NEXT-ANNIV-DATE
             TO EFFECTIVE-DATE           IN FIXED-RATE-PARMS.
           MOVE '99999999'
             TO APP-SIGNED-DATE          IN FIXED-RATE-PARMS
                SCAN-DATE                IN FIXED-RATE-PARMS
                OVERRIDE-DATE            IN FIXED-RATE-PARMS.

           CALL 'MUAFFS1' USING FIXED-RATE-PARMS.
           IF  RETURN-STATUS IN FIXED-RATE-PARMS NOT = SPACES
              MOVE INT-RATE-READ-ERROR
                TO VCS-ABEND-CODE
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
              GO TO 459520-EXIT
           END-IF.

           MOVE DECLARED-RATE            IN FIXED-RATE-PARMS (SUBB)
             TO WK-CURR-DECL-RATE.

       459520-EXIT.
           EXIT.
           EJECT

       460000-GET-REC-60.
      *        DISPLAY '460000-GET-REC-60'.


              MOVE  '60'
                TO  RECORD-TYPE

              MOVE  HOLD-CONTRACT-NO (6:10)
                TO  POLICY-NUMBER        IN           KEY-DEFINITION

              MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE          IN KEY-DEFINITION.

              MOVE HOLD-PROD-MNEMONIC
                TO KEY-PROD-MNEMONIC

              MOVE HOLD-SSN
                TO KEY-SSN

              MOVE HOLD-AGENT-ID
                TO REP-NO             IN           KEY-DEFINITION

              MOVE HOLD-BROKER-NO
                TO BROKER-NO          IN           KEY-DEFINITION

              PERFORM 461000-GET-TRX-DETAIL THRU 461000-EXIT.


      *   WRITE OUT RECORD TYPE 60
      *    DISPLAY 'WRITE OUT RECORD TYPE 60'
      *

           MOVE ZEROS
             TO KEY-DEFINITION.

           MOVE SPACES
             TO DATA-DEFINITION-AREA.



       460000-EXIT.
           EXIT.

090163 461000-GET-TRX-DETAIL.
090163*     DISPLAY '461000-GET-TRX-DETAIL'.
090164
090165     MOVE 'N' TO TRX-PROCESSING-COMPLETE-SW.
090170
090200     PERFORM 4611000-GET-FIRST-TRX THRU 4611000-EXIT.
090210
090400     PERFORM 4612000-PROCESS-LOOP THRU 4612000-EXIT
090500       UNTIL TRX-PROCESSING-COMPLETE.
090501

090620
090700 461000-EXIT.
090800     EXIT.
090900     EJECT
090910
091000 4611000-GET-FIRST-TRX.
091000*        DISPLAY '4611000-GET-FIRST-TRX'.
091100
091200     MOVE SPACES                     TO DB-PARM-AREA.
091300     MOVE SPACES                     TO DB-COMM-AREA.
091400     MOVE GET-FIRST                  IN DB-OPERATIONS
091500       TO OPERATION                  IN DB-PARM-AREA.
091600     MOVE TRANSACTION-HISTORY        IN DB-SEGMENT-MNEMONICS
091700       TO ACCESS-SEGMENT             IN DB-PARM-AREA.
091800     MOVE  HOLD-COMPANY-CODE
091900       TO COMPANY-CODE               IN DB-PARM-AREA.
092000     MOVE  HOLD-CONTRACT-NO
092100       TO KEY-QUALIFIER              IN DB-PARM-AREA.
           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.
092200
           MOVE ZEROS TO TOTAL-CLAIMS.
           MOVE ZEROS TO HOLD-CLAIM-AMT.

092300     PERFORM 4613000-GET-SEGMENT THRU 4613000-EXIT.
092400
092500     IF  NOT SUCCESSFUL-CALL         IN DB-COMM-AREA
092600         MOVE TRX-HIST-READ-ERROR
092700           TO  VCS-ABEND-CODE
092800         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
092810
093000 4611000-EXIT.
093100
093200     EXIT.
093300
093400 4612000-PROCESS-LOOP.
093400*        DISPLAY '4612000-process-loop   '.
093500
           MOVE ZEROS TO HOLD-CLAIM-AMT.

           IF (EFFECTIVE-DATE IN GEN-TRX-REC < TRX-BEGIN-DATE) OR
              (EFFECTIVE-DATE IN GEN-TRX-REC > TRX-END-DATE)
              GO TO 4612000-CONTINUE
           END-IF.

           MOVE EFFECTIVE-DATE       IN GEN-TRX-REC
             TO HIST-DT.

           MOVE ZEROS
             TO HIST-AMT.

           IF EXPLORER-CONTRACT
              PERFORM 4620000-EXPLORER-TRXS THRU 4620000-EXIT
              GO TO 4612000-CONTINUE
           END-IF.

           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              PERFORM 463000-FIA-TRXS       THRU 463000-EXIT
              GO TO 4612000-CONTINUE
           END-IF.

           IF  TRX-CODE           IN NA-TRX-REC = 'NA'
           OR  TRX-CODE           IN NA-TRX-REC = 'MA'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN NA-TRX-REC
      *            EQUAL  SPACES
                   IF  EFFECTIVE-DATE IN NA-TRX-REC
                        = HOLD-ISSUE-DATE
                       MOVE  'Purchase Payment'
                         TO  HIST-DESC

                       IF   PAYMENT-AMOUNT  IN NA-TRX-REC
                           > 0
                           COMPUTE HIST-AMT =
                               HIST-AMT +
                               PAYMENT-AMOUNT  IN NA-TRX-REC
                           WRITE ANNL-STMNT FROM STMTEX-LINE
      *                ELSE
      *                    CONTINUE
                       END-IF
      *            ELSE
      *                CONTINUE
                   END-IF
      *            GO TO 4612000-CONTINUE                      $W10612D
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN NA-TRX-REC = 'NA'
           OR  TRX-CODE           IN NA-TRX-REC = 'MA'
                   IF  EFFECTIVE-DATE IN NA-TRX-REC
                    NOT = HOLD-ISSUE-DATE
                       MOVE  'Purchase Payment'
                         TO  HIST-DESC

                       IF   PAYMENT-AMOUNT  IN NA-TRX-REC
                           > 0
                           COMPUTE HIST-AMT =
                               HIST-AMT +
                               PAYMENT-AMOUNT  IN NA-TRX-REC
                           WRITE ANNL-STMNT FROM STMTEX-LINE
                       END-IF
                   END-IF
                   GO TO 4612000-CONTINUE
           END-IF.

           IF  TRX-CODE           IN TA-TRX-REC = 'TA'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TA-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TA-TRX-REC
      *                >= TRX-BEGIN-DATE
      *            AND  EFFECTIVE-DATE IN TA-TRX-REC
      *                <= TRX-END-DATE
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               SURRENDER-AMT   IN TA-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN TZ-TRX-REC = 'TZ'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TZ-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TZ-TRX-REC
      *                >= TRX-BEGIN-DATE
      *            AND  EFFECTIVE-DATE IN TZ-TRX-REC
      *                <= TRX-END-DATE
                       MOVE  'Annuitization'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               ANNUITIZATION-AMOUNT IN TZ-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TB'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TB-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TB-TRX-REC
      *                 >= TRX-BEGIN-DATE
      *            AND EFFECTIVE-DATE IN TB-TRX-REC
      *                 <= TRX-END-DATE
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               SURRENDER-AMT    IN TB-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TKM'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TB-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TB-TRX-REC
      *                 >= TRX-BEGIN-DATE
      *            AND EFFECTIVE-DATE IN TB-TRX-REC
      *                 <= TRX-END-DATE
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               SURRENDER-AMT  IN TB-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TK'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TB-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TB-TRX-REC
      *                 >= TRX-BEGIN-DATE
      *            AND EFFECTIVE-DATE IN TB-TRX-REC
      *                 <= TRX-END-DATE
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               SURRENDER-AMT     IN TB-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE           IN TB-TRX-REC = 'TKS'
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN TB-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN TB-TRX-REC
      *                 >= TRX-BEGIN-DATE
      *            AND EFFECTIVE-DATE IN TB-TRX-REC
      *                 <= TRX-END-DATE
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
      *                MOVE SURRENDER-AMT           IN TB-TRX-REC
      *                  TO HIST-AMT
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               SURRENDER-AMT     IN TB-TRX-REC
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  TRX-CODE          IN PAD-TRX-REC = 'PAD '
                       MOVE  'Withdrawal'
                         TO  HIST-DESC
                       COMPUTE HIST-AMT =
                               HIST-AMT -
                               TOTAL-PROCEEDS  IN PAD-TRX-REC
                       END-COMPUTE
                       WRITE ANNL-STMNT    FROM    STMTEX-LINE
                       GO TO 4612000-CONTINUE
           END-IF.

           IF  TRX-CODE     IN OE-TRX-REC = 'OE'
           OR  TRX-CODE     IN OE-TRX-REC = 'OEA '
      ***** $W10612D START *****
      *        IF  REVERSAL-CODE  IN OE-TRX-REC
      *            EQUAL  SPACES
      *            IF  EFFECTIVE-DATE IN OE-TRX-REC
      *                 >= TRX-BEGIN-DATE
      *            AND EFFECTIVE-DATE IN OE-TRX-REC
      *                 <= TRX-END-DATE
                       PERFORM 4614000-GET-OE-INFO THRU 4614000-EXIT
                       GO TO 4612000-CONTINUE
      *
      *            ELSE
      *                CONTINUE
      *            END-IF
      *        END-IF
      ***** $W10612D  END  *****
           END-IF.

           IF  EXPEDITION-CONTRACT
           OR  MARINER-CONTRACT
           OR  PIA-CONTRACT
              IF  TRX-CODE IN GEN-TRX-REC = 'XC  '
                 IF  TOTAL-TRX-AMOUNT IN XC-TRX-REC = ZERO
                    GO TO 4612000-CONTINUE
                 END-IF
                 MOVE 'Credit Enhancement'
                   TO HIST-DESC
                 MOVE TOTAL-TRX-AMOUNT        IN XC-TRX-REC
                   TO HIST-AMT
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 GO TO 4612000-CONTINUE
              END-IF
           END-IF.

           IF  PIA-CONTRACT
              IF  TRX-CODE IN GEN-TRX-REC = 'WX  '
                 MOVE 'GMWB Fee'
                   TO HIST-DESC
                 MOVE RIDER-FEE               IN WX-TRX-REC
                   TO HIST-AMT
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 GO TO 4612000-CONTINUE
              END-IF
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'WXD '
              MOVE 'GDB Fee'
                TO HIST-DESC
              MOVE RIDER-FEE          IN WXD-TRX-REC
                TO HIST-AMT
              WRITE ANNL-STMNT FROM STMTEX-LINE
              GO TO 4612000-CONTINUE
           END-IF.
       4612000-CONTINUE.

095300*    MOVE GET-PRIOR                  IN DB-OPERATIONS
095300     MOVE GET-NEXT                   IN DB-OPERATIONS
095400       TO OPERATION                  IN DB-PARM-AREA.
095500
095600     MOVE SEGMENT-KEY                IN DB-COMM-AREA
095700       TO SEGMENT-KEY                IN DB-PARM-AREA.

           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.
095800
095900     PERFORM 4613000-GET-SEGMENT THRU 4613000-EXIT.
096000
096100     IF  SUCCESSFUL-CALL             IN DB-COMM-AREA
096200         GO TO 4612000-EXIT.
096300
096400     MOVE 'Y' TO TRX-PROCESSING-COMPLETE-SW.
096500
096600     IF  END-KEY                     IN DB-COMM-AREA
096700     OR  END-OF-FILE                 IN DB-COMM-AREA
096800     OR  RECORD-NOT-FOUND            IN DB-COMM-AREA
096900         NEXT SENTENCE
097000     ELSE
097100         MOVE TRX-HIST-READ-ERROR
097200           TO  VCS-ABEND-CODE
097300         PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
           END-IF.
097400
097500 4612000-EXIT.
097600     EXIT.
097700     EJECT

097800 4613000-GET-SEGMENT.
097800*     DISPLAY '4613000-GET-SEGMENT'.
097900
098000     CALL 'IVEXAI1' USING DB-PARM-AREA
098100                          GEN-TRX-REC
098200                          DB-COMM-AREA.
098300
098400 4613000-EXIT.
098500     EXIT.
098600     EJECT
098601
097800 4614000-GET-OE-INFO.
097800*     DISPLAY '4614000-'.

098000
           PERFORM VARYING WS-SUB FROM 1 BY 1
               UNTIL WS-POL-FUND-SUB > 99
               OR FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                 = 999

               MOVE ZEROS
                 TO HIST-AMT

               IF FROM-FUND   IN OE-TRX-REC
                                         (WS-SUB)
                   COMPUTE HIST-AMT =
                           HIST-AMT -
                           PARTICIPATION-AMOUNT IN OE-TRX-REC
                                         (WS-SUB)
                   EVALUATE TRUE
                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 011
                           MOVE 'Term Transfer from 1 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 012
                           MOVE 'Term Transfer from 2 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 013
                           MOVE 'Term Transfer from 3 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 014
                           MOVE 'Term Transfer from 4 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 015
                           MOVE 'Term Transfer from 5 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 016
                           MOVE 'Term Transfer from 6 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 017
                           MOVE 'Term Transfer from 7 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 018
                           MOVE 'Term Transfer from 8 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 019
                           MOVE 'Term Transfer from 9 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                         = 020
                           MOVE 'Term Transfer from 10 YEAR'
                             TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 041
                          MOVE 'Term Transfer from 1 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 042
                          MOVE 'Term Transfer from 2 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 043
                          MOVE 'Term Transfer from 3 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 044
                          MOVE 'Term Transfer from 4 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 045
                          MOVE 'Term Transfer from 5 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 046
                          MOVE 'Term Transfer from 6 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 047
                          MOVE 'Term Transfer from 7 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 048
                          MOVE 'Term Transfer from 8 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 049
                          MOVE 'Term Transfer from 9 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 050
                          MOVE 'Term Transfer from 10 YEAR'
                            TO HIST-DESC

                   END-EVALUATE

               END-IF
               IF TO-FUND   IN OE-TRX-REC
                                         (WS-SUB)
                   COMPUTE HIST-AMT =
                           HIST-AMT +
                           PARTICIPATION-AMOUNT IN OE-TRX-REC
                                        (WS-SUB)
                   EVALUATE TRUE
                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 011
                            MOVE 'Term Transfer to 1 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 012
                            MOVE 'Term Transfer to 2 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 013
                            MOVE 'Term Transfer to 3 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 014
                            MOVE 'Term Transfer to 4 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 015
                            MOVE 'Term Transfer to 5 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 016
                            MOVE 'Term Transfer to 6 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 017
                            MOVE 'Term Transfer to 7 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 018
                            MOVE 'Term Transfer to 8 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 019
                            MOVE 'Term Transfer to 9 YEAR'
                              TO HIST-DESC

                        WHEN  FUND-NUMBER IN OE-TRX-REC  (WS-SUB)
                                          = 020
                            MOVE 'Term Transfer to 10 YEAR'
                              TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 041
                          MOVE 'Term Transfer to 1 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 042
                          MOVE 'Term Transfer to 2 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 043
                          MOVE 'Term Transfer to 3 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 044
                          MOVE 'Term Transfer to 4 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 045
                          MOVE 'Term Transfer to 5 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 046
                          MOVE 'Term Transfer to 6 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 047
                          MOVE 'Term Transfer to 7 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 048
                          MOVE 'Term Transfer to 8 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 049
                          MOVE 'Term Transfer to 9 YEAR'
                            TO HIST-DESC

                       WHEN  FUND-NUMBER IN OE-TRX-REC (WS-SUB) = 050
                          MOVE 'Term Transfer to 10 YEAR'
                            TO HIST-DESC

                   END-EVALUATE
               END-IF


               IF HIST-AMT = ZERO
                   CONTINUE
               ELSE
                   WRITE ANNL-STMNT    FROM    STMTEX-LINE
               END-IF

           END-PERFORM.
098100
098200
098300
098400 4614000-EXIT.
098500     EXIT.
098600     EJECT
       4620000-EXPLORER-TRXS.

            IF FULL-SURRENDER-TRX IN GEN-TRX-REC
               MOVE 'Withdrawal Amount'
                 TO HIST-DESC
               MULTIPLY SURRENDER-AMT IN TA-TRX-REC
                     BY -1
                 GIVING HIST-AMT
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               MOVE 'Withdrawal Charge'
                 TO HIST-DESC
               MULTIPLY SURRENDER-PENALTY IN TA-TRX-REC
                     BY -1
                 GIVING HIST-AMT
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               MOVE 'Taxes Withheld   '
                 TO HIST-DESC
               COMPUTE HIST-AMT
                     = (AMT-WITHHELD-FED       IN TA-TRX-REC
                     +  AMT-WITHHELD-STATE     IN TA-TRX-REC
                     +  AMT-WITHHELD-MUNICIPAL IN TA-TRX-REC)
                     * -1
               END-COMPUTE
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               GO TO 4620000-EXIT
            END-IF.

            IF  SCHED-WD-TYPE-TRX     IN GEN-TRX-REC
            OR  PARTIAL-SURRENDER-TRX IN GEN-TRX-REC
               MOVE 'Withdrawal Amount'
                 TO HIST-DESC
               MULTIPLY SURRENDER-AMT IN TB-TRX-REC
                     BY -1
                 GIVING HIST-AMT
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               MOVE 'Withdrawal Charge'
                 TO HIST-DESC
               MULTIPLY SURRENDER-PENALTY IN TB-TRX-REC
                     BY -1
                 GIVING HIST-AMT
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               MOVE 'Taxes Withheld   '
                 TO HIST-DESC
               COMPUTE HIST-AMT
                     = (AMT-WITHHELD-FED       IN TB-TRX-REC
                     +  AMT-WITHHELD-STATE     IN TB-TRX-REC
                     +  AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC)
                     * -1
               END-COMPUTE
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               GO TO 4620000-EXIT
            END-IF.

            IF  DEATH-DIST-TRX        IN GEN-TRX-REC
               MOVE 'Withdrawal Amount'
                 TO HIST-DESC
               COMPUTE HIST-AMT
                     = TOTAL-PROCEEDS IN PAD-TRX-REC
                     * -1
               END-COMPUTE
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               MOVE 'Taxes Withheld   '
                 TO HIST-DESC
               COMPUTE HIST-AMT
                     = (AMT-WITHHELD-FED       IN PAD-TRX-REC
                     +  AMT-WITHHELD-STATE     IN PAD-TRX-REC
                     +  AMT-WITHHELD-LOCAL     IN PAD-TRX-REC)
                     * -1
               END-COMPUTE
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               GO TO 4620000-EXIT
            END-IF.

            IF  FULL-ANNUITIZATION-TRX    IN GEN-TRX-REC
               MOVE 'Annuitization'
                 TO HIST-DESC
               MULTIPLY ANNUITIZATION-AMOUNT IN TZ-TRX-REC
                     BY -1
                 GIVING HIST-AMT
               IF HIST-AMT NOT = ZERO
                  WRITE ANNL-STMNT FROM STMTEX-LINE
               END-IF
               GO TO 4620000-EXIT
            END-IF.

       4620000-EXIT.
           EXIT.
           EJECT
       463000-FIA-TRXS.

           IF  (TRX-CODE IN GEN-TRX-REC = 'MA  ')
           OR  (TRX-CODE IN GEN-TRX-REC = 'NA  ')
              IF  PAYMENT-AMOUNT IN NA-TRX-REC = ZERO
                 GO TO 463000-EXIT
              END-IF
              IF  EFFECTIVE-DATE IN NA-TRX-REC = HOLD-ISSUE-DATE
                 MOVE 'Initial Premium'
                   TO HIST-DESC
              ELSE
                 MOVE 'Purchase Payment'
                   TO HIST-DESC
              END-IF
              PERFORM 463100-PAYMENT-FUNDS THRU 463100-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'XC  '
              IF  TOTAL-TRX-AMOUNT IN XC-TRX-REC = ZERO
                 GO TO 463000-EXIT
              END-IF
              MOVE 'Credit Enhancement'
                TO HIST-DESC
              PERFORM 463200-XTRA-CRD-FUNDS THRU 463200-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEZ '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
              PERFORM 463300-TRANSFER-FUNDS THRU 463300-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEM '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
              PERFORM 463350-TRANSFER-FUNDS THRU 463350-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'IAT '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
              IF  INTEREST-CREDITED IN IAT-TRX-REC NOT NUMERIC
              OR  INTEREST-CREDITED IN IAT-TRX-REC = ZERO
                 GO TO 463000-EXIT
              END-IF
              MOVE 'Index-Linked Interest Credited'
                TO HIST-DESC
              PERFORM 463400-ILI-CRD-FUNDS THRU 463400-EXIT
           END-IF.

      ***** $114384 START *****
      *    IF  (TRX-CODE IN GEN-TRX-REC = 'TB  ')
      *    OR  (TRX-CODE IN GEN-TRX-REC = 'TK  ')
      *    OR  (TRX-CODE IN GEN-TRX-REC = 'TKM ')
           IF  ((TRX-CODE IN GEN-TRX-REC = 'TB  ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TK  ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TKS ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TKM '))
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
      ***** $114384  END  *****
              PERFORM 463500-PARTIAL-FUNDS THRU 463500-EXIT
           END-IF.

           IF TRX-CODE IN GEN-TRX-REC = 'PAD ' AND
              NON-TERMINATING-PAD IN PAD-TRX-REC
              PERFORM 463550-PARTIAL-FUNDS-PAD   THRU 463550-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'TA  '
              PERFORM 463600-FULL-SURR-FUNDS THRU 463600-EXIT
           END-IF.

           IF TRX-CODE IN GEN-TRX-REC = 'PAD ' AND
              TERMINATING-PAD IN PAD-TRX-REC
              PERFORM 463650-FULL-SURR-FUNDS-PAD THRU 463650-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'TZ  '
              PERFORM 463700-PAYMENT-FUNDS THRU 463700-EXIT
           END-IF.

      *    IF  TRX-CODE IN GEN-TRX-REC = 'WX  ' OR               $T59669
      *        TRX-CODE IN GEN-TRX-REC = 'WXI '                 $T201018
           IF (TRX-CODE IN GEN-TRX-REC = 'WX  ' OR
               TRX-CODE IN GEN-TRX-REC = 'WXI ')
            AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
               IF  RIDER-FEE   IN WX-TRX-REC   =  ZERO
                   GO TO 463000-EXIT
               END-IF
               MOVE 'GMWB Fee     '  TO HIST-DESC
               MOVE EFFECTIVE-DATE   IN GEN-TRX-REC TO HIST-DT
               PERFORM 463800-RIDER-FEE-FUNDS THRU 463800-EXIT
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'WXD '
            AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
               IF  RIDER-FEE   IN WX-TRX-REC   =  ZERO
                   GO TO 463000-EXIT
               END-IF
               MOVE 'GDB Fee      '  TO HIST-DESC
               MOVE EFFECTIVE-DATE   IN GEN-TRX-REC TO HIST-DT
               PERFORM 463900-RIDER-FEE-FUNDS THRU 463900-EXIT
           END-IF.

       463000-EXIT.
           EXIT.
           EJECT
       463100-PAYMENT-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN NA-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN NA-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE             OF FUND-INFO-TEXT
                                         IN NA-TRX-REC (WS-SUB)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-NET-PREMIUM IN NA-TRX-REC (WS-SUB)
              END-COMPUTE
              IF  HIST-AMT > ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463100-EXIT.
           EXIT.
           EJECT
       463200-XTRA-CRD-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN XC-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN XC-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE             OF FUND-INFO-TEXT
                                         IN XC-TRX-REC (WS-SUB)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-NET-AMOUNT  IN XC-TRX-REC (WS-SUB)
              END-COMPUTE
              IF  HIST-AMT > ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463200-EXIT.
           EXIT.
           EJECT
       463300-TRANSFER-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN OE-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              IF  FROM-FUND OF FUND-INFO-TEXT IN OE-TRX-REC (WS-SUB)
                 MOVE 'Transfer From'
                   TO HIST-DESC
              ELSE
                 MOVE 'Transfer To'
                   TO HIST-DESC
              END-IF
              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE-INDICATOR   OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
              END-COMPUTE
              IF HIST-AMT > ZERO
                 IF  FROM-FUND OF FUND-INFO-TEXT
                               IN OE-TRX-REC (WS-SUB)
                     COMPUTE HIST-AMT = HIST-AMT * -1
                 END-IF
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463300-EXIT.
           EXIT.
           EJECT
       463350-TRANSFER-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN OE-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              IF  FROM-FUND OF FUND-INFO-TEXT IN OE-TRX-REC (WS-SUB)
                 MOVE 'Transfer From'
                   TO HIST-DESC
              ELSE
                 MOVE 'Transfer To'
                   TO HIST-DESC
              END-IF
              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              MOVE FUND-TYPE-INDICATOR   OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                TO WK-FUND-TYPE-IND-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
              END-COMPUTE
              IF HIST-AMT > ZERO
                 IF  FROM-FUND OF FUND-INFO-TEXT
                               IN OE-TRX-REC (WS-SUB)
                     COMPUTE HIST-AMT = HIST-AMT * -1
                 END-IF
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463350-EXIT.
           EXIT.
           EJECT
       463400-ILI-CRD-FUNDS.

           MOVE FUND-NUMBER              IN IAT-TRX-REC
             TO WK-FUND-NUMBER-WORK.
           MOVE FUND-TYPE                IN IAT-TRX-REC
             TO WK-FUND-TYPE-IND-WORK.
           PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
           MOVE WK-FUND-NAME-SHORT
             TO HIST-INDEX-OPTION.
           IF  INTEREST-CREDITED IN IAT-TRX-REC NUMERIC
              COMPUTE HIST-AMT
                    = INTEREST-CREDITED IN IAT-TRX-REC
              END-COMPUTE
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

       463400-EXIT.
           EXIT.
           EJECT
       463500-PARTIAL-FUNDS.

           MOVE 'Withdrawal Amount'
             TO HIST-DESC.
      *    MULTIPLY SURRENDER-AMT IN TB-TRX-REC
      *          BY -1
      *      GIVING HIST-AMT.
      *    IF  HIST-AMT NOT = ZERO
      *       WRITE ANNL-STMNT FROM STMTEX-LINE
      *    END-IF.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN TB-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN TB-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-AMT-SURRENDERED IN TB-TRX-REC (WS-SUB)
                    * -1
              END-COMPUTE
              IF  HIST-AMT < ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

           MOVE 'Withdrawal Charge'
             TO HIST-DESC.
           MOVE SPACES
             TO HIST-INDEX-OPTION.
           MULTIPLY SURRENDER-PENALTY IN TB-TRX-REC
                 BY -1
             GIVING HIST-AMT.
           IF  HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.
           MOVE 'Taxes Withheld   '
             TO HIST-DESC.
           MOVE SPACES
             TO HIST-INDEX-OPTION.
           COMPUTE HIST-AMT
                 = (AMT-WITHHELD-FED       IN TB-TRX-REC
                 +  AMT-WITHHELD-STATE     IN TB-TRX-REC
                 +  AMT-WITHHELD-MUNICIPAL IN TB-TRX-REC)
                 * -1
           END-COMPUTE.
           IF HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

      *    MOVE 'Withdrawal Charge'
      *      TO HIST-DESC.
      *    PERFORM VARYING WS-SUB FROM +1 BY +1
      *      UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
      *                         IN TB-TRX-REC (WS-SUB) = +999)
      *         OR (WS-SUB > +99)
      *
      *       MOVE FUND-NUMBER           OF FUND-INFO-TEXT
      *                                  IN TB-TRX-REC (WS-SUB)
      *         TO WK-FUND-NUMBER-WORK
      *       PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
      *       MOVE WK-FUND-NAME-SHORT
      *         TO HIST-INDEX-OPTION
      *       COMPUTE HIST-AMT
      *             = FUND-SURRENDER-PENALTY IN TB-TRX-REC (WS-SUB)
      *             * -1
      *       END-COMPUTE
      *       IF  HIST-AMT > ZERO
      *          WRITE ANNL-STMNT FROM STMTEX-LINE
      *          MOVE ZERO TO HIST-DT
      *          MOVE SPACES TO HIST-DESC
      *       END-IF
      *    END-PERFORM.
      *
      *    MOVE 'Taxes Withheld   '
      *      TO HIST-DESC.
      *    PERFORM VARYING WS-SUB FROM +1 BY +1
      *      UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
      *                         IN TB-TRX-REC (WS-SUB) = +999)
      *         OR (WS-SUB > +99)
      *
      *       MOVE FUND-NUMBER           OF FUND-INFO-TEXT
      *                                  IN TB-TRX-REC (WS-SUB)
      *         TO WK-FUND-NUMBER-WORK
      *       PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
      *       MOVE WK-FUND-NAME-SHORT
      *         TO HIST-INDEX-OPTION
      *       COMPUTE HIST-AMT
      *             = (FUND-FED-TAX-PENALTY IN TB-TRX-REC (WS-SUB)
      *             +  FUND-STATE-TAX       IN TB-TRX-REC (WS-SUB))
      *             * -1
      *       END-COMPUTE
      *       IF  HIST-AMT > ZERO
      *          WRITE ANNL-STMNT FROM STMTEX-LINE
      *          MOVE ZERO TO HIST-DT
      *          MOVE SPACES TO HIST-DESC
      *       END-IF
      *
      *    END-PERFORM.

       463500-EXIT.
           EXIT.
           EJECT
       463550-PARTIAL-FUNDS-PAD.

           MOVE 'Withdrawal Amount'
             TO HIST-DESC.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN PAD-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN PAD-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-AMT-SURRENDERED IN PAD-TRX-REC (WS-SUB)
                    * -1
              END-COMPUTE
              IF  HIST-AMT < ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

           MOVE 'Taxes Withheld   '
             TO HIST-DESC.
           MOVE SPACES
             TO HIST-INDEX-OPTION.
           COMPUTE HIST-AMT
                 = (AMT-WITHHELD-FED       IN PAD-TRX-REC
                 +  AMT-WITHHELD-STATE     IN PAD-TRX-REC
                 +  AMT-WITHHELD-LOCAL     IN PAD-TRX-REC)
                 * -1
           END-COMPUTE.
           IF HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

       463550-EXIT.
           EXIT.

       463600-FULL-SURR-FUNDS.

           MOVE SPACE TO HIST-INDEX-OPTION

           MOVE 'Withdrawal Amount'
             TO HIST-DESC.
           MULTIPLY SURRENDER-AMT IN TA-TRX-REC
                 BY -1
             GIVING HIST-AMT.
           IF  HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.
           MOVE 'Withdrawal Charge'
             TO HIST-DESC.
           MULTIPLY SURRENDER-PENALTY IN TA-TRX-REC
                 BY -1
             GIVING HIST-AMT.
           IF  HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.
           IF  FIA-CONTRACT
           OR  FIA-PA-CONTRACT
           OR  FIA-INDEX-EDGE-CONTRACT
              IF  IAR-FEE IN TA-TRX-REC NUMERIC
              AND IAR-FEE IN TA-TRX-REC > ZERO
                 MOVE 'GMWB Fee         '
                   TO HIST-DESC
                 COMPUTE HIST-AMT
                       = IAR-FEE         IN TA-TRX-REC
                       * -1
                 END-COMPUTE
                 WRITE ANNL-STMNT FROM STMTEX-LINE
              END-IF
           END-IF.
           MOVE 'Taxes Withheld   '
             TO HIST-DESC
           COMPUTE HIST-AMT
                 = (AMT-WITHHELD-FED       IN TA-TRX-REC
                 +  AMT-WITHHELD-STATE     IN TA-TRX-REC
                 +  AMT-WITHHELD-MUNICIPAL IN TA-TRX-REC)
                 * -1
           END-COMPUTE.
           IF HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

       463600-EXIT.
           EXIT.
           EJECT
       463650-FULL-SURR-FUNDS-PAD.

           MOVE SPACE TO HIST-INDEX-OPTION

           MOVE 'Withdrawal Amount'
             TO HIST-DESC.
           COMPUTE HIST-AMT
                 = TOTAL-PROCEEDS IN PAD-TRX-REC
                 * -1
           END-COMPUTE.
           IF  HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

           MOVE 'Taxes Withheld   '
             TO HIST-DESC
           COMPUTE HIST-AMT
                 = (AMT-WITHHELD-FED       IN PAD-TRX-REC
                 +  AMT-WITHHELD-STATE     IN PAD-TRX-REC
                 +  AMT-WITHHELD-LOCAL     IN PAD-TRX-REC)
                 * -1
           END-COMPUTE.
           IF HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

       463650-EXIT.
           EXIT.

       463700-PAYMENT-FUNDS.

           MOVE SPACE TO HIST-INDEX-OPTION

           MOVE 'Annuitization'
             TO HIST-DESC.
           MULTIPLY ANNUITIZATION-AMOUNT IN TZ-TRX-REC
                 BY -1
             GIVING HIST-AMT.
           IF  HIST-AMT NOT = ZERO
              WRITE ANNL-STMNT FROM STMTEX-LINE
           END-IF.

       463700-EXIT.
           EXIT.
           EJECT
       463800-RIDER-FEE-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF WX-FUND-INFO-TEXT
                                IN WX-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF WX-FUND-INFO-TEXT
                                         IN WX-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-RIDER-FEE   IN WX-TRX-REC (WS-SUB)
              END-COMPUTE
              IF  HIST-AMT > ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO   TO HIST-AMT
                 MOVE ZERO   TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463800-EXIT.
           EXIT.
           EJECT

       463900-RIDER-FEE-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF WXD-FUND-INFO-TEXT
                                IN WXD-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF WXD-FUND-INFO-TEXT
                                         IN WXD-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK
              PERFORM 700000-FUND-NAME-SHORT THRU 700000-EXIT
              MOVE WK-FUND-NAME-SHORT
                TO HIST-INDEX-OPTION
              COMPUTE HIST-AMT
                    = FUND-RIDER-FEE   IN WXD-TRX-REC (WS-SUB)
              END-COMPUTE
              IF  HIST-AMT > ZERO
                 WRITE ANNL-STMNT FROM STMTEX-LINE
                 MOVE ZERO   TO HIST-AMT
                 MOVE ZERO   TO HIST-DT
                 MOVE SPACES TO HIST-DESC
              END-IF

           END-PERFORM.

       463900-EXIT.
           EXIT.
           EJECT

       465000-WRITE-30-REC.
      *
      *
      *kpl 30 REC
      *KPL*****************************************************
      ***  MOVE  HOLD-FIA-30-REC  TO    STMTEX-LINE.
      *********************************************************
      *    IF  FIA-CV-WITHDRAWAL-CHRGS NOT NUMERIC
      *        MOVE ZEROS TO FIA-CV-WITHDRAWAL-CHRGS
      *    END-IF.
      *********************************************************
      ***  MOVE HOLD-FIA-INTEREST
      ***    TO STMT-INTEREST.
      ***  MOVE WK-TOTAL-TAX  TO STMT-TAX
      *---  ALREADY SET FROM VALUATION IN 436000-
      *    MOVE WK-TOTAL-MVA  TO STMT-MVA
      ***  IF  FIA-TOTAL-CLAIMS > ZEROS
      ***      MOVE FIA-TOTAL-CLAIMS    TO STMT-WITHDRAW
      ***  ELSE
      ***      MOVE HOLD-FIA-WITHDRAW   TO STMT-WITHDRAW
      ***  END-IF
      *********************************************************
      ***  WRITE   ANNL-STMNT     FROM  STMTEX-LINE.
      *********************************************************
      *
       465000-EXIT.
           EXIT.
           EJECT
       470000-GET-REC-37.
      *
      *  FULL SURRENDER ILLUSTRATION
      *

           MOVE ZEROS
             TO KEY-DEFINITION.

           MOVE SPACES
             TO DATA-DEFINITION-AREA.


           MOVE  '37'
             TO  RECORD-TYPE

           MOVE  HOLD-VAL-END-DATE
             TO  SURRENDER-CONT-VAL-DATE

           MOVE  HOLD-CONTRACT-NO (6:10)
             TO  POLICY-NUMBER        IN           KEY-DEFINITION

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE          IN KEY-DEFINITION.

           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC

           MOVE HOLD-SSN
             TO KEY-SSN

           MOVE HOLD-AGENT-ID
             TO REP-NO             IN           KEY-DEFINITION

           MOVE HOLD-BROKER-NO
             TO BROKER-NO          IN           KEY-DEFINITION

           MOVE  SURRENDER-AMT     IN TA-WORK-AREA
             TO  SURRENDER-CONTRACT-VALUE.

           MOVE  SURRENDER-PENALTY  IN TA-WORK-AREA
             TO  SURRENDER-WITHDRAWAL-CHRG.

           MOVE  TOTAL-MVA-AMT      IN TA-WORK-AREA
             TO  SURRENDER-MVA-ADJ.
      *
      * CHANGE SIGN OF MVA (NEGATIVE IS POSITIVE FOR CUSTOMER)
      *
           COMPUTE SURRENDER-MVA-ADJ =
                   SURRENDER-MVA-ADJ * -1.

           MOVE  CHECK-AMOUNT      IN TA-WORK-AREA
             TO  SURRENDER-FULLSUR-VALUE.

           WRITE ANNL-STMNT    FROM    STMTEX-LINE.


       470000-EXIT.
           EXIT.
           EJECT

       480000-FRONTIERS-II-REC-47.

           MOVE PGO-SERVICING-AGENCY
             TO BROKER-NO.
           MOVE PGO-SERVICING-AGENT
             TO REP-NO.
           MOVE HOLD-SSN
             TO KEY-SSN.
           MOVE FUND-NUMBER              IN MONEY-FUND-KEY-WORK
             TO KEY-FUND-NUMBER.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '47'
             TO RECORD-TYPE.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC.

           MOVE HOLD-LAST-RENEW-DATE
             TO E-RENEW-AS-OF-DATE.
           COMPUTE WK-FUND-TERM
                 = CURR-RENEWAL-PERIOD IN HOLD-MONYFND-SEG
                 / 12
           END-COMPUTE.

           EVALUATE TRUE

              WHEN WK-FUND-TERM = 1
                 MOVE '1 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 2
                 MOVE '2 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 3
                 MOVE '3 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 4
                 MOVE '4 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 5
                 MOVE '5 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 6
                 MOVE '6 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 7
                 MOVE '7 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 8
                 MOVE '8 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 9
                 MOVE '9 YEAR '
                   TO E-RENEW-PERIOD

              WHEN WK-FUND-TERM = 10
                 MOVE '10 YEAR'
                   TO E-RENEW-PERIOD

           END-EVALUATE.

           MOVE HOLD-LAST-RENEW-DATE
             TO E-RENEW-BEGINNING.
           COMPUTE E-RENEW-INT-RATE
                 = INTEREST-RATE IN HOLD-MONYFND-SEG (SUBC)
                 * 100
           END-COMPUTE.
           MOVE HOLD-NEXT-RENEW-DATE
             TO E-RENEW-END.
           MOVE FUND-NUMBER              IN HOLD-MONYFND-KEY
             TO E-RENEW-FUND-NUMBER.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.
      *
      * dummy data only for test purposes
      * dummy data only for test purposes
      *
      *
      *    MOVE PGO-SERVICING-AGENCY
      *      TO BROKER-NO.
      *    MOVE PGO-SERVICING-AGENT
      *      TO REP-NO.
      *    MOVE HOLD-SSN
      *      TO KEY-SSN.
      *    MOVE HOLD-FUND-NUMBER
      *      TO KEY-FUND-NUMBER.
      *    MOVE HOLD-CONTRACT-NO (6:10)
      *      TO POLICY-NUMBER            IN KEY-DEFINITION.
      *    MOVE HOLD-COMPANY-CODE
      *      TO COMPANY-CODE             IN KEY-DEFINITION.
      *    MOVE HOLD-PROD-MNEMONIC
      *      TO KEY-PROD-MNEMONIC.
      *    MOVE '47'
      *      TO RECORD-TYPE              IN STMTEX-LINE.
      *
      *    MOVE HOLD-VAL-END-DATE
      *      TO E-RENEW-AS-OF-DATE.
      *
      *    MOVE 'Test 01'
      *      TO E-RENEW-PERIOD.
      *
      *    MOVE TRX-BEGIN-DATE
      *      TO BASE-DATE                IN DATE-ARITHMETIC-AREA
      *         RETURN-DATE              IN DATE-ARITHMETIC-AREA.
      *
      *    MOVE +1
      *      TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
      *    MOVE ZEROES
      *      TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA
      *         CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
      *
      *    CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.
      *
      *    MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
      *      TO E-RENEW-BEGINNING.
      *
      *
      *    MOVE 88
      *      TO E-RENEW-INT-RATE.
      *
      *    MOVE E-RENEW-BEGINNING
      *      TO BASE-DATE                IN DATE-ARITHMETIC-AREA
      *         RETURN-DATE              IN DATE-ARITHMETIC-AREA.
      *
      *    MOVE +1
      *      TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA.
      *    MOVE ZEROES
      *      TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
      *    MOVE -1
      *      TO CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
      *
      *    CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.
      *
      *    MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
      *      TO E-RENEW-END.
      *
      *    MOVE KEY-FUND-NUMBER
      *      TO E-RENEW-FUND-NUMBER.
      *
      *    WRITE ANNL-STMNT FROM STMTEX-LINE.
      *
      *    MOVE ZEROS
      *      TO KEY-DEFINITION.
      *    MOVE SPACES
      *      TO DATA-DEFINITION-AREA.
      *
      *
       480000-EXIT.
           EXIT.
           EJECT
       490000-GET-REC-65.

           IF  TRUSTEE IN POLICY-SEG
           OR  ((LINE-OF-BUSINESS-CODE IN POLICY-SEG = '401')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = '457')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = '501')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'IK1')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'KEO')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'KET')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'PEN')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'PSD')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CO2')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CO6')
           OR   (LINE-OF-BUSINESS-CODE IN POLICY-SEG = 'CP6'))
              GO TO 490000-EXIT
           END-IF.

           IF  CONTRACT-BENE-SW IN POLICY-SEG NOT = 'Y'
              PERFORM 492000-BUILD-DEFAULT-BENE THRU 492000-EXIT
              GO TO 490000-EXIT
           END-IF.

           PERFORM 491000-BUILD-BENE-LIST THRU 491000-EXIT.

           PERFORM VARYING SUBB FROM +1 BY +1
             UNTIL (SUBB > WK-BENE-COUNT)
                OR (SUBB > +50)

              MOVE ZEROS TO KEY-DEFINITION
              MOVE SPACES TO DATA-DEFINITION-AREA

              MOVE HOLD-BROKER-NO
                TO BROKER-NO             IN KEY-DEFINITION
              MOVE HOLD-AGENT-ID
                TO REP-NO                IN KEY-DEFINITION
              MOVE HOLD-SSN
                TO KEY-SSN               IN KEY-DEFINITION
              MOVE HOLD-CONTRACT-NO (6:10)
                TO POLICY-NUMBER         IN KEY-DEFINITION
              MOVE '65'
                TO RECORD-TYPE           IN KEY-DEFINITION
              MOVE HOLD-COMPANY-CODE
                TO COMPANY-CODE          IN KEY-DEFINITION
              MOVE HOLD-PROD-MNEMONIC
                TO KEY-PROD-MNEMONIC     IN KEY-DEFINITION

              IF  WK-BENE-TYPE (SUBB) = 'P'
                 SET BENEFIT-TYPE-PRIMARY TO TRUE
              ELSE
                 SET BENEFIT-TYPE-CONTINGENT TO TRUE
              END-IF
              MOVE WK-BENE-PCT (SUBB)
                TO BENEFIT-PERCENT
              MOVE WK-BENE-NAME (SUBB)
                TO BENEFIT-NAME

              WRITE ANNL-STMNT FROM STMTEX-LINE

           END-PERFORM.

       490000-EXIT.
           EXIT.
           EJECT
       491000-BUILD-BENE-LIST.

           MOVE ZERO TO WK-BENE-COUNT.
           PERFORM VARYING SUBB FROM +1 BY +1
             UNTIL SUBB > +50

              MOVE SPACES TO WK-BENE-NAME (SUBB)
                             WK-BENE-TYPE (SUBB)
              MOVE ZERO   TO WK-BENE-PCT  (SUBB)

           END-PERFORM.

           MOVE SPACES
             TO SAVE-BENE-KEY.

           MOVE SPACES TO DB-PARM-AREA
                          DB-COMM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                SAVE-COMPANY-CDE.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                SAVE-MASTER-ID.
           MOVE +1
             TO SAVE-PARM-SEG-SEQ-NUM.
           MOVE ZEROS
             TO SAVE-PARM-SEG-ID.
           MOVE SAVE-BENE-KEY
             TO SEGMENT-KEY              IN DB-PARM-AREA.
           MOVE GET-FIRST-WITH-POSITION  IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE BENE                     IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           MOVE SPACE TO SW-END-OF-BENEFICIARIES-SW.
           PERFORM 491100-GET-NEXT-BENE THRU 491100-EXIT
             UNTIL SW-END-OF-BENEFICIARIES.

       491000-EXIT.
           EXIT.
           EJECT
       491100-GET-NEXT-BENE.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                BENEFICIARY-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-BENEFICIARIES TO TRUE
              GO TO 491100-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO SAVE-BENE-KEY.

           PERFORM 491110-INSERT-BENE THRU 491110-EXIT.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE SAVE-BENE-KEY
             TO SEGMENT-KEY              IN DB-PARM-AREA.
           MOVE GET-NEXT                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE BENE                     IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

       491100-EXIT.
           EXIT.
           EJECT
       491110-INSERT-BENE.

           IF  BENE-TYPE = 'T'
              GO TO 491110-EXIT
           END-IF.

           ADD +1 TO WK-BENE-COUNT.

           MOVE SPACE TO SW-ELEMENT-INSERTED-SW.

           PERFORM VARYING SUBB FROM +1 BY +1
             UNTIL (SUBB > WK-BENE-COUNT)
                OR SW-ELEMENT-INSERTED

      ***** BECAUSE P(RIMARY) COMES AFTER C(ONTINGENT) WE NEED TO TEST
      ***** FOR GREATER IN ORDER TO INSERT THE PRIMARY BEFORE THE
      ***** CONTINGENT

              IF  BENE-TYPE > WK-BENE-TYPE (SUBB)
                 PERFORM 491120-ADD-BENE-ENTRY THRU 491120-EXIT
              ELSE
                 IF  BENE-TYPE = WK-BENE-TYPE (SUBB)
                    IF  BENEFIT-PCT > WK-BENE-PCT (SUBB)
                       PERFORM 491120-ADD-BENE-ENTRY THRU 491120-EXIT
                    END-IF
                 END-IF
              END-IF

           END-PERFORM.

       491110-EXIT.
           EXIT.
           EJECT
       491120-ADD-BENE-ENTRY.

           IF  WK-BENE-COUNT > +1
              PERFORM 491130-SHIFT-BENES THRU 491130-EXIT
           END-IF.

           MOVE BENE-TYPE   TO WK-BENE-TYPE (SUBB).
           MOVE BENEFIT-PCT TO WK-BENE-PCT  (SUBB).

           IF  NAME-TYPE-INDIVIDUAL IN BENEFICIARY-SEGMENT
              MOVE SPACES TO WK-BENE-NAME (SUBB)
              IF  NAME-PREFIX IN BENEFICIARY-SEGMENT NOT = SPACES
                 STRING NAME-PREFIX IN BENEFICIARY-SEGMENT ' '
                        FIRST-NAME  IN BENEFICIARY-SEGMENT ' '
                        LAST-NAME   IN BENEFICIARY-SEGMENT ' '
                        NAME-SUFFIX IN BENEFICIARY-SEGMENT ' '
                           DELIMITED BY '  '
                   INTO WK-BENE-NAME (SUBB)
              ELSE
                 STRING FIRST-NAME  IN BENEFICIARY-SEGMENT ' '
                        LAST-NAME   IN BENEFICIARY-SEGMENT ' '
                        NAME-SUFFIX IN BENEFICIARY-SEGMENT ' '
                           DELIMITED BY '  '
                   INTO WK-BENE-NAME (SUBB)
              END-IF
           ELSE
              MOVE COMPANY-NAME          IN BENEFICIARY-SEGMENT
                TO WK-BENE-NAME (SUBB)
           END-IF.

           SET SW-ELEMENT-INSERTED TO TRUE.

       491120-EXIT.
           EXIT.
           EJECT
       491130-SHIFT-BENES.

           PERFORM VARYING SUBY FROM WK-BENE-COUNT BY -1
             UNTIL (SUBY NOT > +1)
                OR (SUBY NOT > SUBB)

              COMPUTE SUBX
                    = SUBY
                    - 1
              END-COMPUTE
              MOVE WK-BENEFICIARY-DATA (SUBX)
                TO WK-BENEFICIARY-DATA (SUBY)

           END-PERFORM.

       491130-EXIT.
           EXIT.
           EJECT
       492000-BUILD-DEFAULT-BENE.

           MOVE ZEROS TO KEY-DEFINITION.
           MOVE SPACES TO DATA-DEFINITION-AREA.

           MOVE HOLD-BROKER-NO
             TO BROKER-NO                IN KEY-DEFINITION.
           MOVE HOLD-AGENT-ID
             TO REP-NO                   IN KEY-DEFINITION.
           MOVE HOLD-SSN
             TO KEY-SSN                  IN KEY-DEFINITION.
           MOVE HOLD-CONTRACT-NO (6:10)
             TO POLICY-NUMBER            IN KEY-DEFINITION.
           MOVE '65'
             TO RECORD-TYPE              IN KEY-DEFINITION.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN KEY-DEFINITION.
           MOVE HOLD-PROD-MNEMONIC
             TO KEY-PROD-MNEMONIC        IN KEY-DEFINITION.

           SET BENEFIT-TYPE-PRIMARY TO TRUE.
           MOVE +100.00
             TO BENEFIT-PERCENT.
           MOVE 'ESTATE OF CONTRACT OWNER'
             TO BENEFIT-NAME.

           WRITE ANNL-STMNT FROM STMTEX-LINE.

       492000-EXIT.
           EXIT.
           EJECT
      ***** $W6165C START *****
       500000-BAD-ADDR-HEADER.

           MOVE SPACES TO BAD-ADDR-REC.

           MOVE 'BAD ADDRESS AUDIT REPORT' TO BAD-ADDR-LINE (58:25).
           MOVE BAD-ADDR-LINE TO BAD-ADDR-DATA.

           WRITE BAD-ADDR-REC AFTER ADVANCING PAGE.

           MOVE '------------------------' TO BAD-ADDR-LINE (58:25).
           MOVE BAD-ADDR-LINE TO BAD-ADDR-DATA.

           WRITE BAD-ADDR-REC AFTER ADVANCING 1.

           MOVE SPACES TO BAD-ADDR-LINE.
           MOVE BAD-ADDR-LINE TO BAD-ADDR-DATA.

           WRITE BAD-ADDR-REC AFTER ADVANCING 1.

           MOVE ZERO TO RPT-LINE-COUNT.

       500000-EXIT.
           EXIT.
           Eject
       510000-BAD-ADDR.

           MOVE SPACES TO BAD-ADDR-LINE.

           MOVE POLICY-NUMBER            IN KEY-DEFINITION
             TO BAD-ADDR-POLICY-NUMBER   IN BAD-ADDR-LINE.
           MOVE SOC-SEC-NO               IN NAME-ADDRESS-SEGMENT
             TO BAD-ADDR-SSN             IN BAD-ADDR-LINE.
           MOVE COMPANY-NAME             IN NAME-ADDRESS-SEGMENT (1:60)
             TO BAD-ADDR-NAME            IN BAD-ADDR-LINE.
           MOVE '*** BAD ADDRESS INDICATOR SET. RECORD SUPPRESSED ***'
             TO BAD-ADDR-MESSAGE         IN BAD-ADDR-LINE.
           MOVE BAD-ADDR-LINE TO BAD-ADDR-DATA.

           WRITE BAD-ADDR-REC AFTER ADVANCING 1.

           ADD +1 TO RPT-LINE-COUNT.
           IF  RPT-LINE-COUNT > +60
              PERFORM 500000-BAD-ADDR-HEADER THRU 500000-EXIT
           END-IF.

       510000-EXIT.
           EXIT.
      ***** $W6165C  END  *****
           EJECT
       600000-GET-FIRST-RIDER.

           MOVE SPACES TO DB-PARM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE            IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER           IN DB-PARM-AREA.
           MOVE GET-FIRST               IN DB-OPERATIONS
             TO OPERATION               IN DB-PARM-AREA.
           MOVE RIDER                   IN DB-MNEMONICS
             TO ACCESS-SEGMENT          IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                RIDER-SEGMENT
                                DB-COMM-AREA.
           IF  SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE SEGMENT-KEY           IN DB-COMM-AREA
                TO WK-HOLD-RIDER-KEY
           END-IF.

       600000-EXIT.
           EXIT.
           EJECT
       610000-GET-NEXT-RIDER.

           initialize db-parm-area.
           initialize db-comm-area.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE            IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER           IN DB-PARM-AREA.
           MOVE GET-NEXT                IN DB-OPERATIONS
             TO OPERATION               IN DB-PARM-AREA.
           MOVE WK-HOLD-RIDER-KEY
             TO SEGMENT-KEY             IN DB-PARM-AREA.
           MOVE RIDER                   IN DB-MNEMONICS
             TO ACCESS-SEGMENT          IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                RIDER-SEGMENT
                                DB-COMM-AREA.
           IF  SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE SEGMENT-KEY           IN DB-COMM-AREA
                TO WK-HOLD-RIDER-KEY
           END-IF.

       610000-EXIT.
           EXIT.
           EJECT
       700000-FUND-NAME-SHORT.

           MOVE SPACES TO WK-FUND-NAME-SHORT.

           PERFORM VARYING SUBN FROM +1 BY +1
             UNTIL (SUBN > +400)
                OR (VT1-FUND-NUM-9 (SUBN) = +999)
                OR (WK-FUND-NAME-SHORT > SPACES)

              IF  WK-FUND-NUMBER-WORK = VT1-FUND-NUM-9 (SUBN)
                 MOVE VT1-FUND-NAME-16 (SUBN) TO WK-FUND-NAME-SHORT
              END-IF

           END-PERFORM.

       700000-EXIT.
           EXIT.
           EJECT
       710000-FUND-NAME-LONG.

           MOVE SPACES TO WK-FUND-NAME-LONG.

           PERFORM VARYING SUBN FROM +1 BY +1
             UNTIL (SUBN > +400)
                OR (VT1-FUND-NUM-9 (SUBN) = +999)
                OR (WK-FUND-NAME-LONG > SPACES)

              IF  WK-FUND-NUMBER-WORK = VT1-FUND-NUM-9 (SUBN)
                 MOVE VT1-FUND-NAME-24 (SUBN) TO WK-FUND-NAME-LONG
              END-IF

           END-PERFORM.

       710000-EXIT.
           EXIT.
           EJECT
       800000-GET-SEG-DATES.

           MOVE SPACE TO SW-DATE-SEARCH-COMPLETE-SW
                         SW-FUND-IN-USE-SW.
           MOVE '00000000' TO WK-BEG-DATE
                              WK-END-DATE.

           PERFORM 810000-GET-FIRST-FUND THRU 810000-EXIT.

           PERFORM 820000-GET-NEXT-FUND  THRU 820000-EXIT
             UNTIL SW-DATE-SEARCH-COMPLETE.

           IF  WK-DATE-SEARCH-TYPE = 'N'
              IF  WK-BEG-DATE = '00000000'
      *          IF  SW-NO-OTHER-FUNDS-AVAIL                    $T164136
      *          OR  SW-FUND-IN-USE                             $T164136

                 IF SW-FUND-IN-USE
                    GO TO 800000-EXIT
                 END-IF
                 PERFORM 830000-GET-NEW-DATES THRU 830000-EXIT
              END-IF
           END-IF.

       800000-EXIT.
           EXIT.
           EJECT
       810000-GET-FIRST-FUND.

           IF  FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
              PERFORM 811000-GET-FIRST-MF THRU 811000-EXIT
           ELSE
              PERFORM 812000-GET-FIRST-IF THRU 812000-EXIT
           END-IF.

       810000-EXIT.
           EXIT.
           EJECT
       811000-GET-FIRST-MF.

           MOVE SPACES TO DB-PARM-AREA.
           INITIALIZE MONEY-FUND-KEY-WORK.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN MONEY-FUND-KEY-WORK.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN MONEY-FUND-KEY-WORK.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              IN MONEY-FUND-KEY-WORK.
           MOVE LOW-VALUES
             TO ELEMENT-KEY              IN MONEY-FUND-KEY-WORK.
           MOVE 'GFI '
             TO OPERATION                IN DB-PARM-AREA.
           MOVE MONEY-FUND               IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL  IN DB-COMM-AREA
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 811000-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO MONEY-FUND-KEY-WORK.

       811000-EXIT.
           EXIT.
           EJECT
       812000-GET-FIRST-IF.

           MOVE SPACES TO DB-PARM-AREA.
           MOVE SPACES TO DB-PARM-AREA.
           INITIALIZE INDEX-FUND-SEG-KEY.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
                COMPANY-CODE             IN INDEX-FUND-SEG-KEY.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
                MASTER-ID                IN INDEX-FUND-SEG-KEY.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              IN INDEX-FUND-SEG-KEY.
           MOVE GET-FIRST                IN DB-OPERATIONS
      *    MOVE 'GFI '
             TO OPERATION                IN DB-PARM-AREA
           MOVE INDEX-FUND               IN DB-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

      *    INITIALIZE ELEMENT-KEY           IN INDEX-FUND-SEG-key
      *         REPLACING NUMERIC DATA BY ZEROES.

           MOVE INDEX-FUND-SEG-KEY
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                INDEX-FUND-SEG
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 812000-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO INDEX-FUND-SEG-KEY.

       812000-EXIT.
           EXIT.
           EJECT
       820000-GET-NEXT-FUND.

           PERFORM 823000-CHECK-SEGMENT THRU 823000-EXIT.

           IF  FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
              PERFORM 821000-GET-NEXT-MF THRU 821000-EXIT
           ELSE
              PERFORM 822000-GET-NEXT-IF THRU 822000-EXIT
           END-IF.

       820000-EXIT.
           EXIT.
           EJECT
       821000-GET-NEXT-MF.

           IF SW-DATE-SEARCH-COMPLETE
              GO TO 821000-EXIT
           END-IF.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE 'GNI '
             TO OPERATION                IN DB-PARM-AREA.
           MOVE MONEY-FUND               IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           MOVE MONEY-FUND-KEY-WORK
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL  IN DB-COMM-AREA
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 821000-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO MONEY-FUND-KEY-WORK.

       821000-EXIT.
           EXIT.
           EJECT
       822000-GET-NEXT-IF.

           IF SW-DATE-SEARCH-COMPLETE
              GO TO 822000-EXIT
           END-IF.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA
           MOVE GET-NEXT                 IN DB-OPERATIONS
      *    MOVE 'GNI '
             TO OPERATION                IN DB-PARM-AREA
           MOVE INDEX-FUND               IN DB-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

      *    INITIALIZE ELEMENT-KEY           IN INDEX-FUND-SEG-KEY
      *         REPLACING NUMERIC DATA BY ZEROES.

           MOVE INDEX-FUND-SEG-KEY
             TO SECONDARY-KEY            IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                INDEX-FUND-SEG
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 822000-EXIT
           END-IF.

           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO INDEX-FUND-SEG-KEY.

       822000-EXIT.
           EXIT.
           EJECT
       823000-CHECK-SEGMENT.

           IF  WK-DATE-SEARCH-TYPE = 'N'
              IF  FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
                 PERFORM 823100-NEW-MF-DATES THRU 823100-EXIT
              ELSE
                 PERFORM 823200-NEW-IF-DATES THRU 823200-EXIT
              END-IF
           ELSE
              IF  FUND-TYPE IN RATE-SEGMENT (SUBF) = 'M'
                 PERFORM 823300-OLD-MF-DATES THRU 823300-EXIT
              ELSE
                 PERFORM 823400-OLD-IF-DATES THRU 823400-EXIT
              END-IF
           END-IF.

       823000-EXIT.
           EXIT.
           EJECT
       823100-NEW-MF-DATES.

           IF  ACTIVE-SEGMENT IN MONEY-FUND-SEGMENT
              IF  LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT > TRX-END-DATE
                 GO TO 823100-EXIT
              END-IF
              MOVE LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
                TO WK-BEG-DATE
              MOVE NEXT-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
                TO WK-END-DATE
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 823100-EXIT
           END-IF.

       823100-EXIT.
           EXIT.
           EJECT
       823200-NEW-IF-DATES.

           IF  LAST-RENEWAL-DATE IN INDEX-FUND-SEG = '00000000'
              MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
                TO LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
           END-IF.

           IF  ACTIVE-SEGMENT IN INDEX-FUND-SEG
           AND (LAST-RENEWAL-DATE IN INDEX-FUND-SEG < TRX-END-DATE)
           AND (EI-PERIOD         IN INDEX-FUND-SEG > 12)
              SET SW-FUND-IN-USE TO TRUE
              GO TO 823200-EXIT
           END-IF.

           IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
      **** $T164136 START ****
           AND (ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG <=
                TRX-BEGIN-DATE)
           AND (EI-TERMINATION-DATE   IN INDEX-FUND-SEG >
                TRX-BEGIN-DATE)
           AND (EI-TERMINATION-DATE   IN INDEX-FUND-SEG NOT EQUAL
                TRX-END-DATE)
      *    AND (LAST-RENEWAL-DATE IN INDEX-FUND-SEG >= TRX-BEGIN-DATE)
      *    AND (LAST-RENEWAL-DATE IN INDEX-FUND-SEG < TRX-END-DATE)
           AND (EI-PERIOD         IN INDEX-FUND-SEG > 12)
              SET SW-FUND-IN-USE TO TRUE
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 823200-EXIT
           END-IF.

           IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
      **** $T164136 START ****
      *    AND (ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG = TRX-END-DATE)
           AND (EI-PERIOD            IN INDEX-FUND-SEG = 12)
      *       MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
      *         TO WK-BEG-DATE
      *       MOVE LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
      *         TO WK-END-DATE
              MOVE TRX-END-DATE
                TO WK-BEG-DATE
                   BASE-DATE                IN DATE-ARITHMETIC-AREA
                   RETURN-DATE              IN DATE-ARITHMETIC-AREA
              MOVE ZERO
                TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                   CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA
              MOVE EI-PERIOD                IN INDEX-FUND-SEG
                TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA

              CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA

                 MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                   TO WK-END-DATE
      ***** $T164136  END  *****
              SET SW-FUND-IN-USE TO TRUE
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 823200-EXIT
           END-IF.

           IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
           AND (ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG = TRX-BEGIN-DATE)
           AND (EI-PERIOD            IN INDEX-FUND-SEG > 12)
      ***** $T164136 START *****
           AND (ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG  NOT EQUAL
                EI-TERMINATION-DATE   IN INDEX-FUND-SEG)
      *       MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
      *         TO WK-BEG-DATE
      *       MOVE LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
      *         TO WK-END-DATE
      ***** $T164136  END *****
              SET SW-FUND-IN-USE TO TRUE
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 823200-EXIT
           END-IF.

           IF  ACTIVE-SEGMENT IN INDEX-FUND-SEG
      ***** $T164136 START *****
              MOVE TRX-END-DATE
      *       MOVE LAST-RENEWAL-DATE  IN INDEX-FUND-SEG
                TO WK-BEG-DATE
                   BASE-DATE                IN DATE-ARITHMETIC-AREA
                   RETURN-DATE              IN DATE-ARITHMETIC-AREA
              MOVE ZERO
                TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                   CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA
              MOVE EI-PERIOD                IN INDEX-FUND-SEG
                TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA

              CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA

                 MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                   TO WK-END-DATE
      *       MOVE EI-RENEWAL-DATE    IN INDEX-FUND-SEG
      *         TO WK-END-DATE
      ***** $T164136  END  *****
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
              GO TO 823200-EXIT
           END-IF.

       823200-EXIT.
           EXIT.
           EJECT
       823300-OLD-MF-DATES.

      *    IF  LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT NOT <
      ***** $T87078 START *****
      *    IF  LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT >
      *        TRX-END-DATE
           IF  ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT NOT <
               TRX-END-DATE
      ***** $T87078  END  *****
           OR  (NEXT-RENEWAL-DATE IN MONEY-FUND-SEGMENT <
                TRX-BEGIN-DATE)
           OR  TERMINATED-SEGMENT IN MONEY-FUND-SEGMENT
           AND (LAST-RENEWAL-DATE IN MONEY-FUND-SEGMENT <=
                TRX-BEGIN-DATE)
              GO TO 823300-EXIT
           END-IF.

      ***** $114947 START *****
      *    PERFORM 823310-ADJUST-MF-DATE THRU 823310-EXIT
      *      UNTIL (LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT NOT <
      *             TRX-BEGIN-DATE)
      *        AND (NEXT-RENEWAL-DATE     IN MONEY-FUND-SEGMENT NOT <
      *             TRX-END-DATE)
      *         OR (LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT NOT >
      *             ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT).
           PERFORM 823310-ADJUST-MF-DATE THRU 823310-EXIT.
      ***** $114947  END  *****

      *    MOVE LAST-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
           MOVE TRX-BEGIN-DATE
             TO WK-BEG-DATE.
      *    MOVE NEXT-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
      ***** $T87078 START *****
      *    MOVE LAST-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
      *      TO WK-END-DATE.
      ***** $114947 START *****
      *    IF  ACTIVE-SEGMENT IN MONEY-FUND-SEGMENT
      *       MOVE LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
      *         TO WK-END-DATE
      *    ELSE
      *       IF  NEXT-RENEWAL-DATE IN MONEY-FUND-SEGMENT > TRX-END-DATE
      *          MOVE LAST-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
      *            TO WK-END-DATE
      *       ELSE
      *          MOVE NEXT-RENEWAL-DATE  IN MONEY-FUND-SEGMENT
      *            TO WK-END-DATE
      *       END-IF
      *    END-IF.
      ***** $114947  END  *****
      ***** $T87078  END  *****

           IF RECORD-TYPE IS = '52'
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
           END-IF.

       823300-EXIT.
           EXIT.
           EJECT
       823310-ADJUST-MF-DATE.

      ***** $114947 START *****
      *    MOVE LAST-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
      *      TO NEXT-RENEWAL-DATE        IN MONEY-FUND-SEGMENT.
      *
      *    MOVE LAST-RENEWAL-DATE        IN MONEY-FUND-SEGMENT
      *      TO BASE-DATE                IN DATE-ARITHMETIC-AREA
      *         RETURN-DATE              IN DATE-ARITHMETIC-AREA.
      *    MOVE ZERO
      *      TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
      *         CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
      *    COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
      *          = CURR-RENEWAL-PERIOD IN MONEY-FUND-SEGMENT
      *          * -1
      *    END-COMPUTE.
           MOVE TRX-BEGIN-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           MOVE CURR-RENEWAL-PERIOD      IN MONEY-FUND-SEGMENT
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.
      ***** $114947  END  *****

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

      ***** $114947 START *****
      *    IF  RETURN-DATE           IN DATE-ARITHMETIC-AREA NOT <
      *        ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT
      *       MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
      *         TO LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
      *    ELSE
      *       MOVE ORIG-DEPOSIT-EFF-DATE IN MONEY-FUND-SEGMENT
      *         TO LAST-RENEWAL-DATE     IN MONEY-FUND-SEGMENT
      *    END-IF.
           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-END-DATE.
      ***** $114947  END  *****

       823310-EXIT.
           EXIT.
           EJECT
       823400-OLD-IF-DATES.

      ***** START $T164136 *****
           MOVE TRX-BEGIN-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA
           MOVE -1
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
           MOVE ZERO
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE
             TO TRX-PRIOR-YEAR.

      ***** $T92005 START *****
      *    IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
      *    AND EI-RENEWAL-DATE    IN INDEX-FUND-SEG NOT > TRX-BEGIN-DATE
           IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
           AND EI-PERIOD IN INDEX-FUND-SEG = 12
           AND (ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG NOT EQUAL
               TRX-BEGIN-DATE)
              GO TO 823400-EXIT
           END-IF.

           IF   TERMINATED-SEGMENT    IN INDEX-FUND-SEG
           AND (ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG  =
                EI-TERMINATION-DATE   IN INDEX-FUND-SEG)
              GO TO 823400-EXIT
           END-IF.

           IF  TERMINATED-SEGMENT IN INDEX-FUND-SEG
           AND EI-PERIOD IN INDEX-FUND-SEG > 12
              IF (ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG =
                  TRX-BEGIN-DATE)
              OR (ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG =
                  TRX-PRIOR-YEAR)
                 CONTINUE
              ELSE
                 GO TO 823400-EXIT
              END-IF
           END-IF

           IF  ACTIVE-SEGMENT IN INDEX-FUND-SEG
      *    AND ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG = TRX-END-DATE
           AND ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG >= TRX-END-DATE
      **** $T164136  END *****
              GO TO 823400-EXIT
           END-IF.

           MOVE TRX-BEGIN-DATE TO WK-BEG-DATE.
           IF  ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG < WK-BEG-DATE
              MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
                TO WK-BEG-DATE
           END-IF.

      *    IF  LAST-RENEWAL-DATE IN INDEX-FUND-SEG = '00000000'
      *       IF  ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG = TRX-END-DATE
      *          GO TO 823400-EXIT
      *       END-IF
      *       MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
      *         TO LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
      *    END-IF.
      *
      **   IF  LAST-RENEWAL-DATE IN INDEX-FUND-SEG NOT < TRX-END-DATE
      *    IF  LAST-RENEWAL-DATE IN INDEX-FUND-SEG > TRX-END-DATE
      *       GO TO 823400-EXIT
      *    END-IF.
      *
      *    PERFORM 823410-ADJUST-IF-DATE THRU 823410-EXIT
      *      UNTIL (LAST-RENEWAL-DATE     IN INDEX-FUND-SEG NOT <
      *             TRX-BEGIN-DATE)
      *        AND (EI-RENEWAL-DATE       IN INDEX-FUND-SEG NOT <
      *             TRX-END-DATE)
      *         OR (LAST-RENEWAL-DATE     IN INDEX-FUND-SEG NOT >
      *             ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG).
      *
      *    MOVE LAST-RENEWAL-DATE  IN INDEX-FUND-SEG
      **   MOVE ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG
      *      TO WK-BEG-DATE.
      ***** $T92005  END  *****
      ***** $T164136 START *****
           MOVE WK-BEG-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA
           MOVE EI-PERIOD                IN INDEX-FUND-SEG
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA

              MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
                TO WK-END-DATE
      *    MOVE EI-RENEWAL-DATE    IN INDEX-FUND-SEG
      *      TO WK-END-DATE.
      ***** $T164136  END  *****

           IF  SW-ONLY-2YR-MONEY
           AND (EI-PERIOD IN INDEX-FUND-SEG > 12)
              IF  (WK-BEG-DATE = TRX-BEGIN-DATE)
              AND (WK-END-DATE > TRX-END-DATE)
                 SET SW-NO-OTHER-FUNDS-AVAIL TO TRUE
              END-IF
           END-IF

           IF RECORD-TYPE IS = '52'
              SET SW-DATE-SEARCH-COMPLETE TO TRUE
           END-IF.

       823400-EXIT.
           EXIT.
           EJECT
       823410-ADJUST-IF-DATE.

           MOVE LAST-RENEWAL-DATE        IN INDEX-FUND-SEG
             TO EI-RENEWAL-DATE          IN INDEX-FUND-SEG.

           MOVE LAST-RENEWAL-DATE        IN INDEX-FUND-SEG
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           COMPUTE CHANGE-DATE-MMM IN DATE-ARITHMETIC-AREA
                 = EI-PERIOD       IN INDEX-FUND-SEG
                 * -1
           END-COMPUTE.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           IF  RETURN-DATE          IN DATE-ARITHMETIC-AREA NOT <
               ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG
              MOVE RETURN-DATE           IN DATE-ARITHMETIC-AREA
                TO LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
           ELSE
              MOVE ORIG-EI-DEPOSIT-DATE  IN INDEX-FUND-SEG
                TO LAST-RENEWAL-DATE     IN INDEX-FUND-SEG
           END-IF.

       823410-EXIT.
           EXIT.
           EJECT
       830000-GET-NEW-DATES.

           MOVE TRX-END-DATE TO WK-BEG-DATE.

           MOVE SPACES TO TABLE-ACCESS.

           MOVE '009'
             TO TABLE-ID                 IN TABLE-ACCESS.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN TABLE-ACCESS.
           MOVE STMT-END
             TO EFFECTIVE-DATE           IN TABLE-ACCESS.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              IN FUND-INFO-RECORD.

           CALL 'ITAX011' USING TABLE-ACCESS
                                FUND-INFO-RECORD.
           IF  NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS
              DISPLAY 'TABLE 009 ERROR = '
                      RETURN-STATUS IN TABLE-ACCESS
              DISPLAY 'POL NUMBER = ' HOLD-CONTRACT-NO (6:10)
                      HOLD-CONTRACT-NO (6:10)
              GO TO 830000-EXIT
           END-IF.

           MOVE WK-BEG-DATE
             TO BASE-DATE                IN DATE-ARITHMETIC-AREA
                RETURN-DATE              IN DATE-ARITHMETIC-AREA.
           MOVE ZERO
             TO CHANGE-DATE-YYY          IN DATE-ARITHMETIC-AREA
                CHANGE-DATE-DDD          IN DATE-ARITHMETIC-AREA.
           MOVE GUARANTEED-DURATION      IN FUND-INFO-RECORD
             TO CHANGE-DATE-MMM          IN DATE-ARITHMETIC-AREA.

           CALL 'IUAXF85' USING DATE-ARITHMETIC-AREA.

           MOVE RETURN-DATE              IN DATE-ARITHMETIC-AREA
             TO WK-END-DATE.

       830000-EXIT.
           EXIT.
           EJECT
       850000-BUILD-FUND-TABLE.

      *    MOVE TRANSACTION-DATA TO POLICY-VALUES-RECORD.
           MOVE 'N' TO FIA-OEM-TRNSFER-FOUND.
           MOVE +0  TO HOLD-FIA-INTEREST
                       HOLD-FIA-WITHDRAW
                       WK-STMT-MVA-AMT.

           PERFORM VARYING SUBS FROM +1 BY +1
      *      UNTIL SUBS > +10                                   $T157090
             UNTIL (FIA-CONTRACT    AND SUBS > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBS > +10)
                OR (FIA-PA-CONTRACT AND SUBS > +30)

              MOVE FUND-NUMBER           IN RATE-SEGMENT (SUBS)
                TO FIA-FUND-NUMBER  (SUBS)
              MOVE ZERO
      *         TO FIA-FUND-PREMIUM (SUBS)
                TO FIA-FUND-BEGIN-VALUE (SUBS)
                   FIA-FUND-PREMIUM (SUBS)
                   FIA-FUND-ADDON (SUBS)
                   FIA-FUND-EXTRA-CREDIT (SUBS)
                   FIA-FUND-WITHDRAWALS (SUBS)
                   FIA-FUND-RIDER-FEES (SUBS)
                   FIA-FUND-INTEREST (SUBS)
                   FIA-FUND-TRANSFER-IN-OUT (SUBS)
                   FIA-FUND-ENDING-VALUE (SUBS)
                   FIA-FUND-STARTING-PRICE (SUBS)
                   FIA-FUND-ENDING-PRICE (SUBS)
                   FIA-FUND-INDEX-CHANGE (SUBS)
                   FIA-FUND-GUAR-RATE (SUBS)
                   FIA-FUND-RATE-CREDITED (SUBS)
                   FIA-FUND-MVA (SUBS)

           END-PERFORM.

           PERFORM VARYING SUBV FROM +1 BY +1
      *      UNTIL (SUBV > +10)                                 $T157090
             UNTIL (FIA-CONTRACT    AND SUBV > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBV > +10)
                OR (FIA-PA-CONTRACT AND SUBV > +30)
                OR (FUND-NUMBER IN BEGIN-POLICY-VALUES (SUBV) = +999)

              MOVE FUND-NUMBER           IN BEGIN-POLICY-VALUES (SUBV)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              MOVE FUND-DECL-VALUE       IN BEGIN-POLICY-VALUES (SUBV)
                TO FIA-FUND-BEGIN-VALUE (SUBS)

              MOVE FUND-TYPE-INDICATOR   IN BEGIN-POLICY-VALUES (SUBV)
                TO FIA-FUND-TYPE (SUBS)

           END-PERFORM.

           PERFORM VARYING SUBV FROM +1 BY +1
      *      UNTIL (SUBV > +10)                                 $T157090
             UNTIL (FIA-CONTRACT    AND SUBV > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBV > +10)
                OR (FIA-PA-CONTRACT AND SUBV > +30)
                OR (FUND-NUMBER IN POLICY-VALUES (SUBV) = +999)

              MOVE FUND-NUMBER           IN POLICY-VALUES (SUBV)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              MOVE FUND-DECL-VALUE       IN POLICY-VALUES (SUBV)
                TO FIA-FUND-ENDING-VALUE (SUBS)

      ***** $114384 START *****
      *       MOVE FUND-TYPE-INDICATOR   IN POLICY-VALUES (SUBV)
      *         TO FIA-FUND-TYPE (SUBS)
      ***** $114384  END  *****

           END-PERFORM.

           PERFORM 851000-GET-LAST-TRXHIST THRU 851000-EXIT.

           MOVE SPACE TO SW-END-OF-TRXHIST-SW.

           PERFORM 852000-PROCESS-TRXHIST  THRU 852000-EXIT
             UNTIL SW-END-OF-TRXHIST.

      *---------------------------------------------------*
      * IF TRX=OEM, NEED TO BACK INTO INTEREST CALCULATION*
      *---------------------------------------------------*

      ***** $114384 START *****
      *    IF FIA-OEM-TRNSFER-FOUND = 'Y'
      *       PERFORM VARYING SUBX FROM +1 BY +1
      *         UNTIL (SUBX > +10)
      *
      *          IF  FIA-FUND-TYPE (SUBX) IS NOT = 'M'
      *              COMPUTE FIA-FUND-INTEREST        (SUBX) =
      *                     (FIA-FUND-PREMIUM         (SUBX) +
      *                      FIA-FUND-EXTRA-CREDIT    (SUBX) -
      *                      FIA-FUND-WITHDRAWALS     (SUBX) +
      *                      FIA-FUND-TRANSFER-IN-OUT (SUBX) )
      *                      * -1
      *              END-COMPUTE
      *          END-IF
      *       END-PERFORM
      *    END-IF.
      ***** $114384  END  *****

      *---------------------------------------------------*
      * NEED TO BACK INTO A FEW FIA VALUES IN THIS TABLE  *
      *---------------------------------------------------*

           PERFORM VARYING SUBX FROM +1 BY +1
      *         UNTIL (SUBX > +10)                              $T157090
             UNTIL (FIA-CONTRACT    AND SUBX > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBX > +10)
                OR (FIA-PA-CONTRACT AND SUBX > +30)

      ***** $114384 START ****
      *          IF  FIA-FUND-TYPE (SUBX) = 'M'
      *              COMPUTE   FIA-FUND-INTEREST        (SUBX)   =
      *                       (FIA-FUND-ENDING-VALUE    (SUBX)   +
      *                        FIA-FUND-RIDER-FEES      (SUBX)   +
      *                        FIA-FUND-WITHDRAWALS     (SUBX) ) -
      *                       (FIA-FUND-PREMIUM         (SUBX)   +
      *                        FIA-FUND-TRANSFER-IN-OUT (SUBX)   +
      *                        FIA-FUND-EXTRA-CREDIT    (SUBX) )
      *              END-COMPUTE
      *          END-IF
                 COMPUTE FIA-FUND-INTEREST (SUBX)
                       = FIA-FUND-ENDING-VALUE (SUBX)
                       - FIA-FUND-ADDON (SUBX)
                       - FIA-FUND-BEGIN-VALUE (SUBX)
                       + FIA-FUND-WITHDRAWALS (SUBX)
                       + FIA-FUND-RIDER-FEES (SUBX)
                       - FIA-FUND-TRANSFER-IN-OUT (SUBX)
                 END-COMPUTE
      ***** $114384  END  ****
                 IF  FIA-FUND-INTEREST (SUBX) < ZERO
                    MOVE ZERO TO FIA-FUND-INTEREST (SUBX)
                 END-IF

                 COMPUTE HOLD-FIA-INTEREST =
                         HOLD-FIA-INTEREST + FIA-FUND-INTEREST (SUBX)
                 END-COMPUTE
                 COMPUTE HOLD-FIA-WITHDRAW =
                         HOLD-FIA-WITHDRAW + FIA-FUND-RIDER-FEES (SUBX)
                 END-COMPUTE
           END-PERFORM.

       850000-EXIT.
           EXIT.
           EJECT
       851000-GET-LAST-TRXHIST.

           MOVE SPACES TO DB-PARM-AREA.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE GET-LAST                 IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE TRANSACTION-HISTORY      IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                GEN-TRX-REC
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              MOVE TRX-HIST-READ-ERROR TO VCS-ABEND-CODE
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
              SET SW-END-OF-TRXHIST TO TRUE
           END-IF.

       851000-EXIT.
           EXIT.
           EJECT
       852000-PROCESS-TRXHIST.

           IF  (EFFECTIVE-DATE IN GEN-TRX-REC < TRX-BEGIN-DATE)
           OR  (EFFECTIVE-DATE IN GEN-TRX-REC > TRX-END-DATE)
              GO TO 852000-CONTINUE
           END-IF.

           IF  ((TRX-CODE IN GEN-TRX-REC = 'MA  ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'NA  '))
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              PERFORM 852100-PAYMENT-FUNDS        THRU 852100-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'XC  '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              PERFORM 852200-EXTRA-CREDIT-FUNDS   THRU 852200-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'IDT '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              IF  EFFECTIVE-DATE IN GEN-TRX-REC = TRX-END-DATE
                 PERFORM 852300-IDX-RENEWAL-FUNDS THRU 852300-EXIT
              END-IF
              GO TO 852000-CONTINUE
           END-IF.
      *
      * WE DON'T NEED BOTH IAT AND IDT
      *
      *    IF  TRX-CODE IN GEN-TRX-REC = 'IAT '
      *    AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
      *       IF  EFFECTIVE-DATE IN GEN-TRX-REC = TRX-END-DATE
      *          PERFORM 852400-IDX-ANNIV-FUNDS   THRU 852400-EXIT
      *       END-IF
      *       GO TO 852000-CONTINUE
      *    END-IF.

           IF  ((TRX-CODE IN GEN-TRX-REC = 'TB  ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TK  ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TKS ')
           OR   (TRX-CODE IN GEN-TRX-REC = 'TKM '))
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
              PERFORM 852500-PARTIAL-FUNDS        THRU 852500-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'IRT '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              IF  EFFECTIVE-DATE IN GEN-TRX-REC = TRX-END-DATE
                 PERFORM 852600-MF-RENEWAL-FUNDS  THRU 852600-EXIT
              END-IF
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEZ '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              IF  EFFECTIVE-DATE IN GEN-TRX-REC = TRX-END-DATE
                 PERFORM 852700-FIA-TRNSFR-FUNDS  THRU 852700-EXIT
              END-IF
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'OEM '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
              PERFORM 852750-FIA-OEM-TRNSFR  THRU 852750-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'TA  '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
              PERFORM 852800-FULL-SURR-FUNDS      THRU 852800-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'PAD '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
           AND NON-TERMINATING-PAD IN PAD-TRX-REC
              PERFORM 852550-PAD-TRX          THRU 852550-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'PAD '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND TERMINATING-PAD IN PAD-TRX-REC
              PERFORM 852550-PAD-TRX          THRU 852550-EXIT
              GO TO 852000-CONTINUE
           END-IF.

      ***  IF  TRX-CODE IN GEN-TRX-REC = 'WX  ' OR               $T59669
      ***      TRX-CODE IN GEN-TRX-REC = 'WXI '                 $T201018
           IF (TRX-CODE IN GEN-TRX-REC = 'WX  ' OR
               TRX-CODE IN GEN-TRX-REC = 'WXI ')
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
               PERFORM 852900-RIDER-FEE-FUNDS THRU 852900-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'WXD '
           AND REVERSAL-CODE IN GEN-TRX-REC  = ' '
           AND (EFFECTIVE-DATE IN GEN-TRX-REC NOT = TRX-BEGIN-DATE)
               PERFORM 852910-RIDER-FEE-FUNDS THRU 852910-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'PA  '
              PERFORM 852A00-DEATH-CLAIM-FUNDS THRU 852A00-EXIT
              GO TO 852000-CONTINUE
           END-IF.

           IF  TRX-CODE IN GEN-TRX-REC = 'TZ  '
              PERFORM 852B00-ANNUITIZE-FUNDS   THRU 852B00-EXIT
              GO TO 852000-CONTINUE
           END-IF.

       852000-CONTINUE.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER            IN DB-PARM-AREA.
           MOVE SEGMENT-KEY              IN DB-COMM-AREA
             TO SEGMENT-KEY              IN DB-PARM-AREA.
           MOVE GET-PRIOR                IN DB-OPERATIONS
             TO OPERATION                IN DB-PARM-AREA.
           MOVE TRANSACTION-HISTORY      IN DB-SEGMENT-MNEMONICS
             TO ACCESS-SEGMENT           IN DB-PARM-AREA.

           SET BYPASS-REV-SOURCE-REV-TRX IN DB-PARM-AREA
            TO TRUE.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                GEN-TRX-REC
                                DB-COMM-AREA.
           IF  NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              SET SW-END-OF-TRXHIST TO TRUE
           END-IF.

       852000-EXIT.
           EXIT.
           EJECT
       852100-PAYMENT-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN NA-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN NA-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-PREMIUM (SUBS)
                    = FIA-FUND-PREMIUM (SUBS)
                    + FUND-NET-PREMIUM IN NA-TRX-REC (WS-SUB)
              END-COMPUTE

              IF  EFFECTIVE-DATE IN GEN-TRX-REC > HOLD-ISSUE-DATE
                 COMPUTE FIA-FUND-ADDON (SUBS)
                       = FIA-FUND-ADDON (SUBS)
                       + FUND-NET-PREMIUM IN NA-TRX-REC (WS-SUB)
                 END-COMPUTE
              END-IF

           END-PERFORM.

       852100-EXIT.
           EXIT.
           EJECT
       852200-EXTRA-CREDIT-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN XC-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN XC-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-EXTRA-CREDIT (SUBS)
                    = FIA-FUND-EXTRA-CREDIT (SUBS)
                    + FUND-NET-AMOUNT IN XC-TRX-REC (WS-SUB)
              END-COMPUTE

              IF  EFFECTIVE-DATE IN GEN-TRX-REC > HOLD-ISSUE-DATE
                 COMPUTE FIA-FUND-ADDON (SUBS)
                       = FIA-FUND-ADDON (SUBS)
                       + FUND-NET-AMOUNT IN XC-TRX-REC (WS-SUB)
                 END-COMPUTE
              END-IF

           END-PERFORM.

       852200-EXIT.
           EXIT.
           EJECT
       852300-IDX-RENEWAL-FUNDS.

           MOVE FUND-NUMBER              IN IDT-TRX-REC
             TO WK-FUND-NUMBER-WORK.

           PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT.

      *    COMPUTE FIA-FUND-INTEREST (SUBS)
      *          = FIA-FUND-INTEREST (SUBS)
      *          + CURR-CREDITED-VALUE   IN IDT-TRX-REC
      *    END-COMPUTE.
      *
           IF  T-P-RNWL-OEQ-VALUE   IN IDT-TRX-REC NUMERIC
           AND T-P-RNWL-OEQ-VALUE   IN IDT-TRX-REC NUMERIC
              COMPUTE FIA-FUND-INTEREST (SUBS)
                    = FIA-FUND-INTEREST (SUBS)
                    + (T-P-RNWL-OEQ-VALUE   IN IDT-TRX-REC
                    -  T-P-RNWL-OBQ-VALUE   IN IDT-TRX-REC)
              END-COMPUTE
      *    ELSE
      *        MOVE ZEROS TO FIA-FUND-INTEREST (SUBS)
           END-IF.

           IF  SW-USE-GTE-100K-BAND
              MOVE DECL-GTE-100K-CAP     IN RATE-SEGMENT (SUBS)
                TO FIA-FUND-GUAR-RATE (SUBS)
           ELSE
              MOVE DECL-LES-100K-CAP     IN RATE-SEGMENT (SUBS)
                TO FIA-FUND-GUAR-RATE (SUBS)
           END-IF.

       852300-EXIT.
           EXIT.
           EJECT
       852400-IDX-ANNIV-FUNDS.

           MOVE FUND-NUMBER              IN IAT-TRX-REC
             TO WK-FUND-NUMBER-WORK.

           PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT.

           IF  PRIOR-INDEX-FACTOR IN IAT-TRX-REC NUMERIC
              MOVE PRIOR-INDEX-FACTOR    IN IAT-TRX-REC
                TO FIA-FUND-STARTING-PRICE (SUBS)
           ELSE
              MOVE ZERO
                TO FIA-FUND-STARTING-PRICE (SUBS)
           END-IF.
           IF  CURR-INDEX-FACTOR IN IAT-TRX-REC NUMERIC
              MOVE CURR-INDEX-FACTOR     IN IAT-TRX-REC
                TO FIA-FUND-ENDING-PRICE (SUBS)
           ELSE
              MOVE ZERO
                TO FIA-FUND-ENDING-PRICE (SUBS)
           END-IF.
           IF  ANNIV-ACCT-GROWTH IN IAT-TRX-REC NUMERIC
              MOVE ANNIV-ACCT-GROWTH     IN IAT-TRX-REC
                TO FIA-FUND-INDEX-CHANGE (SUBS)
           ELSE
              MOVE ZERO
                TO FIA-FUND-INDEX-CHANGE (SUBS)
           END-IF.
           IF  ANNIV-CREDITED-RATE IN IAT-TRX-REC NUMERIC
              MOVE ANNIV-CREDITED-RATE   IN IAT-TRX-REC
                TO FIA-FUND-RATE-CREDITED  (SUBS)
           ELSE
              MOVE ZERO
                TO FIA-FUND-RATE-CREDITED  (SUBS)
           END-IF.

           IF  IAT-BEG-ILI-DUE     IN IAT-TRX-REC NUMERIC
              COMPUTE FIA-FUND-INTEREST (SUBS)
                    = FIA-FUND-INTEREST (SUBS)
                    + IAT-BEG-ILI-DUE    IN IAT-TRX-REC
      *    ELSE
      *       MOVE ZERO
      *         TO FIA-FUND-INTEREST (SUBS)
           END-IF.

       852400-EXIT.
           EXIT.
           EJECT
       852500-PARTIAL-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN TB-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN TB-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-WITHDRAWALS (SUBS)
                    = FIA-FUND-WITHDRAWALS (SUBS)
                    + FUND-AMT-SURRENDERED IN TB-TRX-REC (WS-SUB)
              END-COMPUTE
              COMPUTE FIA-FUND-MVA (SUBS)
                    = FIA-FUND-MVA (SUBS)
                    + FUND-MVA-AMT       IN TB-TRX-REC (WS-SUB)
              END-COMPUTE
              COMPUTE WK-STMT-MVA-AMT
                    = WK-STMT-MVA-AMT
                    + FUND-MVA-AMT       IN TB-TRX-REC (WS-SUB)
              END-COMPUTE

           END-PERFORM.

       852500-EXIT.
           EXIT.
           EJECT
       852550-PAD-TRX.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN PAD-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN PAD-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-WITHDRAWALS (SUBS)
                    = FIA-FUND-WITHDRAWALS (SUBS)
                    + FUND-AMT-SURRENDERED IN PAD-TRX-REC (WS-SUB)
              END-COMPUTE

           END-PERFORM.

       852550-EXIT.
           EXIT.

       852600-MF-RENEWAL-FUNDS.

           MOVE FUND-NUMBER              IN IRT-TRX-REC
             TO WK-FUND-NUMBER-WORK.

           PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT.

           COMPUTE FIA-FUND-INTEREST (SUBS)
                 = FIA-FUND-INTEREST (SUBS)
                 + (LAST-RENEWAL-AMOUNT OF CURR-INFO
                                        IN IRT-TRX-REC
                 -  LAST-RENEWAL-AMOUNT OF PRIOR-INFO
                                        IN IRT-TRX-REC)
           END-COMPUTE.

       852600-EXIT.
           EXIT.
           EJECT
       852700-FIA-TRNSFR-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN OE-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              IF  PARTICIPATION-TYPE IN OE-TRX-REC (WS-SUB) NOT = SPACE
                 MOVE FUND-NUMBER        OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                   TO WK-FUND-NUMBER-WORK

                 PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

                 IF  FROM-FUND IN OE-TRX-REC (WS-SUB)
                    COMPUTE FIA-FUND-TRANSFER-IN-OUT (SUBS)
                          = FIA-FUND-TRANSFER-IN-OUT (SUBS)
                          - PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
                    END-COMPUTE
                 ELSE
                    COMPUTE FIA-FUND-TRANSFER-IN-OUT (SUBS)
                          = FIA-FUND-TRANSFER-IN-OUT (SUBS)
                          + PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
                    END-COMPUTE
                 END-IF

              END-IF

           END-PERFORM.

       852700-EXIT.
           EXIT.
           EJECT

       852750-FIA-OEM-TRNSFR.

           MOVE 'Y' TO FIA-OEM-TRNSFER-FOUND.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN OE-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              IF  PARTICIPATION-TYPE IN OE-TRX-REC (WS-SUB) NOT = SPACE
                 MOVE FUND-NUMBER        OF FUND-INFO-TEXT
                                         IN OE-TRX-REC (WS-SUB)
                   TO WK-FUND-NUMBER-WORK

                 PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

                 IF  FROM-FUND IN OE-TRX-REC (WS-SUB)
                    COMPUTE FIA-FUND-TRANSFER-IN-OUT (SUBS)
                          = PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
                            * -1
                    END-COMPUTE
                 ELSE
                    MOVE PARTICIPATION-AMOUNT IN OE-TRX-REC (WS-SUB)
                      TO FIA-FUND-TRANSFER-IN-OUT (SUBS)
                 END-IF

              END-IF

           END-PERFORM.

       852750-EXIT.
           EXIT.
           EJECT

       852800-FULL-SURR-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF FUND-INFO-TEXT
                                IN TA-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF FUND-INFO-TEXT
                                         IN TA-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-WITHDRAWALS (SUBS)
                    = FIA-FUND-WITHDRAWALS (SUBS)
                    + FUND-AMT-SURRENDERED IN TA-TRX-REC (WS-SUB)
              END-COMPUTE
              COMPUTE FIA-FUND-MVA (SUBS)
                    = FIA-FUND-MVA (SUBS)
                    + FUND-MVA-AMT       IN TA-TRX-REC (WS-SUB)
              END-COMPUTE
              COMPUTE WK-STMT-MVA-AMT
                    = WK-STMT-MVA-AMT
                    + FUND-MVA-AMT       IN TA-TRX-REC (WS-SUB)
              END-COMPUTE

           END-PERFORM.

       852800-EXIT.
           EXIT.
           EJECT
       852900-RIDER-FEE-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF WX-FUND-INFO-TEXT
                                IN WX-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF WX-FUND-INFO-TEXT
                                         IN WX-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              IF  FUND-RIDER-FEE IN WX-TRX-REC (WS-SUB) NUMERIC
                  MOVE FUND-RIDER-FEE  IN WX-TRX-REC (WS-SUB)
                    TO FIA-FUND-RIDER-FEES (SUBS)
              ELSE
                  MOVE ZEROS
                    TO FIA-FUND-RIDER-FEES (SUBS)
              END-IF
           END-PERFORM.

       852900-EXIT.
           EXIT.
           EJECT
       852910-RIDER-FEE-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER OF WXD-FUND-INFO-TEXT
                                IN WXD-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           OF WXD-FUND-INFO-TEXT
                                         IN WXD-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              IF  FUND-RIDER-FEE IN WXD-TRX-REC (WS-SUB) NUMERIC
                  MOVE FUND-RIDER-FEE  IN WXD-TRX-REC (WS-SUB)
                    TO FIA-FUND-RIDER-FEES (SUBS)
              ELSE
                  MOVE ZEROS
                    TO FIA-FUND-RIDER-FEES (SUBS)
              END-IF
           END-PERFORM.

       852910-EXIT.
           EXIT.
           EJECT
       852A00-DEATH-CLAIM-FUNDS.

           IF  CURR-STATUS-CODE IN PA-TRX-REC NOT = 'D'
              GO TO 852A00-EXIT
           END-IF.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER IN PA-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           IN PA-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-WITHDRAWALS (SUBS)
                    = FIA-FUND-WITHDRAWALS (SUBS)
                    + FUND-AMT-SURRENDERED IN PA-TRX-REC (WS-SUB)
              END-COMPUTE

           END-PERFORM.

       852A00-EXIT.
           EXIT.
           EJECT
       852B00-ANNUITIZE-FUNDS.

           PERFORM VARYING WS-SUB FROM +1 BY +1
             UNTIL (FUND-NUMBER IN TZ-TRX-REC (WS-SUB) = +999)
                OR (WS-SUB > +99)

              MOVE FUND-NUMBER           IN TZ-TRX-REC (WS-SUB)
                TO WK-FUND-NUMBER-WORK

              PERFORM 852Z00-FIND-FUND-SLOT THRU 852Z00-EXIT

              COMPUTE FIA-FUND-WITHDRAWALS (SUBS)
                    = FIA-FUND-WITHDRAWALS (SUBS)
                    + FUND-AMT-ANNUITIZED IN TZ-TRX-REC (WS-SUB)
              END-COMPUTE

           END-PERFORM.

       852B00-EXIT.
           EXIT.
           EJECT
       852Z00-FIND-FUND-SLOT.

           MOVE ZERO TO SUBS.

           PERFORM VARYING SUBX FROM +1 BY +1
      *      UNTIL (SUBX > +10)                                 $T157090
             UNTIL (FIA-CONTRACT AND SUBX > +10)
                OR (FIA-INDEX-EDGE-CONTRACT AND SUBX > +10)
                OR (FIA-PA-CONTRACT AND SUBX > +30)
                OR (SUBS > ZERO)

              IF  WK-FUND-NUMBER-WORK =
                  FUND-NUMBER IN RATE-SEGMENT (SUBX)
                 MOVE SUBX TO SUBS
              END-IF

           END-PERFORM.

       852Z00-EXIT.
           EXIT.
           EJECT

       900000-GET-INDEX-TABLE-REC.

           MOVE SPACES TO TABLE-ACCESS.
           INITIALIZE INDEX-TABLE-REC.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN TABLE-ACCESS.
           MOVE PLAN-CODE                IN POLICY-SEG
             TO PLAN-CODE                IN TABLE-ACCESS.
           MOVE PROCESSING-SYSTEM-ID     IN POLICY-SEG
             TO PRODUCT-CODE             IN TABLE-ACCESS.
           MOVE POLICY-EFF-DATE          IN POLICY-SEG
             TO EFFECTIVE-DATE           IN TABLE-ACCESS
                EFFECTIVE-DATE           IN INDEX-TABLE-REC.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              IN INDEX-TABLE-REC.
           MOVE 'NA  '
             TO TRANSACTION-CODE         IN INDEX-TABLE-REC.
           MOVE POLICY-ISSUE-STATE       IN POLICY-SEG
             TO STATE-CODE               IN INDEX-TABLE-REC.
           MOVE LINE-OF-BUSINESS-CODE    IN POLICY-SEG
             TO LINE-OF-BUSINESS         IN INDEX-TABLE-REC.
           MOVE ZEROES
             TO THRESHOLD-AMOUNT         IN INDEX-TABLE-REC.
           MOVE SPACES
             TO REQUEST-TYPE             IN TABLE-ACCESS.
           MOVE '0C8'
             TO TABLE-ID                 IN TABLE-ACCESS.

           CALL 'ITAX011' USING TABLE-ACCESS
                                INDEX-TABLE-REC.
           IF  NOT TABLE-NORMAL-RETURN IN TABLE-ACCESS
              DISPLAY 'ERROR *** BAD INDEX TABLE READ ***'

              SET INDEX-PRIOR-NEXT-IND-PRIOR TO TRUE
              MOVE ' ' TO VALUATION-TYPE IN INDEX-TABLE-REC
              MOVE +365 TO LEAP-YEAR-DAYS IN INDEX-TABLE-REC
              GO TO 900000-EXIT
           END-IF.

       900000-EXIT.
           EXIT.
           EJECT

       910000-GET-ENDING-PRICE.

           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE             IN INDEX-PRICE-AREA.
           MOVE PLAN-CODE                IN POLICY-SEG
             TO PLAN-CODE                IN INDEX-PRICE-AREA.
           MOVE PROCESSING-SYSTEM-ID     IN POLICY-SEG
             TO PRODUCT-CODE             IN INDEX-PRICE-AREA.
           MOVE SPACES
             TO MEMO-CODE                IN INDEX-PRICE-AREA.
           MOVE STATUTORY-COMPANY-CODE   IN POLICY-SEG
             TO STATUTORY-COMPANY-CODE   IN INDEX-PRICE-AREA.
           MOVE LINE-OF-BUSINESS-CODE    IN POLICY-SEG
             TO LINE-OF-BUSINESS         IN INDEX-PRICE-AREA.
           MOVE WK-FUND-NUMBER-WORK
             TO FUND-NUMBER              OF INPUT-AREA
                                         IN INDEX-PRICE-AREA.
           MOVE TRX-END-DATE
             TO EFFECTIVE-DATE           IN INDEX-PRICE-AREA.

           IF  INDEX-PRIOR-NEXT-IND-PRIOR IN INDEX-TABLE-REC
              MOVE 'GNRP'
                TO UV-OPERATION          IN INDEX-PRICE-AREA
           ELSE
              MOVE 'GNRA'
                TO UV-OPERATION          IN INDEX-PRICE-AREA
           END-IF.

           CALL 'MUAXIP1' USING INDEX-PRICE-AREA.
           IF  NOT SUCCESSFUL-CALL IN INDEX-PRICE-AREA
              MOVE +0 TO WK-ENDING-PRICE
              DISPLAY 'ERROR *** MISSING PRICE ***'
              GO TO 910000-EXIT
           END-IF.

           MOVE INDEX-PRICE              IN INDEX-PRICE-AREA (1)
             TO WK-ENDING-PRICE.

       910000-EXIT.
           EXIT.
           EJECT

       920000-CALC-ILI-INFO.

           COMPUTE WK-INDEX-PCT
                 = (WK-ENDING-PRICE
                 -  INIT-INDEX-RATE IN INDEX-FUND-SEG)
                 / INIT-INDEX-RATE IN INDEX-FUND-SEG
           END-COMPUTE.

           COMPUTE WK-INDEX-GROWTH
                 = WK-INDEX-PCT
                 * 100.00
           END-COMPUTE.
      *
      * AT THIS POINT WE KNOW HOW THE INDEX DID. IF WE HAVE NEGATIVE
      * GROWTH, WE CAN ZERO OUT THE CREDITED RATE AS THEY WILL NOT
      * RECEIVE ANY INTEREST.
      *
           IF  WK-INDEX-PCT < ZERO
              MOVE ZERO TO WK-INDEX-CREDITED-RATE
      *       COMPUTE WK-INDEX-GROWTH = WK-INDEX-PCT * 100
              GO TO 920000-EXIT
           END-IF.

           IF  VALUATION-TYPE IN INDEX-TABLE-REC = 'T'
              PERFORM 921000-INDEX-FUND-TYPE-T THRU 921000-EXIT
           END-IF.

            COMPUTE WK-INDEX-PCT
                  = WK-INDEX-PCT
                  * EI-PARTICIPATION-PCT IN INDEX-FUND-SEG
            END-COMPUTE.

           CALL 'IUAEVC1' USING LEAP-YEAR-DAYS IN INDEX-TABLE-REC
                                ORIG-EI-DEPOSIT-DATE IN INDEX-FUND-SEG
                                WK-BEG-DAYS-1900.

      ***** $T86566 START *****
           IF INDEX-TYPE IN RATE-SEGMENT (SUBF) = 'E'
              COMPUTE WK-INDEX-PCT =
                      WK-INDEX-PCT *
                      (FIA-IL-GUAR-RATE   / 100) -
                      (FIA-IL-SPREAD-RATE / 100)
              END-COMPUTE
           ELSE
            IF  WK-INDEX-PCT > WK-CAP-RATE
               MOVE WK-CAP-RATE TO WK-INDEX-PCT
            END-IF
           END-IF
      ***** $T87159 START *****
      *    COMPUTE WK-INDEX-CREDITED-RATE
      *          = (WK-INDEX-PCT
      *          *  ((WK-END-DAYS-1900
      *          -    WK-BEG-DAYS-1900)
      *          /    WK-YEAR-IN-DAYS))
      *          * 100.00
      *    END-COMPUTE.
           COMPUTE WK-INDEX-PCT
              =  WK-INDEX-PCT
              *  ((WK-END-DAYS-1900
              -    WK-BEG-DAYS-1900)
              /    WK-YEAR-IN-DAYS)
           END-COMPUTE.
           COMPUTE WK-INDEX-CREDITED-RATE
                 = WK-INDEX-PCT
                 * 100.00
           END-COMPUTE.
      ***** $T87159  END  *****

      *
      * OUR LAST ADJUSTMENT IS TO DETERMINE HOW MUCH OF THE PERIOD THEY
      * ACTUALLY HAD MONEY IN THE FUND AND ADJUST ACCORDINGLY. NOTE:
      * IT IS ONLY IN THE FIRST YEAR THAT THIS WILL BE ANYTHING BUT 100%
      *
      *    IF  (ORIG-EI-DEPOSIT-MO IN INDEX-FUND-SEG = TRX-END-DATE-MM)
      *    AND (ORIG-EI-DEPOSIT-DY IN INDEX-FUND-SEG = TRX-END-DATE-DD)
      *       COMPUTE WK-INDEX-CREDITED-RATE
      *             = WK-INDEX-PCT
      *             * 100.00
      *       END-COMPUTE
      *    ELSE
      *       COMPUTE WK-INDEX-CREDITED-RATE
      *             = (WK-INDEX-PCT
      *             *  ((WK-END-DAYS-1900
      *             -    WK-BEG-DAYS-1900)
      *             /    WK-YEAR-IN-DAYS))
      *             * 100.00
      *       END-COMPUTE
      *    END-IF.
      ***** $T86566  END  *****

      ***** $T84581 START *****
      *    COMPUTE WK-INDEX-GROWTH = WK-INDEX-PCT * 100.
      ***** $T84581 START *****

       920000-EXIT.
           EXIT.
           EJECT
       921000-INDEX-FUND-TYPE-T.

           IF  SW-USE-GTE-100K-BAND
              COMPUTE WK-INDEX-PCT
                    = DECL-GTE-100K-CAP IN RATE-SEGMENT (SUBF)
                    / 100.000000
              END-COMPUTE
           ELSE
              COMPUTE WK-INDEX-PCT
                    = DECL-LES-100K-CAP   IN RATE-SEGMENT (SUBF)
                    / 100.000000
              END-COMPUTE
           END-IF.

       921000-EXIT.
           EXIT.
           EJECT
      *---------------------------------------------------------------
       930000-READ-INPUT .
      *----------------------------------------------------------------
      *    DISPLAY '930000-READ-INPUT'.
           READ EXTRACT-FILE
             AT END  MOVE 'Y'                TO EOF-SWITCH.


       930000-EXIT.
           EXIT.
           EJECT
      *----------------------------------------------------------------
       940000-GET-SEGMENTS.
      *----------------------------------------------------------------
      *    DISPLAY '940000-GET-SEGMENTS'.

           MOVE STATUTORY-COMPANY-CODE IN           POLICY-SPEC-RECORD
             TO HOLD-COMPANY-CODE.

      *    MOVE SERVICING-AGENT        IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENT
             TO HOLD-AGENT-ID.

      *    MOVE SERVICING-AGENCY-CODE IN           POLICY-SPEC-RECORD
           MOVE PGO-SERVICING-AGENCY
             TO HOLD-BROKER-NO.

           MOVE POLICY-NUMBER    IN     POLICY-SPEC-RECORD
             TO  HOLD-CONTRACT-NO.

           PERFORM 942000-GET-SCHEDULE-SEG   THRU 942000-EXIT.
           PERFORM 943000-GET-POLICY-SEG      THRU 943000-EXIT.
           PERFORM 944000-GET-FUND-SEG        THRU 944000-EXIT.

           PERFORM 946000-CALL-VPPTAB     THRU 946000-EXIT.


       940000-EXIT.
           EXIT.
           EJECT

      *----------------------------------------------------------------
       941000-GET-NAME-ADDRESS.
      *----------------------------------------------------------------
      *    DISPLAY '941000--NAME'.


           CALL 'IVEXAI1'                    USING DB-PARM-AREA
                                                   NAME-ADDRESS-SEGMENT
                                                   DB-COMM-AREA.

           IF RECORD-NOT-FOUND    IN DB-COMM-AREA
              CONTINUE
           ELSE
               IF NOT SUCCESSFUL-CALL IN DB-COMM-AREA
                   MOVE NAME-ADDR-READ-ERR
                     TO VCS-ABEND-CODE
                   DISPLAY 'ABENDING  OWNER'
                   DISPLAY 'DB-PARM-AREA'
                   DISPLAY  DB-PARM-AREA
                   DISPLAY 'DB-COMM-AREA'
                   DISPLAY  DB-COMM-AREA
                   PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
               END-IF
           END-IF.

       941000-EXIT.
           EXIT.
           EJECT

       941500-CALL-FINALIST.
      *---------------------------------

      **** CALL ADDRESS-CHECK ROUTINE:




      *    SET  AV-FINAL-REPORTS-CASS-ONLY
      *                                TO TRUE
           SET  AV-REPORT-ERRORS-ONLY  TO TRUE.
           MOVE SPACES                 TO AV-REPORT-KEY.
           MOVE HOLD-CONTRACT-NO       TO AV-REPORT-KEY.


           MOVE 35                     TO AV-MAX-LINE-LEN.

           CALL WS-VPPADDRB         USING WS-ADDRESS-VERIF-REC.


           IF      AV-BARCODE-BEG NOT = SPACE
               MOVE '*'                TO AV-BARCODE-BEG
                                          AV-BARCODE-END
           END-IF.

           MOVE AV-BARCODE             TO WS-MAIL-BARCODE.



       941500-EXIT.
           EXIT.
           EJECT
      *----------------------------------------------------------------
       942000-GET-SCHEDULE-SEG.
      *----------------------------------------------------------------
      *    DISPLAY '942000-GET-SCHEDULE-SEG'.

      **** READ SCHEDULE SEGMENT:

           MOVE SPACES                 TO DB-PARM-AREA.
           MOVE GET-FIRST              IN DB-OPERATIONS
             TO OPERATION              IN DB-PARM-AREA.
           MOVE SCHEDULE-ACTIVITY      IN DB-MNEMONICS
             TO ACCESS-SEGMENT         IN DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE           IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER          IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                SCHEDULE-SEGMENT
                                DB-COMM-AREA.

           IF      NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR READING SCHEDULE SEGMENT           ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' STATUS-CODE OF DB-COMM-AREA
              MOVE '93'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

       942000-EXIT.
           EXIT.
           EJECT
      *----------------------------------------------------------------
       943000-GET-POLICY-SEG.
      *----------------------------------------------------------------
      *    DISPLAY '943000-GET-POLICY-SEG'.

      **** READ CONTRACT SEGMENT:

           MOVE SPACES                 TO DB-PARM-AREA.
           MOVE GET-FIRST              IN DB-OPERATIONS
             TO OPERATION              IN DB-PARM-AREA.
           MOVE CONTRACT               IN DB-MNEMONICS
             TO ACCESS-SEGMENT         IN DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE           IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER          IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                POLICY-SEG
                                DB-COMM-AREA.

           MOVE SEGMENT-KEY IN DB-COMM-AREA
               TO SAVED-POLICY-KEY.

           IF      NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR READING CONTRACT SEGMENT           ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' STATUS-CODE OF DB-COMM-AREA
              MOVE '94'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.

       943000-EXIT.
           EXIT.
           EJECT
       944000-GET-FUND-SEG SECTION.
      *----------------------------------------------------------------
      *    DISPLAY '944000-GET-FUND-SEG'.

      **** READ FUND SEGMENT:

           MOVE SPACES                 TO DB-PARM-AREA.
           MOVE GET-FIRST              IN DB-OPERATIONS
             TO OPERATION              IN DB-PARM-AREA.
           MOVE FUND                   IN DB-MNEMONICS
             TO ACCESS-SEGMENT         IN DB-PARM-AREA.
           MOVE HOLD-COMPANY-CODE
             TO COMPANY-CODE           IN DB-PARM-AREA.
           MOVE HOLD-CONTRACT-NO
             TO KEY-QUALIFIER          IN DB-PARM-AREA.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                FUND-SEGMENT
                                DB-COMM-AREA.

           IF      NOT SUCCESSFUL-CALL IN DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR READING FUND SEGMENT               ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              DISPLAY 'STATUS-CODE - ' STATUS-CODE OF DB-COMM-AREA
              MOVE '95'                   TO STAND-ALONE-COMM-AREA
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT
           ELSE
               MOVE SEGMENT-KEY            IN DB-COMM-AREA
                 TO FUND-SEG-KEY
               MOVE DB-COMM-AREA          TO FUND-COMM-AREA
      ***** $W10612D START *****
      *        MOVE FUND-NUMBER             IN FUND-SEGMENT (SUBR)
      *
      *          TO HOLD-FUND-NUMBER.
               MOVE FUND-NUMBER             IN FUND-SEGMENT (SUBR)
                 TO HOLD-FUND-NUMBER
               IF EXPLORER-CONTRACT
                  PERFORM 944100-EXPLORER-FUND THRU 944100-EXIT
               END-IF
           END-IF.
      ***** $W10612D  END  *****

       944000-EXIT.
           EXIT.
           EJECT
       944100-EXPLORER-FUND.

           MOVE SPACE TO GENERATE-REC-45-SW
                         GENERATE-REC-46-SW
                         GENERATE-REC-47-SW.

           MOVE ZEROES TO HOLD-FUND-NUMBER.
           PERFORM VARYING SUBX FROM +1 BY +1
             UNTIL (SUBX > POLICY-MAX-FUNDS) OR
                   (FUND-NUMBER IN FUND-SEGMENT (SUBX) =
                    FUND-NUMBER-DEFAULT) OR
                   (HOLD-FUND-NUMBER > ZEROES)

      * BECAUSE THE ONLY TRANSFER ALLOWED IS THE RENEWAL INTO 111
      * THE ONLY FUND THAT SHOULD EVER HAVE TRANSFERS IN IS 111.
      *
              IF TRANSFERS-IN-CUM IN FUND-SEGMENT (SUBX) > ZEROES
                 MOVE FUND-NUMBER        IN FUND-SEGMENT (SUBX)
                   TO HOLD-FUND-NUMBER
              END-IF
      *
      * IF CASE WE DON'T HAVE 111 WE WILL SAVE THE POINTER TO THE
      * FUND WE DO.
      *
              IF GROSS-PREM IN FUND-SEGMENT (SUBX) > ZEROES
                 MOVE SUBX TO SUBH
              END-IF

           END-PERFORM.

      * IF WE DON'T HAVE 111 SET THE FLAG THAT WE HAVEN'T RENEWED YET
      * AND USE THE FUND THAT HAS MONEY IN IT.
      *
           IF HOLD-FUND-NUMBER > ZEROES
              SET GENERATE-REC-47 TO TRUE
              GO TO 944100-EXIT
           END-IF.

           MOVE FUND-NUMBER              IN FUND-SEGMENT (SUBH)
             TO HOLD-FUND-NUMBER.

       944100-EXIT.
           EXIT.
           EJECT

       946000-CALL-VPPTAB.


118000     MOVE COMPANY-CODE           IN DB-COMM-AREA
118100                  TO VTC-COMPANY-CODE.
118200     MOVE PLAN-CODE              IN POLICY-SEG
118300                  TO VTC-PLAN-CODE.
118400     MOVE LINE-OF-BUSINESS-CODE  IN POLICY-SEG
118500                  TO VTC-LOB-CODE.
118600     MOVE POLICY-ISSUE-DATE      IN POLICY-SEG
118700                  TO VTC-ISSUE-DATE.
118800
           SET    VTC-UPPER-CASE-ONLY
                  VTC-PARM-2-ALL-PROD-FUND
                  VTC-PARM-3-ALL-PLAN-LOB
            TO    TRUE.

118900     CALL W-VPPTAB1 USING W-CONTROL-PARM
                                W-ALL-PROD-FUND-PARM
                                W-ALL-PLAN-LOB-PARM.


119000     IF   NOT VTC-RESPONSE-GOOD
119100          DISPLAY 'VPPTAB1 RESP = '
119200                   VTC-RESPONSE-MSG
119300          MOVE PLAN-TABLE-ACCESS-ERROR
119400            TO  VCS-ABEND-CODE
                PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.
119500
119600
           PERFORM
               VARYING VT2-L-DX FROM 1 BY 1
                 UNTIL VT2-L-DX > VT2-LOB-CNT
               IF VT2-LOB-CODE(VT2-L-DX)
                  =  LINE-OF-BUSINESS-CODE  IN POLICY-SEG
                   MOVE VT2-LOB-DESC-30(VT2-L-DX)
                     TO HOLD-PLAN-TYPE
                   MOVE VTC-LOB-ANNUITANT-COPY
                     TO HOLD-ANNUITANT-COPY
               END-IF
           END-PERFORM.

119600
           MOVE VTC-PROD-MNEMONIC
             TO HOLD-PROD-MNEMONIC.
           MOVE VTC-PROD-EXT-NAME-20
             TO HOLD-PROD-NAME.

           IF HOLD-PROD-NAME = 'PACIFIC SECURE INCM'
              MOVE 'SECURE INCOME'
                TO HOLD-PROD-NAME
           END-IF.

           IF HOLD-PROD-NAME = 'INDEX SELECT 6' OR 'INDEX SELECT 8'
              MOVE 'Pacific Index Select'
                TO HOLD-PROD-NAME
           END-IF.

           IF HOLD-PROD-NAME = 'INDEX DIMENSIONS 7' OR
                               'INDEX DIMENSIONS 10'
              MOVE 'INDEX DIMENSIONS'
                TO HOLD-PROD-NAME
           END-IF.

      *    DISPLAY 'HOLD-PROD-NAME  '
      *           HOLD-PROD-NAME.

       946000-EXIT.
           EXIT.

       947000-GET-MONYFND-SEG.
      *----------------------------------------------------------------
      *    DISPLAY '947000-GET-MONYFND-SEG'.


           IF FIRST-TIME-MONEY-FUND
               MOVE SPACES                TO DB-PARM-AREA
                                             DB-COMM-AREA
                                             MONEY-FUND-KEY-WORK

      *        MOVE GET-FIRST              IN DB-OPERATIONS
               MOVE 'GFI '
                 TO OPERATION              IN DB-PARM-AREA

               MOVE MONEY-FUND             IN DB-SEGMENT-MNEMONICS
                 TO ACCESS-SEGMENT         IN DB-PARM-AREA

               MOVE HOLD-COMPANY-CODE
                 TO COMPANY-CODE            IN DB-PARM-AREA
                    COMPANY-CODE            IN MONEY-FUND-KEY-WORK

               MOVE HOLD-CONTRACT-NO
                 TO KEY-QUALIFIER           IN DB-PARM-AREA
                    MASTER-ID               IN MONEY-FUND-KEY-WORK

               MOVE HOLD-FUND-NUMBER
                 TO FUND-NUMBER             IN MONEY-FUND-KEY-WORK

               MOVE LOW-VALUES
                 TO ELEMENT-KEY             IN MONEY-FUND-KEY-WORK

               MOVE MONEY-FUND-KEY-WORK
                 TO SECONDARY-KEY           IN DB-PARM-AREA

           ELSE
               MOVE SPACES
                 TO DB-PARM-AREA
                    STATUS-CODE          IN DB-COMM-AREA

      *        MOVE GET-NEXT             IN DB-OPERATIONS
               MOVE 'GNI '
                 TO OPERATION               IN DB-PARM-AREA

               MOVE HOLD-COMPANY-CODE
                 TO COMPANY-CODE            IN DB-PARM-AREA

               MOVE HOLD-CONTRACT-NO
                 TO KEY-QUALIFIER           IN DB-PARM-AREA

               MOVE SAVE-MONYFUND-KEY
                 TO SECONDARY-KEY           IN DB-PARM-AREA

               MOVE MONEY-FUND           IN DB-SEGMENT-MNEMONICS
                 TO ACCESS-SEGMENT       IN DB-PARM-AREA

           END-IF.

           CALL 'IVEXAI1' USING DB-PARM-AREA
                                MONEY-FUND-SEGMENT
                                DB-COMM-AREA.

           IF RECORD-NOT-FOUND         IN DB-COMM-AREA
           OR END-OF-FILE              IN DB-COMM-AREA
             DISPLAY ' RECORD NOT FOUND'
             GO TO 947000-EXIT
           END-IF.

      *
      * WHEN USING GET FIRST RNF WILL NOT BE ENCOUNTERED
      * IF STATEMENT BELOW DOES CHECK INSTEAD
      *
           MOVE SEGMENT-KEY             IN DB-COMM-AREA
             TO SAVE-MONYFUND-KEY.
           MOVE SPACES
             TO  MFUND-SEGMENT-FOUND-FLAG

           IF FIRST-TIME-MONEY-FUND
           AND   FUND-NUMBER IN SAVE-MONYFUND-KEY
                 NOT =
                        HOLD-FUND-NUMBER
             SET MFUND-SEGMENT-NOT-FOUND TO TRUE
             DISPLAY ' NO MFUND FOR FUND = ' HOLD-FUND-NUMBER
             GO TO 947000-EXIT.

           IF FIRST-TIME-MONEY-FUND
               MOVE 'N' TO FIRST-TIME-MONEY-FUND-FLAG
               MOVE ORIG-DEPOSIT-FILE-CODE
                            IN  MONEY-FUND-SEGMENT
                 TO HOLD-ORIG-DEPOSIT-FILE-CODE
           END-IF

           IF FUND-NUMBER IN SAVE-MONYFUND-KEY
              NOT =
                HOLD-FUND-NUMBER
               MOVE 'Y' TO FUND-CHANGED-SW
           END-IF


           IF      NOT SUCCESSFUL-CALL  IN DB-COMM-AREA
           AND     NOT RECORD-NOT-FOUND IN DB-COMM-AREA
           AND     NOT END-OF-FILE      IN DB-COMM-AREA
              DISPLAY '***********************************************'
              DISPLAY '***                                         ***'
              DISPLAY '***PROGRAM NAME = VAPFIXST                  ***'
              DISPLAY '***                                         ***'
              DISPLAY '***ERROR READING MONEY-FUND-SEGMENT         ***'
              DISPLAY '***                                         ***'
              DISPLAY '***********************************************'
              PERFORM 990000-CALL-VCSABEND THRU 990000-EXIT.


       947000-EXIT.
      *    DISPLAY '947000-EXIT'.
           EXIT.
           EJECT
097710
099100 960000-CURRENT-AV.
099100*       DISPLAY '960000-CURRENT-AV'.

               MOVE    WK-VALUATION-DATE
099500           TO    VALUATION-DATE    IN POLICY-VALUES.

099700     PERFORM  961000-CALL-VALUATION   THRU  961000-EXIT.
099800
099900     IF  NOT GOOD-RETURN            IN INQ-CONT-AREA
100000         DISPLAY  'NOT GOOD RETURN IN INQUIRY CONTROL AREA'
100100         DISPLAY  'ERROR CODE ' ERROR-CODE IN INQ-CONT-AREA
100200         DISPLAY  'CONTRACT '  SCHEDULE-SEG-CONTRACT
               DISPLAY  'VALUATION DATE '
                         VALUATION-DATE IN POLICY-VALUES
125000         DISPLAY  SAVE-COMPANY-CODE
125200         DISPLAY  SCHEDULE-SEG-KEY-QUALIFIER
125400         DISPLAY  SAVE-FUND-KEY
100300         MOVE  VALUATION-CALL-ERROR
100400           TO  VCS-ABEND-CODE
100600         GO TO 960000-EXIT.
100700
102000
102100 960000-EXIT.
102200     EXIT.
102300     EJECT

124900 961000-CALL-VALUATION.
124900*       DISPLAY '961000-CALL-VALUATION'.
      *

           MOVE HOLD-COMPANY-CODE      TO COMPANY-CODE
                                       IN POLICY-VALUES.
           MOVE HOLD-CONTRACT-NO       TO MASTER-ID
                                       IN POLICY-VALUES.
           MOVE SEGMENT-KEY            IN FUND-COMM-AREA(1:24)
                                       TO FUND-ACCUM-SEGMENT-KEY
                                       IN POLICY-VALUES.
           MOVE 'P'                    TO REQUEST-TYPE
                                       IN POLICY-VALUES.
           MOVE 'EM  '                 TO REQUEST-TYPE
                                       IN INQ-CONT-AREA.
           MOVE '1'                    TO MASK-FUND-CASH-VALUE
                                       IN INQ-CONT-AREA.
           MOVE '1'                    TO MASK-TERMINATION-PENALTY
                                       IN INQ-CONT-AREA.
           MOVE '1'                    TO MASK-CASH-SURRENDER-VALUE
                                       IN INQ-CONT-AREA.
           MOVE '1'                    TO MASK-LOAN-VALUES
                                       IN INQ-CONT-AREA.
           MOVE '1'                    TO MASK-TEFRA-VALUE
                                       IN INQ-CONT-AREA.
           MOVE 'OL'
             TO RESERVES-PROC-IND      IN POLICY-SEG.
           MOVE SPACES                 TO MVA-OVERRIDE-IND
                                       IN TA-WORK-AREA.
           CALL 'IUAFIC1' USING
                                          INQ-CONT-AREA
                                          POLICY-VALUES
                                          POLICY-SEG
                                          SCHEDULE-SEGMENT
                                          DUMMY-AREA-1
                                          DUMMY-AREA-2
                                          DUMMY-AREA-3
                                          TRX-WORK-AREA
                                          TRX-COMM-AREA
                                          MONEY-FUND-SURTBL.

      *     MOVE    TRX-WORK-AREA
      *       TO    TA-WORK-AREA.

128100 961000-EXIT.
128200     EXIT.
128300     EJECT
089701
       970000-GET-EMAIL-DETAILS.
      *--------------------------------------

      **** READ THE EMAIL FILE TO DETERMINE IF AN EMAIL ADDRESS EXISTS
      **** ON DATABASE.

           SET  VP-DATA-SSN            IN W-VPAWEML-PARAMETER
                VP-ROLE-ALL            IN W-VPAWEML-PARAMETER
                VP-IN-STATUS-ALL       IN W-VPAWEML-PARAMETER
                                       TO TRUE.

           MOVE SPACES                 TO HOLD-ROLE-EMAIL.
           MOVE +0                     TO HOLD-ROLE-EMAIL-SEQ.

           CALL 'VPAWEML'           USING W-VPAWEML-PARAMETER.

           IF      VP-OUTPUT-RECORD-FND
               PERFORM VARYING VP-OUT-DX FROM 1 BY 1
                       UNTIL VP-OUT-DX > 10
                       OR    VP-OUTPUT-EML-ADDRESS(VP-OUT-DX) = SPACES
                   IF HOLD-ROLE-EMAIL = SPACES
                      MOVE VP-OUTPUT-SEQ         (VP-OUT-DX)
                        TO HOLD-ROLE-EMAIL-SEQ
                      MOVE VP-OUTPUT-EML-ADDRESS (VP-OUT-DX)
                        TO HOLD-ROLE-EMAIL
                   END-IF
               END-PERFORM
           ELSE
               MOVE 'NOT ON FILE'
                 TO HOLD-ROLE-EMAIL

           END-IF.

           IF HOLD-ROLE-EMAIL
                      = 'webmaster_annuities@pacificlife.com'
                     OR 'annuities_webmaster@pacificlife.com'
                     OR 'webmaster@pacificlife.com'
               MOVE SPACES
                 TO HOLD-ROLE-EMAIL
           END-IF.

       970000-EXIT.
           EXIT.
000900 980000-GET-PD-FROM-VPDPDS.
000900
000900*****************************************************************
000900***              980000-GET-PD-FROM-VPDPDS SECTION            ***
000900***             GETS AGENT INFO AND CHECKS RETURN CODES       ***
000900*****************************************************************
000900
000900D    DISPLAY '    START OF 980000-                '.
000900
000900     INITIALIZE                            PGI-INPUT-FIELDS
000900                                           PGO-OUTPUT-FIELDS.
000900*    MOVE  SAVE-COMPANY-CODE           TO  PGI-COMPANY-CODE.
000900     MOVE  HOLD-COMPANY-CODE           TO  PGI-COMPANY-CODE.
000900*    MOVE SCHEDULE-SEG-KEY-QUALIFIER
000900     MOVE HOLD-CONTRACT-NO
000900                        TO  PGI-CONTRACT-NUMBER.
000900     SET   PGI-NEED-SERV-AGENCY-NAME       TO TRUE
000900     SET   PGI-NEED-SERV-AGENT-NAME       TO TRUE
000900     MOVE  '0'                         TO  PGI-DATE-TO-USE.
000900     CALL  'VPDPDS'                 USING  PDS-AGENT-REC.
000900
000900     IF  PGO-RESPONSE-PARM-ERROR  OR
000900         PGO-RESPONSE-FILE-ERROR
000900         DISPLAY 'POL NO = ' PGI-CONTRACT-NUMBER
000900         DISPLAY 'CODE   = ' PGO-RESPONSE-CODE
000900         DISPLAY 'MSG    = ' PGO-RESPONSE-MSG
000900         MOVE  PRODUCER-READ-ERROR     TO  VCS-ABEND-CODE
000900         CALL  'VCSABEND'           USING  VCS-ABEND-CODE
000900     END-IF.
000900
000900     IF  NOT  PGO-RESPONSE-GOOD
000900         DISPLAY 'POL NO = ' PGI-CONTRACT-NUMBER
000900         DISPLAY 'CODE   = ' PGO-RESPONSE-CODE
000900         DISPLAY 'MSG    = ' PGO-RESPONSE-MSG
000900         SET  DROP-POLICY              TO  TRUE
000900     END-IF.
000900
086900
087000 980000-EXIT.
087100     EXIT.
087200
      *---------------------------------------------------------------
      *----------------------------------------------------------------
       990000-CALL-VCSABEND.
      *----------------------------------------------------------------
           DISPLAY '990000-CALL-VCSABEND'.

           CALL 'VCSABEND' USING VCS-ABEND-CODE.
           DISPLAY 'CALL PROGRAMMER'.

128100 990000-EXIT.
128200     EXIT.
           EJECT

